(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[753],{62602:function(Te,I,S){"use strict";S.d(I,{Z:function(){return Z}});var N=S(28991),x=S(67294),ne={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M342 88H120c-17.7 0-32 14.3-32 32v224c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V168h174c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16zm578 576h-48c-8.8 0-16 7.2-16 16v176H682c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h222c17.7 0 32-14.3 32-32V680c0-8.8-7.2-16-16-16zM342 856H168V680c0-8.8-7.2-16-16-16h-48c-8.8 0-16 7.2-16 16v224c0 17.7 14.3 32 32 32h222c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16zM904 88H682c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h174v176c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V120c0-17.7-14.3-32-32-32z"}}]},name:"expand",theme:"outlined"},W=ne,j=S(27029),V=function(he,be){return x.createElement(j.Z,(0,N.Z)((0,N.Z)({},he),{},{ref:be,icon:W}))};V.displayName="ExpandOutlined";var Z=x.forwardRef(V)},24557:function(Te,I,S){"use strict";S.d(I,{Z:function(){return Z}});var N=S(28991),x=S(67294),ne={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.4 800.9c.2-.3.5-.6.7-.9C920.6 722.1 960 621.7 960 512s-39.4-210.1-104.8-288c-.2-.3-.5-.5-.7-.8-1.1-1.3-2.1-2.5-3.2-3.7-.4-.5-.8-.9-1.2-1.4l-4.1-4.7-.1-.1c-1.5-1.7-3.1-3.4-4.6-5.1l-.1-.1c-3.2-3.4-6.4-6.8-9.7-10.1l-.1-.1-4.8-4.8-.3-.3c-1.5-1.5-3-2.9-4.5-4.3-.5-.5-1-1-1.6-1.5-1-1-2-1.9-3-2.8-.3-.3-.7-.6-1-1C736.4 109.2 629.5 64 512 64s-224.4 45.2-304.3 119.2c-.3.3-.7.6-1 1-1 .9-2 1.9-3 2.9-.5.5-1 1-1.6 1.5-1.5 1.4-3 2.9-4.5 4.3l-.3.3-4.8 4.8-.1.1c-3.3 3.3-6.5 6.7-9.7 10.1l-.1.1c-1.6 1.7-3.1 3.4-4.6 5.1l-.1.1c-1.4 1.5-2.8 3.1-4.1 4.7-.4.5-.8.9-1.2 1.4-1.1 1.2-2.1 2.5-3.2 3.7-.2.3-.5.5-.7.8C103.4 301.9 64 402.3 64 512s39.4 210.1 104.8 288c.2.3.5.6.7.9l3.1 3.7c.4.5.8.9 1.2 1.4l4.1 4.7c0 .1.1.1.1.2 1.5 1.7 3 3.4 4.6 5l.1.1c3.2 3.4 6.4 6.8 9.6 10.1l.1.1c1.6 1.6 3.1 3.2 4.7 4.7l.3.3c3.3 3.3 6.7 6.5 10.1 9.6 80.1 74 187 119.2 304.5 119.2s224.4-45.2 304.3-119.2a300 300 0 0010-9.6l.3-.3c1.6-1.6 3.2-3.1 4.7-4.7l.1-.1c3.3-3.3 6.5-6.7 9.6-10.1l.1-.1c1.5-1.7 3.1-3.3 4.6-5 0-.1.1-.1.1-.2 1.4-1.5 2.8-3.1 4.1-4.7.4-.5.8-.9 1.2-1.4a99 99 0 003.3-3.7zm4.1-142.6c-13.8 32.6-32 62.8-54.2 90.2a444.07 444.07 0 00-81.5-55.9c11.6-46.9 18.8-98.4 20.7-152.6H887c-3 40.9-12.6 80.6-28.5 118.3zM887 484H743.5c-1.9-54.2-9.1-105.7-20.7-152.6 29.3-15.6 56.6-34.4 81.5-55.9A373.86 373.86 0 01887 484zM658.3 165.5c39.7 16.8 75.8 40 107.6 69.2a394.72 394.72 0 01-59.4 41.8c-15.7-45-35.8-84.1-59.2-115.4 3.7 1.4 7.4 2.9 11 4.4zm-90.6 700.6c-9.2 7.2-18.4 12.7-27.7 16.4V697a389.1 389.1 0 01115.7 26.2c-8.3 24.6-17.9 47.3-29 67.8-17.4 32.4-37.8 58.3-59 75.1zm59-633.1c11 20.6 20.7 43.3 29 67.8A389.1 389.1 0 01540 327V141.6c9.2 3.7 18.5 9.1 27.7 16.4 21.2 16.7 41.6 42.6 59 75zM540 640.9V540h147.5c-1.6 44.2-7.1 87.1-16.3 127.8l-.3 1.2A445.02 445.02 0 00540 640.9zm0-156.9V383.1c45.8-2.8 89.8-12.5 130.9-28.1l.3 1.2c9.2 40.7 14.7 83.5 16.3 127.8H540zm-56 56v100.9c-45.8 2.8-89.8 12.5-130.9 28.1l-.3-1.2c-9.2-40.7-14.7-83.5-16.3-127.8H484zm-147.5-56c1.6-44.2 7.1-87.1 16.3-127.8l.3-1.2c41.1 15.6 85 25.3 130.9 28.1V484H336.5zM484 697v185.4c-9.2-3.7-18.5-9.1-27.7-16.4-21.2-16.7-41.7-42.7-59.1-75.1-11-20.6-20.7-43.3-29-67.8 37.2-14.6 75.9-23.3 115.8-26.1zm0-370a389.1 389.1 0 01-115.7-26.2c8.3-24.6 17.9-47.3 29-67.8 17.4-32.4 37.8-58.4 59.1-75.1 9.2-7.2 18.4-12.7 27.7-16.4V327zM365.7 165.5c3.7-1.5 7.3-3 11-4.4-23.4 31.3-43.5 70.4-59.2 115.4-21-12-40.9-26-59.4-41.8 31.8-29.2 67.9-52.4 107.6-69.2zM165.5 365.7c13.8-32.6 32-62.8 54.2-90.2 24.9 21.5 52.2 40.3 81.5 55.9-11.6 46.9-18.8 98.4-20.7 152.6H137c3-40.9 12.6-80.6 28.5-118.3zM137 540h143.5c1.9 54.2 9.1 105.7 20.7 152.6a444.07 444.07 0 00-81.5 55.9A373.86 373.86 0 01137 540zm228.7 318.5c-39.7-16.8-75.8-40-107.6-69.2 18.5-15.8 38.4-29.7 59.4-41.8 15.7 45 35.8 84.1 59.2 115.4-3.7-1.4-7.4-2.9-11-4.4zm292.6 0c-3.7 1.5-7.3 3-11 4.4 23.4-31.3 43.5-70.4 59.2-115.4 21 12 40.9 26 59.4 41.8a373.81 373.81 0 01-107.6 69.2z"}}]},name:"global",theme:"outlined"},W=ne,j=S(27029),V=function(he,be){return x.createElement(j.Z,(0,N.Z)((0,N.Z)({},he),{},{ref:be,icon:W}))};V.displayName="GlobalOutlined";var Z=x.forwardRef(V)},92104:function(Te,I,S){"use strict";S.d(I,{Z:function(){return Z}});var N=S(28991),x=S(67294),ne={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"},W=ne,j=S(27029),V=function(he,be){return x.createElement(j.Z,(0,N.Z)((0,N.Z)({},he),{},{ref:be,icon:W}))};V.displayName="SaveOutlined";var Z=x.forwardRef(V)},63434:function(Te,I,S){"use strict";var N=S(63185),x=S(9676),ne=S(99653),W=S(97445),j=S(85893),V=S(22270),Z=S(67294),De=S(64893),he=S(26227),be=["options","fieldProps","proFieldProps","valueEnum"],at=Z.forwardRef(function(dt,Et){var ht=dt.options,Oe=dt.fieldProps,Re=dt.proFieldProps,Dt=dt.valueEnum,ot=(0,W.Z)(dt,be);return(0,j.jsx)(he.Z,(0,ne.Z)({ref:Et,valueType:"checkbox",valueEnum:(0,V.h)(Dt,void 0),fieldProps:(0,ne.Z)({options:ht},Oe),lightProps:(0,ne.Z)({labelFormatter:function(){return(0,j.jsx)(he.Z,(0,ne.Z)({ref:Et,valueType:"checkbox",mode:"read",valueEnum:(0,V.h)(Dt,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,ne.Z)({options:ht},Oe),proFieldProps:Re},ot))}},ot.lightProps),proFieldProps:Re},ot))}),We=Z.forwardRef(function(dt,Et){var ht=dt.fieldProps,Oe=dt.children;return(0,j.jsx)(x.Z,(0,ne.Z)((0,ne.Z)({ref:Et},ht),{},{children:Oe}))}),Ht=(0,De.G)(We,{valuePropName:"checked"}),Yt=Ht;Yt.Group=at,I.Z=Yt},64317:function(Te,I,S){"use strict";var N=S(99653),x=S(97445),ne=S(85893),W=S(22270),j=S(67294),V=S(66758),Z=S(26227),De=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],he=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],be=j.forwardRef(function(dt,Et){var ht=dt.fieldProps,Oe=dt.children,Re=dt.params,Dt=dt.proFieldProps,ot=dt.mode,ft=dt.valueEnum,Ct=dt.request,St=dt.showSearch,Zt=dt.options,vt=(0,x.Z)(dt,De),tn=(0,j.useContext)(V.Z);return(0,ne.jsx)(Z.Z,(0,N.Z)((0,N.Z)({valueEnum:(0,W.h)(ft),request:Ct,params:Re,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,N.Z)({options:Zt,mode:ot,showSearch:St,getPopupContainer:tn.getPopupContainer},ht),ref:Et,proFieldProps:Dt},vt),{},{children:Oe}))}),at=j.forwardRef(function(dt,Et){var ht=dt.fieldProps,Oe=dt.children,Re=dt.params,Dt=dt.proFieldProps,ot=dt.mode,ft=dt.valueEnum,Ct=dt.request,St=dt.options,Zt=(0,x.Z)(dt,he),vt=(0,N.Z)({options:St,mode:ot||"multiple",labelInValue:!0,showSearch:!0,showArrow:!1,autoClearSearchValue:!0,optionLabelProp:"label"},ht),tn=(0,j.useContext)(V.Z);return(0,ne.jsx)(Z.Z,(0,N.Z)((0,N.Z)({valueEnum:(0,W.h)(ft),request:Ct,params:Re,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,N.Z)({getPopupContainer:tn.getPopupContainer},vt),ref:Et,proFieldProps:Dt},Zt),{},{children:Oe}))}),We=be,Ht=at,Yt=We;Yt.SearchSelect=Ht,Yt.displayName="ProFormComponent",I.Z=Yt},52688:function(Te,I,S){"use strict";var N=S(99653),x=S(97445),ne=S(85893),W=S(67294),j=S(26227),V=["fieldProps","unCheckedChildren","checkedChildren","proFieldProps"],Z=W.forwardRef(function(De,he){var be=De.fieldProps,at=De.unCheckedChildren,We=De.checkedChildren,Ht=De.proFieldProps,Yt=(0,x.Z)(De,V);return(0,ne.jsx)(j.Z,(0,N.Z)({valueType:"switch",fieldProps:(0,N.Z)({unCheckedChildren:at,checkedChildren:We},be),ref:he,valuePropName:"checked",proFieldProps:Ht,filedConfig:{valuePropName:"checked",ignoreWidth:!0}},Yt))});I.Z=Z},90672:function(Te,I,S){"use strict";var N=S(99653),x=S(97445),ne=S(85893),W=S(67294),j=S(26227),V=["fieldProps","proFieldProps"],Z=function(he,be){var at=he.fieldProps,We=he.proFieldProps,Ht=(0,x.Z)(he,V);return(0,ne.jsx)(j.Z,(0,N.Z)({ref:be,valueType:"textarea",fieldProps:at,proFieldProps:We},Ht))};I.Z=W.forwardRef(Z)},5966:function(Te,I,S){"use strict";var N=S(99653),x=S(97445),ne=S(85893),W=S(26227),j=["fieldProps","proFieldProps"],V=["fieldProps","proFieldProps"],Z="text",De=function(We){var Ht=We.fieldProps,Yt=We.proFieldProps,dt=(0,x.Z)(We,j);return(0,ne.jsx)(W.Z,(0,N.Z)({valueType:Z,fieldProps:Ht,filedConfig:{valueType:Z},proFieldProps:Yt},dt))},he=function(We){var Ht=We.fieldProps,Yt=We.proFieldProps,dt=(0,x.Z)(We,V);return(0,ne.jsx)(W.Z,(0,N.Z)({valueType:"password",fieldProps:Ht,proFieldProps:Yt,filedConfig:{valueType:Z}},dt))},be=De;be.Password=he,be.displayName="ProFormComponent",I.Z=be},16894:function(Te,I,S){"use strict";var N=S(65808),x=S(68129);I.ZP=x.Z},20499:function(){},64851:function(){},59518:function(){},26199:function(){},14156:function(){},71468:function(){},48871:function(){},9871:function(){},25612:function(){},92777:function(){},20159:function(){},61622:function(){},69609:function(Te,I,S){"use strict";S.d(I,{Vq:function(){return xs}});var N={};S.r(N),S.d(N,{components:function(){return Go},dfs:function(){return Ci},dijkstra:function(){return Rr},dijkstraAll:function(){return ls},findCycles:function(){return ko},floydWarshall:function(){return wl},isAcyclic:function(){return El},postorder:function(){return ta},preorder:function(){return ho},prim:function(){return Wr},tarjan:function(){return uf},topsort:function(){return lf}});const x=e=>typeof e=="string",ne=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},W=/-(\w)/g,j=ne(e=>e.replace(W,(t,n)=>n?n.toUpperCase():"")),V=Array.isArray,Z=e=>typeof e=="number",De=e=>Number.isNaN(Number(e)),he=e=>{const t=parseFloat(e);return De(t)?e:t},be=e=>e!==null&&typeof e=="object",at=e=>{if(e===null)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof Array){const t=[];return e.forEach(n=>{t.push(n)}),t.map(n=>at(n))}if(typeof e=="object"&&e!=={}){const t=Object.assign({},e);return Object.keys(t).forEach(n=>{t[n]=at(t[n])}),t}return e},We=(e,t)=>{const n=e[t];return be(n)?n.cell:n},Ht=(e,t,n)=>{const r=[];for(let i=0;i<e;i++)r[i]={in:0,out:0,all:0};return n&&n.forEach(i=>{const a=We(i,"source"),o=We(i,"target");a&&r[t[a]]&&(r[t[a]].out+=1,r[t[a]].all+=1),o&&r[t[o]]&&(r[t[o]].in+=1,r[t[o]].all+=1)}),r},Yt=(e,t)=>{const n={};return e.forEach(r=>{n[r.id]={in:0,out:0,all:0}}),t&&t.forEach(r=>{const i=We(r,"source"),a=We(r,"target");i&&(n[i].out+=1,n[i].all+=1),a&&(n[a].in+=1,n[a].all+=1)}),n},dt=e=>{const t=[],n=e.length;for(let r=0;r<n;r+=1){t[r]=[];for(let i=0;i<n;i+=1)r===i?t[r][i]=0:e[r][i]===0||!e[r][i]?t[r][i]=Infinity:t[r][i]=e[r][i]}for(let r=0;r<n;r+=1)for(let i=0;i<n;i+=1)for(let a=0;a<n;a+=1)t[i][a]>t[i][r]+t[r][a]&&(t[i][a]=t[i][r]+t[r][a]);return t},Et=(e,t)=>{const{nodes:n,edges:r}=e,i=[],a={};if(!n)throw new Error("invalid nodes data!");return n&&n.forEach((o,s)=>{a[o.id]=s;const c=[];i.push(c)}),r&&r.forEach(o=>{const s=We(o,"source"),c=We(o,"target"),f=a[s],d=a[c];i[f][d]=1,t||(i[d][f]=1)}),i},ht=(e,t)=>{const n=[];return e.forEach(r=>{const i=[];r.forEach(a=>{i.push(a*t)}),n.push(i)}),n},Oe=(e,t)=>{if(e&&e.children){for(let n=e.children.length-1;n>=0;n--)if(!Oe(e.children[n],t))return}return!!t(e)},Re=(e,t)=>{typeof t=="function"&&Oe(e,t)},Dt=e=>{let t=Infinity,n=Infinity,r=-Infinity,i=-Infinity;return e.forEach(a=>{t>a.x&&(t=a.x),n>a.y&&(n=a.y),r<a.x&&(r=a.x),i<a.y&&(i=a.y)}),{minX:t,minY:n,maxX:r,maxY:i}},ot=e=>{let t={x:0,y:0};e.forEach(r=>{t.x+=r.x||0,t.y+=r.y||0});const n=e.length||1;return{x:t.x/n,y:t.y/n}},ft=(e,t,n)=>{var r,i;return e==="source"?((r=n==null?void 0:n.find(a=>a.target===t.id))===null||r===void 0?void 0:r.source)||{}:((i=n==null?void 0:n.find(a=>a.source===t.id))===null||i===void 0?void 0:i.target)||{}},Ct=(e,t,n)=>{let r=[];switch(e){case"source":r=n==null?void 0:n.filter(a=>a.source===t.id).map(a=>a.target);break;case"target":r=n==null?void 0:n.filter(a=>a.target===t.id).map(a=>a.source);break;case"both":r=n==null?void 0:n.filter(a=>a.source===t.id).map(a=>a.target).concat(n==null?void 0:n.filter(a=>a.target===t.id).map(a=>a.source));break;default:break}const i=new Set(r);return Array.from(i)},St=(e,t,n,r,i)=>{const a=n[t]||"";let o=(r==null?void 0:r.filter(s=>s[t]===a))||[];return e==="leaf"&&(o=o.filter(s=>{var c,f;return((c=i[s.id])===null||c===void 0?void 0:c.in)===0||((f=i[s.id])===null||f===void 0?void 0:f.out)===0})),o},Zt=(e,t,n,r,i,a)=>{const{in:o,out:s}=i[t.id];let c=t,f=[];o===0?(c=ft("source",t,n),f=Ct("both",c,n).map(h=>a[h])):s===0&&(c=ft("target",t,n),f=Ct("both",c,n).map(h=>a[h])),f=f.filter(h=>i[h.id]&&(i[h.id].in===0||i[h.id].out===0));const d=St(e,r,t,f,i);return{coreNode:c,relativeLeafNodes:f,sameTypeLeafNodes:d}},vt=e=>typeof e=="function",tn=(e,t,n)=>{let r;return n?r=n:Z(e)?r=()=>e:r=()=>t,r},$n=(e,t,n=!0)=>!t&&t!==0?r=>r.size?V(r.size)?r.size[0]>r.size[1]?r.size[0]:r.size[1]:be(r.size)?r.size.width>r.size.height?r.size.width:r.size.height:r.size:e:vt(t)?t:Z(t)?()=>t:V(t)?()=>{if(n){const r=Math.max(...t);return isNaN(r)?e:r}return t}:be(t)?()=>{if(n){const r=Math.max(t.width,t.height);return isNaN(r)?e:r}return[t.width,t.height]}:()=>e,X=new Map,Dr=(e,t)=>{if(X.get(e)&&console.warn(`The layout with the name ${e} exists already, it will be overridden`),isObject(t)){class n extends Base{constructor(i){super();const a=this,o={},s=a.getDefaultCfg();Object.assign(o,s,t,i),Object.keys(o).forEach(c=>{const f=o[c];a[c]=f})}}X.set(e,n)}else X.set(e,t);return X.get(e)},Ki=e=>{X.has(e)&&X.delete(e)},es=e=>X.has(e)?X.get(e):null;class ar{constructor(){this.nodes=[],this.edges=[],this.combos=[],this.comboEdges=[],this.hiddenNodes=[],this.hiddenEdges=[],this.hiddenCombos=[],this.positions=[],this.destroyed=!1,this.onLayoutEnd=()=>{}}layout(t){return this.init(t),this.execute(!0)}init(t){this.nodes=t.nodes||[],this.edges=t.edges||[],this.combos=t.combos||[],this.comboEdges=t.comboEdges||[],this.hiddenNodes=t.hiddenNodes||[],this.hiddenEdges=t.hiddenEdges||[],this.hiddenCombos=t.hiddenCombos||[]}execute(t){}executeWithWorker(){}getDefaultCfg(){return{}}updateCfg(t){t&&Object.assign(this,t)}getType(){return"base"}destroy(){this.nodes=null,this.edges=null,this.combos=null,this.positions=null,this.destroyed=!0}}class Gi extends ar{constructor(t){super();this.begin=[0,0],this.preventOverlap=!0,this.preventOverlapPadding=10,this.condense=!1,this.sortBy="degree",this.nodes=[],this.edges=[],this.width=300,this.height=300,this.row=0,this.col=0,this.cellWidth=0,this.cellHeight=0,this.cellUsed={},this.id2manPos={},this.onLayoutEnd=()=>{},this.updateCfg(t)}getDefaultCfg(){return{begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30}}execute(){const t=this,{nodes:n,edges:r,begin:i}=t,a=n.length;if(a===0)return t.onLayoutEnd&&t.onLayoutEnd(),{nodes:n,edges:r};if(a===1)return n[0].x=i[0],n[0].y=i[1],t.onLayoutEnd&&t.onLayoutEnd(),{nodes:n,edges:r};let{sortBy:o,width:s,height:c}=t;const{condense:f,preventOverlapPadding:d,preventOverlap:h,nodeSpacing:v,nodeSize:m}=t,g=[];n.forEach(b=>{g.push(b)});const _={};if(g.forEach((b,A)=>{_[b.id]=A}),(o==="degree"||!x(o)||g[0][o]===void 0)&&(o="degree",De(n[0].degree))){const b=Ht(g.length,_,r);g.forEach((A,C)=>{A.degree=b[C].all})}g.sort((b,A)=>A[o]-b[o]),!s&&typeof window!="undefined"&&(s=window.innerWidth),!c&&typeof window!="undefined"&&(c=window.innerHeight);const y=t.rows,E=t.cols!=null?t.cols:t.columns;if(t.cells=a,y!=null&&E!=null?(t.rows=y,t.cols=E):y!=null&&E==null?(t.rows=y,t.cols=Math.ceil(t.cells/t.rows)):y==null&&E!=null?(t.cols=E,t.rows=Math.ceil(t.cells/t.cols)):(t.splits=Math.sqrt(t.cells*t.height/t.width),t.rows=Math.round(t.splits),t.cols=Math.round(t.width/t.height*t.splits)),t.rows=Math.max(t.rows,1),t.cols=Math.max(t.cols,1),t.cols*t.rows>t.cells){const b=t.small(),A=t.large();(b-1)*A>=t.cells?t.small(b-1):(A-1)*b>=t.cells&&t.large(A-1)}else for(;t.cols*t.rows<t.cells;){const b=t.small(),A=t.large();(A+1)*b>=t.cells?t.large(A+1):t.small(b+1)}if(t.cellWidth=s/t.cols,t.cellHeight=c/t.rows,f&&(t.cellWidth=0,t.cellHeight=0),h||v){const b=$n(10,v),A=$n(30,m,!1);g.forEach(C=>{(!C.x||!C.y)&&(C.x=0,C.y=0);const R=A(C)||30;let z,ee;V(R)?(z=R[0],ee=R[1]):(z=R,ee=R);const Q=b!==void 0?b(C):d,re=z+Q,de=ee+Q;t.cellWidth=Math.max(t.cellWidth,re),t.cellHeight=Math.max(t.cellHeight,de)})}t.cellUsed={},t.row=0,t.col=0,t.id2manPos={};for(let b=0;b<g.length;b++){const A=g[b];let C;if(t.position&&(C=t.position(A)),C&&(C.row!==void 0||C.col!==void 0)){const R={row:C.row,col:C.col};if(R.col===void 0)for(R.col=0;t.used(R.row,R.col);)R.col++;else if(R.row===void 0)for(R.row=0;t.used(R.row,R.col);)R.row++;t.id2manPos[A.id]=R,t.use(R.row,R.col)}t.getPos(A)}return t.onLayoutEnd&&t.onLayoutEnd(),{edges:r,nodes:g}}small(t){const n=this;let r;const i=n.rows||5,a=n.cols||5;return t==null?r=Math.min(i,a):Math.min(i,a)===n.rows?n.rows=t:n.cols=t,r}large(t){const n=this;let r;const i=n.rows||5,a=n.cols||5;return t==null?r=Math.max(i,a):Math.max(i,a)===n.rows?n.rows=t:n.cols=t,r}used(t,n){return this.cellUsed[`c-${t}-${n}`]||!1}use(t,n){const r=this;r.cellUsed[`c-${t}-${n}`]=!0}moveToNextCell(){const t=this,n=t.cols||5;t.col++,t.col>=n&&(t.col=0,t.row++)}getPos(t){const n=this,{begin:r,cellWidth:i,cellHeight:a}=n;let o,s;const c=n.id2manPos[t.id];if(c)o=c.col*i+i/2+r[0],s=c.row*a+a/2+r[1];else{for(;n.used(n.row,n.col);)n.moveToNextCell();o=n.col*i+i/2+r[0],s=n.row*a+a/2+r[1],n.use(n.row,n.col),n.moveToNextCell()}t.x=o,t.y=s}getType(){return"grid"}}const Fa=(e,t)=>{let n;return e?Z(e)?n=r=>e:n=e:n=r=>t||1,n};class ao extends ar{constructor(t){super();this.maxIteration=500,this.workerEnabled=!1,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.5,this.interval=.02,this.factor=1,this.linkDistance=1,this.gravity=10,this.preventOverlap=!0,this.collideStrength=1,this.tick=()=>{},this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.animate=!0,this.updateCfg(t)}getDefaultCfg(){return{maxIteration:500,gravity:10,enableTick:!0,animate:!0}}execute(){var t,n;const r=this,i=r.nodes;if(r.timeInterval!==void 0&&typeof window!="undefined"&&window.clearInterval(r.timeInterval),!i||i.length===0){(t=r.onLayoutEnd)===null||t===void 0||t.call(r);return}!r.width&&typeof window!="undefined"&&(r.width=window.innerWidth),!r.height&&typeof window!="undefined"&&(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);const a=r.center;if(i.length===1){i[0].x=a[0],i[0].y=a[1],(n=r.onLayoutEnd)===null||n===void 0||n.call(r);return}const o={},s={};i.forEach((h,v)=>{Z(h.x)||(h.x=Math.random()*r.width),Z(h.y)||(h.y=Math.random()*r.height),o[h.id]=h,s[h.id]=v}),r.nodeMap=o,r.nodeIdxMap=s,r.linkDistance=Fa(r.linkDistance,1),r.nodeStrength=Fa(r.nodeStrength,1),r.edgeStrength=Fa(r.edgeStrength,1);const c=r.nodeSize;let f;if(r.preventOverlap){const h=r.nodeSpacing;let v;Z(h)?v=()=>h:vt(h)?v=h:v=()=>0,c?V(c)?f=m=>Math.max(c[0],c[1])+v(m):f=m=>c+v(m):f=m=>m.size?V(m.size)?Math.max(m.size[0],m.size[1])+v(m):be(m.size)?Math.max(m.size.width,m.size.height)+v(m):m.size+v(m):10+v(m)}r.nodeSize=f;const d=r.edges;r.degrees=Ht(i.length,r.nodeIdxMap,d),r.getMass||(r.getMass=h=>h.mass||r.degrees[r.nodeIdxMap[h.id]].all||1),r.run()}run(){var t;const n=this,{maxIteration:r,nodes:i,workerEnabled:a,minMovement:o,animate:s}=n;if(!!i)if(a||!s){for(let c=0;c<r;c++){const f=n.runOneStep(c);if(n.reachMoveThreshold(i,f,o))break}(t=n.onLayoutEnd)===null||t===void 0||t.call(n)}else{if(typeof window=="undefined")return;let c=0;this.timeInterval=window.setInterval(()=>{var f,d;if(!i)return;const h=n.runOneStep(c)||[];n.reachMoveThreshold(i,h,o)&&((f=n.onLayoutEnd)===null||f===void 0||f.call(n),window.clearInterval(n.timeInterval)),c++,c>=r&&((d=n.onLayoutEnd)===null||d===void 0||d.call(n),window.clearInterval(n.timeInterval))},0)}}reachMoveThreshold(t,n,r){let i=0;return t.forEach((a,o)=>{const s=a.x-n[o].x,c=a.y-n[o].y;i+=Math.sqrt(s*s+c*c)}),i/=t.length,i<r}runOneStep(t){var n;const r=this,{nodes:i,edges:a}=r,o=[],s=[];if(!i)return;i.forEach((d,h)=>{o[2*h]=0,o[2*h+1]=0,s[2*h]=0,s[2*h+1]=0}),r.calRepulsive(o,i),a&&r.calAttractive(o,a),r.calGravity(o,i);const c=Math.max(.02,r.interval-t*.002);r.updateVelocity(o,s,c,i);const f=[];return i.forEach(d=>{f.push({x:d.x,y:d.y})}),r.updatePosition(s,c,i),(n=r.tick)===null||n===void 0||n.call(r),f}calRepulsive(t,n){const r=this,{getMass:i,factor:a,coulombDisScale:o,preventOverlap:s,collideStrength:c=1}=r,f=r.nodeStrength,d=r.nodeSize;n.forEach((h,v)=>{const m=i?i(h):1;n.forEach((g,_)=>{if(v>=_)return;let y=h.x-g.x,E=h.y-g.y;y===0&&E===0&&(y=Math.random()*.01,E=Math.random()*.01);const b=y*y+E*E,A=Math.sqrt(b),C=(A+.1)*o,R=y/A,z=E/A,ee=(f(h)+f(g))*.5*a/(C*C),Q=i?i(g):1;if(t[2*v]+=R*ee,t[2*v+1]+=z*ee,t[2*_]-=R*ee,t[2*_+1]-=z*ee,s&&(d(h)+d(g))/2>A){const re=c*(f(h)+f(g))*.5/b;t[2*v]+=R*re/m,t[2*v+1]+=z*re/m,t[2*_]-=R*re/Q,t[2*_+1]-=z*re/Q}})})}calAttractive(t,n){const r=this,{nodeMap:i,nodeIdxMap:a,linkDistance:o,edgeStrength:s}=r,c=r.nodeSize,f=r.getMass;n.forEach((d,h)=>{const v=We(d,"source"),m=We(d,"target"),g=i[v],_=i[m];let y=_.x-g.x,E=_.y-g.y;y===0&&E===0&&(y=Math.random()*.01,E=Math.random()*.01);const b=Math.sqrt(y*y+E*E),A=y/b,C=E/b,ee=((o(d,g,_)||1+(c(g)+c(g)||0)/2)-b)*s(d),Q=a[v],re=a[m],de=f?f(g):1,Ie=f?f(_):1;t[2*Q]-=A*ee/de,t[2*Q+1]-=C*ee/de,t[2*re]+=A*ee/Ie,t[2*re+1]+=C*ee/Ie})}calGravity(t,n){const r=this,i=r.center,a=r.gravity,o=r.degrees,s=n.length;for(let c=0;c<s;c++){const f=n[c];let d=f.x-i[0],h=f.y-i[1],v=a;if(r.getCenter){const m=r.getCenter(f,o[c].all);m&&Z(m[0])&&Z(m[1])&&Z(m[2])&&(d=f.x-m[0],h=f.y-m[1],v=m[2])}!v||(t[2*c]-=v*d,t[2*c+1]-=v*h)}}updateVelocity(t,n,r,i){const a=this,o=r*a.damping;i.forEach((s,c)=>{let f=t[2*c]*o||.01,d=t[2*c+1]*o||.01;const h=Math.sqrt(f*f+d*d);if(h>a.maxSpeed){const v=a.maxSpeed/h;f=v*f,d=v*d}n[2*c]=f,n[2*c+1]=d})}updatePosition(t,n,r){r.forEach((i,a)=>{if(Z(i.fx)&&Z(i.fy)){i.x=i.fx,i.y=i.fy;return}const o=t[2*a]*n,s=t[2*a+1]*n;i.x+=o,i.y+=s})}stop(){this.timeInterval&&typeof window!="undefined"&&window.clearInterval(this.timeInterval)}destroy(){const t=this;t.stop(),t.tick=null,t.nodes=null,t.edges=null,t.destroyed=!0}getType(){return"gForce"}}function ki(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return Mo(this.cover(t,n),t,n,e)}function Mo(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,a=e._root,o={data:r},s=e._x0,c=e._y0,f=e._x1,d=e._y1,h,v,m,g,_,y,E,b;if(!a)return e._root=o,e;for(;a.length;)if((_=t>=(h=(s+f)/2))?s=h:f=h,(y=n>=(v=(c+d)/2))?c=v:d=v,i=a,!(a=a[E=y<<1|_]))return i[E]=o,e;if(m=+e._x.call(null,a.data),g=+e._y.call(null,a.data),t===m&&n===g)return o.next=a,i?i[E]=o:e._root=o,e;do i=i?i[E]=new Array(4):e._root=new Array(4),(_=t>=(h=(s+f)/2))?s=h:f=h,(y=n>=(v=(c+d)/2))?c=v:d=v;while((E=y<<1|_)==(b=(g>=v)<<1|m>=h));return i[b]=a,i[E]=o,e}function vu(e){var t,n,r=e.length,i,a,o=new Array(r),s=new Array(r),c=Infinity,f=Infinity,d=-Infinity,h=-Infinity;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t))||(o[n]=i,s[n]=a,i<c&&(c=i),i>d&&(d=i),a<f&&(f=a),a>h&&(h=a));if(c>d||f>h)return this;for(this.cover(c,f).cover(d,h),n=0;n<r;++n)Mo(this,o[n],s[n],e[n]);return this}function ei(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,a=(r=Math.floor(t))+1;else{for(var o=i-n||1,s=this._root,c,f;n>e||e>=i||r>t||t>=a;)switch(f=(t<r)<<1|e<n,c=new Array(4),c[f]=s,s=c,o*=2,f){case 0:i=n+o,a=r+o;break;case 1:n=i-o,a=r+o;break;case 2:i=n+o,r=a-o;break;case 3:n=i-o,r=a-o;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this}function oa(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function No(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function or(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function ts(e,t,n){var r,i=this._x0,a=this._y0,o,s,c,f,d=this._x1,h=this._y1,v=[],m=this._root,g,_;for(m&&v.push(new or(m,i,a,d,h)),n==null?n=Infinity:(i=e-n,a=t-n,d=e+n,h=t+n,n*=n);g=v.pop();)if(!(!(m=g.node)||(o=g.x0)>d||(s=g.y0)>h||(c=g.x1)<i||(f=g.y1)<a))if(m.length){var y=(o+c)/2,E=(s+f)/2;v.push(new or(m[3],y,E,c,f),new or(m[2],o,E,y,f),new or(m[1],y,s,c,E),new or(m[0],o,s,y,E)),(_=(t>=E)<<1|e>=y)&&(g=v[v.length-1],v[v.length-1]=v[v.length-1-_],v[v.length-1-_]=g)}else{var b=e-+this._x.call(null,m.data),A=t-+this._y.call(null,m.data),C=b*b+A*A;if(C<n){var R=Math.sqrt(n=C);i=e-R,a=t-R,d=e+R,h=t+R,r=m.data}}return r}function oo(e){if(isNaN(d=+this._x.call(null,e))||isNaN(h=+this._y.call(null,e)))return this;var t,n=this._root,r,i,a,o=this._x0,s=this._y0,c=this._x1,f=this._y1,d,h,v,m,g,_,y,E;if(!n)return this;if(n.length)for(;;){if((g=d>=(v=(o+c)/2))?o=v:c=v,(_=h>=(m=(s+f)/2))?s=m:f=m,t=n,!(n=n[y=_<<1|g]))return this;if(!n.length)break;(t[y+1&3]||t[y+2&3]||t[y+3&3])&&(r=t,E=y)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):t?(a?t[y]=a:delete t[y],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[E]=n:this._root=n),this):(this._root=a,this)}function ns(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Do(){return this._root}function Fi(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function rs(e){var t=[],n,r=this._root,i,a,o,s,c;for(r&&t.push(new or(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,a=n.x0,o=n.y0,s=n.x1,c=n.y1)&&r.length){var f=(a+s)/2,d=(o+c)/2;(i=r[3])&&t.push(new or(i,f,d,s,c)),(i=r[2])&&t.push(new or(i,a,d,f,c)),(i=r[1])&&t.push(new or(i,f,o,s,d)),(i=r[0])&&t.push(new or(i,a,o,f,d))}return this}function _i(e){var t=[],n=[],r;for(this._root&&t.push(new or(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var a,o=r.x0,s=r.y0,c=r.x1,f=r.y1,d=(o+c)/2,h=(s+f)/2;(a=i[0])&&t.push(new or(a,o,s,d,h)),(a=i[1])&&t.push(new or(a,d,s,c,h)),(a=i[2])&&t.push(new or(a,o,h,d,f)),(a=i[3])&&t.push(new or(a,d,h,c,f))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function ci(e){return e[0]}function pu(e){return arguments.length?(this._x=e,this):this._x}function Ti(e){return e[1]}function Ps(e){return arguments.length?(this._y=e,this):this._y}function is(e,t,n){var r=new G(t??ci,n??Ti,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function G(e,t,n,r,i,a){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function Zi(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Br=is.prototype=G.prototype;Br.copy=function(){var e=new G(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=Zi(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=Zi(r));return e},Br.add=ki,Br.addAll=vu,Br.cover=ei,Br.data=oa,Br.extent=No,Br.find=ts,Br.remove=oo,Br.removeAll=ns,Br.root=Do,Br.size=Fi,Br.visit=rs,Br.visitAfter=_i,Br.x=pu,Br.y=Ps;const so=.81,mu=.1;function Ji(e,t,n,r,i){const a=n/r,o=e.map((c,f)=>{const d=t[c.id],{data:h,x:v,y:m,size:g}=d,{nodeStrength:_}=h.layout.force;return{x:v,y:m,size:g,index:f,vx:0,vy:0,weight:a*_}}),s=is(o,c=>c.x,c=>c.y).visitAfter(as);return o.forEach(c=>{Xe(c,s)}),o.map((c,f)=>{const d=t[e[f].id],{mass:h=1}=d.data.layout.force;i[2*f]=c.vx/h,i[2*f+1]=c.vy/h}),i}function as(e){let t=0,n=0,r=0;if(e.length){for(let i=0;i<4;i++){const a=e[i];a&&a.weight&&(t+=a.weight,n+=a.x*a.weight,r+=a.y*a.weight)}e.x=n/t,e.y=r/t,e.weight=t}else{const i=e;e.x=i.data.x,e.y=i.data.y,e.weight=i.data.weight}}const Se=(e,t,n,r,i,a)=>{const o=a.x-e.x||mu,s=a.y-e.y||mu,c=r-t,f=o*o+s*s,d=Math.sqrt(f)*f;if(c*c*so<f){const h=e.weight/d;return a.vx+=o*h,a.vy+=s*h,!0}if(e.length)return!1;if(e.data!==a){const h=e.data.weight/d;a.vx+=o*h,a.vy+=s*h}};function Xe(e,t){t.visit((n,r,i,a,o)=>Se(n,r,i,a,o,e))}const mt=(e,t)=>{let n;return e?Z(e)?n=r=>e:n=e:n=r=>t||1,n};class Gt extends ar{constructor(t){super();this.maxIteration=1e3,this.workerEnabled=!1,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.4,this.interval=.02,this.factor=1,this.linkDistance=200,this.gravity=0,this.clusterNodeStrength=20,this.preventOverlap=!0,this.distanceThresholdMode="mean",this.tick=()=>{},this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.judgingDistance=0,this.centripetalOptions={leaf:2,single:2,others:1,center:r=>({x:this.width/2,y:this.height/2})};const{getMass:n}=t;this.propsGetMass=n,this.updateCfg(t)}getCentripetalOptions(){const{leafCluster:t,clustering:n,nodeClusterBy:r,nodes:i,nodeMap:a,clusterNodeStrength:o}=this,s=m=>typeof o=="function"?o(m):o;let c={},f;if(t){f=this.getSameTypeLeafMap()||{};const m=Array.from(new Set(i==null?void 0:i.map(g=>g[r])))||[];c={single:100,leaf:(g,_,y)=>{const{relativeLeafNodes:E,sameTypeLeafNodes:b}=f[g.id]||{};return(b==null?void 0:b.length)===(E==null?void 0:E.length)||(m==null?void 0:m.length)===1?1:s(g)},others:1,center:(g,_,y)=>{var E;const{degree:b}=((E=g.data)===null||E===void 0?void 0:E.layout)||{};if(!b)return{x:100,y:100};let A;if(b===1){const{sameTypeLeafNodes:C=[]}=f[g.id]||{};C.length===1?A=void 0:C.length>1&&(A=ot(C))}else A=void 0;return{x:A==null?void 0:A.x,y:A==null?void 0:A.y}}}}if(n){f||(f=this.getSameTypeLeafMap());const m=Array.from(new Set(i.map((_,y)=>_[r]))).filter(_=>_!==void 0),g={};m.forEach(_=>{const y=i.filter(E=>E[r]===_).map(E=>a[E.id]);g[_]=ot(y)}),c={single:_=>s(_),leaf:_=>s(_),others:_=>s(_),center:(_,y,E)=>{const b=g[_[r]];return{x:b==null?void 0:b.x,y:b==null?void 0:b.y}}}}this.centripetalOptions=Object.assign(Object.assign({},this.centripetalOptions),c);const{leaf:d,single:h,others:v}=this.centripetalOptions;d&&typeof d!="function"&&(this.centripetalOptions.leaf=()=>d),h&&typeof h!="function"&&(this.centripetalOptions.single=()=>h),v&&typeof v!="function"&&(this.centripetalOptions.others=()=>v)}updateCfg(t){t&&Object.assign(this,t)}getDefaultCfg(){return{maxIteration:500,gravity:10,enableTick:!0,animate:!0}}execute(){const t=this;t.stop();const{nodes:n,edges:r,defSpringLen:i}=t;if(t.judgingDistance=0,!n||n.length===0){t.onLayoutEnd([]);return}!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight),t.center||(t.center=[t.width/2,t.height/2]);const a=t.center;if(n.length===1){n[0].x=a[0],n[0].y=a[1],t.onLayoutEnd([Object.assign({},n[0])]);return}t.degreesMap=Yt(n,r),t.propsGetMass?t.getMass=t.propsGetMass:t.getMass=d=>{let h=1;Z(d.mass)&&(h=d.mass);const v=t.degreesMap[d.id].all;return!v||v<5?h:v*5*h};const o=t.nodeSize;let s;if(t.preventOverlap){const d=t.nodeSpacing;let h;Z(d)?h=()=>d:vt(d)?h=d:h=()=>0,o?V(o)?s=v=>Math.max(o[0],o[1])+h(v):s=v=>o+h(v):s=v=>v.size?V(v.size)?Math.max(v.size[0],v.size[1])+h(v):be(v.size)?Math.max(v.size.width,v.size.height)+h(v):v.size+h(v):10+h(v)}t.nodeSize=s,t.linkDistance=mt(t.linkDistance,1),t.nodeStrength=mt(t.nodeStrength,1),t.edgeStrength=mt(t.edgeStrength,1);const c={},f={};n.forEach((d,h)=>{Z(d.x)||(d.x=Math.random()*t.width),Z(d.y)||(d.y=Math.random()*t.height);const v=t.degreesMap[d.id];c[d.id]=Object.assign(Object.assign({},d),{data:Object.assign(Object.assign({},d.data),{size:t.nodeSize(d)||30,layout:{inDegree:v.in,outDegree:v.out,degree:v.all,tDegree:v.in,sDegree:v.out,force:{mass:t.getMass(d),nodeStrength:t.nodeStrength(d)}}})}),f[d.id]=h}),t.nodeMap=c,t.nodeIdxMap=f,t.edgeInfos=[],r==null||r.forEach(d=>{const h=c[d.source],v=c[d.target];!h||!v?elf.edgeInfos.push({}):t.edgeInfos.push({edgeStrength:t.edgeStrength(d),linkDistance:i?i(Object.assign(Object.assign({},d),{source:h,target:v}),h,v):t.linkDistance(d,h,v)||1+(o(h)+o(h)||0)/2})}),this.getCentripetalOptions(),t.onLayoutEnd=t.onLayoutEnd||(()=>{}),t.run()}run(){const t=this,{maxIteration:n,nodes:r,workerEnabled:i,minMovement:a,animate:o,nodeMap:s}=t;if(!r)return;const c=[];r.forEach((h,v)=>{c[2*v]=0,c[2*v+1]=0});const f=n;if(i||!o){let h=0;for(let v=0;(t.judgingDistance>a||v<1)&&v<f;v++)h=v,t.runOneStep(v,c);t.onLayoutEnd(Object.values(s))}else{if(typeof window=="undefined")return;let h=0;this.timeInterval=window.setInterval(()=>{!r||(t.runOneStep(h,c),h++,(h>=f||t.judgingDistance<a)&&(t.onLayoutEnd(Object.values(s)),window.clearInterval(t.timeInterval)))},0)}}runOneStep(t,n){var r;const i=this,{nodes:a,edges:o,nodeMap:s,monitor:c}=i,f=[];if(!(a==null?void 0:a.length))return;i.calRepulsive(f),o&&i.calAttractive(f),i.calGravity(f);const d=i.interval;if(i.updateVelocity(f,n,d),i.updatePosition(n,d),(r=i.tick)===null||r===void 0||r.call(i),c){const h=this.calTotalEnergy(f);c({energy:h,nodes:a,edges:o,iterations:t})}}calTotalEnergy(t){const{nodes:n,nodeMap:r}=this;if(!(n==null?void 0:n.length))return 0;let i=0;return n.forEach((a,o)=>{const s=t[2*o],c=t[2*o+1],f=s*s+c*c,{mass:d=1}=r[a.id].data.layout.force;i+=d*f*.5}),i}calRepulsive(t){const n=this,{nodes:r,nodeMap:i,factor:a,coulombDisScale:o}=n,s=n.nodeSize;Ji(r,i,a,o*o,t)}calAttractive(t){const n=this,{edges:r,nodeMap:i,nodeIdxMap:a,edgeInfos:o}=n,s=n.nodeSize;r.forEach((c,f)=>{const d=We(c,"source"),h=We(c,"target"),v=i[d],m=i[h];if(!v||!m)return;let g=m.x-v.x,_=m.y-v.y;!g&&!_&&(g=Math.random()*.01,_=Math.random()*.01);const y=Math.sqrt(g*g+_*_),E=g/y,b=_/y,{linkDistance:A=200,edgeStrength:C=200}=o[f]||{},z=(A-y)*C,ee=v.data.layout.force.mass||1,Q=m.data.layout.force.mass||1,re=1/ee,de=1/Q,Ie=E*z,ie=b*z,ke=2*a[d],Ve=2*a[h];t[ke]-=Ie*re,t[ke+1]-=ie*re,t[Ve]+=Ie*de,t[Ve+1]+=ie*de})}calGravity(t){var n;const r=this,{nodes:i,edges:a=[],nodeMap:o,width:s,height:c,center:f,gravity:d,degreesMap:h,centripetalOptions:v}=r;if(!i)return;const m=i.length;for(let g=0;g<m;g++){const _=2*g,y=o[i[g].id],{mass:E=1}=y.data.layout.force;let b=0,A=0,C=d;const{in:R,out:z,all:ee}=h[y.id],Q=(n=r.getCenter)===null||n===void 0?void 0:n.call(r,y,ee);if(Q){const[re,de,Ie]=Q;b=y.x-re,A=y.y-de,C=Ie}else b=y.x-f[0],A=y.y-f[1];if(C&&(t[_]-=C*b/E,t[_+1]-=C*A/E),v){const{leaf:re,single:de,others:Ie,center:ie}=v,{x:ke,y:Ve,centerStrength:Rt}=(ie==null?void 0:ie(y,i,a,s,c))||{x:0,y:0,centerStrength:0};if(!Z(ke)||!Z(Ve))continue;const dn=(y.x-ke)/E,ln=(y.y-Ve)/E;if(Rt&&(t[_]-=Rt*dn,t[_+1]-=Rt*ln),ee===0){const lr=de(y);if(!lr)continue;t[_]-=lr*dn,t[_+1]-=lr*ln;continue}if(R===0||z===0){const lr=re(y,i,a);if(!lr)continue;t[_]-=lr*dn,t[_+1]-=lr*ln;continue}const pn=Ie(y);if(!pn)continue;t[_]-=pn*dn,t[_+1]-=pn*ln}}}updateVelocity(t,n,r){const i=this,{nodes:a,damping:o,maxSpeed:s}=i;!(a==null?void 0:a.length)||a.forEach((c,f)=>{let d=(n[2*f]+t[2*f]*r)*o||.01,h=(n[2*f+1]+t[2*f+1]*r)*o||.01;const v=Math.sqrt(d*d+h*h);if(v>s){const m=s/v;d=m*d,h=m*h}n[2*f]=d,n[2*f+1]=h})}updatePosition(t,n){const r=this,{nodes:i,distanceThresholdMode:a,nodeMap:o}=r;if(!(i==null?void 0:i.length)){this.judgingDistance=0;return}let s=0;a==="max"?r.judgingDistance=-Infinity:a==="min"&&(r.judgingDistance=Infinity),i.forEach((c,f)=>{const d=o[c.id];if(Z(c.fx)&&Z(c.fy)){c.x=c.fx,c.y=c.fy,d.x=c.x,d.y=c.y;return}const h=t[2*f]*n,v=t[2*f+1]*n;c.x+=h,c.y+=v,d.x=c.x,d.y=c.y;const m=Math.sqrt(h*h+v*v);switch(a){case"max":r.judgingDistance<m&&(r.judgingDistance=m);break;case"min":r.judgingDistance>m&&(r.judgingDistance=m);break;default:s=s+m;break}}),(!a||a==="mean")&&(r.judgingDistance=s/i.length)}stop(){this.timeInterval&&typeof window!="undefined"&&window.clearInterval(this.timeInterval)}destroy(){const t=this;t.stop(),t.tick=null,t.nodes=null,t.edges=null,t.destroyed=!0}getType(){return"force2"}getSameTypeLeafMap(){const{nodeClusterBy:t,nodes:n,edges:r,nodeMap:i,degreesMap:a}=this;if(!(n==null?void 0:n.length))return;const o={};return n.forEach((s,c)=>{a[s.id].all===1&&(o[s.id]=Zt("leaf",s,r,t,a,i))}),o}}function Ut(e){return function(){return e}}function kn(e){return(e()-.5)*1e-6}var An={value:function(){}};function Pn(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new en(n)}function en(e){this._=e}function Yn(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}en.prototype=Pn.prototype={constructor:en,on:function(t,n){var r=this._,i=Yn(t+"",r),a,o=-1,s=i.length;if(arguments.length<2){for(;++o<s;)if((a=(t=i[o]).type)&&(a=Kn(r[a],t.name)))return a;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++o<s;)if(a=(t=i[o]).type)r[a]=ma(r[a],t.name,n);else if(n==null)for(a in r)r[a]=ma(r[a],t.name,null);return this},copy:function(){var t={},n=this._;for(var r in n)t[r]=n[r].slice();return new en(t)},call:function(t,n){if((a=arguments.length-2)>0)for(var r=new Array(a),i=0,a,o;i<a;++i)r[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],i=0,a=o.length;i<a;++i)o[i].value.apply(n,r)},apply:function(t,n,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],a=0,o=i.length;a<o;++a)i[a].value.apply(n,r)}};function Kn(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function ma(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=An,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Os=Pn,Po=0,Ua=0,Oo=0,tf=1e3,Ai,uo,Lo=0,ga=0,os=0,Ls=typeof performance=="object"&&performance.now?performance:Date,nf=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Gs(){return ga||(nf(ol),ga=Ls.now()+os)}function ol(){ga=0}function qi(){this._call=this._time=this._next=null}qi.prototype=ac.prototype={constructor:qi,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Gs():+n)+(t==null?0:+t),!this._next&&uo!==this&&(uo?uo._next=this:Ai=this,uo=this),this._call=e,this._time=n,oc()},stop:function(){this._call&&(this._call=null,this._time=Infinity,oc())}};function ac(e,t,n){var r=new qi;return r.restart(e,t,n),r}function Xr(){Gs(),++Po;for(var e=Ai,t;e;)(t=ga-e._time)>=0&&e._call.call(null,t),e=e._next;--Po}function rf(){ga=(Lo=Ls.now())+os,Po=Ua=0;try{Xr()}finally{Po=0,af(),ga=0}}function sl(){var e=Ls.now(),t=e-Lo;t>tf&&(os-=t,Lo=e)}function af(){for(var e,t=Ai,n,r=Infinity;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Ai=n);uo=e,oc(r)}function oc(e){if(!Po){Ua&&(Ua=clearTimeout(Ua));var t=e-ga;t>24?(e<Infinity&&(Ua=setTimeout(rf,e-Ls.now()-os)),Oo&&(Oo=clearInterval(Oo))):(Oo||(Lo=Ls.now(),Oo=setInterval(sl,tf)),Po=1,nf(rf))}}var ul=1664525,cl=1013904223,sc=4294967296;function fl(){var e=1;return function(){return(e=(ul*e+cl)%sc)/sc}}function ll(e){return e.x}function gu(e){return e.y}var dl=10,of=Math.PI*(3-Math.sqrt(5));function uc(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,s=new Map,c=ac(h),f=Os("tick","end"),d=fl();e==null&&(e=[]);function h(){v(),f.call("tick",t),n<r&&(c.stop(),f.call("end",t))}function v(_){var y,E=e.length,b;_===void 0&&(_=1);for(var A=0;A<_;++A)for(n+=(a-n)*i,s.forEach(function(C){C(n)}),y=0;y<E;++y)b=e[y],b.fx==null?b.x+=b.vx*=o:(b.x=b.fx,b.vx=0),b.fy==null?b.y+=b.vy*=o:(b.y=b.fy,b.vy=0);return t}function m(){for(var _=0,y=e.length,E;_<y;++_){if(E=e[_],E.index=_,E.fx!=null&&(E.x=E.fx),E.fy!=null&&(E.y=E.fy),isNaN(E.x)||isNaN(E.y)){var b=dl*Math.sqrt(.5+_),A=_*of;E.x=b*Math.cos(A),E.y=b*Math.sin(A)}(isNaN(E.vx)||isNaN(E.vy))&&(E.vx=E.vy=0)}}function g(_){return _.initialize&&_.initialize(e,d),_}return m(),t={tick:v,restart:function(){return c.restart(h),t},stop:function(){return c.stop(),t},nodes:function(y){return arguments.length?(e=y,m(),s.forEach(g),t):e},alpha:function(y){return arguments.length?(n=+y,t):n},alphaMin:function(y){return arguments.length?(r=+y,t):r},alphaDecay:function(y){return arguments.length?(i=+y,t):+i},alphaTarget:function(y){return arguments.length?(a=+y,t):a},velocityDecay:function(y){return arguments.length?(o=1-y,t):1-o},randomSource:function(y){return arguments.length?(d=y,s.forEach(g),t):d},force:function(y,E){return arguments.length>1?(E==null?s.delete(y):s.set(y,g(E)),t):s.get(y)},find:function(y,E,b){var A=0,C=e.length,R,z,ee,Q,re;for(b==null?b=Infinity:b*=b,A=0;A<C;++A)Q=e[A],R=y-Q.x,z=E-Q.y,ee=R*R+z*z,ee<b&&(re=Q,b=ee);return re},on:function(y,E){return arguments.length>1?(f.on(y,E),t):f.on(y)}}}function ss(){var e,t,n,r,i=Ut(-30),a,o=1,s=Infinity,c=.81;function f(m){var g,_=e.length,y=is(e,ll,gu).visitAfter(h);for(r=m,g=0;g<_;++g)t=e[g],y.visit(v)}function d(){if(!!e){var m,g=e.length,_;for(a=new Array(g),m=0;m<g;++m)_=e[m],a[_.index]=+i(_,m,e)}}function h(m){var g=0,_,y,E=0,b,A,C;if(m.length){for(b=A=C=0;C<4;++C)(_=m[C])&&(y=Math.abs(_.value))&&(g+=_.value,E+=y,b+=y*_.x,A+=y*_.y);m.x=b/E,m.y=A/E}else{_=m,_.x=_.data.x,_.y=_.data.y;do g+=a[_.data.index];while(_=_.next)}m.value=g}function v(m,g,_,y){if(!m.value)return!0;var E=m.x-t.x,b=m.y-t.y,A=y-g,C=E*E+b*b;if(A*A/c<C)return C<s&&(E===0&&(E=kn(n),C+=E*E),b===0&&(b=kn(n),C+=b*b),C<o&&(C=Math.sqrt(o*C)),t.vx+=E*m.value*r/C,t.vy+=b*m.value*r/C),!0;if(m.length||C>=s)return;(m.data!==t||m.next)&&(E===0&&(E=kn(n),C+=E*E),b===0&&(b=kn(n),C+=b*b),C<o&&(C=Math.sqrt(o*C)));do m.data!==t&&(A=a[m.data.index]*r/C,t.vx+=E*A,t.vy+=b*A);while(m=m.next)}return f.initialize=function(m,g){e=m,n=g,d()},f.strength=function(m){return arguments.length?(i=typeof m=="function"?m:Ut(+m),d(),f):i},f.distanceMin=function(m){return arguments.length?(o=m*m,f):Math.sqrt(o)},f.distanceMax=function(m){return arguments.length?(s=m*m,f):Math.sqrt(s)},f.theta=function(m){return arguments.length?(c=m*m,f):Math.sqrt(c)},f}function us(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var a,o=n.length,s,c=0,f=0;for(a=0;a<o;++a)s=n[a],c+=s.x,f+=s.y;for(c=(c/o-e)*r,f=(f/o-t)*r,a=0;a<o;++a)s=n[a],s.x-=c,s.y-=f}return i.initialize=function(a){n=a},i.x=function(a){return arguments.length?(e=+a,i):e},i.y=function(a){return arguments.length?(t=+a,i):t},i.strength=function(a){return arguments.length?(r=+a,i):r},i}function yu(e){return e.index}function cc(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function ks(e){var t=yu,n=h,r,i=Ut(30),a,o,s,c,f,d=1;e==null&&(e=[]);function h(y){return 1/Math.min(s[y.source.index],s[y.target.index])}function v(y){for(var E=0,b=e.length;E<d;++E)for(var A=0,C,R,z,ee,Q,re,de;A<b;++A)C=e[A],R=C.source,z=C.target,ee=z.x+z.vx-R.x-R.vx||kn(f),Q=z.y+z.vy-R.y-R.vy||kn(f),re=Math.sqrt(ee*ee+Q*Q),re=(re-a[A])/re*y*r[A],ee*=re,Q*=re,z.vx-=ee*(de=c[A]),z.vy-=Q*de,R.vx+=ee*(de=1-de),R.vy+=Q*de}function m(){if(!!o){var y,E=o.length,b=e.length,A=new Map(o.map(function(R,z){return[t(R,z,o),R]})),C;for(y=0,s=new Array(E);y<b;++y)C=e[y],C.index=y,typeof C.source!="object"&&(C.source=cc(A,C.source)),typeof C.target!="object"&&(C.target=cc(A,C.target)),s[C.source.index]=(s[C.source.index]||0)+1,s[C.target.index]=(s[C.target.index]||0)+1;for(y=0,c=new Array(b);y<b;++y)C=e[y],c[y]=s[C.source.index]/(s[C.source.index]+s[C.target.index]);r=new Array(b),g(),a=new Array(b),_()}}function g(){if(!!o)for(var y=0,E=e.length;y<E;++y)r[y]=+n(e[y],y,e)}function _(){if(!!o)for(var y=0,E=e.length;y<E;++y)a[y]=+i(e[y],y,e)}return v.initialize=function(y,E){o=y,f=E,m()},v.links=function(y){return arguments.length?(e=y,m(),v):e},v.id=function(y){return arguments.length?(t=y,v):t},v.iterations=function(y){return arguments.length?(d=+y,v):d},v.strength=function(y){return arguments.length?(n=typeof y=="function"?y:Ut(+y),g(),v):n},v.distance=function(y){return arguments.length?(i=typeof y=="function"?y:Ut(+y),_(),v):i},v}function hl(e){return e.x+e.vx}function sf(e){return e.y+e.vy}function fc(e){var t,n,r,i=1,a=1;typeof e!="function"&&(e=Ut(e==null?1:+e));function o(){for(var f,d=t.length,h,v,m,g,_,y,E=0;E<a;++E)for(h=is(t,hl,sf).visitAfter(s),f=0;f<d;++f)v=t[f],_=n[v.index],y=_*_,m=v.x+v.vx,g=v.y+v.vy,h.visit(b);function b(A,C,R,z,ee){var Q=A.data,re=A.r,de=_+re;if(Q){if(Q.index>v.index){var Ie=m-Q.x-Q.vx,ie=g-Q.y-Q.vy,ke=Ie*Ie+ie*ie;ke<de*de&&(Ie===0&&(Ie=kn(r),ke+=Ie*Ie),ie===0&&(ie=kn(r),ke+=ie*ie),ke=(de-(ke=Math.sqrt(ke)))/ke*i,v.vx+=(Ie*=ke)*(de=(re*=re)/(y+re)),v.vy+=(ie*=ke)*de,Q.vx-=Ie*(de=1-de),Q.vy-=ie*de)}return}return C>m+de||z<m-de||R>g+de||ee<g-de}}function s(f){if(f.data)return f.r=n[f.data.index];for(var d=f.r=0;d<4;++d)f[d]&&f[d].r>f.r&&(f.r=f[d].r)}function c(){if(!!t){var f,d=t.length,h;for(n=new Array(d),f=0;f<d;++f)h=t[f],n[h.index]=+e(h,f,t)}}return o.initialize=function(f,d){t=f,r=d,c()},o.iterations=function(f){return arguments.length?(a=+f,o):a},o.strength=function(f){return arguments.length?(i=+f,o):i},o.radius=function(f){return arguments.length?(e=typeof f=="function"?f:Ut(+f),c(),o):e},o}function lc(e){var t=Ut(.1),n,r,i;typeof e!="function"&&(e=Ut(e==null?0:+e));function a(s){for(var c=0,f=n.length,d;c<f;++c)d=n[c],d.vx+=(i[c]-d.x)*r[c]*s}function o(){if(!!n){var s,c=n.length;for(r=new Array(c),i=new Array(c),s=0;s<c;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return a.initialize=function(s){n=s,o()},a.strength=function(s){return arguments.length?(t=typeof s=="function"?s:Ut(+s),o(),a):t},a.x=function(s){return arguments.length?(e=typeof s=="function"?s:Ut(+s),o(),a):e},a}function _u(e){var t=Ut(.1),n,r,i;typeof e!="function"&&(e=Ut(e==null?0:+e));function a(s){for(var c=0,f=n.length,d;c<f;++c)d=n[c],d.vy+=(i[c]-d.y)*r[c]*s}function o(){if(!!n){var s,c=n.length;for(r=new Array(c),i=new Array(c),s=0;s<c;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return a.initialize=function(s){n=s,o()},a.strength=function(s){return arguments.length?(t=typeof s=="function"?s:Ut(+s),o(),a):t},a.y=function(s){return arguments.length?(e=typeof s=="function"?s:Ut(+s),o(),a):e},a}function vl(){function e(Ot){return()=>Ot}let t=Ot=>Ot.cluster,n=e(1),r=e(-1),i=e(100),a=e(.1),o=[0,0],s=[],c={},f=[],d=100,h=100,v={none:{x:0,y:0}},m=[],g,_="force",y=!0,E=.1;function b(Ot){if(!y)return b;g.tick(),Q();for(let Tn=0,hr=s.length,zn,mn=Ot*E;Tn<hr;++Tn)zn=s[Tn],zn.vx+=(v[t(zn)].x-zn.x)*mn,zn.vy+=(v[t(zn)].y-zn.y)*mn}function A(){!s||C()}function C(){if(!s||!s.length)return;if(t(s[0])===void 0)throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInABox.groupBy('clusterAttr') before calling .links()");const Ot=R();g=uc(Ot.nodes).force("x",lc(d).strength(.1)).force("y",_u(h).strength(.1)).force("collide",fc(Tn=>Tn.r).iterations(4)).force("charge",ss().strength(r)).force("links",ks(Ot.nodes.length?Ot.links:[]).distance(i).strength(a)),m=g.nodes(),Q()}function R(){const Ot=[],Tn=[],hr={};let zn=[],mn={},Qt=[];return mn=z(s),Qt=ee(f),zn=Object.keys(mn),zn.forEach((mr,Qr)=>{const br=mn[mr];Ot.push({id:mr,size:br.count,r:Math.sqrt(br.sumforceNodeSize/Math.PI)}),hr[mr]=Qr}),Qt.forEach(mr=>{const Qr=We(mr,"source"),br=We(mr,"target"),ro=hr[Qr],fu=hr[br];ro!==void 0&&fu!==void 0&&Tn.push({source:ro,target:fu,count:mr.count})}),{nodes:Ot,links:Tn}}function z(Ot){const Tn={};return Ot.forEach(hr=>{const zn=t(hr);Tn[zn]||(Tn[zn]={count:0,sumforceNodeSize:0})}),Ot.forEach(hr=>{const zn=t(hr),mn=n(hr),Qt=Tn[zn];Qt.count=Qt.count+1,Qt.sumforceNodeSize=Qt.sumforceNodeSize+Math.PI*(mn*mn)*1.3,Tn[zn]=Qt}),Tn}function ee(Ot){const Tn={},hr=[];return Ot.forEach(mn=>{const Qt=re(mn);let mr=0;Tn[Qt]!==void 0&&(mr=Tn[Qt]),mr+=1,Tn[Qt]=mr}),Object.entries(Tn).forEach(([mn,Qt])=>{const mr=mn.split("~")[0],Qr=mn.split("~")[1];mr!==void 0&&Qr!==void 0&&hr.push({source:mr,target:Qr,count:Qt})}),hr}function Q(){return v={none:{x:0,y:0}},m.forEach(Ot=>{v[Ot.id]={x:Ot.x-o[0],y:Ot.y-o[1]}}),v}function re(Ot){const Tn=We(Ot,"source"),hr=We(Ot,"target"),zn=t(c[Tn]),mn=t(c[hr]);return zn<=mn?`${zn}~${mn}`:`${mn}~${zn}`}function de(Ot){c={},Ot.forEach(Tn=>{c[Tn.id]=Tn})}function Ie(Ot){return arguments.length?(_=Ot,A(),b):_}function ie(Ot){return arguments.length?typeof Ot=="string"?(t=Tn=>Tn[Ot],b):(t=Ot,b):t}function ke(Ot){return arguments.length?(y=Ot,b):y}function Ve(Ot){return arguments.length?(E=Ot,b):E}function Rt(Ot){return arguments.length?(d=Ot,b):d}function dn(Ot){return arguments.length?(h=Ot,b):h}function ln(Ot){return arguments.length?(de(Ot||[]),s=Ot||[],b):s}function pn(Ot){return arguments.length?(f=Ot||[],A(),b):f}function lr(Ot){return arguments.length?(typeof Ot=="function"?n=Ot:n=e(+Ot),A(),b):n}function Si(Ot){return arguments.length?(typeof Ot=="function"?r=Ot:r=e(+Ot),A(),b):r}function Hr(Ot){return arguments.length?(typeof Ot=="function"?i=Ot:i=e(+Ot),A(),b):i}function _n(Ot){return arguments.length?(typeof Ot=="function"?a=Ot:a=e(+Ot),A(),b):a}function wn(Ot){return arguments.length?(o=Ot,b):o}return b.initialize=Ot=>{s=Ot,A()},b.template=Ie,b.groupBy=ie,b.enableGrouping=ke,b.strength=Ve,b.centerX=Rt,b.centerY=dn,b.nodes=ln,b.links=pn,b.forceNodeSize=lr,b.nodeSize=b.forceNodeSize,b.forceCharge=Si,b.forceLinkDistance=Hr,b.forceLinkStrength=_n,b.offset=wn,b.getFocis=Q,b}const Ye={RUN:"LAYOUT_RUN",END:"LAYOUT_END",ERROR:"LAYOUT_ERROR",TICK:"LAYOUT_TICK",GPURUN:"GPU_LAYOUT_RUN",GPUEND:"GPU_LAYOUT_END"},Ne={gForce:!0,force2:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0};class bt extends ar{constructor(t){super();this.center=[0,0],this.nodeStrength=null,this.edgeStrength=null,this.preventOverlap=!1,this.clusterNodeStrength=null,this.clusterEdgeStrength=null,this.clusterEdgeDistance=null,this.clusterNodeSize=null,this.clusterFociStrength=null,this.linkDistance=50,this.alphaDecay=.028,this.alphaMin=.001,this.alpha=.3,this.collideStrength=1,this.workerEnabled=!1,this.tick=()=>{},this.onLayoutEnd=()=>{},this.ticking=void 0,t&&this.updateCfg(t)}getDefaultCfg(){return{center:[0,0],nodeStrength:null,edgeStrength:null,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10,tick(){},onLayoutEnd(){},workerEnabled:!1}}init(t){const n=this;n.nodes=t.nodes||[];const r=t.edges||[];n.edges=r.map(i=>{const a={},o=["targetNode","sourceNode","startPoint","endPoint"];return Object.keys(i).forEach(s=>{o.indexOf(s)>-1||(a[s]=i[s])}),a}),n.ticking=!1}execute(t){const n=this,r=n.nodes,i=n.edges;if(n.ticking)return;let a=n.forceSimulation;const o=n.alphaMin,s=n.alphaDecay,c=n.alpha;if(a){if(t){if(n.clustering&&n.clusterForce&&(n.clusterForce.nodes(r),n.clusterForce.links(i)),a.nodes(r),i&&n.edgeForce)n.edgeForce.links(i);else if(i&&!n.edgeForce){const f=ks().id(d=>d.id).links(i);n.edgeStrength&&f.strength(n.edgeStrength),n.linkDistance&&f.distance(n.linkDistance),n.edgeForce=f,a.force("link",f)}}n.preventOverlap&&n.overlapProcess(a),a.alpha(c).restart(),this.ticking=!0}else try{const f=ss();if(n.nodeStrength&&f.strength(n.nodeStrength),a=uc().nodes(r),n.clustering){const d=vl();d.centerX(n.center[0]).centerY(n.center[1]).template("force").strength(n.clusterFociStrength),i&&d.links(i),r&&d.nodes(r),d.forceLinkDistance(n.clusterEdgeDistance).forceLinkStrength(n.clusterEdgeStrength).forceCharge(n.clusterNodeStrength).forceNodeSize(n.clusterNodeSize),n.clusterForce=d,a.force("group",d)}if(a.force("center",us(n.center[0],n.center[1])).force("charge",f).alpha(c).alphaDecay(s).alphaMin(o),n.preventOverlap&&n.overlapProcess(a),i){const d=ks().id(h=>h.id).links(i);n.edgeStrength&&d.strength(n.edgeStrength),n.linkDistance&&d.distance(n.linkDistance),n.edgeForce=d,a.force("link",d)}if(n.workerEnabled&&!Tt()&&(n.workerEnabled=!1,console.warn("workerEnabled option is only supported when running in web worker.")),!n.workerEnabled)a.on("tick",()=>{n.tick()}).on("end",()=>{n.ticking=!1,n.onLayoutEnd&&n.onLayoutEnd()}),n.ticking=!0;else{a.stop();const d=Ue(a);for(let h=1;h<=d;h++)a.tick(),postMessage({nodes:r,currentTick:h,totalTicks:d,type:Ye.TICK},void 0);n.ticking=!1}n.forceSimulation=a,n.ticking=!0}catch(f){n.ticking=!1,console.warn(f)}}overlapProcess(t){const n=this,r=n.nodeSize,i=n.nodeSpacing;let a,o;const s=n.collideStrength;if(Z(i)?o=()=>i:vt(i)?o=i:o=()=>0,!r)a=c=>c.size?V(c.size)?(c.size[0]>c.size[1]?c.size[0]:c.size[1])/2+o(c):be(c.size)?(c.size.width>c.size.height?c.size.width:c.size.height)/2+o(c):c.size/2+o(c):10+o(c);else if(vt(r))a=c=>r(c)+o(c);else if(V(r)){const f=(r[0]>r[1]?r[0]:r[1])/2;a=d=>f+o(d)}else if(Z(r)){const c=r/2;a=f=>c+o(f)}else a=()=>10;t.force("collisionForce",fc(a).strength(s))}updateCfg(t){const n=this;n.ticking&&(n.forceSimulation.stop(),n.ticking=!1),n.forceSimulation=null,Object.assign(n,t)}destroy(){const t=this;t.ticking&&(t.forceSimulation.stop(),t.ticking=!1),t.nodes=null,t.edges=null,t.destroyed=!0}}function Ue(e){const t=e.alphaMin(),n=e.alphaTarget(),r=e.alpha(),i=Math.log((t-n)/(r-n))/Math.log(1-e.alphaDecay());return Math.ceil(i)}function Tt(){return typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope}function Lt(e,t,n,r){e.forEach((i,a)=>{e[a].children=[],e[a].parent=[]}),r?t.forEach(i=>{const a=We(i,"source"),o=We(i,"target");let s=0;a&&(s=n[a]);let c=0;o&&(c=n[o]);const f=e[s].children,d=e[c].parent;f.push(e[c].id),d.push(e[s].id)}):t.forEach(i=>{const a=We(i,"source"),o=We(i,"target");let s=0;a&&(s=n[a]);let c=0;o&&(c=n[o]);const f=e[s].children,d=e[c].children;f.push(e[c].id),d.push(e[s].id)})}function nn(e,t,n){const r=n.length;for(let i=0;i<r;i++){const a=We(n[i],"source"),o=We(n[i],"target");if(e.id===a&&t.id===o||t.id===a&&e.id===o)return!0}return!1}function jt(e,t){const n=e.degree,r=t.degree;return n<r?-1:n>r?1:0}class xt extends ar{constructor(t){super();this.radius=null,this.nodeSize=void 0,this.startRadius=null,this.endRadius=null,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0,this.divisions=1,this.ordering=null,this.angleRatio=1,this.nodes=[],this.edges=[],this.nodeMap={},this.degrees=[],this.width=300,this.height=300,this.updateCfg(t)}getDefaultCfg(){return{radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1}}execute(){var t;const n=this,r=n.nodes,i=n.edges,a=r.length;if(a===0){n.onLayoutEnd&&n.onLayoutEnd();return}!n.width&&typeof window!="undefined"&&(n.width=window.innerWidth),!n.height&&typeof window!="undefined"&&(n.height=window.innerHeight),n.center||(n.center=[n.width/2,n.height/2]);const o=n.center;if(a===1){r[0].x=o[0],r[0].y=o[1],n.onLayoutEnd&&n.onLayoutEnd();return}let{radius:s,startRadius:c,endRadius:f}=n;const{divisions:d,startAngle:h,endAngle:v,angleRatio:m,ordering:g,clockwise:_,nodeSpacing:y,nodeSize:E}=n,b=(v-h)/a,A={};r.forEach((Q,re)=>{A[Q.id]=re}),n.nodeMap=A;const C=Ht(r.length,A,i);if(n.degrees=C,y){const Q=$n(10,y),re=$n(10,E);let de=-Infinity;r.forEach(ie=>{const ke=re(ie);de<ke&&(de=ke)});let Ie=0;r.forEach((ie,ke)=>{ke===0?Ie+=de||10:Ie+=(Q(ie)||0)+(de||10)}),s=Ie/(2*Math.PI)}else!s&&!c&&!f?s=n.height>n.width?n.width/2:n.height/2:!c&&f?c=f:c&&!f&&(f=c);const R=b*m;let z=[];g==="topology"?z=n.topologyOrdering():g==="topology-directed"?z=n.topologyOrdering(!0):g==="degree"?z=n.degreeOrdering():z=r;const ee=Math.ceil(a/d);for(let Q=0;Q<a;++Q){let re=s;!re&&c!==null&&f!==null&&(re=c+Q*(f-c)/(a-1)),re||(re=10+Q*100/(a-1));let de=h+Q%ee*R+2*Math.PI/d*Math.floor(Q/ee);_||(de=v-Q%ee*R-2*Math.PI/d*Math.floor(Q/ee)),z[Q].x=o[0]+Math.cos(de)*re,z[Q].y=o[1]+Math.sin(de)*re,z[Q].weight=C[Q].all}return(t=n.onLayoutEnd)===null||t===void 0||t.call(n),{nodes:z,edges:this.edges}}topologyOrdering(t=!1){const n=this,r=n.degrees,i=n.edges,a=n.nodes,o=at(a),s=n.nodeMap,c=[o[0]],f=[a[0]],d=[],h=a.length;d[0]=!0,Lt(o,i,s,t);let v=0;return o.forEach((m,g)=>{if(g!==0)if((g===h-1||r[g].all!==r[g+1].all||nn(c[v],m,i))&&!d[g])c.push(m),f.push(a[s[m.id]]),d[g]=!0,v++;else{const _=c[v].children;let y=!1;for(let b=0;b<_.length;b++){const A=s[_[b]];if(r[A].all===r[g].all&&!d[A]){c.push(o[A]),f.push(a[s[o[A].id]]),d[A]=!0,y=!0;break}}let E=0;for(;!y&&(d[E]||(c.push(o[E]),f.push(a[s[o[E].id]]),d[E]=!0,y=!0),E++,E!==h););}}),f}degreeOrdering(){const t=this,n=t.nodes,r=[],i=t.degrees;return n.forEach((a,o)=>{a.degree=i[o].all,r.push(a)}),r.sort(jt),r}getType(){return"circular"}}const sn=(e,t)=>{if(e!=="next"&&e!=="prev")return t},gn=e=>{e.prev.next=e.next,e.next.prev=e.prev,delete e.next,delete e.prev};class Jn{constructor(){const t={};t.prev=t,t.next=t.prev,this.shortcut=t}dequeue(){const t=this.shortcut,n=t.prev;if(n&&n!==t)return gn(n),n}enqueue(t){const n=this.shortcut;t.prev&&t.next&&gn(t),t.next=n.next,n.next.prev=t,n.next=t,t.prev=n}toString(){const t=[],n=this.shortcut;let r=n.prev;for(;r!==n;)t.push(JSON.stringify(r,sn)),r=r==null?void 0:r.prev;return`[${t.join(", ")}]`}}var Fn;(function(e){e.DEFAULT_EDGE_NAME="\0",e.GRAPH_NODE="\0",e.EDGE_KEY_DELIM=""})(Fn||(Fn={}));function zr(e,t){var n=e.get(t)||0;e.set(t,n+1)}function Pr(e,t){var n=e.get(t);n!==void 0&&(n=n-1,n>0?e.set(t,n):e.delete(t))}function Ar(e,t,n,r){var i=String(t),a=String(n);if(!e&&i>a){var o=i;i=a,a=o}return i+Fn.EDGE_KEY_DELIM+a+Fn.EDGE_KEY_DELIM+(r===void 0?Fn.DEFAULT_EDGE_NAME:r)}function wr(e,t,n,r){var i=String(t),a=String(n),o={v:t,w:n};if(!e&&i>a){var s=o.v;o.v=o.w,o.w=s}return r!==void 0&&(o.name=r),o}function Or(e,t){return Ar(e,t.v,t.w,t.name)}function ti(e){return typeof e=="function"}var Pi=function(t){return t.nodes().map(function(n){var r=t.node(n),i=t.parent(n),a={id:n,value:r,parent:i};return a.value===void 0&&delete a.value,a.parent===void 0&&delete a.parent,a})},Ii=function(t){return t.edges().map(function(n){var r=t.edge(n),i={v:n.v,w:n.w,value:r,name:n.name};return i.name===void 0&&delete i.name,i.value===void 0&&delete i.value,i})},Un=function(t){var n={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:Pi(t),edges:Ii(t),value:t.graph()};return n.value===void 0&&delete n.value,n},ni=function(t){var n=new Lr(t.options);return t.value!==void 0&&n.setGraph(t.value),t.nodes.forEach(function(r){n.setNode(r.id,r.value),r.parent&&n.setParent(r.id,r.parent)}),t.edges.forEach(function(r){n.setEdge(r.v,r.w,r.value,r.name)}),n};function Ei(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function sa(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ei(Object(n),!0).forEach(function(r){ua(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ei(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ua(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function co(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ya(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cs(e,t,n){return t&&ya(e.prototype,t),n&&ya(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var ji={compound:!1,multigraph:!1,directed:!0},Lr=function(){function e(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};co(this,e),this.directed=!0,this.multigraph=!1,this.compound=!1,this.GRAPH_NODE=Fn.GRAPH_NODE,this.label=void 0,this.nodeCountNum=0,this.edgeCountNum=0,this.defaultNodeLabelFn=function(){},this.defaultEdgeLabelFn=function(){},this.parentMap=void 0,this.childrenMap=void 0,this.nodesLabelMap=new Map,this.inEdgesMap=new Map,this.outEdgesMap=new Map,this.predecessorsMap=new Map,this.successorsMap=new Map,this.edgesMap=new Map,this.edgesLabelsMap=new Map,this.isDirected=function(){return t.directed},this.isMultigraph=function(){return t.multigraph},this.isCompound=function(){return t.compound},this.setGraph=function(i){return t.label=i,t},this.graph=function(){return t.label},this.setDefaultNodeLabel=function(i){return ti(i)?t.defaultNodeLabelFn=i:t.defaultNodeLabelFn=function(){return i},t},this.nodeCount=function(){return t.nodeCountNum},this.node=function(i){return t.nodesLabelMap.get(i)},this.nodes=function(){return Array.from(t.nodesLabelMap.keys())},this.sources=function(){return t.nodes().filter(function(i){var a;return!((a=t.inEdgesMap.get(i))===null||a===void 0?void 0:a.size)})},this.sinks=function(){return t.nodes().filter(function(i){var a;return!((a=t.outEdgesMap.get(i))===null||a===void 0?void 0:a.size)})},this.setNodes=function(i,a){return i.map(function(o){return t.setNode(o,a)}),t},this.hasNode=function(i){return t.nodesLabelMap.has(i)},this.checkCompound=function(){if(!t.isCompound())throw new Error("Cannot construct parent-children relations in a non-compound graph")},this.parent=function(i){if(t.isCompound()){var a,o=(a=t.parentMap)===null||a===void 0?void 0:a.get(i);if(o!==t.GRAPH_NODE)return o}},this.removeFromParentsChildList=function(i){var a=t.parentMap.get(i);t.childrenMap.get(a).delete(i)},this.setParent=function(i,a){var o,s;t.checkCompound();for(var c=a===void 0?t.GRAPH_NODE:a,f=t.parent(c);f;){if(i===f)throw new Error("Setting "+a+" as parent of "+i+" would create a cycle");f=t.parent(f)}a&&t.setNode(a),t.setNode(i),t.removeFromParentsChildList(i),(o=t.parentMap)===null||o===void 0||o.set(i,c);var d=t.childrenMap.get(c);return d.set(i,!0),(s=t.childrenMap)===null||s===void 0||s.set(c,d),t},this.children=function(i){var a=i===void 0?t.GRAPH_NODE:i;if(t.isCompound()){var o,s=(o=t.childrenMap)===null||o===void 0?void 0:o.get(a);return s?Array.from(s.keys()):void 0}if(a===t.GRAPH_NODE)return t.nodes();if(i&&t.hasNode(i))return[]},this.predecessors=function(i){var a=t.predecessorsMap.get(i);return a?Array.from(a.keys()):void 0},this.successors=function(i){var a=t.successorsMap.get(i);return a?Array.from(a.keys()):void 0},this.neighbors=function(i){var a;if(!!t.hasNode(i))return Array.from(new Set((a=t.predecessors(i))===null||a===void 0?void 0:a.concat(t.successors(i))))},this.isLeaf=function(i){var a;if(t.isDirected()){var o;return!((o=t.successors(i))===null||o===void 0?void 0:o.length)}return!((a=t.neighbors(i))===null||a===void 0?void 0:a.length)},this.filterNodes=function(i){var a=t.directed,o=t.multigraph,s=t.compound,c=new e({directed:a,multigraph:o,compound:s});if(c.setGraph(t.graph()),t.nodes().forEach(function(d){i(d)&&c.setNode(d,t.node(d))}),t.edges().forEach(function(d){c.hasNode(d.v)&&c.hasNode(d.w)&&c.setEdgeObj(d,t.edge(d))}),s){var f=function(h){for(var v=t.parent(h);v!==void 0&&!c.hasNode(v);)v=t.parent(v);return v};c.nodes().forEach(function(d){c.setParent(d,f(d))})}return c},this.setDefaultEdgeLabel=function(i){return ti(i)?t.defaultEdgeLabelFn=i:t.defaultEdgeLabelFn=function(){return i},t},this.edgeCount=function(){return t.edgeCountNum},this.setEdgeObj=function(i,a){return t.setEdge(i.v,i.w,a,i.name)},this.setPath=function(i,a){return i.reduce(function(o,s){return t.setEdge(o,s,a),s}),t},this.edgeFromArgs=function(i,a,o){return t.edge({v:i,w:a,name:o})},this.edge=function(i){return t.edgesLabelsMap.get(Or(t.isDirected(),i))},this.hasEdge=function(i,a,o){return t.edgesLabelsMap.has(Or(t.isDirected(),{v:i,w:a,name:o}))},this.removeEdgeObj=function(i){var a=i.v,o=i.w,s=i.name;return t.removeEdge(a,o,s)},this.edges=function(){return Array.from(t.edgesMap.values())},this.inEdges=function(i,a){var o=t.inEdgesMap.get(i);if(o)return Array.from(o.values()).filter(function(s){return!a||s.v===a})},this.outEdges=function(i,a){var o=t.outEdgesMap.get(i);if(o)return Array.from(o.values()).filter(function(s){return!a||s.w===a})},this.nodeEdges=function(i,a){var o;if(!!t.hasNode(i))return(o=t.inEdges(i,a))===null||o===void 0?void 0:o.concat(t.outEdges(i,a))},this.toJSON=function(){return Un(t)},this.nodeInDegree=function(i){var a=t.inEdgesMap.get(i);return a?a.size:0},this.nodeOutDegree=function(i){var a=t.outEdgesMap.get(i);return a?a.size:0},this.nodeDegree=function(i){return t.nodeInDegree(i)+t.nodeOutDegree(i)},this.source=function(i){return i.v},this.target=function(i){return i.w};var r=sa(sa({},ji),n);this.compound=r.compound,this.directed=r.directed,this.multigraph=r.multigraph,this.compound&&(this.parentMap=new Map,this.childrenMap=new Map)}return cs(e,[{key:"setNode",value:function(n,r){var i=this.nodesLabelMap,a=this.defaultNodeLabelFn,o=this.isCompound,s=this.parentMap,c=this.childrenMap,f=this.inEdgesMap,d=this.outEdgesMap,h=this.predecessorsMap,v=this.successorsMap;if(i.has(n))return r!==void 0&&i.set(n,r),this;if(i.set(n,r||a(n)),o()){var m;s==null||s.set(n,this.GRAPH_NODE),c==null||c.set(n,new Map),(c==null?void 0:c.has(this.GRAPH_NODE))||c==null||c.set(this.GRAPH_NODE,new Map),c==null||(m=c.get(this.GRAPH_NODE))===null||m===void 0||m.set(n,!0)}return[f,d,h,v].forEach(function(g){return g.set(n,new Map)}),this.nodeCountNum+=1,this}},{key:"removeNode",value:function(n){var r=this;if(this.hasNode(n)){var i=function(y){r.removeEdge(y.v,y.w,y.name)},a=this.inEdgesMap,o=this.outEdgesMap,s=this.predecessorsMap,c=this.successorsMap,f=this.nodesLabelMap;if(this.isCompound()){var d,h,v;this.removeFromParentsChildList(n),(d=this.parentMap)===null||d===void 0||d.delete(n),(h=this.children(n))===null||h===void 0||h.forEach(function(_){return r.setParent(_)}),(v=this.childrenMap)===null||v===void 0||v.delete(n)}var m=a.get(n),g=o.get(n);Array.from(m.values()).forEach(function(_){return i(_)}),Array.from(g.values()).forEach(function(_){return i(_)}),f.delete(n),a.delete(n),o.delete(n),s.delete(n),c.delete(n),this.nodeCountNum-=1}return this}},{key:"setEdge",value:function(n,r,i,a){var o,s,c=wr(this.isDirected(),n,r,a),f=Or(this.isDirected(),c),d=c.v,h=c.w;if(this.edgesLabelsMap.has(f))return this.edgesLabelsMap.set(f,i),this;if(a!==void 0&&!this.isMultigraph())throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(d),this.setNode(h),this.edgesLabelsMap.set(f,i||this.defaultEdgeLabelFn(d,h,a)),Object.freeze(c),this.edgesMap.set(f,c);var v=this.predecessorsMap.get(h),m=this.successorsMap.get(d);return zr(v,d),zr(m,h),(o=this.inEdgesMap.get(h))===null||o===void 0||o.set(f,c),(s=this.outEdgesMap.get(d))===null||s===void 0||s.set(f,c),this.edgeCountNum+=1,this}},{key:"removeEdge",value:function(n,r,i){var a=Ar(this.isDirected(),n,r,i),o=this.edgesMap.get(a);if(o){var s=wr(this.isDirected(),n,r,i),c=s.v,f=s.w;this.edgesLabelsMap.delete(a),this.edgesMap.delete(a);var d=this.predecessorsMap.get(f),h=this.successorsMap.get(c);Pr(d,c),Pr(h,f),this.inEdgesMap.get(f).delete(a),this.outEdgesMap.get(c).delete(a),this.edgeCountNum-=1}return this}}]),e}();Lr.fromJSON=ni;function fo(e){return fo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fo(e)}function Fs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fs(e,t,n){return t&&Qi(e.prototype,t),n&&Qi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ba(){return typeof Reflect!="undefined"&&Reflect.get?Ba=Reflect.get:Ba=function(t,n,r){var i=_a(t,n);if(!!i){var a=Object.getOwnPropertyDescriptor(i,n);return a.get?a.get.call(arguments.length<3?t:r):a.value}},Ba.apply(this,arguments)}function _a(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Xn(e),e!==null););return e}function ca(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Hi(e,t)}function Hi(e,t){return Hi=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Hi(e,t)}function za(e){var t=Ea();return function(){var r=Xn(e),i;if(t){var a=Xn(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return gr(this,i)}}function gr(e,t){if(t&&(fo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qn(e)}function qn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ea(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Xn(e){return Xn=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},Xn(e)}var sr=null;function fi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ui(e,t,n){return t&&fi(e.prototype,t),n&&fi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ea(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Gr=Ui(function e(){var t=this;ea(this,e),this.arr=[],this.keyIndice=new Map,this.size=function(){return t.arr.length},this.keys=function(){return t.arr.map(function(n){return n.key})},this.has=function(n){return t.keyIndice.has(n)},this.priority=function(n){var r=t.keyIndice.get(n);if(r!==void 0)return t.arr[r].priority},this.swap=function(n,r){var i=t.arr,a=t.keyIndice,o=[i[n],i[r]],s=o[0],c=o[1];i[n]=c,i[r]=s,a.set(s.key,r),a.set(c.key,n)},this.innerDecrease=function(n){for(var r=t.arr,i=r[n].priority,a,o=n;o!==0;){var s;if(a=o>>1,((s=r[a])===null||s===void 0?void 0:s.priority)<i)break;t.swap(o,a),o=a}},this.heapify=function(n){var r=t.arr,i=n<<1,a=i+1,o=n;i<r.length&&(o=r[i].priority<r[o].priority?i:o,a<r.length&&(o=r[a].priority<r[o].priority?a:o),o!==n&&(t.swap(n,o),t.heapify(o)))},this.min=function(){if(t.size()===0)throw new Error("Queue underflow");return t.arr[0].key},this.add=function(n,r){var i=t.keyIndice,a=t.arr;if(!i.has(n)){var o=a.length;return i.set(n,o),a.push({key:n,priority:r}),t.innerDecrease(o),!0}return!1},this.removeMin=function(){t.swap(0,t.arr.length-1);var n=t.arr.pop();return t.keyIndice.delete(n.key),t.heapify(0),n.key},this.decrease=function(n,r){if(!t.has(n))throw new Error("There's no key named ".concat(n));var i=t.keyIndice.get(n);if(r>t.arr[i].priority)throw new Error("New priority is greater than current priority.Key: ".concat(n," Old: + ").concat(t.arr[i].priority," New: ").concat(r));t.arr[i].priority=r,t.innerDecrease(i)}}),Na=function(t,n){var r=new Lr,i=new Map,a=new Gr,o;function s(d){var h=d.v===o?d.w:d.v,v=a.priority(h);if(v!==void 0){var m=n(d);m<v&&(i.set(h,o),a.decrease(h,m))}}if(t.nodeCount()===0)return r;t.nodes().forEach(function(d){a.add(d,Number.POSITIVE_INFINITY),r.setNode(d)}),a.decrease(t.nodes()[0],0);for(var c=!1;a.size()>0;){var f;if(o=a.removeMin(),i.has(o))r.setEdge(o,i.get(o));else{if(c)throw new Error("Input graph is not connected: "+t.graph());c=!0}(f=t.nodeEdges(o))===null||f===void 0||f.forEach(s)}return r},Wr=Na,fa=function(t){var n=new Set,r=[],i=t.nodes();return i.forEach(function(a){for(var o=[],s=[a];s.length>0;){var c=s.pop();if(!n.has(c)){var f,d;n.add(c),o.push(c),(f=t.successors(c))===null||f===void 0||f.forEach(function(h){return s.push(h)}),(d=t.predecessors(c))===null||d===void 0||d.forEach(function(h){return s.push(h)})}}o.length&&r.push(o)}),r},Go=fa,Eu=function e(t,n,r,i,a,o){i.includes(n)||(i.push(n),r||o.push(n),a(n).forEach(function(s){return e(t,s,r,i,a,o)}),r&&o.push(n))},la=function(t,n,r){var i=Array.isArray(n)?n:[n],a=function(f){return t.isDirected()?t.successors(f):t.neighbors(f)},o=[],s=[];return i.forEach(function(c){if(t.hasNode(c))Eu(t,c,r==="post",s,a,o);else throw new Error("Graph does not have node: "+c)}),o},Ci=la;function Ri(e,t){return rr(e)||On(e,t)||xr(e,t)||In()}function In(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xr(e,t){if(!!e){if(typeof e=="string")return vr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vr(e,t)}}function vr(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function On(e,t){var n=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r=[],i=!0,a=!1,o,s;try{for(n=n.call(e);!(i=(o=n.next()).done)&&(r.push(o.value),!(t&&r.length===t));i=!0);}catch(c){a=!0,s=c}finally{try{!i&&n.return!=null&&n.return()}finally{if(a)throw s}}return r}}function rr(e){if(Array.isArray(e))return e}var ur=function(){return 1},dr=function(t,n,r,i){return kr(t,n,r||ur,i||function(a){return t.outEdges(a)})},kr=function(t,n,r,i){var a=new Map,o=new Gr,s,c,f=function(v){var m=v.v!==s?v.v:v.w,g=a.get(m),_=r(v),y=c.distance+_;if(_<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+v+" Weight: "+_);y<g.distance&&(g.distance=y,g.predecessor=s,o.decrease(m,y))};for(t.nodes().forEach(function(h){var v=h===n?0:Number.POSITIVE_INFINITY;a.set(h,{distance:v}),o.add(h,v)});o.size()>0&&(s=o.removeMin(),c=a.get(s),!(c&&c.distance===Number.POSITIVE_INFINITY));)i(s).forEach(f);var d={};return Array.from(a.entries()).forEach(function(h){var v=Ri(h,2),m=v[0],g=v[1];return d[String(m)]=g,d}),d},Rr=dr,dc=function(t,n,r){var i={};return t.nodes().forEach(function(a){return i[String(a)]=Rr(t,a,n,r),i}),i},ls=dc,hc=function(t){var n=0,r=[],i=new Map,a=[];function o(s){var c,f={onStack:!0,lowlink:n,index:n};if(i.set(s,f),n+=1,r.push(s),(c=t.successors(s))===null||c===void 0||c.forEach(function(m){var g;if(i.has(m)){if((g=i.get(m))===null||g===void 0?void 0:g.onStack){var y=i.get(m);f.lowlink=Math.min(f.lowlink,y.index)}}else{o(m);var _=i.get(m);f.lowlink=Math.min(f.lowlink,_.lowlink)}}),f.lowlink===f.index){var d=[],h;do{h=r.pop();var v=i.get(h);v.onStack=!1,d.push(h)}while(s!==h);a.push(d)}}return t.nodes().forEach(function(s){i.has(s)||o(s)}),a},uf=hc,$r=function(t){return uf(t).filter(function(n){return n.length>1||n.length===1&&t.hasEdge(n[0],n[0])})},ko=$r;function Mr(e){return Mr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mr(e)}function pl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ml(e,t,n){return t&&pl(e.prototype,t),n&&pl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function lo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gl(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fo(e,t)}function cf(e){var t=wu();return function(){var r=vs(e),i;if(t){var a=vs(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return ds(this,i)}}function ds(e,t){if(t&&(Mr(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bu(e)}function bu(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wa(e){var t=typeof Map=="function"?new Map:void 0;return Wa=function(r){if(r===null||!yl(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t!="undefined"){if(t.has(r))return t.get(r);t.set(r,i)}function i(){return hs(r,arguments,vs(this).constructor)}return i.prototype=Object.create(r.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Fo(i,r)},Wa(e)}function hs(e,t,n){return wu()?hs=Reflect.construct:hs=function(i,a,o){var s=[null];s.push.apply(s,a);var c=Function.bind.apply(i,s),f=new c;return o&&Fo(f,o.prototype),f},hs.apply(null,arguments)}function wu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function yl(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function Fo(e,t){return Fo=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Fo(e,t)}function vs(e){return vs=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},vs(e)}var ff=function(e){gl(n,e);var t=cf(n);function n(){return lo(this,n),t.apply(this,arguments)}return ml(n)}(Wa(Error));function Fh(e){var t=new Set,n=new Set,r=[];function i(a){if(n.has(a))throw new ff;if(!t.has(a)){var o;n.add(a),t.add(a),(o=e.predecessors(a))===null||o===void 0||o.forEach(i),n.delete(a),r.push(a)}}if(e.sinks().forEach(i),t.size!==e.nodeCount())throw new ff;return r}var lf=Fh,_l=function(t){try{lf(t)}catch(n){if(n instanceof ff)return!1;throw n}return!0},El=_l,vc=function(t,n){return Ci(t,n,"post")},ta=vc,pc=function(t,n){return Ci(t,n,"pre")},ho=pc,df=function(){return 1};function hf(e,t,n){return bl(e,t||df,n||function(r){return e.outEdges(r)})}function bl(e,t,n){var r={},i=e.nodes();return i.forEach(function(a){var o=String(a);r[o]={},r[o][o]={distance:0},i.forEach(function(s){a!==s&&(r[o][String(s)]={distance:Number.POSITIVE_INFINITY})}),n(a).forEach(function(s){var c=s.v===a?s.w:s.v,f=t(s);r[o][String(c)]={distance:f,predecessor:a}})}),i.forEach(function(a){var o=String(a),s=r[o];i.forEach(function(c){var f=String(c),d=r[f];i.forEach(function(h){var v=String(h),m=d[o],g=s[v],_=d[v],y=m.distance+g.distance;y<_.distance&&(_.distance=y,_.predecessor=g.predecessor)})})}),r}var wl=hf;function sd(e,t){return ld(e)||fd(e,t)||cd(e,t)||ud()}function ud(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cd(e,t){if(!!e){if(typeof e=="string")return ps(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ps(e,t)}}function ps(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fd(e,t){var n=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r=[],i=!0,a=!1,o,s;try{for(n=n.call(e);!(i=(o=n.next()).done)&&(r.push(o.value),!(t&&r.length===t));i=!0);}catch(c){a=!0,s=c}finally{try{!i&&n.return!=null&&n.return()}finally{if(a)throw s}}return r}}function ld(e){if(Array.isArray(e))return e}function xl(e){return e instanceof Graph}function dd(e){if(e.isMultigraph())return!1;for(var t=e.edges(),n=new Map,r=0;r<t.length;r++){var i=t[r];if(i.v===i.w)return!1;var a=[i.v,i.w].sort(),o=sd(a,2),s=o[0],c=o[1],f="".concat(s,"-").concat(c);if(n.has(f))return!1;n.set(f,!0)}return!0}function Da(e){return e.nodes().length===0}function mc(e){for(var t=e.edges(),n=0;n<t.length;n++){var r=t[n];if(r.v===r.w)return!0}return!1}var hd=function(t,n){if(!isSimpleGraph(t)||!isSimpleGraph(n)||!containAllSameNodes(t,n)||containSameEdges(t,n))return!1;var r=t.nodeCount();return t.edgeCount()+n.edgeCount()===r*(r-1)/2},vf=function(t){if(!isSimpleGraph(t))return null;for(var n=t.nodeCount(),r=new Graph({compound:t.isCompound(),directed:t.isDirected(),multigraph:t.isMultigraph()}),i=t.nodes(),a=0;a<n;a++){var o=i[a];r.setNode(o,t.node(o));for(var s=a+1;s<n;s++){var c=i[s];t.hasEdge(o,c)||r.setEdge(o,c)}}return r};class Uh extends Jn{}class xu extends Lr{}const Va=()=>1,pf=(e,t)=>{var n;if(e.nodeCount()<=1)return[];const r=zh(e,t||Va);return(n=Bh(r.graph,r.buckets,r.zeroIdx).map(a=>e.outEdges(a.v,a.w)))===null||n===void 0?void 0:n.flat()},Bh=(e,t,n)=>{let r=[];const i=t[t.length-1],a=t[0];let o;for(;e.nodeCount();){for(;o=a.dequeue();)Sl(e,t,n,o);for(;o=i.dequeue();)Sl(e,t,n,o);if(e.nodeCount()){for(let s=t.length-2;s>0;--s)if(o=t[s].dequeue(),o){r=r.concat(Sl(e,t,n,o,!0));break}}}return r},Sl=(e,t,n,r,i)=>{var a,o;const s=[];return(a=e.inEdges(r.v))===null||a===void 0||a.forEach(c=>{const f=e.edge(c),d=e.node(c.v);i&&s.push({v:c.v,w:c.w,in:0,out:0}),d.out===void 0&&(d.out=0),d.out-=f,gc(t,n,d)}),(o=e.outEdges(r.v))===null||o===void 0||o.forEach(c=>{const f=e.edge(c),d=c.w,h=e.node(d);h.in===void 0&&(h.in=0),h.in-=f,gc(t,n,h)}),e.removeNode(r.v),i?s:void 0},zh=(e,t)=>{const n=new xu;let r=0,i=0;e.nodes().forEach(c=>{n.setNode(c,{v:c,in:0,out:0})}),e.edges().forEach(c=>{const f=n.edge(c)||0,d=(t==null?void 0:t(c))||1,h=f+d;n.setEdge(c.v,c.w,h),i=Math.max(i,n.node(c.v).out+=d),r=Math.max(r,n.node(c.w).in+=d)});const a=[],o=i+r+3;for(let c=0;c<o;c++)a.push(new Uh);const s=r+1;return n.nodes().forEach(c=>{gc(a,s,n.node(c))}),{buckets:a,zeroIdx:s,graph:n}},gc=(e,t,n)=>{n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)};var Wh=pf;const Su=e=>{const t=r=>i=>{var a;return((a=r.edge(i))===null||a===void 0?void 0:a.weight)||1},n=e.graph().acyclicer==="greedy"?Wh(e,t(e)):me(e);n==null||n.forEach(r=>{const i=e.edge(r);e.removeEdgeObj(r),i.forwardName=r.name,i.reversed=!0,e.setEdge(r.w,r.v,i,`rev-${Math.random()}`)})},me=e=>{const t=[],n={},r={},i=a=>{var o;r[a]||(r[a]=!0,n[a]=!0,(o=e.outEdges(a))===null||o===void 0||o.forEach(s=>{n[s.w]?t.push(s):i(s.w)}),delete n[a])};return e.nodes().forEach(i),t};var Pe={run:Su,undo:e=>{e.edges().forEach(t=>{const n=e.edge(t);if(n.reversed){e.removeEdgeObj(t);const r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}};class Bt extends Lr{}const Nn=(e,t)=>Number(e)-Number(t),cr=(e,t,n,r)=>{let i;do i=`${r}${Math.random()}`;while(e.hasNode(i));return n.dummy=t,e.setNode(i,n),i},Yr=e=>{const t=new Bt().setGraph(e.graph());return e.nodes().forEach(n=>{t.setNode(n,e.node(n))}),e.edges().forEach(n=>{const r=t.edgeFromArgs(n.v,n.w)||{weight:0,minlen:1},i=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})}),t},yr=e=>{const t=new Bt({multigraph:e.isMultigraph()}).setGraph(e.graph());return e.nodes().forEach(n=>{var r;((r=e.children(n))===null||r===void 0?void 0:r.length)||t.setNode(n,e.node(n))}),e.edges().forEach(n=>{t.setEdgeObj(n,e.edge(n))}),t},mf=(e,t)=>e==null?void 0:e.reduce((n,r,i)=>(n[r]=t[i],n),{}),ip=e=>{const t={};return e.nodes().forEach(n=>{var r;const i={};(r=e.outEdges(n))===null||r===void 0||r.forEach(a=>{var o;i[a.w]=(i[a.w]||0)+(((o=e.edge(a))===null||o===void 0?void 0:o.weight)||0)}),t[n]=i}),t},Za=e=>{const t=e.nodes(),n=t.map(r=>{var i;const a={};return(i=e.inEdges(r))===null||i===void 0||i.forEach(o=>{a[o.v]=(a[o.v]||0)+e.edge(o).weight}),a});return mf(t,n)},yc=(e,t)=>{const n=Number(e.x),r=Number(e.y),i=Number(t.x)-n,a=Number(t.y)-r;let o=Number(e.width)/2,s=Number(e.height)/2;if(!i&&!a)return{x:0,y:0};let c,f;return Math.abs(a)*o>Math.abs(i)*s?(a<0&&(s=-s),c=s*i/a,f=s):(i<0&&(o=-o),c=o,f=o*a/i),{x:n+c,y:r+f}},Tu=e=>{const t=[],n=Wn(e)+1;for(let r=0;r<n;r++)t.push([]);e.nodes().forEach(r=>{const a=e.node(r).rank;a!==void 0&&t[a]&&t[a].push(r)});for(let r=0;r<n;r++)t[r]=t[r].sort((i,a)=>{var o,s;return Nn((o=e.node(i))===null||o===void 0?void 0:o.order,(s=e.node(a))===null||s===void 0?void 0:s.order)});return t},vo=e=>{const t=e.nodes().filter(r=>{var i;return((i=e.node(r))===null||i===void 0?void 0:i.rank)!==void 0}).map(r=>e.node(r).rank),n=Math.min(...t);e.nodes().forEach(r=>{const i=e.node(r);i.hasOwnProperty("rank")&&n!==Infinity&&(i.rank-=n)})},gf=e=>{const t=e.nodes(),n=t.filter(s=>{var c;return((c=e.node(s))===null||c===void 0?void 0:c.rank)!==void 0}).map(s=>e.node(s).rank),r=Math.min(...n),i=[];t.forEach(s=>{var c;const f=(((c=e.node(s))===null||c===void 0?void 0:c.rank)||0)-r;i[f]||(i[f]=[]),i[f].push(s)});let a=0;const o=e.graph().nodeRankFactor||0;for(let s=0;s<i.length;s++){const c=i[s];c===void 0?s%o!=0&&(a-=1):a&&(c==null||c.forEach(f=>{const d=e.node(f);d&&(d.rank=d.rank||0,d.rank+=a)}))}},ms=(e,t,n,r)=>{const i={width:0,height:0};return Z(n)&&Z(r)&&(i.rank=n,i.order=r),cr(e,"border",i,t)},Wn=e=>{let t;return e.nodes().forEach(n=>{var r;const i=(r=e.node(n))===null||r===void 0?void 0:r.rank;i!==void 0&&(t===void 0||i>t)&&(t=i)}),t||(t=0),t},Au=(e,t)=>{const n={lhs:[],rhs:[]};return e==null||e.forEach(r=>{t(r)?n.lhs.push(r):n.rhs.push(r)}),n},yf=(e,t)=>{const n=Date.now();try{return t()}finally{console.log(`${e} time: ${Date.now()-n}ms`)}},Iu=(e,t)=>t(),_f=(e,t)=>e.reduce((n,r)=>{const i=t(n),a=t(r);return i>a?r:n}),vd=e=>{e.graph().dummyChains=[],e.edges().forEach(t=>pd(e,t))},pd=(e,t)=>{let n=t.v,r=e.node(n).rank;const i=t.w,a=e.node(i).rank,o=t.name,s=e.edge(t),c=s.labelRank;if(a===r+1)return;e.removeEdgeObj(t);const f=e.graph();let d,h,v;for(v=0,++r;r<a;++v,++r)s.points=[],h={edgeLabel:s,width:0,height:0,edgeObj:t,rank:r},d=cr(e,"edge",h,"_d"),r===c&&(h.width=s.width,h.height=s.height,h.dummy="edge-label",h.labelpos=s.labelpos),e.setEdge(n,d,{weight:s.weight},o),v===0&&(f.dummyChains||(f.dummyChains=[]),f.dummyChains.push(d)),n=d;e.setEdge(n,i,{weight:s.weight},o)};var Uo={run:vd,undo:e=>{var t;(t=e.graph().dummyChains)===null||t===void 0||t.forEach(n=>{let r=e.node(n);const i=r.edgeLabel;let a;r.edgeObj&&e.setEdgeObj(r.edgeObj,i);let o=n;for(;r.dummy;)a=e.successors(o)[0],e.removeNode(o),i.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height),o=a,r=e.node(o)})}};const ja=e=>{var t;const n={},r=i=>{var a;const o=e.node(i);if(n[i])return o.rank;n[i]=!0;let s;return(a=e.outEdges(i))===null||a===void 0||a.forEach(c=>{const f=r(c.w),d=e.edge(c).minlen,h=f-d;h&&(s===void 0||h<s)&&(s=h)}),s||(s=0),o.rank=s,s};(t=e.sources())===null||t===void 0||t.forEach(i=>r(i))},bi=e=>{var t;const n={};let r;const i=o=>{var s;const c=e.node(o);if(n[o])return c.rank;n[o]=!0;let f;return(s=e.outEdges(o))===null||s===void 0||s.forEach(d=>{const h=i(d.w),v=e.edge(d).minlen,m=h-v;m&&(f===void 0||m<f)&&(f=m)}),f||(f=0),(r===void 0||f<r)&&(r=f),c.rank=f,f};(t=e.sources())===null||t===void 0||t.forEach(o=>i(o)),r===void 0&&(r=0);const a=(o,s)=>{var c;const f=e.node(o),d=isNaN(f.layer)?s:f.layer;(f.rank===void 0||f.rank<d)&&(f.rank=d),(c=e.outEdges(o))===null||c===void 0||c.map(h=>{a(h.w,d+e.edge(h).minlen)})};e.nodes().forEach(o=>{const s=e.node(o);isNaN(s.layer)?s.rank-=r:a(o,s.layer)})},ba=(e,t)=>e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen;var md={longestPath:ja,longestPathWithLayer:bi,slack:ba};const Bo=e=>{const t=new Bt({directed:!1}),n=e.nodes()[0],r=e.nodeCount();t.setNode(n,{});let i,a;for(;_c(t,e)<r;)i=gs(t,e),a=t.hasNode(i.v)?ba(e,i):-ba(e,i),bc(t,e,a);return t},_c=(e,t)=>{const n=r=>{t.nodeEdges(r).forEach(i=>{const a=i.v,o=r===a?i.w:a;!e.hasNode(o)&&!ba(t,i)&&(e.setNode(o,{}),e.setEdge(r,o,{}),n(o))})};return e.nodes().forEach(n),e.nodeCount()},bf=e=>{const t=new Bt({directed:!1}),n=e.nodes()[0],r=e.nodeCount();t.setNode(n,{});let i,a;for(;Ec(t,e)<r;)i=gs(t,e),a=t.hasNode(i.v)?ba(e,i):-ba(e,i),bc(t,e,a);return t},Ec=(e,t)=>{const n=r=>{var i;(i=t.nodeEdges(r))===null||i===void 0||i.forEach(a=>{const o=a.v,s=r===o?a.w:o;!e.hasNode(s)&&(t.node(s).layer!==void 0||!ba(t,a))&&(e.setNode(s,{}),e.setEdge(r,s,{}),n(s))})};return e.nodes().forEach(n),e.nodeCount()},gs=(e,t)=>_f(t.edges(),n=>e.hasNode(n.v)!==e.hasNode(n.w)?ba(t,n):Infinity),bc=(e,t,n)=>{e.nodes().forEach(r=>{t.node(r).rank||(t.node(r).rank=0),t.node(r).rank+=n})};var ap={feasibleTree:Bo,feasibleTreeWithLayer:bf};const{preorder:Tl,postorder:gd}=N,wf=e=>{const t=Yr(e);ja(t);const n=Bo(t);Ru(n),Cu(n,t);let r,i;for(;r=ys(n);)i=li(n,t,r),Bi(n,t,r,i)},Cu=(e,t)=>{let n=gd(e,e.nodes());n=n==null?void 0:n.slice(0,(n==null?void 0:n.length)-1),n==null||n.forEach(r=>{xf(e,t,r)})},xf=(e,t,n)=>{const i=e.node(n).parent;e.edgeFromArgs(n,i).cutvalue=Vh(e,t,n)},Vh=(e,t,n)=>{var r;const a=e.node(n).parent;let o=!0,s=t.edgeFromArgs(n,a),c=0;return s||(o=!1,s=t.edgeFromArgs(a,n)),c=s.weight,(r=t.nodeEdges(n))===null||r===void 0||r.forEach(f=>{const d=f.v===n,h=d?f.w:f.v;if(h!==a){const v=d===o,m=t.edge(f).weight;if(c+=v?m:-m,Ed(e,n,h)){const g=e.edgeFromArgs(n,h).cutvalue;c+=v?-g:g}}}),c},Ru=(e,t=e.nodes()[0])=>{yd(e,{},1,t)},yd=(e,t,n,r,i)=>{var a;const o=n;let s=n;const c=e.node(r);return t[r]=!0,(a=e.neighbors(r))===null||a===void 0||a.forEach(f=>{t[f]||(s=yd(e,t,s,f,r))}),c.low=o,c.lim=s++,i?c.parent=i:delete c.parent,s},ys=e=>e.edges().find(t=>e.edge(t).cutvalue<0),li=(e,t,n)=>{let r=n.v,i=n.w;t.hasEdge(r,i)||(r=n.w,i=n.v);const a=e.node(r),o=e.node(i);let s=a,c=!1;a.lim>o.lim&&(s=o,c=!0);const f=t.edges().filter(d=>c===Sf(e,e.node(d.v),s)&&c!==Sf(e,e.node(d.w),s));return _f(f,d=>ba(t,d))},Bi=(e,t,n,r)=>{const i=n.v,a=n.w;e.removeEdge(i,a),e.setEdge(r.v,r.w,{}),Ru(e),Cu(e,t),_d(e,t)},_d=(e,t)=>{const n=e.nodes().find(i=>{var a;return!((a=t.node(i))===null||a===void 0?void 0:a.parent)});let r=Tl(e,n);r=r==null?void 0:r.slice(1),r==null||r.forEach(i=>{const a=e.node(i).parent;let o=t.edgeFromArgs(i,a),s=!1;o||(o=t.edgeFromArgs(a,i),s=!0),t.node(i).rank=t.node(a).rank+(s?o.minlen:-o.minlen)})},Ed=(e,t,n)=>e.hasEdge(t,n),Sf=(e,t,n)=>n.low<=t.lim&&t.lim<=n.lim;var bd=wf;const Tf=e=>{switch(e.graph().ranker){case"network-simplex":Us(e);break;case"tight-tree":wc(e);break;case"longest-path":Mu(e);break;default:wc(e)}},Mu=ja,wc=e=>{bi(e),bf(e)},Us=e=>{bd(e)};var na=Tf;const Nu=e=>{var t;const n={};let r=0;const i=a=>{var o;const s=r;(o=e.children(a))===null||o===void 0||o.forEach(i),n[a]={low:s,lim:r++}};return(t=e.children())===null||t===void 0||t.forEach(i),n},Af=(e,t,n,r)=>{const i=[],a=[],o=Math.min(t[n].low,t[r].low),s=Math.max(t[n].lim,t[r].lim);let c,f;c=n;do c=e.parent(c),i.push(c);while(c&&(t[c].low>o||s>t[c].lim));for(f=c,c=r;c&&c!==f;)a.push(c),c=e.parent(c);return{lca:f,path:i.concat(a.reverse())}};var Al=e=>{var t;const n=Nu(e);(t=e.graph().dummyChains)===null||t===void 0||t.forEach(r=>{var i,a;let o=r,s=e.node(o);const c=s.edgeObj;if(!c)return;const f=Af(e,n,c.v,c.w),d=f.path,h=f.lca;let v=0,m=d[v],g=!0;for(;o!==c.w;){if(s=e.node(o),g){for(;m!==h&&((i=e.node(m))===null||i===void 0?void 0:i.maxRank)<s.rank;)v++,m=d[v];m===h&&(g=!1)}if(!g){for(;v<d.length-1&&((a=e.node(d[v+1]))===null||a===void 0?void 0:a.minRank)<=s.rank;)v++;m=d[v]}e.setParent(o,m),o=e.successors(o)[0]}})};const Bs=e=>{var t;const n=cr(e,"root",{},"_root"),r=wd(e);let i=Math.max(...Object.values(r));Math.abs(i)===Infinity&&(i=1);const a=i-1,o=2*a+1;e.graph().nestingRoot=n,e.edges().forEach(c=>{e.edge(c).minlen*=o});const s=xd(e)+1;(t=e.children())===null||t===void 0||t.forEach(c=>{xc(e,n,o,s,a,r,c)}),e.graph().nodeRankFactor=o},xc=(e,t,n,r,i,a,o)=>{const s=e.children(o);if(!(s==null?void 0:s.length)){o!==t&&e.setEdge(t,o,{weight:0,minlen:n});return}const c=ms(e,"_bt"),f=ms(e,"_bb"),d=e.node(o);e.setParent(c,o),d.borderTop=c,e.setParent(f,o),d.borderBottom=f,s==null||s.forEach(h=>{xc(e,t,n,r,i,a,h);const v=e.node(h),m=v.borderTop?v.borderTop:h,g=v.borderBottom?v.borderBottom:h,_=v.borderTop?r:2*r,y=m!==g?1:i-a[o]+1;e.setEdge(c,m,{minlen:y,weight:_,nestingEdge:!0}),e.setEdge(g,f,{minlen:y,weight:_,nestingEdge:!0})}),e.parent(o)||e.setEdge(t,c,{weight:0,minlen:i+a[o]})},wd=e=>{var t;const n={},r=(i,a)=>{const o=e.children(i);o==null||o.forEach(s=>r(s,a+1)),n[i]=a};return(t=e.children())===null||t===void 0||t.forEach(i=>r(i,1)),n},xd=e=>{let t=0;return e.edges().forEach(n=>{t+=e.edge(n).weight}),t};var zs={run:Bs,cleanup:e=>{const t=e.graph();t.nestingRoot&&e.removeNode(t.nestingRoot),delete t.nestingRoot,e.edges().forEach(n=>{e.edge(n).nestingEdge&&e.removeEdgeObj(n)})}};const Il=e=>{var t;const n=r=>{const i=e.children(r),a=e.node(r);if((i==null?void 0:i.length)&&i.forEach(o=>n(o)),a.hasOwnProperty("minRank")){a.borderLeft=[],a.borderRight=[];for(let o=a.minRank,s=a.maxRank+1;o<s;o+=1)P(e,"borderLeft","_bl",r,a,o),P(e,"borderRight","_br",r,a,o)}};(t=e.children())===null||t===void 0||t.forEach(r=>n(r))},P=(e,t,n,r,i,a)=>{const o={rank:a,borderType:t,width:0,height:0},s=i[t][a-1],c=cr(e,"border",o,n);i[t][a]=c,e.setParent(c,r),s&&e.setEdge(s,c,{weight:1})};var Du=Il;const Cf=e=>{var t;const n=(t=e.graph().rankdir)===null||t===void 0?void 0:t.toLowerCase();(n==="lr"||n==="rl")&&ir(e)},Pa=e=>{var t;const n=(t=e.graph().rankdir)===null||t===void 0?void 0:t.toLowerCase();(n==="bt"||n==="rl")&&Zh(e),(n==="lr"||n==="rl")&&(_s(e),ir(e))},ir=e=>{e.nodes().forEach(t=>{Sd(e.node(t))}),e.edges().forEach(t=>{Sd(e.edge(t))})},Sd=e=>{const t=e.width;e.width=e.height,e.height=t},Zh=e=>{e.nodes().forEach(t=>{Rf(e.node(t))}),e.edges().forEach(t=>{var n;const r=e.edge(t);(n=r.points)===null||n===void 0||n.forEach(i=>Rf(i)),r.hasOwnProperty("y")&&Rf(r)})},Rf=e=>{(e==null?void 0:e.y)&&(e.y=-e.y)},_s=e=>{e.nodes().forEach(t=>{Cl(e.node(t))}),e.edges().forEach(t=>{var n;const r=e.edge(t);(n=r.points)===null||n===void 0||n.forEach(i=>Cl(i)),r.hasOwnProperty("x")&&Cl(r)})},Cl=e=>{const t=e.x;e.x=e.y,e.y=t};var Td={adjust:Cf,undo:Pa},Sc=e=>{const t={},n=e.nodes().filter(d=>{var h;return!((h=e.children(d))===null||h===void 0?void 0:h.length)}),r=n.map(d=>e.node(d).rank),i=Math.max(...r),a=[];for(let d=0;d<i+1;d++)a.push([]);const o=d=>{var h;if(t.hasOwnProperty(d))return;t[d]=!0;const v=e.node(d);isNaN(v.rank)||a[v.rank].push(d),(h=e.successors(d))===null||h===void 0||h.forEach(m=>o(m))},s=n.sort((d,h)=>e.node(d).rank-e.node(h).rank),f=s.filter(d=>e.node(d).fixorder!==void 0).sort((d,h)=>e.node(d).fixorder-e.node(h).fixorder);return f==null||f.forEach(d=>{isNaN(e.node(d).rank)||a[e.node(d).rank].push(d),t[d]=!0}),s==null||s.forEach(o),a};const jh=(e,t,n)=>{const r=mf(n,n.map((d,h)=>h)),a=t.map(d=>{var h;const v=(h=e.outEdges(d))===null||h===void 0?void 0:h.map(m=>({pos:r[m.w]||0,weight:e.edge(m).weight}));return v==null?void 0:v.sort((m,g)=>m.pos-g.pos)}).flat().filter(d=>d!==void 0);let o=1;for(;o<n.length;)o<<=1;const s=2*o-1;o-=1;const c=Array(s).fill(0,0,s);let f=0;return a==null||a.forEach(d=>{if(d){let h=d.pos+o;c[h]+=d.weight;let v=0;for(;h>0;)h%2&&(v+=c[h+1]),h=h-1>>1,c[h]+=d.weight;f+=d.weight*v}}),f};var Id=(e,t)=>{let n=0;for(let r=1;r<(t==null?void 0:t.length);r+=1)n+=jh(e,t[r-1],t[r]);return n};const Hh=(e,t,n)=>{const r=Xh(e),i=new Bt({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(a=>e.node(a));return e.nodes().forEach(a=>{var o;const s=e.node(a),c=e.parent(a);(s.rank===t||s.minRank<=t&&t<=s.maxRank)&&(i.setNode(a),i.setParent(a,c||r),(o=e[n](a))===null||o===void 0||o.forEach(f=>{const d=f.v===a?f.w:f.v,h=i.edgeFromArgs(d,a),v=h!==void 0?h.weight:0;i.setEdge(d,a,{weight:e.edge(f).weight+v})}),s.hasOwnProperty("minRank")&&i.setNode(a,{borderLeft:s.borderLeft[t],borderRight:s.borderRight[t]}))}),i},Xh=e=>{let t;for(;e.hasNode(t=`_root${Math.random()}`););return t};var Cd=Hh,zo=(e,t,n)=>{const r={};let i;n==null||n.forEach(a=>{let o=e.parent(a),s,c;for(;o;){if(s=e.parent(o),s?(c=r[s],r[s]=o):(c=i,i=o),c&&c!==o){t.setEdge(c,o);return}o=s}})},$h=(e,t)=>t.map(n=>{const r=e.inEdges(n);if(!(r==null?void 0:r.length))return{v:n};{const i={sum:0,weight:0};return r==null||r.forEach(a=>{const o=e.edge(a),s=e.node(a.v);i.sum+=o.weight*s.order,i.weight+=o.weight}),{v:n,barycenter:i.sum/i.weight,weight:i.weight}}});const Yh=(e,t)=>{var n,r,i;const a={};e==null||e.forEach((s,c)=>{a[s.v]={i:c,indegree:0,in:[],out:[],vs:[s.v]};const f=a[s.v];s.barycenter!==void 0&&(f.barycenter=s.barycenter,f.weight=s.weight)}),(n=t.edges())===null||n===void 0||n.forEach(s=>{const c=a[s.v],f=a[s.w];c!==void 0&&f!==void 0&&(f.indegree++,c.out.push(a[s.w]))});const o=(i=(r=Object.values(a)).filter)===null||i===void 0?void 0:i.call(r,s=>!s.indegree);return Pu(o)},Pu=e=>{var t,n;const r=[],i=c=>f=>{f.merged||(f.barycenter===void 0||c.barycenter===void 0||f.barycenter>=c.barycenter)&&Kh(c,f)},a=c=>f=>{f.in.push(c),--f.indegree==0&&e.push(f)};for(;e==null?void 0:e.length;){const c=e.pop();r.push(c),(t=c.in.reverse())===null||t===void 0||t.forEach(f=>i(c)(f)),(n=c.out)===null||n===void 0||n.forEach(f=>a(c)(f))}const o=r.filter(c=>!c.merged),s=["vs","i","barycenter","weight"];return o.map(c=>{const f={};return s==null||s.forEach(d=>{c[d]!==void 0&&(f[d]=c[d])}),f})},Kh=(e,t)=>{var n;let r=0,i=0;e.weight&&(r+=e.barycenter*e.weight,i+=e.weight),t.weight&&(r+=t.barycenter*t.weight,i+=t.weight),e.vs=(n=t.vs)===null||n===void 0?void 0:n.concat(e.vs),e.barycenter=r/i,e.weight=i,e.i=Math.min(t.i,e.i),t.merged=!0};var Ws=Yh;const Rd=(e,t,n)=>{const r=Au(e,h=>h.hasOwnProperty("fixorder")&&!isNaN(h.fixorder)||h.hasOwnProperty("barycenter")),i=r.lhs,a=r.rhs.sort((h,v)=>-h.i- -v.i),o=[];let s=0,c=0,f=0;i==null||i.sort(Ha(!!t,!!n)),f=Mf(o,a,f),i==null||i.forEach(h=>{var v;f+=(v=h.vs)===null||v===void 0?void 0:v.length,o.push(h.vs),s+=h.barycenter*h.weight,c+=h.weight,f=Mf(o,a,f)});const d={vs:o.flat()};return c&&(d.barycenter=s/c,d.weight=c),d},Mf=(e,t,n)=>{let r=n,i;for(;t.length&&(i=t[t.length-1]).i<=r;)t.pop(),e==null||e.push(i.vs),r++;return r},Ha=(e,t)=>(n,r)=>{if(n.fixorder!==void 0&&r.fixorder!==void 0)return n.fixorder-r.fixorder;if(n.barycenter<r.barycenter)return-1;if(n.barycenter>r.barycenter)return 1;if(t&&n.order!==void 0&&r.order!==void 0){if(n.order<r.order)return-1;if(n.order>r.order)return 1}return e?r.i-n.i:n.i-r.i};var Md=Rd;const Nd=(e,t,n,r,i)=>{var a,o,s,c;let f=e.children(t);const d=e.node(t),h=d?d.borderLeft:void 0,v=d?d.borderRight:void 0,m={};h&&(f=f==null?void 0:f.filter(E=>E!==h&&E!==v));const g=$h(e,f||[]);g==null||g.forEach(E=>{var b;if((b=e.children(E.v))===null||b===void 0?void 0:b.length){const A=Nd(e,E.v,n,r);m[E.v]=A,A.hasOwnProperty("barycenter")&&qh(E,A)}});const _=Ws(g,n);Jh(_,m),(a=_.filter(E=>E.vs.length>0))===null||a===void 0||a.forEach(E=>{const b=e.node(E.vs[0]);b&&(E.fixorder=b.fixorder,E.order=b.order)});const y=Md(_,r,i);if(h&&(y.vs=[h,y.vs,v].flat(),(o=e.predecessors(h))===null||o===void 0?void 0:o.length)){const E=e.node(((s=e.predecessors(h))===null||s===void 0?void 0:s[0])||""),b=e.node(((c=e.predecessors(v))===null||c===void 0?void 0:c[0])||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+E.order+b.order)/(y.weight+2),y.weight+=2}return y},Jh=(e,t)=>{e==null||e.forEach(n=>{var r;const i=(r=n.vs)===null||r===void 0?void 0:r.map(a=>t[a]?t[a].vs:a);n.vs=i.flat()})},qh=(e,t)=>{e.barycenter!==void 0?(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight):(e.barycenter=t.barycenter,e.weight=t.weight)};var Qh=Nd;const Dd=e=>{const t=Wn(e),n=[],r=[];for(let f=1;f<t+1;f++)n.push(f);for(let f=t-1;f>-1;f--)r.push(f);const i=Vs(e,n,"inEdges"),a=Vs(e,r,"outEdges");let o=Sc(e);Ou(e,o);let s=Number.POSITIVE_INFINITY,c;for(let f=0,d=0;d<4;++f,++d){Pd(f%2?i:a,f%4>=2),o=Tu(e);const h=Id(e,o);h<s&&(d=0,c=at(o),s=h)}o=Sc(e),Ou(e,o);for(let f=0,d=0;d<4;++f,++d){Pd(f%2?i:a,f%4>=2,!0),o=Tu(e);const h=Id(e,o);h<s&&(d=0,c=at(o),s=h)}Ou(e,c)},Vs=(e,t,n)=>t.map(r=>Cd(e,r,n)),Pd=(e,t,n)=>{const r=new Bt;e==null||e.forEach(i=>{var a;const o=i.graph().root,s=Qh(i,o,r,t,n);for(let c=0;c<((a=s.vs)===null||a===void 0?void 0:a.length);c++){const f=i.node(s.vs[c]);f&&(f.order=c)}zo(i,r,s.vs)})},Ou=(e,t)=>{t==null||t.forEach(n=>{n==null||n.forEach((r,i)=>{e.node(r).order=i})})};var Rl=Dd;class po extends Lr{}const mo=(e,t)=>{const n={},r=(i,a)=>{let o=0,s=0;const c=i.length,f=a==null?void 0:a[(a==null?void 0:a.length)-1];return a==null||a.forEach((d,h)=>{var v;const m=Zs(e,d),g=m?e.node(m).order:c;(m||d===f)&&((v=a.slice(s,h+1))===null||v===void 0||v.forEach(_=>{var y;(y=e.predecessors(_))===null||y===void 0||y.forEach(E=>{var b;const A=e.node(E),C=A.order;(C<o||g<C)&&!(A.dummy&&((b=e.node(_))===null||b===void 0?void 0:b.dummy))&&Ml(n,E,_)})}),s=h+1,o=g)}),a};return(t==null?void 0:t.length)&&t.reduce(r),n},Od=(e,t)=>{const n={},r=(a,o,s,c,f)=>{let d;const h=[];for(let v=o;v<s;v++)h.push(v);h.forEach(v=>{var m,g;d=a[v],((m=e.node(d))===null||m===void 0?void 0:m.dummy)&&((g=e.predecessors(d))===null||g===void 0||g.forEach(_=>{const y=e.node(_);y.dummy&&(y.order<c||y.order>f)&&Ml(n,_,d)}))})},i=(a,o)=>{let s=-1,c,f=0;return o==null||o.forEach((d,h)=>{var v;if(((v=e.node(d))===null||v===void 0?void 0:v.dummy)==="border"){const m=e.predecessors(d)||[];m.length&&(c=e.node(m[0]).order,r(o,f,h,s,c),f=h,s=c)}r(o,f,o.length,c,a.length)}),o};return(t==null?void 0:t.length)&&t.reduce(i),n},Zs=(e,t)=>{var n,r;if((n=e.node(t))===null||n===void 0?void 0:n.dummy)return(r=e.predecessors(t))===null||r===void 0?void 0:r.find(i=>e.node(i).dummy)},Ml=(e,t,n)=>{let r=t,i=n;if(r>i){const o=r;r=i,i=o}let a=e[r];a||(e[r]=a={}),a[i]=!0},da=(e,t,n)=>{let r=t,i=n;if(r>i){const a=t;r=i,i=a}return!!e[r]},Lu=(e,t,n,r)=>{const i={},a={},o={};return t==null||t.forEach(s=>{s==null||s.forEach((c,f)=>{i[c]=c,a[c]=c,o[c]=f})}),t==null||t.forEach(s=>{let c=-1;s==null||s.forEach(f=>{let d=r(f);if(d.length){d=d.sort((v,m)=>o[v]-o[m]);const h=(d.length-1)/2;for(let v=Math.floor(h),m=Math.ceil(h);v<=m;++v){const g=d[v];a[f]===f&&c<o[g]&&!da(n,f,g)&&(a[g]=f,a[f]=i[f]=i[g],c=o[g])}}})}),{root:i,align:a}},go=(e,t,n,r,i)=>{var a;const o={},s=ha(e,t,n,i),c=i?"borderLeft":"borderRight",f=(v,m)=>{let g=s.nodes(),_=g.pop();const y={};for(;_;)y[_]?v(_):(y[_]=!0,g.push(_),g=g.concat(m(_))),_=g.pop()},d=v=>{o[v]=(s.inEdges(v)||[]).reduce((m,g)=>Math.max(m,(o[g.v]||0)+s.edge(g)),0)},h=v=>{const m=(s.outEdges(v)||[]).reduce((_,y)=>Math.min(_,(o[y.w]||0)-s.edge(y)),Number.POSITIVE_INFINITY),g=e.node(v);m!==Number.POSITIVE_INFINITY&&g.borderType!==c&&(o[v]=Math.max(o[v],m))};return f(d,s.predecessors.bind(s)),f(h,s.successors.bind(s)),(a=Object.values(r))===null||a===void 0||a.forEach(v=>{o[v]=o[n[v]]}),o},ha=(e,t,n,r)=>{const i=new po,a=e.graph(),o=Wo(a.nodesep,a.edgesep,r);return t==null||t.forEach(s=>{let c;s==null||s.forEach(f=>{const d=n[f];if(i.setNode(d),c){const h=n[c],v=i.edgeFromArgs(h,d);i.setEdge(h,d,Math.max(o(e,f,c),v||0))}c=f})}),i},Nf=(e,t)=>_f(Object.values(t),n=>{var r;let i=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY;return(r=Object.keys(n))===null||r===void 0||r.forEach(o=>{const s=n[o],c=Nl(e,o)/2;i=Math.max(s+c,i),a=Math.min(s-c,a)}),i-a});function Tc(e,t){const n=Object.values(t),r=Math.min(...n),i=Math.max(...n);["u","d"].forEach(a=>{["l","r"].forEach(o=>{const s=a+o,c=e[s];let f;if(c===t)return;const d=Object.values(c);f=o==="l"?r-Math.min(...d):i-Math.max(...d),f&&(e[s]={},Object.keys(c).forEach(h=>{e[s][h]=c[h]+f}))})})}const Gu=(e,t)=>{const n={};return Object.keys(e.ul).forEach(r=>{if(t)n[r]=e[t.toLowerCase()][r];else{const i=Object.values(e).map(a=>a[r]);n[r]=(i[0]+i[1])/2}}),n},Ac=e=>{const t=buildLayerMatrix(e),n=Object.assign(mo(e,t),Od(e,t)),r={};let i;["u","d"].forEach(o=>{i=o==="u"?t:Object.values(t).reverse(),["l","r"].forEach(s=>{s==="r"&&(i=i.map(h=>Object.values(h).reverse()));const c=(o==="u"?e.predecessors:e.successors).bind(e),f=Lu(e,i,n,c),d=go(e,i,f.root,f.align,s==="r");s==="r"&&Object.keys(d).forEach(h=>{d[h]=-d[h]}),r[o+s]=d})});const a=Nf(e,r);return Tc(r,a),Gu(r,e.graph().align)},Wo=(e,t,n)=>(r,i,a)=>{const o=r.node(i),s=r.node(a);let c=0,f;if(c+=o.width/2,o.hasOwnProperty("labelpos"))switch((o.labelpos||"").toLowerCase()){case"l":f=-o.width/2;break;case"r":f=o.width/2;break}if(f&&(c+=n?f:-f),f=0,c+=(o.dummy?t:e)/2,c+=(s.dummy?t:e)/2,c+=s.width/2,s.labelpos)switch((s.labelpos||"").toLowerCase()){case"l":f=s.width/2;break;case"r":f=-s.width/2;break}return f&&(c+=n?f:-f),f=0,c},Nl=(e,t)=>e.node(t).width||0,Ld=e=>{const t=Tu(e),n=e.graph().ranksep;let r=0;t==null||t.forEach(i=>{const a=i.map(s=>e.node(s).height),o=Math.max(...a);i==null||i.forEach(s=>{e.node(s).y=r+o/2}),r+=o+n})},Ic=e=>{const t=Tu(e),n=Object.assign(mo(e,t),Od(e,t)),r={};let i=[];["u","d"].forEach(o=>{i=o==="u"?t:Object.values(t).reverse(),["l","r"].forEach(s=>{s==="r"&&(i=i.map(h=>Object.values(h).reverse()));const c=(o==="u"?e.predecessors:e.successors).bind(e),f=Lu(e,i,n,c),d=go(e,i,f.root,f.align,s==="r");s==="r"&&Object.keys(d).forEach(h=>d[h]=-d[h]),r[o+s]=d})});const a=Nf(e,r);return a&&Tc(r,a),Gu(r,e.graph().align)};var Df=e=>{var t;const n=yr(e);Ld(n);const r=Ic(n);(t=Object.keys(r))===null||t===void 0||t.forEach(i=>{n.node(i).x=r[i]})},Pf=(e,t)=>{const r=e.nodes().filter(o=>{var s;return!((s=e.children(o))===null||s===void 0?void 0:s.length)}).map(o=>e.node(o).rank),i=Math.max(...r),a=Array(i+1).fill([]);t==null||t.forEach(o=>{const s=e.node(o);!s||(s==null?void 0:s.dummy)||isNaN(s.rank)||(s.fixorder=a[s.rank].length,a[s.rank].push(o))})};const Dl=(e,t)=>{const n=t&&t.debugTiming?yf:Iu;n("layout",()=>{t&&!t.keepNodeOrder&&t.prevGraph&&n("  inheritOrder",()=>{Cc(e,t.prevGraph)});const r=n("  buildLayoutGraph",()=>Ud(e));t&&t.edgeLabelSpace===!1||n("  makeSpaceForEdgeLabels",()=>{ku(r)});try{n("  runLayout",()=>{Xa(r,n,t)})}catch(i){if(i.message==="Not possible to find intersection inside of the rectangle"){console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,i);return}throw i}n("  updateInputGraph",()=>{Rc(e,r)})})},Xa=(e,t,n)=>{t("    removeSelfEdges",()=>{Nc(e)}),t("    acyclic",()=>{Pe.run(e)}),t("    nestingGraph.run",()=>{zs.run(e)}),t("    rank",()=>{na(yr(e))}),t("    injectEdgeLabelProxies",()=>{Gf(e)}),t("    removeEmptyRanks",()=>{gf(e)}),t("    nestingGraph.cleanup",()=>{zs.cleanup(e)}),t("    normalizeRanks",()=>{vo(e)}),t("    assignRankMinMax",()=>{Ol(e)}),t("    removeEdgeLabelProxies",()=>{Mc(e)}),t("    normalize.run",()=>{Uo.run(e)}),t("    parentDummyChains",()=>{Al(e)}),t("    addBorderSegments",()=>{Du(e)}),n&&n.keepNodeOrder&&t("    initDataOrder",()=>{Pf(e,n.nodeOrder)}),t("    order",()=>{Rl(e)}),t("    insertSelfEdges",()=>{Dc(e)}),t("    adjustCoordinateSystem",()=>{Td.adjust(e)}),t("    position",()=>{Df(e)}),t("    positionSelfEdges",()=>{Xs(e)}),t("    removeBorderNodes",()=>{ws(e)}),t("    normalize.undo",()=>{Uo.undo(e)}),t("    fixupEdgeLabelCoords",()=>{Vo(e)}),t("    undoCoordinateSystem",()=>{Td.undo(e)}),t("    translateGraph",()=>{Fu(e)}),t("    assignNodeIntersects",()=>{kf(e)}),t("    reversePoints",()=>{Hs(e)}),t("    acyclic.undo",()=>{Pe.undo(e)})},Cc=(e,t)=>{e.nodes().forEach(n=>{const r=e.node(n),i=t.node(n);i!==void 0?(r.fixorder=i._order,delete i._order):delete r.fixorder})},Rc=(e,t)=>{e.nodes().forEach(n=>{var r;const i=e.node(n);if(i){const a=t.node(n);i.x=a.x,i.y=a.y,i._order=a.order,i._rank=a.rank,((r=t.children(n))===null||r===void 0?void 0:r.length)&&(i.width=a.width,i.height=a.height)}}),e.edges().forEach(n=>{const r=e.edge(n),i=t.edge(n);r.points=i.points,i.hasOwnProperty("x")&&(r.x=i.x,r.y=i.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height},bs=["nodesep","edgesep","ranksep","marginx","marginy"],Of={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Mi=["acyclicer","ranker","rankdir","align"],Lf=["width","height","layer","fixorder"],Pl={width:0,height:0},kd=["minlen","weight","width","height","labeloffset"],Fd={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},js=["labelpos"],Ud=e=>{const t=new Bt({multigraph:!0,compound:!0}),n=$a(e.graph()),r={};return Mi==null||Mi.forEach(i=>{n[i]!==void 0&&(r[i]=n[i])}),t.setGraph(Object.assign({},Of,yo(n,bs),r)),e.nodes().forEach(i=>{const a=$a(e.node(i)),o=Object.assign(Object.assign({},Pl),a),s=yo(o,Lf);t.setNode(i,s),t.setParent(i,e.parent(i))}),e.edges().forEach(i=>{const a=$a(e.edge(i)),o={};js==null||js.forEach(s=>{a[s]!==void 0&&(o[s]=a[s])}),t.setEdgeObj(i,Object.assign({},Fd,yo(a,kd),o))}),t},ku=e=>{const t=e.graph();t.ranksep||(t.ranksep=0),t.ranksep/=2,e.nodes().forEach(n=>{const r=e.node(n);isNaN(r.layer)||r.layer||(r.layer=0)}),e.edges().forEach(n=>{var r;const i=e.edge(n);i.minlen*=2,((r=i.labelpos)===null||r===void 0?void 0:r.toLowerCase())!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?i.width+=i.labeloffset:i.height+=i.labeloffset)})},Gf=e=>{e.edges().forEach(t=>{const n=e.edge(t);if(n.width&&n.height){const r=e.node(t.v),i=e.node(t.w),a={e:t,rank:(i.rank-r.rank)/2+r.rank};cr(e,"edge-proxy",a,"_ep")}})},Ol=e=>{let t=0;e.nodes().forEach(n=>{var r,i;const a=e.node(n);a.borderTop&&(a.minRank=(r=e.node(a.borderTop))===null||r===void 0?void 0:r.rank,a.maxRank=(i=e.node(a.borderBottom))===null||i===void 0?void 0:i.rank,t=Math.max(t,a.maxRank||-Infinity))}),e.graph().maxRank=t},Mc=e=>{e.nodes().forEach(t=>{const n=e.node(t);n.dummy==="edge-proxy"&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})},Fu=e=>{let t,n=0,r,i=0;const a=e.graph(),o=a.marginx||0,s=a.marginy||0,c=f=>{if(!f)return;const d=f.x,h=f.y,v=f.width,m=f.height;!isNaN(d)&&!isNaN(v)&&(t===void 0&&(t=d-v/2),t=Math.min(t,d-v/2),n=Math.max(n,d+v/2)),!isNaN(h)&&!isNaN(m)&&(r===void 0&&(r=h-m/2),r=Math.min(r,h-m/2),i=Math.max(i,h+m/2))};e.nodes().forEach(f=>{c(e.node(f))}),e.edges().forEach(f=>{const d=e.edge(f);(d==null?void 0:d.hasOwnProperty("x"))&&c(d)}),t-=o,r-=s,e.nodes().forEach(f=>{const d=e.node(f);d&&(d.x-=t,d.y-=r)}),e.edges().forEach(f=>{var d;const h=e.edge(f);(d=h.points)===null||d===void 0||d.forEach(v=>{v.x-=t,v.y-=r}),h.hasOwnProperty("x")&&(h.x-=t),h.hasOwnProperty("y")&&(h.y-=r)}),a.width=n-t+o,a.height=i-r+s},kf=e=>{e.edges().forEach(t=>{const n=e.edge(t),r=e.node(t.v),i=e.node(t.w);let a,o;n.points?(a=n.points[0],o=n.points[n.points.length-1]):(n.points=[],a=i,o=r),n.points.unshift(yc(r,a)),n.points.push(yc(i,o))})},Vo=e=>{e.edges().forEach(t=>{const n=e.edge(t);if(n==null?void 0:n.hasOwnProperty("x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})},Hs=e=>{e.edges().forEach(t=>{var n;const r=e.edge(t);r.reversed&&((n=r.points)===null||n===void 0||n.reverse())})},ws=e=>{e.nodes().forEach(t=>{var n,r,i;if((n=e.children(t))===null||n===void 0?void 0:n.length){const a=e.node(t),o=e.node(a.borderTop),s=e.node(a.borderBottom),c=e.node(a.borderLeft[((r=a.borderLeft)===null||r===void 0?void 0:r.length)-1]),f=e.node(a.borderRight[((i=a.borderRight)===null||i===void 0?void 0:i.length)-1]);a.width=Math.abs((f==null?void 0:f.x)-(c==null?void 0:c.x))||10,a.height=Math.abs((s==null?void 0:s.y)-(o==null?void 0:o.y))||10,a.x=((c==null?void 0:c.x)||0)+a.width/2,a.y=((o==null?void 0:o.y)||0)+a.height/2}}),e.nodes().forEach(t=>{var n;((n=e.node(t))===null||n===void 0?void 0:n.dummy)==="border"&&e.removeNode(t)})},Nc=e=>{e.edges().forEach(t=>{if(t.v===t.w){const n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdgeObj(t)}})},Dc=e=>{const t=Tu(e);t==null||t.forEach(n=>{let r=0;n==null||n.forEach((i,a)=>{var o;const s=e.node(i);s.order=a+r,(o=s.selfEdges)===null||o===void 0||o.forEach(c=>{cr(e,"selfedge",{width:c.label.width,height:c.label.height,rank:s.rank,order:a+ ++r,e:c.e,label:c.label},"_se")}),delete s.selfEdges})})},Xs=e=>{e.nodes().forEach(t=>{const n=e.node(t);if(n.dummy==="selfedge"){const r=e.node(n.e.v),i=r.x+r.width/2,a=r.y,o=n.x-i,s=r.height/2;e.setEdgeObj(n.e,n.label),e.removeNode(t),n.label.points=[{x:i+2*o/3,y:a-s},{x:i+5*o/6,y:a-s},{y:a,x:i+o},{x:i+5*o/6,y:a+s},{x:i+2*o/3,y:a+s}],n.label.x=n.x,n.label.y=n.y}})},yo=(e,t)=>{const n={};return t==null||t.forEach(r=>{e[r]!==void 0&&(n[r]=+e[r])}),n},$a=(e={})=>{const t={};return Object.keys(e).forEach(n=>{t[n.toLowerCase()]=e[n]}),t};var Ff=Dl,Uu={layout:Ff,util:{time:yf,notime:Iu}};class xs extends ar{constructor(t){super();this.rankdir="TB",this.nodesep=50,this.ranksep=50,this.controlPoints=!1,this.sortByCombo=!1,this.edgeLabelSpace=!0,this.radial=!1,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.layoutNode=n=>{const r=this,{nodes:i}=r,a=i.find(o=>o.id===n);return a?a.layout!==!1:!0},this.updateCfg(t)}getDefaultCfg(){return{rankdir:"TB",align:void 0,nodeSize:void 0,nodesepFunc:void 0,ranksepFunc:void 0,nodesep:50,ranksep:50,controlPoints:!1,radial:!1,focusNode:null}}execute(){var t,n;const r=this,{nodes:i,nodeSize:a,rankdir:o,combos:s,begin:c,radial:f}=r;if(!i)return;const d=r.edges||[],h=new Bt({multigraph:!0,compound:!0});let v;a?V(a)?v=()=>a:v=()=>[a,a]:v=C=>C.size?V(C.size)?C.size:be(C.size)?[C.size.width||40,C.size.height||40]:[C.size,C.size]:[40,40];const m=tn(r.ranksep,50,r.ranksepFunc),g=tn(r.nodesep,50,r.nodesepFunc);let _=g,y=m;(o==="LR"||o==="RL")&&(_=m,y=g),h.setDefaultEdgeLabel(()=>({})),h.setGraph(r);const E={};this.sortByCombo&&s&&s.forEach(C=>{!C.parentId||(E[C.parentId]||(E[C.parentId]=!0,h.setNode(C.parentId,{})),h.setParent(C.id,C.parentId))}),i.filter(C=>C.layout!==!1).forEach(C=>{const R=v(C),z=y(C),ee=_(C),Q=R[0]+2*ee,re=R[1]+2*z,de=C.layer;Z(de)?h.setNode(C.id,{width:Q,height:re,layer:de}):h.setNode(C.id,{width:Q,height:re}),this.sortByCombo&&C.comboId&&(E[C.comboId]||(E[C.comboId]=!0,h.setNode(C.comboId,{})),h.setParent(C.id,C.comboId))}),d.forEach(C=>{const R=We(C,"source"),z=We(C,"target");this.layoutNode(R)&&this.layoutNode(z)&&h.setEdge(R,z,{weight:C.weight||1})});let b;((t=r.preset)===null||t===void 0?void 0:t.nodes)&&(b=new Bt({multigraph:!0,compound:!0}),r.preset.nodes.forEach(C=>{b==null||b.setNode(C.id,C)})),Uu.layout(h,{prevGraph:b,edgeLabelSpace:r.edgeLabelSpace,keepNodeOrder:Boolean(!!r.nodeOrder),nodeOrder:r.nodeOrder});const A=[0,0];if(c){let C=Infinity,R=Infinity;h.nodes().forEach(z=>{const ee=h.node(z);C>ee.x&&(C=ee.x),R>ee.y&&(R=ee.y)}),h.edges().forEach(z=>{var ee;(ee=h.edge(z).points)===null||ee===void 0||ee.forEach(re=>{C>re.x&&(C=re.x),R>re.y&&(R=re.y)})}),A[0]=c[0]-C,A[1]=c[1]-R}if(f){const{focusNode:C,ranksep:R,getRadialPos:z}=this,ee=x(C)?C:C==null?void 0:C.id,Q=ee?(n=h.node(ee))===null||n===void 0?void 0:n._rank:0,re=[],de=o==="LR"||o==="RL",Ie=de?"y":"x",ie=de?"height":"width";let ke=Infinity,Ve=-Infinity;h.nodes().forEach(_n=>{const wn=h.node(_n),Ot=i.findIndex(mn=>mn.id===_n);if(!i[Ot])return;const Tn=g(i[Ot]);if(Q===0)re[wn._rank]||(re[wn._rank]={nodes:[],totalWidth:0,maxSize:-Infinity}),re[wn._rank].nodes.push(_n),re[wn._rank].totalWidth+=Tn*2+wn[ie],re[wn._rank].maxSize<Math.max(wn.width,wn.height)&&(re[wn._rank].maxSize=Math.max(wn.width,wn.height));else{const mn=wn._rank-Q;if(mn===0)re[mn]||(re[mn]={nodes:[],totalWidth:0,maxSize:-Infinity}),re[mn].nodes.push(_n),re[mn].totalWidth+=Tn*2+wn[ie],re[mn].maxSize<Math.max(wn.width,wn.height)&&(re[mn].maxSize=Math.max(wn.width,wn.height));else{const Qt=Math.abs(mn);re[Qt]||(re[Qt]={left:[],right:[],totalWidth:0,maxSize:-Infinity}),re[Qt].totalWidth+=Tn*2+wn[ie],re[Qt].maxSize<Math.max(wn.width,wn.height)&&(re[Qt].maxSize=Math.max(wn.width,wn.height)),mn<0?re[Qt].left.push(_n):re[Qt].right.push(_n)}}const hr=wn[Ie]-wn[ie]/2-Tn,zn=wn[Ie]+wn[ie]/2+Tn;hr<ke&&(ke=hr),zn>Ve&&(Ve=zn)});let Rt=R||50;const dn={},ln=(Ve-ke)/.9,pn=[(ke+Ve-ln)*.5,(ke+Ve+ln)*.5],lr=(_n,wn,Ot=-Infinity,Tn=[0,1])=>{let hr=Ot;return _n.forEach(zn=>{const mn=h.node(zn);dn[zn]=wn;const{x:Qt,y:mr}=z(mn[Ie],pn,ln,wn,Tn),Qr=i.findIndex(ro=>ro.id===zn);if(!i[Qr])return;i[Qr].x=Qt+A[0],i[Qr].y=mr+A[1],i[Qr]._order=mn._order;const br=m(i[Qr]);hr<br&&(hr=br)}),hr};let Si=!0;const Hr=0;re.forEach(_n=>{var wn,Ot,Tn,hr,zn,mn,Qt;if(!((wn=_n==null?void 0:_n.nodes)===null||wn===void 0?void 0:wn.length)&&!((Ot=_n==null?void 0:_n.left)===null||Ot===void 0?void 0:Ot.length)&&!((Tn=_n==null?void 0:_n.right)===null||Tn===void 0?void 0:Tn.length))return;if(Si&&_n.nodes.length===1){const Qr=i.findIndex(br=>br.id===_n.nodes[0]);i[Qr].x=A[0],i[Qr].y=A[1],dn[_n.nodes[0]]=0,Rt=m(i[Qr]),Si=!1;return}Rt=Math.max(Rt,_n.totalWidth/(2*Math.PI));let mr=-Infinity;if(Q===0||((hr=_n.nodes)===null||hr===void 0?void 0:hr.length))mr=lr(_n.nodes,Rt,mr,[0,1]);else{const Qr=((zn=_n.left)===null||zn===void 0?void 0:zn.length)/(((mn=_n.left)===null||mn===void 0?void 0:mn.length)+((Qt=_n.right)===null||Qt===void 0?void 0:Qt.length));mr=lr(_n.left,Rt,mr,[0,Qr]),mr=lr(_n.right,Rt,mr,[Qr+.05,1])}Rt+=mr,Si=!1,Hr-_n.maxSize}),h.edges().forEach(_n=>{var wn,Ot,Tn;const hr=h.edge(_n),zn=d.findIndex(mn=>{const Qt=We(mn,"source"),mr=We(mn,"target");return Qt===_n.v&&mr===_n.w});if(r.edgeLabelSpace&&r.controlPoints&&d[zn].type!=="loop"){const mn=Ie==="x"?"y":"x",Qt=(wn=hr==null?void 0:hr.points)===null||wn===void 0?void 0:wn.slice(1,hr.points.length-1),mr=[],Qr=(Ot=h.node(_n.v))===null||Ot===void 0?void 0:Ot[mn],br=Qr-((Tn=h.node(_n.w))===null||Tn===void 0?void 0:Tn[mn]),ro=dn[_n.v],fu=ro-dn[_n.w];Qt==null||Qt.forEach(qc=>{const Qc=(qc[mn]-Qr)/br*fu+ro,ef=z(qc[Ie],pn,ln,Qc);mr.push({x:ef.x+A[0],y:ef.y+A[1]})}),d[zn].controlPoints=mr}})}else h.nodes().forEach(C=>{const R=h.node(C),z=i.findIndex(ee=>ee.id===C);!i[z]||(i[z].x=R.x+A[0],i[z].y=R.y+A[1],i[z]._order=R._order)}),h.edges().forEach(C=>{var R;const z=h.edge(C),ee=d.findIndex(Q=>{const re=We(Q,"source"),de=We(Q,"target");return re===C.v&&de===C.w});r.edgeLabelSpace&&r.controlPoints&&d[ee].type!=="loop"&&(d[ee].controlPoints=(R=z==null?void 0:z.points)===null||R===void 0?void 0:R.slice(1,z.points.length-1),d[ee].controlPoints.forEach(Q=>{Q.x+=A[0],Q.y+=A[1]}))});return r.onLayoutEnd&&r.onLayoutEnd(),{nodes:i,edges:d}}getRadialPos(t,n,r,i,a=[0,1]){let o=(t-n[0])/r;o=o*(a[1]-a[0])+a[0];const s=o*2*Math.PI;return{x:Math.cos(s)*i,y:Math.sin(s)*i}}getType(){return"dagre"}}const $s={graph:{meta:{rankDir:"TB",nodeSep:50,rankSep:50,edgeSep:5,align:void 0}},subScene:{meta:{paddingTop:20,paddingBottom:20,paddingLeft:20,paddingRight:20,labelHeight:20}},nodeSize:{meta:{width:100,maxLabelWidth:0,height:20},node:{width:80,height:20,labelOffset:10,maxLabelWidth:40},bridge:{width:5,height:5,radius:2,labelOffset:0}}};function Ys(e={},t=$s){var n,r,i,a;const o=JSON.parse(JSON.stringify(t)),s=((n=e==null?void 0:e.graph)===null||n===void 0?void 0:n.meta)||{},c=((r=e==null?void 0:e.subScene)===null||r===void 0?void 0:r.meta)||{},f=((i=e==null?void 0:e.nodeSize)===null||i===void 0?void 0:i.meta)||{},d=((a=e==null?void 0:e.nodeSize)===null||a===void 0?void 0:a.node)||{},h=o.nodeSize.bridge;return{graph:{meta:Object.assign(o.graph.meta,s)},subScene:{meta:Object.assign(o.subScene.meta,c)},nodeSize:{meta:Object.assign(o.nodeSize.meta,f),node:Object.assign(o.nodeSize.node,d),bridge:h}}}function _o(e){return`\u25EC${e}\u25EC`}const Ya=_o("ROOT"),Bd=_o("BRIDGE_GRAPH");var Xi,Ks,Js,Pc;(function(e){e[e.META=0]="META",e[e.NODE=1]="NODE",e[e.BRIDGE=2]="BRIDGE"})(Xi||(Xi={})),function(e){e[e.INCLUDE=0]="INCLUDE",e[e.EXCLUDE=1]="EXCLUDE",e[e.UNSPECIFIED=2]="UNSPECIFIED"}(Ks||(Ks={})),function(e){e[e.META=0]="META",e[e.CORE=1]="CORE",e[e.BRIDGE=2]="BRIDGE"}(Js||(Js={})),function(e){e[e.META=0]="META",e[e.OP=1]="OP",e[e.SERIES=2]="SERIES"}(Pc||(Pc={}));var Bu=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof S.g!="undefined"?S.g:typeof self!="undefined"?self:{};function Zo(e,t){return e(t={exports:{}},t.exports),t.exports}var Ll=function(){this.__data__=[],this.size=0},zu=function(e,t){return e===t||e!=e&&t!=t},Wu=function(e,t){for(var n=e.length;n--;)if(zu(e[n][0],t))return n;return-1},Zn=Array.prototype.splice,ev=function(e){var t=this.__data__,n=Wu(t,e);return!(n<0)&&(n==t.length-1?t.pop():Zn.call(t,n,1),--this.size,!0)},tv=function(e){var t=this.__data__,n=Wu(t,e);return n<0?void 0:t[n][1]},Oc=function(e){return Wu(this.__data__,e)>-1},zd=function(e,t){var n=this.__data__,r=Wu(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function Vu(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Vu.prototype.clear=Ll,Vu.prototype.delete=ev,Vu.prototype.get=tv,Vu.prototype.has=Oc,Vu.prototype.set=zd;var Uf=Vu,Oa=function(){this.__data__=new Uf,this.size=0},nv=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Bf=function(e){return this.__data__.get(e)},Gl=function(e){return this.__data__.has(e)},Lc=typeof Bu=="object"&&Bu&&Bu.Object===Object&&Bu,Gc=typeof self=="object"&&self&&self.Object===Object&&self,Fr=Lc||Gc||Function("return this")(),di=Fr.Symbol,Zu=Object.prototype,kc=Zu.hasOwnProperty,qs=Zu.toString,jo=di?di.toStringTag:void 0,Fc=function(e){var t=kc.call(e,jo),n=e[jo];try{e[jo]=void 0;var r=!0}catch(a){}var i=qs.call(e);return r&&(t?e[jo]=n:delete e[jo]),i},Uc=Object.prototype.toString,ju=function(e){return Uc.call(e)},Qs=di?di.toStringTag:void 0,Ni=function(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Qs&&Qs in Object(e)?Fc(e):ju(e)},Oi=function(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")},xa,Eo=function(e){if(!Oi(e))return!1;var t=Ni(e);return t=="[object Function]"||t=="[object GeneratorFunction]"||t=="[object AsyncFunction]"||t=="[object Proxy]"},Ss=Fr["__core-js_shared__"],Bc=(xa=/[^.]+$/.exec(Ss&&Ss.keys&&Ss.keys.IE_PROTO||""))?"Symbol(src)_1."+xa:"",zc=function(e){return!!Bc&&Bc in e},eu=Function.prototype.toString,Ts=function(e){if(e!=null){try{return eu.call(e)}catch(t){}try{return e+""}catch(t){}}return""},zf=/^\[object .+?Constructor\]$/,Wd=Function.prototype,rv=Object.prototype,Vd=Wd.toString,Ho=rv.hasOwnProperty,ra=RegExp("^"+Vd.call(Ho).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ka=function(e){return!(!Oi(e)||zc(e))&&(Eo(e)?ra:zf).test(Ts(e))},Zd=function(e,t){return e==null?void 0:e[t]},tu=function(e,t){var n=Zd(e,t);return Ka(n)?n:void 0},Xo=tu(Fr,"Map"),bo=tu(Object,"create"),Ja=function(){this.__data__=bo?bo(null):{},this.size=0},kl=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Hu=Object.prototype.hasOwnProperty,$o=function(e){var t=this.__data__;if(bo){var n=t[e];return n==="__lodash_hash_undefined__"?void 0:n}return Hu.call(t,e)?t[e]:void 0},nu=Object.prototype.hasOwnProperty,ru=function(e){var t=this.__data__;return bo?t[e]!==void 0:nu.call(t,e)},Wf=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=bo&&t===void 0?"__lodash_hash_undefined__":t,this};function As(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}As.prototype.clear=Ja,As.prototype.delete=kl,As.prototype.get=$o,As.prototype.has=ru,As.prototype.set=Wf;var Wi=As,qa=function(){this.size=0,this.__data__={hash:new Wi,map:new(Xo||Uf),string:new Wi}},ri=function(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null},wi=function(e,t){var n=e.__data__;return ri(t)?n[typeof t=="string"?"string":"hash"]:n.map},Vf=function(e){var t=wi(this,e).delete(e);return this.size-=t?1:0,t},Zf=function(e){return wi(this,e).get(e)},iv=function(e){return wi(this,e).has(e)},jd=function(e,t){var n=wi(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function Yo(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Yo.prototype.clear=qa,Yo.prototype.delete=Vf,Yo.prototype.get=Zf,Yo.prototype.has=iv,Yo.prototype.set=jd;var Xu=Yo,Fl=function(e,t){var n=this.__data__;if(n instanceof Uf){var r=n.__data__;if(!Xo||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Xu(r)}return n.set(e,t),this.size=n.size,this};function $u(e){var t=this.__data__=new Uf(e);this.size=t.size}$u.prototype.clear=Oa,$u.prototype.delete=nv,$u.prototype.get=Bf,$u.prototype.has=Gl,$u.prototype.set=Fl;var iu=$u,Qa=function(e,t){for(var n=-1,r=e==null?0:e.length;++n<r&&t(e[n],n,e)!==!1;);return e},Wc=function(){try{var e=tu(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),Yu=function(e,t,n){t=="__proto__"&&Wc?Wc(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},Hd=Object.prototype.hasOwnProperty,Ku=function(e,t,n){var r=e[t];Hd.call(e,t)&&zu(r,n)&&(n!==void 0||t in e)||Yu(e,t,n)},Vc=function(e,t,n,r){var i=!n;n||(n={});for(var a=-1,o=t.length;++a<o;){var s=t[a],c=r?r(n[s],e[s],s,n,e):void 0;c===void 0&&(c=e[s]),i?Yu(n,s,c):Ku(n,s,c)}return n},av=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},xi=function(e){return e!=null&&typeof e=="object"},jf=function(e){return xi(e)&&Ni(e)=="[object Arguments]"},T=Object.prototype,O=T.hasOwnProperty,H=T.propertyIsEnumerable,ge=jf(function(){return arguments}())?jf:function(e){return xi(e)&&O.call(e,"callee")&&!H.call(e,"callee")},se=Array.isArray,_e=function(){return!1},xe=Zo(function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n?Fr.Buffer:void 0,a=(i?i.isBuffer:void 0)||_e;e.exports=a}),$e=/^(?:0|[1-9]\d*)$/,et=function(e,t){var n=typeof e;return!!(t=t??9007199254740991)&&(n=="number"||n!="symbol"&&$e.test(e))&&e>-1&&e%1==0&&e<t},nt=function(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=9007199254740991},Ge={};Ge["[object Float32Array]"]=Ge["[object Float64Array]"]=Ge["[object Int8Array]"]=Ge["[object Int16Array]"]=Ge["[object Int32Array]"]=Ge["[object Uint8Array]"]=Ge["[object Uint8ClampedArray]"]=Ge["[object Uint16Array]"]=Ge["[object Uint32Array]"]=!0,Ge["[object Arguments]"]=Ge["[object Array]"]=Ge["[object ArrayBuffer]"]=Ge["[object Boolean]"]=Ge["[object DataView]"]=Ge["[object Date]"]=Ge["[object Error]"]=Ge["[object Function]"]=Ge["[object Map]"]=Ge["[object Number]"]=Ge["[object Object]"]=Ge["[object RegExp]"]=Ge["[object Set]"]=Ge["[object String]"]=Ge["[object WeakMap]"]=!1;var qe=function(e){return xi(e)&&nt(e.length)&&!!Ge[Ni(e)]},_t=function(e){return function(t){return e(t)}},Je=Zo(function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n&&Lc.process,a=function(){try{var o=r&&r.require&&r.require("util").types;return o||i&&i.binding&&i.binding("util")}catch(s){}}();e.exports=a}),lt=Je&&Je.isTypedArray,fe=lt?_t(lt):qe,Ae=Object.prototype.hasOwnProperty,rt=function(e,t){var n=se(e),r=!n&&ge(e),i=!n&&!r&&xe(e),a=!n&&!r&&!i&&fe(e),o=n||r||i||a,s=o?av(e.length,String):[],c=s.length;for(var f in e)!t&&!Ae.call(e,f)||o&&(f=="length"||i&&(f=="offset"||f=="parent")||a&&(f=="buffer"||f=="byteLength"||f=="byteOffset")||et(f,c))||s.push(f);return s},Mt=Object.prototype,Ze=function(e){var t=e&&e.constructor;return e===(typeof t=="function"&&t.prototype||Mt)},At=function(e,t){return function(n){return e(t(n))}},Fe=At(Object.keys,Object),pt=Object.prototype.hasOwnProperty,He=function(e){if(!Ze(e))return Fe(e);var t=[];for(var n in Object(e))pt.call(e,n)&&n!="constructor"&&t.push(n);return t},st=function(e){return e!=null&&nt(e.length)&&!Eo(e)},Wt=function(e){return st(e)?rt(e):He(e)},cn=function(e,t){return e&&Vc(t,Wt(t),e)},gt=function(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t},ct=Object.prototype.hasOwnProperty,je=function(e){if(!Oi(e))return gt(e);var t=Ze(e),n=[];for(var r in e)(r!="constructor"||!t&&ct.call(e,r))&&n.push(r);return n},Kt=function(e){return st(e)?rt(e,!0):je(e)},En=function(e,t){return e&&Vc(t,Kt(t),e)},kt=Zo(function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n?Fr.Buffer:void 0,a=i?i.allocUnsafe:void 0;e.exports=function(o,s){if(s)return o.slice();var c=o.length,f=a?a(c):new o.constructor(c);return o.copy(f),f}}),Dn=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t},un=function(e,t){for(var n=-1,r=e==null?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o)}return a},bn=function(){return[]},Qn=Object.prototype.propertyIsEnumerable,Vr=Object.getOwnPropertySymbols,ii=Vr?function(e){return e==null?[]:(e=Object(e),un(Vr(e),function(t){return Qn.call(e,t)}))}:bn,Cn=function(e,t){return Vc(e,ii(e),t)},Zr=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e},_r=At(Object.getPrototypeOf,Object),Kr=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Zr(t,ii(e)),e=_r(e);return t}:bn,Jr=function(e,t){return Vc(e,Kr(e),t)},ai=function(e,t,n){var r=t(e);return se(e)?r:Zr(r,n(e))},Sr=function(e){return ai(e,Wt,ii)},qr=function(e){return ai(e,Kt,Kr)},jr=tu(Fr,"DataView"),hn=tu(Fr,"Promise"),oi=tu(Fr,"Set"),er=tu(Fr,"WeakMap"),Jt=Ts(jr),Gn=Ts(Xo),jn=Ts(hn),si=Ts(oi),wo=Ts(er),Sa=Ni;(jr&&Sa(new jr(new ArrayBuffer(1)))!="[object DataView]"||Xo&&Sa(new Xo)!="[object Map]"||hn&&Sa(hn.resolve())!="[object Promise]"||oi&&Sa(new oi)!="[object Set]"||er&&Sa(new er)!="[object WeakMap]")&&(Sa=function(e){var t=Ni(e),n=t=="[object Object]"?e.constructor:void 0,r=n?Ts(n):"";if(r)switch(r){case Jt:return"[object DataView]";case Gn:return"[object Map]";case jn:return"[object Promise]";case si:return"[object Set]";case wo:return"[object WeakMap]"}return t});var B=Sa,we=Object.prototype.hasOwnProperty,ye=function(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&we.call(e,"index")&&(n.index=e.index,n.input=e.input),n},Pt=Fr.Uint8Array,Sn=function(e){var t=new e.constructor(e.byteLength);return new Pt(t).set(new Pt(e)),t},F=function(e,t){var n=t?Sn(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},D=/\w*$/,Y=function(e){var t=new e.constructor(e.source,D.exec(e));return t.lastIndex=e.lastIndex,t},ce=di?di.prototype:void 0,le=ce?ce.valueOf:void 0,te=function(e){return le?Object(le.call(e)):{}},K=function(e,t){var n=t?Sn(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)},oe=function(e,t,n){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return Sn(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return F(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return K(e,n);case"[object Map]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return Y(e);case"[object Set]":return new r;case"[object Symbol]":return te(e)}},U=Object.create,$=function(){function e(){}return function(t){if(!Oi(t))return{};if(U)return U(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),L=function(e){return typeof e.constructor!="function"||Ze(e)?{}:$(_r(e))},ae=function(e){return xi(e)&&B(e)=="[object Map]"},pe=Je&&Je.isMap,Le=pe?_t(pe):ae,Be=function(e){return xi(e)&&B(e)=="[object Set]"},Me=Je&&Je.isSet,it=Me?_t(Me):Be,It={};It["[object Arguments]"]=It["[object Array]"]=It["[object ArrayBuffer]"]=It["[object DataView]"]=It["[object Boolean]"]=It["[object Date]"]=It["[object Float32Array]"]=It["[object Float64Array]"]=It["[object Int8Array]"]=It["[object Int16Array]"]=It["[object Int32Array]"]=It["[object Map]"]=It["[object Number]"]=It["[object Object]"]=It["[object RegExp]"]=It["[object Set]"]=It["[object String]"]=It["[object Symbol]"]=It["[object Uint8Array]"]=It["[object Uint8ClampedArray]"]=It["[object Uint16Array]"]=It["[object Uint32Array]"]=!0,It["[object Error]"]=It["[object Function]"]=It["[object WeakMap]"]=!1;var yn=function e(t,n,r,i,a,o){var s,c=1&n,f=2&n,d=4&n;if(r&&(s=a?r(t,i,a,o):r(t)),s!==void 0)return s;if(!Oi(t))return t;var h=se(t);if(h){if(s=ye(t),!c)return Dn(t,s)}else{var v=B(t),m=v=="[object Function]"||v=="[object GeneratorFunction]";if(xe(t))return kt(t,c);if(v=="[object Object]"||v=="[object Arguments]"||m&&!a){if(s=f||m?{}:L(t),!c)return f?Jr(t,En(s,t)):Cn(t,cn(s,t))}else{if(!It[v])return a?t:{};s=oe(t,v,c)}}o||(o=new iu);var g=o.get(t);if(g)return g;o.set(t,s),it(t)?t.forEach(function(y){s.add(e(y,n,r,y,t,o))}):Le(t)&&t.forEach(function(y,E){s.set(E,e(y,n,r,E,t,o))});var _=h?void 0:(d?f?qr:Sr:f?Kt:Wt)(t);return Qa(_||t,function(y,E){_&&(y=t[E=y]),Ku(s,E,e(y,n,r,E,t,o))}),s},Ft=function(e){return yn(e,4)},$t=function(e){return function(){return e}},fn=function(e){return function(t,n,r){for(var i=-1,a=Object(t),o=r(t),s=o.length;s--;){var c=o[e?s:++i];if(n(a[c],c,a)===!1)break}return t}}(),Hn=function(e,t){return e&&fn(e,t,Wt)},Nr=function(e,t){return function(n,r){if(n==null)return n;if(!st(n))return e(n,r);for(var i=n.length,a=t?i:-1,o=Object(n);(t?a--:++a<i)&&r(o[a],a,o)!==!1;);return n}}(Hn),hi=function(e){return e},Hf=function(e){return typeof e=="function"?e:hi},Ta=function(e,t){return(se(e)?Qa:Nr)(e,Hf(t))},Ul=Ta,eo=function(e,t){var n=[];return Nr(e,function(r,i,a){t(r,i,a)&&n.push(r)}),n},Xd=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},hm=function(e){return this.__data__.has(e)};function $d(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new Xu;++t<n;)this.add(e[t])}$d.prototype.add=$d.prototype.push=Xd,$d.prototype.has=hm;var up=$d,vm=function(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1},cp=function(e,t){return e.has(t)},fp=function(e,t,n,r,i,a){var o=1&n,s=e.length,c=t.length;if(s!=c&&!(o&&c>s))return!1;var f=a.get(e),d=a.get(t);if(f&&d)return f==t&&d==e;var h=-1,v=!0,m=2&n?new up:void 0;for(a.set(e,t),a.set(t,e);++h<s;){var g=e[h],_=t[h];if(r)var y=o?r(_,g,h,t,e,a):r(g,_,h,e,t,a);if(y!==void 0){if(y)continue;v=!1;break}if(m){if(!vm(t,function(E,b){if(!cp(m,b)&&(g===E||i(g,E,n,r,a)))return m.push(b)})){v=!1;break}}else if(g!==_&&!i(g,_,n,r,a)){v=!1;break}}return a.delete(e),a.delete(t),v},pm=function(e){var t=-1,n=Array(e.size);return e.forEach(function(r,i){n[++t]=[i,r]}),n},ov=function(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n},lp=di?di.prototype:void 0,sv=lp?lp.valueOf:void 0,mm=function(e,t,n,r,i,a,o){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!a(new Pt(e),new Pt(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return zu(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=pm;case"[object Set]":var c=1&r;if(s||(s=ov),e.size!=t.size&&!c)return!1;var f=o.get(e);if(f)return f==t;r|=2,o.set(e,t);var d=fp(s(e),s(t),r,i,a,o);return o.delete(e),d;case"[object Symbol]":if(sv)return sv.call(e)==sv.call(t)}return!1},uv=Object.prototype.hasOwnProperty,dp=function(e,t,n,r,i,a){var o=1&n,s=Sr(e),c=s.length;if(c!=Sr(t).length&&!o)return!1;for(var f=c;f--;){var d=s[f];if(!(o?d in t:uv.call(t,d)))return!1}var h=a.get(e),v=a.get(t);if(h&&v)return h==t&&v==e;var m=!0;a.set(e,t),a.set(t,e);for(var g=o;++f<c;){var _=e[d=s[f]],y=t[d];if(r)var E=o?r(y,_,d,t,e,a):r(_,y,d,e,t,a);if(!(E===void 0?_===y||i(_,y,n,r,a):E)){m=!1;break}g||(g=d=="constructor")}if(m&&!g){var b=e.constructor,A=t.constructor;b==A||!("constructor"in e)||!("constructor"in t)||typeof b=="function"&&b instanceof b&&typeof A=="function"&&A instanceof A||(m=!1)}return a.delete(e),a.delete(t),m},hp=Object.prototype.hasOwnProperty,gm=function(e,t,n,r,i,a){var o=se(e),s=se(t),c=o?"[object Array]":B(e),f=s?"[object Array]":B(t),d=(c=c=="[object Arguments]"?"[object Object]":c)=="[object Object]",h=(f=f=="[object Arguments]"?"[object Object]":f)=="[object Object]",v=c==f;if(v&&xe(e)){if(!xe(t))return!1;o=!0,d=!1}if(v&&!d)return a||(a=new iu),o||fe(e)?fp(e,t,n,r,i,a):mm(e,t,c,n,r,i,a);if(!(1&n)){var m=d&&hp.call(e,"__wrapped__"),g=h&&hp.call(t,"__wrapped__");if(m||g){var _=m?e.value():e,y=g?t.value():t;return a||(a=new iu),i(_,y,n,r,a)}}return!!v&&(a||(a=new iu),dp(e,t,n,r,i,a))},vp=function e(t,n,r,i,a){return t===n||(t==null||n==null||!xi(t)&&!xi(n)?t!=t&&n!=n:gm(t,n,r,i,e,a))},ym=function(e,t,n,r){var i=n.length,a=i,o=!r;if(e==null)return!a;for(e=Object(e);i--;){var s=n[i];if(o&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<a;){var c=(s=n[i])[0],f=e[c],d=s[1];if(o&&s[2]){if(f===void 0&&!(c in e))return!1}else{var h=new iu;if(r)var v=r(f,d,c,e,t,h);if(!(v===void 0?vp(d,f,3,r,h):v))return!1}}return!0},pp=function(e){return e==e&&!Oi(e)},_m=function(e){for(var t=Wt(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,pp(i)]}return t},mp=function(e,t){return function(n){return n!=null&&n[e]===t&&(t!==void 0||e in Object(n))}},Em=function(e){var t=_m(e);return t.length==1&&t[0][2]?mp(t[0][0],t[0][1]):function(n){return n===e||ym(n,e,t)}},Ju=function(e){return typeof e=="symbol"||xi(e)&&Ni(e)=="[object Symbol]"},bm=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Yd=/^\w*$/,cv=function(e,t){if(se(e))return!1;var n=typeof e;return!(n!="number"&&n!="symbol"&&n!="boolean"&&e!=null&&!Ju(e))||Yd.test(e)||!bm.test(e)||t!=null&&e in Object(t)};function fv(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=e.apply(this,r);return n.cache=a.set(i,o)||a,o};return n.cache=new(fv.Cache||Xu),n}fv.Cache=Xu;var wm=fv,xm=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Sm=/\\(\\)?/g,Tm=function(e){var t=wm(e,function(r){return n.size===500&&n.clear(),r}),n=t.cache;return t}(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(xm,function(n,r,i,a){t.push(i?a.replace(Sm,"$1"):r||n)}),t}),Xf=function(e,t){for(var n=-1,r=e==null?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i},gp=di?di.prototype:void 0,yp=gp?gp.toString:void 0,Am=function e(t){if(typeof t=="string")return t;if(se(t))return Xf(t,e)+"";if(Ju(t))return yp?yp.call(t):"";var n=t+"";return n=="0"&&1/t==-Infinity?"-0":n},_p=function(e){return e==null?"":Am(e)},Kd=function(e,t){return se(e)?e:cv(e,t)?[e]:Tm(_p(e))},Bl=function(e){if(typeof e=="string"||Ju(e))return e;var t=e+"";return t=="0"&&1/e==-Infinity?"-0":t},Jd=function(e,t){for(var n=0,r=(t=Kd(t,e)).length;e!=null&&n<r;)e=e[Bl(t[n++])];return n&&n==r?e:void 0},Im=function(e,t,n){var r=e==null?void 0:Jd(e,t);return r===void 0?n:r},Cm=function(e,t){return e!=null&&t in Object(e)},lv=function(e,t,n){for(var r=-1,i=(t=Kd(t,e)).length,a=!1;++r<i;){var o=Bl(t[r]);if(!(a=e!=null&&n(e,o)))break;e=e[o]}return a||++r!=i?a:!!(i=e==null?0:e.length)&&nt(i)&&et(o,i)&&(se(e)||ge(e))},dv=function(e,t){return e!=null&&lv(e,t,Cm)},Rm=function(e,t){return cv(e)&&pp(t)?mp(Bl(e),t):function(n){var r=Im(n,e);return r===void 0&&r===t?dv(n,e):vp(t,r,3)}},Ep=function(e){return function(t){return t==null?void 0:t[e]}},Mm=function(e){return function(t){return Jd(t,e)}},Nm=function(e){return cv(e)?Ep(Bl(e)):Mm(e)},xo=function(e){return typeof e=="function"?e:e==null?hi:typeof e=="object"?se(e)?Rm(e[0],e[1]):Em(e):Nm(e)},bp=function(e,t){return(se(e)?un:eo)(e,xo(t))},Dm=Object.prototype.hasOwnProperty,Pm=function(e,t){return e!=null&&Dm.call(e,t)},wp=function(e,t){return e!=null&&lv(e,t,Pm)},Om=Object.prototype.hasOwnProperty,Lm=function(e){if(e==null)return!0;if(st(e)&&(se(e)||typeof e=="string"||typeof e.splice=="function"||xe(e)||fe(e)||ge(e)))return!e.length;var t=B(e);if(t=="[object Map]"||t=="[object Set]")return!e.size;if(Ze(e))return!He(e).length;for(var n in e)if(Om.call(e,n))return!1;return!0},xp=function(e){return e===void 0},Sp=function(e,t){var n=-1,r=st(e)?Array(e.length):[];return Nr(e,function(i,a,o){r[++n]=t(i,a,o)}),r},Tp=function(e,t){return(se(e)?Xf:Sp)(e,xo(t))},Gm=function(e,t,n,r){var i=-1,a=e==null?0:e.length;for(r&&a&&(n=e[++i]);++i<a;)n=t(n,e[i],i,e);return n},km=function(e,t,n,r,i){return i(e,function(a,o,s){n=r?(r=!1,a):t(n,a,o,s)}),n},zl=function(e,t,n){var r=se(e)?Gm:km,i=arguments.length<3;return r(e,xo(t),n,i,Nr)},Fm=function(e){return typeof e=="string"||!se(e)&&xi(e)&&Ni(e)=="[object String]"},Ap=Ep("length"),Ip=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),hv=function(e){return Ip.test(e)},Cp="[\\ud800-\\udfff]",qd="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Qd="\\ud83c[\\udffb-\\udfff]",vv="[^\\ud800-\\udfff]",Rp="(?:\\ud83c[\\udde6-\\uddff]){2}",Mp="[\\ud800-\\udbff][\\udc00-\\udfff]",Np="(?:"+qd+"|"+Qd+")?",eh="[\\ufe0e\\ufe0f]?"+Np+("(?:\\u200d(?:"+[vv,Rp,Mp].join("|")+")[\\ufe0e\\ufe0f]?"+Np+")*"),th="(?:"+[vv+qd+"?",qd,Rp,Mp,Cp].join("|")+")",Dp=RegExp(Qd+"(?="+Qd+")|"+th+eh,"g"),Um=function(e){for(var t=Dp.lastIndex=0;Dp.test(e);)++t;return t},pv=function(e){return hv(e)?Um(e):Ap(e)},Pp=function(e){if(e==null)return 0;if(st(e))return Fm(e)?pv(e):e.length;var t=B(e);return t=="[object Map]"||t=="[object Set]"?e.size:He(e).length},Bm=function(e,t,n){var r=se(e),i=r||xe(e)||fe(e);if(t=xo(t),n==null){var a=e&&e.constructor;n=i?r?new a:[]:Oi(e)&&Eo(a)?$(_r(e)):{}}return(i?Qa:Hn)(e,function(o,s,c){return t(n,o,s,c)}),n},Op=di?di.isConcatSpreadable:void 0,zm=function(e){return se(e)||ge(e)||!!(Op&&e&&e[Op])},mv=function e(t,n,r,i,a){var o=-1,s=t.length;for(r||(r=zm),a||(a=[]);++o<s;){var c=t[o];n>0&&r(c)?n>1?e(c,n-1,r,i,a):Zr(a,c):i||(a[a.length]=c)}return a},Wm=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},Lp=Math.max,Gp=function(e,t,n){return t=Lp(t===void 0?e.length-1:t,0),function(){for(var r=arguments,i=-1,a=Lp(r.length-t,0),o=Array(a);++i<a;)o[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(o),Wm(e,this,s)}},Vm=Wc?function(e,t){return Wc(e,"toString",{configurable:!0,enumerable:!1,value:$t(t),writable:!0})}:hi,Zm=Date.now,kp=function(e){var t=0,n=0;return function(){var r=Zm(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Vm),nh=function(e,t){return kp(Gp(e,t,hi),e+"")},Fp=function(e,t,n,r){for(var i=e.length,a=n+(r?1:-1);r?a--:++a<i;)if(t(e[a],a,e))return a;return-1},Ko=function(e){return e!=e},jm=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1},Hm=function(e,t,n){return t==t?jm(e,t,n):Fp(e,Ko,n)},Zc=function(e,t){return!!(e==null?0:e.length)&&Hm(e,t,0)>-1},Vn=function(e,t,n){for(var r=-1,i=e==null?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1},Xm=function(){},La=oi&&1/ov(new oi([,-0]))[1]==1/0?function(e){return new oi(e)}:Xm,Di=function(e,t,n){var r=-1,i=Zc,a=e.length,o=!0,s=[],c=s;if(n)o=!1,i=Vn;else if(a>=200){var f=t?null:La(e);if(f)return ov(f);o=!1,i=cp,c=new up}else c=t?[]:s;e:for(;++r<a;){var d=e[r],h=t?t(d):d;if(d=n||d!==0?d:0,o&&h==h){for(var v=c.length;v--;)if(c[v]===h)continue e;t&&c.push(h),s.push(d)}else i(c,h,n)||(c!==s&&c.push(h),s.push(d))}return s},Up=function(e){return xi(e)&&st(e)},qu=nh(function(e){return Di(mv(e,1,Up,!0))}),$m=function(e,t){return Xf(t,function(n){return e[n]})},rh,Bp=function(e){return e==null?[]:$m(e,Wt(e))};try{rh={clone:Ft,constant:$t,each:Ul,filter:bp,has:wp,isArray:se,isEmpty:Lm,isFunction:Eo,isUndefined:xp,keys:Wt,map:Tp,reduce:zl,size:Pp,transform:Bm,union:qu,values:Bp}}catch(e){}rh||(rh=window._);var zt=rh,gv=tr;function tr(e){this._isDirected=!zt.has(e,"directed")||e.directed,this._isMultigraph=!!zt.has(e,"multigraph")&&e.multigraph,this._isCompound=!!zt.has(e,"compound")&&e.compound,this._label=void 0,this._defaultNodeLabelFn=zt.constant(void 0),this._defaultEdgeLabelFn=zt.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function zp(e,t){e[t]?e[t]++:e[t]=1}function Is(e,t){--e[t]||delete e[t]}function $f(e,t,n,r){var i=""+t,a=""+n;if(!e&&i>a){var o=i;i=a,a=o}return i+""+a+""+(zt.isUndefined(r)?"\0":r)}function ih(e,t,n,r){var i=""+t,a=""+n;if(!e&&i>a){var o=i;i=a,a=o}var s={v:i,w:a};return r&&(s.name=r),s}function ui(e,t){return $f(e,t.v,t.w,t.name)}tr.prototype._nodeCount=0,tr.prototype._edgeCount=0,tr.prototype.isDirected=function(){return this._isDirected},tr.prototype.isMultigraph=function(){return this._isMultigraph},tr.prototype.isCompound=function(){return this._isCompound},tr.prototype.setGraph=function(e){return this._label=e,this},tr.prototype.graph=function(){return this._label},tr.prototype.setDefaultNodeLabel=function(e){return zt.isFunction(e)||(e=zt.constant(e)),this._defaultNodeLabelFn=e,this},tr.prototype.nodeCount=function(){return this._nodeCount},tr.prototype.nodes=function(){return zt.keys(this._nodes)},tr.prototype.sources=function(){var e=this;return zt.filter(this.nodes(),function(t){return zt.isEmpty(e._in[t])})},tr.prototype.sinks=function(){var e=this;return zt.filter(this.nodes(),function(t){return zt.isEmpty(e._out[t])})},tr.prototype.setNodes=function(e,t){var n=arguments,r=this;return zt.each(e,function(i){n.length>1?r.setNode(i,t):r.setNode(i)}),this},tr.prototype.setNode=function(e,t){return zt.has(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]="\0",this._children[e]={},this._children["\0"][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)},tr.prototype.node=function(e){return this._nodes[e]},tr.prototype.hasNode=function(e){return zt.has(this._nodes,e)},tr.prototype.removeNode=function(e){var t=this;if(zt.has(this._nodes,e)){var n=function(r){t.removeEdge(t._edgeObjs[r])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],zt.each(this.children(e),function(r){t.setParent(r)}),delete this._children[e]),zt.each(zt.keys(this._in[e]),n),delete this._in[e],delete this._preds[e],zt.each(zt.keys(this._out[e]),n),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},tr.prototype.setParent=function(e,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(zt.isUndefined(t))t="\0";else{for(var n=t+="";!zt.isUndefined(n);n=this.parent(n))if(n===e)throw new Error("Setting "+t+" as parent of "+e+" would create a cycle");this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this},tr.prototype._removeFromParentsChildList=function(e){delete this._children[this._parent[e]][e]},tr.prototype.parent=function(e){if(this._isCompound){var t=this._parent[e];if(t!=="\0")return t}},tr.prototype.children=function(e){if(zt.isUndefined(e)&&(e="\0"),this._isCompound){var t=this._children[e];if(t)return zt.keys(t)}else{if(e==="\0")return this.nodes();if(this.hasNode(e))return[]}},tr.prototype.predecessors=function(e){var t=this._preds[e];if(t)return zt.keys(t)},tr.prototype.successors=function(e){var t=this._sucs[e];if(t)return zt.keys(t)},tr.prototype.neighbors=function(e){var t=this.predecessors(e);if(t)return zt.union(t,this.successors(e))},tr.prototype.isLeaf=function(e){return(this.isDirected()?this.successors(e):this.neighbors(e)).length===0},tr.prototype.filterNodes=function(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var n=this;zt.each(this._nodes,function(a,o){e(o)&&t.setNode(o,a)}),zt.each(this._edgeObjs,function(a){t.hasNode(a.v)&&t.hasNode(a.w)&&t.setEdge(a,n.edge(a))});var r={};function i(a){var o=n.parent(a);return o===void 0||t.hasNode(o)?(r[a]=o,o):o in r?r[o]:i(o)}return this._isCompound&&zt.each(t.nodes(),function(a){t.setParent(a,i(a))}),t},tr.prototype.setDefaultEdgeLabel=function(e){return zt.isFunction(e)||(e=zt.constant(e)),this._defaultEdgeLabelFn=e,this},tr.prototype.edgeCount=function(){return this._edgeCount},tr.prototype.edges=function(){return zt.values(this._edgeObjs)},tr.prototype.setPath=function(e,t){var n=this,r=arguments;return zt.reduce(e,function(i,a){return r.length>1?n.setEdge(i,a,t):n.setEdge(i,a),a}),this},tr.prototype.setEdge=function(){var e,t,n,r,i=!1,a=arguments[0];typeof a=="object"&&a!==null&&"v"in a?(e=a.v,t=a.w,n=a.name,arguments.length===2&&(r=arguments[1],i=!0)):(e=a,t=arguments[1],n=arguments[3],arguments.length>2&&(r=arguments[2],i=!0)),e=""+e,t=""+t,zt.isUndefined(n)||(n=""+n);var o=$f(this._isDirected,e,t,n);if(zt.has(this._edgeLabels,o))return i&&(this._edgeLabels[o]=r),this;if(!zt.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[o]=i?r:this._defaultEdgeLabelFn(e,t,n);var s=ih(this._isDirected,e,t,n);return e=s.v,t=s.w,Object.freeze(s),this._edgeObjs[o]=s,zp(this._preds[t],e),zp(this._sucs[e],t),this._in[t][o]=s,this._out[e][o]=s,this._edgeCount++,this},tr.prototype.edge=function(e,t,n){var r=arguments.length===1?ui(this._isDirected,arguments[0]):$f(this._isDirected,e,t,n);return this._edgeLabels[r]},tr.prototype.hasEdge=function(e,t,n){var r=arguments.length===1?ui(this._isDirected,arguments[0]):$f(this._isDirected,e,t,n);return zt.has(this._edgeLabels,r)},tr.prototype.removeEdge=function(e,t,n){var r=arguments.length===1?ui(this._isDirected,arguments[0]):$f(this._isDirected,e,t,n),i=this._edgeObjs[r];return i&&(e=i.v,t=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],Is(this._preds[t],e),Is(this._sucs[e],t),delete this._in[t][r],delete this._out[e][r],this._edgeCount--),this},tr.prototype.inEdges=function(e,t){var n=this._in[e];if(n){var r=zt.values(n);return t?zt.filter(r,function(i){return i.v===t}):r}},tr.prototype.outEdges=function(e,t){var n=this._out[e];if(n){var r=zt.values(n);return t?zt.filter(r,function(i){return i.w===t}):r}},tr.prototype.nodeEdges=function(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t))};var vi={Graph:gv,version:"2.1.8"},Wp={write:function(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:Ym(e),edges:Km(e)};return zt.isUndefined(e.graph())||(t.value=zt.clone(e.graph())),t},read:function(e){var t=new gv(e.options).setGraph(e.value);return zt.each(e.nodes,function(n){t.setNode(n.v,n.value),n.parent&&t.setParent(n.v,n.parent)}),zt.each(e.edges,function(n){t.setEdge({v:n.v,w:n.w,name:n.name},n.value)}),t}};function Ym(e){return zt.map(e.nodes(),function(t){var n=e.node(t),r=e.parent(t),i={v:t};return zt.isUndefined(n)||(i.value=n),zt.isUndefined(r)||(i.parent=r),i})}function Km(e){return zt.map(e.edges(),function(t){var n=e.edge(t),r={v:t.v,w:t.w};return zt.isUndefined(t.name)||(r.name=t.name),zt.isUndefined(n)||(r.value=n),r})}var Jm=function(e){var t,n={},r=[];function i(a){zt.has(n,a)||(n[a]=!0,t.push(a),zt.each(e.successors(a),i),zt.each(e.predecessors(a),i))}return zt.each(e.nodes(),function(a){t=[],i(a),t.length&&r.push(t)}),r},Vp=So;function So(){this._arr=[],this._keyIndices={}}So.prototype.size=function(){return this._arr.length},So.prototype.keys=function(){return this._arr.map(function(e){return e.key})},So.prototype.has=function(e){return zt.has(this._keyIndices,e)},So.prototype.priority=function(e){var t=this._keyIndices[e];if(t!==void 0)return this._arr[t].priority},So.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},So.prototype.add=function(e,t){var n=this._keyIndices;if(e=String(e),!zt.has(n,e)){var r=this._arr,i=r.length;return n[e]=i,r.push({key:e,priority:t}),this._decrease(i),!0}return!1},So.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},So.prototype.decrease=function(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+t);this._arr[n].priority=t,this._decrease(n)},So.prototype._heapify=function(e){var t=this._arr,n=2*e,r=n+1,i=e;n<t.length&&(i=t[n].priority<t[i].priority?n:i,r<t.length&&(i=t[r].priority<t[i].priority?r:i),i!==e&&(this._swap(e,i),this._heapify(i)))},So.prototype._decrease=function(e){for(var t,n=this._arr,r=n[e].priority;e!==0&&!(n[t=e>>1].priority<r);)this._swap(e,t),e=t},So.prototype._swap=function(e,t){var n=this._arr,r=this._keyIndices,i=n[e],a=n[t];n[e]=a,n[t]=i,r[a.key]=e,r[i.key]=t};var Zp=function(e,t,n,r){return function(i,a,o,s){var c,f,d={},h=new Vp,v=function(m){var g=m.v!==c?m.v:m.w,_=d[g],y=o(m),E=f.distance+y;if(y<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+m+" Weight: "+y);E<_.distance&&(_.distance=E,_.predecessor=c,h.decrease(g,E))};for(i.nodes().forEach(function(m){var g=m===a?0:Number.POSITIVE_INFINITY;d[m]={distance:g},h.add(m,g)});h.size()>0&&(c=h.removeMin(),(f=d[c]).distance!==Number.POSITIVE_INFINITY);)s(c).forEach(v);return d}(e,String(t),n||jp,r||function(i){return e.outEdges(i)})},jp=zt.constant(1),Wl=function(e,t,n){return zt.transform(e.nodes(),function(r,i){r[i]=Zp(e,i,t,n)},{})},ah=function(e){var t=0,n=[],r={},i=[];function a(o){var s=r[o]={onStack:!0,lowlink:t,index:t++};if(n.push(o),e.successors(o).forEach(function(d){zt.has(r,d)?r[d].onStack&&(s.lowlink=Math.min(s.lowlink,r[d].index)):(a(d),s.lowlink=Math.min(s.lowlink,r[d].lowlink))}),s.lowlink===s.index){var c,f=[];do c=n.pop(),r[c].onStack=!1,f.push(c);while(o!==c);i.push(f)}}return e.nodes().forEach(function(o){zt.has(r,o)||a(o)}),i},qm=function(e){return zt.filter(ah(e),function(t){return t.length>1||t.length===1&&e.hasEdge(t[0],t[0])})},Hp=function(e,t,n){return function(r,i,a){var o={},s=r.nodes();return s.forEach(function(c){o[c]={},o[c][c]={distance:0},s.forEach(function(f){c!==f&&(o[c][f]={distance:Number.POSITIVE_INFINITY})}),a(c).forEach(function(f){var d=f.v===c?f.w:f.v,h=i(f);o[c][d]={distance:h,predecessor:c}})}),s.forEach(function(c){var f=o[c];s.forEach(function(d){var h=o[d];s.forEach(function(v){var m=h[c],g=f[v],_=h[v],y=m.distance+g.distance;y<_.distance&&(_.distance=y,_.predecessor=g.predecessor)})})}),o}(e,t||oh,n||function(r){return e.outEdges(r)})},oh=zt.constant(1),Aa=jc;function jc(e){var t={},n={},r=[];if(zt.each(e.sinks(),function i(a){if(zt.has(n,a))throw new sh;zt.has(t,a)||(n[a]=!0,t[a]=!0,zt.each(e.predecessors(a),i),delete n[a],r.push(a))}),zt.size(t)!==e.nodeCount())throw new sh;return r}function sh(){}jc.CycleException=sh,sh.prototype=new Error;var Xp=function(e,t,n){zt.isArray(t)||(t=[t]);var r=(e.isDirected()?e.successors:e.neighbors).bind(e),i=[],a={};return zt.each(t,function(o){if(!e.hasNode(o))throw new Error("Graph does not have node: "+o);$p(e,o,n==="post",a,r,i)}),i};function $p(e,t,n,r,i,a){zt.has(r,t)||(r[t]=!0,n||a.push(t),zt.each(i(t),function(o){$p(e,o,n,r,i,a)}),n&&a.push(t))}var uh,Qm={Graph:vi.Graph,json:Wp,alg:{components:Jm,dijkstra:Zp,dijkstraAll:Wl,findCycles:qm,floydWarshall:Hp,isAcyclic:function(e){try{Aa(e)}catch(t){if(t instanceof Aa.CycleException)return!1;throw t}return!0},postorder:function(e,t){return Xp(e,t,"post")},preorder:function(e,t){return Xp(e,t,"pre")},prim:function(e,t){var n,r=new gv,i={},a=new Vp;function o(c){var f=c.v===n?c.w:c.v,d=a.priority(f);if(d!==void 0){var h=t(c);h<d&&(i[f]=n,a.decrease(f,h))}}if(e.nodeCount()===0)return r;zt.each(e.nodes(),function(c){a.add(c,Number.POSITIVE_INFINITY),r.setNode(c)}),a.decrease(e.nodes()[0],0);for(var s=!1;a.size()>0;){if(n=a.removeMin(),zt.has(i,n))r.setEdge(n,i[n]);else{if(s)throw new Error("Input graph is not connected: "+e);s=!0}e.nodeEdges(n).forEach(o)}return r},tarjan:ah,topsort:Aa},version:vi.version};try{uh=Qm}catch(e){}uh||(uh=window.graphlib);var To=uh,au=function(e){return yn(e,5)},Bn=function(e,t,n){if(!Oi(n))return!1;var r=typeof t;return!!(r=="number"?st(n)&&et(t,n.length):r=="string"&&t in n)&&zu(n[t],e)},yv=Object.prototype,Ao=yv.hasOwnProperty,Yp=nh(function(e,t){e=Object(e);var n=-1,r=t.length,i=r>2?t[2]:void 0;for(i&&Bn(t[0],t[1],i)&&(r=1);++n<r;)for(var a=t[n],o=Kt(a),s=-1,c=o.length;++s<c;){var f=o[s],d=e[f];(d===void 0||zu(d,yv[f])&&!Ao.call(e,f))&&(e[f]=a[f])}return e}),eg=function(e){return function(t,n,r){var i=Object(t);if(!st(t)){var a=xo(n);t=Wt(t),n=function(s){return a(i[s],s,i)}}var o=e(t,n,r);return o>-1?i[a?t[o]:o]:void 0}},Ir=/^\s+|\s+$/g,tg=/^[-+]0x[0-9a-f]+$/i,Kp=/^0b[01]+$/i,ch=/^0o[0-7]+$/i,ng=parseInt,rg=function(e){if(typeof e=="number")return e;if(Ju(e))return NaN;if(Oi(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Oi(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(Ir,"");var n=Kp.test(e);return n||ch.test(e)?ng(e.slice(2),n?2:8):tg.test(e)?NaN:+e},fh=function(e){return e?(e=rg(e))===Infinity||e===-Infinity?17976931348623157e292*(e<0?-1:1):e==e?e:0:e===0?e:0},ig=function(e){var t=fh(e),n=t%1;return t==t?n?t-n:t:0},ag=Math.max,og=eg(function(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var i=n==null?0:ig(n);return i<0&&(i=ag(r+i,0)),Fp(e,xo(t),i)}),Jp=function(e){return(e==null?0:e.length)?mv(e,1):[]},sg=function(e,t){return e==null?e:fn(e,Hf(t),Kt)},ug=function(e){var t=e==null?0:e.length;return t?e[t-1]:void 0},cg=function(e,t){var n={};return t=xo(t),Hn(e,function(r,i,a){Yu(n,i,t(r,i,a))}),n},_v=function(e,t,n){for(var r=-1,i=e.length;++r<i;){var a=e[r],o=t(a);if(o!=null&&(s===void 0?o==o&&!Ju(o):n(o,s)))var s=o,c=a}return c},fg=function(e,t){return e>t},lg=function(e){return e&&e.length?_v(e,hi,fg):void 0},Vl=function(e,t,n){(n!==void 0&&!zu(e[t],n)||n===void 0&&!(t in e))&&Yu(e,t,n)},dg=Function.prototype,Ev=Object.prototype,qp=dg.toString,hg=Ev.hasOwnProperty,vg=qp.call(Object),$i=function(e){if(!xi(e)||Ni(e)!="[object Object]")return!1;var t=_r(e);if(t===null)return!0;var n=hg.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&qp.call(n)==vg},va=function(e,t){if((t!=="constructor"||typeof e[t]!="function")&&t!="__proto__")return e[t]},pg=function(e){return Vc(e,Kt(e))},mg=function(e,t,n,r,i,a,o){var s=va(e,n),c=va(t,n),f=o.get(c);if(f)Vl(e,n,f);else{var d=a?a(s,c,n+"",e,t,o):void 0,h=d===void 0;if(h){var v=se(c),m=!v&&xe(c),g=!v&&!m&&fe(c);d=c,v||m||g?se(s)?d=s:Up(s)?d=Dn(s):m?(h=!1,d=kt(c,!0)):g?(h=!1,d=K(c,!0)):d=[]:$i(c)||ge(c)?(d=s,ge(s)?d=pg(s):Oi(s)&&!Eo(s)||(d=L(c))):h=!1}h&&(o.set(c,d),i(d,c,r,a,o),o.delete(c)),Vl(e,n,d)}},gg=function e(t,n,r,i,a){t!==n&&fn(n,function(o,s){if(a||(a=new iu),Oi(o))mg(t,n,s,r,e,i,a);else{var c=i?i(va(t,s),o,s+"",t,n,a):void 0;c===void 0&&(c=o),Vl(t,s,c)}},Kt)},Qp=function(e){return nh(function(t,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,o=i>2?n[2]:void 0;for(a=e.length>3&&typeof a=="function"?(i--,a):void 0,o&&Bn(n[0],n[1],o)&&(a=i<3?void 0:a,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,a)}return t})}(function(e,t,n){gg(e,t,n)}),e0=function(e,t){return e<t},yg=function(e){return e&&e.length?_v(e,hi,e0):void 0},_g=function(e,t){return e&&e.length?_v(e,xo(t),e0):void 0},t0=function(){return Fr.Date.now()},Eg=function(e,t,n,r){if(!Oi(e))return e;for(var i=-1,a=(t=Kd(t,e)).length,o=a-1,s=e;s!=null&&++i<a;){var c=Bl(t[i]),f=n;if(c==="__proto__"||c==="constructor"||c==="prototype")return e;if(i!=o){var d=s[c];(f=r?r(d,c,s):void 0)===void 0&&(f=Oi(d)?d:et(t[i+1])?[]:{})}Ku(s,c,f),s=s[c]}return e},bg=function(e,t,n){for(var r=-1,i=t.length,a={};++r<i;){var o=t[r],s=Jd(e,o);n(s,o)&&Eg(a,Kd(o,e),s)}return a},wg=function(e,t){return bg(e,t,function(n,r){return dv(e,r)})},n0=function(e){return kp(Gp(e,void 0,Jp),e+"")}(function(e,t){return e==null?{}:wg(e,t)}),r0=Math.ceil,xg=Math.max,Sg=function(e,t,n,r){for(var i=-1,a=xg(r0((t-e)/(n||1)),0),o=Array(a);a--;)o[r?a:++i]=e,e+=n;return o},Tg=function(e){return function(t,n,r){return r&&typeof r!="number"&&Bn(t,n,r)&&(n=r=void 0),t=fh(t),n===void 0?(n=t,t=0):n=fh(n),r=r===void 0?t<n?1:-1:fh(r),Sg(t,n,r,e)}}(),Ag=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e},Yf=function(e,t){if(e!==t){var n=e!==void 0,r=e===null,i=e==e,a=Ju(e),o=t!==void 0,s=t===null,c=t==t,f=Ju(t);if(!s&&!f&&!a&&e>t||a&&o&&c&&!s&&!f||r&&o&&c||!n&&c||!i)return 1;if(!r&&!a&&!f&&e<t||f&&n&&i&&!r&&!a||s&&n&&i||!o&&i||!c)return-1}return 0},Ig=function(e,t,n){for(var r=-1,i=e.criteria,a=t.criteria,o=i.length,s=n.length;++r<o;){var c=Yf(i[r],a[r]);if(c)return r>=s?c:c*(n[r]=="desc"?-1:1)}return e.index-t.index},Cg=function(e,t,n){t=t.length?Xf(t,function(a){return se(a)?function(o){return Jd(o,a.length===1?a[0]:a)}:a}):[hi];var r=-1;t=Xf(t,_t(xo));var i=Sp(e,function(a,o,s){return{criteria:Xf(t,function(c){return c(a)}),index:++r,value:a}});return Ag(i,function(a,o){return Ig(a,o,n)})},Rg=nh(function(e,t){if(e==null)return[];var n=t.length;return n>1&&Bn(e,t[0],t[1])?t=[]:n>2&&Bn(t[0],t[1],t[2])&&(t=[t[0]]),Cg(e,mv(t,1),[])}),Mg=0,Ng=function(e){var t=++Mg;return _p(e)+t},i0=function(e,t,n){for(var r=-1,i=e.length,a=t.length,o={};++r<i;){var s=r<a?t[r]:void 0;n(o,e[r],s)}return o},Zl,Dg=function(e,t){return i0(e||[],t||[],Ku)};try{Zl={cloneDeep:au,constant:$t,defaults:Yp,each:Ul,filter:bp,find:og,flatten:Jp,forEach:Ta,forIn:sg,has:wp,isUndefined:xp,last:ug,map:Tp,mapValues:cg,max:lg,merge:Qp,min:yg,minBy:_g,now:t0,pick:n0,range:Tg,reduce:zl,sortBy:Rg,uniqueId:Ng,values:Bp,zipObject:Dg}}catch(e){}Zl||(Zl=window._);var J=Zl,Pg=lh;function lh(){var e={};e._next=e._prev=e,this._sentinel=e}function a0(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function Og(e,t){if(e!=="_next"&&e!=="_prev")return t}lh.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return a0(t),t},lh.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&a0(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t},lh.prototype.toString=function(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,Og)),n=n._prev;return"["+e.join(", ")+"]"};var Lg=To.Graph,Gg=function(e,t){if(e.nodeCount()<=1)return[];var n=function(i,a){var o=new Lg,s=0,c=0;J.forEach(i.nodes(),function(h){o.setNode(h,{v:h,in:0,out:0})}),J.forEach(i.edges(),function(h){var v=o.edge(h.v,h.w)||0,m=a(h),g=v+m;o.setEdge(h.v,h.w,g),c=Math.max(c,o.node(h.v).out+=m),s=Math.max(s,o.node(h.w).in+=m)});var f=J.range(c+s+3).map(function(){return new Pg}),d=s+1;return J.forEach(o.nodes(),function(h){wv(f,d,o.node(h))}),{graph:o,buckets:f,zeroIdx:d}}(e,t||kg),r=function(i,a,o){for(var s,c=[],f=a[a.length-1],d=a[0];i.nodeCount();){for(;s=d.dequeue();)bv(i,a,o,s);for(;s=f.dequeue();)bv(i,a,o,s);if(i.nodeCount()){for(var h=a.length-2;h>0;--h)if(s=a[h].dequeue()){c=c.concat(bv(i,a,o,s,!0));break}}}return c}(n.graph,n.buckets,n.zeroIdx);return J.flatten(J.map(r,function(i){return e.outEdges(i.v,i.w)}),!0)},kg=J.constant(1);function bv(e,t,n,r,i){var a=i?[]:void 0;return J.forEach(e.inEdges(r.v),function(o){var s=e.edge(o),c=e.node(o.v);i&&a.push({v:o.v,w:o.w}),c.out-=s,wv(t,n,c)}),J.forEach(e.outEdges(r.v),function(o){var s=e.edge(o),c=o.w,f=e.node(c);f.in-=s,wv(t,n,f)}),e.removeNode(r.v),a}function wv(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}var o0={run:function(e){var t=e.graph().acyclicer==="greedy"?Gg(e,function(n){return function(r){return n.edge(r).weight}}(e)):function(n){var r=[],i={},a={};function o(s){J.has(a,s)||(a[s]=!0,i[s]=!0,J.forEach(n.outEdges(s),function(c){J.has(i,c.w)?r.push(c):o(c.w)}),delete i[s])}return J.forEach(n.nodes(),o),r}(e);J.forEach(t,function(n){var r=e.edge(n);e.removeEdge(n),r.forwardName=n.name,r.reversed=!0,e.setEdge(n.w,n.v,r,J.uniqueId("rev"))})},undo:function(e){J.forEach(e.edges(),function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}},s0=To.Graph,Yi={addDummyNode:u0,simplify:function(e){var t=new s0().setGraph(e.graph());return J.forEach(e.nodes(),function(n){t.setNode(n,e.node(n))}),J.forEach(e.edges(),function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},i=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})}),t},asNonCompoundGraph:function(e){var t=new s0({multigraph:e.isMultigraph()}).setGraph(e.graph());return J.forEach(e.nodes(),function(n){e.children(n).length||t.setNode(n,e.node(n))}),J.forEach(e.edges(),function(n){t.setEdge(n,e.edge(n))}),t},successorWeights:function(e){var t=J.map(e.nodes(),function(n){var r={};return J.forEach(e.outEdges(n),function(i){r[i.w]=(r[i.w]||0)+e.edge(i).weight}),r});return J.zipObject(e.nodes(),t)},predecessorWeights:function(e){var t=J.map(e.nodes(),function(n){var r={};return J.forEach(e.inEdges(n),function(i){r[i.v]=(r[i.v]||0)+e.edge(i).weight}),r});return J.zipObject(e.nodes(),t)},intersectRect:function(e,t){var n,r,i=e.x,a=e.y,o=t.x-i,s=t.y-a,c=e.width/2,f=e.height/2;if(!o&&!s)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(s)*c>Math.abs(o)*f?(s<0&&(f=-f),n=f*o/s,r=f):(o<0&&(c=-c),n=c,r=c*s/o),{x:i+n,y:a+r}},buildLayerMatrix:function(e){var t=J.map(J.range(c0(e)+1),function(){return[]});return J.forEach(e.nodes(),function(n){var r=e.node(n),i=r.rank;J.isUndefined(i)||(t[i][r.order]=n)}),t},normalizeRanks:function(e){var t=J.min(J.map(e.nodes(),function(n){return e.node(n).rank}));J.forEach(e.nodes(),function(n){var r=e.node(n);J.has(r,"rank")&&(r.rank-=t)})},removeEmptyRanks:function(e){var t=J.min(J.map(e.nodes(),function(a){return e.node(a).rank})),n=[];J.forEach(e.nodes(),function(a){var o=e.node(a).rank-t;n[o]||(n[o]=[]),n[o].push(a)});var r=0,i=e.graph().nodeRankFactor;J.forEach(n,function(a,o){J.isUndefined(a)&&o%i!=0?--r:r&&J.forEach(a,function(s){e.node(s).rank+=r})})},addBorderNode:function(e,t,n,r){var i={width:0,height:0};return arguments.length>=4&&(i.rank=n,i.order=r),u0(e,"border",i,t)},maxRank:c0,partition:function(e,t){var n={lhs:[],rhs:[]};return J.forEach(e,function(r){t(r)?n.lhs.push(r):n.rhs.push(r)}),n},time:function(e,t){var n=J.now();try{return t()}finally{console.log(e+" time: "+(J.now()-n)+"ms")}},notime:function(e,t){return t()}};function u0(e,t,n,r){var i;do i=J.uniqueId(r);while(e.hasNode(i));return n.dummy=t,e.setNode(i,n),i}function c0(e){return J.max(J.map(e.nodes(),function(t){var n=e.node(t).rank;if(!J.isUndefined(n))return n}))}var f0={run:function(e){e.graph().dummyChains=[],J.forEach(e.edges(),function(t){(function(n,r){var i,a,o,s=r.v,c=n.node(s).rank,f=r.w,d=n.node(f).rank,h=r.name,v=n.edge(r),m=v.labelRank;if(d!==c+1){for(n.removeEdge(r),o=0,++c;c<d;++o,++c)v.points=[],a={width:0,height:0,edgeLabel:v,edgeObj:r,rank:c},i=Yi.addDummyNode(n,"edge",a,"_d"),c===m&&(a.width=v.width,a.height=v.height,a.dummy="edge-label",a.labelpos=v.labelpos),n.setEdge(s,i,{weight:v.weight},h),o===0&&n.graph().dummyChains.push(i),s=i;n.setEdge(s,f,{weight:v.weight},h)}})(e,t)})},undo:function(e){J.forEach(e.graph().dummyChains,function(t){var n,r=e.node(t),i=r.edgeLabel;for(e.setEdge(r.edgeObj,i);r.dummy;)n=e.successors(t)[0],e.removeNode(t),i.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height),t=n,r=e.node(t)})}},l0=function(e){var t={};J.forEach(e.sources(),function n(r){var i=e.node(r);if(J.has(t,r))return i.rank;t[r]=!0;var a=J.min(J.map(e.outEdges(r),function(o){return n(o.w)-e.edge(o).minlen}));return a!==Number.POSITIVE_INFINITY&&a!=null||(a=0),i.rank=a})},d0=function(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen},Fg=To.Graph,dh=d0,h0=function(e){var t,n,r=new Fg({directed:!1}),i=e.nodes()[0],a=e.nodeCount();for(r.setNode(i,{});Ug(r,e)<a;)t=Bg(r,e),n=r.hasNode(t.v)?dh(e,t):-dh(e,t),zg(r,e,n);return r};function Ug(e,t){return J.forEach(e.nodes(),function n(r){J.forEach(t.nodeEdges(r),function(i){var a=i.v,o=r===a?i.w:a;e.hasNode(o)||dh(t,i)||(e.setNode(o,{}),e.setEdge(r,o,{}),n(o))})}),e.nodeCount()}function Bg(e,t){return J.minBy(t.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return dh(t,n)})}function zg(e,t,n){J.forEach(e.nodes(),function(r){t.node(r).rank+=n})}var xv=d0,v0=l0,p0=To.alg.preorder,Wg=To.alg.postorder,Vg=Yi.simplify,Zg=ou;function ou(e){e=Vg(e),v0(e);var t,n=h0(e);for(Tv(n),Sv(n,e);t=hh(n);)y0(n,e,t,g0(n,e,t))}function Sv(e,t){var n=Wg(e,e.nodes());n=n.slice(0,n.length-1),J.forEach(n,function(r){(function(i,a,o){var s=i.node(o).parent;i.edge(o,s).cutvalue=m0(i,a,o)})(e,t,r)})}function m0(e,t,n){var r=e.node(n).parent,i=!0,a=t.edge(n,r),o=0;return a||(i=!1,a=t.edge(r,n)),o=a.weight,J.forEach(t.nodeEdges(n),function(s){var c,f,d=s.v===n,h=d?s.w:s.v;if(h!==r){var v=d===i,m=t.edge(s).weight;if(o+=v?m:-m,c=n,f=h,e.hasEdge(c,f)){var g=e.edge(n,h).cutvalue;o+=v?-g:g}}}),o}function Tv(e,t){arguments.length<2&&(t=e.nodes()[0]),Ia(e,{},1,t)}function Ia(e,t,n,r,i){var a=n,o=e.node(r);return t[r]=!0,J.forEach(e.neighbors(r),function(s){J.has(t,s)||(n=Ia(e,t,n,s,r))}),o.low=a,o.lim=n++,i?o.parent=i:delete o.parent,n}function hh(e){return J.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function g0(e,t,n){var r=n.v,i=n.w;t.hasEdge(r,i)||(r=n.w,i=n.v);var a=e.node(r),o=e.node(i),s=a,c=!1;a.lim>o.lim&&(s=o,c=!0);var f=J.filter(t.edges(),function(d){return c===_0(e,e.node(d.v),s)&&c!==_0(e,e.node(d.w),s)});return J.minBy(f,function(d){return xv(t,d)})}function y0(e,t,n,r){var i=n.v,a=n.w;e.removeEdge(i,a),e.setEdge(r.v,r.w,{}),Tv(e),Sv(e,t),function(o,s){var c=J.find(o.nodes(),function(d){return!s.node(d).parent}),f=p0(o,c);f=f.slice(1),J.forEach(f,function(d){var h=o.node(d).parent,v=s.edge(d,h),m=!1;v||(v=s.edge(h,d),m=!0),s.node(d).rank=s.node(h).rank+(m?v.minlen:-v.minlen)})}(e,t)}function _0(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}ou.initLowLimValues=Tv,ou.initCutValues=Sv,ou.calcCutValue=m0,ou.leaveEdge=hh,ou.enterEdge=g0,ou.exchangeEdges=y0;var E0=l0,Av=function(e){switch(e.graph().ranker){case"network-simplex":vh(e);break;case"tight-tree":(function(t){E0(t),h0(t)})(e);break;case"longest-path":jg(e);break;default:vh(e)}},jg=E0;function vh(e){Zg(e)}var Hg=function(e){var t=function(n){var r={},i=0;function a(o){var s=i;J.forEach(n.children(o),a),r[o]={low:s,lim:i++}}return J.forEach(n.children(),a),r}(e);J.forEach(e.graph().dummyChains,function(n){for(var r=e.node(n),i=r.edgeObj,a=function(h,v,m,g){var _,y,E=[],b=[],A=Math.min(v[m].low,v[g].low),C=Math.max(v[m].lim,v[g].lim);_=m;do _=h.parent(_),E.push(_);while(_&&(v[_].low>A||C>v[_].lim));for(y=_,_=g;(_=h.parent(_))!==y;)b.push(_);return{path:E.concat(b.reverse()),lca:y}}(e,t,i.v,i.w),o=a.path,s=a.lca,c=0,f=o[c],d=!0;n!==i.w;){if(r=e.node(n),d){for(;(f=o[c])!==s&&e.node(f).maxRank<r.rank;)c++;f===s&&(d=!1)}if(!d){for(;c<o.length-1&&e.node(f=o[c+1]).minRank<=r.rank;)c++;f=o[c]}e.setParent(n,f),n=e.successors(n)[0]}})},b0={run:function(e){var t=Yi.addDummyNode(e,"root",{},"_root"),n=function(o){var s={};function c(f,d){var h=o.children(f);h&&h.length&&J.forEach(h,function(v){c(v,d+1)}),s[f]=d}return J.forEach(o.children(),function(f){c(f,1)}),s}(e),r=J.max(J.values(n))-1,i=2*r+1;e.graph().nestingRoot=t,J.forEach(e.edges(),function(o){e.edge(o).minlen*=i});var a=function(o){return J.reduce(o.edges(),function(s,c){return s+o.edge(c).weight},0)}(e)+1;J.forEach(e.children(),function(o){w0(e,t,i,a,r,n,o)}),e.graph().nodeRankFactor=i},cleanup:function(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,J.forEach(e.edges(),function(n){e.edge(n).nestingEdge&&e.removeEdge(n)})}};function w0(e,t,n,r,i,a,o){var s=e.children(o);if(s.length){var c=Yi.addBorderNode(e,"_bt"),f=Yi.addBorderNode(e,"_bb"),d=e.node(o);e.setParent(c,o),d.borderTop=c,e.setParent(f,o),d.borderBottom=f,J.forEach(s,function(h){w0(e,t,n,r,i,a,h);var v=e.node(h),m=v.borderTop?v.borderTop:h,g=v.borderBottom?v.borderBottom:h,_=v.borderTop?r:2*r,y=m!==g?1:i-a[o]+1;e.setEdge(c,m,{weight:_,minlen:y,nestingEdge:!0}),e.setEdge(g,f,{weight:_,minlen:y,nestingEdge:!0})}),e.parent(o)||e.setEdge(t,c,{weight:0,minlen:i+a[o]})}else o!==t&&e.setEdge(t,o,{weight:0,minlen:n})}var Xg=function(e){J.forEach(e.children(),function t(n){var r=e.children(n),i=e.node(n);if(r.length&&J.forEach(r,t),J.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var a=i.minRank,o=i.maxRank+1;a<o;++a)Iv(e,"borderLeft","_bl",n,i,a),Iv(e,"borderRight","_br",n,i,a)}})};function Iv(e,t,n,r,i,a){var o={width:0,height:0,rank:a,borderType:t},s=i[t][a-1],c=Yi.addDummyNode(e,"border",o,n);i[t][a]=c,e.setParent(c,r),s&&e.setEdge(s,c,{weight:1})}var x0={adjust:function(e){var t=e.graph().rankdir.toLowerCase();t!=="lr"&&t!=="rl"||S0(e)},undo:function(e){var t=e.graph().rankdir.toLowerCase();t!=="bt"&&t!=="rl"||function(n){J.forEach(n.nodes(),function(r){jl(n.node(r))}),J.forEach(n.edges(),function(r){var i=n.edge(r);J.forEach(i.points,jl),J.has(i,"y")&&jl(i)})}(e),t!=="lr"&&t!=="rl"||(function(n){J.forEach(n.nodes(),function(r){Hl(n.node(r))}),J.forEach(n.edges(),function(r){var i=n.edge(r);J.forEach(i.points,Hl),J.has(i,"x")&&Hl(i)})}(e),S0(e))}};function S0(e){J.forEach(e.nodes(),function(t){T0(e.node(t))}),J.forEach(e.edges(),function(t){T0(e.edge(t))})}function T0(e){var t=e.width;e.width=e.height,e.height=t}function jl(e){e.y=-e.y}function Hl(e){var t=e.x;e.x=e.y,e.y=t}var $g=function(e){var t={},n=J.filter(e.nodes(),function(s){return!e.children(s).length}),r=J.max(J.map(n,function(s){return e.node(s).rank})),i=J.map(J.range(r+1),function(){return[]});function a(s){if(!J.has(t,s)){t[s]=!0;var c=e.node(s);i[c.rank].push(s),J.forEach(e.successors(s),a)}}var o=J.sortBy(n,function(s){return e.node(s).rank});return J.forEach(o,a),i},Yg=function(e,t){for(var n=0,r=1;r<t.length;++r)n+=Kg(e,t[r-1],t[r]);return n};function Kg(e,t,n){for(var r=J.zipObject(n,J.map(n,function(f,d){return d})),i=J.flatten(J.map(t,function(f){return J.sortBy(J.map(e.outEdges(f),function(d){return{pos:r[d.w],weight:e.edge(d).weight}}),"pos")}),!0),a=1;a<n.length;)a<<=1;var o=2*a-1;a-=1;var s=J.map(new Array(o),function(){return 0}),c=0;return J.forEach(i.forEach(function(f){var d=f.pos+a;s[d]+=f.weight;for(var h=0;d>0;)d%2&&(h+=s[d+1]),s[d=d-1>>1]+=f.weight;c+=f.weight*h})),c}var Jg=function(e,t){return J.map(t,function(n){var r=e.inEdges(n);if(r.length){var i=J.reduce(r,function(a,o){var s=e.edge(o),c=e.node(o.v);return{sum:a.sum+s.weight*c.order,weight:a.weight+s.weight}},{sum:0,weight:0});return{v:n,barycenter:i.sum/i.weight,weight:i.weight}}return{v:n}})},qg=function(e,t){var n={};return J.forEach(e,function(r,i){var a=n[r.v]={indegree:0,in:[],out:[],vs:[r.v],i};J.isUndefined(r.barycenter)||(a.barycenter=r.barycenter,a.weight=r.weight)}),J.forEach(t.edges(),function(r){var i=n[r.v],a=n[r.w];J.isUndefined(i)||J.isUndefined(a)||(a.indegree++,i.out.push(n[r.w]))}),function(r){var i=[];function a(c){return function(f){f.merged||(J.isUndefined(f.barycenter)||J.isUndefined(c.barycenter)||f.barycenter>=c.barycenter)&&function(d,h){var v=0,m=0;d.weight&&(v+=d.barycenter*d.weight,m+=d.weight),h.weight&&(v+=h.barycenter*h.weight,m+=h.weight),d.vs=h.vs.concat(d.vs),d.barycenter=v/m,d.weight=m,d.i=Math.min(h.i,d.i),h.merged=!0}(c,f)}}function o(c){return function(f){f.in.push(c),--f.indegree==0&&r.push(f)}}for(;r.length;){var s=r.pop();i.push(s),J.forEach(s.in.reverse(),a(s)),J.forEach(s.out,o(s))}return J.map(J.filter(i,function(c){return!c.merged}),function(c){return J.pick(c,["vs","i","barycenter","weight"])})}(J.filter(n,function(r){return!r.indegree}))},Qg=function(e,t){var n=Yi.partition(e,function(h){return J.has(h,"barycenter")}),r=n.lhs,i=J.sortBy(n.rhs,function(h){return-h.i}),a=[],o=0,s=0,c=0;r.sort((f=!!t,function(h,v){return h.barycenter<v.barycenter?-1:h.barycenter>v.barycenter?1:f?v.i-h.i:h.i-v.i})),c=A0(a,i,c),J.forEach(r,function(h){c+=h.vs.length,a.push(h.vs),o+=h.barycenter*h.weight,s+=h.weight,c=A0(a,i,c)});var f,d={vs:J.flatten(a,!0)};return s&&(d.barycenter=o/s,d.weight=s),d};function A0(e,t,n){for(var r;t.length&&(r=J.last(t)).i<=n;)t.pop(),e.push(r.vs),n++;return n}var ey=function e(t,n,r,i){var a=t.children(n),o=t.node(n),s=o?o.borderLeft:void 0,c=o?o.borderRight:void 0,f={};s&&(a=J.filter(a,function(_){return _!==s&&_!==c}));var d=Jg(t,a);J.forEach(d,function(_){if(t.children(_.v).length){var y=e(t,_.v,r,i);f[_.v]=y,J.has(y,"barycenter")&&(E=_,b=y,J.isUndefined(E.barycenter)?(E.barycenter=b.barycenter,E.weight=b.weight):(E.barycenter=(E.barycenter*E.weight+b.barycenter*b.weight)/(E.weight+b.weight),E.weight+=b.weight))}var E,b});var h=qg(d,r);(function(_,y){J.forEach(_,function(E){E.vs=J.flatten(E.vs.map(function(b){return y[b]?y[b].vs:b}),!0)})})(h,f);var v=Qg(h,i);if(s&&(v.vs=J.flatten([s,v.vs,c],!0),t.predecessors(s).length)){var m=t.node(t.predecessors(s)[0]),g=t.node(t.predecessors(c)[0]);J.has(v,"barycenter")||(v.barycenter=0,v.weight=0),v.barycenter=(v.barycenter*v.weight+m.order+g.order)/(v.weight+2),v.weight+=2}return v},ty=To.Graph,ny=function(e,t,n){var r=function(a){for(var o;a.hasNode(o=J.uniqueId("_root")););return o}(e),i=new ty({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(function(a){return e.node(a)});return J.forEach(e.nodes(),function(a){var o=e.node(a),s=e.parent(a);(o.rank===t||o.minRank<=t&&t<=o.maxRank)&&(i.setNode(a),i.setParent(a,s||r),J.forEach(e[n](a),function(c){var f=c.v===a?c.w:c.v,d=i.edge(f,a),h=J.isUndefined(d)?0:d.weight;i.setEdge(f,a,{weight:e.edge(c).weight+h})}),J.has(o,"minRank")&&i.setNode(a,{borderLeft:o.borderLeft[t],borderRight:o.borderRight[t]}))}),i},ry=function(e,t,n){var r,i={};J.forEach(n,function(a){for(var o,s,c=e.parent(a);c;){if((o=e.parent(c))?(s=i[o],i[o]=c):(s=r,r=c),s&&s!==c)return void t.setEdge(s,c);c=o}})},iy=To.Graph,ay=function(e){var t=Yi.maxRank(e),n=I0(e,J.range(1,t+1),"inEdges"),r=I0(e,J.range(t-1,-1,-1),"outEdges"),i=$g(e);C0(e,i);for(var a,o=Number.POSITIVE_INFINITY,s=0,c=0;c<4;++s,++c){oy(s%2?n:r,s%4>=2),i=Yi.buildLayerMatrix(e);var f=Yg(e,i);f<o&&(c=0,a=J.cloneDeep(i),o=f)}C0(e,a)};function I0(e,t,n){return J.map(t,function(r){return ny(e,r,n)})}function oy(e,t){var n=new iy;J.forEach(e,function(r){var i=r.graph().root,a=ey(r,i,n,t);J.forEach(a.vs,function(o,s){r.node(o).order=s}),ry(r,n,a.vs)})}function C0(e,t){J.forEach(t,function(n){J.forEach(n,function(r,i){e.node(r).order=i})})}var sy=To.Graph,uy=function(e){var t,n=Yi.buildLayerMatrix(e),r=J.merge(cy(e,n),fy(e,n)),i={};J.forEach(["u","d"],function(o){t=o==="u"?n:J.values(n).reverse(),J.forEach(["l","r"],function(s){s==="r"&&(t=J.map(t,function(h){return J.values(h).reverse()}));var c=(o==="u"?e.predecessors:e.successors).bind(e),f=l(e,t,r,c),d=p(e,t,f.root,f.align,s==="r");s==="r"&&(d=J.mapValues(d,function(h){return-h})),i[o+s]=d})});var a=w(e,i);return M(i,a),k(i,e.graph().align)};function cy(e,t){var n={};return J.reduce(t,function(r,i){var a=0,o=0,s=r.length,c=J.last(i);return J.forEach(i,function(f,d){var h=function(m,g){if(m.node(g).dummy)return J.find(m.predecessors(g),function(_){return m.node(_).dummy})}(e,f),v=h?e.node(h).order:s;(h||f===c)&&(J.forEach(i.slice(o,d+1),function(m){J.forEach(e.predecessors(m),function(g){var _=e.node(g),y=_.order;!(y<a||v<y)||_.dummy&&e.node(m).dummy||R0(n,g,m)})}),o=d+1,a=v)}),i}),n}function fy(e,t){var n={};function r(i,a,o,s,c){var f;J.forEach(J.range(a,o),function(d){f=i[d],e.node(f).dummy&&J.forEach(e.predecessors(f),function(h){var v=e.node(h);v.dummy&&(v.order<s||v.order>c)&&R0(n,h,f)})})}return J.reduce(t,function(i,a){var o,s=-1,c=0;return J.forEach(a,function(f,d){if(e.node(f).dummy==="border"){var h=e.predecessors(f);h.length&&(o=e.node(h[0]).order,r(a,c,d,s,o),c=d,s=o)}r(a,c,a.length,o,i.length)}),a}),n}function R0(e,t,n){if(t>n){var r=t;t=n,n=r}var i=e[t];i||(e[t]=i={}),i[n]=!0}function u(e,t,n){if(t>n){var r=t;t=n,n=r}return J.has(e[t],n)}function l(e,t,n,r){var i={},a={},o={};return J.forEach(t,function(s){J.forEach(s,function(c,f){i[c]=c,a[c]=c,o[c]=f})}),J.forEach(t,function(s){var c=-1;J.forEach(s,function(f){var d=r(f);if(d.length)for(var h=((d=J.sortBy(d,function(_){return o[_]})).length-1)/2,v=Math.floor(h),m=Math.ceil(h);v<=m;++v){var g=d[v];a[f]===f&&c<o[g]&&!u(n,f,g)&&(a[g]=f,a[f]=i[f]=i[g],c=o[g])}})}),{root:i,align:a}}function p(e,t,n,r,i){var a={},o=function(f,d,h,v){var m=new sy,g=f.graph(),_=function(y,E,b){return function(A,C,R){var z,ee=A.node(C),Q=A.node(R),re=0;if(re+=ee.width/2,J.has(ee,"labelpos"))switch(ee.labelpos.toLowerCase()){case"l":z=-ee.width/2;break;case"r":z=ee.width/2}if(z&&(re+=b?z:-z),z=0,re+=(ee.dummy?E:y)/2,re+=(Q.dummy?E:y)/2,re+=Q.width/2,J.has(Q,"labelpos"))switch(Q.labelpos.toLowerCase()){case"l":z=Q.width/2;break;case"r":z=-Q.width/2}return z&&(re+=b?z:-z),z=0,re}}(g.nodesep,g.edgesep,v);return J.forEach(d,function(y){var E;J.forEach(y,function(b){var A=h[b];if(m.setNode(A),E){var C=h[E],R=m.edge(C,A);m.setEdge(C,A,Math.max(_(f,b,E),R||0))}E=b})}),m}(e,t,n,i),s=i?"borderLeft":"borderRight";function c(f,d){for(var h=o.nodes(),v=h.pop(),m={};v;)m[v]?f(v):(m[v]=!0,h.push(v),h=h.concat(d(v))),v=h.pop()}return c(function(f){a[f]=o.inEdges(f).reduce(function(d,h){return Math.max(d,a[h.v]+o.edge(h))},0)},o.predecessors.bind(o)),c(function(f){var d=o.outEdges(f).reduce(function(v,m){return Math.min(v,a[m.w]-o.edge(m))},Number.POSITIVE_INFINITY),h=e.node(f);d!==Number.POSITIVE_INFINITY&&h.borderType!==s&&(a[f]=Math.max(a[f],d))},o.successors.bind(o)),J.forEach(r,function(f){a[f]=a[n[f]]}),a}function w(e,t){return J.minBy(J.values(t),function(n){var r=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return J.forIn(n,function(a,o){var s=function(c,f){return c.node(f).width}(e,o)/2;r=Math.max(a+s,r),i=Math.min(a-s,i)}),r-i})}function M(e,t){var n=J.values(t),r=J.min(n),i=J.max(n);J.forEach(["u","d"],function(a){J.forEach(["l","r"],function(o){var s,c=a+o,f=e[c];if(f!==t){var d=J.values(f);(s=o==="l"?r-J.min(d):i-J.max(d))&&(e[c]=J.mapValues(f,function(h){return h+s}))}})})}function k(e,t){return J.mapValues(e.ul,function(n,r){if(t)return e[t.toLowerCase()][r];var i=J.sortBy(J.map(e,r));return(i[1]+i[2])/2})}var q=uy,ue=function(e){(function(t){var n=Yi.buildLayerMatrix(t),r=t.graph().ranksep,i=0;J.forEach(n,function(a){var o=J.max(J.map(a,function(s){return t.node(s).height}));J.forEach(a,function(s){t.node(s).y=i+o/2}),i+=o+r})})(e=Yi.asNonCompoundGraph(e)),J.forEach(q(e),function(t,n){e.node(n).x=t})},Ee=Yi.normalizeRanks,ut=Yi.removeEmptyRanks,tt=Yi,wt=To.Graph,Vt=function(e,t){var n=t&&t.debugTiming?tt.time:tt.notime;n("layout",function(){var r=n("  buildLayoutGraph",function(){return function(i){var a=new wt({multigraph:!0,compound:!0}),o=pi(i.graph());return a.setGraph(J.merge({},Rn,Ra(o,rn),J.pick(o,nr))),J.forEach(i.nodes(),function(s){var c=pi(i.node(s));a.setNode(s,J.defaults(Ra(c,Mn),fr)),a.setParent(s,i.parent(s))}),J.forEach(i.edges(),function(s){var c=pi(i.edge(s));a.setEdge(s,J.merge({},to,Ra(c,pr),J.pick(c,Ca)))}),a}(e)});n("  runLayout",function(){(function(i,a){a("    makeSpaceForEdgeLabels",function(){(function(o){var s=o.graph();s.ranksep/=2,J.forEach(o.edges(),function(c){var f=o.edge(c);f.minlen*=2,f.labelpos.toLowerCase()!=="c"&&(s.rankdir==="TB"||s.rankdir==="BT"?f.width+=f.labeloffset:f.height+=f.labeloffset)})})(i)}),a("    removeSelfEdges",function(){(function(o){J.forEach(o.edges(),function(s){if(s.v===s.w){var c=o.node(s.v);c.selfEdges||(c.selfEdges=[]),c.selfEdges.push({e:s,label:o.edge(s)}),o.removeEdge(s)}})})(i)}),a("    acyclic",function(){o0.run(i)}),a("    nestingGraph.run",function(){b0.run(i)}),a("    rank",function(){Av(tt.asNonCompoundGraph(i))}),a("    injectEdgeLabelProxies",function(){(function(o){J.forEach(o.edges(),function(s){var c=o.edge(s);if(c.width&&c.height){var f=o.node(s.v),d={rank:(o.node(s.w).rank-f.rank)/2+f.rank,e:s};tt.addDummyNode(o,"edge-proxy",d,"_ep")}})})(i)}),a("    removeEmptyRanks",function(){ut(i)}),a("    nestingGraph.cleanup",function(){b0.cleanup(i)}),a("    normalizeRanks",function(){Ee(i)}),a("    assignRankMinMax",function(){(function(o){var s=0;J.forEach(o.nodes(),function(c){var f=o.node(c);f.borderTop&&(f.minRank=o.node(f.borderTop).rank,f.maxRank=o.node(f.borderBottom).rank,s=J.max(s,f.maxRank))}),o.graph().maxRank=s})(i)}),a("    removeEdgeLabelProxies",function(){(function(o){J.forEach(o.nodes(),function(s){var c=o.node(s);c.dummy==="edge-proxy"&&(o.edge(c.e).labelRank=c.rank,o.removeNode(s))})})(i)}),a("    normalize.run",function(){f0.run(i)}),a("    parentDummyChains",function(){Hg(i)}),a("    addBorderSegments",function(){Xg(i)}),a("    order",function(){ay(i)}),a("    insertSelfEdges",function(){(function(o){var s=tt.buildLayerMatrix(o);J.forEach(s,function(c){var f=0;J.forEach(c,function(d,h){var v=o.node(d);v.order=h+f,J.forEach(v.selfEdges,function(m){tt.addDummyNode(o,"selfedge",{width:m.label.width,height:m.label.height,rank:v.rank,order:h+ ++f,e:m.e,label:m.label},"_se")}),delete v.selfEdges})})})(i)}),a("    adjustCoordinateSystem",function(){x0.adjust(i)}),a("    position",function(){ue(i)}),a("    positionSelfEdges",function(){(function(o){J.forEach(o.nodes(),function(s){var c=o.node(s);if(c.dummy==="selfedge"){var f=o.node(c.e.v),d=f.x+f.width/2,h=f.y,v=c.x-d,m=f.height/2;o.setEdge(c.e,c.label),o.removeNode(s),c.label.points=[{x:d+2*v/3,y:h-m},{x:d+5*v/6,y:h-m},{x:d+v,y:h},{x:d+5*v/6,y:h+m},{x:d+2*v/3,y:h+m}],c.label.x=c.x,c.label.y=c.y}})})(i)}),a("    removeBorderNodes",function(){(function(o){J.forEach(o.nodes(),function(s){if(o.children(s).length){var c=o.node(s),f=o.node(c.borderTop),d=o.node(c.borderBottom),h=o.node(J.last(c.borderLeft)),v=o.node(J.last(c.borderRight));c.width=Math.abs(v.x-h.x),c.height=Math.abs(d.y-f.y),c.x=h.x+c.width/2,c.y=f.y+c.height/2}}),J.forEach(o.nodes(),function(s){o.node(s).dummy==="border"&&o.removeNode(s)})})(i)}),a("    normalize.undo",function(){f0.undo(i)}),a("    fixupEdgeLabelCoords",function(){(function(o){J.forEach(o.edges(),function(s){var c=o.edge(s);if(J.has(c,"x"))switch(c.labelpos!=="l"&&c.labelpos!=="r"||(c.width-=c.labeloffset),c.labelpos){case"l":c.x-=c.width/2+c.labeloffset;break;case"r":c.x+=c.width/2+c.labeloffset}})})(i)}),a("    undoCoordinateSystem",function(){x0.undo(i)}),a("    translateGraph",function(){(function(o){var s=Number.POSITIVE_INFINITY,c=0,f=Number.POSITIVE_INFINITY,d=0,h=o.graph(),v=h.marginx||0,m=h.marginy||0;function g(_){var y=_.x,E=_.y,b=_.width,A=_.height;s=Math.min(s,y-b/2),c=Math.max(c,y+b/2),f=Math.min(f,E-A/2),d=Math.max(d,E+A/2)}J.forEach(o.nodes(),function(_){g(o.node(_))}),J.forEach(o.edges(),function(_){var y=o.edge(_);J.has(y,"x")&&g(y)}),s-=v,f-=m,J.forEach(o.nodes(),function(_){var y=o.node(_);y.x-=s,y.y-=f}),J.forEach(o.edges(),function(_){var y=o.edge(_);J.forEach(y.points,function(E){E.x-=s,E.y-=f}),J.has(y,"x")&&(y.x-=s),J.has(y,"y")&&(y.y-=f)}),h.width=c-s+v,h.height=d-f+m})(i)}),a("    assignNodeIntersects",function(){(function(o){J.forEach(o.edges(),function(s){var c,f,d=o.edge(s),h=o.node(s.v),v=o.node(s.w);d.points?(c=d.points[0],f=d.points[d.points.length-1]):(d.points=[],c=v,f=h),d.points.unshift(tt.intersectRect(h,c)),d.points.push(tt.intersectRect(v,f))})})(i)}),a("    reversePoints",function(){(function(o){J.forEach(o.edges(),function(s){var c=o.edge(s);c.reversed&&c.points.reverse()})})(i)}),a("    acyclic.undo",function(){o0.undo(i)})})(r,n)}),n("  updateInputGraph",function(){(function(i,a){J.forEach(i.nodes(),function(o){var s=i.node(o),c=a.node(o);s&&(s.x=c.x,s.y=c.y,a.children(o).length&&(s.width=c.width,s.height=c.height))}),J.forEach(i.edges(),function(o){var s=i.edge(o),c=a.edge(o);s.points=c.points,J.has(c,"x")&&(s.x=c.x,s.y=c.y)}),i.graph().width=a.graph().width,i.graph().height=a.graph().height})(e,r)})})},rn=["nodesep","edgesep","ranksep","marginx","marginy"],Rn={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},nr=["acyclicer","ranker","rankdir","align"],Mn=["width","height"],fr={width:0,height:0},pr=["minlen","weight","width","height","labeloffset"],to={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Ca=["labelpos"];function Ra(e,t){return J.mapValues(J.pick(e,t),Number)}function pi(e){var t={};return J.forEach(e,function(n,r){t[r.toLowerCase()]=n}),t}var Jo=To.Graph,Cs={graphlib:To,layout:Vt,debug:{debugOrdering:function(e){var t=Yi.buildLayerMatrix(e),n=new Jo({compound:!0,multigraph:!0}).setGraph({});return J.forEach(e.nodes(),function(r){n.setNode(r,{label:r}),n.setParent(r,"layer"+e.node(r).rank)}),J.forEach(e.edges(),function(r){n.setEdge(r.v,r.w,{},r.name)}),J.forEach(t,function(r,i){var a="layer"+i;n.setNode(a,{rank:"same"}),J.reduce(r,function(o,s){return n.setEdge(o,s,{style:"invis"}),s})}),n}},util:{time:Yi.time,notime:Yi.notime},version:"0.8.5"},M0=Cs.graphlib,Yx=Cs.layout;class Kx{constructor(t){this.cardinality=1,this.include=Ks.UNSPECIFIED,this.isGroupNode=!1,this.parentNode=null,this.type=Xi.NODE,this.name=t.name,this.attr=t.attr||{},this.inputs=t.inputs,this.path=t.path||[],this.width=t.width,this.height=t.height}}class Jx{constructor(){this.nodes={},this.edges=[],this.nodes={},this.edges=[]}}function qx(e){const t=new Jx;return e.nodes.map(n=>new Kx(n)).forEach(n=>{t.nodes[n.name]=n,n.inputs.forEach(r=>{(function(i,a,o){o.name!==a.name&&i.edges.push(Object.assign(Object.assign({},o.attr),{v:o.name,w:a.name}))})(t,n,r)})}),t}class Qx{constructor(t,n={}){this.attr=null,this.bridgeGraph=null,this.cardinality=0,this.depth=1,this.include=Ks.UNSPECIFIED,this.isGroupNode=!0,this.parentNode=null,this.type=Xi.META,this.path=[],this.name=t,this.metaGraph=ly(t,Js.META,n)}getFirstChild(){return this.metaGraph.node(this.metaGraph.nodes()[0])}getChildren(){return this.metaGraph.nodes().map(t=>this.metaGraph.node(t))}leaves(){let t,n=[],r=[this];for(;r.length;){let i=r.shift();i.isGroupNode?(t=i.metaGraph,t.nodes().forEach(a=>r.push(t.node(a)))):n.push(i.name)}return n}}class eS{constructor(t,n){this.v=t,this.w=n,this.baseEdgeList=[],this.inbound=null,this.name=null}addBaseEdge(t,n){this.baseEdgeList.push(t)}}function Jy(e,t={}){return new Qx(e,t)}function qy(e,t){return new eS(e,t)}function ly(e,t,n){const r=n||{},i=new M0.Graph(r);return i.setGraph({name:e,rankdir:r.rankdir,type:t,align:r.align}),i}class tS{constructor(t={}){this.graphOptions=t,this.index={},this.graphOptions.compound=!0,this.root=Jy(Ya,this.graphOptions),this.index[Ya]=this.root}getNodeMap(){return this.index}node(t){return this.index[t]}setNode(t,n){this.index[t]=n}getBridgeGraph(t){const n=this.index[t];if(!n)throw Error("Could not find node in hierarchy: "+t);if(!("metaGraph"in n))return null;const r=n;if(r.bridgeGraph)return r.bridgeGraph;const i=ly(Bd,Js.BRIDGE,this.graphOptions);if(r.bridgeGraph=i,!n.parentNode||!("metaGraph"in n.parentNode))return i;const a=n.parentNode;return[a.metaGraph,this.getBridgeGraph(a.name)].forEach(o=>{o.edges().filter(s=>s.v===t||s.w===t).forEach(s=>{const c=s.w===t;o.edge(s).baseEdgeList.forEach(f=>{const[d,h]=c?[f.w,s.v]:[f.v,s.w],v=this.getChildName(t,d),m={v:c?h:v,w:c?v:h};let g=i.edge(m);g||(g=qy(m.v,m.w),g.inbound=c,i.setEdge(m.v,m.w,g)),g.addBaseEdge(f,this)})})}),i}getChildName(t,n){let r=this.index[n];for(;r;){if(r.parentNode&&r.parentNode.name===t)return r.name;r=r.parentNode}throw Error("Could not find immediate child for descendant: "+n)}getPredecessors(t){const n=this.index[t];if(!n)throw Error("Could not find node with name: "+t);return this.getOneWayEdges(n,!0)}getSuccessors(t){const n=this.index[t];if(!n)throw Error("Could not find node with name: "+t);return this.getOneWayEdges(n,!1)}getOneWayEdges(t,n){const r=[];if(!t.parentNode||!t.parentNode.isGroupNode)return r;const i=t.parentNode,a=i.metaGraph,o=this.getBridgeGraph(i.name);return Qy(a,t,n,r),Qy(o,t,n,r),r}}function nS(e,t){const{rankDirection:n,align:r}=t,i=new tS({rankdir:n,align:r});return function(a,o){Object.keys(o.nodes).forEach(s=>{const c=o.nodes[s],f=c.path;let d=a.root;d.depth=Math.max(f.length,d.depth);for(let h=0;h<f.length&&(d.depth=Math.max(d.depth,f.length-h),d.cardinality+=c.cardinality,h!==f.length-1);h++){const v=f[h];let m=a.node(v);m||(m=Jy(v,a.graphOptions),m.path=c.path.slice(0,h+1),m.parentNode=d,a.setNode(v,m),d.metaGraph.setNode(v,m)),d=m}a.setNode(c.name,c),c.parentNode=d,d.metaGraph.setNode(c.name,c)})}(i,e),function(a,o){const s=a.getNodeMap();let c=[],f=[];const d=(h,v)=>{let m=0;for(;h;)v[m++]=h.name,h=h.parentNode;return m-1};o.edges.forEach(h=>{c=[],f=[];let v=d(o.nodes[h.v],c),m=d(o.nodes[h.w],f);for(;c[v]===f[m];)if(v--,m--,v<0||m<0)throw Error("No difference found between ancestor paths.");const g=s[c[v+1]],_=c[v],y=f[m];let E=g.metaGraph.edge(_,y);E||(E=qy(_,y),g.metaGraph.setEdge(_,y,E)),E.addBaseEdge(h,a)})}(i,e),i}function Qy(e,t,n,r){(n?e.inEdges(t.name):e.outEdges(t.name)).forEach(i=>{const a=e.edge(i);r.push(a)})}class rS{constructor(t){this.hierarchy=t,this.index={},this.hasSubHierarchy={},this.root=new t1(this.hierarchy.root,this.hierarchy.graphOptions),this.index[t.root.name]=this.root,this.buildSubHierarchy(t.root.name),this.root.expanded=!0}getRenderInfoNodes(){return Object.values(this.index)}getSubHierarchy(){return this.hasSubHierarchy}buildSubHierarchy(t){if(t in this.hasSubHierarchy)return;this.hasSubHierarchy[t]=!0;const n=this.index[t];if(n.node.type!==Xi.META)return;const r=n,i=r.node.metaGraph,a=r.coreGraph;i.nodes().forEach(d=>{const h=this.getOrCreateRenderNodeByName(d);a.setNode(d,h)}),i.edges().forEach(d=>{const h=i.edge(d),v=new e1(h);a.setEdge(d.v,d.w,v)});const o=r.node.parentNode;if(!o)return;const s=this.getRenderNodeByName(o.name),c=(d,...h)=>h.concat([d?"IN":"OUT"]).join("~~"),f=this.hierarchy.getBridgeGraph(t);f.edges().forEach(d=>{const h=f.edge(d),v=!!i.node(d.w),[m,g]=v?[d.w,d.v]:[d.v,d.w],_=R=>{const z=v?{v:R,w:t}:{v:t,w:R};return s.coreGraph.edge(z)};let y=_(g);y||(y=_(c(v,g,o.name)));const E=c(v,t),b=c(v,g,t);let A=a.node(b);if(!A){let R=a.node(E);if(!R){const ee={name:E,type:Xi.BRIDGE,isGroupNode:!1,cardinality:0,parentNode:null,include:Ks.UNSPECIFIED,inbound:v,attr:{}};R=new N0(ee),this.index[E]=R,a.setNode(E,R)}const z={name:b,type:Xi.BRIDGE,isGroupNode:!1,cardinality:1,parentNode:null,include:Ks.UNSPECIFIED,inbound:v,attr:{}};A=new N0(z),this.index[b]=A,a.setNode(b,A),a.setParent(b,E),R.node.cardinality++}const C=new e1(h);C.adjoiningMetaEdge=y,v?a.setEdge(b,m,C):a.setEdge(m,b,C)})}getOrCreateRenderNodeByName(t){if(!t)return null;if(t in this.index)return this.index[t];const n=this.getNodeByName(t);return n?(this.index[t]=n.isGroupNode?new t1(n,this.hierarchy.graphOptions):new N0(n),this.index[t]):null}getRenderNodeByName(t){return this.index[t]}getNodeByName(t){return this.hierarchy.node(t)}}class N0{constructor(t){this.node=t,this.expanded=!1,this.x=0,this.y=0,this.coreBox={width:0,height:0},this.outboxWidth=0,this.labelOffset=0,this.radius=0,this.labelHeight=0,this.paddingTop=0,this.paddingLeft=0,this.paddingRight=0,this.paddingBottom=0,this.width=t.width||0,this.height=t.height||0,this.displayName=t.name,this.attr=t.attr}}class e1{constructor(t){this.metaEdge=t,this.adjoiningMetaEdge=null,this.weight=1,this.points=[]}}class t1 extends N0{constructor(t,n){super(t);const r=t.metaGraph.graph();n.compound=!0,this.coreGraph=ly(r.name,Js.CORE,n)}}function n1(e,t){e.node.isGroupNode&&function(n,r){const i=Ys(r);n.coreGraph.nodes().map(a=>n.coreGraph.node(a)).forEach(a=>{var o,s,c,f,d,h;const{height:v,width:m}=a;switch(a.node.type){case Xi.NODE:Object.assign(a,i.nodeSize.node),a.height=v||i.nodeSize.node.height,a.width=m||i.nodeSize.node.width;break;case Xi.BRIDGE:Object.assign(a,i.nodeSize.bridge);break;case Xi.META:a.expanded?n1(a,r):(Object.assign(a,i.nodeSize.meta),a.height=i.nodeSize.meta.height,a.width=i.nodeSize.meta.width);break;default:throw Error("Unrecognized node type: "+a.node.type)}if(!a.expanded){const g=a.attr;(function(_,y=!1){if(_.coreBox.width=_.width,_.coreBox.height=_.height,!y){const E=`${_.displayName}`.length,b=3;_.width=Math.max(_.coreBox.width,E*b)}})(a,r&&(a.node.type===0&&!!((s=(o=r==null?void 0:r.nodeSize)===null||o===void 0?void 0:o.meta)===null||s===void 0?void 0:s.width)||a.node.type===1&&(!!((f=(c=r==null?void 0:r.nodeSize)===null||c===void 0?void 0:c.node)===null||f===void 0?void 0:f.width)||!!g.width)||a.node.type===2&&!!((h=(d=r==null?void 0:r.nodeSize)===null||d===void 0?void 0:d.bridge)===null||h===void 0?void 0:h.width)))}})}(e,t),e.node.type===Xi.META&&function(n,r){const i=Ys(r),a=i.subScene.meta;Object.assign(n,a);const{nodeSep:o,rankSep:s,edgeSep:c,align:f}=i.graph.meta,d={nodesep:o,ranksep:s,edgesep:c,align:f};Object.assign(n.coreBox,function(m,g){const{ranksep:_,nodesep:y,edgesep:E,align:b}=g;Object.assign(m.graph(),{ranksep:_,nodesep:y,edgesep:E,align:b});const A=[];if(m.nodes().forEach(Q=>{m.node(Q).node.type!==Xi.BRIDGE&&A.push(Q)}),!A.length)return{width:0,height:0};Yx(m);let C=1/0,R=1/0,z=-1/0,ee=-1/0;return A.forEach(Q=>{const re=m.node(Q),de=.5*re.width,Ie=re.x-de,ie=re.x+de;C=Ie<C?Ie:C,z=ie>z?ie:z;const ke=.5*re.height,Ve=re.y-ke,Rt=re.y+ke;R=Ve<R?Ve:R,ee=Rt>ee?Rt:ee}),m.edges().forEach(Q=>{const re=m.edge(Q),de=m.node(re.metaEdge.v),Ie=m.node(re.metaEdge.w);if(re.points.length===3&&function(Ve){let Rt=r1(Ve[0],Ve[1]);for(let dn=1;dn<Ve.length-1;dn++){const ln=r1(Ve[dn],Ve[dn+1]);if(Math.abs(ln-Rt)>1)return!1;Rt=ln}return!0}(re.points)){if(de!=null){const Ve=de.expanded?de.x:dy(de);re.points[0].x=Ve}if(Ie!=null){const Ve=Ie.expanded?Ie.x:dy(Ie);re.points[2].x=Ve}re.points=[re.points[0],re.points[1]]}const ie=re.points[re.points.length-2];Ie!=null&&(re.points[re.points.length-1]=i1(ie,Ie));const ke=re.points[1];de!=null&&(re.points[0]=i1(ke,de)),re.points.forEach(Ve=>{C=Ve.x<C?Ve.x:C,z=Ve.x>z?Ve.x:z,R=Ve.y<R?Ve.y:R,ee=Ve.y>ee?Ve.y:ee})}),m.nodes().forEach(Q=>{const re=m.node(Q);re.x-=C,re.y-=R}),m.edges().forEach(Q=>{m.edge(Q).points.forEach(re=>{re.x-=C,re.y-=R})}),{width:z-C,height:ee-R}}(n.coreGraph,d));let h=0;n.coreGraph.nodeCount()>0&&h++;const v=h<=1?0:h;n.coreBox.width+=v+v,n.coreBox.height=a.labelHeight+n.coreBox.height,n.width=n.coreBox.width+a.paddingLeft+a.paddingRight,n.height=n.paddingTop+n.coreBox.height+n.paddingBottom}(e,t)}function r1(e,t){const n=t.x-e.x,r=t.y-e.y;return 180*Math.atan(r/n)/Math.PI}function dy(e){return e.expanded?e.x:e.x-e.width/2+0+e.coreBox.width/2}function i1(e,t){const n=t.expanded?t.x:dy(t),r=t.y,i=e.x-n,a=e.y-r;let o,s,c=t.expanded?t.width:t.coreBox.width,f=t.expanded?t.height:t.coreBox.height;return Math.abs(a)*c/2>Math.abs(i)*f/2?(a<0&&(f=-f),o=a===0?0:f/2*i/a,s=f/2):(i<0&&(c=-c),o=c/2,s=i===0?0:c/2*a/i),{x:n+o,y:r+s}}function iS(e,t,n){var r,i,a,o;const s=e.nodes.filter((h,v,m)=>m.findIndex(g=>g.id===h.id)!==v).map(h=>h.id);if(s.length)throw new Error(`Duplicated ids found: ${s.join(", ")}`);const c=function(h){const v={nodes:[]},m=h.compound,g=Object.keys(m||{}),_=new Map,y=(b,A=[])=>{if(_.has(b))return _.get(b);for(let C=0;C<g.length;C++){let R=g[C];if(m&&m[R].indexOf(b)!==-1)return A.unshift(R),y(R,A)}return A.length===0&&_.set(b,A),A},E=b=>h.edges.filter(A=>A.w===b).map(A=>({name:A.v}));return h.nodes.forEach(b=>{const A=b.id,C=[...y(A),A];let R=E(A);v.nodes.push({name:A,path:C,inputs:R,width:b.width,height:b.height,attr:Object.assign({},b)})}),v}(e),f=function(h,v){const m=(_,y)=>{for(let E of y.values())if(E.includes(_))return!0;return!1},g=(_,y=[])=>{if(Object.keys(_).length===0)return[...new Set(y)];const E=new Map(Object.keys(_).map(A=>[A,_[A]])),b={};for(let[A,C]of E)m(A,E)?b[A]=C:y=y.concat(A,C);return g(b,y)};return g(h).filter(_=>v.includes(_))}(e.compound||{},(t==null?void 0:t.expanded)||[]),d=function(h,v){return function(m){return new rS(m)}(nS(qx(h),v))}(c,{rankDirection:((i=(r=n==null?void 0:n.graph)===null||r===void 0?void 0:r.meta)===null||i===void 0?void 0:i.rankDir)||(t==null?void 0:t.rankDirection)||$s.graph.meta.rankDir,align:((o=(a=n==null?void 0:n.graph)===null||a===void 0?void 0:a.meta)===null||o===void 0?void 0:o.align)||$s.graph.meta.align});return function(h,v){v.forEach(m=>{const g=h.getRenderInfoNodes().find(E=>E.displayName===m);let _=g&&g.node&&g.node.name||"";const y=h.getRenderNodeByName(_);if(!y)throw new Error(`No nodes found: ${_}`);y.expanded=!0,h.buildSubHierarchy(_)})}(d,f),n1(d.root,n),o1(d.root)}function aS(e,t=!1){const n=JSON.parse(JSON.stringify(e)),r={nodes:[n],edges:[...n.edges]};return n.nodes.forEach(function i(a){(a.type===0||a.type===1)&&r.nodes.push(a),a.type===0&&(r.edges=r.edges.concat(a.edges)),Array.isArray(a.nodes)&&a.nodes.forEach(i)}),t&&r.nodes.forEach(i=>{const a=r.nodes.find(o=>o.id===i.parentNodeName);if(a){const o=a.x-a.width/2+a.paddingLeft,s=a.y-a.height/2+a.labelHeight+a.paddingTop;a.id!==Ya&&(i.x+=o,i.y+=s),i.type===0&&i.edges.forEach(c=>{c.points.forEach(f=>{f.x+=i.x-i.width/2+i.paddingLeft,f.y+=i.y-i.height/2+i.labelHeight+i.paddingTop})})}}),r}function a1(e,t,n,r){var i,a;let o=[];const s=((i=n.find(h=>h.id===e))===null||i===void 0?void 0:i.path)||[],c=((a=n.find(h=>h.id===t))===null||a===void 0?void 0:a.path)||[],f=[Ya,...s].slice(0,s.length).reverse(),d=[Ya,...c].slice(0,c.length);return f.forEach(h=>{const v=n.find(m=>m.id===h);o=o.concat(v.edges.filter(m=>m.baseEdgeList.some(g=>g.v===((r==null?void 0:r.v)||e)&&g.w===((r==null?void 0:r.w)||t))))}),d.filter(h=>!f.includes(h)).forEach(h=>{const v=n.find(m=>m.id===h);o=o.concat(v.edges.filter(m=>m.baseEdgeList.some(g=>g.v===((r==null?void 0:r.v)||e)&&g.w===((r==null?void 0:r.w)||t))))}),o}function o1(e){const t=e.coreGraph.nodes().map(r=>e.coreGraph.node(r));return Object.assign(Object.assign({},s1(e)),{expanded:e.expanded,nodes:e.expanded?(n=t,n.map(r=>r.node.type===Xi.META?o1(r):s1(r))):[],edges:e.expanded?oS(e):[]});var n}function s1(e){return{id:e.node.name,name:e.node.name,type:e.node.type,cardinality:e.node.cardinality,attr:e.attr,parentNodeName:e.node.parentNode?e.node.parentNode.name:null,coreBox:Object.assign({},e.coreBox),x:e.x,y:e.y,width:e.width,height:e.height,radius:e.radius,labelHeight:e.labelHeight,labelOffset:e.labelOffset,outboxWidth:e.outboxWidth,paddingLeft:e.paddingLeft,paddingTop:e.paddingTop,paddingRight:e.paddingRight,paddingBottom:e.paddingBottom,path:e.node.path}}function oS(e){return e.coreGraph.edges().map(t=>({renderInfoEdge:e.coreGraph.edge(t),edge:t})).filter(({renderInfoEdge:t})=>t.metaEdge).map(({edge:t,renderInfoEdge:n})=>{const r=function(i,a){const o=a.points.map(s=>Object.assign({},s));if(a.adjoiningMetaEdge){const s=a.adjoiningMetaEdge.points,c=a.metaEdge.inbound,f=c?s[s.length-1]:s[0],d=o[c?0:o.length-1],h=i.x-i.width/2,v=i.y-i.height/2,m=f.x-h,g=f.y-v,_=-i.paddingLeft,y=-(i.paddingTop+i.labelHeight);d.x=m+_,d.y=g+y}return o}(e,n);return{adjoiningEdge:n.adjoiningMetaEdge?{w:n.adjoiningMetaEdge.metaEdge.w,v:n.adjoiningMetaEdge.metaEdge.v}:null,inbound:n.metaEdge.inbound,w:t.w,v:t.v,points:r,weight:n.weight,baseEdgeList:n.metaEdge.baseEdgeList,parentNodeName:e.node.name}})}class sS extends ar{constructor(t){super();this.rankdir="TB",this.nodesep=50,this.edgesep=5,this.ranksep=50,this.controlPoints=!0,this.anchorPoint=!0,this.nodes=[],this.edges=[],this.combos=[],this.onLayoutEnd=()=>{},this.updateCfg(t)}getDefaultCfg(){return{rankdir:"TB",align:void 0,begin:void 0,nodeSize:void 0,nodesep:50,ranksep:50,controlPoints:!0,anchorPoint:!0}}init(t){const n=t.hiddenNodes||[],r=t.hiddenEdges||[],i=t.hiddenCombos||[];this.nodes=this.getDataByOrder((t.nodes||[]).concat(n)),this.edges=this.getDataByOrder((t.edges||[]).concat(r)),this.combos=(t.combos||[]).concat(i.map(a=>Object.assign(Object.assign({},a),{collapsed:!0})))}execute(){const t=this,{nodes:n,edges:r}=t;if(!n)return;const{graphDef:i,graphOption:a,graphSettings:o}=t.getLayoutConfig(),s=iS(i,a,o),c=aS(s,!0);return this.updatePosition(c),t.onLayoutEnd&&t.onLayoutEnd(),{nodes:n,edges:r}}getNodePath(t){const n=this,{nodes:r,combos:i}=n,a=r.find(s=>s.id===t),o=(s,c=[])=>{const f=i.find(d=>d.id===s);return f?(c.unshift(s),f.parentId?o(f.parentId,c):c):c};return a&&a.comboId?o(a.comboId,[t]):[t]}getLayoutConfig(){var t,n,r;const i=this,{nodes:a,edges:o,combos:s,nodeSize:c,rankdir:f,align:d,edgesep:h,nodesep:v,ranksep:m,settings:g}=i,_=(s||[]).reduce((ke,Ve)=>{const Rt=a.filter(ln=>ln.comboId===Ve.id).map(ln=>ln.id),dn=(s||[]).filter(ln=>ln.parentId===Ve.id).map(ln=>ln.id);return(Rt.length||dn.length)&&(ke[Ve.id]=[...Rt,...dn]),ke},{});let y;c?V(c)?y=()=>c:y=()=>[c,c]:y=ke=>ke&&ke.size?V(ke.size)?ke.size:be(ke.size)?[ke.size.width||40,ke.size.height||40]:[ke.size,ke.size]:[40,40];const E=ke=>ke&&ke.size?V(ke.size)?ke.size:[ke.size,ke.size]:[80,40],[b,A]=E(s==null?void 0:s[0]),C=(n=(t=i.graphSettings)===null||t===void 0?void 0:t.subScene)===null||n===void 0?void 0:n.meta,[R,z,ee,Q]=((r=s.find(ke=>!ke.collapsed))===null||r===void 0?void 0:r.padding)||[20,20,20,20],re={compound:_,nodes:[...(a||[]).map(ke=>{const Ve=y(ke),Rt=Ve[0],dn=Ve[1];return Object.assign(Object.assign({},ke),{width:Rt,height:dn})})],edges:[...(o||[]).map(ke=>Object.assign(Object.assign({},ke),{v:ke.source,w:ke.target}))]},de={expanded:(s||[]).filter(ke=>!ke.collapsed).map(ke=>ke.id)},Ie={graph:{meta:{align:d,rankDir:f,nodeSep:v,edgeSep:h,rankSep:m}},subScene:{meta:{paddingTop:R||(C==null?void 0:C.paddingTop)||20,paddingRight:z||(C==null?void 0:C.paddingRight)||20,paddingBottom:ee||(C==null?void 0:C.paddingBottom)||20,paddingLeft:Q||(C==null?void 0:C.paddingLeft)||20,labelHeight:0}},nodeSize:{meta:{width:b,height:A}}},ie=Ys(g,Object.assign({},Ys(Ie,$s)));return i.graphSettings=ie,{graphDef:re,graphOption:de,graphSettings:ie}}updatePosition(t){const{nodes:n,edges:r}=t;this.updateNodePosition(n,r),this.updateEdgePosition(n,r)}getBegin(t,n){const r=this,{begin:i}=r,a=[0,0];if(i){let o=Infinity,s=Infinity;t.forEach(c=>{o>c.x&&(o=c.x),s>c.y&&(s=c.y)}),n.forEach(c=>{c.points.forEach(f=>{o>f.x&&(o=f.x),s>f.y&&(s=f.y)})}),a[0]=i[0]-o,a[1]=i[1]-s}return a}updateNodePosition(t,n){const r=this,{combos:i,nodes:a,edges:o,anchorPoint:s,graphSettings:c}=r,f=this.getBegin(t,n);t.forEach(d=>{var h;const{x:v,y:m,id:g,type:_,coreBox:y}=d;if(_===Pc.META&&g!==Ya){const E=i.findIndex(A=>A.id===g),b=(h=c==null?void 0:c.subScene)===null||h===void 0?void 0:h.meta;i[E].offsetX=v+f[0],i[E].offsetY=m+f[1],i[E].fixSize=[y.width,y.height],i[E].fixCollapseSize=[y.width,y.height],d.expanded?i[E].padding=[b==null?void 0:b.paddingTop,b==null?void 0:b.paddingRight,b==null?void 0:b.paddingBottom,b==null?void 0:b.paddingLeft]:i[E].padding=[0,0,0,0]}else if(_===Pc.OP){const E=a.findIndex(b=>b.id===g);if(a[E].x=v+f[0],a[E].y=m+f[1],s){const b=[],A=n.filter(R=>R.v===g),C=n.filter(R=>R.w===g);A.length>0&&A.forEach(R=>{const z=R.points[0],ee=(z.x-v)/d.width+.5,Q=(z.y-m)/d.height+.5;b.push([ee,Q]),R.baseEdgeList.forEach(re=>{const de=o.find(Ie=>Ie.source===re.v&&Ie.target===re.w);de&&(de.sourceAnchor=b.length-1)})}),C.length>0&&C.forEach(R=>{const z=R.points[R.points.length-1],ee=(z.x-v)/d.width+.5,Q=(z.y-m)/d.height+.5;b.push([ee,Q]),R.baseEdgeList.forEach(re=>{const de=o.find(Ie=>Ie.source===re.v&&Ie.target===re.w);de&&(de.targetAnchor=b.length-1)})}),a[E].anchorPoints=b.length>0?b:a[E].anchorPoints||[]}}})}updateEdgePosition(t,n){const r=this,{combos:i,edges:a,controlPoints:o}=r,s=this.getBegin(t,n);o&&(i.forEach(c=>{c.inEdges=[],c.outEdges=[]}),a.forEach(c=>{var f,d,h,v;let m=t.find(E=>E.id===c.source),g=t.find(E=>E.id===c.target),_=[],y=[];if(m&&g)y=a1(m==null?void 0:m.id,g==null?void 0:g.id,t);else if(!m||!g){const E=r.getNodePath(c.source),b=r.getNodePath(c.target),A=E.reverse().slice(m?0:1).find(R=>t.find(z=>z.id===R)),C=b.reverse().slice(g?0:1).find(R=>t.find(z=>z.id===R));m=t.find(R=>R.id===A),g=t.find(R=>R.id===C),y=a1(m==null?void 0:m.id,g==null?void 0:g.id,t,{v:c.source,w:c.target})}if(_=y.reduce((E,b)=>[...E,...b.points.map(A=>Object.assign(Object.assign({},A),{x:A.x+s[0],y:A.y+s[1]}))],[]),_=_.slice(1,-1),c.controlPoints=_,(g==null?void 0:g.type)===Xi.META){const E=i.findIndex(b=>b.id===(g==null?void 0:g.id));if(!i[E]||((f=i[E].inEdges)===null||f===void 0?void 0:f.some(b=>b.source===m.id&&b.target===g.id)))return;(d=i[E].inEdges)===null||d===void 0||d.push({source:m.id,target:g.id,controlPoints:_})}if((m==null?void 0:m.type)===Xi.META){const E=i.findIndex(b=>b.id===(m==null?void 0:m.id));if(!i[E]||((h=i[E].outEdges)===null||h===void 0?void 0:h.some(b=>b.source===m.id&&b.target===g.id)))return;(v=i[E].outEdges)===null||v===void 0||v.push({source:m.id,target:g.id,controlPoints:_})}}))}getType(){return"dagreCompound"}getDataByOrder(t){return t.every(n=>n.layoutOrder!==void 0)||t.forEach((n,r)=>{n.layoutOrder=r}),t.sort((n,r)=>n.layoutOrder-r.layoutOrder)}}var uS=S(79320),u1=S(81306),c1=S(59206),D0=S(69610),P0=S(54941);const cS=Object.prototype.toString;function qo(e){return cS.call(e).endsWith("Array]")}function fS(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!qo(e))throw new TypeError("input must be an array");if(e.length===0)throw new TypeError("input must not be empty");var n=t.fromIndex,r=n===void 0?0:n,i=t.toIndex,a=i===void 0?e.length:i;if(r<0||r>=e.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=r||a>e.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var o=e[r],s=r+1;s<a;s++)e[s]>o&&(o=e[s]);return o}function lS(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!qo(e))throw new TypeError("input must be an array");if(e.length===0)throw new TypeError("input must not be empty");var n=t.fromIndex,r=n===void 0?0:n,i=t.toIndex,a=i===void 0?e.length:i;if(r<0||r>=e.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=r||a>e.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var o=e[r],s=r+1;s<a;s++)e[s]<o&&(o=e[s]);return o}function f1(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(qo(e)){if(e.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var n;if(t.output!==void 0){if(!qo(t.output))throw new TypeError("output option must be an array if specified");n=t.output}else n=new Array(e.length);var r=lS(e),i=fS(e);if(r===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var a=t.min,o=a===void 0?t.autoMinMax?r:0:a,s=t.max,c=s===void 0?t.autoMinMax?i:1:s;if(o>=c)throw new RangeError("min option must be smaller than max option");for(var f=(c-o)/(i-r),d=0;d<e.length;d++)n[d]=(e[d]-r)*f+o;return n}var O0=" ".repeat(2),l1=" ".repeat(4);function dS(){return d1(this)}function d1(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.maxRows,r=n===void 0?15:n,i=t.maxColumns,a=i===void 0?10:i,o=t.maxNumSize,s=o===void 0?8:o;return"".concat(e.constructor.name,` {
`).concat(O0,`[
`).concat(l1).concat(hS(e,r,a,s),`
`).concat(O0,`]
`).concat(O0,"rows: ").concat(e.rows,`
`).concat(O0,"columns: ").concat(e.columns,`
}`)}function hS(e,t,n,r){for(var i=e.rows,a=e.columns,o=Math.min(i,t),s=Math.min(a,n),c=[],f=0;f<o;f++){for(var d=[],h=0;h<s;h++)d.push(vS(e.get(f,h),r));c.push("".concat(d.join(" ")))}return s!==a&&(c[c.length-1]+=" ... ".concat(a-n," more columns")),o!==i&&c.push("... ".concat(i-t," more rows")),c.join(`
`.concat(l1))}function vS(e,t){var n=String(e);if(n.length<=t)return n.padEnd(t," ");var r=e.toPrecision(t-2);if(r.length<=t)return r;var i=e.toExponential(t-2),a=i.indexOf("e"),o=i.slice(a);return i.slice(0,t-o.length)+o}function pS(e,t){e.prototype.add=function(r){return typeof r=="number"?this.addS(r):this.addM(r)},e.prototype.addS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)+r);return this},e.prototype.addM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)+r.get(i,a));return this},e.add=function(r,i){var a=new t(r);return a.add(i)},e.prototype.sub=function(r){return typeof r=="number"?this.subS(r):this.subM(r)},e.prototype.subS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)-r);return this},e.prototype.subM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)-r.get(i,a));return this},e.sub=function(r,i){var a=new t(r);return a.sub(i)},e.prototype.subtract=e.prototype.sub,e.prototype.subtractS=e.prototype.subS,e.prototype.subtractM=e.prototype.subM,e.subtract=e.sub,e.prototype.mul=function(r){return typeof r=="number"?this.mulS(r):this.mulM(r)},e.prototype.mulS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)*r);return this},e.prototype.mulM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)*r.get(i,a));return this},e.mul=function(r,i){var a=new t(r);return a.mul(i)},e.prototype.multiply=e.prototype.mul,e.prototype.multiplyS=e.prototype.mulS,e.prototype.multiplyM=e.prototype.mulM,e.multiply=e.mul,e.prototype.div=function(r){return typeof r=="number"?this.divS(r):this.divM(r)},e.prototype.divS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)/r);return this},e.prototype.divM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)/r.get(i,a));return this},e.div=function(r,i){var a=new t(r);return a.div(i)},e.prototype.divide=e.prototype.div,e.prototype.divideS=e.prototype.divS,e.prototype.divideM=e.prototype.divM,e.divide=e.div,e.prototype.mod=function(r){return typeof r=="number"?this.modS(r):this.modM(r)},e.prototype.modS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)%r);return this},e.prototype.modM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)%r.get(i,a));return this},e.mod=function(r,i){var a=new t(r);return a.mod(i)},e.prototype.modulus=e.prototype.mod,e.prototype.modulusS=e.prototype.modS,e.prototype.modulusM=e.prototype.modM,e.modulus=e.mod,e.prototype.and=function(r){return typeof r=="number"?this.andS(r):this.andM(r)},e.prototype.andS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)&r);return this},e.prototype.andM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)&r.get(i,a));return this},e.and=function(r,i){var a=new t(r);return a.and(i)},e.prototype.or=function(r){return typeof r=="number"?this.orS(r):this.orM(r)},e.prototype.orS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)|r);return this},e.prototype.orM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)|r.get(i,a));return this},e.or=function(r,i){var a=new t(r);return a.or(i)},e.prototype.xor=function(r){return typeof r=="number"?this.xorS(r):this.xorM(r)},e.prototype.xorS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)^r);return this},e.prototype.xorM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)^r.get(i,a));return this},e.xor=function(r,i){var a=new t(r);return a.xor(i)},e.prototype.leftShift=function(r){return typeof r=="number"?this.leftShiftS(r):this.leftShiftM(r)},e.prototype.leftShiftS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)<<r);return this},e.prototype.leftShiftM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)<<r.get(i,a));return this},e.leftShift=function(r,i){var a=new t(r);return a.leftShift(i)},e.prototype.signPropagatingRightShift=function(r){return typeof r=="number"?this.signPropagatingRightShiftS(r):this.signPropagatingRightShiftM(r)},e.prototype.signPropagatingRightShiftS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)>>r);return this},e.prototype.signPropagatingRightShiftM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)>>r.get(i,a));return this},e.signPropagatingRightShift=function(r,i){var a=new t(r);return a.signPropagatingRightShift(i)},e.prototype.rightShift=function(r){return typeof r=="number"?this.rightShiftS(r):this.rightShiftM(r)},e.prototype.rightShiftS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)>>>r);return this},e.prototype.rightShiftM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)>>>r.get(i,a));return this},e.rightShift=function(r,i){var a=new t(r);return a.rightShift(i)},e.prototype.zeroFillRightShift=e.prototype.rightShift,e.prototype.zeroFillRightShiftS=e.prototype.rightShiftS,e.prototype.zeroFillRightShiftM=e.prototype.rightShiftM,e.zeroFillRightShift=e.rightShift,e.prototype.not=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,~this.get(r,i));return this},e.not=function(r){var i=new t(r);return i.not()},e.prototype.abs=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.abs(this.get(r,i)));return this},e.abs=function(r){var i=new t(r);return i.abs()},e.prototype.acos=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.acos(this.get(r,i)));return this},e.acos=function(r){var i=new t(r);return i.acos()},e.prototype.acosh=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.acosh(this.get(r,i)));return this},e.acosh=function(r){var i=new t(r);return i.acosh()},e.prototype.asin=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.asin(this.get(r,i)));return this},e.asin=function(r){var i=new t(r);return i.asin()},e.prototype.asinh=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.asinh(this.get(r,i)));return this},e.asinh=function(r){var i=new t(r);return i.asinh()},e.prototype.atan=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.atan(this.get(r,i)));return this},e.atan=function(r){var i=new t(r);return i.atan()},e.prototype.atanh=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.atanh(this.get(r,i)));return this},e.atanh=function(r){var i=new t(r);return i.atanh()},e.prototype.cbrt=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.cbrt(this.get(r,i)));return this},e.cbrt=function(r){var i=new t(r);return i.cbrt()},e.prototype.ceil=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.ceil(this.get(r,i)));return this},e.ceil=function(r){var i=new t(r);return i.ceil()},e.prototype.clz32=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.clz32(this.get(r,i)));return this},e.clz32=function(r){var i=new t(r);return i.clz32()},e.prototype.cos=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.cos(this.get(r,i)));return this},e.cos=function(r){var i=new t(r);return i.cos()},e.prototype.cosh=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.cosh(this.get(r,i)));return this},e.cosh=function(r){var i=new t(r);return i.cosh()},e.prototype.exp=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.exp(this.get(r,i)));return this},e.exp=function(r){var i=new t(r);return i.exp()},e.prototype.expm1=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.expm1(this.get(r,i)));return this},e.expm1=function(r){var i=new t(r);return i.expm1()},e.prototype.floor=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.floor(this.get(r,i)));return this},e.floor=function(r){var i=new t(r);return i.floor()},e.prototype.fround=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.fround(this.get(r,i)));return this},e.fround=function(r){var i=new t(r);return i.fround()},e.prototype.log=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.log(this.get(r,i)));return this},e.log=function(r){var i=new t(r);return i.log()},e.prototype.log1p=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.log1p(this.get(r,i)));return this},e.log1p=function(r){var i=new t(r);return i.log1p()},e.prototype.log10=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.log10(this.get(r,i)));return this},e.log10=function(r){var i=new t(r);return i.log10()},e.prototype.log2=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.log2(this.get(r,i)));return this},e.log2=function(r){var i=new t(r);return i.log2()},e.prototype.round=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.round(this.get(r,i)));return this},e.round=function(r){var i=new t(r);return i.round()},e.prototype.sign=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.sign(this.get(r,i)));return this},e.sign=function(r){var i=new t(r);return i.sign()},e.prototype.sin=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.sin(this.get(r,i)));return this},e.sin=function(r){var i=new t(r);return i.sin()},e.prototype.sinh=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.sinh(this.get(r,i)));return this},e.sinh=function(r){var i=new t(r);return i.sinh()},e.prototype.sqrt=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.sqrt(this.get(r,i)));return this},e.sqrt=function(r){var i=new t(r);return i.sqrt()},e.prototype.tan=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.tan(this.get(r,i)));return this},e.tan=function(r){var i=new t(r);return i.tan()},e.prototype.tanh=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.tanh(this.get(r,i)));return this},e.tanh=function(r){var i=new t(r);return i.tanh()},e.prototype.trunc=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.trunc(this.get(r,i)));return this},e.trunc=function(r){var i=new t(r);return i.trunc()},e.pow=function(r,i){var a=new t(r);return a.pow(i)},e.prototype.pow=function(r){return typeof r=="number"?this.powS(r):this.powM(r)},e.prototype.powS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,Math.pow(this.get(i,a),r));return this},e.prototype.powM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,Math.pow(this.get(i,a),r.get(i,a)));return this}}function su(e,t,n){var r=n?e.rows:e.rows-1;if(t<0||t>r)throw new RangeError("Row index out of range")}function uu(e,t,n){var r=n?e.columns:e.columns-1;if(t<0||t>r)throw new RangeError("Column index out of range")}function ph(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw new RangeError("vector size must be the same as the number of columns");return t}function mh(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw new RangeError("vector size must be the same as the number of rows");return t}function mS(e,t){if(!qo(t))throw new TypeError("row indices must be an array");for(var n=0;n<t.length;n++)if(t[n]<0||t[n]>=e.rows)throw new RangeError("row indices are out of range")}function gS(e,t){if(!qo(t))throw new TypeError("column indices must be an array");for(var n=0;n<t.length;n++)if(t[n]<0||t[n]>=e.columns)throw new RangeError("column indices are out of range")}function h1(e,t,n,r,i){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(G0("startRow",t),G0("endRow",n),G0("startColumn",r),G0("endColumn",i),t>n||r>i||t<0||t>=e.rows||n<0||n>=e.rows||r<0||r>=e.columns||i<0||i>=e.columns)throw new RangeError("Submatrix indices are out of range")}function L0(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=[],r=0;r<e;r++)n.push(t);return n}function G0(e,t){if(typeof t!="number")throw new TypeError("".concat(e," must be a number"))}function gh(e){if(e.isEmpty())throw new Error("Empty matrix has no elements to index")}function yS(e){for(var t=L0(e.rows),n=0;n<e.rows;++n)for(var r=0;r<e.columns;++r)t[n]+=e.get(n,r);return t}function _S(e){for(var t=L0(e.columns),n=0;n<e.rows;++n)for(var r=0;r<e.columns;++r)t[r]+=e.get(n,r);return t}function ES(e){for(var t=0,n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)t+=e.get(n,r);return t}function bS(e){for(var t=L0(e.rows,1),n=0;n<e.rows;++n)for(var r=0;r<e.columns;++r)t[n]*=e.get(n,r);return t}function wS(e){for(var t=L0(e.columns,1),n=0;n<e.rows;++n)for(var r=0;r<e.columns;++r)t[r]*=e.get(n,r);return t}function xS(e){for(var t=1,n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)t*=e.get(n,r);return t}function SS(e,t,n){for(var r=e.rows,i=e.columns,a=[],o=0;o<r;o++){for(var s=0,c=0,f=0,d=0;d<i;d++)f=e.get(o,d)-n[o],s+=f,c+=f*f;t?a.push((c-s*s/i)/(i-1)):a.push((c-s*s/i)/i)}return a}function TS(e,t,n){for(var r=e.rows,i=e.columns,a=[],o=0;o<i;o++){for(var s=0,c=0,f=0,d=0;d<r;d++)f=e.get(d,o)-n[o],s+=f,c+=f*f;t?a.push((c-s*s/r)/(r-1)):a.push((c-s*s/r)/r)}return a}function AS(e,t,n){for(var r=e.rows,i=e.columns,a=r*i,o=0,s=0,c=0,f=0;f<r;f++)for(var d=0;d<i;d++)c=e.get(f,d)-n,o+=c,s+=c*c;return t?(s-o*o/a)/(a-1):(s-o*o/a)/a}function IS(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t[n])}function CS(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t[r])}function RS(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t)}function MS(e){for(var t=[],n=0;n<e.rows;n++){for(var r=0,i=0;i<e.columns;i++)r+=Math.pow(e.get(n,i),2)/(e.columns-1);t.push(Math.sqrt(r))}return t}function NS(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t[n])}function DS(e){for(var t=[],n=0;n<e.columns;n++){for(var r=0,i=0;i<e.rows;i++)r+=Math.pow(e.get(i,n),2)/(e.rows-1);t.push(Math.sqrt(r))}return t}function PS(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t[r])}function OS(e){for(var t=e.size-1,n=0,r=0;r<e.columns;r++)for(var i=0;i<e.rows;i++)n+=Math.pow(e.get(i,r),2)/t;return Math.sqrt(n)}function LS(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t)}var ia=function(){function e(){(0,D0.Z)(this,e)}return(0,P0.Z)(e,[{key:"size",get:function(){return this.rows*this.columns}},{key:"apply",value:function(n){if(typeof n!="function")throw new TypeError("callback must be a function");for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)n.call(this,r,i);return this}},{key:"to1DArray",value:function(){for(var n=[],r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)n.push(this.get(r,i));return n}},{key:"to2DArray",value:function(){for(var n=[],r=0;r<this.rows;r++){n.push([]);for(var i=0;i<this.columns;i++)n[r].push(this.get(r,i))}return n}},{key:"toJSON",value:function(){return this.to2DArray()}},{key:"isRowVector",value:function(){return this.rows===1}},{key:"isColumnVector",value:function(){return this.columns===1}},{key:"isVector",value:function(){return this.rows===1||this.columns===1}},{key:"isSquare",value:function(){return this.rows===this.columns}},{key:"isEmpty",value:function(){return this.rows===0||this.columns===0}},{key:"isSymmetric",value:function(){if(this.isSquare()){for(var n=0;n<this.rows;n++)for(var r=0;r<=n;r++)if(this.get(n,r)!==this.get(r,n))return!1;return!0}return!1}},{key:"isEchelonForm",value:function(){for(var n=0,r=0,i=-1,a=!0,o=!1;n<this.rows&&a;){for(r=0,o=!1;r<this.columns&&o===!1;)this.get(n,r)===0?r++:this.get(n,r)===1&&r>i?(o=!0,i=r):(a=!1,o=!0);n++}return a}},{key:"isReducedEchelonForm",value:function(){for(var n=0,r=0,i=-1,a=!0,o=!1;n<this.rows&&a;){for(r=0,o=!1;r<this.columns&&o===!1;)this.get(n,r)===0?r++:this.get(n,r)===1&&r>i?(o=!0,i=r):(a=!1,o=!0);for(var s=r+1;s<this.rows;s++)this.get(n,s)!==0&&(a=!1);n++}return a}},{key:"echelonForm",value:function(){for(var n=this.clone(),r=0,i=0;r<n.rows&&i<n.columns;){for(var a=r,o=r;o<n.rows;o++)n.get(o,i)>n.get(a,i)&&(a=o);if(n.get(a,i)===0)i++;else{n.swapRows(r,a);for(var s=n.get(r,i),c=i;c<n.columns;c++)n.set(r,c,n.get(r,c)/s);for(var f=r+1;f<n.rows;f++){var d=n.get(f,i)/n.get(r,i);n.set(f,i,0);for(var h=i+1;h<n.columns;h++)n.set(f,h,n.get(f,h)-n.get(r,h)*d)}r++,i++}}return n}},{key:"reducedEchelonForm",value:function(){for(var n=this.echelonForm(),r=n.columns,i=n.rows,a=i-1;a>=0;)if(n.maxRow(a)===0)a--;else{for(var o=0,s=!1;o<i&&s===!1;)n.get(a,o)===1?s=!0:o++;for(var c=0;c<a;c++)for(var f=n.get(c,o),d=o;d<r;d++){var h=n.get(c,d)-f*n.get(a,d);n.set(c,d,h)}a--}return n}},{key:"set",value:function(){throw new Error("set method is unimplemented")}},{key:"get",value:function(){throw new Error("get method is unimplemented")}},{key:"repeat",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof n!="object")throw new TypeError("options must be an object");var r=n.rows,i=r===void 0?1:r,a=n.columns,o=a===void 0?1:a;if(!Number.isInteger(i)||i<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(o)||o<=0)throw new TypeError("columns must be a positive integer");for(var s=new Ln(this.rows*i,this.columns*o),c=0;c<i;c++)for(var f=0;f<o;f++)s.setSubMatrix(this,this.rows*c,this.columns*f);return s}},{key:"fill",value:function(n){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,n);return this}},{key:"neg",value:function(){return this.mulS(-1)}},{key:"getRow",value:function(n){su(this,n);for(var r=[],i=0;i<this.columns;i++)r.push(this.get(n,i));return r}},{key:"getRowVector",value:function(n){return Ln.rowVector(this.getRow(n))}},{key:"setRow",value:function(n,r){su(this,n),r=ph(this,r);for(var i=0;i<this.columns;i++)this.set(n,i,r[i]);return this}},{key:"swapRows",value:function(n,r){su(this,n),su(this,r);for(var i=0;i<this.columns;i++){var a=this.get(n,i);this.set(n,i,this.get(r,i)),this.set(r,i,a)}return this}},{key:"getColumn",value:function(n){uu(this,n);for(var r=[],i=0;i<this.rows;i++)r.push(this.get(i,n));return r}},{key:"getColumnVector",value:function(n){return Ln.columnVector(this.getColumn(n))}},{key:"setColumn",value:function(n,r){uu(this,n),r=mh(this,r);for(var i=0;i<this.rows;i++)this.set(i,n,r[i]);return this}},{key:"swapColumns",value:function(n,r){uu(this,n),uu(this,r);for(var i=0;i<this.rows;i++){var a=this.get(i,n);this.set(i,n,this.get(i,r)),this.set(i,r,a)}return this}},{key:"addRowVector",value:function(n){n=ph(this,n);for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)+n[i]);return this}},{key:"subRowVector",value:function(n){n=ph(this,n);for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)-n[i]);return this}},{key:"mulRowVector",value:function(n){n=ph(this,n);for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)*n[i]);return this}},{key:"divRowVector",value:function(n){n=ph(this,n);for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)/n[i]);return this}},{key:"addColumnVector",value:function(n){n=mh(this,n);for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)+n[r]);return this}},{key:"subColumnVector",value:function(n){n=mh(this,n);for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)-n[r]);return this}},{key:"mulColumnVector",value:function(n){n=mh(this,n);for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)*n[r]);return this}},{key:"divColumnVector",value:function(n){n=mh(this,n);for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)/n[r]);return this}},{key:"mulRow",value:function(n,r){su(this,n);for(var i=0;i<this.columns;i++)this.set(n,i,this.get(n,i)*r);return this}},{key:"mulColumn",value:function(n,r){uu(this,n);for(var i=0;i<this.rows;i++)this.set(i,n,this.get(i,n)*r);return this}},{key:"max",value:function(n){if(this.isEmpty())return NaN;switch(n){case"row":{for(var r=new Array(this.rows).fill(Number.NEGATIVE_INFINITY),i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.get(i,a)>r[i]&&(r[i]=this.get(i,a));return r}case"column":{for(var o=new Array(this.columns).fill(Number.NEGATIVE_INFINITY),s=0;s<this.rows;s++)for(var c=0;c<this.columns;c++)this.get(s,c)>o[c]&&(o[c]=this.get(s,c));return o}case void 0:{for(var f=this.get(0,0),d=0;d<this.rows;d++)for(var h=0;h<this.columns;h++)this.get(d,h)>f&&(f=this.get(d,h));return f}default:throw new Error("invalid option: ".concat(n))}}},{key:"maxIndex",value:function(){gh(this);for(var n=this.get(0,0),r=[0,0],i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.get(i,a)>n&&(n=this.get(i,a),r[0]=i,r[1]=a);return r}},{key:"min",value:function(n){if(this.isEmpty())return NaN;switch(n){case"row":{for(var r=new Array(this.rows).fill(Number.POSITIVE_INFINITY),i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.get(i,a)<r[i]&&(r[i]=this.get(i,a));return r}case"column":{for(var o=new Array(this.columns).fill(Number.POSITIVE_INFINITY),s=0;s<this.rows;s++)for(var c=0;c<this.columns;c++)this.get(s,c)<o[c]&&(o[c]=this.get(s,c));return o}case void 0:{for(var f=this.get(0,0),d=0;d<this.rows;d++)for(var h=0;h<this.columns;h++)this.get(d,h)<f&&(f=this.get(d,h));return f}default:throw new Error("invalid option: ".concat(n))}}},{key:"minIndex",value:function(){gh(this);for(var n=this.get(0,0),r=[0,0],i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.get(i,a)<n&&(n=this.get(i,a),r[0]=i,r[1]=a);return r}},{key:"maxRow",value:function(n){if(su(this,n),this.isEmpty())return NaN;for(var r=this.get(n,0),i=1;i<this.columns;i++)this.get(n,i)>r&&(r=this.get(n,i));return r}},{key:"maxRowIndex",value:function(n){su(this,n),gh(this);for(var r=this.get(n,0),i=[n,0],a=1;a<this.columns;a++)this.get(n,a)>r&&(r=this.get(n,a),i[1]=a);return i}},{key:"minRow",value:function(n){if(su(this,n),this.isEmpty())return NaN;for(var r=this.get(n,0),i=1;i<this.columns;i++)this.get(n,i)<r&&(r=this.get(n,i));return r}},{key:"minRowIndex",value:function(n){su(this,n),gh(this);for(var r=this.get(n,0),i=[n,0],a=1;a<this.columns;a++)this.get(n,a)<r&&(r=this.get(n,a),i[1]=a);return i}},{key:"maxColumn",value:function(n){if(uu(this,n),this.isEmpty())return NaN;for(var r=this.get(0,n),i=1;i<this.rows;i++)this.get(i,n)>r&&(r=this.get(i,n));return r}},{key:"maxColumnIndex",value:function(n){uu(this,n),gh(this);for(var r=this.get(0,n),i=[0,n],a=1;a<this.rows;a++)this.get(a,n)>r&&(r=this.get(a,n),i[0]=a);return i}},{key:"minColumn",value:function(n){if(uu(this,n),this.isEmpty())return NaN;for(var r=this.get(0,n),i=1;i<this.rows;i++)this.get(i,n)<r&&(r=this.get(i,n));return r}},{key:"minColumnIndex",value:function(n){uu(this,n),gh(this);for(var r=this.get(0,n),i=[0,n],a=1;a<this.rows;a++)this.get(a,n)<r&&(r=this.get(a,n),i[0]=a);return i}},{key:"diag",value:function(){for(var n=Math.min(this.rows,this.columns),r=[],i=0;i<n;i++)r.push(this.get(i,i));return r}},{key:"norm",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"frobenius",r=0;if(n==="max")return this.max();if(n==="frobenius"){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)r=r+this.get(i,a)*this.get(i,a);return Math.sqrt(r)}else throw new RangeError("unknown norm type: ".concat(n))}},{key:"cumulativeSum",value:function(){for(var n=0,r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)n+=this.get(r,i),this.set(r,i,n);return this}},{key:"dot",value:function(n){e.isMatrix(n)&&(n=n.to1DArray());var r=this.to1DArray();if(r.length!==n.length)throw new RangeError("vectors do not have the same size");for(var i=0,a=0;a<r.length;a++)i+=r[a]*n[a];return i}},{key:"mmul",value:function(n){n=Ln.checkMatrix(n);for(var r=this.rows,i=this.columns,a=n.columns,o=new Ln(r,a),s=new Float64Array(i),c=0;c<a;c++){for(var f=0;f<i;f++)s[f]=n.get(f,c);for(var d=0;d<r;d++){for(var h=0,v=0;v<i;v++)h+=this.get(d,v)*s[v];o.set(d,c,h)}}return o}},{key:"strassen2x2",value:function(n){n=Ln.checkMatrix(n);var r=new Ln(2,2),i=this.get(0,0),a=n.get(0,0),o=this.get(0,1),s=n.get(0,1),c=this.get(1,0),f=n.get(1,0),d=this.get(1,1),h=n.get(1,1),v=(i+d)*(a+h),m=(c+d)*a,g=i*(s-h),_=d*(f-a),y=(i+o)*h,E=(c-i)*(a+s),b=(o-d)*(f+h),A=v+_-y+b,C=g+y,R=m+_,z=v-m+g+E;return r.set(0,0,A),r.set(0,1,C),r.set(1,0,R),r.set(1,1,z),r}},{key:"strassen3x3",value:function(n){n=Ln.checkMatrix(n);var r=new Ln(3,3),i=this.get(0,0),a=this.get(0,1),o=this.get(0,2),s=this.get(1,0),c=this.get(1,1),f=this.get(1,2),d=this.get(2,0),h=this.get(2,1),v=this.get(2,2),m=n.get(0,0),g=n.get(0,1),_=n.get(0,2),y=n.get(1,0),E=n.get(1,1),b=n.get(1,2),A=n.get(2,0),C=n.get(2,1),R=n.get(2,2),z=(i+a+o-s-c-h-v)*E,ee=(i-s)*(-g+E),Q=c*(-m+g+y-E-b-A+R),re=(-i+s+c)*(m-g+E),de=(s+c)*(-m+g),Ie=i*m,ie=(-i+d+h)*(m-_+b),ke=(-i+d)*(_-b),Ve=(d+h)*(-m+_),Rt=(i+a+o-c-f-d-h)*b,dn=h*(-m+_+y-E-b-A+C),ln=(-o+h+v)*(E+A-C),pn=(o-v)*(E-C),lr=o*A,Si=(h+v)*(-A+C),Hr=(-o+c+f)*(b+A-R),_n=(o-f)*(b-R),wn=(c+f)*(-A+R),Ot=a*y,Tn=f*C,hr=s*_,zn=d*g,mn=v*R,Qt=Ie+lr+Ot,mr=z+re+de+Ie+ln+lr+Si,Qr=Ie+ie+Ve+Rt+lr+Hr+wn,br=ee+Q+re+Ie+lr+Hr+_n,ro=ee+re+de+Ie+Tn,fu=lr+Hr+_n+wn+hr,qc=Ie+ie+ke+dn+ln+pn+lr,Qc=ln+pn+lr+Si+zn,ef=Ie+ie+ke+Ve+mn;return r.set(0,0,Qt),r.set(0,1,mr),r.set(0,2,Qr),r.set(1,0,br),r.set(1,1,ro),r.set(1,2,fu),r.set(2,0,qc),r.set(2,1,Qc),r.set(2,2,ef),r}},{key:"mmulStrassen",value:function(n){n=Ln.checkMatrix(n);var r=this.clone(),i=r.rows,a=r.columns,o=n.rows,s=n.columns;a!==o&&console.warn("Multiplying ".concat(i," x ").concat(a," and ").concat(o," x ").concat(s," matrix: dimensions do not match."));function c(v,m,g){var _=v.rows,y=v.columns;if(_===m&&y===g)return v;var E=e.zeros(m,g);return E=E.setSubMatrix(v,0,0),E}var f=Math.max(i,o),d=Math.max(a,s);r=c(r,f,d),n=c(n,f,d);function h(v,m,g,_){if(g<=512||_<=512)return v.mmul(m);g%2==1&&_%2==1?(v=c(v,g+1,_+1),m=c(m,g+1,_+1)):g%2==1?(v=c(v,g+1,_),m=c(m,g+1,_)):_%2==1&&(v=c(v,g,_+1),m=c(m,g,_+1));var y=parseInt(v.rows/2,10),E=parseInt(v.columns/2,10),b=v.subMatrix(0,y-1,0,E-1),A=m.subMatrix(0,y-1,0,E-1),C=v.subMatrix(0,y-1,E,v.columns-1),R=m.subMatrix(0,y-1,E,m.columns-1),z=v.subMatrix(y,v.rows-1,0,E-1),ee=m.subMatrix(y,m.rows-1,0,E-1),Q=v.subMatrix(y,v.rows-1,E,v.columns-1),re=m.subMatrix(y,m.rows-1,E,m.columns-1),de=h(e.add(b,Q),e.add(A,re),y,E),Ie=h(e.add(z,Q),A,y,E),ie=h(b,e.sub(R,re),y,E),ke=h(Q,e.sub(ee,A),y,E),Ve=h(e.add(b,C),re,y,E),Rt=h(e.sub(z,b),e.add(A,R),y,E),dn=h(e.sub(C,Q),e.add(ee,re),y,E),ln=e.add(de,ke);ln.sub(Ve),ln.add(dn);var pn=e.add(ie,Ve),lr=e.add(Ie,ke),Si=e.sub(de,Ie);Si.add(ie),Si.add(Rt);var Hr=e.zeros(2*ln.rows,2*ln.columns);return Hr=Hr.setSubMatrix(ln,0,0),Hr=Hr.setSubMatrix(pn,ln.rows,0),Hr=Hr.setSubMatrix(lr,0,ln.columns),Hr=Hr.setSubMatrix(Si,ln.rows,ln.columns),Hr.subMatrix(0,g-1,0,_-1)}return h(r,n,f,d)}},{key:"scaleRows",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof n!="object")throw new TypeError("options must be an object");var r=n.min,i=r===void 0?0:r,a=n.max,o=a===void 0?1:a;if(!Number.isFinite(i))throw new TypeError("min must be a number");if(!Number.isFinite(o))throw new TypeError("max must be a number");if(i>=o)throw new RangeError("min must be smaller than max");for(var s=new Ln(this.rows,this.columns),c=0;c<this.rows;c++){var f=this.getRow(c);f.length>0&&f1(f,{min:i,max:o,output:f}),s.setRow(c,f)}return s}},{key:"scaleColumns",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof n!="object")throw new TypeError("options must be an object");var r=n.min,i=r===void 0?0:r,a=n.max,o=a===void 0?1:a;if(!Number.isFinite(i))throw new TypeError("min must be a number");if(!Number.isFinite(o))throw new TypeError("max must be a number");if(i>=o)throw new RangeError("min must be smaller than max");for(var s=new Ln(this.rows,this.columns),c=0;c<this.columns;c++){var f=this.getColumn(c);f.length&&f1(f,{min:i,max:o,output:f}),s.setColumn(c,f)}return s}},{key:"flipRows",value:function(){for(var n=Math.ceil(this.columns/2),r=0;r<this.rows;r++)for(var i=0;i<n;i++){var a=this.get(r,i),o=this.get(r,this.columns-1-i);this.set(r,i,o),this.set(r,this.columns-1-i,a)}return this}},{key:"flipColumns",value:function(){for(var n=Math.ceil(this.rows/2),r=0;r<this.columns;r++)for(var i=0;i<n;i++){var a=this.get(i,r),o=this.get(this.rows-1-i,r);this.set(i,r,o),this.set(this.rows-1-i,r,a)}return this}},{key:"kroneckerProduct",value:function(n){n=Ln.checkMatrix(n);for(var r=this.rows,i=this.columns,a=n.rows,o=n.columns,s=new Ln(r*a,i*o),c=0;c<r;c++)for(var f=0;f<i;f++)for(var d=0;d<a;d++)for(var h=0;h<o;h++)s.set(a*c+d,o*f+h,this.get(c,f)*n.get(d,h));return s}},{key:"kroneckerSum",value:function(n){if(n=Ln.checkMatrix(n),!this.isSquare()||!n.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");var r=this.rows,i=n.rows,a=this.kroneckerProduct(Ln.eye(i,i)),o=Ln.eye(r,r).kroneckerProduct(n);return a.add(o)}},{key:"transpose",value:function(){for(var n=new Ln(this.columns,this.rows),r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)n.set(i,r,this.get(r,i));return n}},{key:"sortRows",value:function(){for(var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v1,r=0;r<this.rows;r++)this.setRow(r,this.getRow(r).sort(n));return this}},{key:"sortColumns",value:function(){for(var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v1,r=0;r<this.columns;r++)this.setColumn(r,this.getColumn(r).sort(n));return this}},{key:"subMatrix",value:function(n,r,i,a){h1(this,n,r,i,a);for(var o=new Ln(r-n+1,a-i+1),s=n;s<=r;s++)for(var c=i;c<=a;c++)o.set(s-n,c-i,this.get(s,c));return o}},{key:"subMatrixRow",value:function(n,r,i){if(r===void 0&&(r=0),i===void 0&&(i=this.columns-1),r>i||r<0||r>=this.columns||i<0||i>=this.columns)throw new RangeError("Argument out of range");for(var a=new Ln(n.length,i-r+1),o=0;o<n.length;o++)for(var s=r;s<=i;s++){if(n[o]<0||n[o]>=this.rows)throw new RangeError("Row index out of range: ".concat(n[o]));a.set(o,s-r,this.get(n[o],s))}return a}},{key:"subMatrixColumn",value:function(n,r,i){if(r===void 0&&(r=0),i===void 0&&(i=this.rows-1),r>i||r<0||r>=this.rows||i<0||i>=this.rows)throw new RangeError("Argument out of range");for(var a=new Ln(i-r+1,n.length),o=0;o<n.length;o++)for(var s=r;s<=i;s++){if(n[o]<0||n[o]>=this.columns)throw new RangeError("Column index out of range: ".concat(n[o]));a.set(s-r,o,this.get(s,n[o]))}return a}},{key:"setSubMatrix",value:function(n,r,i){if(n=Ln.checkMatrix(n),n.isEmpty())return this;var a=r+n.rows-1,o=i+n.columns-1;h1(this,r,a,i,o);for(var s=0;s<n.rows;s++)for(var c=0;c<n.columns;c++)this.set(r+s,i+c,n.get(s,c));return this}},{key:"selection",value:function(n,r){mS(this,n),gS(this,r);for(var i=new Ln(n.length,r.length),a=0;a<n.length;a++)for(var o=n[a],s=0;s<r.length;s++){var c=r[s];i.set(a,s,this.get(o,c))}return i}},{key:"trace",value:function(){for(var n=Math.min(this.rows,this.columns),r=0,i=0;i<n;i++)r+=this.get(i,i);return r}},{key:"clone",value:function(){for(var n=new Ln(this.rows,this.columns),r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)n.set(r,i,this.get(r,i));return n}},{key:"sum",value:function(n){switch(n){case"row":return yS(this);case"column":return _S(this);case void 0:return ES(this);default:throw new Error("invalid option: ".concat(n))}}},{key:"product",value:function(n){switch(n){case"row":return bS(this);case"column":return wS(this);case void 0:return xS(this);default:throw new Error("invalid option: ".concat(n))}}},{key:"mean",value:function(n){var r=this.sum(n);switch(n){case"row":{for(var i=0;i<this.rows;i++)r[i]/=this.columns;return r}case"column":{for(var a=0;a<this.columns;a++)r[a]/=this.rows;return r}case void 0:return r/this.size;default:throw new Error("invalid option: ".concat(n))}}},{key:"variance",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof n=="object"&&(r=n,n=void 0),typeof r!="object")throw new TypeError("options must be an object");var i=r,a=i.unbiased,o=a===void 0?!0:a,s=i.mean,c=s===void 0?this.mean(n):s;if(typeof o!="boolean")throw new TypeError("unbiased must be a boolean");switch(n){case"row":{if(!qo(c))throw new TypeError("mean must be an array");return SS(this,o,c)}case"column":{if(!qo(c))throw new TypeError("mean must be an array");return TS(this,o,c)}case void 0:{if(typeof c!="number")throw new TypeError("mean must be a number");return AS(this,o,c)}default:throw new Error("invalid option: ".concat(n))}}},{key:"standardDeviation",value:function(n,r){typeof n=="object"&&(r=n,n=void 0);var i=this.variance(n,r);if(n===void 0)return Math.sqrt(i);for(var a=0;a<i.length;a++)i[a]=Math.sqrt(i[a]);return i}},{key:"center",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof n=="object"&&(r=n,n=void 0),typeof r!="object")throw new TypeError("options must be an object");var i=r,a=i.center,o=a===void 0?this.mean(n):a;switch(n){case"row":{if(!qo(o))throw new TypeError("center must be an array");return IS(this,o),this}case"column":{if(!qo(o))throw new TypeError("center must be an array");return CS(this,o),this}case void 0:{if(typeof o!="number")throw new TypeError("center must be a number");return RS(this,o),this}default:throw new Error("invalid option: ".concat(n))}}},{key:"scale",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof n=="object"&&(r=n,n=void 0),typeof r!="object")throw new TypeError("options must be an object");var i=r.scale;switch(n){case"row":{if(i===void 0)i=MS(this);else if(!qo(i))throw new TypeError("scale must be an array");return NS(this,i),this}case"column":{if(i===void 0)i=DS(this);else if(!qo(i))throw new TypeError("scale must be an array");return PS(this,i),this}case void 0:{if(i===void 0)i=OS(this);else if(typeof i!="number")throw new TypeError("scale must be a number");return LS(this,i),this}default:throw new Error("invalid option: ".concat(n))}}},{key:"toString",value:function(n){return d1(this,n)}}],[{key:"from1DArray",value:function(n,r,i){var a=n*r;if(a!==i.length)throw new RangeError("data length does not match given dimensions");for(var o=new Ln(n,r),s=0;s<n;s++)for(var c=0;c<r;c++)o.set(s,c,i[s*r+c]);return o}},{key:"rowVector",value:function(n){for(var r=new Ln(1,n.length),i=0;i<n.length;i++)r.set(0,i,n[i]);return r}},{key:"columnVector",value:function(n){for(var r=new Ln(n.length,1),i=0;i<n.length;i++)r.set(i,0,n[i]);return r}},{key:"zeros",value:function(n,r){return new Ln(n,r)}},{key:"ones",value:function(n,r){return new Ln(n,r).fill(1)}},{key:"rand",value:function(n,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof i!="object")throw new TypeError("options must be an object");for(var a=i.random,o=a===void 0?Math.random:a,s=new Ln(n,r),c=0;c<n;c++)for(var f=0;f<r;f++)s.set(c,f,o());return s}},{key:"randInt",value:function(n,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof i!="object")throw new TypeError("options must be an object");var a=i.min,o=a===void 0?0:a,s=i.max,c=s===void 0?1e3:s,f=i.random,d=f===void 0?Math.random:f;if(!Number.isInteger(o))throw new TypeError("min must be an integer");if(!Number.isInteger(c))throw new TypeError("max must be an integer");if(o>=c)throw new RangeError("min must be smaller than max");for(var h=c-o,v=new Ln(n,r),m=0;m<n;m++)for(var g=0;g<r;g++){var _=o+Math.round(d()*h);v.set(m,g,_)}return v}},{key:"eye",value:function(n,r,i){r===void 0&&(r=n),i===void 0&&(i=1);for(var a=Math.min(n,r),o=this.zeros(n,r),s=0;s<a;s++)o.set(s,s,i);return o}},{key:"diag",value:function(n,r,i){var a=n.length;r===void 0&&(r=a),i===void 0&&(i=r);for(var o=Math.min(a,r,i),s=this.zeros(r,i),c=0;c<o;c++)s.set(c,c,n[c]);return s}},{key:"min",value:function(n,r){n=this.checkMatrix(n),r=this.checkMatrix(r);for(var i=n.rows,a=n.columns,o=new Ln(i,a),s=0;s<i;s++)for(var c=0;c<a;c++)o.set(s,c,Math.min(n.get(s,c),r.get(s,c)));return o}},{key:"max",value:function(n,r){n=this.checkMatrix(n),r=this.checkMatrix(r);for(var i=n.rows,a=n.columns,o=new this(i,a),s=0;s<i;s++)for(var c=0;c<a;c++)o.set(s,c,Math.max(n.get(s,c),r.get(s,c)));return o}},{key:"checkMatrix",value:function(n){return e.isMatrix(n)?n:new Ln(n)}},{key:"isMatrix",value:function(n){return n!=null&&n.klass==="Matrix"}}]),e}();ia.prototype.klass="Matrix",typeof Symbol!="undefined"&&(ia.prototype[Symbol.for("nodejs.util.inspect.custom")]=dS);function v1(e,t){return e-t}function GS(e){return e.every(function(t){return typeof t=="number"})}ia.random=ia.rand,ia.randomInt=ia.randInt,ia.diagonal=ia.diag,ia.prototype.diagonal=ia.prototype.diag,ia.identity=ia.eye,ia.prototype.negate=ia.prototype.neg,ia.prototype.tensorProduct=ia.prototype.kroneckerProduct;var Ln=function(e){(0,u1.Z)(n,e);var t=(0,c1.Z)(n);function n(r,i){var a;if((0,D0.Z)(this,n),a=t.call(this),n.isMatrix(r))return(0,uS.Z)(a,r.clone());if(Number.isInteger(r)&&r>=0)if(a.data=[],Number.isInteger(i)&&i>=0)for(var o=0;o<r;o++)a.data.push(new Float64Array(i));else throw new TypeError("nColumns must be a positive integer");else if(qo(r)){var s=r;if(r=s.length,i=r?s[0].length:0,typeof i!="number")throw new TypeError("Data must be a 2D array with at least one element");a.data=[];for(var c=0;c<r;c++){if(s[c].length!==i)throw new RangeError("Inconsistent array dimensions");if(!GS(s[c]))throw new TypeError("Input data contains non-numeric values");a.data.push(Float64Array.from(s[c]))}}else throw new TypeError("First argument must be a positive number or an array");return a.rows=r,a.columns=i,a}return(0,P0.Z)(n,[{key:"set",value:function(i,a,o){return this.data[i][a]=o,this}},{key:"get",value:function(i,a){return this.data[i][a]}},{key:"removeRow",value:function(i){return su(this,i),this.data.splice(i,1),this.rows-=1,this}},{key:"addRow",value:function(i,a){return a===void 0&&(a=i,i=this.rows),su(this,i,!0),a=Float64Array.from(ph(this,a)),this.data.splice(i,0,a),this.rows+=1,this}},{key:"removeColumn",value:function(i){uu(this,i);for(var a=0;a<this.rows;a++){for(var o=new Float64Array(this.columns-1),s=0;s<i;s++)o[s]=this.data[a][s];for(var c=i+1;c<this.columns;c++)o[c-1]=this.data[a][c];this.data[a]=o}return this.columns-=1,this}},{key:"addColumn",value:function(i,a){typeof a=="undefined"&&(a=i,i=this.columns),uu(this,i,!0),a=mh(this,a);for(var o=0;o<this.rows;o++){for(var s=new Float64Array(this.columns+1),c=0;c<i;c++)s[c]=this.data[o][c];for(s[c++]=a[o];c<this.columns+1;c++)s[c]=this.data[o][c-1];this.data[o]=s}return this.columns+=1,this}}]),n}(ia);pS(ia,Ln);var kS=function(e){(0,u1.Z)(n,e);var t=(0,c1.Z)(n);function n(r){var i;return(0,D0.Z)(this,n),i=t.call(this),i.data=r,i.rows=r.length,i.columns=r[0].length,i}return(0,P0.Z)(n,[{key:"set",value:function(i,a,o){return this.data[i][a]=o,this}},{key:"get",value:function(i,a){return this.data[i][a]}}]),n}(ia);function yh(e,t){var n=0;return Math.abs(e)>Math.abs(t)?(n=t/e,Math.abs(e)*Math.sqrt(1+n*n)):t!==0?(n=e/t,Math.abs(t)*Math.sqrt(1+n*n)):0}var p1=function(){function e(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if((0,D0.Z)(this,e),t=kS.checkMatrix(t),t.isEmpty())throw new Error("Matrix must be non-empty");var r=t.rows,i=t.columns,a=n.computeLeftSingularVectors,o=a===void 0?!0:a,s=n.computeRightSingularVectors,c=s===void 0?!0:s,f=n.autoTranspose,d=f===void 0?!1:f,h=Boolean(o),v=Boolean(c),m=!1,g;if(r<i)if(!d)g=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{g=t.transpose(),r=g.rows,i=g.columns,m=!0;var _=h;h=v,v=_}else g=t.clone();for(var y=Math.min(r,i),E=Math.min(r+1,i),b=new Float64Array(E),A=new Ln(r,y),C=new Ln(i,i),R=new Float64Array(i),z=new Float64Array(r),ee=new Float64Array(E),Q=0;Q<E;Q++)ee[Q]=Q;for(var re=Math.min(r-1,i),de=Math.max(0,Math.min(i-2,r)),Ie=Math.max(re,de),ie=0;ie<Ie;ie++){if(ie<re){b[ie]=0;for(var ke=ie;ke<r;ke++)b[ie]=yh(b[ie],g.get(ke,ie));if(b[ie]!==0){g.get(ie,ie)<0&&(b[ie]=-b[ie]);for(var Ve=ie;Ve<r;Ve++)g.set(Ve,ie,g.get(Ve,ie)/b[ie]);g.set(ie,ie,g.get(ie,ie)+1)}b[ie]=-b[ie]}for(var Rt=ie+1;Rt<i;Rt++){if(ie<re&&b[ie]!==0){for(var dn=0,ln=ie;ln<r;ln++)dn+=g.get(ln,ie)*g.get(ln,Rt);dn=-dn/g.get(ie,ie);for(var pn=ie;pn<r;pn++)g.set(pn,Rt,g.get(pn,Rt)+dn*g.get(pn,ie))}R[Rt]=g.get(ie,Rt)}if(h&&ie<re)for(var lr=ie;lr<r;lr++)A.set(lr,ie,g.get(lr,ie));if(ie<de){R[ie]=0;for(var Si=ie+1;Si<i;Si++)R[ie]=yh(R[ie],R[Si]);if(R[ie]!==0){R[ie+1]<0&&(R[ie]=0-R[ie]);for(var Hr=ie+1;Hr<i;Hr++)R[Hr]/=R[ie];R[ie+1]+=1}if(R[ie]=-R[ie],ie+1<r&&R[ie]!==0){for(var _n=ie+1;_n<r;_n++)z[_n]=0;for(var wn=ie+1;wn<r;wn++)for(var Ot=ie+1;Ot<i;Ot++)z[wn]+=R[Ot]*g.get(wn,Ot);for(var Tn=ie+1;Tn<i;Tn++)for(var hr=-R[Tn]/R[ie+1],zn=ie+1;zn<r;zn++)g.set(zn,Tn,g.get(zn,Tn)+hr*z[zn])}if(v)for(var mn=ie+1;mn<i;mn++)C.set(mn,ie,R[mn])}}var Qt=Math.min(i,r+1);if(re<i&&(b[re]=g.get(re,re)),r<Qt&&(b[Qt-1]=0),de+1<Qt&&(R[de]=g.get(de,Qt-1)),R[Qt-1]=0,h){for(var mr=re;mr<y;mr++){for(var Qr=0;Qr<r;Qr++)A.set(Qr,mr,0);A.set(mr,mr,1)}for(var br=re-1;br>=0;br--)if(b[br]!==0){for(var ro=br+1;ro<y;ro++){for(var fu=0,qc=br;qc<r;qc++)fu+=A.get(qc,br)*A.get(qc,ro);fu=-fu/A.get(br,br);for(var Qc=br;Qc<r;Qc++)A.set(Qc,ro,A.get(Qc,ro)+fu*A.get(Qc,br))}for(var ef=br;ef<r;ef++)A.set(ef,br,-A.get(ef,br));A.set(br,br,1+A.get(br,br));for(var By=0;By<br-1;By++)A.set(By,br,0)}else{for(var zy=0;zy<r;zy++)A.set(zy,br,0);A.set(br,br,1)}}if(v)for(var Ro=i-1;Ro>=0;Ro--){if(Ro<de&&R[Ro]!==0)for(var Kv=Ro+1;Kv<i;Kv++){for(var um=0,cm=Ro+1;cm<i;cm++)um+=C.get(cm,Ro)*C.get(cm,Kv);um=-um/C.get(Ro+1,Ro);for(var Jv=Ro+1;Jv<i;Jv++)C.set(Jv,Kv,C.get(Jv,Kv)+um*C.get(Jv,Ro))}for(var Wy=0;Wy<i;Wy++)C.set(Wy,Ro,0);C.set(Ro,Ro,1)}for(var Hx=Qt-1,Vy=0,Xx=Number.EPSILON;Qt>0;){var xn=void 0,qv=void 0;for(xn=Qt-2;xn>=-1&&xn!==-1;xn--){var yR=Number.MIN_VALUE+Xx*Math.abs(b[xn]+Math.abs(b[xn+1]));if(Math.abs(R[xn])<=yR||Number.isNaN(R[xn])){R[xn]=0;break}}if(xn===Qt-2)qv=4;else{var Qo=void 0;for(Qo=Qt-1;Qo>=xn&&Qo!==xn;Qo--){var _R=(Qo!==Qt?Math.abs(R[Qo]):0)+(Qo!==xn+1?Math.abs(R[Qo-1]):0);if(Math.abs(b[Qo])<=Xx*_R){b[Qo]=0;break}}Qo===xn?qv=3:Qo===Qt-1?qv=1:(qv=2,xn=Qo)}switch(xn++,qv){case 1:{var Zy=R[Qt-2];R[Qt-2]=0;for(var Ds=Qt-2;Ds>=xn;Ds--){var Qv=yh(b[Ds],Zy),jy=b[Ds]/Qv,Hy=Zy/Qv;if(b[Ds]=Qv,Ds!==xn&&(Zy=-Hy*R[Ds-1],R[Ds-1]=jy*R[Ds-1]),v)for(var nl=0;nl<i;nl++)Qv=jy*C.get(nl,Ds)+Hy*C.get(nl,Qt-1),C.set(nl,Qt-1,-Hy*C.get(nl,Ds)+jy*C.get(nl,Qt-1)),C.set(nl,Ds,Qv)}break}case 2:{var Xy=R[xn-1];R[xn-1]=0;for(var lu=xn;lu<Qt;lu++){var ep=yh(b[lu],Xy),$y=b[lu]/ep,Yy=Xy/ep;if(b[lu]=ep,Xy=-Yy*R[lu],R[lu]=$y*R[lu],h)for(var rl=0;rl<r;rl++)ep=$y*A.get(rl,lu)+Yy*A.get(rl,xn-1),A.set(rl,xn-1,-Yy*A.get(rl,lu)+$y*A.get(rl,xn-1)),A.set(rl,lu,ep)}break}case 3:{var tp=Math.max(Math.abs(b[Qt-1]),Math.abs(b[Qt-2]),Math.abs(R[Qt-2]),Math.abs(b[xn]),Math.abs(R[xn])),Oh=b[Qt-1]/tp,$x=b[Qt-2]/tp,fm=R[Qt-2]/tp,Ky=b[xn]/tp,ER=R[xn]/tp,ad=(($x+Oh)*($x-Oh)+fm*fm)/2,lm=Oh*fm*(Oh*fm),np=0;(ad!==0||lm!==0)&&(ad<0?np=0-Math.sqrt(ad*ad+lm):np=Math.sqrt(ad*ad+lm),np=lm/(ad+np));for(var od=(Ky+Oh)*(Ky-Oh)+np,Lh=Ky*ER,Tr=xn;Tr<Qt-1;Tr++){var io=yh(od,Lh);io===0&&(io=Number.MIN_VALUE);var du=od/io,hu=Lh/io;if(Tr!==xn&&(R[Tr-1]=io),od=du*b[Tr]+hu*R[Tr],R[Tr]=du*R[Tr]-hu*b[Tr],Lh=hu*b[Tr+1],b[Tr+1]=du*b[Tr+1],v)for(var il=0;il<i;il++)io=du*C.get(il,Tr)+hu*C.get(il,Tr+1),C.set(il,Tr+1,-hu*C.get(il,Tr)+du*C.get(il,Tr+1)),C.set(il,Tr,io);if(io=yh(od,Lh),io===0&&(io=Number.MIN_VALUE),du=od/io,hu=Lh/io,b[Tr]=io,od=du*R[Tr]+hu*b[Tr+1],b[Tr+1]=-hu*R[Tr]+du*b[Tr+1],Lh=hu*R[Tr+1],R[Tr+1]=du*R[Tr+1],h&&Tr<r-1)for(var al=0;al<r;al++)io=du*A.get(al,Tr)+hu*A.get(al,Tr+1),A.set(al,Tr+1,-hu*A.get(al,Tr)+du*A.get(al,Tr+1)),A.set(al,Tr,io)}R[Qt-2]=od,Vy=Vy+1;break}case 4:{if(b[xn]<=0&&(b[xn]=b[xn]<0?-b[xn]:0,v))for(var dm=0;dm<=Hx;dm++)C.set(dm,xn,-C.get(dm,xn));for(;xn<Hx&&!(b[xn]>=b[xn+1]);){var rp=b[xn];if(b[xn]=b[xn+1],b[xn+1]=rp,v&&xn<i-1)for(var Gh=0;Gh<i;Gh++)rp=C.get(Gh,xn+1),C.set(Gh,xn+1,C.get(Gh,xn)),C.set(Gh,xn,rp);if(h&&xn<r-1)for(var kh=0;kh<r;kh++)rp=A.get(kh,xn+1),A.set(kh,xn+1,A.get(kh,xn)),A.set(kh,xn,rp);xn++}Vy=0,Qt--;break}}}if(m){var bR=C;C=A,A=bR}this.m=r,this.n=i,this.s=b,this.U=A,this.V=C}return(0,P0.Z)(e,[{key:"solve",value:function(n){for(var r=n,i=this.threshold,a=this.s.length,o=Ln.zeros(a,a),s=0;s<a;s++)Math.abs(this.s[s])<=i?o.set(s,s,0):o.set(s,s,1/this.s[s]);for(var c=this.U,f=this.rightSingularVectors,d=f.mmul(o),h=f.rows,v=c.rows,m=Ln.zeros(h,v),g=0;g<h;g++)for(var _=0;_<v;_++){for(var y=0,E=0;E<a;E++)y+=d.get(g,E)*c.get(_,E);m.set(g,_,y)}return m.mmul(r)}},{key:"solveForDiagonal",value:function(n){return this.solve(Ln.diag(n))}},{key:"inverse",value:function(){for(var n=this.V,r=this.threshold,i=n.rows,a=n.columns,o=new Ln(i,this.s.length),s=0;s<i;s++)for(var c=0;c<a;c++)Math.abs(this.s[c])>r&&o.set(s,c,n.get(s,c)/this.s[c]);for(var f=this.U,d=f.rows,h=f.columns,v=new Ln(i,d),m=0;m<i;m++)for(var g=0;g<d;g++){for(var _=0,y=0;y<h;y++)_+=o.get(m,y)*f.get(g,y);v.set(m,g,_)}return v}},{key:"condition",get:function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}},{key:"norm2",get:function(){return this.s[0]}},{key:"rank",get:function(){for(var n=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,r=0,i=this.s,a=0,o=i.length;a<o;a++)i[a]>n&&r++;return r}},{key:"diagonal",get:function(){return Array.from(this.s)}},{key:"threshold",get:function(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}},{key:"leftSingularVectors",get:function(){return this.U}},{key:"rightSingularVectors",get:function(){return this.V}},{key:"diagonalMatrix",get:function(){return Ln.diag(this.s)}}]),e}();class FS{constructor(t){this.distances=t.distances,this.dimension=t.dimension||2,this.linkDistance=t.linkDistance}layout(){const t=this,{dimension:n,distances:r,linkDistance:i}=t;try{const a=Ln.mul(Ln.pow(r,2),-.5),o=a.mean("row"),s=a.mean("column"),c=a.mean();a.add(c).subRowVector(o).subColumnVector(s);const f=new p1(a),d=Ln.sqrt(f.diagonalMatrix).diagonal();return f.leftSingularVectors.toJSON().map(h=>Ln.mul([h],[d]).toJSON()[0].splice(0,n))}catch(a){const o=[];for(let s=0;s<r.length;s++){const c=Math.random()*i,f=Math.random()*i;o.push([c,f])}return o}}}const US=800;class BS{constructor(t){this.disp=[],this.positions=t.positions,this.adjMatrix=t.adjMatrix,this.focusID=t.focusID,this.radii=t.radii,this.iterations=t.iterations||10,this.height=t.height||10,this.width=t.width||10,this.speed=t.speed||100,this.gravity=t.gravity||10,this.nodeSizeFunc=t.nodeSizeFunc,this.k=t.k||5,this.strictRadial=t.strictRadial,this.nodes=t.nodes}layout(){const t=this,n=t.positions,r=[],i=t.iterations,a=t.width/10;t.maxDisplace=a,t.disp=r;for(let o=0;o<i;o++)n.forEach((s,c)=>{r[c]={x:0,y:0}}),t.getRepulsion(),t.updatePositions();return n}getRepulsion(){const t=this,n=t.positions,r=t.nodes,i=t.disp,a=t.k,o=t.radii||[];n.forEach((s,c)=>{i[c]={x:0,y:0},n.forEach((f,d)=>{if(c===d||o[c]!==o[d])return;let h=s[0]-f[0],v=s[1]-f[1],m=Math.sqrt(h*h+v*v);if(m===0){m=1;const g=c>d?1:-1;h=.01*g,v=.01*g}if(m<t.nodeSizeFunc(r[c])/2+t.nodeSizeFunc(r[d])/2){const g=a*a/m;i[c].x+=h/m*g,i[c].y+=v/m*g}})})}updatePositions(){const t=this,n=t.positions,r=t.disp,i=t.speed,a=t.strictRadial,o=t.focusID,s=t.maxDisplace||t.width/10;a&&r.forEach((f,d)=>{const h=n[d][0]-n[o][0],v=n[d][1]-n[o][1],m=Math.sqrt(h*h+v*v);let g=v/m,_=-h/m;const y=Math.sqrt(f.x*f.x+f.y*f.y);let E=Math.acos((g*f.x+_*f.y)/y);E>Math.PI/2&&(E-=Math.PI/2,g*=-1,_*=-1);const b=Math.cos(E)*y;f.x=g*b,f.y=_*b});const c=t.radii;n.forEach((f,d)=>{if(d===o)return;const h=Math.sqrt(r[d].x*r[d].x+r[d].y*r[d].y);if(h>0&&d!==o){const v=Math.min(s*(i/US),h);if(f[0]+=r[d].x/h*v,f[1]+=r[d].y/h*v,a){let m=f[0]-n[o][0],g=f[1]-n[o][1];const _=Math.sqrt(m*m+g*g);m=m/_*c[d],g=g/_*c[d],f[0]=n[o][0]+m,f[1]=n[o][1]+g}}})}}function zS(e){const t=e.length,n=e[0].length,r=[];for(let i=0;i<t;i++){const a=[];for(let o=0;o<n;o++)e[i][o]!==0?a.push(1/(e[i][o]*e[i][o])):a.push(0);r.push(a)}return r}function WS(e,t){let n=-1;return e.forEach((r,i)=>{r.id===t&&(n=i)}),n}function m1(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}class VS extends ar{constructor(t){super();this.maxIteration=1e3,this.focusNode=null,this.unitRadius=null,this.linkDistance=50,this.preventOverlap=!1,this.strictRadial=!0,this.maxPreventOverlapIteration=200,this.sortStrength=10,this.nodes=[],this.edges=[],this.updateCfg(t)}getDefaultCfg(){return{maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,strictRadial:!0,maxPreventOverlapIteration:200,sortBy:void 0,sortStrength:10}}execute(){const t=this,n=t.nodes,r=t.edges||[];if(!n||n.length===0){t.onLayoutEnd&&t.onLayoutEnd();return}!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight),t.center||(t.center=[t.width/2,t.height/2]);const i=t.center;if(n.length===1){n[0].x=i[0],n[0].y=i[1],t.onLayoutEnd&&t.onLayoutEnd();return}const a=t.linkDistance;let o=null;if(x(t.focusNode)){let Ie=!1;for(let ie=0;ie<n.length;ie++)n[ie].id===t.focusNode&&(o=n[ie],t.focusNode=o,Ie=!0,ie=n.length);Ie||(o=null)}else o=t.focusNode;o||(o=n[0],t.focusNode=o);let s=WS(n,o.id);s<0&&(s=0),t.focusIndex=s;const c=Et({nodes:n,edges:r},!1),f=dt(c),d=t.maxToFocus(f,s);t.handleInfinity(f,s,d+1),t.distances=f;const h=f[s],v=t.width||500,m=t.height||500;let g=v-i[0]>i[0]?i[0]:v-i[0],_=m-i[1]>i[1]?i[1]:m-i[1];g===0&&(g=v/2),_===0&&(_=m/2);const y=_>g?g:_,E=Math.max(...h),b=[];h.forEach((Ie,ie)=>{t.unitRadius||(t.unitRadius=y/E),b[ie]=Ie*t.unitRadius}),t.radii=b;const A=t.eIdealDisMatrix();t.eIdealDistances=A;const C=zS(A);t.weights=C;let z=new FS({linkDistance:a,distances:A}).layout();z.forEach(Ie=>{De(Ie[0])&&(Ie[0]=Math.random()*a),De(Ie[1])&&(Ie[1]=Math.random()*a)}),t.positions=z,z.forEach((Ie,ie)=>{n[ie].x=Ie[0]+i[0],n[ie].y=Ie[1]+i[1]}),z.forEach(Ie=>{Ie[0]-=z[s][0],Ie[1]-=z[s][1]}),t.run();const ee=t.preventOverlap,Q=t.nodeSize;let re;const de=t.strictRadial;if(ee){const Ie=t.nodeSpacing;let ie;Z(Ie)?ie=()=>Ie:vt(Ie)?ie=Ie:ie=()=>0,Q?V(Q)?re=Rt=>(Q[0]>Q[1]?Q[0]:Q[1])+ie(Rt):re=Rt=>Q+ie(Rt):re=Rt=>Rt.size?V(Rt.size)?(Rt.size[0]>Rt.size[1]?Rt.size[0]:Rt.size[1])+ie(Rt):be(Rt.size)?(Rt.size.width>Rt.size.height?Rt.size.width:Rt.size.height)+ie(Rt):Rt.size+ie(Rt):10+ie(Rt);const ke={nodes:n,nodeSizeFunc:re,adjMatrix:c,positions:z,radii:b,height:m,width:v,strictRadial:de,focusID:s,iterations:t.maxPreventOverlapIteration||200,k:z.length/4.5};z=new BS(ke).layout()}return z.forEach((Ie,ie)=>{n[ie].x=Ie[0]+i[0],n[ie].y=Ie[1]+i[1]}),t.onLayoutEnd&&t.onLayoutEnd(),{nodes:n,edges:r}}run(){const t=this,n=t.maxIteration,r=t.positions||[],i=t.weights||[],a=t.eIdealDistances||[],o=t.radii||[];for(let s=0;s<=n;s++){const c=s/n;t.oneIteration(c,r,o,a,i)}}oneIteration(t,n,r,i,a){const o=this,s=1-t,c=o.focusIndex;n.forEach((f,d)=>{const h=m1(f,[0,0]),v=h===0?0:1/h;if(d===c)return;let m=0,g=0,_=0;n.forEach((E,b)=>{if(d===b)return;const A=m1(f,E),C=A===0?0:1/A,R=i[b][d];_+=a[d][b],m+=a[d][b]*(E[0]+R*(f[0]-E[0])*C),g+=a[d][b]*(E[1]+R*(f[1]-E[1])*C)});const y=r[d]===0?0:1/r[d];_*=s,_+=t*y*y,m*=s,m+=t*y*f[0]*v,f[0]=m/_,g*=s,g+=t*y*f[1]*v,f[1]=g/_})}eIdealDisMatrix(){const t=this,n=t.nodes;if(!n)return[];const r=t.distances,i=t.linkDistance,a=t.radii||[],o=t.unitRadius||50,s=[];return r&&r.forEach((c,f)=>{const d=[];c.forEach((h,v)=>{if(f===v)d.push(0);else if(a[f]===a[v])if(t.sortBy==="data")d.push(h*(Math.abs(f-v)*t.sortStrength)/(a[f]/o));else if(t.sortBy){let m=n[f][t.sortBy]||0,g=n[v][t.sortBy]||0;x(m)&&(m=m.charCodeAt(0)),x(g)&&(g=g.charCodeAt(0)),d.push(h*(Math.abs(m-g)*t.sortStrength)/(a[f]/o))}else d.push(h*i/(a[f]/o));else{const m=(i+o)/2;d.push(h*m)}}),s.push(d)}),s}handleInfinity(t,n,r){const i=t.length;for(let a=0;a<i;a++)if(t[n][a]===Infinity){t[n][a]=r,t[a][n]=r;for(let o=0;o<i;o++)t[a][o]!==Infinity&&t[n][o]===Infinity&&(t[n][o]=r+t[a][o],t[o][n]=r+t[a][o])}for(let a=0;a<i;a++)if(a!==n){for(let o=0;o<i;o++)if(t[a][o]===Infinity){let s=Math.abs(t[n][a]-t[n][o]);s=s===0?1:s,t[a][o]=s}}}maxToFocus(t,n){let r=0;for(let i=0;i<t[n].length;i++)t[n][i]!==Infinity&&(r=t[n][i]>r?t[n][i]:r);return r}getType(){return"radial"}}class g1 extends ar{constructor(t){super();this.nodeSize=30,this.minNodeSpacing=10,this.nodeSpacing=10,this.preventOverlap=!1,this.equidistant=!1,this.startAngle=3/2*Math.PI,this.clockwise=!0,this.sortBy="degree",this.nodes=[],this.edges=[],this.width=300,this.height=300,this.onLayoutEnd=()=>{},this.updateCfg(t)}getDefaultCfg(){return{nodeSize:30,minNodeSpacing:10,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:3/2*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"}}execute(){var t,n;const r=this,{nodes:i,edges:a}=r,o=i.length;if(o===0){(t=r.onLayoutEnd)===null||t===void 0||t.call(r);return}!r.width&&typeof window!="undefined"&&(r.width=window.innerWidth),!r.height&&typeof window!="undefined"&&(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);const s=r.center;if(o===1){i[0].x=s[0],i[0].y=s[1],(n=r.onLayoutEnd)===null||n===void 0||n.call(r);return}const{nodeSize:c,nodeSpacing:f}=r,d=[];let h,v=0;V(c)?h=Math.max(c[0],c[1]):h=c,V(f)?v=Math.max(f[0],f[1]):Z(f)&&(v=f),i.forEach(A=>{d.push(A);let C=h;V(A.size)?C=Math.max(A.size[0],A.size[1]):Z(A.size)?C=A.size:be(A.size)&&(C=Math.max(A.size.width,A.size.height)),h=Math.max(h,C),vt(f)&&(v=Math.max(f(A),v))}),r.clockwise=r.counterclockwise!==void 0?!r.counterclockwise:r.clockwise;const m={},g={};if(d.forEach((A,C)=>{m[A.id]=A,g[A.id]=C}),(r.sortBy==="degree"||!x(r.sortBy)||d[0][r.sortBy]===void 0)&&(r.sortBy="degree",!Z(i[0].degree))){const A=Ht(i.length,g,a);d.forEach((C,R)=>{C.degree=A[R].all})}d.sort((A,C)=>C[r.sortBy]-A[r.sortBy]),r.maxValueNode=d[0],r.maxLevelDiff=r.maxLevelDiff||r.maxValueNode[r.sortBy]/4;const _=[[]];let y=_[0];d.forEach(A=>{if(y.length>0){const C=Math.abs(y[0][r.sortBy]-A[r.sortBy]);r.maxLevelDiff&&C>=r.maxLevelDiff&&(y=[],_.push(y))}y.push(A)});let E=h+(v||r.minNodeSpacing);if(!r.preventOverlap){const A=_.length>0&&_[0].length>1,R=(Math.min(r.width,r.height)/2-E)/(_.length+(A?1:0));E=Math.min(E,R)}let b=0;if(_.forEach(A=>{let C=r.sweep;C===void 0&&(C=2*Math.PI-2*Math.PI/A.length);const R=A.dTheta=C/Math.max(1,A.length-1);if(A.length>1&&r.preventOverlap){const z=Math.cos(R)-Math.cos(0),ee=Math.sin(R)-Math.sin(0),Q=Math.sqrt(E*E/(z*z+ee*ee));b=Math.max(Q,b)}A.r=b,b+=E}),r.equidistant){let A=0,C=0;for(let R=0;R<_.length;R++){const ee=_[R].r-C;A=Math.max(A,ee)}C=0,_.forEach((R,z)=>{z===0&&(C=R.r),R.r=C,C+=A})}return _.forEach(A=>{const C=A.dTheta,R=A.r;A.forEach((z,ee)=>{const Q=r.startAngle+(r.clockwise?1:-1)*C*ee;z.x=s[0]+R*Math.cos(Q),z.y=s[1]+R*Math.sin(Q)})}),r.onLayoutEnd&&r.onLayoutEnd(),{nodes:i,edges:a}}getType(){return"concentric"}}class y1 extends ar{constructor(t){super();this.center=[0,0],this.linkDistance=50,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(t)}getDefaultCfg(){return{center:[0,0],linkDistance:50}}execute(){const t=this,{nodes:n,edges:r=[]}=t,i=t.center;if(!n||n.length===0){t.onLayoutEnd&&t.onLayoutEnd();return}if(n.length===1){n[0].x=i[0],n[0].y=i[1],t.onLayoutEnd&&t.onLayoutEnd();return}const a=t.linkDistance,o=Et({nodes:n,edges:r},!1),s=dt(o);t.handleInfinity(s);const c=ht(s,a);t.scaledDistances=c;const f=t.runMDS();return t.positions=f,f.forEach((d,h)=>{n[h].x=d[0]+i[0],n[h].y=d[1]+i[1]}),t.onLayoutEnd&&t.onLayoutEnd(),{nodes:n,edges:r}}runMDS(){const t=this,n=2,r=t.scaledDistances,i=Ln.mul(Ln.pow(r,2),-.5),a=i.mean("row"),o=i.mean("column"),s=i.mean();i.add(s).subRowVector(a).subColumnVector(o);const c=new p1(i),f=Ln.sqrt(c.diagonalMatrix).diagonal();return c.leftSingularVectors.toJSON().map(d=>Ln.mul([d],[f]).toJSON()[0].splice(0,n))}handleInfinity(t){let n=-999999;t.forEach(r=>{r.forEach(i=>{i!==Infinity&&n<i&&(n=i)})}),t.forEach((r,i)=>{r.forEach((a,o)=>{a===Infinity&&(t[i][o]=n)})})}getType(){return"mds"}}const ZS=800;class jS extends ar{constructor(t){super();this.maxIteration=1e3,this.workerEnabled=!1,this.gravity=10,this.speed=5,this.clustering=!1,this.clusterGravity=10,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.onLayoutEnd=()=>{},this.tick=()=>{},this.animate=!0,this.updateCfg(t)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10,animate:!0}}execute(){var t,n;const r=this,i=r.nodes;if(r.timeInterval!==void 0&&typeof window!="undefined"&&window.clearInterval(r.timeInterval),!i||i.length===0){(t=r.onLayoutEnd)===null||t===void 0||t.call(r);return}!r.width&&typeof window!="undefined"&&(r.width=window.innerWidth),!r.height&&typeof window!="undefined"&&(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);const a=r.center;if(i.length===1){i[0].x=a[0],i[0].y=a[1],(n=r.onLayoutEnd)===null||n===void 0||n.call(r);return}const o={},s={};return i.forEach((c,f)=>{Z(c.x)||(c.x=Math.random()*this.width),Z(c.y)||(c.y=Math.random()*this.height),o[c.id]=c,s[c.id]=f}),r.nodeMap=o,r.nodeIdxMap=s,r.run()}run(){var t;const n=this,r=n.nodes;if(!r)return;const{edges:i,maxIteration:a,workerEnabled:o,clustering:s,animate:c}=n,f={};if(s&&r.forEach(d=>{f[d.cluster]===void 0&&(f[d.cluster]={name:d.cluster,cx:0,cy:0,count:0})}),o||!c){for(let d=0;d<a;d++)n.runOneStep(f);(t=n.onLayoutEnd)===null||t===void 0||t.call(n)}else{if(typeof window=="undefined")return;let d=0;this.timeInterval=window.setInterval(()=>{var h;n.runOneStep(f),d++,d>=a&&((h=n.onLayoutEnd)===null||h===void 0||h.call(n),window.clearInterval(n.timeInterval))},0)}return{nodes:r,edges:i}}runOneStep(t){var n;const r=this,i=r.nodes;if(!i)return;const{edges:a,center:o,gravity:s,speed:c,clustering:f}=r,d=r.height*r.width,h=Math.sqrt(d)/10,v=d/(i.length+1),m=Math.sqrt(v),g=[];if(i.forEach((_,y)=>{g[y]={x:0,y:0}}),r.applyCalculate(i,a,g,m,v),f){for(const y in t)t[y].cx=0,t[y].cy=0,t[y].count=0;i.forEach(y=>{const E=t[y.cluster];Z(y.x)&&(E.cx+=y.x),Z(y.y)&&(E.cy+=y.y),E.count++});for(const y in t)t[y].cx/=t[y].count,t[y].cy/=t[y].count;const _=r.clusterGravity||s;i.forEach((y,E)=>{if(!Z(y.x)||!Z(y.y))return;const b=t[y.cluster],A=Math.sqrt((y.x-b.cx)*(y.x-b.cx)+(y.y-b.cy)*(y.y-b.cy)),C=m*_;g[E].x-=C*(y.x-b.cx)/A,g[E].y-=C*(y.y-b.cy)/A})}i.forEach((_,y)=>{if(!Z(_.x)||!Z(_.y))return;const E=.01*m*s;g[y].x-=E*(_.x-o[0]),g[y].y-=E*(_.y-o[1])}),i.forEach((_,y)=>{if(Z(_.fx)&&Z(_.fy)){_.x=_.fx,_.y=_.fy;return}if(!Z(_.x)||!Z(_.y))return;const E=Math.sqrt(g[y].x*g[y].x+g[y].y*g[y].y);if(E>0){const b=Math.min(h*(c/ZS),E);_.x+=g[y].x/E*b,_.y+=g[y].y/E*b}}),(n=r.tick)===null||n===void 0||n.call(r)}applyCalculate(t,n,r,i,a){const o=this;o.calRepulsive(t,r,a),n&&o.calAttractive(n,r,i)}calRepulsive(t,n,r){t.forEach((i,a)=>{n[a]={x:0,y:0},t.forEach((o,s)=>{if(a===s||!Z(i.x)||!Z(o.x)||!Z(i.y)||!Z(o.y))return;let c=i.x-o.x,f=i.y-o.y,d=c*c+f*f;if(d===0){d=1;const v=a>s?1:-1;c=.01*v,f=.01*v}const h=r/d;n[a].x+=c*h,n[a].y+=f*h})})}calAttractive(t,n,r){t.forEach(i=>{const a=We(i,"source"),o=We(i,"target");if(!a||!o)return;const s=this.nodeIdxMap[a],c=this.nodeIdxMap[o];if(s===c)return;const f=this.nodeMap[a],d=this.nodeMap[o];if(!Z(d.x)||!Z(f.x)||!Z(d.y)||!Z(f.y))return;const h=d.x-f.x,v=d.y-f.y,m=Math.sqrt(h*h+v*v),g=m*m/r;n[c].x-=h/m*g,n[c].y-=v/m*g,n[s].x+=h/m*g,n[s].y+=v/m*g})}stop(){this.timeInterval&&typeof window!="undefined"&&window.clearInterval(this.timeInterval)}destroy(){const t=this;t.stop(),t.tick=null,t.nodes=null,t.edges=null,t.destroyed=!0}getType(){return"fruchterman"}}function an(e,t,n,r){!n||Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}var qt=S(6610),vn=S(5991);function on(e,t,n,r,i){var a={};return Object.keys(r).forEach(function(o){a[o]=r[o]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(o,s){return s(e,t,o)||o},a),i&&a.initializer!==void 0&&(a.value=a.initializer?a.initializer.call(i):void 0,a.initializer=void 0),a.initializer===void 0&&(Object.defineProperty(e,t,a),a=null),a}var wR=S(28660),HS=S(87757),Xt=S.n(HS),Er=S(92137),XS=-1,$S=1;function Qu(){return $S++}var Xl=function e(t){(0,qt.Z)(this,e)},$l=function(){function e(t){(0,qt.Z)(this,e),this.clazz=void 0,this.components=[],this.entities=[],this.lookup={},this.clazz=t}return(0,vn.Z)(e,[{key:"clear",value:function(){this.components=[],this.entities=[],this.lookup={}}},{key:"contains",value:function(n){return this.lookup[n]>-1}},{key:"create",value:function(n,r){this.lookup[n]=this.components.length;var i=new this.clazz(r||{});return this.components.push(i),this.entities.push(n),i}},{key:"remove",value:function(n){var r=this.lookup[n];r>-1&&r<this.components.length-1&&(this.components[r]=this.components[this.components.length-1],this.entities[r]=this.entities[this.entities.length-1],this.lookup[this.entities[r]]=r),this.components.pop(),this.entities.pop(),delete this.lookup[n]}},{key:"removeKeepSorted",value:function(n){var r=this.lookup[n];if(r>-1){var i=this.entities[r];if(r<this.components.length-1){for(var a=r+1;a<this.components.length;++a)this.components[a-1]=this.components[a];for(var o=r+1;o<this.entities.length;++o)this.entities[o-1]=this.entities[o],this.lookup[this.entities[o-1]]=o-1}this.components.pop(),this.entities.pop(),delete this.lookup[i]}}},{key:"moveItem",value:function(n,r){if(n!==r){for(var i=this.components[n],a=this.entities[n],o=n<r?1:-1,s=n;s!==r;s+=o){var c=s+o;this.components[s]=this.components[c],this.entities[s]=this.entities[c],this.lookup[this.entities[s]]=s}this.components[r]=i,this.entities[r]=a,this.lookup[a]=r}}},{key:"getEntity",value:function(n){return this.entities[n]}},{key:"getComponent",value:function(n){return this.components[n]}},{key:"getComponentByEntity",value:function(n){var r=this.lookup[n];return r>-1?this.components[r]:null}},{key:"getCount",value:function(){return this.components.length}},{key:"getEntityByComponentIndex",value:function(n){for(var r=0,i=Object.keys(this.lookup);r<i.length;r++){var a=i[r],o=Number(a);if(this.lookup[o]===n)return o}return XS}},{key:"find",value:function(n){for(var r=0;r<this.getCount();r++){var i=this.getComponent(r);if(n(i,r))return i}return null}},{key:"findIndex",value:function(n){for(var r=0;r<this.getCount();r++){var i=this.getComponent(r);if(n(i,r))return r}return-1}},{key:"forEach",value:function(n){for(var r=0,i=Object.keys(this.lookup);r<i.length;r++){var a=i[r],o=Number(a),s=this.lookup[o];n(o,this.getComponent(s))}}},{key:"forEachAsync",value:function(){var t=(0,Er.Z)(Xt().mark(function r(i){var a,o,s,c,f;return Xt().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:a=0,o=Object.keys(this.lookup);case 1:if(!(a<o.length)){h.next=10;break}return s=o[a],c=Number(s),f=this.lookup[c],h.next=7,i(c,this.getComponent(f));case 7:a++,h.next=1;break;case 10:case"end":return h.stop()}},r,this)}));function n(r){return t.apply(this,arguments)}return n}()},{key:"map",value:function(n){for(var r=[],i=0,a=Object.keys(this.lookup);i<a.length;i++){var o=a[i],s=Number(o),c=this.lookup[s];r.push(n(s,this.getComponent(c)))}return r}}]),e}(),k0=S(28481),yt=S(86700),Qe={HierarchyComponentManager:Symbol("HierarchyComponentManager"),TransformComponentManager:Symbol("TransformComponentManager"),NameComponentManager:Symbol("NameComponentManager"),SceneGraphSystem:Symbol("SceneGraphSystem"),FrameGraphSystem:Symbol("FrameGraphSystem"),ResourcePool:Symbol("ResourcePool"),ResourceHandleComponentManager:Symbol("ResourceHandleComponentManager"),PassNodeComponentManager:Symbol("PassNodeComponentManager"),RendererSystem:Symbol("RendererSystem"),RenderPass:Symbol("RenderPass"),RenderPassFactory:Symbol("Factory<IRenderPass>"),Renderable:Symbol("Factory<IRenderPass>"),MeshSystem:Symbol("MeshSystem"),MeshComponentManager:Symbol("MeshComponentManager"),CullableComponentManager:Symbol("CullableComponentManager"),Geometry:Symbol("Geometry"),GeometrySystem:Symbol("GeometrySystem"),GeometryComponentManager:Symbol("GeometryComponentManager"),Material:Symbol("Material"),MaterialSystem:Symbol("MaterialSystem"),MaterialComponentManager:Symbol("MaterialComponentManager"),ForwardRenderPath:Symbol("ForwardRenderPath"),ComputeSystem:Symbol("ComputeSystem"),ComputeComponentManager:Symbol("ComputeComponentManager"),ComputeStrategy:Symbol("ComputeStrategy"),Systems:Symbol("Systems"),World:Symbol("World"),RenderEngine:Symbol("RenderEngine"),WebGPUEngine:Symbol("WebGPUEngine"),WebGLEngine:Symbol("WebGLEngine"),ShaderModuleService:Symbol("ShaderModuleService"),ConfigService:Symbol("ConfigService"),InteractorService:Symbol("InteractorService"),IEventEmitter:Symbol("IEventEmitter"),Light:Symbol("Light")},YS=function e(){(0,qt.Z)(this,e),this.index=void 0},KS=function e(){(0,qt.Z)(this,e),this.name=void 0,this.data=void 0,this.execute=void 0,this.tearDown=void 0},JS=function(){function e(){(0,qt.Z)(this,e),this.name=void 0,this.refCount=0,this.hasSideEffect=!1,this.devirtualize=[],this.destroy=[],this.reads=[],this.writes=[]}return(0,vn.Z)(e,[{key:"read",value:function(n){return this.reads.find(function(r){return r.index===n.index})||this.reads.push(n),n}},{key:"sample",value:function(n){return this.read(n),n}},{key:"write",value:function(n,r){var i=this.writes.find(function(c){return c.index===r.index});if(i)return r;var a=n.getResourceNode(r);a.resource.version++,a.resource.imported&&(this.hasSideEffect=!0);var o=n.createResourceNode(a.resource),s=n.getResourceNode(o);return s.writer=this,this.writes.push(o),o}}]),e}(),Ga=S(10379),ka=S(46070),Cr=S(77608),qS=function e(){(0,qt.Z)(this,e),this.first=void 0,this.last=void 0};function QS(e){var t=e2();return function(){var r=(0,Cr.Z)(e),i;if(t){var a=(0,Cr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ka.Z)(this,i)}}function e2(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var _1=function(e){(0,Ga.Z)(n,e);var t=QS(n);function n(){var r;(0,qt.Z)(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return r=t.call.apply(t,[this].concat(a)),r.version=0,r.refs=0,r.name=void 0,r.imported=void 0,r.priority=void 0,r.discardStart=!0,r.discardEnd=!1,r.descriptor=void 0,r.resource=void 0,r}return(0,vn.Z)(n,[{key:"preExecuteDestroy",value:function(){this.discardEnd=!0}},{key:"postExecuteDestroy",value:function(){!this.imported}},{key:"postExecuteDevirtualize",value:function(){this.discardStart=!1}},{key:"preExecuteDevirtualize",value:function(){!this.imported}}]),n}(qS),t2=function e(){(0,qt.Z)(this,e),this.resource=void 0,this.writer=void 0,this.readerCount=0,this.version=void 0},E1,b1,w1,hy,x1,S1;function Rs(e,t){var n;if(typeof Symbol=="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(n=n2(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(f){throw f},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){n=e[Symbol.iterator]()},n:function(){var f=n.next();return a=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!a&&n.return!=null&&n.return()}finally{if(o)throw s}}}}function n2(e,t){if(!!e){if(typeof e=="string")return T1(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T1(e,t)}}function T1(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var r2=(E1=(0,yt.b2)(),b1=(0,yt.f3)(Qe.RenderEngine),E1(w1=(hy=(S1=function(){function e(){(0,qt.Z)(this,e),this.passNodes=[],this.resourceNodes=[],this.frameGraphPasses=[],an(this,"engine",x1,this)}return(0,vn.Z)(e,[{key:"execute",value:function(){var t=(0,Er.Z)(Xt().mark(function r(i){return Xt().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.compile(),o.next=3,this.executePassNodes(i);case 3:case"end":return o.stop()}},r,this)}));function n(r){return t.apply(this,arguments)}return n}()},{key:"tearDown",value:function(){this.frameGraphPasses.forEach(function(n){n.tearDown&&n.tearDown()}),this.reset()}},{key:"addPass",value:function(n,r,i,a){var o=new KS;o.execute=i,a&&(o.tearDown=a),o.name=n;var s=new JS;return s.name=n,this.passNodes.push(s),this.frameGraphPasses.push(o),r(this,s,o),o}},{key:"getPass",value:function(n){return this.frameGraphPasses.find(function(r){return r.name===n})}},{key:"compile",value:function(){var n=this,r=Rs(this.passNodes),i;try{for(r.s();!(i=r.n()).done;){var a=i.value;a.refCount=a.writes.length+(a.hasSideEffect?1:0),a.reads.forEach(function(pn){n.resourceNodes[pn.index].readerCount++})}}catch(pn){r.e(pn)}finally{r.f()}var o=[],s=Rs(this.resourceNodes),c;try{for(s.s();!(c=s.n()).done;){var f=c.value;f.readerCount===0&&o.push(f)}}catch(pn){s.e(pn)}finally{s.f()}for(;o.length;){var d=o.pop(),h=d&&d.writer;if(h&&--h.refCount==0){var v=Rs(h.reads),m;try{for(v.s();!(m=v.n()).done;){var g=m.value,_=this.resourceNodes[g.index];--_.readerCount==0&&o.push(_)}}catch(pn){v.e(pn)}finally{v.f()}}}this.resourceNodes.forEach(function(pn){pn.resource.refs+=pn.readerCount});var y=Rs(this.passNodes),E;try{for(y.s();!(E=y.n()).done;){var b=E.value;if(!!b.refCount){var A=Rs(b.reads),C;try{for(A.s();!(C=A.n()).done;){var R=C.value,z=this.resourceNodes[R.index].resource;z.first=z.first?z.first:b,z.last=b}}catch(pn){A.e(pn)}finally{A.f()}var ee=Rs(b.writes),Q;try{for(ee.s();!(Q=ee.n()).done;){var re=Q.value,de=this.resourceNodes[re.index].resource;de.first=de.first?de.first:b,de.last=b}}catch(pn){ee.e(pn)}finally{ee.f()}}}}catch(pn){y.e(pn)}finally{y.f()}for(var Ie=0;Ie<2;Ie++){var ie=Rs(this.resourceNodes),ke;try{for(ie.s();!(ke=ie.n()).done;){var Ve=ke.value,Rt=Ve.resource;if(Rt.priority===Ie&&Rt.refs){var dn=Rt.first,ln=Rt.last;dn&&ln&&(dn.devirtualize.push(Rt),ln.destroy.push(Rt))}}}catch(pn){ie.e(pn)}finally{ie.f()}}}},{key:"executePassNodes",value:function(){var t=(0,Er.Z)(Xt().mark(function r(i){var a,o,s,c,f,d,h,v,m,g,_,y,E,b,A,C,R;return Xt().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:a=Rs(this.passNodes.entries()),ee.prev=1,a.s();case 3:if((o=a.n()).done){ee.next=18;break}if(s=(0,k0.Z)(o.value,2),c=s[0],f=s[1],!f.refCount){ee.next=16;break}d=Rs(f.devirtualize);try{for(d.s();!(h=d.n()).done;)v=h.value,v.preExecuteDevirtualize(this.engine)}catch(Q){d.e(Q)}finally{d.f()}m=Rs(f.destroy);try{for(m.s();!(g=m.n()).done;)_=g.value,_.preExecuteDestroy(this.engine)}catch(Q){m.e(Q)}finally{m.f()}return ee.next=12,this.frameGraphPasses[c].execute(this,this.frameGraphPasses[c],i);case 12:y=Rs(f.devirtualize);try{for(y.s();!(E=y.n()).done;)b=E.value,b.postExecuteDevirtualize(this.engine)}catch(Q){y.e(Q)}finally{y.f()}A=Rs(f.destroy);try{for(A.s();!(C=A.n()).done;)R=C.value,R.postExecuteDestroy(this.engine)}catch(Q){A.e(Q)}finally{A.f()}case 16:ee.next=3;break;case 18:ee.next=23;break;case 20:ee.prev=20,ee.t0=ee.catch(1),a.e(ee.t0);case 23:return ee.prev=23,a.f(),ee.finish(23);case 26:this.reset();case 27:case"end":return ee.stop()}},r,this,[[1,20,23,26]])}));function n(r){return t.apply(this,arguments)}return n}()},{key:"reset",value:function(){this.passNodes=[],this.resourceNodes=[],this.frameGraphPasses=[]}},{key:"getResourceNode",value:function(n){return this.resourceNodes[n.index]}},{key:"createResourceNode",value:function(n){var r=new t2;r.resource=n,r.version=n.version,this.resourceNodes.push(r);var i=new YS;return i.index=this.resourceNodes.length-1,i}},{key:"createTexture",value:function(n,r,i){var a=new _1;return a.name=r,a.descriptor=i,this.createResourceNode(a)}},{key:"createRenderTarget",value:function(n,r,i){var a=new _1;return a.name=r,a.descriptor=i,this.createResourceNode(a)}},{key:"present",value:function(n){this.addPass("Present",function(r,i){i.read(n),i.hasSideEffect=!0},(0,Er.Z)(Xt().mark(function r(){return Xt().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:case"end":return a.stop()}},r)})))}}]),e}(),S1),x1=on(hy.prototype,"engine",[b1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hy))||w1),ze=S(96156),Li=S(63349),pa=S(49685);function Cv(){var e=new pa.WT(4);return pa.WT!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function i2(e){var t=new pa.WT(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function A1(e,t,n,r){var i=new pa.WT(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}function a2(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function o2(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e}function s2(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}function xR(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function SR(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}function TR(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e}function AR(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function IR(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function CR(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e}function RR(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e}function MR(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function u2(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function NR(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e}function DR(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return Math.hypot(n,r,i,a)}function PR(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return n*n+r*r+i*i+a*a}function c2(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.hypot(t,n,r,i)}function f2(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i}function OR(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function LR(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function l2(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n*n+r*r+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),e[0]=n*o,e[1]=r*o,e[2]=i*o,e[3]=a*o,e}function d2(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function GR(e,t,n,r){var i=n[0]*r[1]-n[1]*r[0],a=n[0]*r[2]-n[2]*r[0],o=n[0]*r[3]-n[3]*r[0],s=n[1]*r[2]-n[2]*r[1],c=n[1]*r[3]-n[3]*r[1],f=n[2]*r[3]-n[3]*r[2],d=t[0],h=t[1],v=t[2],m=t[3];return e[0]=h*f-v*c+m*s,e[1]=-(d*f)+v*o-m*a,e[2]=d*c-h*o+m*i,e[3]=-(d*s)+h*a-v*i,e}function h2(e,t,n,r){var i=t[0],a=t[1],o=t[2],s=t[3];return e[0]=i+r*(n[0]-i),e[1]=a+r*(n[1]-a),e[2]=o+r*(n[2]-o),e[3]=s+r*(n[3]-s),e}function kR(e,t){t=t||1;var n,r,i,a,o,s;do n=glMatrix.RANDOM()*2-1,r=glMatrix.RANDOM()*2-1,o=n*n+r*r;while(o>=1);do i=glMatrix.RANDOM()*2-1,a=glMatrix.RANDOM()*2-1,s=i*i+a*a;while(s>=1);var c=Math.sqrt((1-o)/s);return e[0]=t*n,e[1]=t*r,e[2]=t*i*c,e[3]=t*a*c,e}function Rv(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*o,e[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*o,e[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*o,e[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*o,e}function FR(e,t,n){var r=t[0],i=t[1],a=t[2],o=n[0],s=n[1],c=n[2],f=n[3],d=f*r+s*a-c*i,h=f*i+c*r-o*a,v=f*a+o*i-s*r,m=-o*r-s*i-c*a;return e[0]=d*f+m*-o+h*-c-v*-s,e[1]=h*f+m*-s+v*-o-d*-c,e[2]=v*f+m*-c+d*-s-h*-o,e[3]=t[3],e}function UR(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function BR(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function v2(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function p2(e,t){var n=e[0],r=e[1],i=e[2],a=e[3],o=t[0],s=t[1],c=t[2],f=t[3];return Math.abs(n-o)<=pa.Ib*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-s)<=pa.Ib*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-c)<=pa.Ib*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(a-f)<=pa.Ib*Math.max(1,Math.abs(a),Math.abs(f))}var zR=null,WR=null,VR=null,ZR=null,jR=null,HR=null,XR=null,$R=function(){var e=Cv();return function(t,n,r,i,a,o){var s,c;for(n||(n=4),r||(r=0),i?c=Math.min(i*n+r,t.length):c=t.length,s=r;s<c;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],a(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}(),Yl=S(35600),Ce=S(77160),_h=S(90484),m2=9007199254740991,g2="[object Arguments]",y2="[object Array]",_2="[object Boolean]",E2="[object Date]",b2="[object Error]",w2="[object Function]",x2="[object Map]",S2="[object Number]",T2="[object Object]",A2="[object RegExp]",I2="[object Set]",C2="[object String]",R2="[object WeakMap]",M2="[object ArrayBuffer]",N2="[object DataView]",D2="[object Float32Array]",P2="[object Float64Array]",O2="[object Int8Array]",L2="[object Int16Array]",G2="[object Int32Array]",k2="[object Uint8Array]",F2="[object Uint8ClampedArray]",U2="[object Uint16Array]",B2="[object Uint32Array]",mi={};mi[D2]=mi[P2]=mi[O2]=mi[L2]=mi[G2]=mi[k2]=mi[F2]=mi[U2]=mi[B2]=!0,mi[g2]=mi[y2]=mi[M2]=mi[_2]=mi[N2]=mi[E2]=mi[b2]=mi[w2]=mi[x2]=mi[S2]=mi[T2]=mi[A2]=mi[I2]=mi[C2]=mi[R2]=!1;function YR(e){return function(t){return e(t)}}var z2=Object.prototype,W2=z2.toString;function V2(e){return j2(e)&&Z2(e.length)&&!!mi[W2.call(e)]}function Z2(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=m2}function j2(e){return!!e&&(0,_h.Z)(e)==="object"}var I1=V2;function C1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function R1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?C1(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C1(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function H2(e){var t=X2();return function(){var r=(0,Cr.Z)(e),i;if(t){var a=(0,Cr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ka.Z)(this,i)}}function X2(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var $2=function(e){(0,Ga.Z)(n,e);var t=H2(n);function n(r){var i;return(0,qt.Z)(this,n),i=t.call(this,r),i.dirty=!0,i.attributes=[],i.indices=void 0,i.indicesBuffer=void 0,i.vertexCount=0,i.maxInstancedCount=void 0,i.aabb=void 0,i.entity=void 0,Object.assign((0,Li.Z)(i),r),i}return(0,vn.Z)(n,[{key:"setAttribute",value:function(i,a,o,s){var c=this.attributes.find(function(f){return f.name===i});return c?(c.data=a,c.dirty=!0):this.attributes.push(R1(R1({dirty:!0,name:i,data:a},o),{},{bufferGetter:s})),this.dirty=!0,this}},{key:"setIndex",value:function(i){return this.indices=new Uint32Array(i.buffer?i.buffer:i),this.dirty=!0,this}},{key:"applyMatrix",value:function(i){var a=this.attributes.find(function(v){var m=v.name;return m==="position"}),o=this.attributes.find(function(v){var m=v.name;return m==="normal"});if(a&&(a.dirty=!0,a.data&&a.data.length))for(var s=0;s<a.data.length;s+=3){var c=A1(a.data[s],a.data[s+1],a.data[s+2],1);Rv(c,c,i),I1(a.data)?a.data.set([c[0],c[1],c[2]],s):(a.data[s]=c[0],a.data[s+1]=c[1],a.data[s+2]=c[2])}if(o){var f=Yl.XL(Yl.Ue(),i);if(o.data&&o.data.length)for(var d=0;d<o.data.length;d+=3){var h=Ce.al(o.data[d],o.data[d+1],o.data[d+2]);Ce.kK(h,h,f),Ce.Fv(h,h),I1(o.data)?o.data.set([h[0],h[1],h[2]],d):(o.data[d]=h[0],o.data[d+1]=h[1],o.data[d+2]=h[2])}}}}]),n}(Xl),ve;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.COPY_SRC=1]="COPY_SRC",e[e.COPY_DST=2]="COPY_DST",e[e.SAMPLED=4]="SAMPLED",e[e.STORAGE=8]="STORAGE",e[e.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(ve||(ve={}));var M1,N1,D1,P1,F0,O1,L1,G1,Y2=(M1=(0,yt.b2)(),N1=(0,yt.f3)(Qe.GeometryComponentManager),D1=(0,yt.f3)(Qe.RenderEngine),M1(P1=(F0=(G1=function(){function e(){(0,qt.Z)(this,e),an(this,"geometry",O1,this),an(this,"engine",L1,this)}return(0,vn.Z)(e,[{key:"execute",value:function(){var t=(0,Er.Z)(Xt().mark(function r(){var i=this;return Xt().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:this.geometry.forEach(function(s,c){c.dirty&&(c.attributes.forEach(function(f){if(f.dirty&&f.data){if(!f.buffer)f.buffer=i.engine.createBuffer({data:f.data,type:ve.FLOAT});else{var d;(d=f.buffer)===null||d===void 0||d.subData({data:f.data,offset:0})}f.dirty=!1}}),c.indices&&(c.indicesBuffer?c.indicesBuffer.subData({data:c.indices,offset:0}):c.indicesBuffer=i.engine.createElements({data:c.indices,count:c.indices.length,type:ve.UNSIGNED_INT,usage:ve.STATIC_DRAW})),c.dirty=!1)});case 1:case"end":return o.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"tearDown",value:function(){this.geometry.forEach(function(n,r){r.indicesBuffer&&r.indicesBuffer.destroy(),r.attributes.forEach(function(i){i.buffer&&i.buffer.destroy()})}),this.geometry.clear()}},{key:"createBufferGeometry",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{vertexCount:3},r=n.vertexCount,i=Qu();return this.geometry.create(i,{vertexCount:r})}},{key:"createInstancedBufferGeometry",value:function(n){var r=n.maxInstancedCount,i=n.vertexCount,a=Qu();return this.geometry.create(a,{maxInstancedCount:r,vertexCount:i})}}]),e}(),G1),O1=on(F0.prototype,"geometry",[N1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L1=on(F0.prototype,"engine",[D1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F0))||P1);function k1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function F1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?k1(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k1(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function K2(e){var t=J2();return function(){var r=(0,Cr.Z)(e),i;if(t){var a=(0,Cr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ka.Z)(this,i)}}function J2(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var q2=function(e){(0,Ga.Z)(n,e);var t=K2(n);function n(r){var i;return(0,qt.Z)(this,n),i=t.call(this,r),i.vertexShaderGLSL=void 0,i.fragmentShaderGLSL=void 0,i.defines={},i.dirty=!0,i.uniforms=[],i.cull={enable:!0,face:ve.BACK},i.depth={enable:!0},i.blend=void 0,i.entity=void 0,i.type=void 0,Object.assign((0,Li.Z)(i),r),i}return(0,vn.Z)(n,[{key:"setDefines",value:function(i){return this.defines=F1(F1({},this.defines),i),this}},{key:"setCull",value:function(i){return this.cull=i,this}},{key:"setDepth",value:function(i){return this.depth=i,this}},{key:"setBlend",value:function(i){return this.blend=i,this}},{key:"setUniform",value:function(i,a){var o=this;if(typeof i!="string")return Object.keys(i).forEach(function(c){return o.setUniform(c,i[c])}),this;var s=this.uniforms.find(function(c){return c.name===i});return s?(s.dirty=!0,s.data=a):this.uniforms.push({name:i,dirty:!0,data:a}),this.dirty=!0,this}}]),n}(Xl),U1,B1,z1,W1,V1,Mv,Z1,j1,H1,X1;function $1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Y1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$1(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$1(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Q2=(U1=(0,yt.b2)(),B1=(0,yt.f3)(Qe.MaterialComponentManager),z1=(0,yt.f3)(Qe.RenderEngine),W1=(0,yt.f3)(Qe.ShaderModuleService),U1(V1=(Mv=(X1=function(){function e(){(0,qt.Z)(this,e),an(this,"material",Z1,this),an(this,"engine",j1,this),an(this,"shaderModule",H1,this)}return(0,vn.Z)(e,[{key:"execute",value:function(){var t=(0,Er.Z)(Xt().mark(function r(){return Xt().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:case"end":return a.stop()}},r)}));function n(){return t.apply(this,arguments)}return n}()},{key:"tearDown",value:function(){this.material.clear()}},{key:"createShaderMaterial",value:function(n){var r=Qu(),i=n.vertexShader,a=n.fragmentShader,o=[];if(!this.engine.supportWebGPU){var s="material-".concat(r);this.shaderModule.registerModule(s,{vs:n.vertexShader,fs:n.fragmentShader});var c=this.shaderModule.getModule(s);i=c.vs,a=c.fs,c.uniforms&&(o=Object.keys(c.uniforms).map(function(f){return{dirty:!0,name:f,data:c.uniforms[f]}}))}return this.material.create(r,Y1(Y1({vertexShaderGLSL:i,fragmentShaderGLSL:a},n),{},{uniforms:o}))}}]),e}(),X1),Z1=on(Mv.prototype,"material",[B1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j1=on(Mv.prototype,"engine",[z1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H1=on(Mv.prototype,"shaderModule",[W1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mv))||V1);function eT(e){var t=tT();return function(){var r=(0,Cr.Z)(e),i;if(t){var a=(0,Cr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ka.Z)(this,i)}}function tT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var vy;(function(e){e[e.Standard=0]="Standard"})(vy||(vy={}));var nT=function(e){(0,Ga.Z)(n,e);var t=eT(n);function n(r){var i;return(0,qt.Z)(this,n),i=t.call(this,r),i.strategy=vy.Standard,i.visibilityPlaneMask=0,i.visible=!1,Object.assign((0,Li.Z)(i),r),i}return n}(Xl),py=function(){function e(t,n){(0,qt.Z)(this,e),this.center=void 0,this.halfExtents=void 0,this.min=Ce.Ue(),this.max=Ce.Ue(),this.update(t,n)}return(0,vn.Z)(e,[{key:"update",value:function(n,r){this.center=n||Ce.Ue(),this.halfExtents=r||Ce.al(.5,.5,.5),this.min=Ce.lu(this.min,this.center,this.halfExtents),this.max=Ce.IH(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(n,r){Ce.IH(this.center,r,n),Ce.bA(this.center,this.center,.5),Ce.lu(this.halfExtents,r,n),Ce.bA(this.halfExtents,this.halfExtents,.5),Ce.JG(this.min,n),Ce.JG(this.max,r)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(n){var r=this.center,i=r[0],a=r[1],o=r[2],s=this.halfExtents,c=s[0],f=s[1],d=s[2],h=i-c,v=i+c,m=a-f,g=a+f,_=o-d,y=o+d,E=n.center,b=E[0],A=E[1],C=E[2],R=n.halfExtents,z=R[0],ee=R[1],Q=R[2],re=b-z,de=b+z,Ie=A-ee,ie=A+ee,ke=C-Q,Ve=C+Q;re<h&&(h=re),de>v&&(v=de),Ie<m&&(m=Ie),ie>g&&(g=ie),ke<_&&(_=ke),Ve>y&&(y=Ve),r[0]=(h+v)*.5,r[1]=(m+g)*.5,r[2]=(_+y)*.5,s[0]=(v-h)*.5,s[1]=(g-m)*.5,s[2]=(y-_)*.5,this.min[0]=h,this.min[1]=m,this.min[2]=_,this.max[0]=v,this.max[1]=g,this.max[2]=y}},{key:"intersects",value:function(n){var r=this.getMax(),i=this.getMin(),a=n.getMax(),o=n.getMin();return i[0]<=a[0]&&r[0]>=o[0]&&i[1]<=a[1]&&r[1]>=o[1]&&i[2]<=a[2]&&r[2]>=o[2]}},{key:"containsPoint",value:function(n){var r=this.getMin(),i=this.getMax();return!(n[0]<r[0]||n[0]>i[0]||n[1]<r[1]||n[1]>i[1]||n[2]<r[2]||n[2]>i[2])}},{key:"getNegativeFarPoint",value:function(n){return n.pnVertexFlag===273?Ce.JG(Ce.Ue(),this.min):n.pnVertexFlag===272?Ce.al(this.min[0],this.min[1],this.max[2]):n.pnVertexFlag===257?Ce.al(this.min[0],this.max[1],this.min[2]):n.pnVertexFlag===256?Ce.al(this.min[0],this.max[1],this.max[2]):n.pnVertexFlag===17?Ce.al(this.max[0],this.min[1],this.min[2]):n.pnVertexFlag===16?Ce.al(this.max[0],this.min[1],this.max[2]):n.pnVertexFlag===1?Ce.al(this.max[0],this.max[1],this.min[2]):Ce.al(this.max[0],this.max[1],this.max[2])}},{key:"getPositiveFarPoint",value:function(n){return n.pnVertexFlag===273?Ce.JG(Ce.Ue(),this.max):n.pnVertexFlag===272?Ce.al(this.max[0],this.max[1],this.min[2]):n.pnVertexFlag===257?Ce.al(this.max[0],this.min[1],this.max[2]):n.pnVertexFlag===256?Ce.al(this.max[0],this.min[1],this.min[2]):n.pnVertexFlag===17?Ce.al(this.min[0],this.max[1],this.max[2]):n.pnVertexFlag===16?Ce.al(this.min[0],this.max[1],this.min[2]):n.pnVertexFlag===1?Ce.al(this.min[0],this.min[1],this.max[2]):Ce.al(this.min[0],this.min[1],this.min[2])}}]),e}();function rT(e){var t=iT();return function(){var r=(0,Cr.Z)(e),i;if(t){var a=(0,Cr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ka.Z)(this,i)}}function iT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var aT=function(e){(0,Ga.Z)(n,e);var t=rT(n);function n(r){var i;return(0,qt.Z)(this,n),i=t.call(this,r),i.material=void 0,i.geometry=void 0,i.aabb=new py,i.aabbDirty=!0,i.model=void 0,i.visible=!0,i.children=[],Object.assign((0,Li.Z)(i),r),i}return n}(Xl),oT=function(){function e(t,n){(0,qt.Z)(this,e),this.distance=void 0,this.normal=void 0,this.pnVertexFlag=void 0,this.distance=t||0,this.normal=n||Ce.al(0,1,0),this.updatePNVertexFlag()}return(0,vn.Z)(e,[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(n){return Ce.AK(n,this.normal)-this.distance}},{key:"normalize",value:function(){var n=1/Ce.Zh(this.normal);Ce.bA(this.normal,this.normal,n),this.distance*=n}},{key:"intersectsLine",value:function(n,r,i){var a=this.distanceToPoint(n),o=this.distanceToPoint(r),s=a/(a-o),c=s>=0&&s<=1;return c&&i&&Ce.t7(i,n,r,s),c}}]),e}(),Kf;(function(e){e[e.OUTSIDE=4294967295]="OUTSIDE",e[e.INSIDE=0]="INSIDE",e[e.INDETERMINATE=2147483647]="INDETERMINATE"})(Kf||(Kf={}));var sT=function(){function e(t){if((0,qt.Z)(this,e),this.planes=[],t)this.planes=t;else for(var n=0;n<6;n++)this.planes.push(new oT)}return(0,vn.Z)(e,[{key:"extractFromVPMatrix",value:function(n){var r=(0,k0.Z)(n,16),i=r[0],a=r[1],o=r[2],s=r[3],c=r[4],f=r[5],d=r[6],h=r[7],v=r[8],m=r[9],g=r[10],_=r[11],y=r[12],E=r[13],b=r[14],A=r[15];Ce.t8(this.planes[0].normal,s-i,h-c,_-v),this.planes[0].distance=-(A-y),Ce.t8(this.planes[1].normal,s+i,h+c,_+v),this.planes[1].distance=-(A+y),Ce.t8(this.planes[2].normal,s+a,h+f,_+m),this.planes[2].distance=-(A+E),Ce.t8(this.planes[3].normal,s-a,h-f,_-m),this.planes[3].distance=-(A-E),Ce.t8(this.planes[4].normal,s-o,h-d,_-g),this.planes[4].distance=-(A-b),Ce.t8(this.planes[5].normal,s+o,h+d,_+g),this.planes[5].distance=-(A+b),this.planes.forEach(function(C){C.normalize(),C.updatePNVertexFlag()})}}]),e}();function KR(e){return typeof e=="number"}function JR(e){return e===void 0?0:e>360||e<-360?e%360:e}function qR(e,t,n){return isNumber(e)?vec3.fromValues(e,t,n):e.length===3?vec3.clone(e):vec3.fromValues(e[0],e[1],e[2])}function uT(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function cT(e){var t=(0,k0.Z)(e,3),n=t[0],r=t[1],i=t[2],a=n+r*256+i*65536-1;return a}function QR(e){return[e+1&255,e+1>>8&255,e+1>>8>>8&255]}var K1,J1,q1,Q1,e_,t_,n_,Kl,r_,i_,a_,o_,s_,u_;function c_(e,t){var n;if(typeof Symbol=="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(n=fT(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(f){throw f},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){n=e[Symbol.iterator]()},n:function(){var f=n.next();return a=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!a&&n.return!=null&&n.return()}finally{if(o)throw s}}}}function fT(e,t){if(!!e){if(typeof e=="string")return f_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f_(e,t)}}function f_(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var lT=(K1=(0,yt.b2)(),J1=(0,yt.f3)(Qe.MeshComponentManager),q1=(0,yt.f3)(Qe.CullableComponentManager),Q1=(0,yt.f3)(Qe.GeometryComponentManager),e_=(0,yt.f3)(Qe.HierarchyComponentManager),t_=(0,yt.f3)(Qe.TransformComponentManager),K1(n_=(Kl=(u_=function(){function e(){(0,qt.Z)(this,e),an(this,"mesh",r_,this),an(this,"cullable",i_,this),an(this,"geometry",a_,this),an(this,"hierarchy",o_,this),an(this,"transform",s_,this),this.planes=void 0}return(0,vn.Z)(e,[{key:"setFrustumPlanes",value:function(n){this.planes=n}},{key:"execute",value:function(){var t=(0,Er.Z)(Xt().mark(function r(i){var a,o,s,c,f,d,h,v,m,g,_,y,E,b,A,C,R,z,ee,Q,re;return Xt().wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:a=c_(i);try{for(a.s();!(o=a.n()).done;){s=o.value,c=s.getScene(),f=s.getCamera(),d=c_(c.getEntities());try{for(d.s();!(h=d.n()).done;)v=h.value,m=this.mesh.getComponentByEntity(v),m&&(g=this.hierarchy.getComponentByEntity(v),_=this.cullable.getComponentByEntity(v),y=m.geometry,E=this.transform.getComponentByEntity(v),y&&y.aabb&&E&&m.aabbDirty&&(b=E.worldTransform,A=y.aabb,C=A.center,R=A.halfExtents,z=Ce.fF(Ce.Ue(),C,b),ee=uT(b,Yl.Ue()),Q=Ce.kK(Ce.Ue(),R,ee),m.aabb.update(z,Q),m.aabbDirty=!1),_&&y&&(re=this.cullable.getComponentByEntity((g==null?void 0:g.parentID)||-1),_.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(m.aabb,(re==null?void 0:re.visibilityPlaneMask)||Kf.INDETERMINATE,this.planes||f.getFrustum().planes),_.visible=_.visibilityPlaneMask!==Kf.OUTSIDE))}catch(ie){d.e(ie)}finally{d.f()}}}catch(ie){a.e(ie)}finally{a.f()}case 2:case"end":return Ie.stop()}},r,this)}));function n(r){return t.apply(this,arguments)}return n}()},{key:"tearDown",value:function(){this.cullable.clear(),this.mesh.clear()}},{key:"computeVisibilityWithPlaneMask",value:function(n,r,i){if(r===Kf.OUTSIDE||r===Kf.INSIDE)return r;for(var a=Kf.INSIDE,o=0,s=i.length;o<s;++o){var c=o<31?1<<o:0;if(!(o<31&&(r&c)==0)){var f=i[o],d=f.normal,h=f.distance;if(Ce.AK(d,n.getNegativeFarPoint(i[o]))+h>0)return Kf.OUTSIDE;Ce.AK(d,n.getPositiveFarPoint(i[o]))+h>0&&(a|=c)}}return a}}]),e}(),u_),r_=on(Kl.prototype,"mesh",[J1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i_=on(Kl.prototype,"cullable",[q1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a_=on(Kl.prototype,"geometry",[Q1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o_=on(Kl.prototype,"hierarchy",[e_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s_=on(Kl.prototype,"transform",[t_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kl))||n_);function Io(){var e=new pa.WT(16);return pa.WT!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function dT(e){var t=new pa.WT(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function my(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function eM(e,t,n,r,i,a,o,s,c,f,d,h,v,m,g,_){var y=new glMatrix.ARRAY_TYPE(16);return y[0]=e,y[1]=t,y[2]=n,y[3]=r,y[4]=i,y[5]=a,y[6]=o,y[7]=s,y[8]=c,y[9]=f,y[10]=d,y[11]=h,y[12]=v,y[13]=m,y[14]=g,y[15]=_,y}function tM(e,t,n,r,i,a,o,s,c,f,d,h,v,m,g,_,y){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=c,e[8]=f,e[9]=d,e[10]=h,e[11]=v,e[12]=m,e[13]=g,e[14]=_,e[15]=y,e}function l_(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function nM(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function U0(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],f=t[7],d=t[8],h=t[9],v=t[10],m=t[11],g=t[12],_=t[13],y=t[14],E=t[15],b=n*s-r*o,A=n*c-i*o,C=n*f-a*o,R=r*c-i*s,z=r*f-a*s,ee=i*f-a*c,Q=d*_-h*g,re=d*y-v*g,de=d*E-m*g,Ie=h*y-v*_,ie=h*E-m*_,ke=v*E-m*y,Ve=b*ke-A*ie+C*Ie+R*de-z*re+ee*Q;return Ve?(Ve=1/Ve,e[0]=(s*ke-c*ie+f*Ie)*Ve,e[1]=(i*ie-r*ke-a*Ie)*Ve,e[2]=(_*ee-y*z+E*R)*Ve,e[3]=(v*z-h*ee-m*R)*Ve,e[4]=(c*de-o*ke-f*re)*Ve,e[5]=(n*ke-i*de+a*re)*Ve,e[6]=(y*C-g*ee-E*A)*Ve,e[7]=(d*ee-v*C+m*A)*Ve,e[8]=(o*ie-s*de+f*Q)*Ve,e[9]=(r*de-n*ie-a*Q)*Ve,e[10]=(g*z-_*C+E*b)*Ve,e[11]=(h*C-d*z-m*b)*Ve,e[12]=(s*re-o*Ie-c*Q)*Ve,e[13]=(n*Ie-r*re+i*Q)*Ve,e[14]=(_*A-g*R-y*b)*Ve,e[15]=(d*R-h*A+v*b)*Ve,e):null}function rM(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],f=t[7],d=t[8],h=t[9],v=t[10],m=t[11],g=t[12],_=t[13],y=t[14],E=t[15];return e[0]=s*(v*E-m*y)-h*(c*E-f*y)+_*(c*m-f*v),e[1]=-(r*(v*E-m*y)-h*(i*E-a*y)+_*(i*m-a*v)),e[2]=r*(c*E-f*y)-s*(i*E-a*y)+_*(i*f-a*c),e[3]=-(r*(c*m-f*v)-s*(i*m-a*v)+h*(i*f-a*c)),e[4]=-(o*(v*E-m*y)-d*(c*E-f*y)+g*(c*m-f*v)),e[5]=n*(v*E-m*y)-d*(i*E-a*y)+g*(i*m-a*v),e[6]=-(n*(c*E-f*y)-o*(i*E-a*y)+g*(i*f-a*c)),e[7]=n*(c*m-f*v)-o*(i*m-a*v)+d*(i*f-a*c),e[8]=o*(h*E-m*_)-d*(s*E-f*_)+g*(s*m-f*h),e[9]=-(n*(h*E-m*_)-d*(r*E-a*_)+g*(r*m-a*h)),e[10]=n*(s*E-f*_)-o*(r*E-a*_)+g*(r*f-a*s),e[11]=-(n*(s*m-f*h)-o*(r*m-a*h)+d*(r*f-a*s)),e[12]=-(o*(h*y-v*_)-d*(s*y-c*_)+g*(s*v-c*h)),e[13]=n*(h*y-v*_)-d*(r*y-i*_)+g*(r*v-i*h),e[14]=-(n*(s*y-c*_)-o*(r*y-i*_)+g*(r*c-i*s)),e[15]=n*(s*v-c*h)-o*(r*v-i*h)+d*(r*c-i*s),e}function iM(e){var t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],c=e[7],f=e[8],d=e[9],h=e[10],v=e[11],m=e[12],g=e[13],_=e[14],y=e[15],E=t*o-n*a,b=t*s-r*a,A=t*c-i*a,C=n*s-r*o,R=n*c-i*o,z=r*c-i*s,ee=f*g-d*m,Q=f*_-h*m,re=f*y-v*m,de=d*_-h*g,Ie=d*y-v*g,ie=h*y-v*_;return E*ie-b*Ie+A*de+C*re-R*Q+z*ee}function Jl(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],f=t[6],d=t[7],h=t[8],v=t[9],m=t[10],g=t[11],_=t[12],y=t[13],E=t[14],b=t[15],A=n[0],C=n[1],R=n[2],z=n[3];return e[0]=A*r+C*s+R*h+z*_,e[1]=A*i+C*c+R*v+z*y,e[2]=A*a+C*f+R*m+z*E,e[3]=A*o+C*d+R*g+z*b,A=n[4],C=n[5],R=n[6],z=n[7],e[4]=A*r+C*s+R*h+z*_,e[5]=A*i+C*c+R*v+z*y,e[6]=A*a+C*f+R*m+z*E,e[7]=A*o+C*d+R*g+z*b,A=n[8],C=n[9],R=n[10],z=n[11],e[8]=A*r+C*s+R*h+z*_,e[9]=A*i+C*c+R*v+z*y,e[10]=A*a+C*f+R*m+z*E,e[11]=A*o+C*d+R*g+z*b,A=n[12],C=n[13],R=n[14],z=n[15],e[12]=A*r+C*s+R*h+z*_,e[13]=A*i+C*c+R*v+z*y,e[14]=A*a+C*f+R*m+z*E,e[15]=A*o+C*d+R*g+z*b,e}function Nv(e,t,n){var r=n[0],i=n[1],a=n[2],o,s,c,f,d,h,v,m,g,_,y,E;return t===e?(e[12]=t[0]*r+t[4]*i+t[8]*a+t[12],e[13]=t[1]*r+t[5]*i+t[9]*a+t[13],e[14]=t[2]*r+t[6]*i+t[10]*a+t[14],e[15]=t[3]*r+t[7]*i+t[11]*a+t[15]):(o=t[0],s=t[1],c=t[2],f=t[3],d=t[4],h=t[5],v=t[6],m=t[7],g=t[8],_=t[9],y=t[10],E=t[11],e[0]=o,e[1]=s,e[2]=c,e[3]=f,e[4]=d,e[5]=h,e[6]=v,e[7]=m,e[8]=g,e[9]=_,e[10]=y,e[11]=E,e[12]=o*r+d*i+g*a+t[12],e[13]=s*r+h*i+_*a+t[13],e[14]=c*r+v*i+y*a+t[14],e[15]=f*r+m*i+E*a+t[15]),e}function aM(e,t,n){var r=n[0],i=n[1],a=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function oM(e,t,n,r){var i=r[0],a=r[1],o=r[2],s=Math.hypot(i,a,o),c,f,d,h,v,m,g,_,y,E,b,A,C,R,z,ee,Q,re,de,Ie,ie,ke,Ve,Rt;return s<glMatrix.EPSILON?null:(s=1/s,i*=s,a*=s,o*=s,c=Math.sin(n),f=Math.cos(n),d=1-f,h=t[0],v=t[1],m=t[2],g=t[3],_=t[4],y=t[5],E=t[6],b=t[7],A=t[8],C=t[9],R=t[10],z=t[11],ee=i*i*d+f,Q=a*i*d+o*c,re=o*i*d-a*c,de=i*a*d-o*c,Ie=a*a*d+f,ie=o*a*d+i*c,ke=i*o*d+a*c,Ve=a*o*d-i*c,Rt=o*o*d+f,e[0]=h*ee+_*Q+A*re,e[1]=v*ee+y*Q+C*re,e[2]=m*ee+E*Q+R*re,e[3]=g*ee+b*Q+z*re,e[4]=h*de+_*Ie+A*ie,e[5]=v*de+y*Ie+C*ie,e[6]=m*de+E*Ie+R*ie,e[7]=g*de+b*Ie+z*ie,e[8]=h*ke+_*Ve+A*Rt,e[9]=v*ke+y*Ve+C*Rt,e[10]=m*ke+E*Ve+R*Rt,e[11]=g*ke+b*Ve+z*Rt,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function hT(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[4],o=t[5],s=t[6],c=t[7],f=t[8],d=t[9],h=t[10],v=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+f*r,e[5]=o*i+d*r,e[6]=s*i+h*r,e[7]=c*i+v*r,e[8]=f*i-a*r,e[9]=d*i-o*r,e[10]=h*i-s*r,e[11]=v*i-c*r,e}function vT(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[0],o=t[1],s=t[2],c=t[3],f=t[8],d=t[9],h=t[10],v=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-f*r,e[1]=o*i-d*r,e[2]=s*i-h*r,e[3]=c*i-v*r,e[8]=a*r+f*i,e[9]=o*r+d*i,e[10]=s*r+h*i,e[11]=c*r+v*i,e}function sM(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[0],o=t[1],s=t[2],c=t[3],f=t[4],d=t[5],h=t[6],v=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+f*r,e[1]=o*i+d*r,e[2]=s*i+h*r,e[3]=c*i+v*r,e[4]=f*i-a*r,e[5]=d*i-o*r,e[6]=h*i-s*r,e[7]=v*i-c*r,e}function uM(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function cM(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function fM(e,t,n){var r=n[0],i=n[1],a=n[2],o=Math.hypot(r,i,a),s,c,f;return o<glMatrix.EPSILON?null:(o=1/o,r*=o,i*=o,a*=o,s=Math.sin(t),c=Math.cos(t),f=1-c,e[0]=r*r*f+c,e[1]=i*r*f+a*s,e[2]=a*r*f-i*s,e[3]=0,e[4]=r*i*f-a*s,e[5]=i*i*f+c,e[6]=a*i*f+r*s,e[7]=0,e[8]=r*a*f+i*s,e[9]=i*a*f-r*s,e[10]=a*a*f+c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function lM(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function dM(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function hM(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function pT(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=r+r,c=i+i,f=a+a,d=r*s,h=r*c,v=r*f,m=i*c,g=i*f,_=a*f,y=o*s,E=o*c,b=o*f;return e[0]=1-(m+_),e[1]=h+b,e[2]=v-E,e[3]=0,e[4]=h-b,e[5]=1-(d+_),e[6]=g+y,e[7]=0,e[8]=v+E,e[9]=g-y,e[10]=1-(d+m),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function vM(e,t){var n=new glMatrix.ARRAY_TYPE(3),r=-t[0],i=-t[1],a=-t[2],o=t[3],s=t[4],c=t[5],f=t[6],d=t[7],h=r*r+i*i+a*a+o*o;return h>0?(n[0]=(s*o+d*r+c*a-f*i)*2/h,n[1]=(c*o+d*i+f*r-s*a)*2/h,n[2]=(f*o+d*a+s*i-c*r)*2/h):(n[0]=(s*o+d*r+c*a-f*i)*2,n[1]=(c*o+d*i+f*r-s*a)*2,n[2]=(f*o+d*a+s*i-c*r)*2),pT(e,t,n),e}function Dv(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Eh(e,t){var n=t[0],r=t[1],i=t[2],a=t[4],o=t[5],s=t[6],c=t[8],f=t[9],d=t[10];return e[0]=Math.hypot(n,r,i),e[1]=Math.hypot(a,o,s),e[2]=Math.hypot(c,f,d),e}function Pv(e,t){var n=new pa.WT(3);Eh(n,t);var r=1/n[0],i=1/n[1],a=1/n[2],o=t[0]*r,s=t[1]*i,c=t[2]*a,f=t[4]*r,d=t[5]*i,h=t[6]*a,v=t[8]*r,m=t[9]*i,g=t[10]*a,_=o+d+g,y=0;return _>0?(y=Math.sqrt(_+1)*2,e[3]=.25*y,e[0]=(h-m)/y,e[1]=(v-c)/y,e[2]=(s-f)/y):o>d&&o>g?(y=Math.sqrt(1+o-d-g)*2,e[3]=(h-m)/y,e[0]=.25*y,e[1]=(s+f)/y,e[2]=(v+c)/y):d>g?(y=Math.sqrt(1+d-o-g)*2,e[3]=(v-c)/y,e[0]=(s+f)/y,e[1]=.25*y,e[2]=(h+m)/y):(y=Math.sqrt(1+g-o-d)*2,e[3]=(s-f)/y,e[0]=(v+c)/y,e[1]=(h+m)/y,e[2]=.25*y),e}function mT(e,t,n,r){var i=t[0],a=t[1],o=t[2],s=t[3],c=i+i,f=a+a,d=o+o,h=i*c,v=i*f,m=i*d,g=a*f,_=a*d,y=o*d,E=s*c,b=s*f,A=s*d,C=r[0],R=r[1],z=r[2];return e[0]=(1-(g+y))*C,e[1]=(v+A)*C,e[2]=(m-b)*C,e[3]=0,e[4]=(v-A)*R,e[5]=(1-(h+y))*R,e[6]=(_+E)*R,e[7]=0,e[8]=(m+b)*z,e[9]=(_-E)*z,e[10]=(1-(h+g))*z,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function pM(e,t,n,r,i){var a=t[0],o=t[1],s=t[2],c=t[3],f=a+a,d=o+o,h=s+s,v=a*f,m=a*d,g=a*h,_=o*d,y=o*h,E=s*h,b=c*f,A=c*d,C=c*h,R=r[0],z=r[1],ee=r[2],Q=i[0],re=i[1],de=i[2],Ie=(1-(_+E))*R,ie=(m+C)*R,ke=(g-A)*R,Ve=(m-C)*z,Rt=(1-(v+E))*z,dn=(y+b)*z,ln=(g+A)*ee,pn=(y-b)*ee,lr=(1-(v+_))*ee;return e[0]=Ie,e[1]=ie,e[2]=ke,e[3]=0,e[4]=Ve,e[5]=Rt,e[6]=dn,e[7]=0,e[8]=ln,e[9]=pn,e[10]=lr,e[11]=0,e[12]=n[0]+Q-(Ie*Q+Ve*re+ln*de),e[13]=n[1]+re-(ie*Q+Rt*re+pn*de),e[14]=n[2]+de-(ke*Q+dn*re+lr*de),e[15]=1,e}function d_(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n+n,s=r+r,c=i+i,f=n*o,d=r*o,h=r*s,v=i*o,m=i*s,g=i*c,_=a*o,y=a*s,E=a*c;return e[0]=1-h-g,e[1]=d+E,e[2]=v-y,e[3]=0,e[4]=d-E,e[5]=1-f-g,e[6]=m+_,e[7]=0,e[8]=v+y,e[9]=m-_,e[10]=1-f-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function mM(e,t,n,r,i,a,o){var s=1/(n-t),c=1/(i-r),f=1/(a-o);return e[0]=a*2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a*2*c,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(i+r)*c,e[10]=(o+a)*f,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*f,e[15]=0,e}function gT(e,t,n,r,i){var a=1/Math.tan(t/2),o;return e[0]=a/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==Infinity?(o=1/(r-i),e[10]=(i+r)*o,e[14]=2*i*r*o):(e[10]=-1,e[14]=-2*r),e}var yT=gT;function gM(e,t,n,r,i){var a=1/Math.tan(t/2),o;return e[0]=a/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==Infinity?(o=1/(r-i),e[10]=i*o,e[14]=i*r*o):(e[10]=-1,e[14]=-r),e}function yM(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),c=2/(o+s),f=2/(i+a);return e[0]=c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f,e[6]=0,e[7]=0,e[8]=-((o-s)*c*.5),e[9]=(i-a)*f*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}function _T(e,t,n,r,i,a,o){var s=1/(t-n),c=1/(r-i),f=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*f,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*c,e[14]=(o+a)*f,e[15]=1,e}var ET=_T;function _M(e,t,n,r,i,a,o){var s=1/(t-n),c=1/(r-i),f=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=f,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*c,e[14]=a*f,e[15]=1,e}function bT(e,t,n,r){var i,a,o,s,c,f,d,h,v,m,g=t[0],_=t[1],y=t[2],E=r[0],b=r[1],A=r[2],C=n[0],R=n[1],z=n[2];return Math.abs(g-C)<pa.Ib&&Math.abs(_-R)<pa.Ib&&Math.abs(y-z)<pa.Ib?l_(e):(d=g-C,h=_-R,v=y-z,m=1/Math.hypot(d,h,v),d*=m,h*=m,v*=m,i=b*v-A*h,a=A*d-E*v,o=E*h-b*d,m=Math.hypot(i,a,o),m?(m=1/m,i*=m,a*=m,o*=m):(i=0,a=0,o=0),s=h*o-v*a,c=v*i-d*o,f=d*a-h*i,m=Math.hypot(s,c,f),m?(m=1/m,s*=m,c*=m,f*=m):(s=0,c=0,f=0),e[0]=i,e[1]=s,e[2]=d,e[3]=0,e[4]=a,e[5]=c,e[6]=h,e[7]=0,e[8]=o,e[9]=f,e[10]=v,e[11]=0,e[12]=-(i*g+a*_+o*y),e[13]=-(s*g+c*_+f*y),e[14]=-(d*g+h*_+v*y),e[15]=1,e)}function EM(e,t,n,r){var i=t[0],a=t[1],o=t[2],s=r[0],c=r[1],f=r[2],d=i-n[0],h=a-n[1],v=o-n[2],m=d*d+h*h+v*v;m>0&&(m=1/Math.sqrt(m),d*=m,h*=m,v*=m);var g=c*v-f*h,_=f*d-s*v,y=s*h-c*d;return m=g*g+_*_+y*y,m>0&&(m=1/Math.sqrt(m),g*=m,_*=m,y*=m),e[0]=g,e[1]=_,e[2]=y,e[3]=0,e[4]=h*y-v*_,e[5]=v*g-d*y,e[6]=d*_-h*g,e[7]=0,e[8]=d,e[9]=h,e[10]=v,e[11]=0,e[12]=i,e[13]=a,e[14]=o,e[15]=1,e}function bM(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function wM(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function xM(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e}function SM(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}function TM(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e}function AM(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e}function IM(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function CM(e,t){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],f=e[7],d=e[8],h=e[9],v=e[10],m=e[11],g=e[12],_=e[13],y=e[14],E=e[15],b=t[0],A=t[1],C=t[2],R=t[3],z=t[4],ee=t[5],Q=t[6],re=t[7],de=t[8],Ie=t[9],ie=t[10],ke=t[11],Ve=t[12],Rt=t[13],dn=t[14],ln=t[15];return Math.abs(n-b)<=glMatrix.EPSILON*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(r-A)<=glMatrix.EPSILON*Math.max(1,Math.abs(r),Math.abs(A))&&Math.abs(i-C)<=glMatrix.EPSILON*Math.max(1,Math.abs(i),Math.abs(C))&&Math.abs(a-R)<=glMatrix.EPSILON*Math.max(1,Math.abs(a),Math.abs(R))&&Math.abs(o-z)<=glMatrix.EPSILON*Math.max(1,Math.abs(o),Math.abs(z))&&Math.abs(s-ee)<=glMatrix.EPSILON*Math.max(1,Math.abs(s),Math.abs(ee))&&Math.abs(c-Q)<=glMatrix.EPSILON*Math.max(1,Math.abs(c),Math.abs(Q))&&Math.abs(f-re)<=glMatrix.EPSILON*Math.max(1,Math.abs(f),Math.abs(re))&&Math.abs(d-de)<=glMatrix.EPSILON*Math.max(1,Math.abs(d),Math.abs(de))&&Math.abs(h-Ie)<=glMatrix.EPSILON*Math.max(1,Math.abs(h),Math.abs(Ie))&&Math.abs(v-ie)<=glMatrix.EPSILON*Math.max(1,Math.abs(v),Math.abs(ie))&&Math.abs(m-ke)<=glMatrix.EPSILON*Math.max(1,Math.abs(m),Math.abs(ke))&&Math.abs(g-Ve)<=glMatrix.EPSILON*Math.max(1,Math.abs(g),Math.abs(Ve))&&Math.abs(_-Rt)<=glMatrix.EPSILON*Math.max(1,Math.abs(_),Math.abs(Rt))&&Math.abs(y-dn)<=glMatrix.EPSILON*Math.max(1,Math.abs(y),Math.abs(dn))&&Math.abs(E-ln)<=glMatrix.EPSILON*Math.max(1,Math.abs(E),Math.abs(ln))}var RM=null,MM=null,h_,v_,p_,m_,g_,y_,__,E_,b_,w_,x_,S_,cu,T_,A_,I_,C_,R_,M_,N_,D_,P_,O_,L_;function B0(e,t){var n;if(typeof Symbol=="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(n=wT(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(f){throw f},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){n=e[Symbol.iterator]()},n:function(){var f=n.next();return a=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!a&&n.return!=null&&n.return()}finally{if(o)throw s}}}}function wT(e,t){if(!!e){if(typeof e=="string")return G_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G_(e,t)}}function G_(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var bh=(h_=(0,yt.b2)(),v_=(0,yt.f3)(Qe.MeshComponentManager),p_=(0,yt.f3)(Qe.GeometryComponentManager),m_=(0,yt.f3)(Qe.MaterialComponentManager),g_=(0,yt.f3)(Qe.CullableComponentManager),y_=(0,yt.f3)(Qe.TransformComponentManager),__=(0,yt.f3)(Qe.HierarchyComponentManager),E_=(0,yt.f3)(Qe.Systems),b_=(0,yt.t6)(Qe.FrameGraphSystem),w_=(0,yt.f3)(Qe.RenderEngine),x_=(0,yt.f3)(Qe.ResourcePool),h_(S_=(cu=(L_=O_=function(){function e(){var t=this;(0,qt.Z)(this,e),an(this,"mesh",T_,this),an(this,"geometry",A_,this),an(this,"material",I_,this),an(this,"cullable",C_,this),an(this,"transform",R_,this),an(this,"hierarchy",M_,this),an(this,"frameGraphSystem",N_,this),an(this,"engine",D_,this),an(this,"resourcePool",P_,this),this.modelCache={},this.setup=function(n,r,i){var a=n.createRenderTarget(r,"color buffer",{width:1,height:1,usage:ve.RENDER_ATTACHMENT|ve.SAMPLED|ve.COPY_SRC});i.data={output:r.write(n,a)}},this.execute=function(){var n=(0,Er.Z)(Xt().mark(function r(i,a,o){var s,c,f,d,h,v;return Xt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:s=i.getResourceNode(a.data.output),c=t.resourcePool.getOrCreateResource(s.resource),f=B0(o),g.prev=3,f.s();case 5:if((d=f.n()).done){g.next=11;break}return h=d.value,g.next=9,t.initView(h);case 9:g.next=5;break;case 11:g.next=16;break;case 13:g.prev=13,g.t0=g.catch(3),f.e(g.t0);case 16:return g.prev=16,f.f(),g.finish(16);case 19:v=t.engine.getCanvas(),c.resize({width:v.width,height:v.height}),t.engine.setScissor({enable:!1}),t.engine.clear({framebuffer:c,color:o[0].getClearColor(),depth:1}),t.engine.useFramebuffer(c,function(){var _=B0(o),y;try{for(_.s();!(y=_.n()).done;){var E=y.value;t.renderView(E)}}catch(b){_.e(b)}finally{_.f()}});case 24:case"end":return g.stop()}},r,null,[[3,13,16,19]])}));return function(r,i,a){return n.apply(this,arguments)}}()}return(0,vn.Z)(e,[{key:"renderView",value:function(n){var r=n.getScene(),i=n.getCamera(),a=i.getViewTransform(),o=Jl(Io(),i.getPerspective(),a);i.getFrustum().extractFromVPMatrix(o);var s=n.getViewport(),c=s.x,f=s.y,d=s.width,h=s.height;this.engine.viewport({x:c,y:f,width:d,height:h});var v=B0(r.getEntities()),m;try{for(v.s();!(m=v.n()).done;){var g=m.value;this.renderMesh(g,{camera:i,view:n,viewMatrix:a})}}catch(_){v.e(_)}finally{v.f()}}},{key:"renderMesh",value:function(n,r){var i=r.camera,a=r.view,o=r.viewMatrix,s=this.mesh.getComponentByEntity(n);if(!(!s||!s.visible)){var c=s.material,f=s.geometry;if(!(!f||f.dirty||!c)){var d=this.transform.getComponentByEntity(n),h=Jl(Io(),o,d.worldTransform),v=a.getViewport(),m=v.width,g=v.height;c.setUniform({projectionMatrix:i.getPerspective(),modelViewMatrix:h,modelMatrix:d.worldTransform,viewMatrix:o,cameraPosition:i.getPosition(),u_viewport:[m,g]}),s.model&&(s.model.draw({uniforms:c.uniforms.reduce(function(_,y){return _[y.name]=y.data,_},{})}),c.uniforms.forEach(function(_){_.dirty=!1}),c.dirty=!1)}}}},{key:"initMesh",value:function(){var t=(0,Er.Z)(Xt().mark(function r(i,a){var o,s,c,f,d,h,v,m;return Xt().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(o=this.mesh.getComponentByEntity(i),o){_.next=3;break}return _.abrupt("return");case 3:if(s=o.material,c=o.geometry,!(!c||c.dirty||!s)){_.next=7;break}return _.abrupt("return");case 7:if(o.model){_.next=24;break}if(f="m-".concat(s.entity,"-g-").concat(c.entity),!this.modelCache[f]){_.next=12;break}return o.model=this.modelCache[f],_.abrupt("return");case 12:return s.setUniform({projectionMatrix:1,modelViewMatrix:1,modelMatrix:1,viewMatrix:1,cameraPosition:1,u_viewport:1}),d=this.engine,h=d.createModel,v=d.createAttribute,m={vs:s.vertexShaderGLSL,fs:s.fragmentShaderGLSL,defines:s.defines,attributes:c.attributes.reduce(function(y,E){return E.data&&E.buffer&&(y[E.name]=v({buffer:E.buffer,attributes:E.attributes,arrayStride:E.arrayStride,stepMode:E.stepMode,divisor:E.stepMode==="vertex"?0:1})),y},{}),uniforms:s.uniforms.reduce(function(y,E){return y[E.name]=E.data,y},{}),scissor:{enable:!0,box:function(){return a.getViewport()}}},s.cull&&(m.cull=s.cull),s.depth&&(m.depth=s.depth),s.blend&&(m.blend=s.blend),c.indicesBuffer&&(m.elements=c.indicesBuffer),c.maxInstancedCount&&(m.instances=c.maxInstancedCount,m.count=c.vertexCount||3),_.next=22,h(m);case 22:o.model=_.sent,this.modelCache[f]=o.model;case 24:case"end":return _.stop()}},r,this)}));function n(r,i){return t.apply(this,arguments)}return n}()},{key:"initView",value:function(){var t=(0,Er.Z)(Xt().mark(function r(i){var a,o,s,c;return Xt().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:a=i.getScene(),o=B0(a.getEntities()),d.prev=2,o.s();case 4:if((s=o.n()).done){d.next=10;break}return c=s.value,d.next=8,this.initMesh(c,i);case 8:d.next=4;break;case 10:d.next=15;break;case 12:d.prev=12,d.t0=d.catch(2),o.e(d.t0);case 15:return d.prev=15,o.f(),d.finish(15);case 18:case"end":return d.stop()}},r,this,[[2,12,15,18]])}));function n(r){return t.apply(this,arguments)}return n}()}]),e}(),O_.IDENTIFIER="Render Pass",L_),T_=on(cu.prototype,"mesh",[v_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A_=on(cu.prototype,"geometry",[p_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I_=on(cu.prototype,"material",[m_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C_=on(cu.prototype,"cullable",[g_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R_=on(cu.prototype,"transform",[y_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M_=on(cu.prototype,"hierarchy",[__],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N_=on(cu.prototype,"frameGraphSystem",[E_,b_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D_=on(cu.prototype,"engine",[w_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P_=on(cu.prototype,"resourcePool",[x_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cu))||S_),k_,F_,U_,B_,z_,W_,wh,V_,Z_,j_,H_,X_,$_;function gy(e,t){var n;if(typeof Symbol=="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(n=xT(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(f){throw f},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){n=e[Symbol.iterator]()},n:function(){var f=n.next();return a=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!a&&n.return!=null&&n.return()}finally{if(o)throw s}}}}function xT(e,t){if(!!e){if(typeof e=="string")return Y_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Y_(e,t)}}function Y_(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var yy={NONE:0,ENCODE:1,HIGHLIGHT:2},_y=(k_=(0,yt.b2)(),F_=(0,yt.f3)(Qe.RenderEngine),U_=(0,yt.f3)(Qe.ResourcePool),B_=(0,yt.f3)(Qe.RenderPassFactory),z_=(0,yt.f3)(Qe.MeshComponentManager),k_(W_=(wh=($_=X_=function(){function e(){var t=this;(0,qt.Z)(this,e),an(this,"engine",V_,this),an(this,"resourcePool",Z_,this),an(this,"renderPassFactory",j_,this),an(this,"mesh",H_,this),this.pickingFBO=void 0,this.views=void 0,this.highlightEnabled=!0,this.highlightColor=[255,0,0,255],this.alreadyInRendering=!1,this.setup=function(n,r,i){var a=n.createRenderTarget(r,"picking fbo",{width:1,height:1});i.data={output:r.write(n,a)},r.hasSideEffect=!0},this.execute=function(){var n=(0,Er.Z)(Xt().mark(function r(i,a,o){var s,c,f;return Xt().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(t.views=o,!t.alreadyInRendering){h.next=3;break}return h.abrupt("return");case 3:s=gy(o);try{for(f=function(){var m=c.value,g=m.getViewport(),_=g.width,y=g.height;t.alreadyInRendering=!0;var E=i.getResourceNode(a.data.output);t.pickingFBO=t.resourcePool.getOrCreateResource(E.resource),t.pickingFBO.resize({width:_,height:y}),t.engine.useFramebuffer(t.pickingFBO,function(){t.engine.clear({framebuffer:t.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var b=t.renderPassFactory(bh.IDENTIFIER),A=[],C=m.getScene(),R=gy(C.getEntities()),z;try{for(R.s();!(z=R.n()).done;){var ee=z.value,Q=t.mesh.getComponentByEntity(ee),re=Q.material;re.setUniform("u_PickingStage",yy.ENCODE),A.push(Q)}}catch(de){R.e(de)}finally{R.f()}b.renderView(m),A.forEach(function(de){var Ie=de.material;Ie.setUniform("u_PickingStage",yy.HIGHLIGHT)}),t.alreadyInRendering=!1})},s.s();!(c=s.n()).done;)f()}catch(v){s.e(v)}finally{s.f()}case 5:case"end":return h.stop()}},r)}));return function(r,i,a){return n.apply(this,arguments)}}(),this.pick=function(n,r){var i=n.x,a=n.y,o=t.engine,s=o.readPixels,c=o.useFramebuffer,f=r.getViewport(),d=f.width,h=f.height,v=i*window.devicePixelRatio,m=a*window.devicePixelRatio;if(!(v>d||v<0||m>h||m<0)){var g,_;return c(t.pickingFBO,function(){g=s({x:Math.round(v),y:Math.round(h-(a+1)*window.devicePixelRatio),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:t.pickingFBO}),(g[0]!==0||g[1]!==0||g[2]!==0)&&(_=cT(g),t.highlightEnabled&&t.highlightPickedFeature(g,r))}),_}}}return(0,vn.Z)(e,[{key:"enableHighlight",value:function(n){this.highlightEnabled=n}},{key:"setHighlightColor",value:function(n){this.highlightColor=n}},{key:"highlightPickedFeature",value:function(n,r){if(n){var i=gy(r.getScene().getEntities()),a;try{for(i.s();!(a=i.n()).done;){var o=a.value,s=this.mesh.getComponentByEntity(o),c=s.material;c.setUniform("u_PickingStage",yy.HIGHLIGHT),c.setUniform("u_PickingColor",[n[0],n[1],n[2]]),c.setUniform("u_HighlightColor",this.highlightColor)}}catch(f){i.e(f)}finally{i.f()}}}}]),e}(),X_.IDENTIFIER="PixelPicking Pass",$_),V_=on(wh.prototype,"engine",[F_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z_=on(wh.prototype,"resourcePool",[U_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j_=on(wh.prototype,"renderPassFactory",[B_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H_=on(wh.prototype,"mesh",[z_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wh))||W_),K_,J_,q_,Q_,z0,eE,tE,nE,rE,ST=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,TT=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,AT=`layout(set = 0, binding = 0) uniform sampler u_TextureSampler;
layout(set = 0, binding = 1) uniform texture2D u_Texture;

layout(location = 0) in vec2 v_UV;
layout(location = 0) out vec4 outColor;

void main() {
  outColor = texture(sampler2D(u_Texture, u_TextureSampler), v_UV);
}`,IT=`layout(location = 0) in vec2 a_Position;
layout(location = 0) out vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,W0=(K_=(0,yt.b2)(),J_=(0,yt.f3)(Qe.RenderEngine),q_=(0,yt.f3)(Qe.ResourcePool),K_(Q_=(z0=(rE=nE=function e(){var t=this;(0,qt.Z)(this,e),an(this,"engine",eE,this),an(this,"resourcePool",tE,this),this.model=void 0,this.setup=function(n,r,i){var a=n.getPass(bh.IDENTIFIER);if(a){var o=n.createRenderTarget(r,"render to screen",{width:1,height:1});i.data={input:r.read(a.data.output),output:r.write(n,o)}}},this.execute=function(){var n=(0,Er.Z)(Xt().mark(function r(i,a){var o,s,c,f,d,h,v;return Xt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(o=t.engine,s=o.createModel,c=o.createAttribute,f=o.createBuffer,t.model){g.next=6;break}return g.next=4,s({vs:t.engine.supportWebGPU?IT:TT,fs:t.engine.supportWebGPU?AT:ST,attributes:{a_Position:c({buffer:f({data:[-4,-4,4,-4,0,4],type:ve.FLOAT}),size:2,arrayStride:2*4,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]})},uniforms:{u_Texture:null},depth:{enable:!1},count:3,blend:{enable:!0}});case 4:d=g.sent,t.model=d;case 6:h=i.getResourceNode(a.data.input),v=t.resourcePool.getOrCreateResource(h.resource),t.engine.useFramebuffer(null,function(){t.engine.clear({framebuffer:null,color:[0,0,0,0],depth:1,stencil:0}),t.model.draw({uniforms:{u_Texture:v}})});case 9:case"end":return g.stop()}},r)}));return function(r,i){return n.apply(this,arguments)}}(),this.tearDown=function(){t.model=void 0}},nE.IDENTIFIER="Copy Pass",rE),eE=on(z0.prototype,"engine",[J_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tE=on(z0.prototype,"resourcePool",[q_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z0))||Q_),iE,aE,oE,sE,uE,cE,fE,xh,lE,dE,hE,vE,pE,CT=(iE=(0,yt.b2)(),aE=(0,yt.f3)(Qe.Systems),oE=(0,yt.t6)(Qe.FrameGraphSystem),sE=(0,yt.f3)(Qe.RenderPassFactory),uE=(0,yt.f3)(Qe.ConfigService),cE=(0,yt.f3)(Qe.ResourcePool),iE(fE=(xh=(pE=function(){function e(){(0,qt.Z)(this,e),an(this,"frameGraphSystem",lE,this),an(this,"renderPassFactory",dE,this),an(this,"configService",hE,this),an(this,"resourcePool",vE,this)}return(0,vn.Z)(e,[{key:"execute",value:function(){var t=(0,Er.Z)(Xt().mark(function r(i){var a,o,s,c,f,d,h,v,m;return Xt().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:a=this.renderPassFactory(bh.IDENTIFIER),o=a.setup,s=a.execute,c=this.frameGraphSystem.addPass(bh.IDENTIFIER,o,s),f=this.renderPassFactory(W0.IDENTIFIER),d=f.setup,h=f.execute,v=f.tearDown,m=this.frameGraphSystem.addPass(W0.IDENTIFIER,d,h,v),this.frameGraphSystem.present(m.data.output);case 5:case"end":return _.stop()}},r,this)}));function n(r){return t.apply(this,arguments)}return n}()},{key:"tearDown",value:function(){this.resourcePool.clean()}},{key:"pick",value:function(n,r){var i=this.renderPassFactory(_y.IDENTIFIER);return i.pick(n,r)}}]),e}(),pE),lE=on(xh.prototype,"frameGraphSystem",[aE,oE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dE=on(xh.prototype,"renderPassFactory",[sE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hE=on(xh.prototype,"configService",[uE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vE=on(xh.prototype,"resourcePool",[cE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xh))||fE);function RT(e){var t=MT();return function(){var r=(0,Cr.Z)(e),i;if(t){var a=(0,Cr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ka.Z)(this,i)}}function MT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var NT=function(e){(0,Ga.Z)(n,e);var t=RT(n);function n(r){var i;return(0,qt.Z)(this,n),i=t.call(this,r),i.parentID=void 0,Object.assign((0,Li.Z)(i),r),i}return n}(Xl),mE,gE,yE,_E,EE,Ov,bE,wE,xE,SE,DT=(mE=(0,yt.b2)(),gE=(0,yt.f3)(Qe.HierarchyComponentManager),yE=(0,yt.f3)(Qe.TransformComponentManager),_E=(0,yt.f3)(Qe.MeshComponentManager),mE(EE=(Ov=(SE=function(){function e(){(0,qt.Z)(this,e),an(this,"hierarchy",bE,this),an(this,"transform",wE,this),an(this,"mesh",xE,this)}return(0,vn.Z)(e,[{key:"execute",value:function(){var t=(0,Er.Z)(Xt().mark(function r(){return Xt().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:this.runTransformUpdateSystem(),this.runHierarchyUpdateSystem();case 2:case"end":return a.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"tearDown",value:function(){this.hierarchy.clear(),this.transform.clear()}},{key:"getHierarchyComponentManager",value:function(){return this.hierarchy}},{key:"getTransformComponentManager",value:function(){return this.transform}},{key:"runTransformUpdateSystem",value:function(){var n=this;this.transform.forEach(function(r,i){(i.isDirty()||i.isLocalDirty())&&(n.setMeshAABBDirty(n.mesh.getComponentByEntity(r)),i.updateTransform())})}},{key:"runHierarchyUpdateSystem",value:function(){var n=this;this.hierarchy.forEach(function(r,i){var a=n.transform.getComponentByEntity(r),o=n.transform.getComponentByEntity(i.parentID);a!==null&&o!==null&&a.updateTransformWithParent(o)})}},{key:"attach",value:function(n,r,i){this.hierarchy.contains(n)&&this.detach(n),this.hierarchy.create(n,{parentID:r});var a=this.mesh.getComponentByEntity(r);if(this.setMeshAABBDirty(a),a&&a.children.indexOf(n)===-1&&a.children.push(n),this.hierarchy.getCount()>1)for(var o=this.hierarchy.getCount()-1;o>0;--o)for(var s=this.hierarchy.getEntity(o),c=0;c<o;++c){var f=this.hierarchy.getComponent(c);if(f.parentID===s){this.hierarchy.moveItem(o,c),++o;break}}var d=this.hierarchy.getComponentByEntity(n),h=this.transform.getComponentByEntity(r);h===null&&(h=this.transform.create(r));var v=this.transform.getComponentByEntity(n);v===null&&(v=this.transform.create(n),h=this.transform.getComponentByEntity(r)),v.parent=h,!i&&h&&(v.matrixTransform(U0(Io(),h.worldTransform)),v.updateTransform()),h&&v.updateTransformWithParent(h)}},{key:"detach",value:function(n){var r=this.hierarchy.getComponentByEntity(n);if(r!==null){var i=this.transform.getComponentByEntity(n);i!==null&&(i.parent=null,i.applyTransform()),this.hierarchy.removeKeepSorted(n);var a=this.mesh.getComponentByEntity(r.parentID);if(a){var o=a.children.indexOf(n);a.children.splice(o,1)}this.setMeshAABBDirty(a)}}},{key:"detachChildren",value:function(n){var r=this.mesh.getComponentByEntity(n);r&&(r.children=[]);for(var i=0;i<this.hierarchy.getCount();){var a;if(((a=this.hierarchy.getComponent(i))===null||a===void 0?void 0:a.parentID)===n){var o=this.hierarchy.getEntity(i);this.detach(o)}else++i}}},{key:"setMeshAABBDirty",value:function(n){n&&(n.aabbDirty=!0)}}]),e}(),SE),bE=on(Ov.prototype,"hierarchy",[gE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wE=on(Ov.prototype,"transform",[yE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xE=on(Ov.prototype,"mesh",[_E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ov))||EE);function aa(){var e=new pa.WT(4);return pa.WT!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function NM(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function ql(e,t,n){n=n*.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function DM(e,t){var n=Math.acos(t[3])*2,r=Math.sin(n/2);return r>glMatrix.EPSILON?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),n}function PM(e,t){var n=FT(e,t);return Math.acos(2*n*n-1)}function Ms(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=n[0],c=n[1],f=n[2],d=n[3];return e[0]=r*d+o*s+i*f-a*c,e[1]=i*d+o*c+a*s-r*f,e[2]=a*d+o*f+r*c-i*s,e[3]=o*d-r*s-i*c-a*f,e}function OM(e,t,n){n*=.5;var r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),c=Math.cos(n);return e[0]=r*c+o*s,e[1]=i*c+a*s,e[2]=a*c-i*s,e[3]=o*c-r*s,e}function LM(e,t,n){n*=.5;var r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),c=Math.cos(n);return e[0]=r*c-a*s,e[1]=i*c+o*s,e[2]=a*c+r*s,e[3]=o*c-i*s,e}function GM(e,t,n){n*=.5;var r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),c=Math.cos(n);return e[0]=r*c+i*s,e[1]=i*c-r*s,e[2]=a*c+o*s,e[3]=o*c-a*s,e}function kM(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e}function PT(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=Math.sqrt(n*n+r*r+i*i),s=Math.exp(a),c=o>0?s*Math.sin(o)/o:0;return e[0]=n*c,e[1]=r*c,e[2]=i*c,e[3]=s*Math.cos(o),e}function OT(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=Math.sqrt(n*n+r*r+i*i),s=o>0?Math.atan2(o,a)/o:0;return e[0]=n*s,e[1]=r*s,e[2]=i*s,e[3]=.5*Math.log(n*n+r*r+i*i+a*a),e}function FM(e,t,n){return OT(e,t),kT(e,e,n),PT(e,e),e}function V0(e,t,n,r){var i=t[0],a=t[1],o=t[2],s=t[3],c=n[0],f=n[1],d=n[2],h=n[3],v,m,g,_,y;return m=i*c+a*f+o*d+s*h,m<0&&(m=-m,c=-c,f=-f,d=-d,h=-h),1-m>pa.Ib?(v=Math.acos(m),g=Math.sin(v),_=Math.sin((1-r)*v)/g,y=Math.sin(r*v)/g):(_=1-r,y=r),e[0]=_*i+y*c,e[1]=_*a+y*f,e[2]=_*o+y*d,e[3]=_*s+y*h,e}function UM(e){var t=glMatrix.RANDOM(),n=glMatrix.RANDOM(),r=glMatrix.RANDOM(),i=Math.sqrt(1-t),a=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*n),e[1]=i*Math.cos(2*Math.PI*n),e[2]=a*Math.sin(2*Math.PI*r),e[3]=a*Math.cos(2*Math.PI*r),e}function TE(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n*n+r*r+i*i+a*a,s=o?1/o:0;return e[0]=-n*s,e[1]=-r*s,e[2]=-i*s,e[3]=a*s,e}function BM(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function LT(e,t){var n=t[0]+t[4]+t[8],r;if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;r=Math.sqrt(t[i*3+i]-t[a*3+a]-t[o*3+o]+1),e[i]=.5*r,r=.5/r,e[3]=(t[a*3+o]-t[o*3+a])*r,e[a]=(t[a*3+i]+t[i*3+a])*r,e[o]=(t[o*3+i]+t[i*3+o])*r}return e}function Ey(e,t,n,r){var i=.5*Math.PI/180;t*=i,n*=i,r*=i;var a=Math.sin(t),o=Math.cos(t),s=Math.sin(n),c=Math.cos(n),f=Math.sin(r),d=Math.cos(r);return e[0]=a*c*d-o*s*f,e[1]=o*s*d+a*c*f,e[2]=o*c*f-a*s*d,e[3]=o*c*d+a*s*f,e}function zM(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var WM=i2,by=A1,Lv=a2,VM=o2,ZM=s2,GT=Ms,kT=u2,FT=d2,jM=h2,HM=c2,XM=null,$M=f2,YM=null,Sh=l2,KM=v2,JM=p2,qM=function(){var e=Ce.Ue(),t=Ce.al(1,0,0),n=Ce.al(0,1,0);return function(r,i,a){var o=Ce.AK(i,a);return o<-.999999?(Ce.kC(e,t,i),Ce.Zh(e)<1e-6&&Ce.kC(e,n,i),Ce.Fv(e,e),ql(r,e,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Ce.kC(e,i,a),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+o,Sh(r,r))}}(),QM=function(){var e=aa(),t=aa();return function(n,r,i,a,o,s){return V0(e,r,o,s),V0(t,i,a,s),V0(n,e,t,2*s*(1-s)),n}}(),eN=function(){var e=Yl.Ue();return function(t,n,r,i){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],Sh(t,LT(t,e))}}();function UT(e){var t=BT();return function(){var r=(0,Cr.Z)(e),i;if(t){var a=(0,Cr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ka.Z)(this,i)}}function BT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var AE=function(e){(0,Ga.Z)(n,e);var t=UT(n);function n(r){var i;return(0,qt.Z)(this,n),i=t.call(this,r),i.dirtyFlag=void 0,i.localDirtyFlag=void 0,i.parent=null,i.localPosition=Ce.al(0,0,0),i.localRotation=by(0,0,0,1),i.localScale=Ce.al(1,1,1),i.localTransform=Io(),i.position=Ce.al(0,0,0),i.rotation=by(0,0,0,1),i.scaling=Ce.al(1,1,1),i.worldTransform=Io(),i.matrixTransform=function(){var a=Io();return function(o){Jl(a,i.getLocalTransform(),o),Eh(i.localScale,a),Dv(i.localPosition,a),Pv(i.localRotation,a)}}(),i.rotateRollPitchYaw=function(){var a=aa(),o=aa(),s=aa();return function(c,f,d){i.setDirty(),Ey(a,c,0,0),Ey(o,0,f,0),Ey(s,0,0,d),Ms(i.localRotation,a,i.localRotation),Ms(i.localRotation,i.localRotation,o),Ms(i.localRotation,s,i.localRotation),Sh(i.localRotation,i.localRotation)}}(),i.lerp=function(){var a=Ce.Ue(),o=aa(),s=Ce.Ue(),c=Ce.Ue(),f=aa(),d=Ce.Ue();return function(h,v,m){i.setDirty(),Eh(a,h.worldTransform),Dv(s,h.worldTransform),Pv(o,h.worldTransform),Eh(c,v.worldTransform),Dv(d,v.worldTransform),Pv(f,v.worldTransform),Ce.t7(i.localScale,a,c,m),V0(i.localRotation,o,f,m),Ce.t7(i.localPosition,s,d,m)}}(),i.translate=function(){var a=Ce.Ue();return function(o){return Ce.IH(a,i.getPosition(),o),i.setPosition(a),i.setDirty(!0),(0,Li.Z)(i)}}(),i.translateLocal=function(){return function(a){return Ce.VC(a,a,i.localRotation),Ce.IH(i.localPosition,i.localPosition,a),i.setLocalDirty(!0),(0,Li.Z)(i)}}(),i.setPosition=function(){var a=Io();return function(o){return i.position=o,i.setLocalDirty(!0),i.parent===null?Ce.JG(i.localPosition,o):(my(a,i.parent.worldTransform),U0(a,a),Ce.fF(i.localPosition,o,a)),(0,Li.Z)(i)}}(),i.rotate=function(){var a=aa();return function(o){if(i.parent===null)Ms(i.localRotation,i.localRotation,o),Sh(i.localRotation,i.localRotation);else{var s=i.getRotation(),c=i.parent.getRotation();Lv(a,c),TE(a,a),Ms(a,a,o),Ms(i.localRotation,o,s),Sh(i.localRotation,i.localRotation)}return i.setLocalDirty(),(0,Li.Z)(i)}}(),i.rotateLocal=function(){return function(a){return Ms(i.localRotation,i.localRotation,a),Sh(i.localRotation,i.localRotation),i.setLocalDirty(!0),(0,Li.Z)(i)}}(),i.setRotation=function(){var a=aa();return function(o){return i.parent===null?Lv(i.localRotation,o):(Lv(a,i.parent.getRotation()),TE(a,a),Lv(i.localRotation,a),GT(i.localRotation,i.localRotation,o)),i.setLocalDirty(!0),(0,Li.Z)(i)}}(),i}return(0,vn.Z)(n,[{key:"setLocalPosition",value:function(i){Ce.JG(this.localPosition,i),this.setLocalDirty(!0)}},{key:"setLocalScale",value:function(i){Ce.JG(this.localScale,i),this.setLocalDirty(!0)}},{key:"setLocalRotation",value:function(i){return Lv(this.localRotation,i),this.setLocalDirty(!0),this}},{key:"isDirty",value:function(){return this.dirtyFlag}},{key:"setDirty",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i?this.dirtyFlag|=n.DIRTY:this.dirtyFlag&=~n.DIRTY}},{key:"isLocalDirty",value:function(){return this.localDirtyFlag}},{key:"setLocalDirty",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i?(this.localDirtyFlag|=n.DIRTY,this.setDirty(!0)):this.localDirtyFlag&=~n.DIRTY}},{key:"updateTransform",value:function(){this.isLocalDirty()&&this.getLocalTransform(),this.isDirty()&&this.parent===null&&(my(this.worldTransform,this.getLocalTransform()),this.setDirty(!1))}},{key:"updateTransformWithParent",value:function(i){Jl(this.worldTransform,i.worldTransform,this.getLocalTransform())}},{key:"applyTransform",value:function(){this.setDirty(),Eh(this.localScale,this.worldTransform),Dv(this.localPosition,this.worldTransform),Pv(this.localRotation,this.worldTransform)}},{key:"clearTransform",value:function(){this.setDirty(),this.localPosition=Ce.al(0,0,0),this.localRotation=by(0,0,0,1),this.localScale=Ce.al(1,1,1)}},{key:"scaleLocal",value:function(i){return this.setLocalDirty(),Ce.Jp(this.localScale,this.localScale,i),this}},{key:"getLocalPosition",value:function(){return this.localPosition}},{key:"getLocalRotation",value:function(){return this.localRotation}},{key:"getLocalScale",value:function(){return this.localScale}},{key:"getLocalTransform",value:function(){return this.localDirtyFlag&&(mT(this.localTransform,this.localRotation,this.localPosition,this.localScale),this.setLocalDirty(!1)),this.localTransform}},{key:"getWorldTransform",value:function(){return!this.isLocalDirty()&&!this.isDirty()?this.worldTransform:(this.parent&&this.parent.getWorldTransform(),this.updateTransform(),this.worldTransform)}},{key:"getPosition",value:function(){return Dv(this.position,this.worldTransform),this.position}},{key:"getRotation",value:function(){return Pv(this.rotation,this.worldTransform),this.rotation}},{key:"getScale",value:function(){return Eh(this.scaling,this.worldTransform),this.scaling}}]),n}(Xl);AE.DIRTY=1<<0;var zT=S(84879),IE,CE,RE,wy,ME,NE,WT=(IE=(0,yt.b2)(),CE=(0,yt.f3)(Qe.RenderEngine),IE(RE=(wy=(NE=function(){function e(){(0,qt.Z)(this,e),an(this,"engine",ME,this),this.resourcePool={}}return(0,vn.Z)(e,[{key:"getOrCreateResource",value:function(n){if(!this.resourcePool[n.name]){var r=n.descriptor,i=r.width,a=r.height,o=r.usage;this.resourcePool[n.name]=this.engine.createFramebuffer({color:this.engine.createTexture2D({width:i,height:a,wrapS:ve.CLAMP_TO_EDGE,wrapT:ve.CLAMP_TO_EDGE,usage:o})})}return this.resourcePool[n.name]}},{key:"clean",value:function(){this.resourcePool={}}}]),e}(),NE),ME=on(wy.prototype,"engine",[CE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wy))||RE);function VT(e){var t=ZT();return function(){var r=(0,Cr.Z)(e),i;if(t){var a=(0,Cr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ka.Z)(this,i)}}function ZT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var jT=function(e){(0,Ga.Z)(n,e);var t=VT(n);function n(r){var i;return(0,qt.Z)(this,n),i=t.call(this,r),i.name=void 0,i.name=r.name||"",i}return n}(Xl),DE,PE,OE,HT=(DE=(0,yt.b2)(),DE(PE=(OE=function(){function e(){(0,qt.Z)(this,e),this.config=void 0}return(0,vn.Z)(e,[{key:"get",value:function(){return this.config}},{key:"set",value:function(n){this.config=n}}]),e}(),OE))||PE),LE,GE,kE;(function(e){e.PANSTART="PANSTART",e.PANEND="PANEND",e.PANMOVE="PANMOVE",e.PINCH="PINCH",e.KEYDOWN="KEYDOWN",e.KEYUP="KEYUP",e.HOVER="HOVER"})(kE||(kE={}));var XT=(LE=(0,yt.b2)(),LE(GE=function(){function e(){(0,qt.Z)(this,e)}return(0,vn.Z)(e,[{key:"listen",value:function(n){}},{key:"on",value:function(n,r){}},{key:"connect",value:function(){}},{key:"disconnect",value:function(){}},{key:"destroy",value:function(){}}]),e}())||GE);function $T(e){var t=0;switch(e){case"vec2":case"ivec2":t=2;break;case"vec3":case"ivec3":t=3;break;case"vec4":case"ivec4":case"mat2":t=4;break;case"mat3":t=9;break;case"mat4":t=16;break;default:}return t}var YT=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function FE(e){var t={};return e=e.replace(YT,function(n,r,i){var a=i.split(":"),o=a[0].trim(),s="";switch(a.length>1&&(s=a[1].trim()),r){case"bool":s=s==="true";break;case"float":case"int":s=Number(s);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":s?s=s.replace("[","").replace("]","").split(",").reduce(function(c,f){return c.push(Number(f.trim())),c},[]):s=new Array($T(r)).fill(0);break;default:}return t[o]=s,"uniform ".concat(r," ").concat(o,`;
`)}),{content:e,uniforms:t}}function KT(e){return e.filter(function(t,n,r){return r.indexOf(t)===n})}var UE,BE,zE;function WE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Gv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?WE(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WE(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var JT=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;

#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color) {
  bool selected = bool(v_PickingResult.a);

  if (selected) {
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(resultRGB, color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  return filterPickingColor(filterHighlightColor(color));
}
`,qT=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;

#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  // compares only in highlight stage
  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}`,QT=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}`,eA=/precision\s+(high|low|medium)p\s+float/,tA=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,nA=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,rA=(UE=(0,yt.b2)(),UE(BE=(zE=function(){function e(){(0,qt.Z)(this,e),this.moduleCache={},this.rawContentCache={}}return(0,vn.Z)(e,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("picking",{vs:qT,fs:JT}),this.registerModule("sdf2d",{vs:"",fs:QT})}},{key:"registerModule",value:function(n,r){if(!this.rawContentCache[n]){var i=r.vs,a=i===void 0?"":i,o=r.fs,s=o===void 0?"":o,c=r.uniforms,f=FE(a),d=f.content,h=f.uniforms,v=FE(s),m=v.content,g=v.uniforms;this.rawContentCache[n]={fs:m,uniforms:Gv(Gv(Gv({},h),g),c),vs:d}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(n){var r=this;if(this.moduleCache[n])return this.moduleCache[n];var i=this.rawContentCache[n].vs||"",a=this.rawContentCache[n].fs||"",o=this.processModule(i,[],"vs"),s=o.content,c=o.includeList,f=this.processModule(a,[],"fs"),d=f.content,h=f.includeList,v=d,m=KT(c.concat(h).concat(n)).reduce(function(g,_){return Gv(Gv({},g),r.rawContentCache[_].uniforms)},{});return eA.test(d)||(v=tA+d),this.moduleCache[n]={fs:v.trim(),uniforms:m,vs:s.trim()},this.moduleCache[n]}},{key:"processModule",value:function(n,r,i){var a=this,o=n.replace(nA,function(s,c){var f=c.split(" "),d=f[0].replace(/"/g,"");if(r.indexOf(d)>-1)return"";var h=a.rawContentCache[d][i];r.push(d);var v=a.processModule(h||"",r,i),m=v.content;return m});return{content:o,includeList:r}}}]),e}(),zE))||BE),ec=new yt.W2,VE=(0,zT.Z)(ec,!1),tN=function(t){var n=VE.lazyInject(t);return function(r,i,a){n.call(this,r,i),a&&(a.initializer=function(){return r[i]})}},nN=function(t){var n=VE.lazyMultiInject(t);return function(r,i,a){n.call(this,r,i),a&&(a.initializer=function(){return r[i]})}};ec.bind(Qe.ShaderModuleService).to(rA).inSingletonScope(),ec.bind(Qe.NameComponentManager).toConstantValue(new $l(jT)),ec.bind(Qe.HierarchyComponentManager).toConstantValue(new $l(NT)),ec.bind(Qe.TransformComponentManager).toConstantValue(new $l(AE)),ec.bind(Qe.MeshComponentManager).toConstantValue(new $l(aT)),ec.bind(Qe.CullableComponentManager).toConstantValue(new $l(nT)),ec.bind(Qe.GeometryComponentManager).toConstantValue(new $l($2)),ec.bind(Qe.MaterialComponentManager).toConstantValue(new $l(q2));function iA(){var e=new yt.W2;return e.parent=ec,e.bind(Qe.Systems).to(DT).inSingletonScope().whenTargetNamed(Qe.SceneGraphSystem),e.bind(Qe.Systems).to(r2).inSingletonScope().whenTargetNamed(Qe.FrameGraphSystem),e.bind(Qe.Systems).to(lT).inSingletonScope().whenTargetNamed(Qe.MeshSystem),e.bind(Qe.Systems).to(Y2).inSingletonScope().whenTargetNamed(Qe.GeometrySystem),e.bind(Qe.Systems).to(Q2).inSingletonScope().whenTargetNamed(Qe.MaterialSystem),e.bind(Qe.Systems).to(CT).inSingletonScope().whenTargetNamed(Qe.RendererSystem),e.bind(Qe.ResourcePool).to(WT).inSingletonScope(),e.bind(Qe.ConfigService).to(HT).inSingletonScope(),e.bind(Qe.InteractorService).to(XT).inSingletonScope(),e.bind(Qe.RenderPass).to(bh).inSingletonScope().whenTargetNamed(bh.IDENTIFIER),e.bind(Qe.RenderPass).to(W0).inSingletonScope().whenTargetNamed(W0.IDENTIFIER),e.bind(Qe.RenderPass).to(_y).inSingletonScope().whenTargetNamed(_y.IDENTIFIER),e.bind(Qe.RenderPassFactory).toFactory(function(t){return function(n){return t.container.getNamed(Qe.RenderPass,n)}}),e}function xy(e){for(var t=new py,n=Ce.al(e[0],e[1],e[2]),r=Ce.al(e[0],e[1],e[2]),i=3;i<e.length;){var a=e[i++],o=e[i++],s=e[i++];a<n[0]&&(n[0]=a),o<n[1]&&(n[1]=o),s<n[2]&&(n[2]=s),a>r[0]&&(r[0]=a),o>r[1]&&(r[1]=o),s>r[2]&&(r[2]=s)}return t.setMinMax(n,r),t}var Co=typeof navigator!="undefined"&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),rN=Ce.Ue(),iN=null,aN=Ce.Ue(),oN=Ce.Ue(),sN=Ce.Ue(),uN=Ce.Ue(),cN=Ce.Ue(),fN=null,lN=S(59518),dN=S(26199),hN=S(14156),vN=S(71468),pN=S(48871),mN=S(9871),ZE;(function(e){e.Normal="normal",e.PostProcessing="post-processing"})(ZE||(ZE={}));var gN=S(25612),yN=S(92777),_N=S(20159),EN=S(61622),bN=S(20499),wN=S(64851),Ql;(function(e){e.Void="Void",e.Boolean="Boolean",e.Float="Float",e.Uint32="Uint32",e.Int32="Int32",e.Vector="Vector",e.Vector2Float="vec2<f32>",e.Vector3Float="vec3<f32>",e.Vector4Float="vec4<f32>",e.Vector2Boolean="vec2<bool>",e.Vector3Boolean="vec3<bool>",e.Vector4Boolean="vec4<bool>",e.Vector2Uint="vec2<u32>",e.Vector3Uint="vec3<u32>",e.Vector4Uint="vec4<u32>",e.Vector2Int="vec2<i32>",e.Vector3Int="vec3<i32>",e.Vector4Int="vec4<i32>",e.Matrix="Matrix",e.Matrix3x3Float="mat3x3<f32>",e.Matrix4x4Float="mat4x4<i32>",e.Struct="Struct",e.FloatArray="Float[]",e.Vector4FloatArray="vec4<f32>[]"})(Ql||(Ql={}));var jE;(function(e){e.Program="Program",e.Identifier="Identifier",e.VariableDeclaration="VariableDeclaration",e.BlockStatement="BlockStatement",e.ReturnStatement="ReturnStatement",e.FunctionDeclaration="FunctionDeclaration",e.VariableDeclarator="VariableDeclarator",e.AssignmentExpression="AssignmentExpression",e.LogicalExpression="LogicalExpression",e.BinaryExpression="BinaryExpression",e.ArrayExpression="ArrayExpression",e.UnaryExpression="UnaryExpression",e.UpdateExpression="UpdateExpression",e.FunctionExpression="FunctionExpression",e.MemberExpression="MemberExpression",e.ConditionalExpression="ConditionalExpression",e.ExpressionStatement="ExpressionStatement",e.CallExpression="CallExpression",e.NumThreadStatement="NumThreadStatement",e.StorageStatement="StorageStatement",e.DoWhileStatement="DoWhileStatement",e.WhileStatement="WhileStatement",e.ForStatement="ForStatement",e.BreakStatement="BreakStatement",e.ContinueStatement="ContinueStatement",e.IfStatement="IfStatement",e.ImportedFunctionStatement="ImportedFunctionStatement"})(jE||(jE={}));var Jf;(function(e){e.Input="Input",e.Output="Output",e.Uniform="Uniform",e.Workgroup="Workgroup",e.UniformConstant="UniformConstant",e.Image="Image",e.StorageBuffer="StorageBuffer",e.Private="Private",e.Function="Function"})(Jf||(Jf={}));var kv;(function(e){e.GLSL100="GLSL100",e.GLSL450="GLSL450",e.WGSL="WGSL"})(kv||(kv={}));var aA="__DefineValuePlaceholder__";function Sy(e){return typeof e=="number"}function Hc(e){return e===void 0?0:e>360||e<-360?e%360:e}function ed(e,t,n){return Sy(e)?Ce.al(e,t,n):e.length===3?Ce.d9(e):Ce.al(e[0],e[1],e[2])}var HE=function(){function e(t,n){(0,qt.Z)(this,e),this.name=void 0,this.matrix=void 0,this.right=void 0,this.up=void 0,this.forward=void 0,this.position=void 0,this.focalPoint=void 0,this.distanceVector=void 0,this.distance=void 0,this.dollyingStep=void 0,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.name=t,this.matrix=dT(n.matrix),this.right=Ce.d9(n.right),this.up=Ce.d9(n.up),this.forward=Ce.d9(n.forward),this.position=Ce.d9(n.position),this.focalPoint=Ce.d9(n.focalPoint),this.distanceVector=Ce.d9(n.distanceVector),this.azimuth=n.azimuth,this.elevation=n.elevation,this.roll=n.roll,this.relAzimuth=n.relAzimuth,this.relElevation=n.relElevation,this.relRoll=n.relRoll,this.dollyingStep=n.dollyingStep,this.distance=n.distance}return(0,vn.Z)(e,[{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getRoll",value:function(){return this.roll}},{key:"retrieve",value:function(n){n.matrix=my(n.matrix,this.matrix),n.right=Ce.JG(n.right,this.right),n.up=Ce.JG(n.up,this.up),n.forward=Ce.JG(n.forward,this.forward),n.position=Ce.JG(n.position,this.position),n.focalPoint=Ce.JG(n.focalPoint,this.focalPoint),n.distanceVector=Ce.JG(n.distanceVector,this.distanceVector),n.azimuth=this.azimuth,n.elevation=this.elevation,n.roll=this.roll,n.relAzimuth=this.relAzimuth,n.relElevation=this.relElevation,n.relRoll=this.relRoll,n.dollyingStep=this.dollyingStep,n.distance=this.distance}}]),e}(),XE,$E,YE,Ty,KE,JE,qE,Ur;(function(e){e.ORBITING="ORBITING",e.EXPLORING="EXPLORING",e.TRACKING="TRACKING"})(Ur||(Ur={}));var Z0;(function(e){e.DEFAULT="DEFAULT",e.ROTATIONAL="ROTATIONAL",e.TRANSLATIONAL="TRANSLATIONAL",e.CINEMATIC="CINEMATIC"})(Z0||(Z0={}));var td;(function(e){e.ORTHOGRAPHIC="ORTHOGRAPHIC",e.PERSPECTIVE="PERSPECTIVE"})(td||(td={}));var Xc=Math.PI/180,qf=180/Math.PI,QE=(XE=(0,yt.b2)(),$E=(0,yt.f3)(Qe.InteractorService),XE(YE=(Ty=(qE=JE=function(){function e(){(0,qt.Z)(this,e),this.matrix=Io(),this.right=Ce.al(1,0,0),this.up=Ce.al(0,1,0),this.forward=Ce.al(0,0,1),this.position=Ce.al(0,0,1),this.focalPoint=Ce.al(0,0,0),this.distanceVector=Ce.al(0,0,0),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=Infinity,this.minDistance=-Infinity,this.rotateWorld=!1,an(this,"interactor",KE,this),this.fov=30,this.near=.1,this.far=1e4,this.aspect=1,this.left=void 0,this.rright=void 0,this.top=void 0,this.bottom=void 0,this.zoom=1,this.perspective=Io(),this.view=void 0,this.following=void 0,this.type=Ur.EXPLORING,this.trackingMode=Z0.DEFAULT,this.projectionMode=td.PERSPECTIVE,this.frustum=new sT,this.landmarks=[],this.landmarkAnimationID=void 0}return(0,vn.Z)(e,[{key:"clone",value:function(){var n=new e;return n.setType(this.type,void 0),n.interactor=this.interactor,n}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.perspective}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"setType",value:function(n,r){return this.type=n,this.type===Ur.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===Ur.TRACKING&&r!==void 0&&this.setTrackingMode(r),this}},{key:"setProjectionMode",value:function(n){return this.projectionMode=n,this}},{key:"setTrackingMode",value:function(n){if(this.type!==Ur.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=n,this}},{key:"setWorldRotation",value:function(n){this.rotateWorld=n,this._getAngles()}},{key:"getViewTransform",value:function(){return U0(Io(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"setMatrix",value:function(n){return this.matrix=n,this._update(),this}},{key:"setAspect",value:function(n){return this.setPerspective(this.near,this.far,this.fov,n),this}},{key:"setViewOffset",value:function(n,r,i,a,o,s){return this.aspect=n/r,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=n,this.view.fullHeight=r,this.view.offsetX=i,this.view.offsetY=a,this.view.width=o,this.view.height=s,this.projectionMode===td.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===td.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setPerspective",value:function(n,r,i,a){return this.projectionMode=td.PERSPECTIVE,this.fov=i,this.near=n,this.far=r,this.aspect=a,yT(this.perspective,this.fov*Xc,this.aspect,this.near,this.far),this}},{key:"setOrthographic",value:function(n,r,i,a,o,s){this.projectionMode=td.ORTHOGRAPHIC,this.rright=r,this.left=n,this.top=i,this.bottom=a,this.near=o,this.far=s;var c=(this.rright-this.left)/(2*this.zoom),f=(this.top-this.bottom)/(2*this.zoom),d=(this.rright+this.left)/2,h=(this.top+this.bottom)/2,v=d-c,m=d+c,g=h+f,_=h-f;if(this.view!==void 0&&this.view.enabled){var y=(this.rright-this.left)/this.view.fullWidth/this.zoom,E=(this.top-this.bottom)/this.view.fullHeight/this.zoom;v+=y*this.view.offsetX,m=v+y*this.view.width,g-=E*this.view.offsetY,_=g-E*this.view.height}return ET(this.perspective,v,m,g,_,o,s),this}},{key:"setPosition",value:function(n,r,i){return this._setPosition(n,r,i),this.setFocalPoint(this.focalPoint),this}},{key:"setFocalPoint",value:function(n,r,i){var a=Ce.al(0,1,0);if(this.focalPoint=ed(n,r,i),this.trackingMode===Z0.CINEMATIC){var o=Ce.$X(Ce.Ue(),this.focalPoint,this.position);n=o[0],r=o[1],i=o[2];var s=Ce.kE(o),c=Math.asin(r/s)*qf,f=90+Math.atan2(i,n)*qf,d=Io();vT(d,d,f*Xc),hT(d,d,c*Xc),a=Ce.fF(Ce.Ue(),[0,1,0],d)}return U0(this.matrix,bT(Io(),this.position,this.focalPoint,a)),this._getAxes(),this._getDistance(),this._getAngles(),this}},{key:"setDistance",value:function(n){if(!(this.distance===n||n<0)){this.distance=n,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var r=Ce.Ue();n=this.distance;var i=this.forward,a=this.focalPoint;return r[0]=n*i[0]+a[0],r[1]=n*i[1]+a[1],r[2]=n*i[2]+a[2],this._setPosition(r),this}}},{key:"setMaxDistance",value:function(n){return this.maxDistance=n,this}},{key:"setMinDistance",value:function(n){return this.minDistance=n,this}},{key:"changeAzimuth",value:function(n){return this.setAzimuth(this.azimuth+n),this}},{key:"changeElevation",value:function(n){return this.setElevation(this.elevation+n),this}},{key:"changeRoll",value:function(n){return this.setRoll(this.roll+n),this}},{key:"setAzimuth",value:function(n){return this.azimuth=Hc(n),this.computeMatrix(),this._getAxes(),this.type===Ur.ORBITING||this.type===Ur.EXPLORING?this._getPosition():this.type===Ur.TRACKING&&this._getFocalPoint(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(n){return this.elevation=Hc(n),this.computeMatrix(),this._getAxes(),this.type===Ur.ORBITING||this.type===Ur.EXPLORING?this._getPosition():this.type===Ur.TRACKING&&this._getFocalPoint(),this}},{key:"setRoll",value:function(n){return this.roll=Hc(n),this.computeMatrix(),this._getAxes(),this.type===Ur.ORBITING||this.type===Ur.EXPLORING?this._getPosition():this.type===Ur.TRACKING&&this._getFocalPoint(),this}},{key:"rotate",value:function(n,r,i){if(this.type===Ur.EXPLORING){n=Hc(n),r=Hc(r),i=Hc(i);var a=ql(aa(),[1,0,0],(this.rotateWorld?1:-1)*r*Xc),o=ql(aa(),[0,1,0],(this.rotateWorld?1:-1)*n*Xc),s=ql(aa(),[0,0,1],i*Xc),c=Ms(aa(),o,a);c=Ms(aa(),c,s);var f=d_(Io(),c);Nv(this.matrix,this.matrix,[0,0,-this.distance]),Jl(this.matrix,this.matrix,f),Nv(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation+r)>90)return;this.relElevation=Hc(r),this.relAzimuth=Hc(n),this.relRoll=Hc(i),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.computeMatrix()}return this._getAxes(),this.type===Ur.ORBITING||this.type===Ur.EXPLORING?this._getPosition():this.type===Ur.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(n,r){var i=ed(n,r,0),a=Ce.d9(this.position);return Ce.IH(a,a,Ce.bA(Ce.Ue(),this.right,i[0])),Ce.IH(a,a,Ce.bA(Ce.Ue(),this.up,i[1])),this._setPosition(a),this}},{key:"dolly",value:function(n){var r=this.forward,i=Ce.d9(this.position),a=n*this.dollyingStep,o=this.distance+n*this.dollyingStep;return a=Math.max(Math.min(o,this.maxDistance),this.minDistance)-this.distance,i[0]+=a*r[0],i[1]+=a*r[1],i[2]+=a*r[2],this._setPosition(i),this.type===Ur.ORBITING||this.type===Ur.EXPLORING?this._getDistance():this.type===Ur.TRACKING&&Ce.IH(this.focalPoint,i,this.distanceVector),this}},{key:"createLandmark",value:function(n,r){var i=this.clone();i.setPosition(r.position),i.setFocalPoint(r.focalPoint),r.roll!==void 0&&i.setRoll(r.roll);var a=new HE(n,i);return this.landmarks.push(a),a}},{key:"setLandmark",value:function(n){var r=new HE(n,this);return this.landmarks.push(r),this}},{key:"gotoLandmark",value:function(n){var r=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3,a=this.landmarks.find(function(h){return h.name===n});if(a){if(i===0){a.retrieve(this);return}this.landmarkAnimationID!==void 0&&window.cancelAnimationFrame(this.landmarkAnimationID),this.interactor.disconnect();var o=a.getPosition(),s=a.getFocalPoint(),c=a.getRoll(),f,d=function h(v){f===void 0&&(f=v);var m=v-f,g=(1-Math.cos(m/i*Math.PI))/2,_=Ce.Ue(),y=Ce.Ue(),E=0;Ce.t7(_,r.focalPoint,s,g),Ce.t7(y,r.position,o,g),E=r.roll*(1-g)+c*g,r.setFocalPoint(_),r.setPosition(y),r.setRoll(E),r.computeMatrix();var b=Ce.TK(_,s)+Ce.TK(y,o);if(!(b>.01)){r.setFocalPoint(_),r.setPosition(y),r.setRoll(E),r.computeMatrix(),r.interactor.connect();return}m<i&&(r.landmarkAnimationID=window.requestAnimationFrame(h))};window.requestAnimationFrame(d)}}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles()}},{key:"computeMatrix",value:function(){var n,r,i=ql(aa(),[0,0,1],this.roll*Xc);l_(this.matrix),n=ql(aa(),[1,0,0],(this.rotateWorld&&this.type!==Ur.TRACKING||this.type===Ur.TRACKING?1:-1)*this.elevation*Xc),r=ql(aa(),[0,1,0],(this.rotateWorld&&this.type!==Ur.TRACKING||this.type===Ur.TRACKING?1:-1)*this.azimuth*Xc);var a=Ms(aa(),r,n);a=Ms(aa(),a,i);var o=d_(Io(),a);this.type===Ur.ORBITING||this.type===Ur.EXPLORING?(Nv(this.matrix,this.matrix,this.focalPoint),Jl(this.matrix,this.matrix,o),Nv(this.matrix,this.matrix,[0,0,this.distance])):this.type===Ur.TRACKING&&(Nv(this.matrix,this.matrix,this.position),Jl(this.matrix,this.matrix,o))}},{key:"_setPosition",value:function(n,r,i){this.position=ed(n,r,i);var a=this.matrix;a[12]=this.position[0],a[13]=this.position[1],a[14]=this.position[2],a[15]=1}},{key:"_getAxes",value:function(){Ce.JG(this.right,ed(Rv(Cv(),[1,0,0,0],this.matrix))),Ce.JG(this.up,ed(Rv(Cv(),[0,1,0,0],this.matrix))),Ce.JG(this.forward,ed(Rv(Cv(),[0,0,1,0],this.matrix))),Ce.Fv(this.right,this.right),Ce.Fv(this.up,this.up),Ce.Fv(this.forward,this.forward)}},{key:"_getAngles",value:function(){var n=this.distanceVector[0],r=this.distanceVector[1],i=this.distanceVector[2],a=Ce.kE(this.distanceVector);if(a===0){this.elevation=0,this.azimuth=0;return}this.type===Ur.TRACKING?(this.elevation=Math.asin(r/a)*qf,this.azimuth=Math.atan2(-n,-i)*qf):this.rotateWorld?(this.elevation=Math.asin(r/a)*qf,this.azimuth=Math.atan2(-n,-i)*qf):(this.elevation=-Math.asin(r/a)*qf,this.azimuth=-Math.atan2(-n,-i)*qf)}},{key:"_getPosition",value:function(){Ce.JG(this.position,ed(Rv(Cv(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){Ce.kK(this.distanceVector,[0,0,-this.distance],Yl.xO(Yl.Ue(),this.matrix)),Ce.IH(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=Ce.$X(Ce.Ue(),this.focalPoint,this.position),this.distance=Ce.kE(this.distanceVector),this.dollyingStep=this.distance/100}}]),e}(),JE.ProjectionMode={ORTHOGRAPHIC:"ORTHOGRAPHIC",PERSPECTIVE:"PERSPECTIVE"},qE),KE=on(Ty.prototype,"interactor",[$E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ty))||YE),eb,tb,nb,Ay,rb,Fv,ib,Qf=(eb=(0,yt.b2)(),tb=(0,yt.f3)(Qe.GeometryComponentManager),eb(nb=(Ay=(ib=Fv=function(){function e(){(0,qt.Z)(this,e),this.config=void 0,an(this,"geometry",rb,this),this.entity=void 0,this.component=void 0}return(0,vn.Z)(e,[{key:"getEntity",value:function(){return this.entity}},{key:"getComponent",value:function(){return this.component}},{key:"setConfig",value:function(n){this.config=n}},{key:"setEntity",value:function(n){this.entity=n,this.component=this.geometry.create(n),this.component.entity=n,this.onEntityCreated()}},{key:"onEntityCreated",value:function(){}}]),e}(),Fv.BOX="box",Fv.SPHERE="sphere",Fv.PLANE="plane",Fv.MERGED="merged",ib),rb=on(Ay.prototype,"geometry",[tb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ay))||nb),Nt=S(49469);function ab(){if(typeof document!="undefined")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}var oA={}.toString,sA=function(t,n){return oA.call(t)==="[object "+n+"]"},uA=sA,cA=function(e){return Array.isArray?Array.isArray(e):uA(e,"Array")},fA=9007199254740991,lA="[object Arguments]",dA="[object Array]",hA="[object Boolean]",vA="[object Date]",pA="[object Error]",mA="[object Function]",gA="[object Map]",yA="[object Number]",_A="[object Object]",EA="[object RegExp]",bA="[object Set]",wA="[object String]",xA="[object WeakMap]",SA="[object ArrayBuffer]",TA="[object DataView]",AA="[object Float32Array]",IA="[object Float64Array]",CA="[object Int8Array]",RA="[object Int16Array]",MA="[object Int32Array]",NA="[object Uint8Array]",DA="[object Uint8ClampedArray]",PA="[object Uint16Array]",OA="[object Uint32Array]",gi={};gi[AA]=gi[IA]=gi[CA]=gi[RA]=gi[MA]=gi[NA]=gi[DA]=gi[PA]=gi[OA]=!0,gi[lA]=gi[dA]=gi[SA]=gi[hA]=gi[TA]=gi[vA]=gi[pA]=gi[mA]=gi[gA]=gi[yA]=gi[_A]=gi[EA]=gi[bA]=gi[wA]=gi[xA]=!1;function xN(e){return function(t){return e(t)}}var LA=Object.prototype,GA=LA.toString;function kA(e){return UA(e)&&FA(e.length)&&!!gi[GA.call(e)]}function FA(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=fA}function UA(e){return!!e&&(0,_h.Z)(e)==="object"}var ob=kA,sb,ub,cb,fb,j0,lb,db,hb;function vb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function pb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?vb(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var mb=(sb=(0,yt.b2)(),ub=(0,yt.f3)(Qe.RenderEngine),cb=(0,yt.f3)(Qe.ConfigService),sb(fb=(j0=(hb=function(){function e(){(0,qt.Z)(this,e),an(this,"engine",lb,this),an(this,"configService",db,this),this.entity=Qu(),this.model=void 0,this.dirty=!0,this.compiledBundle=void 0,this.initPromise=void 0}return(0,vn.Z)(e,[{key:"init",value:function(){var n=this.configService.get(),r=n.canvas,i=n.engineOptions;this.initPromise=this.engine.init(pb({canvas:r||ab(),swapChainFormat:Nt.EV.BGRA8Unorm,antialiasing:!1},i))}},{key:"setBundle",value:function(n){this.compiledBundle=JSON.parse(JSON.stringify(n))}},{key:"setDispatch",value:function(n){return this.compiledBundle.context&&(this.compiledBundle.context.dispatch=n),this}},{key:"setMaxIteration",value:function(n){return this.compiledBundle.context&&(this.compiledBundle.context.maxIteration=n),this}},{key:"setBinding",value:function(n,r){var i=this;if(typeof n=="string"){var a=Sy(r)||ob(r)||cA(r);if(this.compiledBundle&&this.compiledBundle.context){var o=this.compiledBundle.context.defines.find(function(c){return c.name===n});if(o)return o.value=r,this;var s=this.compiledBundle.context.uniforms.find(function(c){return c.name===n});s&&(a?(s.data=r,s.isReferer=!1,s.storageClass===Jf.Uniform?this.model&&this.model.updateUniform(n,r):this.model&&this.model.updateBuffer(n,r)):(s.isReferer=!0,s.data=r))}}else Object.keys(n).forEach(function(c){i.setBinding(c,n[c])});return this}},{key:"execute",value:function(){var t=(0,Er.Z)(Xt().mark(function r(){var i=this,a,o,s=arguments;return Xt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(a=s.length>0&&s[0]!==void 0?s[0]:1,!this.dirty){f.next=6;break}return this.compiledBundle.context&&(a>1?this.compiledBundle.context.maxIteration=a:this.compiledBundle.context.maxIteration++),f.next=5,this.compile();case 5:this.dirty=!1;case 6:for(this.engine.beginFrame(),this.engine.clear({}),this.compiledBundle.context&&this.compiledBundle.context.uniforms.filter(function(d){var h=d.isReferer;return h}).forEach(function(d){var h=d.data,v=d.name;i.model.confirmInput(h.model,v)}),o=0;o<a;o++)this.model.run();return this.engine.endFrame(),f.abrupt("return",this);case 12:case"end":return f.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"getOutput",value:function(){var t=(0,Er.Z)(Xt().mark(function r(){return Xt().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",this.model.readData());case 1:case"end":return a.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"compile",value:function(){var t=(0,Er.Z)(Xt().mark(function r(){var i,a,o;return Xt().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.initPromise;case 2:return i=pb({},this.compiledBundle.context),a=this.engine.supportWebGPU?this.engine.useWGSL?kv.WGSL:kv.GLSL450:kv.GLSL100,o=this.compiledBundle.shaders[a],i.defines.filter(function(f){return f.runtime}).forEach(function(f){var d="".concat(aA).concat(f.name);o=o.replace(d,"".concat(f.value))}),i.shader=o,i.uniforms.forEach(function(f){if(!f.data&&f.storageClass===Jf.StorageBuffer){var d=1;f.type===Ql.FloatArray?d=1:f.type===Ql.Vector4FloatArray&&(d=4),f.data=new Float32Array(i.output.length*d).fill(0)}}),this.compiledBundle.context=i,c.next=11,this.engine.createComputeModel(this.compiledBundle.context);case 11:this.model=c.sent;case 12:case"end":return c.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()}]),e}(),hb),lb=on(j0.prototype,"engine",[ub],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),db=on(j0.prototype,"configService",[cb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j0))||fb),gb,yb,_b,Iy,Eb,bb,wb,xb=(gb=(0,yt.b2)(),yb=(0,yt.f3)(Qe.MaterialComponentManager),gb(_b=(Iy=(wb=bb=function(){function e(){(0,qt.Z)(this,e),this.config=void 0,an(this,"material",Eb,this),this.entity=void 0,this.component=void 0}return(0,vn.Z)(e,[{key:"getEntity",value:function(){return this.entity}},{key:"getComponent",value:function(){return this.component}},{key:"setConfig",value:function(n){this.config=n}},{key:"setEntity",value:function(n,r){this.entity=n,this.component=this.material.create(n),this.component.entity=n,this.component.type=r,this.onEntityCreated()}},{key:"onEntityCreated",value:function(){}}]),e}(),bb.BASIC="basic",wb),Eb=on(Iy.prototype,"material",[yb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Iy))||_b),Sb,Tb,Ab,Ib,Cb,Rb,Mb,Th,Nb,Db,Pb,Ob,H0,Lb,el=(Sb=(0,yt.b2)(),Tb=(0,yt.f3)(Qe.MeshComponentManager),Ab=(0,yt.f3)(Qe.CullableComponentManager),Ib=(0,yt.f3)(Qe.TransformComponentManager),Cb=(0,yt.f3)(Qe.Systems),Rb=(0,yt.t6)(Qe.SceneGraphSystem),Sb(Mb=(Th=(Lb=H0=function(){function e(){(0,qt.Z)(this,e),this.attributes={},this.config=void 0,an(this,"mesh",Nb,this),an(this,"cullable",Db,this),an(this,"transform",Pb,this),an(this,"sceneGraphSystem",Ob,this),this.meshComponent=void 0,this.transformComponent=void 0,this.entity=void 0}return(0,vn.Z)(e,[{key:"getEntity",value:function(){return this.entity}},{key:"getTransformComponent",value:function(){return this.transformComponent}},{key:"getMeshComponent",value:function(){return this.meshComponent}},{key:"setConfig",value:function(n){this.config=n}},{key:"setEntity",value:function(n){this.entity=n,this.cullable.create(n),this.meshComponent=this.mesh.create(n),this.transformComponent=this.transform.create(n),this.onEntityCreated()}},{key:"setMaterial",value:function(n){return this.meshComponent.material=n,this}},{key:"setGeometry",value:function(n){return this.meshComponent.geometry=n,this}},{key:"setAttributes",value:function(n){var r=this;Object.keys(n).forEach(function(i){n[i]!==void 0&&n[i]!==r.attributes[i]&&(r.onAttributeChanged({name:i,data:n[i]}),r.attributes[i]=n[i])})}},{key:"setVisible",value:function(n){var r=this;return this.meshComponent.visible=n,this.meshComponent.children.forEach(function(i){var a=r.mesh.getComponentByEntity(i);a&&(a.visible=n)}),this}},{key:"isVisible",value:function(){return this.meshComponent.visible}},{key:"attach",value:function(n){return this.sceneGraphSystem.attach(this.entity,n.entity),this}},{key:"detach",value:function(){return this.sceneGraphSystem.detach(this.entity),this}},{key:"detachChildren",value:function(){return this.sceneGraphSystem.detachChildren(this.entity),this}},{key:"onEntityCreated",value:function(){}},{key:"onAttributeChanged",value:function(n){var r=n.name,i=n.data;this.meshComponent&&this.meshComponent.material&&this.meshComponent.material.setUniform(this.convertAttributeName2UniformName(r),i)}},{key:"convertAttributeName2UniformName",value:function(n){return n}}]),e}(),H0.POINT="point",H0.LINE="line",H0.GRID="grid",Lb),Nb=on(Th.prototype,"mesh",[Tb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Db=on(Th.prototype,"cullable",[Ab],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pb=on(Th.prototype,"transform",[Ib],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ob=on(Th.prototype,"sceneGraphSystem",[Cb,Rb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Th))||Mb),BA=S(81550),zA=S.n(BA),WA=function(){function e(t,n){(0,qt.Z)(this,e),this.attribute=void 0,this.buffer=void 0;var r=n.buffer,i=n.offset,a=n.stride,o=n.normalized,s=n.size,c=n.divisor;this.buffer=r,this.attribute={buffer:r.get(),offset:i||0,stride:a||0,normalized:o||!1,divisor:c||0},s&&(this.attribute.size=s)}return(0,vn.Z)(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(n){this.buffer.subData(n)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),$c,Uv,Yc,Ns,Bv,tl,zv,X0,tc,nd,Ma,nc,rc,$0,VA=($c={},(0,ze.Z)($c,ve.POINTS,"points"),(0,ze.Z)($c,ve.LINES,"lines"),(0,ze.Z)($c,ve.LINE_LOOP,"line loop"),(0,ze.Z)($c,ve.LINE_STRIP,"line strip"),(0,ze.Z)($c,ve.TRIANGLES,"triangles"),(0,ze.Z)($c,ve.TRIANGLE_FAN,"triangle fan"),(0,ze.Z)($c,ve.TRIANGLE_STRIP,"triangle strip"),$c),Gb=(Uv={},(0,ze.Z)(Uv,ve.STATIC_DRAW,"static"),(0,ze.Z)(Uv,ve.DYNAMIC_DRAW,"dynamic"),(0,ze.Z)(Uv,ve.STREAM_DRAW,"stream"),Uv),Cy=(Yc={},(0,ze.Z)(Yc,ve.BYTE,"int8"),(0,ze.Z)(Yc,ve.UNSIGNED_INT,"int16"),(0,ze.Z)(Yc,ve.INT,"int32"),(0,ze.Z)(Yc,ve.UNSIGNED_BYTE,"uint8"),(0,ze.Z)(Yc,ve.UNSIGNED_SHORT,"uint16"),(0,ze.Z)(Yc,ve.UNSIGNED_INT,"uint32"),(0,ze.Z)(Yc,ve.FLOAT,"float"),Yc),ZA=(Ns={},(0,ze.Z)(Ns,ve.ALPHA,"alpha"),(0,ze.Z)(Ns,ve.LUMINANCE,"luminance"),(0,ze.Z)(Ns,ve.LUMINANCE_ALPHA,"luminance alpha"),(0,ze.Z)(Ns,ve.RGB,"rgb"),(0,ze.Z)(Ns,ve.RGBA,"rgba"),(0,ze.Z)(Ns,ve.RGBA4,"rgba4"),(0,ze.Z)(Ns,ve.RGB5_A1,"rgb5 a1"),(0,ze.Z)(Ns,ve.RGB565,"rgb565"),(0,ze.Z)(Ns,ve.DEPTH_COMPONENT,"depth"),(0,ze.Z)(Ns,ve.DEPTH_STENCIL,"depth stencil"),Ns),jA=(Bv={},(0,ze.Z)(Bv,ve.DONT_CARE,"dont care"),(0,ze.Z)(Bv,ve.NICEST,"nice"),(0,ze.Z)(Bv,ve.FASTEST,"fast"),Bv),kb=(tl={},(0,ze.Z)(tl,ve.NEAREST,"nearest"),(0,ze.Z)(tl,ve.LINEAR,"linear"),(0,ze.Z)(tl,ve.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,ze.Z)(tl,ve.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,ze.Z)(tl,ve.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,ze.Z)(tl,ve.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),tl),Fb=(zv={},(0,ze.Z)(zv,ve.REPEAT,"repeat"),(0,ze.Z)(zv,ve.CLAMP_TO_EDGE,"clamp"),(0,ze.Z)(zv,ve.MIRRORED_REPEAT,"mirror"),zv),HA=(X0={},(0,ze.Z)(X0,ve.NONE,"none"),(0,ze.Z)(X0,ve.BROWSER_DEFAULT_WEBGL,"browser"),X0),XA=(tc={},(0,ze.Z)(tc,ve.NEVER,"never"),(0,ze.Z)(tc,ve.ALWAYS,"always"),(0,ze.Z)(tc,ve.LESS,"less"),(0,ze.Z)(tc,ve.LEQUAL,"lequal"),(0,ze.Z)(tc,ve.GREATER,"greater"),(0,ze.Z)(tc,ve.GEQUAL,"gequal"),(0,ze.Z)(tc,ve.EQUAL,"equal"),(0,ze.Z)(tc,ve.NOTEQUAL,"notequal"),tc),Ub=(nd={},(0,ze.Z)(nd,ve.FUNC_ADD,"add"),(0,ze.Z)(nd,ve.MIN_EXT,"min"),(0,ze.Z)(nd,ve.MAX_EXT,"max"),(0,ze.Z)(nd,ve.FUNC_SUBTRACT,"subtract"),(0,ze.Z)(nd,ve.FUNC_REVERSE_SUBTRACT,"reverse subtract"),nd),Y0=(Ma={},(0,ze.Z)(Ma,ve.ZERO,"zero"),(0,ze.Z)(Ma,ve.ONE,"one"),(0,ze.Z)(Ma,ve.SRC_COLOR,"src color"),(0,ze.Z)(Ma,ve.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,ze.Z)(Ma,ve.SRC_ALPHA,"src alpha"),(0,ze.Z)(Ma,ve.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,ze.Z)(Ma,ve.DST_COLOR,"dst color"),(0,ze.Z)(Ma,ve.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,ze.Z)(Ma,ve.DST_ALPHA,"dst alpha"),(0,ze.Z)(Ma,ve.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,ze.Z)(Ma,ve.CONSTANT_COLOR,"constant color"),(0,ze.Z)(Ma,ve.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,ze.Z)(Ma,ve.CONSTANT_ALPHA,"constant alpha"),(0,ze.Z)(Ma,ve.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,ze.Z)(Ma,ve.SRC_ALPHA_SATURATE,"src alpha saturate"),Ma),$A=(nc={},(0,ze.Z)(nc,ve.NEVER,"never"),(0,ze.Z)(nc,ve.ALWAYS,"always"),(0,ze.Z)(nc,ve.LESS,"less"),(0,ze.Z)(nc,ve.LEQUAL,"lequal"),(0,ze.Z)(nc,ve.GREATER,"greater"),(0,ze.Z)(nc,ve.GEQUAL,"gequal"),(0,ze.Z)(nc,ve.EQUAL,"equal"),(0,ze.Z)(nc,ve.NOTEQUAL,"notequal"),nc),Ah=(rc={},(0,ze.Z)(rc,ve.ZERO,"zero"),(0,ze.Z)(rc,ve.KEEP,"keep"),(0,ze.Z)(rc,ve.REPLACE,"replace"),(0,ze.Z)(rc,ve.INVERT,"invert"),(0,ze.Z)(rc,ve.INCR,"increment"),(0,ze.Z)(rc,ve.DECR,"decrement"),(0,ze.Z)(rc,ve.INCR_WRAP,"increment wrap"),(0,ze.Z)(rc,ve.DECR_WRAP,"decrement wrap"),rc),YA=($0={},(0,ze.Z)($0,ve.FRONT,"front"),(0,ze.Z)($0,ve.BACK,"back"),$0),KA=function(){function e(t,n){(0,qt.Z)(this,e),this.buffer=void 0;var r=n.data,i=n.usage,a=n.type;this.buffer=t.buffer({data:r,usage:Gb[i||ve.STATIC_DRAW],type:Cy[a||ve.UNSIGNED_BYTE]})}return(0,vn.Z)(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){}},{key:"subData",value:function(n){var r=n.data,i=n.offset;this.buffer.subdata(r,i)}}]),e}(),Vi=S(85061),JA=9007199254740991,qA="[object Arguments]",QA="[object Array]",eI="[object Boolean]",tI="[object Date]",nI="[object Error]",rI="[object Function]",iI="[object Map]",aI="[object Number]",oI="[object Object]",sI="[object RegExp]",uI="[object Set]",cI="[object String]",fI="[object WeakMap]",lI="[object ArrayBuffer]",dI="[object DataView]",hI="[object Float32Array]",vI="[object Float64Array]",pI="[object Int8Array]",mI="[object Int16Array]",gI="[object Int32Array]",yI="[object Uint8Array]",_I="[object Uint8ClampedArray]",EI="[object Uint16Array]",bI="[object Uint32Array]",yi={};yi[hI]=yi[vI]=yi[pI]=yi[mI]=yi[gI]=yi[yI]=yi[_I]=yi[EI]=yi[bI]=!0,yi[qA]=yi[QA]=yi[lI]=yi[eI]=yi[dI]=yi[tI]=yi[nI]=yi[rI]=yi[iI]=yi[aI]=yi[oI]=yi[sI]=yi[uI]=yi[cI]=yi[fI]=!1;function SN(e){return function(t){return e(t)}}var wI=Object.prototype,xI=wI.toString;function SI(e){return AI(e)&&TI(e.length)&&!!yi[xI.call(e)]}function TI(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=JA}function AI(e){return!!e&&(0,_h.Z)(e)==="object"}var Ry=SI;function Bb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function zb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Bb(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var II=`attribute vec3 a_Position;
attribute vec2 a_TexCoord;

varying vec2 v_TexCoord;

void main() {
  gl_Position = vec4(a_Position, 1.0);
  v_TexCoord = a_TexCoord;
}`,Wb=0,K0=!1,CI=function(){function e(t,n){var r=this;(0,qt.Z)(this,e),this.reGl=t,this.context=n,this.entity=Qu(),this.texFBO=void 0,this.computeCommand=void 0,this.textureCache={},this.outputTextureName=void 0,this.swapOutputTextureName=void 0,this.compiledPingpong=void 0,this.dynamicPingpong=void 0;var i={};this.context.uniforms.forEach(function(f){var d=f.name,h=f.type,v=f.data,m=f.isReferer,g=f.storageClass;if(g===Jf.StorageBuffer){if(m)r.textureCache[d]={data:void 0},i["".concat(d,"Size")]=function(){return v.compiledBundle.context.output.textureSize};else{r.textureCache[d]=r.calcDataTexture(d,h,v);var _=r.textureCache[d],y=_.textureWidth,E=_.isOutput;i["".concat(d,"Size")]=[y,y],E&&(r.outputTextureName=d,r.context.needPingpong&&(r.outputTextureName="".concat(d,"Output"),r.textureCache[r.outputTextureName]=r.calcDataTexture(d,h,v)))}i[d]=function(){return K0&&console.log("[".concat(r.entity,"]: ").concat(d," ").concat(r.textureCache[d].id)),r.textureCache[d].texture}}else if(g===Jf.Uniform){if(v&&(Array.isArray(v)||Ry(v))&&v.length>16)throw new Error("invalid data type ".concat(h));i[d]=function(){return f.data}}});var a=this.getOuputDataTexture(),o=a.textureWidth,s=a.texelCount;i.u_OutputTextureSize=[o,o],i.u_OutputTexelCount=s,this.context.output.textureSize=[o,o];var c={attributes:{a_Position:[[-1,1,0],[-1,-1,0],[1,1,0],[1,-1,0]],a_TexCoord:[[0,1],[0,0],[1,1],[1,0]]},frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(this.context.shader),uniforms:i,vert:II,primitive:"triangle strip",count:4};this.computeCommand=this.reGl(c)}return(0,vn.Z)(e,[{key:"run",value:function(){var n=this;this.context.maxIteration>1&&this.context.needPingpong&&(this.compiledPingpong=!0),(this.compiledPingpong||this.dynamicPingpong)&&this.swap(),this.texFBO=this.reGl.framebuffer({color:this.getOuputDataTexture().texture}),this.texFBO.use(function(){n.computeCommand()}),K0&&console.log("[".concat(this.entity,"]: output ").concat(this.getOuputDataTexture().id))}},{key:"readData",value:function(){var t=(0,Er.Z)(Xt().mark(function r(){var i=this,a,o,s,c,f,d,h,v;return Xt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(this.reGl({framebuffer:this.texFBO})(function(){a=i.reGl.read()}),!a){g.next=6;break}if(o=this.getOuputDataTexture(),s=o.originalDataLength,c=o.elementsPerTexel,f=o.typedArrayConstructor,d=f===void 0?Float32Array:f,h=[],c!==4)for(v=0;v<a.length;v+=4)c===1?h.push(a[v]):c===2?h.push(a[v],a[v+1]):h.push(a[v],a[v+1],a[v+2]);else h=a;return g.abrupt("return",new d(h.slice(0,s)));case 6:return g.abrupt("return",new Float32Array);case 7:case"end":return g.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"confirmInput",value:function(n,r){var i;this.entity===n.entity?(this.dynamicPingpong=!0,i=this):i=n,this.textureCache[r].id=i.getOuputDataTexture().id,this.textureCache[r].texture=i.getOuputDataTexture().texture,K0&&console.log("[".concat(this.entity,"]: confirm input ").concat(r," from model ").concat(i.entity,", ").concat(i.getOuputDataTexture().id))}},{key:"updateUniform",value:function(){}},{key:"updateBuffer",value:function(n,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=this.context.uniforms.find(function(f){var d=f.name;return d===n});if(a){var o=this.calcDataTexture(n,a.type,r),s=o.texture,c=o.data;this.textureCache[n].data=c,this.textureCache[n].texture=s}}},{key:"destroy",value:function(){}},{key:"swap",value:function(){if(this.swapOutputTextureName||this.createSwapOutputDataTexture(),this.compiledPingpong){var n=this.context.output.name;this.textureCache[n].id=this.getOuputDataTexture().id,this.textureCache[n].texture=this.getOuputDataTexture().texture}var r=this.outputTextureName;this.outputTextureName=this.swapOutputTextureName,this.swapOutputTextureName=r,K0&&console.log("[".concat(this.entity,"]: after swap, output ").concat(this.getOuputDataTexture().id))}},{key:"getOuputDataTexture",value:function(){return this.textureCache[this.outputTextureName]}},{key:"createSwapOutputDataTexture",value:function(){var n=this.cloneDataTexture(this.getOuputDataTexture());this.swapOutputTextureName="".concat(this.entity,"-swap"),this.textureCache[this.swapOutputTextureName]=n}},{key:"cloneDataTexture",value:function(n){var r=n.data,i=n.textureWidth;return zb(zb({},n),{},{id:Wb++,texture:this.reGl.texture({width:i,height:i,data:r,type:"float"})})}},{key:"calcDataTexture",value:function(n,r,i){var a=1;r===Ql.Vector4FloatArray&&(a=4);for(var o=[],s=0;s<i.length;s+=a)a===1?o.push(i[s],0,0,0):a===2?o.push(i[s],i[s+1],0,0):a===3?o.push(i[s],i[s+1],i[s+2],0):a===4&&o.push(i[s],i[s+1],i[s+2],i[s+3]);var c=i.length,f=Math.ceil(c/a),d=Math.ceil(Math.sqrt(f)),h=d*d;f<h&&o.push.apply(o,(0,Vi.Z)(new Array((h-f)*4).fill(0)));var v=this.reGl.texture({width:d,height:d,data:o,type:"float"});return{id:Wb++,data:o,originalDataLength:c,typedArrayConstructor:Ry(i)?i.constructor:void 0,textureWidth:d,texture:v,texelCount:f,elementsPerTexel:a,isOutput:n===this.context.output.name}}}]),e}(),RI=function(){function e(t,n){(0,qt.Z)(this,e),this.elements=void 0;var r=n.data,i=n.usage,a=n.type,o=n.count;this.elements=t.elements({data:r,usage:Gb[i||ve.STATIC_DRAW],type:Cy[a||ve.UNSIGNED_BYTE],count:o})}return(0,vn.Z)(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(n){var r=n.data;this.elements.subdata(r)}},{key:"destroy",value:function(){this.elements.destroy()}}]),e}(),MI=function(){function e(t,n){(0,qt.Z)(this,e),this.framebuffer=void 0;var r=n.width,i=n.height,a=n.color,o=n.colors,s=n.depth,c=n.stencil,f={width:r,height:i};Array.isArray(o)&&(f.colors=o.map(function(d){return d.get()})),a&&typeof a!="boolean"&&(f.color=a.get()),this.framebuffer=t.framebuffer(f)}return(0,vn.Z)(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(n){var r=n.width,i=n.height;this.framebuffer.resize(r,i)}}]),e}();function NI(e){var t=(0,_h.Z)(e);return e!=null&&(t==="object"||t==="function")}function Wv(e){var t={};return Object.keys(e).forEach(function(n){My(n,e[n],t,"")}),t}function My(e,t,n,r){if(t===null||typeof t=="number"||typeof t=="boolean"||Array.isArray(t)&&typeof t[0]=="number"||Ry(t)||t===""||t.resize!==void 0){n["".concat(r&&r+".").concat(e)]=t;return}NI(t)&&Object.keys(t).forEach(function(i){My(i,t[i],n,"".concat(r&&r+".").concat(e))}),Array.isArray(t)&&t.forEach(function(i,a){Object.keys(i).forEach(function(o){My(o,i[o],n,"".concat(r&&r+".").concat(e,"[").concat(a,"]"))})})}function Vb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Ih(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Vb(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var DI=function(){function e(t,n){(0,qt.Z)(this,e),this.reGl=void 0,this.drawCommand=void 0,this.uniforms={},this.reGl=t;var r=n.vs,i=n.fs,a=n.defines,o=n.attributes,s=n.uniforms,c=n.primitive,f=n.count,d=n.elements,h=n.depth,v=n.blend,m=n.stencil,g=n.cull,_=n.instances,y=n.scissor,E=n.viewport,b={};s&&(this.uniforms=Wv(s),Object.keys(s).forEach(function(z){b[z]=t.prop(z)}));var A={};Object.keys(o).forEach(function(z){A[z]=o[z].get()});var C=a&&this.generateDefines(a)||"",R={attributes:A,frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(C,`
`).concat(i),uniforms:b,vert:`
`.concat(C,`
`).concat(r),primitive:VA[c===void 0?ve.TRIANGLES:c]};_&&(R.instances=_),f&&(R.count=f),d&&(R.elements=d.get()),y&&(R.scissor=y),E&&(R.viewport=E),this.initDepthDrawParams({depth:h},R),this.initBlendDrawParams({blend:v},R),this.initStencilDrawParams({stencil:m},R),this.initCullDrawParams({cull:g},R),this.drawCommand=t(R)}return(0,vn.Z)(e,[{key:"addUniforms",value:function(n){this.uniforms=Ih(Ih({},this.uniforms),Wv(n))}},{key:"draw",value:function(n){var r=Ih(Ih({},this.uniforms),Wv(n.uniforms||{})),i={};Object.keys(r).forEach(function(a){var o=(0,_h.Z)(r[a]);o==="boolean"||o==="number"||Array.isArray(r[a])||r[a].BYTES_PER_ELEMENT?i[a]=r[a]:o==="string"||(i[a]=r[a].get())}),this.drawCommand(i)}},{key:"destroy",value:function(){}},{key:"initDepthDrawParams",value:function(n,r){var i=n.depth;i&&(r.depth={enable:i.enable===void 0?!0:!!i.enable,mask:i.mask===void 0?!0:!!i.mask,func:XA[i.func||ve.LESS],range:i.range||[0,1]})}},{key:"initBlendDrawParams",value:function(n,r){var i=n.blend;if(i){var a=i.enable,o=i.func,s=i.equation,c=i.color,f=c===void 0?[0,0,0,0]:c;r.blend={enable:!!a,func:{srcRGB:Y0[o&&o.srcRGB||ve.SRC_ALPHA],srcAlpha:Y0[o&&o.srcAlpha||ve.SRC_ALPHA],dstRGB:Y0[o&&o.dstRGB||ve.ONE_MINUS_SRC_ALPHA],dstAlpha:Y0[o&&o.dstAlpha||ve.ONE_MINUS_SRC_ALPHA]},equation:{rgb:Ub[s&&s.rgb||ve.FUNC_ADD],alpha:Ub[s&&s.alpha||ve.FUNC_ADD]},color:f}}}},{key:"initStencilDrawParams",value:function(n,r){var i=n.stencil;if(i){var a=i.enable,o=i.mask,s=o===void 0?-1:o,c=i.func,f=c===void 0?{cmp:ve.ALWAYS,ref:0,mask:-1}:c,d=i.opFront,h=d===void 0?{fail:ve.KEEP,zfail:ve.KEEP,zpass:ve.KEEP}:d,v=i.opBack,m=v===void 0?{fail:ve.KEEP,zfail:ve.KEEP,zpass:ve.KEEP}:v;r.stencil={enable:!!a,mask:s,func:Ih(Ih({},f),{},{cmp:$A[f.cmp]}),opFront:{fail:Ah[h.fail],zfail:Ah[h.zfail],zpass:Ah[h.zpass]},opBack:{fail:Ah[m.fail],zfail:Ah[m.zfail],zpass:Ah[m.zpass]}}}}},{key:"initCullDrawParams",value:function(n,r){var i=n.cull;if(i){var a=i.enable,o=i.face,s=o===void 0?ve.BACK:o;r.cull={enable:!!a,face:YA[s]}}}},{key:"generateDefines",value:function(n){return Object.keys(n).map(function(r){return"#define ".concat(r," ").concat(Number(n[r]))}).join(`
`)}}]),e}(),PI=function(){function e(t,n){(0,qt.Z)(this,e),this.texture=void 0,this.width=void 0,this.height=void 0;var r=n.data,i=n.type,a=i===void 0?ve.UNSIGNED_BYTE:i,o=n.width,s=n.height,c=n.flipY,f=c===void 0?!1:c,d=n.format,h=d===void 0?ve.RGBA:d,v=n.mipmap,m=v===void 0?!1:v,g=n.wrapS,_=g===void 0?ve.CLAMP_TO_EDGE:g,y=n.wrapT,E=y===void 0?ve.CLAMP_TO_EDGE:y,b=n.aniso,A=b===void 0?0:b,C=n.alignment,R=C===void 0?1:C,z=n.premultiplyAlpha,ee=z===void 0?!1:z,Q=n.mag,re=Q===void 0?ve.NEAREST:Q,de=n.min,Ie=de===void 0?ve.NEAREST:de,ie=n.colorSpace,ke=ie===void 0?ve.BROWSER_DEFAULT_WEBGL:ie;this.width=o,this.height=s;var Ve={width:o,height:s,type:Cy[a],format:ZA[h],wrapS:Fb[_],wrapT:Fb[E],mag:kb[re],min:kb[Ie],alignment:R,flipY:f,colorSpace:HA[ke],premultiplyAlpha:ee,aniso:A};r&&(Ve.data=r),typeof m=="number"?Ve.mipmap=jA[m]:typeof m=="boolean"&&(Ve.mipmap=m),this.texture=t.texture(Ve)}return(0,vn.Z)(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(n){var r=n.width,i=n.height;this.texture.resize(r,i),this.width=r,this.height=i}},{key:"destroy",value:function(){this.texture.destroy()}}]),e}(),Zb,jb,Hb,OI=(Zb=(0,yt.b2)(),Zb(jb=(Hb=function(){function e(){var t=this;(0,qt.Z)(this,e),this.supportWebGPU=!1,this.useWGSL=!1,this.$canvas=void 0,this.gl=void 0,this.inited=void 0,this.createModel=function(){var n=(0,Er.Z)(Xt().mark(function r(i){return Xt().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!i.uniforms){o.next=3;break}return o.next=3,Promise.all(Object.keys(i.uniforms).map(function(){var s=(0,Er.Z)(Xt().mark(function c(f){var d;return Xt().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!(i.uniforms[f]&&i.uniforms[f].load!==void 0)){v.next=5;break}return v.next=3,i.uniforms[f].load();case 3:d=v.sent,i.uniforms[f]=d;case 5:case"end":return v.stop()}},c)}));return function(c){return s.apply(this,arguments)}}()));case 3:return o.abrupt("return",new DI(t.gl,i));case 4:case"end":return o.stop()}},r)}));return function(r){return n.apply(this,arguments)}}(),this.createAttribute=function(n){return new WA(t.gl,n)},this.createBuffer=function(n){return new KA(t.gl,n)},this.createElements=function(n){return new RI(t.gl,n)},this.createTexture2D=function(n){return new PI(t.gl,n)},this.createFramebuffer=function(n){return new MI(t.gl,n)},this.useFramebuffer=function(n,r){t.gl({framebuffer:n?n.get():null})(r)},this.createComputeModel=function(){var n=(0,Er.Z)(Xt().mark(function r(i){return Xt().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",new CI(t.gl,i));case 1:case"end":return o.stop()}},r)}));return function(r){return n.apply(this,arguments)}}(),this.clear=function(n){var r=n.color,i=n.depth,a=n.stencil,o=n.framebuffer,s=o===void 0?null:o,c={color:r,depth:i,stencil:a};c.framebuffer=s===null?s:s.get(),t.gl.clear(c)},this.setScissor=function(n){t.gl&&t.gl._gl&&(n.enable&&n.box?(t.gl._gl.enable(ve.SCISSOR_TEST),t.gl._gl.scissor(n.box.x,n.box.y,n.box.width,n.box.height)):t.gl._gl.disable(ve.SCISSOR_TEST),t.gl._refresh())},this.viewport=function(n){var r=n.x,i=n.y,a=n.width,o=n.height;t.gl&&t.gl._gl&&(t.gl._gl.viewport(r,i,a,o),t.gl._refresh())},this.readPixels=function(n){var r=n.framebuffer,i=n.x,a=n.y,o=n.width,s=n.height,c={x:i,y:a,width:o,height:s};return r&&(c.framebuffer=r.get()),t.gl.read(c)},this.getCanvas=function(){return t.$canvas},this.getGLContext=function(){return t.gl._gl},this.destroy=function(){t.gl&&(t.gl.destroy(),t.inited=!1)}}return(0,vn.Z)(e,[{key:"init",value:function(){var t=(0,Er.Z)(Xt().mark(function r(i){return Xt().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!this.inited){o.next=2;break}return o.abrupt("return");case 2:return this.$canvas=i.canvas,o.next=5,new Promise(function(s,c){zA()({canvas:i.canvas,attributes:{alpha:!0,antialias:i.antialias,premultipliedAlpha:!0},pixelRatio:1,extensions:["OES_element_index_uint","OES_texture_float","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(d,h){(d||!h)&&c(d),s(h)}})});case 5:this.gl=o.sent,this.inited=!0;case 7:case"end":return o.stop()}},r,this)}));function n(r){return t.apply(this,arguments)}return n}()},{key:"isFloatSupported",value:function(){return this.gl.limits.readFloat}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),e}(),Hb))||jb);function LI(){return typeof window!="undefined"}function GI(e,t,n,r){if(!!LI()){var i=document.getElementsByTagName("head")[0],a=document.createElement("script");a.setAttribute("type","text/javascript"),a.setAttribute("src",e),r&&(a.id=r),a.onload=function(){t&&t()},a.onerror=function(o){n&&n("Unable to load script '".concat(e,"'"),o)},i.appendChild(a)}}function kI(e,t){return new Promise(function(n,r){GI(e,function(){n()},function(i,a){r(a)})})}var J0;function FI(){return Ny.apply(this,arguments)}function Ny(){return Ny=(0,Er.Z)(Xt().mark(function e(){return Xt().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!J0){n.next=2;break}return n.abrupt("return",J0);case 2:return n.next=4,kI("https://preview.babylonjs.com/glslang/glslang.js");case 4:return J0=window.glslang("https://preview.babylonjs.com/glslang/glslang.wasm"),n.abrupt("return",J0);case 6:case"end":return n.stop()}},e)})),Ny.apply(this,arguments)}var UI=function(){function e(t,n){(0,qt.Z)(this,e),this.engine=t,this.options=n,this.attribute=void 0,this.buffer=void 0;var r=n,i=r.buffer,a=r.offset,o=r.stride,s=r.normalized,c=r.size,f=r.divisor,d=r.arrayStride,h=r.attributes,v=r.stepMode;this.buffer=i,this.attribute={buffer:i.get(),offset:a||0,stride:o||0,normalized:s||!1,divisor:f||0,arrayStride:d||0,attributes:h,stepMode:v||"vertex"},c&&(this.attribute.size=c)}return(0,vn.Z)(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(n){this.buffer.subData(n)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),Ch=function(){function e(t,n){(0,qt.Z)(this,e),this.engine=t,this.options=n,this.buffer=void 0;var r=n,i=r.data,a=r.usage,o=r.type;this.buffer=this.createBuffer(i instanceof Array?new Float32Array(i):i,a||Nt.FB.Vertex|Nt.FB.CopyDst)}return(0,vn.Z)(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(n){var r=n.data,i=n.offset;this.setSubData(this.buffer,i,r instanceof Array?new Float32Array(r):r)}},{key:"createBuffer",value:function(n,r){var i=n.byteLength%4,a={size:n.byteLength+i,usage:r},o=this.engine.device.createBuffer(a);return this.setSubData(o,0,n),o}},{key:"setSubData",value:function(n,r,i){var a=Co?this.engine.device.getQueue():this.engine.device.defaultQueue;a.writeBuffer(n,r,i)}}]),e}();function BI(e){return typeof e=="number"}var zI=function(){function e(t,n){(0,qt.Z)(this,e),this.engine=t,this.context=n,this.entity=Qu(),this.uniformGPUBufferLayout=[],this.uniformBuffer=void 0,this.vertexBuffers={},this.outputBuffer=void 0,this.bindGroupEntries=void 0,this.bindGroup=void 0,this.computePipeline=void 0}return(0,vn.Z)(e,[{key:"init",value:function(){var t=(0,Er.Z)(Xt().mark(function r(){var i=this,a,o,s,c,f,d,h;return Xt().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.compileComputePipelineStageDescriptor(this.context.shader);case 2:a=m.sent,o=a.computeStage,s=this.context.uniforms.filter(function(g){return g.storageClass===Jf.StorageBuffer}),c=this.context.uniforms.filter(function(g){return g.storageClass===Jf.Uniform}),f=c.length?1:0,this.bindGroupEntries=[],f&&(d=0,h=[],c.forEach(function(g){if(BI(g.data))i.uniformGPUBufferLayout.push({name:g.name,offset:d}),d+=4,h.push(g.data);else{var _,y=((_=g.data)===null||_===void 0?void 0:_.length)||1;y===3&&(y=4,g.data.push(0));var E=d/4%4;if(E>0){var b=4-E;if(y>1&&y<=b)y===2&&(b===3&&(d+=4,h.push(0)),h.push.apply(h,(0,Vi.Z)(g.data)),i.uniformGPUBufferLayout.push({name:g.name,offset:d}));else{for(var A=0;A<b;A++)d+=4,h.push(0);h.push.apply(h,(0,Vi.Z)(g.data)),i.uniformGPUBufferLayout.push({name:g.name,offset:d})}}d+=4*y}}),this.uniformBuffer=new Ch(this.engine,{data:h instanceof Array?new Float32Array(h):h,usage:Nt.FB.Uniform|Nt.FB.CopyDst}),this.bindGroupEntries.push({binding:0,resource:{buffer:this.uniformBuffer.get()}})),s.forEach(function(g){if(g.data!==null&&(g.type===Ql.Vector4FloatArray||g.type===Ql.FloatArray)){var _;g.name===i.context.output.name?(_=new Ch(i.engine,{data:isFinite(Number(g.data))?[g.data]:g.data,usage:Nt.FB.Storage|Nt.FB.CopyDst|Nt.FB.CopySrc}),i.outputBuffer=_,i.context.output={name:g.name,length:isFinite(Number(g.data))?1:g.data.length,typedArrayConstructor:Float32Array,gpuBuffer:_.get()}):g.isReferer?g.data.model&&g.data.model.outputBuffer&&(_=g.data.model.outputBuffer):_=new Ch(i.engine,{data:isFinite(Number(g.data))?[g.data]:g.data,usage:Nt.FB.Storage|Nt.FB.CopyDst|Nt.FB.CopySrc}),i.vertexBuffers[g.name]=_,i.bindGroupEntries.push({binding:f,resource:{name:g.name,refer:_?void 0:g.data,buffer:_?_.get():void 0}}),f++}}),this.computePipeline=this.engine.device.createComputePipeline({computeStage:o}),console.log(this.bindGroupEntries),this.bindGroup=this.engine.device.createBindGroup({layout:this.computePipeline.getBindGroupLayout(0),entries:this.bindGroupEntries});case 13:case"end":return m.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"destroy",value:function(){var n=this;this.uniformBuffer&&this.uniformBuffer.destroy(),Object.keys(this.vertexBuffers).forEach(function(r){return n.vertexBuffers[r].destroy()})}},{key:"readData",value:function(){var t=(0,Er.Z)(Xt().mark(function r(){var i,a,o,s,c,f,d,h,v,m;return Xt().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(i=this.context.output,!i){_.next=16;break}if(a=i.length,o=i.typedArrayConstructor,s=i.gpuBuffer,!s){_.next=16;break}return c=a*o.BYTES_PER_ELEMENT,f=this.engine.device.createBuffer({size:c,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),d=this.engine.device.createCommandEncoder(),d.copyBufferToBuffer(s,0,f,0,c),h=Co?this.engine.device.getQueue():this.engine.device.defaultQueue,h.submit([d.finish()]),_.next=12,f.mapAsync(Nt.gc.Read);case 12:return v=f.getMappedRange(),m=new o(v.slice(0)),f.unmap(),_.abrupt("return",m);case 16:return _.abrupt("return",new Float32Array);case 17:case"end":return _.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"run",value:function(){if(this.engine.currentComputePass){var n;this.engine.currentComputePass.setPipeline(this.computePipeline),this.engine.currentComputePass.setBindGroup(0,this.bindGroup),(n=this.engine.currentComputePass).dispatch.apply(n,(0,Vi.Z)(this.context.dispatch))}}},{key:"updateBuffer",value:function(n,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=this.vertexBuffers[n];a&&a.subData({data:r,offset:i})}},{key:"updateUniform",value:function(n,r){var i=this.uniformGPUBufferLayout.find(function(a){return a.name===n});i&&this.uniformBuffer.subData({data:Number.isFinite(r)?new Float32Array([r]):new Float32Array(r),offset:i.offset})}},{key:"confirmInput",value:function(n,r){var i=this.vertexBuffers[r],a=n.outputBuffer;if(i&&a&&i!==a){var o=this.engine.device.createCommandEncoder(),s=n.context.output,c=s.length,f=s.typedArrayConstructor,d=c*f.BYTES_PER_ELEMENT;o.copyBufferToBuffer(a.get(),0,i.get(),0,d);var h=Co?this.engine.device.getQueue():this.engine.device.defaultQueue;h.submit([o.finish()])}}},{key:"compileShaderToSpirV",value:function(n,r,i){return this.compileRawShaderToSpirV(i+n,r)}},{key:"compileRawShaderToSpirV",value:function(n,r){return this.engine.glslang.compileGLSL(n,r)}},{key:"compileComputePipelineStageDescriptor",value:function(){var t=(0,Er.Z)(Xt().mark(function r(i){var a,o;return Xt().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(a=i,o=`#version 450
`,this.engine.options.useWGSL){c.next=6;break}return c.next=5,this.compileShaderToSpirV(i,"compute",o);case 5:a=c.sent;case 6:return c.abrupt("return",{computeStage:{module:this.engine.device.createShaderModule({code:a,isWHLSL:Co}),entryPoint:"main"}});case 7:case"end":return c.stop()}},r,this)}));function n(r){return t.apply(this,arguments)}return n}()}]),e}(),WI=function(){function e(t,n){(0,qt.Z)(this,e),this.engine=t,this.options=n,this.indexCount=void 0,this.buffer=void 0;var r=n,i=r.data,a=r.usage,o=r.type,s=r.count;this.indexCount=s||0,this.buffer=new Ch(t,{data:i instanceof Array?new Uint16Array(i):i,usage:Nt.FB.Index|Nt.FB.CopyDst})}return(0,vn.Z)(e,[{key:"get",value:function(){return this.buffer}},{key:"subData",value:function(n){this.buffer.subData(n)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),VI=function(){function e(t,n){(0,qt.Z)(this,e),this.engine=t,this.options=n,this.colorTexture=void 0,this.depthTexture=void 0,this.width=0,this.height=0;var r=n,i=r.width,a=r.height,o=r.color,s=r.colors,c=r.depth,f=r.stencil;o&&(this.colorTexture=o),c&&(this.depthTexture=c)}return(0,vn.Z)(e,[{key:"get",value:function(){var n,r;return{color:(n=this.colorTexture)===null||n===void 0?void 0:n.get(),depth:(r=this.depthTexture)===null||r===void 0?void 0:r.get()}}},{key:"destroy",value:function(){var n,r;(n=this.colorTexture)===null||n===void 0||n.destroy(),(r=this.depthTexture)===null||r===void 0||r.destroy()}},{key:"resize",value:function(n){var r=n.width,i=n.height;if(r!==this.width||i!==this.height){var a,o;(a=this.colorTexture)===null||a===void 0||a.resize({width:r,height:i}),(o=this.depthTexture)===null||o===void 0||o.resize({width:r,height:i})}this.width=r,this.height=i}}]),e}(),Kc,ic,rd,no,Rh,q0,Vv,ZI=(Kc={},(0,ze.Z)(Kc,ve.POINTS,Nt.YV.PointList),(0,ze.Z)(Kc,ve.LINES,Nt.YV.LineList),(0,ze.Z)(Kc,ve.LINE_LOOP,Nt.YV.LineList),(0,ze.Z)(Kc,ve.LINE_STRIP,Nt.YV.LineStrip),(0,ze.Z)(Kc,ve.TRIANGLES,Nt.YV.TriangleList),(0,ze.Z)(Kc,ve.TRIANGLE_FAN,Nt.YV.TriangleList),(0,ze.Z)(Kc,ve.TRIANGLE_STRIP,Nt.YV.TriangleStrip),Kc),jI=(ic={},(0,ze.Z)(ic,ve.NEVER,Nt.wb.Never),(0,ze.Z)(ic,ve.ALWAYS,Nt.wb.Always),(0,ze.Z)(ic,ve.LESS,Nt.wb.Less),(0,ze.Z)(ic,ve.LEQUAL,Nt.wb.LessEqual),(0,ze.Z)(ic,ve.GREATER,Nt.wb.Greater),(0,ze.Z)(ic,ve.GEQUAL,Nt.wb.GreaterEqual),(0,ze.Z)(ic,ve.EQUAL,Nt.wb.Equal),(0,ze.Z)(ic,ve.NOTEQUAL,Nt.wb.NotEqual),ic),Xb=(rd={},(0,ze.Z)(rd,ve.FUNC_ADD,Nt.db.Add),(0,ze.Z)(rd,ve.MIN_EXT,Nt.db.Min),(0,ze.Z)(rd,ve.MAX_EXT,Nt.db.Max),(0,ze.Z)(rd,ve.FUNC_SUBTRACT,Nt.db.Subtract),(0,ze.Z)(rd,ve.FUNC_REVERSE_SUBTRACT,Nt.db.ReverseSubtract),rd),Q0=(no={},(0,ze.Z)(no,ve.ZERO,Nt.zi.Zero),(0,ze.Z)(no,ve.ONE,Nt.zi.One),(0,ze.Z)(no,ve.SRC_COLOR,Nt.zi.SrcColor),(0,ze.Z)(no,ve.ONE_MINUS_SRC_COLOR,Nt.zi.OneMinusSrcColor),(0,ze.Z)(no,ve.SRC_ALPHA,Nt.zi.SrcAlpha),(0,ze.Z)(no,ve.ONE_MINUS_SRC_ALPHA,Nt.zi.OneMinusSrcAlpha),(0,ze.Z)(no,ve.DST_COLOR,Nt.zi.DstColor),(0,ze.Z)(no,ve.ONE_MINUS_DST_COLOR,Nt.zi.OneMinusDstColor),(0,ze.Z)(no,ve.DST_ALPHA,Nt.zi.DstAlpha),(0,ze.Z)(no,ve.ONE_MINUS_DST_ALPHA,Nt.zi.OneMinusDstAlpha),(0,ze.Z)(no,ve.CONSTANT_COLOR,Nt.zi.BlendColor),(0,ze.Z)(no,ve.ONE_MINUS_CONSTANT_COLOR,Nt.zi.OneMinusBlendColor),(0,ze.Z)(no,ve.SRC_ALPHA_SATURATE,Nt.zi.SrcAlphaSaturated),no),HI=(Rh={},(0,ze.Z)(Rh,ve.ALPHA,"r8unorm"),(0,ze.Z)(Rh,ve.RGBA,"rgba8unorm"),(0,ze.Z)(Rh,ve.DEPTH_COMPONENT,"depth32float"),(0,ze.Z)(Rh,ve.DEPTH_STENCIL,"depth24plus-stencil8"),Rh),$b=(q0={},(0,ze.Z)(q0,ve.NEAREST,"nearest"),(0,ze.Z)(q0,ve.LINEAR,"linear"),q0),Dy=(Vv={},(0,ze.Z)(Vv,ve.REPEAT,"repeat"),(0,ze.Z)(Vv,ve.CLAMP_TO_EDGE,"clamp-to-edge"),(0,ze.Z)(Vv,ve.MIRRORED_REPEAT,"mirror-repeat"),Vv);function XI(e){var t=e.cull;if(!t||!t.enable)return Nt.Wf.None;if(t.face)return t.face===ve.FRONT?Nt.Wf.Front:Nt.Wf.Back}function $I(e){var t=e.depth,n=e.stencil,r={compare:Nt.wb.Always,depthFailOp:Nt.xS.Keep,failOp:Nt.xS.Keep,passOp:Nt.xS.Keep};return{depthWriteEnabled:t&&t.enable,depthCompare:jI[(t==null?void 0:t.func)||ve.ALWAYS],format:Nt.EV.Depth24PlusStencil8,stencilFront:r,stencilBack:r,stencilReadMask:4294967295,stencilWriteMask:4294967295}}function YI(e,t){var n=e.blend;return[{format:t,alphaBlend:{srcFactor:Q0[n&&n.func&&n.func.srcAlpha||ve.ONE],dstFactor:Q0[n&&n.func&&n.func.dstAlpha||ve.ZERO],operation:Xb[n&&n.equation&&n.equation.alpha||ve.FUNC_ADD]},colorBlend:{srcFactor:Q0[n&&n.func&&n.func.srcRGB||ve.ONE],dstFactor:Q0[n&&n.func&&n.func.dstRGB||ve.ZERO],operation:Xb[n&&n.equation&&n.equation.rgb||ve.FUNC_ADD]},writeMask:Nt.Yw.All}]}function Yb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Mh(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Yb(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function KI(e){for(var t=0,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var a=0,o=r;a<o.length;a++){var s=o[a];t+=s.length}for(var c=new e(t),f=0,d=0,h=r;d<h.length;d++){var v=h[d];c.set(v,f),f+=v.length}return c}var JI=function(){function e(t,n){(0,qt.Z)(this,e),this.engine=t,this.options=n,this.pipelineLayout=void 0,this.renderPipeline=void 0,this.uniformsBindGroupLayout=void 0,this.uniformBindGroup=void 0,this.uniformBuffer=void 0,this.uniforms={},this.uniformGPUBufferLayout=[],this.attributeCache={},this.indexBuffer=void 0,this.indexCount=void 0}return(0,vn.Z)(e,[{key:"init",value:function(){var t=(0,Er.Z)(Xt().mark(function r(){var i=this,a,o,s,c,f,d,h,v,m,g,_,y,E,b,A,C,R,z;return Xt().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return a=this.options,o=a.vs,s=a.fs,c=a.attributes,f=a.uniforms,d=a.primitive,h=a.count,v=a.elements,m=a.depth,g=a.blend,_=a.stencil,y=a.cull,E=a.instances,Q.next=3,this.compilePipelineStageDescriptor(o,s,null);case 3:b=Q.sent,A=b.vertexStage,C=b.fragmentStage,f&&this.buildUniformBindGroup(f),v&&(this.indexBuffer=v.get(),this.indexCount=v.indexCount),R={vertexBuffers:Object.keys(c).map(function(re,de){var Ie=c[re],ie=Ie.get(),ke=ie.arrayStride,Ve=ie.stepMode,Rt=ie.attributes;return i.attributeCache[re]=Ie,{arrayStride:ke,stepMode:Ve,attributes:Rt}})},z={sampleCount:this.engine.mainPassSampleCount,primitiveTopology:ZI[d||ve.TRIANGLES],rasterizationState:Mh(Mh({},this.getDefaultRasterizationStateDescriptor()),{},{cullMode:XI({cull:y})}),depthStencilState:$I({depth:m,stencil:_}),colorStates:YI({blend:g},this.engine.options.swapChainFormat),layout:this.pipelineLayout,vertexStage:A,fragmentStage:C,vertexState:R},this.renderPipeline=this.engine.device.createRenderPipeline(z);case 11:case"end":return Q.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"addUniforms",value:function(n){this.uniforms=Mh(Mh({},this.uniforms),Wv(n))}},{key:"draw",value:function(n){var r=this,i=this.engine.getCurrentRenderPass(),a=Mh(Mh({},this.uniforms),Wv(n.uniforms||{})),o=[];Object.keys(a).forEach(function(s){var c=(0,_h.Z)(a[s]);if(c==="boolean"||c==="number"||Array.isArray(a[s])||a[s].BYTES_PER_ELEMENT){var f,d=(f=r.uniformGPUBufferLayout.find(function(E){var b=E.name;return b===s}))===null||f===void 0?void 0:f.offset;d!==null&&r.uniformBuffer.subData({data:a[s],offset:d})}else{var h,v=(h=r.uniformGPUBufferLayout.find(function(E){var b=E.name;return b===s}))===null||h===void 0?void 0:h.offset;if(v!==null){var m=a[s].get(),g=m.color||m,_=g.texture,y=g.sampler;y&&(o.push({binding:v,resource:y}),v++),o.push({binding:v,resource:_.createView()})}}}),this.uniformBuffer&&(o[0]={binding:0,resource:{buffer:this.uniformBuffer.get()}}),this.uniformBindGroup=this.engine.device.createBindGroup({layout:this.uniformsBindGroupLayout,entries:o}),this.renderPipeline&&i.setPipeline(this.renderPipeline),i.setBindGroup(0,this.uniformBindGroup),this.indexBuffer&&i.setIndexBuffer(this.indexBuffer.get(),Nt.iD.Uint32,0),Object.keys(this.attributeCache).forEach(function(s,c){i.setVertexBuffer(0+c,r.attributeCache[s].get().buffer,0)}),this.indexBuffer?i.drawIndexed(this.indexCount,this.options.instances||1,0,0,0):i.draw(this.options.count||0,this.options.instances||0,0,0)}},{key:"destroy",value:function(){throw new Error("Method not implemented.")}},{key:"compilePipelineStageDescriptor",value:function(){var t=(0,Er.Z)(Xt().mark(function r(i,a,o){var s,c,f;return Xt().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(s=`#version 450
`,c=i,f=a,this.engine.options.useWGSL){h.next=10;break}return h.next=6,this.compileShaderToSpirV(i,"vertex",s);case 6:return c=h.sent,h.next=9,this.compileShaderToSpirV(a,"fragment",s);case 9:f=h.sent;case 10:return h.abrupt("return",this.createPipelineStageDescriptor(c,f));case 11:case"end":return h.stop()}},r,this)}));function n(r,i,a){return t.apply(this,arguments)}return n}()},{key:"compileShaderToSpirV",value:function(n,r,i){return this.compileRawShaderToSpirV(i+n,r)}},{key:"compileRawShaderToSpirV",value:function(n,r){return this.engine.glslang.compileGLSL(n,r)}},{key:"createPipelineStageDescriptor",value:function(n,r){return{vertexStage:{module:this.engine.device.createShaderModule({code:n,isWHLSL:Co}),entryPoint:"main"},fragmentStage:{module:this.engine.device.createShaderModule({code:r,isWHLSL:Co}),entryPoint:"main"}}}},{key:"getDefaultRasterizationStateDescriptor",value:function(){return{frontFace:Nt.zX.CCW,cullMode:Nt.Wf.None,depthBias:0,depthBiasSlopeScale:0,depthBiasClamp:0}}},{key:"buildUniformBindGroup",value:function(n){var r=this,i=0,a=KI.apply(void 0,[Float32Array].concat((0,Vi.Z)(Object.keys(n).map(function(c){return n[c]?(r.uniformGPUBufferLayout.push({name:c,offset:i}),i+=(n[c].length||1)*4,n[c]):[]})))),o=[],s=!1;a.length&&(s=!0,o.push({binding:0,visibility:Nt.$X.Fragment|Nt.$X.Vertex,type:Nt.$l.UniformBuffer})),Object.keys(n).filter(function(c){return n[c]===null}).forEach(function(c,f){r.uniformGPUBufferLayout.push({name:c,offset:f*2+(s?1:0)}),o.push({binding:f*2+(s?1:0),visibility:Nt.$X.Fragment,type:Nt.$l.Sampler},{binding:f*2+(s?1:0)+1,visibility:Nt.$X.Fragment,type:Nt.$l.SampledTexture})}),this.uniformsBindGroupLayout=this.engine.device.createBindGroupLayout({entries:o}),this.pipelineLayout=this.engine.device.createPipelineLayout({bindGroupLayouts:[this.uniformsBindGroupLayout]}),s&&(this.uniformBuffer=new Ch(this.engine,{data:a instanceof Array?new Float32Array(a):a,usage:Nt.FB.Uniform|Nt.FB.CopyDst}))}}]),e}(),qI=function(){function e(t,n){(0,qt.Z)(this,e),this.engine=t,this.options=n,this.texture=void 0,this.sampler=void 0,this.width=void 0,this.height=void 0,this.createTexture()}return(0,vn.Z)(e,[{key:"get",value:function(){return{texture:this.texture,sampler:this.sampler}}},{key:"update",value:function(){}},{key:"resize",value:function(n){var r=n.width,i=n.height;(r!==this.width||i!==this.height)&&(this.destroy(),this.createTexture()),this.width=r,this.height=i}},{key:"destroy",value:function(){this.texture&&this.texture.destroy()}},{key:"createTexture",value:function(){var n=this.options,r=n.data,i=n.type,a=i===void 0?ve.UNSIGNED_BYTE:i,o=n.width,s=n.height,c=n.flipY,f=c===void 0?!1:c,d=n.format,h=d===void 0?ve.RGBA:d,v=n.mipmap,m=v===void 0?!1:v,g=n.wrapS,_=g===void 0?ve.CLAMP_TO_EDGE:g,y=n.wrapT,E=y===void 0?ve.CLAMP_TO_EDGE:y,b=n.aniso,A=b===void 0?0:b,C=n.alignment,R=C===void 0?1:C,z=n.premultiplyAlpha,ee=z===void 0?!1:z,Q=n.mag,re=Q===void 0?ve.NEAREST:Q,de=n.min,Ie=de===void 0?ve.NEAREST:de,ie=n.colorSpace,ke=ie===void 0?ve.BROWSER_DEFAULT_WEBGL:ie,Ve=n.usage;this.width=o,this.height=s,this.texture=this.engine.device.createTexture({size:[o,s,1],mipLevelCount:1,sampleCount:1,dimension:Nt.kd.E2d,format:HI[h],usage:Ve||Nt.v2.Sampled|Nt.v2.CopyDst}),(!Ve||Ve&Nt.v2.Sampled)&&(this.sampler=this.engine.device.createSampler({addressModeU:Dy[_],addressModeV:Dy[E],addressModeW:Dy[_],magFilter:$b[re],minFilter:$b[Ie],maxAnisotropy:A}))}}]),e}(),Kb,Jb,qb,QI=(Kb=(0,yt.b2)(),Kb(Jb=(qb=function(){function e(){var t=this;(0,qt.Z)(this,e),this.supportWebGPU=!0,this.useWGSL=!1,this.options=void 0,this.canvas=void 0,this.context=void 0,this.glslang=void 0,this.adapter=void 0,this.device=void 0,this.swapChain=void 0,this.mainPassSampleCount=void 0,this.mainTexture=void 0,this.depthTexture=void 0,this.mainColorAttachments=void 0,this.mainTextureExtends=void 0,this.mainDepthAttachment=void 0,this.uploadEncoder=void 0,this.renderEncoder=void 0,this.computeEncoder=void 0,this.renderTargetEncoder=void 0,this.commandBuffers=new Array(4).fill(void 0),this.currentRenderPass=null,this.mainRenderPass=null,this.currentRenderTargetViewDescriptor=void 0,this.currentComputePass=null,this.bundleEncoder=void 0,this.tempBuffers=[],this.currentRenderTarget=null,this.uploadEncoderDescriptor={label:"upload"},this.renderEncoderDescriptor={label:"render"},this.renderTargetEncoderDescriptor={label:"renderTarget"},this.computeEncoderDescriptor={label:"compute"},this.pipelines={},this.computePipelines={},this.defaultSampleCount=4,this.clearDepthValue=1,this.clearStencilValue=0,this.transientViewport={x:Infinity,y:0,width:0,height:0},this.cachedViewport={x:0,y:0,width:0,height:0},this.clear=function(n){var r=n.framebuffer,i=n.color,a=n.depth,o=n.stencil;t.options.supportCompute&&t.startComputePass(),t.currentRenderTarget?(t.currentRenderPass&&t.endRenderTargetRenderPass(),t.startRenderTargetRenderPass(t.currentRenderTarget,i||null,!!a,!!o)):(t.mainColorAttachments[0].loadValue=i||Nt.Ws.Load,t.mainDepthAttachment.depthLoadValue=a||Nt.Ws.Load,t.mainDepthAttachment.stencilLoadValue=o?t.clearStencilValue:Nt.Ws.Load,t.mainRenderPass&&t.endMainRenderPass(),t.startMainRenderPass())},this.createModel=function(){var n=(0,Er.Z)(Xt().mark(function r(i){var a;return Xt().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a=new JI(t,i),s.next=3,a.init();case 3:return s.abrupt("return",a);case 4:case"end":return s.stop()}},r)}));return function(r){return n.apply(this,arguments)}}(),this.createAttribute=function(n){return new UI(t,n)},this.createBuffer=function(n){return new Ch(t,n)},this.createElements=function(n){return new WI(t,n)},this.createTexture2D=function(n){return new qI(t,n)},this.createFramebuffer=function(n){return new VI(t,n)},this.useFramebuffer=function(n,r){t.currentRenderTarget&&t.unbindFramebuffer(t.currentRenderTarget),t.currentRenderTarget=n,t.currentRenderTargetViewDescriptor={dimension:Nt.p_.E2d,arrayLayerCount:1,aspect:Nt.H7.All},t.currentRenderPass=null,r()},this.createComputeModel=function(){var n=(0,Er.Z)(Xt().mark(function r(i){var a;return Xt().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a=new zI(t,i),s.next=3,a.init();case 3:return s.abrupt("return",a);case 4:case"end":return s.stop()}},r)}));return function(r){return n.apply(this,arguments)}}(),this.getCanvas=function(){return t.canvas},this.getGLContext=function(){throw new Error("Method not implemented.")},this.viewport=function(n){var r=n.x,i=n.y,a=n.width,o=n.height;if(!t.currentRenderPass)t.transientViewport={x:r,y:i,width:a,height:o};else if(t.transientViewport.x!==Infinity){var s=t.getCurrentRenderPass();s.setViewport(t.transientViewport.x,t.transientViewport.y,t.transientViewport.width,t.transientViewport.height,0,1)}else if(r!==t.cachedViewport.x||i!==t.cachedViewport.y||a!==t.cachedViewport.width||o!==t.cachedViewport.height){t.cachedViewport={x:r,y:i,width:a,height:o};var c=t.getCurrentRenderPass();c.setViewport(r,i,a,o,0,1)}},this.readPixels=function(n){throw new Error("Method not implemented.")}}return(0,vn.Z)(e,[{key:"isFloatSupported",value:function(){return!0}},{key:"init",value:function(){var t=(0,Er.Z)(Xt().mark(function r(i){return Xt().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.canvas=i.canvas,this.options=i,this.useWGSL=!!i.useWGSL,this.mainPassSampleCount=i.antialiasing?this.defaultSampleCount:1,o.next=6,this.initGlslang();case 6:this.initContextAndSwapChain(),this.initMainAttachments();case 8:case"end":return o.stop()}},r,this)}));function n(r){return t.apply(this,arguments)}return n}()},{key:"setScissor",value:function(n){throw new Error("Method not implemented.")}},{key:"destroy",value:function(){this.mainTexture&&this.mainTexture.destroy(),this.depthTexture&&this.depthTexture.destroy(),this.tempBuffers.forEach(function(n){return n.destroy()}),this.tempBuffers=[]}},{key:"beginFrame",value:function(){this.uploadEncoder=this.device.createCommandEncoder(this.uploadEncoderDescriptor),this.renderEncoder=this.device.createCommandEncoder(this.renderEncoderDescriptor),this.renderTargetEncoder=this.device.createCommandEncoder(this.renderTargetEncoderDescriptor),this.options.supportCompute&&(this.computeEncoder=this.device.createCommandEncoder(this.computeEncoderDescriptor))}},{key:"endFrame",value:function(){this.options.supportCompute&&this.endComputePass(),this.endMainRenderPass(),this.commandBuffers[0]=this.uploadEncoder.finish(),this.commandBuffers[1]=this.renderEncoder.finish(),this.options.supportCompute&&(this.commandBuffers[2]=this.computeEncoder.finish()),this.commandBuffers[3]=this.renderTargetEncoder.finish(),Co?this.device.getQueue().submit(this.commandBuffers.filter(function(n){return n})):this.device.defaultQueue.submit(this.commandBuffers.filter(function(n){return n}))}},{key:"getCurrentRenderPass",value:function(){return this.currentRenderTarget&&!this.currentRenderPass?this.startRenderTargetRenderPass(this.currentRenderTarget,null,!1,!1):this.currentRenderPass||this.startMainRenderPass(),this.currentRenderPass}},{key:"initGlslang",value:function(){var t=(0,Er.Z)(Xt().mark(function r(){var i,a;return Xt().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,FI();case 2:return this.glslang=s.sent,s.next=5,(i=navigator)===null||i===void 0||(a=i.gpu)===null||a===void 0?void 0:a.requestAdapter();case 5:return this.adapter=s.sent,s.next=8,this.adapter.requestDevice();case 8:this.device=s.sent;case 9:case"end":return s.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"initContextAndSwapChain",value:function(){this.context=this.canvas.getContext(Co?"gpu":"gpupresent"),this.swapChain=this.context.configureSwapChain({device:this.device,format:this.options.swapChainFormat,usage:Nt.v2.OutputAttachment|Nt.v2.CopySrc})}},{key:"initMainAttachments",value:function(){if(this.mainTextureExtends={width:this.canvas.width,height:this.canvas.height,depth:1},this.options.antialiasing){var n={size:this.mainTextureExtends,mipLevelCount:1,sampleCount:this.mainPassSampleCount,dimension:Nt.kd.E2d,format:Nt.EV.BGRA8Unorm,usage:Nt.v2.OutputAttachment};this.mainTexture&&this.mainTexture.destroy(),this.mainTexture=this.device.createTexture(n),this.mainColorAttachments=[{attachment:Co?this.mainTexture.createDefaultView():this.mainTexture.createView(),loadValue:[0,0,0,1],storeOp:Nt.EG.Store}]}else this.mainColorAttachments=[{attachment:Co?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView(),loadValue:[0,0,0,1],storeOp:Nt.EG.Store}];var r={size:this.mainTextureExtends,mipLevelCount:1,sampleCount:this.mainPassSampleCount,dimension:Nt.kd.E2d,format:Co?"depth32float-stencil8":Nt.EV.Depth24PlusStencil8,usage:Nt.v2.OutputAttachment};this.depthTexture&&this.depthTexture.destroy(),this.depthTexture=this.device.createTexture(r),this.mainDepthAttachment={attachment:Co?this.depthTexture.createDefaultView():this.depthTexture.createView(),depthLoadValue:this.clearDepthValue,depthStoreOp:Nt.EG.Store,stencilLoadValue:this.clearStencilValue,stencilStoreOp:Nt.EG.Store}}},{key:"startComputePass",value:function(){this.currentComputePass&&this.endComputePass(),this.currentComputePass=this.computeEncoder.beginComputePass()}},{key:"startMainRenderPass",value:function(){this.currentRenderPass&&!this.currentRenderTarget&&this.endMainRenderPass(),this.options.antialiasing?this.mainColorAttachments[0].resolveTarget=Co?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView():this.mainColorAttachments[0].attachment=Co?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView(),this.currentRenderPass=this.renderEncoder.beginRenderPass({colorAttachments:this.mainColorAttachments,depthStencilAttachment:this.mainDepthAttachment}),this.mainRenderPass=this.currentRenderPass,this.cachedViewport&&this.viewport(this.cachedViewport)}},{key:"startRenderTargetRenderPass",value:function(n,r,i){var a,o,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,c=(a=n.get().color)===null||a===void 0?void 0:a.texture,f;c&&(f=c.createView(this.currentRenderTargetViewDescriptor));var d=(o=n.get().depth)===null||o===void 0?void 0:o.texture,h;d&&(h=d.createView());var v=this.renderTargetEncoder.beginRenderPass({colorAttachments:[{attachment:f,loadValue:r!==null?r:Nt.Ws.Load,storeOp:Nt.EG.Store}],depthStencilAttachment:d&&h?{attachment:h,depthLoadValue:i?this.clearDepthValue:Nt.Ws.Load,depthStoreOp:Nt.EG.Store,stencilLoadValue:s?this.clearStencilValue:Nt.Ws.Load,stencilStoreOp:Nt.EG.Store}:void 0});this.currentRenderPass=v,this.cachedViewport&&this.viewport(this.cachedViewport)}},{key:"endMainRenderPass",value:function(){this.currentRenderPass===this.mainRenderPass&&this.currentRenderPass!==null&&(this.currentRenderPass.endPass(),this.resetCachedViewport(),this.currentRenderPass=null,this.mainRenderPass=null)}},{key:"endComputePass",value:function(){this.currentComputePass&&(this.currentComputePass.endPass(),this.currentComputePass=null)}},{key:"endRenderTargetRenderPass",value:function(){this.currentRenderPass&&(this.currentRenderPass.endPass(),this.resetCachedViewport())}},{key:"resetCachedViewport",value:function(){this.cachedViewport={x:0,y:0,width:0,height:0}}},{key:"unbindFramebuffer",value:function(n){this.currentRenderPass&&this.currentRenderPass!==this.mainRenderPass&&this.endRenderTargetRenderPass(),this.transientViewport.x=Infinity,this.currentRenderTarget=null,this.currentRenderPass=this.mainRenderPass}}]),e}(),qb))||Jb),Qb,ew;function eC(e){var t=tC();return function(){var r=(0,Cr.Z)(e),i;if(t){var a=(0,Cr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ka.Z)(this,i)}}function tC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var Py=4/64,tw=1-Py*2,nC=(Qb=(0,yt.b2)(),Qb(ew=function(e){(0,Ga.Z)(n,e);var t=eC(n);function n(){return(0,qt.Z)(this,n),t.apply(this,arguments)}return(0,vn.Z)(n,[{key:"onEntityCreated",value:function(){var i=this.config,a=i.widthSegments,o=a===void 0?1:a,s=i.heightSegments,c=s===void 0?1:s,f=i.depthSegments,d=f===void 0?1:f,h=i.halfExtents,v=h===void 0?Ce.al(.5,.5,.5):h,m=o,g=c,_=d,y=(0,k0.Z)(v,3),E=y[0],b=y[1],A=y[2],C=[Ce.al(-E,-b,A),Ce.al(E,-b,A),Ce.al(E,b,A),Ce.al(-E,b,A),Ce.al(E,-b,-A),Ce.al(-E,-b,-A),Ce.al(-E,b,-A),Ce.al(E,b,-A)],R=[[0,1,3],[4,5,7],[3,2,6],[1,0,4],[1,4,2],[5,0,6]],z=[[0,0,1],[0,0,-1],[0,1,0],[0,-1,0],[1,0,0],[-1,0,0]],ee={FRONT:0,BACK:1,TOP:2,BOTTOM:3,RIGHT:4,LEFT:5},Q=[],re=[],de=[],Ie=[],ie=[],ke=0,Ve=function(pn,lr,Si){var Hr,_n,wn,Ot;for(wn=0;wn<=lr;wn++)for(Ot=0;Ot<=Si;Ot++){var Tn=Ce.Ue(),hr=Ce.Ue(),zn=Ce.Ue(),mn=Ce.Ue();Ce.t7(Tn,C[R[pn][0]],C[R[pn][1]],wn/lr),Ce.t7(hr,C[R[pn][0]],C[R[pn][2]],Ot/Si),Ce.lu(zn,hr,C[R[pn][0]]),Ce.IH(mn,Tn,zn),Hr=wn/lr,_n=Ot/Si,Q.push(mn[0],mn[1],mn[2]),re.push(z[pn][0],z[pn][1],z[pn][2]),de.push(Hr,_n),Hr/=3,_n/=3,Hr=Hr*tw+Py,_n=_n*tw+Py,Hr+=pn%3/3,_n+=Math.floor(pn/3)/3,Ie.push(Hr,_n),wn<lr&&Ot<Si&&(ie.push(ke+Si+1,ke+1,ke),ie.push(ke+Si+1,ke+Si+2,ke+1)),ke++}};Ve(ee.FRONT,m,g),Ve(ee.BACK,m,g),Ve(ee.TOP,m,_),Ve(ee.BOTTOM,m,_),Ve(ee.RIGHT,_,g),Ve(ee.LEFT,_,g);var Rt=xy(Q),dn=this.getComponent();dn.indices=Uint32Array.from(ie),dn.aabb=Rt,dn.vertexCount=ke,dn.attributes=[{dirty:!0,name:"position",data:Float32Array.from(Q),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(re),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(de),arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),n}(Qf))||ew);function rC(e,t){if(!e&&!t)throw new Error("Please specify valid arguments for parameters a and b.");if(!t||t.length===0)return e;if(!e||e.length===0)return t;if(Object.prototype.toString.call(e)!==Object.prototype.toString.call(t))throw new Error("The types of the two arguments passed for parameters a and b do not match.");var n=new e.constructor(e.length+t.length);return n.set(e),n.set(t,e.length),n}var nw,rw;function iC(e){var t=aC();return function(){var r=(0,Cr.Z)(e),i;if(t){var a=(0,Cr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ka.Z)(this,i)}}function aC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var oC=(nw=(0,yt.b2)(),nw(rw=function(e){(0,Ga.Z)(n,e);var t=iC(n);function n(){return(0,qt.Z)(this,n),t.apply(this,arguments)}return(0,vn.Z)(n,[{key:"onEntityCreated",value:function(){var i=this.config.geometries,a=i===void 0?[]:i,o=this.getComponent();o.aabb=new py;var s=[],c=[],f=0;a.forEach(function(d){var h=d.aabb,v=d.indices,m=d.vertexCount,g=d.attributes;o.aabb.add(h),o.vertexCount+=m,v&&c.push.apply(c,(0,Vi.Z)(v.map(function(_){return _+f}))),f+=m,g.forEach(function(_,y){s[y]?_.data&&(Sy(_.data)?s[y].push(_.data):ob(_.data)?s[y].data=rC(s[y].data,_.data):s[y].data=s[y].data.concat(_.data)):(s[y]=_,s[y].dirty=!0)})}),o.attributes=s,o.indices=Uint32Array.from(c),o.dirty=!0}}]),n}(Qf))||rw),iw,aw;function sC(e){var t=uC();return function(){var r=(0,Cr.Z)(e),i;if(t){var a=(0,Cr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ka.Z)(this,i)}}function uC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var cC=(iw=(0,yt.b2)(),iw(aw=function(e){(0,Ga.Z)(n,e);var t=sC(n);function n(){return(0,qt.Z)(this,n),t.apply(this,arguments)}return(0,vn.Z)(n,[{key:"onEntityCreated",value:function(){for(var i=this.config,a=i.halfExtents,o=a===void 0?[.5,.5]:a,s=i.widthSegments,c=s===void 0?5:s,f=i.lengthSegments,d=f===void 0?5:f,h=[],v=[],m=[],g=[],_=0,y=0;y<=c;y++)for(var E=0;E<=d;E++){var b=-o[0]+2*o[0]*y/c,A=0,C=-(-o[1]+2*o[1]*E/d),R=y/c,z=E/d;h.push(b,A,C),v.push(0,1,0),m.push(R,z),y<c&&E<d&&(g.push(_+d+1,_+1,_),g.push(_+d+1,_+d+2,_+1)),_++}var ee=xy(h),Q=this.getComponent();Q.indices=Uint32Array.from(g),Q.aabb=ee,Q.vertexCount=_,Q.attributes=[{dirty:!0,name:"position",data:Float32Array.from(h),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(v),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(m),arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),n}(Qf))||aw),ow,sw;function fC(e){var t=lC();return function(){var r=(0,Cr.Z)(e),i;if(t){var a=(0,Cr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ka.Z)(this,i)}}function lC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var dC=(ow=(0,yt.b2)(),ow(sw=function(e){(0,Ga.Z)(n,e);var t=fC(n);function n(){return(0,qt.Z)(this,n),t.apply(this,arguments)}return(0,vn.Z)(n,[{key:"onEntityCreated",value:function(){for(var i=this.config,a=i.radius,o=a===void 0?.5:a,s=i.latitudeBands,c=s===void 0?16:s,f=i.longitudeBands,d=f===void 0?16:f,h=[],v=[],m=[],g=[],_=0;_<=c;_++)for(var y=_*Math.PI/c,E=Math.sin(y),b=Math.cos(y),A=0;A<=d;A++){var C=A*2*Math.PI/d-Math.PI/2,R=Math.sin(C),z=Math.cos(C),ee=z*E,Q=b,re=R*E,de=1-A/d,Ie=1-_/c;h.push(ee*o,Q*o,re*o),v.push(ee,Q,re),m.push(de,Ie)}for(var ie=0;ie<c;++ie)for(var ke=0;ke<d;++ke){var Ve=ie*(d+1)+ke,Rt=Ve+d+1;g.push(Ve+1,Rt,Ve),g.push(Ve+1,Rt+1,Rt)}var dn=xy(h),ln=this.getComponent();ln.indices=Uint32Array.from(g),ln.aabb=dn,ln.vertexCount=h.length/3,ln.attributes=[{dirty:!0,name:"position",data:Float32Array.from(h),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(v),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(m),arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),n}(Qf))||sw),uw,cw,fw,lw,em,dw,hw,vw;function hC(e){var t=vC();return function(){var r=(0,Cr.Z)(e),i;if(t){var a=(0,Cr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ka.Z)(this,i)}}function vC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var pC=`varying vec4 fragColor;

#pragma include "uv.frag.declaration"
#pragma include "map.frag.declaration"

void main() {
  vec4 diffuseColor = fragColor;

  #pragma include "map.frag.main"

  gl_FragColor = diffuseColor;
}`,mC=`attribute vec3 position;
attribute vec3 normal;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;
uniform vec4 color;

varying vec4 fragColor;

#pragma include "uv.vert.declaration"

void main() {
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  fragColor = color;

  #pragma include "uv.vert.main"
}`,gC=`// layout(set = 0, binding = 1) uniform WireframeUniforms {
//   float lineWidth;
//   vec4 lineColor;
// } wireframe;

layout(location = 0) in vec4 fragColor;
// layout(location = 1) in vec3 v_Barycentric;

layout(location = 0) out vec4 outColor;

// wireframe
// float edgeFactor() {
//   vec3 d = fwidth(v_Barycentric);
//   vec3 a3 = smoothstep(vec3(0.0), d * wireframe.lineWidth, v_Barycentric);
//   return min(min(a3.x, a3.y), a3.z);
// }

void main() {
  // outColor = mix(fragColor, wireframe.lineColor, (1.0 - edgeFactor()));
  outColor = fragColor;
}`,yC=`layout(set = 0, binding = 0) uniform Uniforms {
  vec4 color;
  mat4 projectionMatrix;
  mat4 modelViewMatrix;
} uniforms;

layout(location = 0) in vec3 position;
// layout(location = 1) in vec3 barycentric;

layout(location = 0) out vec4 fragColor;
// layout(location = 1) out vec3 v_Barycentric;

void main() {
  gl_Position = uniforms.projectionMatrix * uniforms.modelViewMatrix * vec4(position, 1.0);
  fragColor = uniforms.color;
  // v_Barycentric = barycentric;
}`,_C=(uw=(0,yt.b2)(),cw=(0,yt.f3)(Qe.RenderEngine),fw=(0,yt.f3)(Qe.ShaderModuleService),uw(lw=(em=(vw=function(e){(0,Ga.Z)(n,e);var t=hC(n);function n(){var r;(0,qt.Z)(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return r=t.call.apply(t,[this].concat(a)),an(r,"engine",dw,(0,Li.Z)(r)),an(r,"shaderModuleService",hw,(0,Li.Z)(r)),r}return(0,vn.Z)(n,[{key:"onEntityCreated",value:function(){var i=this.getComponent(),a=this.engine.supportWebGPU?yC:mC,o=this.engine.supportWebGPU?gC:pC;this.shaderModuleService.registerModule("material-basic",{vs:a,fs:o});var s=this.shaderModuleService.getModule("material-basic"),c=s.vs,f=s.fs,d=s.uniforms;i.vertexShaderGLSL=c,i.fragmentShaderGLSL=f,i.setUniform(d),this.config.map&&(i.setDefines({USE_UV:1,USE_MAP:1}),i.setUniform({map:this.config.map,uvTransform:Yl.Ue()}))}}]),n}(xb),vw),dw=on(em.prototype,"engine",[cw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hw=on(em.prototype,"shaderModuleService",[fw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),em))||lw),pw,mw,gw,yw,_w,Ew,bw,Zv,ww,xw,Sw,Tw;function EC(e){var t=bC();return function(){var r=(0,Cr.Z)(e),i;if(t){var a=(0,Cr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ka.Z)(this,i)}}function bC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var wC=`// generate grid, borrow from clay.gl viewer
// @see https://github.com/pissang/clay-viewer/blob/master/src/graphic/ground.glsl
#extension GL_OES_standard_derivatives : enable

varying vec3 v_Position;
// varying vec3 v_Normal;

uniform float u_GridSize : 5;
uniform float u_GridSize2 : .5;
uniform vec4 u_GridColor : [0, 0, 0, 1];
uniform vec4 u_GridColor2 : [0.3, 0.3, 0.3, 1];
uniform bool u_GridEnabled : true;

// uniform vec3 u_LightDirection;
// uniform vec3 u_LightColor;
// uniform vec3 u_Camera;

void main() {
  // vec3 n = v_Normal;
  // vec3 l = normalize(u_LightDirection);
  // float NdotL = clamp(dot(n, l), 0.001, 1.0);

  gl_FragColor = vec4(1.);

  if (u_GridEnabled) {
    float wx = v_Position.x;
    float wz = v_Position.z;
    // float x0 = abs(fract(wx / u_GridSize - 0.5) - 0.5) / fwidth(wx) * u_GridSize / 2.0;
    // float z0 = abs(fract(wz / u_GridSize - 0.5) - 0.5) / fwidth(wz) * u_GridSize / 2.0;

    float x1 = abs(fract(wx / u_GridSize2 - 0.5) - 0.5) / fwidth(wx) * u_GridSize2;
    float z1 = abs(fract(wz / u_GridSize2 - 0.5) - 0.5) / fwidth(wz) * u_GridSize2;

    // float v0 = 1.0 - clamp(min(x0, z0), 0.0, 1.0);
    float v1 = 1.0 - clamp(min(x1, z1), 0.0, 1.0);
    // if (v0 > 0.1) {
        // gl_FragColor = mix(gl_FragColor, u_GridColor, v0);
    // }
    // else {
        gl_FragColor = mix(gl_FragColor, u_GridColor2, v1);
    // }
  }

  // float shadowFactor = calcShadow(u_ShadowMap, v_PositionFromLight, l, n);
  // vec3 diffuseColor = u_LightColor * NdotL * shadowFactor;

  // gl_FragColor.rgb *= diffuseColor;
}`,xC=`attribute vec3 a_Position;

varying vec3 v_Position;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;

void main() {
  v_Position = a_Position;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(a_Position, 1.);
}`,SC=(pw=(0,yt.b2)(),mw=(0,yt.f3)(Qe.Systems),gw=(0,yt.t6)(Qe.MaterialSystem),yw=(0,yt.f3)(Qe.Systems),_w=(0,yt.t6)(Qe.GeometrySystem),Ew=(0,yt.f3)(Qe.ShaderModuleService),pw(bw=(Zv=(Tw=function(e){(0,Ga.Z)(n,e);var t=EC(n);function n(){var r;(0,qt.Z)(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return r=t.call.apply(t,[this].concat(a)),an(r,"materialSystem",ww,(0,Li.Z)(r)),an(r,"geometrySystem",xw,(0,Li.Z)(r)),an(r,"shaderModuleService",Sw,(0,Li.Z)(r)),r}return(0,vn.Z)(n,[{key:"onAttributeChanged",value:function(i){var a=i.name,o=i.data,s=this.getMeshComponent();s&&s.material&&(a==="gridColor"?(s.material.setUniform("u_GridColor",o),s.material.setUniform("u_GridColor2",o)):a==="gridSize"&&(s.material.setUniform("u_GridSize",o),s.material.setUniform("u_GridSize2",o)))}},{key:"onEntityCreated",value:function(){this.shaderModuleService.registerModule("grid",{vs:xC,fs:wC});var i=this.shaderModuleService.getModule("grid"),a=i.vs,o=i.fs,s=i.uniforms,c=this.materialSystem.createShaderMaterial({vertexShader:a,fragmentShader:o});this.setMaterial(c);var f=this.geometrySystem.createBufferGeometry({vertexCount:4});this.setGeometry(f),c.setCull({enable:!1,face:ve.BACK}).setDepth({enable:!0,func:ve.LESS}),c.setUniform(s),this.setAttributes({gridColor:this.config.gridColor,gridSize:this.config.gridSize}),f.setIndex([0,3,2,2,1,0]),f.setAttribute("a_Position",Float32Array.from([-4,-1,-4,4,-1,-4,4,-1,4,-4,-1,4]),{arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]})}}]),n}(el),Tw),ww=on(Zv.prototype,"materialSystem",[mw,gw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xw=on(Zv.prototype,"geometrySystem",[yw,_w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sw=on(Zv.prototype,"shaderModuleService",[Ew],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zv))||bw),tm=S(32644),id=S(40582);function nm(e,t,n,r,i){jv(t,r,-i),jv(t,r,i),e.push(n),e.push(n)}function jv(e,t,n){e.push([[t[0],t[1]],n])}function TC(e,t,n){var r=[0,0],i=[0,0],a=[0,0],o=[0,0],s=-1,c=!1,f=null,d=(0,tm.create)(),h=n||0,v=3,m=[],g=[],_=[],y=[0,0];t&&(e=e.slice(),e.push(e[0]));for(var E=e.length,b=1;b<E;b++){var A=h,C=e[b-1],R=e[b],z=b<e.length-1?e[b+1]:null;if(y.push(b/E,b/E),(0,id.o7)(r,R,C),f||(f=[0,0],(0,id.mJ)(f,r)),c||(c=!0,nm(g,m,C,f,1)),_.push([A+0,A+1,A+2]),!z)(0,id.mJ)(f,r),nm(g,m,R,f,1),_.push(s===1?[A,A+2,A+3]:[A+2,A+1,A+3]),h+=2;else{(0,id.o7)(i,z,R);var ee=(0,id.x7)(a,o,r,i,1),Q=(0,tm.dot)(a,f)<0?-1:1,re=ee>v;if(!isFinite(ee)){(0,id.mJ)(f,r),nm(g,m,R,f,1),_.push(s===1?[A,A+2,A+3]:[A+2,A+1,A+3]),h+=2,s=Q;continue}re?(ee=v,y.push(b/E),jv(m,f,-Q),g.push(R),jv(m,o,ee*Q),g.push(R),_.push(s!==-Q?[A,A+2,A+3]:[A+2,A+1,A+3]),_.push([A+2,A+3,A+4]),(0,id.mJ)(d,i),(0,tm.copy)(f,d),jv(m,f,-Q),g.push(R),h+=3):(nm(g,m,R,o,ee),_.push(s===1?[A,A+2,A+3]:[A+2,A+1,A+3]),Q=-1,(0,tm.copy)(f,o),h+=2),s=Q}}return{normals:m,attrIndex:_,attrPos:g,attrCounters:y}}var Aw,Iw,Cw,Rw,Mw,Nw,Dw,Hv,Pw,Ow,Lw,Gw;function AC(e){var t=IC();return function(){var r=(0,Cr.Z)(e),i;if(t){var a=(0,Cr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ka.Z)(this,i)}}function IC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var CC=`uniform float u_dash_array : 0.02;
uniform float u_dash_offset : 0;
uniform float u_dash_ratio : 0;
uniform float u_thickness : 0.02;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_counters;

void main() {
    float blur = 1. - smoothstep(0.98, 1., length(v_normal));

    gl_FragColor = v_color;
    gl_FragColor.a *= blur * ceil(mod(v_counters + u_dash_offset, u_dash_array) - (u_dash_array * u_dash_ratio));
}`,RC=`attribute vec2 a_pos;
attribute vec4 a_color;
attribute float a_line_miter;
attribute vec2 a_line_normal;
attribute float a_counters;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;
uniform float u_thickness : 0.02;
uniform vec2 u_viewport;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_counters;

void main() {
  v_color = a_color;
  v_counters = a_counters;

  vec3 normal = normalize(vec3(a_line_normal, 0.0));

  vec4 offset = vec4(normal * u_thickness / 2.0 * a_line_miter, 0.0);

  v_normal = vec2(normal * sign(a_line_miter));

  gl_Position = projectionMatrix * modelViewMatrix * vec4(a_pos, 0.0, 1.0) + offset;
}
`,MC=(Aw=(0,yt.b2)(),Iw=(0,yt.f3)(Qe.Systems),Cw=(0,yt.t6)(Qe.MaterialSystem),Rw=(0,yt.f3)(Qe.Systems),Mw=(0,yt.t6)(Qe.GeometrySystem),Nw=(0,yt.f3)(Qe.ShaderModuleService),Aw(Dw=(Hv=(Gw=function(e){(0,Ga.Z)(n,e);var t=AC(n);function n(){var r;(0,qt.Z)(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return r=t.call.apply(t,[this].concat(a)),an(r,"materialSystem",Pw,(0,Li.Z)(r)),an(r,"geometrySystem",Ow,(0,Li.Z)(r)),an(r,"shaderModuleService",Lw,(0,Li.Z)(r)),r.vertexCount=void 0,r}return(0,vn.Z)(n,[{key:"onAttributeChanged",value:function(i){var a=i.name,o=i.data,s=this.getMeshComponent();if(s&&s.material)switch(a){case"dashArray":s.material.setUniform("u_dash_array",o);break;case"dashOffset":s.material.setUniform("u_dash_offset",o);break;case"dashRatio":s.material.setUniform("u_dash_ratio",o);break;case"thickness":s.material.setUniform("u_thickness",o);break;case"color":var c=new Array(this.vertexCount).fill(void 0).map(function(){return o}).reduce(function(f,d){return[].concat((0,Vi.Z)(f),(0,Vi.Z)(d))},[]);s.geometry.setAttribute("a_color",Float32Array.from(c),{arrayStride:4*4,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float4"}]});break}}},{key:"onEntityCreated",value:function(){var i=this;this.shaderModuleService.registerModule("line",{vs:RC,fs:CC});var a=this.shaderModuleService.getModule("line"),o=a.vs,s=a.fs,c=a.uniforms,f=this.materialSystem.createShaderMaterial({vertexShader:o,fragmentShader:s}),d=TC(this.config.points,!1),h=d.normals,v=d.attrIndex,m=d.attrPos,g=d.attrCounters,_=m.length;this.vertexCount=_;var y=this.geometrySystem.createBufferGeometry({vertexCount:_});this.setMaterial(f),this.setGeometry(y),f.setCull({enable:!1,face:ve.BACK}).setUniform(c),this.setAttributes({dashArray:this.config.dashArray,dashOffset:this.config.dashOffset,dashRatio:this.config.dashRatio,thickness:this.config.thickness});var E=[],b=[];h.forEach(function(C){var R=C[0],z=C[1];E.push([R[0],R[1]]),b.push(z)}),y.setIndex(v.reduce(function(C,R){return[].concat((0,Vi.Z)(C),(0,Vi.Z)(R))},[])),y.setAttribute("a_pos",Float32Array.from(m.reduce(function(C,R){return[].concat((0,Vi.Z)(C),(0,Vi.Z)(R))},[])),{arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]});var A=new Array(_).fill(void 0).map(function(){return(0,Vi.Z)(i.config.color)}).reduce(function(C,R){return[].concat((0,Vi.Z)(C),(0,Vi.Z)(R))},[]);y.setAttribute("a_color",Float32Array.from(A),{arrayStride:4*4,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float4"}]}),y.setAttribute("a_line_miter",Float32Array.from(b),{arrayStride:4*1,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float"}]}),y.setAttribute("a_line_normal",Float32Array.from(E.reduce(function(C,R){return[].concat((0,Vi.Z)(C),(0,Vi.Z)(R))},[])),{arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:3,offset:0,format:"float2"}]}),y.setAttribute("a_counters",Float32Array.from(g),{arrayStride:4*1,stepMode:"vertex",attributes:[{shaderLocation:4,offset:0,format:"float"}]})}}]),n}(el),Gw),Pw=on(Hv.prototype,"materialSystem",[Iw,Cw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ow=on(Hv.prototype,"geometrySystem",[Rw,Mw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lw=on(Hv.prototype,"shaderModuleService",[Nw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hv))||Dw);function NC(e){return[e+1&255,e+1>>8&255,e+1>>8>>8&255]}var kw,Fw,Uw,Bw,zw,Ww,Vw,Xv,Zw,jw,Hw,Xw;function $w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function DC(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$w(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$w(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function PC(e){var t=OC();return function(){var r=(0,Cr.Z)(e),i;if(t){var a=(0,Cr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ka.Z)(this,i)}}function OC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var LC=`uniform float u_blur : 0.05;
uniform float u_opacity : 0.7;
uniform float u_stroke_width : 0.01;
uniform vec4 u_stroke_color : [0, 0, 0, 0];
uniform float u_stroke_opacity : 1;

varying vec4 v_color;
varying vec4 v_data;
varying float v_radius;

#pragma include "sdf2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));

  float antialiasblur = v_data.z;
  float antialiased_blur = -max(u_blur, antialiasblur);
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  // if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  // } else if (shape == 1) {
  //   outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
  //   inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  // } else if (shape == 2) {
  //   outer_df = sdBox(v_data.xy, vec2(1.));
  //   inner_df = sdBox(v_data.xy, vec2(r));
  // } else if (shape == 3) {
  //   outer_df = sdPentagon(v_data.xy, 0.8);
  //   inner_df = sdPentagon(v_data.xy, r * 0.8);
  // } else if (shape == 4) {
  //   outer_df = sdHexagon(v_data.xy, 0.8);
  //   inner_df = sdHexagon(v_data.xy, r * 0.8);
  // } else if (shape == 5) {
  //   outer_df = sdOctogon(v_data.xy, 1.0);
  //   inner_df = sdOctogon(v_data.xy, r);
  // } else if (shape == 6) {
  //   outer_df = sdHexagram(v_data.xy, 0.52);
  //   inner_df = sdHexagram(v_data.xy, r * 0.52);
  // } else if (shape == 7) {
  //   outer_df = sdRhombus(v_data.xy, vec2(1.0));
  //   inner_df = sdRhombus(v_data.xy, vec2(r));
  // } else if (shape == 8) {
  //   outer_df = sdVesica(v_data.xy, 1.1, 0.8);
  //   inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  // }

  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiased_blur,
    0.0,
    inner_df
  );
  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;

  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor.a = gl_FragColor.a * opacity_t;

  gl_FragColor = filterColor(gl_FragColor);
}`,GC=`attribute vec2 position;
attribute vec4 color;
attribute float shape;
attribute vec2 offset;
attribute float size;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;

uniform float u_stroke_width : 0.01;
uniform float u_device_pixel_ratio;
uniform vec2 u_viewport;

varying vec4 v_color;
varying vec4 v_data;
varying float v_radius;

#pragma include "picking"

void main() {
  v_color = color;
  v_radius = size;

  lowp float antialiasblur = 1.0 / u_device_pixel_ratio * (size + u_stroke_width);

  // construct point coords
  v_data = vec4(position, antialiasblur, shape);

  gl_Position = projectionMatrix * modelViewMatrix
    * vec4(position * size + offset, 0.0, 1.0);

  setPickingColor(a_PickingColor);
}`,kC=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],FC=(kw=(0,yt.b2)(),Fw=(0,yt.f3)(Qe.Systems),Uw=(0,yt.t6)(Qe.MaterialSystem),Bw=(0,yt.f3)(Qe.Systems),zw=(0,yt.t6)(Qe.GeometrySystem),Ww=(0,yt.f3)(Qe.ShaderModuleService),kw(Vw=(Xv=(Xw=function(e){(0,Ga.Z)(n,e);var t=PC(n);function n(){var r;(0,qt.Z)(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return r=t.call.apply(t,[this].concat(a)),an(r,"materialSystem",Zw,(0,Li.Z)(r)),an(r,"geometrySystem",jw,(0,Li.Z)(r)),an(r,"shaderModuleService",Hw,(0,Li.Z)(r)),r}return(0,vn.Z)(n,[{key:"onAttributeChanged",value:function(i){var a=i.name,o=i.data,s=this.getMeshComponent();s&&s.material&&(a==="strokeWidth"?s.material.setUniform("u_stroke_width",o):a==="strokeColor"?s.material.setUniform("u_stroke_color",o):a==="strokeOpacity"?s.material.setUniform("u_stroke_opacity",o):a==="opacity"?s.material.setUniform("u_opacity",o):a==="blur"&&s.material.setUniform("u_blur",o))}},{key:"onEntityCreated",value:function(){this.shaderModuleService.registerModule("grid",{vs:GC,fs:LC});var i=this.shaderModuleService.getModule("grid"),a=i.vs,o=i.fs,s=i.uniforms,c=this.materialSystem.createShaderMaterial({vertexShader:a,fragmentShader:o,cull:{enable:!1},depth:{enable:!1},blend:{enable:!0,func:{srcRGB:ve.SRC_ALPHA,dstRGB:ve.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}});c.setUniform(DC({u_device_pixel_ratio:window.devicePixelRatio},s));var f=this.buildAttributes(),d=this.geometrySystem.createInstancedBufferGeometry({maxInstancedCount:f.instancedOffsets.length/2,vertexCount:6});d.setIndex([0,2,1,0,3,2]),d.setAttribute("position",Float32Array.from(f.positions),{arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]}),d.setAttribute("offset",Float32Array.from(f.instancedOffsets),{arrayStride:4*2,stepMode:"instance",attributes:[{shaderLocation:1,offset:0,format:"float2"}]}),d.setAttribute("color",Float32Array.from(f.instancedColors),{arrayStride:4*4,stepMode:"instance",attributes:[{shaderLocation:2,offset:0,format:"float4"}]}),d.setAttribute("size",Float32Array.from(f.instancedSizes),{arrayStride:4,stepMode:"instance",attributes:[{shaderLocation:3,offset:0,format:"float"}]}),d.setAttribute("shape",Float32Array.from(f.instancedShapes),{arrayStride:4,stepMode:"instance",attributes:[{shaderLocation:4,offset:0,format:"float"}]}),d.setAttribute("a_PickingColor",Float32Array.from(f.instancedPickingColors),{arrayStride:4*3,stepMode:"instance",attributes:[{shaderLocation:6,offset:0,format:"float3"}]}),this.setMaterial(c),this.setGeometry(d)}},{key:"buildAttribute",value:function(i,a,o){var s,c,f,d;(s=a.instancedPickingColors).push.apply(s,(0,Vi.Z)(NC(i.id||o))),a.instancedShapes.push(kC.indexOf(i.shape||"circle")),(c=a.instancedColors).push.apply(c,(0,Vi.Z)(i.color||[1,0,0,1])),(f=a.instancedOffsets).push.apply(f,(0,Vi.Z)(i.position||[0,0])),(d=a.instancedSizes).push.apply(d,(0,Vi.Z)(i.size||[.2,.2]))}},{key:"buildAttributes",value:function(){var i=this,a={positions:[1,1,1,-1,-1,-1,-1,1],instancedOffsets:[],instancedColors:[],instancedSizes:[],instancedShapes:[],instancedPickingColors:[]};return Array.isArray(this.config)?this.config.forEach(function(o,s){i.buildAttribute(o,a,s)}):this.buildAttribute(this.config,a,0),a}}]),n}(el),Xw),Zw=on(Xv.prototype,"materialSystem",[Fw,Uw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jw=on(Xv.prototype,"geometrySystem",[Bw,zw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hw=on(Xv.prototype,"shaderModuleService",[Ww],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xv))||Vw),Yw,Kw,Jw,qw,Qw,$v,ex,tx,nx,rx;function ix(e,t){var n;if(typeof Symbol=="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(n=UC(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(f){throw f},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){n=e[Symbol.iterator]()},n:function(){var f=n.next();return a=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!a&&n.return!=null&&n.return()}finally{if(o)throw s}}}}function UC(e,t){if(!!e){if(typeof e=="string")return ax(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ax(e,t)}}function ax(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var BC=`#ifdef USE_MAP
  uniform sampler2D map;
#endif`,zC=`#ifdef USE_MAP
  vec4 texelColor = texture2D(map, vUv);
  // texelColor = mapTexelToLinear(texelColor);
  diffuseColor *= texelColor;
#endif`,WC=`#if (defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ))
  varying vec2 vUv;
#endif`,VC=`#ifdef USE_UV
  attribute vec2 uv;
	#ifdef UVS_VERTEX_ONLY
    vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,ZC=`#ifdef USE_UV
  vUv = (uvTransform * vec3(uv, 1)).xy;
#endif`,ox=(Yw=(0,yt.b2)(),Kw=(0,yt.f3)(Qe.RenderEngine),Jw=(0,yt.f3)(Qe.ShaderModuleService),qw=(0,yt.f3)(Qe.ConfigService),Yw(Qw=($v=(rx=function(){function e(){(0,qt.Z)(this,e),this.container=void 0,an(this,"engine",ex,this),an(this,"shaderModule",tx,this),an(this,"configService",nx,this),this.inited=!1,this.rendering=!1,this.pendings=[],this.views=[],this.size=void 0}return(0,vn.Z)(e,[{key:"init",value:function(){var t=(0,Er.Z)(Xt().mark(function r(){var i,a,o,s,c;return Xt().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(this.shaderModule.registerBuiltinModules(),this.shaderModule.registerModule("uv.vert.declaration",{vs:VC}),this.shaderModule.registerModule("uv.vert.main",{vs:ZC}),this.shaderModule.registerModule("uv.frag.declaration",{fs:WC}),this.shaderModule.registerModule("map.frag.declaration",{fs:BC}),this.shaderModule.registerModule("map.frag.main",{fs:zC}),i=this.container.getAll(Qe.Systems),a=this.configService.get(),!a.canvas){d.next=30;break}return d.next=11,this.engine.init({canvas:a.canvas,swapChainFormat:Nt.EV.BGRA8Unorm,antialiasing:!1});case 11:o=ix(i),d.prev=12,o.s();case 14:if((s=o.n()).done){d.next=21;break}if(c=s.value,!c.initialize){d.next=19;break}return d.next=19,c.initialize();case 19:d.next=14;break;case 21:d.next=26;break;case 23:d.prev=23,d.t0=d.catch(12),o.e(d.t0);case 26:return d.prev=26,o.f(),d.finish(26);case 29:this.inited=!0;case 30:case"end":return d.stop()}},r,this,[[12,23,26,29]])}));function n(){return t.apply(this,arguments)}return n}()},{key:"render",value:function(){var t=(0,Er.Z)(Xt().mark(function r(){var i,a,o,s,c,f,d,h=arguments;return Xt().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(!this.inited||this.rendering)){m.next=2;break}return m.abrupt("return");case 2:for(this.pendings.length&&this.pendings.forEach(function(g){g()}),this.rendering=!0,this.engine.beginFrame(),i=this.container.getAll(Qe.Systems),a=h.length,o=new Array(a),s=0;s<a;s++)o[s]=h[s];c=ix(i),m.prev=8,c.s();case 10:if((f=c.n()).done){m.next=17;break}if(d=f.value,!d.execute){m.next=15;break}return m.next=15,d.execute(o);case 15:m.next=10;break;case 17:m.next=22;break;case 19:m.prev=19,m.t0=m.catch(8),c.e(m.t0);case 22:return m.prev=22,c.f(),m.finish(22);case 25:this.engine.endFrame(),this.rendering=!1;case 27:case"end":return m.stop()}},r,this,[[8,19,22,25]])}));function n(){return t.apply(this,arguments)}return n}()},{key:"clear",value:function(n){var r=this;return this.inited?this.engine.clear(n):this.pendings.unshift(function(){r.engine.clear(n),r.pendings.shift()}),this}},{key:"setSize",value:function(n){var r=n.width,i=n.height,a=this.engine.getCanvas();return this.size={width:r,height:i},a.width=r,a.height=i,this}},{key:"getSize",value:function(){return this.size}}]),e}(),rx),ex=on($v.prototype,"engine",[Kw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tx=on($v.prototype,"shaderModule",[Jw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nx=on($v.prototype,"configService",[qw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$v))||Qw),sx,ux,cx,fx=(sx=(0,yt.b2)(),sx(ux=(cx=function(){function e(){(0,qt.Z)(this,e),this.entities=[]}return(0,vn.Z)(e,[{key:"getEntities",value:function(){return this.entities}},{key:"addRenderable",value:function(n){return this.addEntity(n.getEntity()),this}},{key:"removeRenderable",value:function(n){return this.removeEntity(n.getEntity()),this}},{key:"addLight",value:function(){}},{key:"addEntity",value:function(n){return this.entities.indexOf(n)===-1&&this.entities.push(n),this}},{key:"removeEntity",value:function(n){var r=this.entities.indexOf(n);return this.entities.splice(r,1),this}}]),e}(),cx))||ux),lx,dx,hx,vx=(lx=(0,yt.b2)(),lx(dx=(hx=function(){function e(){(0,qt.Z)(this,e),this.cache={}}return(0,vn.Z)(e,[{key:"get",value:function(n){return this.cache[n]}},{key:"set",value:function(n,r){this.cache[n]=r}}]),e}(),hx))||dx),px,mx,gx,yx,rm,_x,Ex,bx;function wx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function xx(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wx(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wx(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Sx=(px=(0,yt.b2)(),mx=(0,yt.f3)(vx),gx=(0,yt.f3)(Qe.RenderEngine),px(yx=(rm=(bx=function(){function e(){(0,qt.Z)(this,e),an(this,"textureCache",_x,this),an(this,"engine",Ex,this),this.config=void 0,this.loaded=!1,this.texture=void 0}return(0,vn.Z)(e,[{key:"setConfig",value:function(n){this.config=n}},{key:"isLoaded",value:function(){return this.loaded}},{key:"load",value:function(){var t=(0,Er.Z)(Xt().mark(function r(){var i=this;return Xt().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!this.config.url){o.next=4;break}return o.abrupt("return",new Promise(function(s,c){var f=i.textureCache.get(i.config.url);if(f)s(f);else{var d=new Image;d.crossOrigin="Anonymous",d.src=i.config.url,d.onload=function(){var h=i.engine.createTexture2D(xx(xx({},i.config),{},{data:d,width:d.width,height:d.height,flipY:!0}));i.textureCache.set(i.config.url,h),i.texture=h,i.loaded=!0,s(h)},d.onerror=function(){c()}}}));case 4:return this.loaded=!0,this.texture=this.engine.createTexture2D(this.config),o.abrupt("return",this.texture);case 7:case"end":return o.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()}]),e}(),bx),_x=on(rm.prototype,"textureCache",[mx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ex=on(rm.prototype,"engine",[gx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rm))||yx),Tx,Ax,Ix,Cx,Oy,Rx,Mx,Nx=(Tx=(0,yt.b2)(),Ax=(0,yt.f3)(Qe.Systems),Ix=(0,yt.t6)(Qe.RendererSystem),Tx(Cx=(Oy=(Mx=function(){function e(){(0,qt.Z)(this,e),an(this,"rendererSystem",Rx,this),this.camera=void 0,this.scene=void 0,this.viewport={x:0,y:0,width:0,height:0},this.clearColor=[1,1,1,1]}return(0,vn.Z)(e,[{key:"getCamera",value:function(){return this.camera}},{key:"getScene",value:function(){return this.scene}},{key:"getViewport",value:function(){return this.viewport}},{key:"getClearColor",value:function(){return this.clearColor}},{key:"setCamera",value:function(n){return this.camera=n,this}},{key:"setScene",value:function(n){return this.scene=n,this}},{key:"setViewport",value:function(n){return this.viewport=n,this}},{key:"setClearColor",value:function(n){return this.clearColor=n,this}},{key:"pick",value:function(n){return this.rendererSystem.pick(n,this)}}]),e}(),Mx),Rx=on(Oy.prototype,"rendererSystem",[Ax,Ix],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oy))||Cx),Dx,Px,Ox,Ly,Lx,Gx;function kx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function jC(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?kx(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kx(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var im=(Dx=(0,yt.b2)(),Px=(0,yt.f3)(Qe.ConfigService),Dx(Ox=(Ly=(Gx=function(){function e(){(0,qt.Z)(this,e),an(this,"configService",Lx,this),this.container=void 0}return(0,vn.Z)(e,[{key:"getEngine",value:function(){var t=(0,Er.Z)(Xt().mark(function r(){var i,a,o,s;return Xt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return i=this.container.get(Qe.RenderEngine),a=this.configService.get(),o=a.canvas,s=a.engineOptions,f.next=4,i.init(jC({canvas:o||ab(),swapChainFormat:Nt.EV.BGRA8Unorm,antialiasing:!1},s));case 4:return f.abrupt("return",i);case 5:case"end":return f.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"getTransformComponent",value:function(n){var r=this.container.get(Qe.TransformComponentManager);return r.getComponentByEntity(n)}},{key:"getMeshComponent",value:function(n){var r=this.container.get(Qe.MeshComponentManager);return r.getComponentByEntity(n)}},{key:"setConfig",value:function(n){this.configService.set(n)}},{key:"setContainer",value:function(n){this.container=n}},{key:"getContainer",value:function(){return this.container}},{key:"createEntity",value:function(){return Qu()}},{key:"createScene",value:function(){return this.container.get(fx)}},{key:"createCamera",value:function(){return this.container.get(QE)}},{key:"createView",value:function(){return this.container.get(Nx)}},{key:"createRenderable",value:function(n,r){var i=n?this.container.getNamed(Qe.Renderable,n):this.container.get(el),a=Qu();return i.setConfig(r||{}),i.setEntity(a),i}},{key:"createGeometry",value:function(n,r){var i=this.container.getNamed(Qe.Geometry,n),a=Qu();return i.setConfig(r||{}),i.setEntity(a),i.getComponent()}},{key:"createMaterial",value:function(n,r){var i=this.container.getNamed(Qe.Material,n),a=Qu();return i.setConfig(r||{}),i.setEntity(a,n),i.getComponent()}},{key:"createTexture2D",value:function(n){var r=this.container.get(Sx);return r.setConfig(n),r}},{key:"createBufferGeometry",value:function(n){var r=this.container.getNamed(Qe.Systems,Qe.GeometrySystem);return r.createBufferGeometry(n)}},{key:"createInstancedBufferGeometry",value:function(n){var r=this.container.getNamed(Qe.Systems,Qe.GeometrySystem);return r.createInstancedBufferGeometry(n)}},{key:"createShaderMaterial",value:function(n){var r=this.container.getNamed(Qe.Systems,Qe.MaterialSystem);return r.createShaderMaterial(n)}},{key:"createKernel",value:function(n){var r=this.container.get(mb);return typeof n=="string"?r.setBundle(JSON.parse(n)):r.setBundle(n),r.init(),r}},{key:"createRenderer",value:function(){var n=this.container.get(ox);return n.container=this.container,n.init(),n}},{key:"destroy",value:function(){var n=this.container.getAll(Qe.Systems);n.forEach(function(a){a.tearDown&&a.tearDown()});var r=this.container.get(Qe.RenderEngine);r.destroy();var i=this.container.get(Qe.InteractorService);i.destroy()}}],[{key:"create",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=iA(),i=navigator.gpu?QI:OI;r.isBound(Qe.RenderEngine)||r.bind(Qe.RenderEngine).to(i).inSingletonScope(),r.bind(ox).toSelf(),r.bind(mb).toSelf(),r.bind(el).toSelf(),r.bind(Nx).toSelf(),r.bind(QE).toSelf(),r.bind(fx).toSelf(),r.bind(e).toSelf(),r.bind(vx).toSelf(),r.bind(Sx).toSelf(),r.bind(Qe.Geometry).to(nC).whenTargetNamed(Qf.BOX),r.bind(Qe.Geometry).to(dC).whenTargetNamed(Qf.SPHERE),r.bind(Qe.Geometry).to(cC).whenTargetNamed(Qf.PLANE),r.bind(Qe.Geometry).to(oC).whenTargetNamed(Qf.MERGED),r.bind(Qe.Material).to(_C).whenTargetNamed(xb.BASIC),r.bind(Qe.Renderable).to(FC).whenTargetNamed(el.POINT),r.bind(Qe.Renderable).to(MC).whenTargetNamed(el.LINE),r.bind(Qe.Renderable).to(SC).whenTargetNamed(el.GRID);var a=r.get(e);return a.setContainer(r),a.setConfig(n),a}}]),e}(),Gx),Lx=on(Ly.prototype,"configService",[Px],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ly))||Ox);const Nh=(e,t)=>{let n;return e?Z(e)?n=()=>e:n=e:n=()=>t||1,n},HC=(e,t)=>{const n=[],r=[],i={};let a=0;for(a=0;a<e.length;a++){const s=e[a];i[s.id]=a,n.push(s.x),n.push(s.y),n.push(0),n.push(0),r.push([])}for(a=0;a<t.length;a++){const s=t[a],c=We(s,"source"),f=We(s,"target");!isNaN(i[c])&&!isNaN(i[f])&&(r[i[c]].push(i[f]),r[i[f]].push(i[c]))}let o=0;for(a=0;a<e.length;a++){const s=n.length,c=r[a],f=c.length;console.log("dests",c,f),n[a*4+2]=s,n[a*4+3]=f,o=Math.max(o,f);for(let d=0;d<f;++d){const h=c[d];n.push(+h)}}for(;n.length%4!=0;)n.push(0);return{maxEdgePerVetex:o,array:new Float32Array(n)}},XC=(e,t,n,r)=>{const i=[],a=[],o={};let s=0;for(s=0;s<e.length;s++){const f=e[s];o[f.id]=s,i.push(f.x),i.push(f.y),i.push(0),i.push(0),a.push([])}for(s=0;s<t.length;s++){const f=t[s],d=We(f,"source"),h=We(f,"target");a[o[d]].push(o[h]),a[o[d]].push(n(f)),a[o[d]].push(r(f)),a[o[d]].push(0),a[o[h]].push(o[d]),a[o[h]].push(n(f)),a[o[h]].push(r(f)),a[o[h]].push(0)}let c=0;for(s=0;s<e.length;s++){const f=i.length,d=a[s],h=d.length;i[s*4+2]=f+1048576*h/4,i[s*4+3]=0,c=Math.max(c,h/4);for(let v=0;v<h;++v){const m=d[v];i.push(+m)}}for(;i.length%4!=0;)i.push(0);return{maxEdgePerVetex:c,array:new Float32Array(i)}},$C=(e,t)=>{const n=[],r=e.length,i={};return t.forEach(a=>{e.forEach((o,s)=>{if(i[a[o]]===void 0&&(i[a[o]]=Object.keys(i).length),n.push(i[a[o]]),s===r-1)for(;n.length%4!=0;)n.push(0)})}),{array:new Float32Array(n),count:Object.keys(i).length}},Fx=e=>{const t=[],n=e.length,r=e[0].length;for(let i=0;i<r;i++)e.forEach((a,o)=>{if(t.push(a[i]),o===n-1)for(;t.length%4!=0;)t.push(0)});return new Float32Array(t)},TN=null,YC='{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_K : f32;\\n  [[offset 4]] u_K2 : f32;\\n  [[offset 8]] u_Center : vec2<f32>;\\n  [[offset 16]] u_Gravity : f32;\\n  [[offset 20]] u_ClusterGravity : f32;\\n  [[offset 24]] u_Speed : f32;\\n  [[offset 28]] u_MaxDisplace : f32;\\n  [[offset 32]] u_Clustering : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AttributeArray : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_ClusterCenters : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 3, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn calcRepulsive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {if (i != j) {var nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nvar xDist : f32 = currentNode.x - nextNode.x;\\nvar yDist : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nvar param : f32 = gWebGPUUniformParams.u_K2 / dist;\\nif (dist > 0.0) {dx = dx + param * xDist;\\ndy = dy + param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {var sign : f32 = select(1.0, -1.0, i < j);\\ndx = dx + param * std::sign;\\ndy = dy + param * std::sign;}}}}\\nreturn vec2<f32>(dx, dy);}\\nfn calcGravity(currentNode : vec4<f32>, nodeAttributes : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nvar vx : f32 = currentNode.x - gWebGPUUniformParams.u_Center.x;\\nvar vy : f32 = currentNode.y - gWebGPUUniformParams.u_Center.y;\\nvar gf : f32 = (0.01 * gWebGPUUniformParams.u_K) * gWebGPUUniformParams.u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (gWebGPUUniformParams.u_Clustering == 1.0) {var clusterIdx : i32 = i32(nodeAttributes.x);\\nvar center : vec4<f32> = gWebGPUBuffer2.u_ClusterCenters[clusterIdx];\\nvar cvx : f32 = currentNode.x - center.x;\\nvar cvy : f32 = currentNode.y - center.y;\\nvar dist : f32 = std::sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nvar parma : f32 = (gWebGPUUniformParams.u_K * gWebGPUUniformParams.u_ClusterGravity) / dist;\\ndx = dx + parma * cvx;\\ndy = dy + parma * cvy;}\\nreturn vec2<f32>(dx, dy);}\\nfn calcAttractive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nvar arr_offset : i32 = i32(std::floor(currentNode.z + 0.5));\\nvar length : i32 = i32(std::floor(currentNode.w + 0.5));\\nvar node_buffer : vec4<f32>;\\nfor (var p : i32 = 0; p < __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX; p = p + 1) {if (p >= length) {break;}\\nvar arr_idx : i32 = arr_offset + i32(p);\\nvar buf_offset : i32 = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[i32(arr_idx / 4)];}\\nvar float_j : f32 = select(node_buffer.x, select(node_buffer.y, select(node_buffer.z, node_buffer.w, buf_offset == 2), buf_offset == 1), buf_offset == 0);\\nvar nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[i32(float_j)];\\nvar xDist : f32 = currentNode.x - nextNode.x;\\nvar yDist : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = std::sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nvar attractiveF : f32 = dist / gWebGPUUniformParams.u_K;\\nif (dist > 0.0) {dx = dx - xDist * attractiveF;\\ndy = dy - yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {var sign : f32 = select(1.0, -1.0, i < i32(float_j));\\ndx = dx - std::sign * attractiveF;\\ndy = dy - std::sign * attractiveF;}}}\\nreturn vec2<f32>(dx, dy);}\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar currentNode : vec4<f32> = gWebGPUBuffer0.u_Data[i];\\nvar dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nif (i >= __DefineValuePlaceholder__VERTEX_COUNT) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvar nodeAttributes : vec4<f32> = gWebGPUBuffer1.u_AttributeArray[i];\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4<f32>(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w);\\nreturn ;}\\nvar repulsive : vec2<f32> = calcRepulsive(i, currentNode);\\ndx = dx + repulsive.x;\\ndy = dy + repulsive.y;\\nvar attractive : vec2<f32> = calcAttractive(i, currentNode);\\ndx = dx + attractive.x;\\ndy = dy + attractive.y;\\nvar gravity : vec2<f32> = calcGravity(currentNode, nodeAttributes);\\ndx = dx - gravity.x;\\ndy = dy - gravity.y;\\ndx = dx * gWebGPUUniformParams.u_Speed;\\ndy = dy * gWebGPUUniformParams.u_Speed;\\nvar distLength : f32 = std::sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {var limitedDist : f32 = std::min(gWebGPUUniformParams.u_MaxDisplace * gWebGPUUniformParams.u_Speed, distLength);\\ngWebGPUBuffer0.u_Data[i] = vec4<f32>(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w);}\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_K;\\n  float u_K2;\\n  vec2 u_Center;\\n  float u_Gravity;\\n  float u_ClusterGravity;\\n  float u_Speed;\\n  float u_MaxDisplace;\\n  float u_Clustering;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer   GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_AttributeArray[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 3) buffer readonly  GWebGPUBuffer2 {\\n  vec4 u_ClusterCenters[];\\n} gWebGPUBuffer2;\\n\\n\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nvec2 calcRepulsive(int i, vec4 currentNode) {float dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = gWebGPUBuffer0.u_Data[j];\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = gWebGPUUniformParams.u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {float dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - gWebGPUUniformParams.u_Center.x;\\nfloat vy = currentNode.y - gWebGPUUniformParams.u_Center.y;\\nfloat gf = (0.01 * gWebGPUUniformParams.u_K) * gWebGPUUniformParams.u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (gWebGPUUniformParams.u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = gWebGPUBuffer2.u_ClusterCenters[clusterIdx];\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (gWebGPUUniformParams.u_K * gWebGPUUniformParams.u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {float dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[int(arr_idx / 4)];}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = gWebGPUBuffer0.u_Data[int(float_j)];\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / gWebGPUUniformParams.u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {int i = globalInvocationID.x;\\nvec4 currentNode = gWebGPUBuffer0.u_Data[i];\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvec4 nodeAttributes = gWebGPUBuffer1.u_AttributeArray[i];\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w);\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= gWebGPUUniformParams.u_Speed;\\ndy *= gWebGPUUniformParams.u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(gWebGPUUniformParams.u_MaxDisplace * gWebGPUUniformParams.u_Speed, distLength);\\ngWebGPUBuffer0.u_Data[i] = vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w);}}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_K;\\nuniform float u_K2;\\nuniform vec2 u_Center;\\nuniform float u_Gravity;\\nuniform float u_ClusterGravity;\\nuniform float u_Speed;\\nuniform float u_MaxDisplace;\\nuniform float u_Clustering;\\nuniform sampler2D u_AttributeArray;\\nuniform vec2 u_AttributeArraySize;\\nvec4 getDatau_AttributeArray(vec2 address2D) {\\n  return vec4(texture2D(u_AttributeArray, address2D).rgba);\\n}\\nvec4 getDatau_AttributeArray(float address1D) {\\n  return getDatau_AttributeArray(addrTranslation_1Dto2D(address1D, u_AttributeArraySize));\\n}\\nvec4 getDatau_AttributeArray(int address1D) {\\n  return getDatau_AttributeArray(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - u_Center.x;\\nfloat vy = currentNode.y - u_Center.y;\\nfloat gf = (0.01 * u_K) * u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = getDatau_ClusterCenters(clusterIdx);\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (u_K * u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes = getDatau_AttributeArray(i);\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w));\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= u_Speed;\\ndy *= u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(u_MaxDisplace * u_Speed, distLength);\\ngl_FragColor = vec4(vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_K","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_K2","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Center","type":"vec2<f32>","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Gravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterGravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Speed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_MaxDisplace","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Clustering","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AttributeArray","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}',AN=null,KC='{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\n\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 0, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributes : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_ClusterCenters : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar center : vec4<f32> = gWebGPUBuffer2.u_ClusterCenters[i];\\nvar sumx : f32 = 0.0;\\nvar sumy : f32 = 0.0;\\nvar count : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {var attributes : vec4<f32> = gWebGPUBuffer1.u_NodeAttributes[j];\\nvar clusterIdx : i32 = i32(attributes.x);\\nvar vertex : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nif (clusterIdx == i) {sumx = sumx + vertex.x;\\nsumy = sumy + vertex.y;\\ncount = count + 1.0;}}\\ngWebGPUBuffer2.u_ClusterCenters[i] = vec4<f32>(sumx / count, sumy / count, count, i);\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\n\\nlayout(std430, set = 0, binding = 0) buffer readonly  GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 1) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_NodeAttributes[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 2) buffer   GWebGPUBuffer2 {\\n  vec4 u_ClusterCenters[];\\n} gWebGPUBuffer2;\\n\\n\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\nvoid main() {int i = globalInvocationID.x;\\nvec4 center = gWebGPUBuffer2.u_ClusterCenters[i];\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = gWebGPUBuffer1.u_NodeAttributes[j];\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = gWebGPUBuffer0.u_Data[j];\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngWebGPUBuffer2.u_ClusterCenters[i] = vec4(sumx / count, sumy / count, count, i);}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributes;\\nuniform vec2 u_NodeAttributesSize;\\nvec4 getDatau_NodeAttributes(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributes, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributes(float address1D) {\\n  return getDatau_NodeAttributes(addrTranslation_1Dto2D(address1D, u_NodeAttributesSize));\\n}\\nvec4 getDatau_NodeAttributes(int address1D) {\\n  return getDatau_NodeAttributes(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 center = getDatau_ClusterCenters(i);\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = getDatau_NodeAttributes(j);\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = getDatau_Data(j);\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngl_FragColor = vec4(vec4(sumx / count, sumy / count, count, i));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"CLUSTER_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributes","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_ClusterCenters","size":[1,1],"length":1},"needPingpong":true}}';var am=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(d){try{f(r.next(d))}catch(h){o(h)}}function c(d){try{f(r.throw(d))}catch(h){o(h)}}function f(d){d.done?a(d.value):i(d.value).then(s,c)}f((r=r.apply(e,t||[])).next())})};class JC extends ar{constructor(t){super();this.maxIteration=1e3,this.gravity=10,this.speed=1,this.clustering=!1,this.clusterField="cluster",this.clusterGravity=10,this.workerEnabled=!1,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(t)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10}}execute(){return am(this,void 0,void 0,function*(){const t=this,n=t.nodes;if(!n||n.length===0){t.onLayoutEnd&&t.onLayoutEnd();return}!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight),t.center||(t.center=[t.width/2,t.height/2]);const r=t.center;if(n.length===1){n[0].x=r[0],n[0].y=r[1],t.onLayoutEnd&&t.onLayoutEnd();return}const i={},a={};n.forEach((o,s)=>{Z(o.x)||(o.x=Math.random()*this.width),Z(o.y)||(o.y=Math.random()*this.height),i[o.id]=o,a[o.id]=s}),t.nodeMap=i,t.nodeIdxMap=a,yield t.run()})}executeWithWorker(t,n){return am(this,void 0,void 0,function*(){const r=this,i=r.nodes,a=r.center;if(!i||i.length===0)return;if(i.length===1){i[0].x=a[0],i[0].y=a[1];return}const o={},s={};i.forEach((c,f)=>{Z(c.x)||(c.x=Math.random()*this.width),Z(c.y)||(c.y=Math.random()*this.height),o[c.id]=c,s[c.id]=f}),r.nodeMap=o,r.nodeIdxMap=s,yield r.run(t,n)})}run(t,n){return am(this,void 0,void 0,function*(){const r=this,i=r.nodes,a=r.edges,o=r.maxIteration,s=r.center,c=r.height*r.width;let f=Math.sqrt(c)/10;const d=c/(i.length+1),h=Math.sqrt(d),v=r.speed,m=r.clustering,{array:g,count:_}=$C([r.clusterField],i);i.forEach((de,Ie)=>{let ie=0,ke=0;Z(de.fx)&&Z(de.fy)&&(ie=de.fx||.001,ke=de.fy||.001),g[4*Ie+1]=ie,g[4*Ie+2]=ke});const y=i.length,{maxEdgePerVetex:E,array:b}=HC(i,a),A=r.workerEnabled;let C;A?C=im.create({canvas:t,engineOptions:{supportCompute:!0}}):C=im.create({engineOptions:{supportCompute:!0}});const R=r.onLayoutEnd,z=[];for(let de=0;de<_;de++)z.push(0,0,0,0);const ee=C.createKernel(YC).setDispatch([y,1,1]).setBinding({u_Data:b,u_K:h,u_K2:d,u_Gravity:r.gravity,u_ClusterGravity:r.clusterGravity||r.gravity||1,u_Speed:v,u_MaxDisplace:f,u_Clustering:m?1:0,u_Center:s,u_AttributeArray:g,u_ClusterCenters:z,MAX_EDGE_PER_VERTEX:E,VERTEX_COUNT:y});let Q;m&&(Q=C.createKernel(KC).setDispatch([_,1,1]).setBinding({u_Data:b,u_NodeAttributes:g,u_ClusterCenters:z,VERTEX_COUNT:y,CLUSTER_COUNT:_})),yield(()=>am(this,void 0,void 0,function*(){for(let Ie=0;Ie<o;Ie++)yield ee.execute(),m&&(Q.setBinding({u_Data:ee}),yield Q.execute(),ee.setBinding({u_ClusterCenters:Q})),ee.setBinding({u_MaxDisplace:f*=.99});const de=yield ee.getOutput();t?n.postMessage({type:Ye.GPUEND,vertexEdgeData:de}):i.forEach((Ie,ie)=>{const ke=de[4*ie],Ve=de[4*ie+1];Ie.x=ke,Ie.y=Ve}),R&&R()}))()})}getType(){return"fruchterman-gpu"}}const IN=null,qC='{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_damping : f32;\\n  [[offset 4]] u_maxSpeed : f32;\\n  [[offset 8]] u_minMovement : f32;\\n  \\n  [[offset 12]] u_coulombDisScale : f32;\\n  [[offset 16]] u_factor : f32;\\n  \\n  \\n  [[offset 20]] u_interval : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AveMovement : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributeArray1 : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 3, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\ntype GWebGPUBuffer3 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributeArray2 : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 4, set 0]] var<storage_buffer> gWebGPUBuffer3 : GWebGPUBuffer3;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn unpack_float(packedValue : f32) -> vec2<i32> {var packedIntValue : i32 = i32(packedValue);\\nvar v0 : i32 = packedIntValue / 1048576;\\nreturn vec2<i32>(v0, packedIntValue - (v0 * 1048576));}\\nfn calcRepulsive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {if (i != j) {var nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nvar vx : f32 = currentNode.x - nextNode.x;\\nvar vy : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.01;\\nvar n_dist : f32 = (dist + 0.1) * gWebGPUUniformParams.u_coulombDisScale;\\nvar direx : f32 = vx / dist;\\nvar direy : f32 = vy / dist;\\nvar attributesi : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvar attributesj : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[j];\\nvar massi : f32 = attributesi.x;\\nvar nodeStrengthi : f32 = attributesi.z;\\nvar nodeStrengthj : f32 = attributesj.z;\\nvar nodeStrength : f32 = (nodeStrengthi + nodeStrengthj) / 2.0;\\nvar param : f32 = (nodeStrength * gWebGPUUniformParams.u_factor) / (n_dist * n_dist);\\nax = ax + direx * param;\\nay = ay + direy * param;}}\\nreturn vec2<f32>(ax, ay);}\\nfn calcGravity(i : i32, currentNode : vec4<f32>, attributes2 : vec4<f32>) -> vec2<f32> {var vx : f32 = currentNode.x - attributes2.x;\\nvar vy : f32 = currentNode.y - attributes2.y;\\nvar ax : f32 = vx * attributes2.z;\\nvar ay : f32 = vy * attributes2.z;\\nreturn vec2<f32>(ax, ay);}\\nfn calcAttractive(i : i32, currentNode : vec4<f32>, attributes1 : vec4<f32>) -> vec2<f32> {var mass : f32 = attributes1.x;\\nvar ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nvar compressed : vec2<i32> = unpack_float(currentNode.z);\\nvar length : i32 = compressed.x;\\nvar arr_offset : i32 = compressed.y;\\nvar node_buffer : vec4<f32>;\\nfor (var p : i32 = 0; p < __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX; p = p + 1) {if (p >= length) {break;}\\nvar arr_idx : i32 = arr_offset + (4 * p);\\nvar buf_offset : i32 = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[i32(arr_idx / 4)];}\\nvar float_j : f32 = node_buffer.x;\\nvar nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[i32(float_j)];\\nvar vx : f32 = nextNode.x - currentNode.x;\\nvar vy : f32 = nextNode.y - currentNode.y;\\nvar dist : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.01;\\nvar direx : f32 = vx / dist;\\nvar direy : f32 = vy / dist;\\nvar edgeLength : f32 = node_buffer.y;\\nvar edgeStrength : f32 = node_buffer.z;\\nvar diff : f32 = edgeLength - dist;\\nvar param : f32 = (diff * edgeStrength) / mass;\\nax = ax - direx * param;\\nay = ay - direy * param;}\\nreturn vec2<f32>(ax, ay);}\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar currentNode : vec4<f32> = gWebGPUBuffer0.u_Data[i];\\nvar movement : vec4<f32> = gWebGPUBuffer1.u_AveMovement[0];\\nvar ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nif ((i >= __DefineValuePlaceholder__VERTEX_COUNT) || (movement.x < gWebGPUUniformParams.u_minMovement)) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvar nodeAttributes1 : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvar nodeAttributes2 : vec4<f32> = gWebGPUBuffer3.u_NodeAttributeArray2[i];\\nvar repulsive : vec2<f32> = calcRepulsive(i, currentNode);\\nax = ax + repulsive.x;\\nay = ay + repulsive.y;\\nvar attractive : vec2<f32> = calcAttractive(i, currentNode, nodeAttributes1);\\nax = ax + attractive.x;\\nay = ay + attractive.y;\\nvar gravity : vec2<f32> = calcGravity(i, currentNode, nodeAttributes2);\\nax = ax - gravity.x;\\nay = ay - gravity.y;\\nvar param : f32 = gWebGPUUniformParams.u_interval * gWebGPUUniformParams.u_damping;\\nvar vx : f32 = ax * param;\\nvar vy : f32 = ay * param;\\nvar vlength : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > gWebGPUUniformParams.u_maxSpeed) {var param2 : f32 = gWebGPUUniformParams.u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nvar distx : f32 = vx * gWebGPUUniformParams.u_interval;\\nvar disty : f32 = vy * gWebGPUUniformParams.u_interval;\\nvar distLength : f32 = std::sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4<f32>(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0);}else {gWebGPUBuffer0.u_Data[i] = vec4<f32>(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength);}\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_damping;\\n  float u_maxSpeed;\\n  float u_minMovement;\\n  \\n  float u_coulombDisScale;\\n  float u_factor;\\n  \\n  \\n  float u_interval;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer   GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_AveMovement[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 3) buffer readonly  GWebGPUBuffer2 {\\n  vec4 u_NodeAttributeArray1[];\\n} gWebGPUBuffer2;\\n\\nlayout(std430, set = 0, binding = 4) buffer readonly  GWebGPUBuffer3 {\\n  vec4 u_NodeAttributeArray2[];\\n} gWebGPUBuffer3;\\n\\n\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nivec2 unpack_float(float packedValue) {int packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {float ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = gWebGPUBuffer0.u_Data[j];\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * gWebGPUUniformParams.u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvec4 attributesj = gWebGPUBuffer2.u_NodeAttributeArray1[j];\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * gWebGPUUniformParams.u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {float vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {float mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[int(arr_idx / 4)];}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = gWebGPUBuffer0.u_Data[int(float_j)];\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {int i = globalInvocationID.x;\\nvec4 currentNode = gWebGPUBuffer0.u_Data[i];\\nvec4 movement = gWebGPUBuffer1.u_AveMovement[0];\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < gWebGPUUniformParams.u_minMovement)) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvec4 nodeAttributes1 = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvec4 nodeAttributes2 = gWebGPUBuffer3.u_NodeAttributeArray2[i];\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = gWebGPUUniformParams.u_interval * gWebGPUUniformParams.u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > gWebGPUUniformParams.u_maxSpeed) {float param2 = gWebGPUUniformParams.u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nfloat distx = vx * gWebGPUUniformParams.u_interval;\\nfloat disty = vy * gWebGPUUniformParams.u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0);}else {gWebGPUBuffer0.u_Data[i] = vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength);}}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_damping;\\nuniform float u_maxSpeed;\\nuniform float u_minMovement;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nuniform float u_coulombDisScale;\\nuniform float u_factor;\\nuniform sampler2D u_NodeAttributeArray1;\\nuniform vec2 u_NodeAttributeArray1Size;\\nvec4 getDatau_NodeAttributeArray1(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray1, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray1(float address1D) {\\n  return getDatau_NodeAttributeArray1(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray1Size));\\n}\\nvec4 getDatau_NodeAttributeArray1(int address1D) {\\n  return getDatau_NodeAttributeArray1(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributeArray2;\\nuniform vec2 u_NodeAttributeArray2Size;\\nvec4 getDatau_NodeAttributeArray2(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray2, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray2(float address1D) {\\n  return getDatau_NodeAttributeArray2(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray2Size));\\n}\\nvec4 getDatau_NodeAttributeArray2(int address1D) {\\n  return getDatau_NodeAttributeArray2(float(address1D));\\n}\\nuniform float u_interval;\\nivec2 unpack_float(float packedValue) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = getDatau_NodeAttributeArray1(i);\\nvec4 attributesj = getDatau_NodeAttributeArray1(j);\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nvec4 movement = getDatau_AveMovement(0.0);\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < u_minMovement)) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes1 = getDatau_NodeAttributeArray1(i);\\nvec4 nodeAttributes2 = getDatau_NodeAttributeArray2(i);\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = u_interval * u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > u_maxSpeed) {float param2 = u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nfloat distx = vx * u_interval;\\nfloat disty = vy * u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0));}else {gl_FragColor = vec4(vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"SHIFT_20","type":"Float","value":1048576,"runtime":false}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_damping","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_maxSpeed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_minMovement","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_coulombDisScale","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_factor","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray1","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray2","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_interval","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}',CN=null,QC='{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_iter : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AveMovement : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\n\\n\\n\\n\\n\\n\\n\\n\\nfn main() -> void {var movement : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {var vertex : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nmovement = movement + vertex.w;}\\nmovement = movement / f32(__DefineValuePlaceholder__VERTEX_COUNT);\\ngWebGPUBuffer1.u_AveMovement[0] = vec4<f32>(movement, 0.0, 0.0, 0.0);\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_iter;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer readonly  GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer   GWebGPUBuffer1 {\\n  vec4 u_AveMovement[];\\n} gWebGPUBuffer1;\\n\\n\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\nvoid main() {float movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = gWebGPUBuffer0.u_Data[j];\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngWebGPUBuffer1.u_AveMovement[0] = vec4(movement, 0.0, 0.0, 0.0);}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_iter;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = getDatau_Data(j);\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngl_FragColor = vec4(vec4(movement, 0.0, 0.0, 0.0));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_iter","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_AveMovement","size":[1,1],"length":1},"needPingpong":true}}';var Gy=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(d){try{f(r.next(d))}catch(h){o(h)}}function c(d){try{f(r.throw(d))}catch(h){o(h)}}function f(d){d.done?a(d.value):i(d.value).then(s,c)}f((r=r.apply(e,t||[])).next())})};class eR extends ar{constructor(t){super();this.maxIteration=1e3,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.5,this.interval=.02,this.factor=1,this.linkDistance=1,this.gravity=10,this.workerEnabled=!1,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(t)}getDefaultCfg(){return{maxIteration:2e3,gravity:10,clustering:!1,clusterGravity:10}}execute(){return Gy(this,void 0,void 0,function*(){const t=this,n=t.nodes;if(!n||n.length===0){t.onLayoutEnd&&t.onLayoutEnd();return}!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight),t.center||(t.center=[t.width/2,t.height/2]);const r=t.center;if(n.length===1){n[0].x=r[0],n[0].y=r[1],t.onLayoutEnd&&t.onLayoutEnd();return}const i={},a={};n.forEach((o,s)=>{Z(o.x)||(o.x=Math.random()*t.width),Z(o.y)||(o.y=Math.random()*t.height),i[o.id]=o,a[o.id]=s}),t.nodeMap=i,t.nodeIdxMap=a,t.nodeStrength=Nh(t.nodeStrength,1),t.edgeStrength=Nh(t.edgeStrength,1),yield t.run()})}executeWithWorker(t,n){const r=this,i=r.nodes,a=r.center;if(!i||i.length===0)return;if(i.length===1){i[0].x=a[0],i[0].y=a[1];return}const o={},s={};i.forEach((c,f)=>{Z(c.x)||(c.x=Math.random()*r.width),Z(c.y)||(c.y=Math.random()*r.height),o[c.id]=c,s[c.id]=f}),r.nodeMap=o,r.nodeIdxMap=s,r.nodeStrength=Nh(r.nodeStrength,1),r.edgeStrength=Nh(r.edgeStrength,1),r.run(t,n)}run(t,n){return Gy(this,void 0,void 0,function*(){const r=this,i=r.nodes,a=r.edges,o=r.maxIteration;!r.width&&typeof window!="undefined"&&(r.width=window.innerWidth),!r.height&&typeof window!="undefined"&&(r.height=window.innerHeight);const s=i.length;r.linkDistance=Nh(r.linkDistance),r.edgeStrength=Nh(r.edgeStrength);const{maxEdgePerVetex:c,array:f}=XC(i,a,r.linkDistance,r.edgeStrength);r.degrees=Ht(i.length,r.nodeIdxMap,a).map(ie=>ie.all);const d=[],h=[],v=[],m=[],g=[],_=[],y=[];r.getMass||(r.getMass=ie=>r.degrees[r.nodeIdxMap[ie.id]]||1);const E=r.gravity,b=r.center;i.forEach((ie,ke)=>{d.push(r.getMass(ie)),h.push(r.nodeStrength(ie)),r.degrees[ke]||(r.degrees[ke]=0);let Ve=[b[0],b[1],E];if(r.getCenter){const Rt=r.getCenter(ie,r.degrees[ke]);Rt&&Z(Rt[0])&&Z(Rt[1])&&Z(Rt[2])&&(Ve=Rt)}v.push(Ve[0]),m.push(Ve[1]),g.push(Ve[2]),Z(ie.fx)&&Z(ie.fy)?(_.push(ie.fx||.001),y.push(ie.fy||.001)):(_.push(0),y.push(0))});const A=Fx([d,r.degrees,h,_]),C=Fx([v,m,g,y]),R=r.workerEnabled;let z;R?z=im.create({canvas:t,engineOptions:{supportCompute:!0}}):z=im.create({engineOptions:{supportCompute:!0}});const ee=r.onLayoutEnd,Q=[];f.forEach(ie=>{Q.push(ie)});for(let ie=0;ie<4;ie++)Q.push(0);const re=z.createKernel(qC).setDispatch([s,1,1]).setBinding({u_Data:f,u_damping:r.damping,u_maxSpeed:r.maxSpeed,u_minMovement:r.minMovement,u_coulombDisScale:r.coulombDisScale,u_factor:r.factor,u_NodeAttributeArray1:A,u_NodeAttributeArray2:C,MAX_EDGE_PER_VERTEX:c,VERTEX_COUNT:s,u_AveMovement:Q,u_interval:r.interval}),de=z.createKernel(QC).setDispatch([1,1,1]).setBinding({u_Data:f,VERTEX_COUNT:s,u_AveMovement:[0,0,0,0]});yield(()=>Gy(this,void 0,void 0,function*(){for(let ke=0;ke<o;ke++){yield re.execute(),de.setBinding({u_Data:re}),yield de.execute();const Ve=Math.max(.02,r.interval-ke*.002);re.setBinding({u_interval:Ve,u_AveMovement:de})}const ie=yield re.getOutput();t?n.postMessage({type:Ye.GPUEND,vertexEdgeData:ie}):i.forEach((ke,Ve)=>{const Rt=ie[4*Ve],dn=ie[4*Ve+1];ke.x=Rt,ke.y=dn}),ee&&ee()}))()})}getType(){return"gForce-gpu"}}class tR extends ar{constructor(t){super();this.center=[0,0],this.maxIteration=100,this.gravity=10,this.comboGravity=10,this.linkDistance=10,this.alpha=1,this.alphaMin=.001,this.alphaDecay=1-Math.pow(this.alphaMin,1/300),this.alphaTarget=0,this.velocityDecay=.6,this.edgeStrength=.6,this.nodeStrength=30,this.preventOverlap=!1,this.preventNodeOverlap=!1,this.preventComboOverlap=!1,this.collideStrength=void 0,this.nodeCollideStrength=.5,this.comboCollideStrength=.5,this.comboSpacing=20,this.comboPadding=10,this.optimizeRangeFactor=1,this.onTick=()=>{},this.onLayoutEnd=()=>{},this.depthAttractiveForceScale=1,this.depthRepulsiveForceScale=2,this.nodes=[],this.edges=[],this.combos=[],this.comboTrees=[],this.width=300,this.height=300,this.bias=[],this.nodeMap={},this.oriComboMap={},this.indexMap={},this.comboMap={},this.previousLayouted=!1,this.updateCfg(t)}getDefaultCfg(){return{maxIteration:100,center:[0,0],gravity:10,speed:1,comboGravity:30,preventOverlap:!1,preventComboOverlap:!0,preventNodeOverlap:!0,nodeSpacing:void 0,collideStrength:void 0,nodeCollideStrength:.5,comboCollideStrength:.5,comboSpacing:20,comboPadding:10,edgeStrength:.6,nodeStrength:30,linkDistance:10}}execute(){const t=this,n=t.nodes,r=t.center;if(t.comboTree={id:"comboTreeRoot",depth:-1,children:t.comboTrees},!n||n.length===0){t.onLayoutEnd&&t.onLayoutEnd();return}if(n.length===1){n[0].x=r[0],n[0].y=r[1],t.onLayoutEnd&&t.onLayoutEnd();return}t.initVals(),t.run(),t.onLayoutEnd&&t.onLayoutEnd()}run(){const t=this,n=t.nodes,r=t.previousLayouted?t.maxIteration/5:t.maxIteration;!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight);const i=t.center,a=t.velocityDecay,o=t.comboMap;t.previousLayouted||t.initPos(o);for(let f=0;f<r;f++){const d=[];n.forEach((h,v)=>{d[v]={x:0,y:0}}),t.applyCalculate(d),t.applyComboCenterForce(d),n.forEach((h,v)=>{!Z(h.x)||!Z(h.y)||(h.x+=d[v].x*a,h.y+=d[v].y*a)}),t.alpha+=(t.alphaTarget-t.alpha)*t.alphaDecay,t.onTick()}const s=[0,0];n.forEach(f=>{!Z(f.x)||!Z(f.y)||(s[0]+=f.x,s[1]+=f.y)}),s[0]/=n.length,s[1]/=n.length;const c=[i[0]-s[0],i[1]-s[1]];n.forEach((f,d)=>{!Z(f.x)||!Z(f.y)||(f.x+=c[0],f.y+=c[1])}),t.combos.forEach(f=>{const d=o[f.id];d&&d.empty&&(f.x=d.cx||f.x,f.y=d.cy||f.y)}),t.previousLayouted=!0}initVals(){const t=this,n=t.edges,r=t.nodes,i=t.combos,a={},o={},s={};r.forEach((de,Ie)=>{o[de.id]=de,s[de.id]=Ie}),t.nodeMap=o,t.indexMap=s;const c={};i.forEach(de=>{c[de.id]=de}),t.oriComboMap=c,t.comboMap=t.getComboMap();const f=t.preventOverlap;t.preventComboOverlap=t.preventComboOverlap||f,t.preventNodeOverlap=t.preventNodeOverlap||f;const d=t.collideStrength;d&&(t.comboCollideStrength=d,t.nodeCollideStrength=d),t.comboCollideStrength=t.comboCollideStrength?t.comboCollideStrength:0,t.nodeCollideStrength=t.nodeCollideStrength?t.nodeCollideStrength:0;for(let de=0;de<n.length;++de){const Ie=We(n[de],"source"),ie=We(n[de],"target");a[Ie]?a[Ie]++:a[Ie]=1,a[ie]?a[ie]++:a[ie]=1}const h=[];for(let de=0;de<n.length;++de){const Ie=We(n[de],"source"),ie=We(n[de],"target");h[de]=a[Ie]/(a[Ie]+a[ie])}this.bias=h;const v=t.nodeSize,m=t.nodeSpacing;let g,_;if(Z(m)?_=()=>m:vt(m)?_=m:_=()=>0,this.nodeSpacing=_,!v)g=de=>de.size?V(de.size)?(de.size[0]>de.size[1]?de.size[0]:de.size[1])/2:be(de.size)?(de.size.width>de.size.height?de.size.width:de.size.height)/2:de.size/2:10;else if(vt(v))g=de=>v(de);else if(V(v)){const Ie=(v[0]>v[1]?v[0]:v[1])/2;g=ie=>Ie}else{const de=v/2;g=Ie=>de}this.nodeSize=g;const y=t.comboSpacing;let E;Z(y)?E=()=>y:vt(y)?E=y:E=()=>0,this.comboSpacing=E;const b=t.comboPadding;let A;Z(b)?A=()=>b:V(b)?A=()=>Math.max.apply(null,b):vt(b)?A=b:A=()=>0,this.comboPadding=A;let C=this.linkDistance,R;C||(C=10),Z(C)?R=de=>C:R=C,this.linkDistance=R;let z=this.edgeStrength,ee;z||(z=1),Z(z)?ee=de=>z:ee=z,this.edgeStrength=ee;let Q=this.nodeStrength,re;Q||(Q=30),Z(Q)?re=de=>Q:re=Q,this.nodeStrength=re}initPos(t){this.nodes.forEach((i,a)=>{const o=i.comboId,s=t[o];o&&s?(i.x=s.cx+100/(a+1),i.y=s.cy+100/(a+1)):(i.x=100/(a+1),i.y=100/(a+1))})}getComboMap(){const t=this,n=t.nodeMap,r=t.comboTrees,i=t.oriComboMap,a={};return(r||[]).forEach(o=>{const s=[];Re(o,c=>{if(c.itemType==="node"||!i[c.id])return!0;if(a[c.id]===void 0){const h={id:c.id,name:c.id,cx:0,cy:0,count:0,depth:t.oriComboMap[c.id].depth||0,children:[]};a[c.id]=h}const f=c.children;f&&f.forEach(h=>{if(!a[h.id]&&!n[h.id])return!0;s.push(h)});const d=a[c.id];if(d.cx=0,d.cy=0,s.length===0){d.empty=!0;const h=i[c.id];d.cx=h.x,d.cy=h.y}return s.forEach(h=>{if(d.count++,h.itemType!=="node"){const m=a[h.id];Z(m.cx)&&(d.cx+=m.cx),Z(m.cy)&&(d.cy+=m.cy);return}const v=n[h.id];!v||(Z(v.x)&&(d.cx+=v.x),Z(v.y)&&(d.cy+=v.y))}),d.cx/=d.count||1,d.cy/=d.count||1,d.children=s,!0})}),a}applyComboCenterForce(t){const n=this,r=n.gravity,i=n.comboGravity||r,a=this.alpha,o=n.comboTrees,s=n.indexMap,c=n.nodeMap,f=n.comboMap;(o||[]).forEach(d=>{Re(d,h=>{if(h.itemType==="node"||!f[h.id])return!0;const m=f[h.id],g=(m.depth+1)/10*.5,_=m.cx,y=m.cy;return m.cx=0,m.cy=0,m.children.forEach(E=>{if(E.itemType!=="node"){const Q=f[E.id];Q&&Z(Q.cx)&&(m.cx+=Q.cx),Q&&Z(Q.cy)&&(m.cy+=Q.cy);return}const b=c[E.id],A=b.x-_||.005,C=b.y-y||.005,R=Math.sqrt(A*A+C*C),z=s[b.id],ee=i*a/R*g;t[z].x-=A*ee,t[z].y-=C*ee,Z(b.x)&&(m.cx+=b.x),Z(b.y)&&(m.cy+=b.y)}),m.cx/=m.count||1,m.cy/=m.count||1,!0})})}applyCalculate(t){const n=this,r=n.comboMap,i=n.nodes,a={};i.forEach((s,c)=>{i.forEach((f,d)=>{if(c<d)return;const h=s.x-f.x||.005,v=s.y-f.y||.005;let m=h*h+v*v;const g=Math.sqrt(m);m<1&&(m=g),a[`${s.id}-${f.id}`]={vx:h,vy:v,vl2:m,vl:g},a[`${f.id}-${s.id}`]={vl2:m,vl:g,vx:-h,vy:-v}})}),n.updateComboSizes(r),n.calRepulsive(t,a),n.calAttractive(t,a),n.preventComboOverlap&&n.comboNonOverlapping(t,r)}updateComboSizes(t){const n=this,r=n.comboTrees,i=n.nodeMap,a=n.nodeSize,o=n.comboSpacing,s=n.comboPadding;(r||[]).forEach(c=>{const f=[];Re(c,d=>{if(d.itemType==="node")return!0;const h=t[d.id];if(!h)return!1;const v=d.children;v&&v.forEach(_=>{!t[_.id]&&!i[_.id]||f.push(_)}),h.minX=Infinity,h.minY=Infinity,h.maxX=-Infinity,h.maxY=-Infinity,f.forEach(_=>{if(_.itemType!=="node")return!0;const y=i[_.id];if(!y)return!0;const E=a(y),b=y.x-E,A=y.y-E,C=y.x+E,R=y.y+E;h.minX>b&&(h.minX=b),h.minY>A&&(h.minY=A),h.maxX<C&&(h.maxX=C),h.maxY<R&&(h.maxY=R)});let m=n.oriComboMap[d.id].size||10;V(m)&&(m=m[0]);const g=Math.max(h.maxX-h.minX,h.maxY-h.minY,m);return h.r=g/2+o(h)/2+s(h),!0})})}comboNonOverlapping(t,n){const r=this,i=r.comboTree,a=r.comboCollideStrength,o=r.indexMap,s=r.nodeMap;Re(i,c=>{if(!n[c.id]&&!s[c.id]&&c.id!=="comboTreeRoot")return!1;const f=c.children;return f&&f.length>1&&f.forEach((d,h)=>{if(d.itemType==="node")return!1;const v=n[d.id];!v||f.forEach((m,g)=>{if(h<=g||m.itemType==="node")return!1;const _=n[m.id];if(!_)return!1;const y=v.cx-_.cx||.005,E=v.cy-_.cy||.005,b=y*y+E*E,A=v.r||1,C=_.r||1,R=A+C,z=C*C,ee=A*A;if(b<R*R){const Q=d.children;if(!Q||Q.length===0)return!1;const re=m.children;if(!re||re.length===0)return!1;const de=Math.sqrt(b),Ie=(R-de)/de*a,ie=y*Ie,ke=E*Ie,Ve=z/(ee+z),Rt=1-Ve;Q.forEach(dn=>{if(dn.itemType!=="node")return!1;if(!s[dn.id])return;const ln=o[dn.id];re.forEach(pn=>{if(pn.itemType!=="node"||!s[pn.id])return!1;const lr=o[pn.id];t[ln].x+=ie*Ve,t[ln].y+=ke*Ve,t[lr].x-=ie*Rt,t[lr].y-=ke*Rt})})}})}),!0})}calRepulsive(t,n){const r=this,i=r.nodes,a=r.width*r.optimizeRangeFactor,o=r.nodeStrength,s=r.alpha,c=r.nodeCollideStrength,f=r.preventNodeOverlap,d=r.nodeSize,h=r.nodeSpacing,v=r.depthRepulsiveForceScale,m=r.center;i.forEach((g,_)=>{if(!(!g.x||!g.y)){if(m){const y=r.gravity,E=g.x-m[0]||.005,b=g.y-m[1]||.005,A=Math.sqrt(E*E+b*b);t[_].x-=E*y*s/A,t[_].y-=b*y*s/A}i.forEach((y,E)=>{if(_===E||!y.x||!y.y)return;const{vl2:b,vl:A}=n[`${g.id}-${y.id}`];if(A>a)return;const{vx:C,vy:R}=n[`${g.id}-${y.id}`];let z=Math.log(Math.abs(y.depth-g.depth)/10)+1||1;z=z<1?1:z,y.comboId!==g.comboId&&(z+=1);const ee=z?Math.pow(v,z):1,Q=o(y)*s/b*ee;if(t[_].x+=C*Q,t[_].y+=R*Q,_<E&&f){const re=d(g)+h(g)||1,de=d(y)+h(y)||1,Ie=re+de;if(b<Ie*Ie){const ie=(Ie-A)/A*c,ke=de*de;let Ve=ke/(re*re+ke);const Rt=C*ie,dn=R*ie;t[_].x+=Rt*Ve,t[_].y+=dn*Ve,Ve=1-Ve,t[E].x-=Rt*Ve,t[E].y-=dn*Ve}}})}})}calAttractive(t,n){const r=this,i=r.edges,a=r.linkDistance,o=r.alpha,s=r.edgeStrength,c=r.bias,f=r.depthAttractiveForceScale;i.forEach((d,h)=>{const v=We(d,"source"),m=We(d,"target");if(!v||!m||v===m)return;const g=r.indexMap[v],_=r.indexMap[m],y=r.nodeMap[v],E=r.nodeMap[m];if(!y||!E)return;let b=y.depth===E.depth?0:Math.log(Math.abs(y.depth-E.depth)/10);y.comboId===E.comboId&&(b=b/2);let A=b?Math.pow(f,b):1;if(y.comboId!==E.comboId&&A===1?A=f/2:y.comboId===E.comboId&&(A=2),!Z(E.x)||!Z(y.x)||!Z(E.y)||!Z(y.y))return;const{vl:C,vx:R,vy:z}=n[`${m}-${v}`],ee=(C-a(d))/C*o*s(d)*A,Q=R*ee,re=z*ee,de=c[h];t[_].x-=Q*de,t[_].y-=re*de,t[g].x+=Q*(1-de),t[g].y+=re*(1-de)})}getType(){return"comboForce"}}class nR extends ar{constructor(t){super();this.center=[0,0],this.nodes=[],this.edges=[],this.combos=[],this.comboEdges=[],this.comboPadding=10,this.comboTrees=[],this.updateCfg(t)}getDefaultCfg(){return{}}execute(){const t=this,n=t.nodes,r=t.center;if(!n||n.length===0){t.onLayoutEnd&&t.onLayoutEnd();return}if(n.length===1){n[0].x=r[0],n[0].y=r[1],t.onLayoutEnd&&t.onLayoutEnd();return}t.initVals(),t.run(),t.onLayoutEnd&&t.onLayoutEnd()}run(){var t;const n=this,{nodes:r,edges:i,combos:a,comboEdges:o,center:s}=n,c={};r.forEach(E=>{c[E.id]=E});const f={};a.forEach(E=>{f[E.id]=E});const d=n.getInnerGraphs(c),h=[],v=[],m={};let g=!0;this.comboTrees.forEach(E=>{const b=d[E.id],A=Object.assign(Object.assign({},E),{x:b.x||f[E.id].x,y:b.y||f[E.id].y,fx:b.fx||f[E.id].fx,fy:b.fy||f[E.id].fy,mass:b.mass||f[E.id].mass,size:b.size});v.push(A),!isNaN(A.x)&&A.x!==0&&!isNaN(A.y)&&A.y!==0?g=!1:(A.x=Math.random()*100,A.y=Math.random()*100),h.push(E.id),Re(E,C=>(C.id!==E.id&&(m[C.id]=E.id),!0))}),r.forEach(E=>{if(E.comboId&&f[E.comboId])return;const b=Object.assign({},E);v.push(b),!isNaN(b.x)&&b.x!==0&&!isNaN(b.y)&&b.y!==0?g=!1:(b.x=Math.random()*100,b.y=Math.random()*100),h.push(E.id)});const _=[];if(i.concat(o).forEach(E=>{const b=m[E.source]||E.source,A=m[E.target]||E.target;b!==A&&h.includes(b)&&h.includes(A)&&_.push({source:b,target:A})}),v==null?void 0:v.length){if(v.length===1)v[0].x=s[0],v[0].y=s[1];else{const E={nodes:v,edges:_},b=this.outerLayout||new ao({gravity:1,factor:2,linkDistance:(C,R,z)=>{var ee,Q;const re=((((ee=R.size)===null||ee===void 0?void 0:ee[0])||30)+(((Q=z.size)===null||Q===void 0?void 0:Q[0])||30))/2;return Math.min(re*1.5,700)}}),A=(t=b.getType)===null||t===void 0?void 0:t.call(b);b.updateCfg({center:s,kg:5,preventOverlap:!0,animate:!1}),g&&Ne[A]&&(v.length<100?new y1:new Gi).layout(E),b.layout(E)}v.forEach(E=>{const b=d[E.id];if(!b){const A=c[E.id];A&&(A.x=E.x,A.y=E.y);return}b.visited=!0,b.x=E.x,b.y=E.y,b.nodes.forEach(A=>{A.x+=E.x,A.y+=E.y})})}const y=Object.keys(d);for(let E=y.length-1;E>=0;E--){const b=y[E],A=d[b];!A||(A.nodes.forEach(C=>{A.visited||(C.x+=A.x||0,C.y+=A.y||0),c[C.id]&&(c[C.id].x=C.x,c[C.id].y=C.y)}),f[b]&&(f[b].x=A.x,f[b].y=A.y))}return{nodes:r,edges:i,combos:a,comboEdges:o}}getInnerGraphs(t){const n=this,{comboTrees:r,nodeSize:i,edges:a,comboPadding:o,spacing:s}=n,c={},f=this.innerLayout||new g1({sortBy:"id"});return f.center=[0,0],f.preventOverlap=!0,f.nodeSpacing=s,(r||[]).forEach(d=>{Re(d,h=>{var v;let m=(o==null?void 0:o(h))||10;if(V(m)&&(m=Math.max(...m)),(v=h.children)===null||v===void 0?void 0:v.length){const g=h.children.map(ee=>{if(ee.itemType==="combo")return c[ee.id];const Q=t[ee.id]||{};return Object.assign(Object.assign({},Q),ee)}),_=g.map(ee=>ee.id),y={nodes:g,edges:a.filter(ee=>_.includes(ee.source)&&_.includes(ee.target))};let E=Infinity;g.forEach(ee=>{var Q;ee.size||(ee.size=((Q=c[ee.id])===null||Q===void 0?void 0:Q.size)||(i==null?void 0:i(ee))||[30,30]),Z(ee.size)&&(ee.size=[ee.size,ee.size]),E>ee.size[0]&&(E=ee.size[0]),E>ee.size[1]&&(E=ee.size[1])}),f.layout(y);const{minX:b,minY:A,maxX:C,maxY:R}=Dt(g),z=Math.max(C-b,R-A,E)+m*2;c[h.id]={id:h.id,nodes:g,size:[z,z]}}else if(h.itemType==="combo"){const g=m?[m*2,m*2]:[30,30];c[h.id]={id:h.id,nodes:[],size:g}}return!0})}),c}initVals(){const t=this,n=t.nodeSize,r=t.spacing;let i,a;if(Z(r)?a=()=>r:vt(r)?a=r:a=()=>0,this.spacing=a,!n)i=c=>{const f=a(c);return c.size?V(c.size)?((c.size[0]>c.size[1]?c.size[0]:c.size[1])+f)/2:be(c.size)?((c.size.width>c.size.height?c.size.width:c.size.height)+f)/2:(c.size+f)/2:10+f/2};else if(vt(n))i=c=>{const f=n(c),d=a(c);return V(c.size)?((c.size[0]>c.size[1]?c.size[0]:c.size[1])+d)/2:((f||10)+d)/2};else if(V(n)){const f=(n[0]>n[1]?n[0]:n[1])/2;i=d=>f+a(d)/2}else{const c=n/2;i=f=>c+a(f)/2}this.nodeSize=i;const o=t.comboPadding;let s;Z(o)?s=()=>o:V(o)?s=()=>Math.max.apply(null,o):vt(o)?s=o:s=()=>0,this.comboPadding=s}getType(){return"comboCombined"}}class ky{constructor(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}distanceTo(t){const n=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(n,r)}setPos(t,n){this.rx=t,this.ry=n}resetForce(){this.fx=0,this.fy=0}addForce(t){const n=t.rx-this.rx,r=t.ry-this.ry;let i=Math.hypot(n,r);i=i<1e-4?1e-4:i;const a=this.g*(this.degree+1)*(t.degree+1)/i;this.fx+=a*n/i,this.fy+=a*r/i}in(t){return t.contains(this.rx,this.ry)}add(t){const n=this.mass+t.mass,r=(this.rx*this.mass+t.rx*t.mass)/n,i=(this.ry*this.mass+t.ry*t.mass)/n,a=this.degree+t.degree,o={rx:r,ry:i,mass:n,degree:a};return new ky(o)}}class Dh{constructor(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}getLength(){return this.length}contains(t,n){const r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&n<=this.ymid+r&&n>=this.ymid-r}NW(){const t=this.xmid-this.length/4,n=this.ymid+this.length/4,r=this.length/2,i={xmid:t,ymid:n,length:r};return new Dh(i)}NE(){const t=this.xmid+this.length/4,n=this.ymid+this.length/4,r=this.length/2,i={xmid:t,ymid:n,length:r};return new Dh(i)}SW(){const t=this.xmid-this.length/4,n=this.ymid-this.length/4,r=this.length/2,i={xmid:t,ymid:n,length:r};return new Dh(i)}SE(){const t=this.xmid+this.length/4,n=this.ymid-this.length/4,r=this.length/2,i={xmid:t,ymid:n,length:r};return new Dh(i)}}class Ph{constructor(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,t!=null&&(this.quad=t)}insert(t){if(this.body==null){this.body=t;return}this._isExternal()?(this.quad&&(this.NW=new Ph(this.quad.NW()),this.NE=new Ph(this.quad.NE()),this.SW=new Ph(this.quad.SW()),this.SE=new Ph(this.quad.SE())),this._putBody(this.body),this._putBody(t),this.body=this.body.add(t)):(this.body=this.body.add(t),this._putBody(t))}_putBody(t){!this.quad||(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))}_isExternal(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null}updateForce(t){if(!(this.body==null||t===this.body))if(this._isExternal())t.addForce(this.body);else{const n=this.quad?this.quad.getLength():0,r=this.body.distanceTo(t);n/r<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t))}}}class rR extends ar{constructor(t){super();this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.kr=5,this.kg=1,this.mode="normal",this.preventOverlap=!1,this.dissuadeHubs=!1,this.barnesHut=void 0,this.maxIteration=0,this.ks=.1,this.ksmax=10,this.tao=.1,this.onLayoutEnd=()=>{},this.prune=void 0,this.updateCfg(t)}getDefaultCfg(){return{}}execute(){const t=this,{nodes:n,onLayoutEnd:r,prune:i}=t;let a=t.maxIteration;!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight);const o=[],s=n.length;for(let c=0;c<s;c+=1){const f=n[c];let d=10,h=10;Z(f.size)&&(d=f.size,h=f.size),V(f.size)?(isNaN(f.size[0])||(d=f.size[0]),isNaN(f.size[1])||(h=f.size[1])):be(f.size)&&(d=f.size.width,h=f.size.height),t.getWidth&&!isNaN(t.getWidth(f))&&(h=t.getWidth(f)),t.getHeight&&!isNaN(t.getHeight(f))&&(d=t.getHeight(f));const v=Math.max(d,h);o.push(v)}t.barnesHut===void 0&&s>250&&(t.barnesHut=!0),t.prune===void 0&&s>100&&(t.prune=!0),this.maxIteration===0&&!t.prune?(a=250,s<=200&&s>100?a=1e3:s>200&&(a=1200),this.maxIteration=a):this.maxIteration===0&&i&&(a=100,s<=200&&s>100?a=500:s>200&&(a=950),this.maxIteration=a),t.kr||(t.kr=50,s>100&&s<=500?t.kr=20:s>500&&(t.kr=1)),t.kg||(t.kg=20,s>100&&s<=500?t.kg=10:s>500&&(t.kg=1)),this.nodes=t.updateNodesByForces(o),r()}updateNodesByForces(t){const n=this,{edges:r,maxIteration:i}=n;let a=n.nodes;const o=r.filter(g=>{const _=We(g,"source"),y=We(g,"target");return _!==y}),s=a.length,c=o.length,f=[],d={},h={},v=[];for(let g=0;g<s;g+=1)d[a[g].id]=g,f[g]=0,(a[g].x===void 0||isNaN(a[g].x))&&(a[g].x=Math.random()*1e3),(a[g].y===void 0||isNaN(a[g].y))&&(a[g].y=Math.random()*1e3),v.push({x:a[g].x,y:a[g].y});for(let g=0;g<c;g+=1){let _,y,E=0,b=0;for(let A=0;A<s;A+=1){const C=We(o[g],"source"),R=We(o[g],"target");a[A].id===C?(_=a[A],E=A):a[A].id===R&&(y=a[A],b=A),h[g]={sourceIdx:E,targetIdx:b}}_&&(f[d[_.id]]+=1),y&&(f[d[y.id]]+=1)}let m=i;if(a=this.iterate(m,d,h,c,f,t),n.prune){for(let g=0;g<c;g+=1)f[h[g].sourceIdx]<=1?(a[h[g].sourceIdx].x=a[h[g].targetIdx].x,a[h[g].sourceIdx].y=a[h[g].targetIdx].y):f[h[g].targetIdx]<=1&&(a[h[g].targetIdx].x=a[h[g].sourceIdx].x,a[h[g].targetIdx].y=a[h[g].sourceIdx].y);n.prune=!1,n.barnesHut=!1,m=100,a=this.iterate(m,d,h,c,f,t)}return a}iterate(t,n,r,i,a,o){const s=this;let{nodes:c}=s;const{kr:f,preventOverlap:d}=s,{barnesHut:h}=s,v=c.length;let m=0;const g=100;let _=t;const y=50;let E=[];const b=[],A=[];for(let C=0;C<v;C+=1)if(E[2*C]=0,E[2*C+1]=0,h){const R={id:C,rx:c[C].x,ry:c[C].y,mass:1,g:f,degree:a[C]};A[C]=new ky(R)}for(;_>0;){for(let R=0;R<v;R+=1)b[2*R]=E[2*R],b[2*R+1]=E[2*R+1],E[2*R]=0,E[2*R+1]=0;E=this.getAttrForces(_,y,i,n,r,a,o,E),h&&(d&&_>y||!d)?E=this.getOptRepGraForces(E,A,a):E=this.getRepGraForces(_,y,E,g,o,a);const C=this.updatePos(E,b,m,a);c=C.nodes,m=C.sg,_--,s.tick&&s.tick()}return c}getAttrForces(t,n,r,i,a,o,s,c){const f=this,{nodes:d,preventOverlap:h,dissuadeHubs:v,mode:m,prune:g}=f;for(let _=0;_<r;_+=1){const y=d[a[_].sourceIdx],E=a[_].sourceIdx,b=d[a[_].targetIdx],A=a[_].targetIdx;if(g&&(o[E]<=1||o[A]<=1))continue;const C=[b.x-y.x,b.y-y.y];let R=Math.hypot(C[0],C[1]);R=R<1e-4?1e-4:R,C[0]=C[0]/R,C[1]=C[1]/R,h&&t<n&&(R=R-s[E]-s[A]);let z=R,ee=z;m==="linlog"&&(z=Math.log(1+R),ee=z),v&&(z=R/o[E],ee=R/o[A]),h&&t<n&&R<=0?(z=0,ee=0):h&&t<n&&R>0&&(z=R,ee=R),c[2*i[y.id]]+=z*C[0],c[2*i[b.id]]-=ee*C[0],c[2*i[y.id]+1]+=z*C[1],c[2*i[b.id]+1]-=ee*C[1]}return c}getRepGraForces(t,n,r,i,a,o){const s=this,{nodes:c,preventOverlap:f,kr:d,kg:h,center:v,prune:m}=s,g=c.length;for(let _=0;_<g;_+=1){for(let A=_+1;A<g;A+=1){if(m&&(o[_]<=1||o[A]<=1))continue;const C=[c[A].x-c[_].x,c[A].y-c[_].y];let R=Math.hypot(C[0],C[1]);R=R<1e-4?1e-4:R,C[0]=C[0]/R,C[1]=C[1]/R,f&&t<n&&(R=R-a[_]-a[A]);let z=d*(o[_]+1)*(o[A]+1)/R;f&&t<n&&R<0?z=i*(o[_]+1)*(o[A]+1):f&&t<n&&R===0?z=0:f&&t<n&&R>0&&(z=d*(o[_]+1)*(o[A]+1)/R),r[2*_]-=z*C[0],r[2*A]+=z*C[0],r[2*_+1]-=z*C[1],r[2*A+1]+=z*C[1]}const y=[c[_].x-v[0],c[_].y-v[1]],E=Math.hypot(y[0],y[1]);y[0]=y[0]/E,y[1]=y[1]/E;const b=h*(o[_]+1);r[2*_]-=b*y[0],r[2*_+1]-=b*y[1]}return r}getOptRepGraForces(t,n,r){const i=this,{nodes:a,kg:o,center:s,prune:c}=i,f=a.length;let d=9e10,h=-9e10,v=9e10,m=-9e10;for(let b=0;b<f;b+=1)c&&r[b]<=1||(n[b].setPos(a[b].x,a[b].y),a[b].x>=h&&(h=a[b].x),a[b].x<=d&&(d=a[b].x),a[b].y>=m&&(m=a[b].y),a[b].y<=v&&(v=a[b].y));const g=Math.max(h-d,m-v),_={xmid:(h+d)/2,ymid:(m+v)/2,length:g,massCenter:s,mass:f},y=new Dh(_),E=new Ph(y);for(let b=0;b<f;b+=1)c&&r[b]<=1||n[b].in(y)&&E.insert(n[b]);for(let b=0;b<f;b+=1){if(c&&r[b]<=1)continue;n[b].resetForce(),E.updateForce(n[b]),t[2*b]-=n[b].fx,t[2*b+1]-=n[b].fy;const A=[a[b].x-s[0],a[b].y-s[1]];let C=Math.hypot(A[0],A[1]);C=C<1e-4?1e-4:C,A[0]=A[0]/C,A[1]=A[1]/C;const R=o*(r[b]+1);t[2*b]-=R*A[0],t[2*b+1]-=R*A[1]}return t}updatePos(t,n,r,i){const a=this,{nodes:o,ks:s,tao:c,prune:f,ksmax:d}=a,h=o.length,v=[],m=[];let g=0,_=0;for(let E=0;E<h;E+=1){if(f&&i[E]<=1)continue;const b=[t[2*E]-n[2*E],t[2*E+1]-n[2*E+1]],A=Math.hypot(b[0],b[1]),C=[t[2*E]+n[2*E],t[2*E+1]+n[2*E+1]],R=Math.hypot(C[0],C[1]);v[E]=A,m[E]=R/2,g+=(i[E]+1)*v[E],_+=(i[E]+1)*m[E]}const y=r;r=c*_/g,y!==0&&(r=r>1.5*y?1.5*y:r);for(let E=0;E<h;E+=1){if(f&&i[E]<=1||Z(o[E].fx)&&Z(o[E].fy))continue;let b=s*r/(1+r*Math.sqrt(v[E])),A=Math.hypot(t[2*E],t[2*E+1]);A=A<1e-4?1e-4:A;const C=d/A;b=b>C?C:b;const R=b*t[2*E],z=b*t[2*E+1];o[E].x+=R,o[E].y+=z}return{nodes:o,sg:r}}}class Jc{constructor(){this.cells=[],this.columnNum=0,this.rowNum=0,this.additionColumn=[],this.additionRow=[]}init(t,n,r){this.cells=[],this.CELL_W=r.CELL_W||Jc.DEFAULT_CELL_W,this.CELL_H=r.CELL_H||Jc.DEFAULT_CELL_H,this.columnNum=Math.ceil(t/this.CELL_W),this.rowNum=Math.ceil(n/this.CELL_H),Jc.MIN_DIST=Math.pow(t,2)+Math.pow(n,2);for(let i=0;i<this.columnNum;i++){const a=[];for(let o=0;o<this.rowNum;o++){const s={dx:i,dy:o,x:i*this.CELL_W,y:o*this.CELL_H,occupied:!1};a.push(s)}this.cells.push(a)}}findGridByNodeId(t){var n,r;for(let i=0;i<this.columnNum;i++)for(let a=0;a<this.rowNum;a++)if(this.cells[i][a].node&&((r=(n=this.cells[i][a])===null||n===void 0?void 0:n.node)===null||r===void 0?void 0:r.id)===t)return{column:i,row:a};return null}sqdist(t,n){return Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)}occupyNearest(t){let n=Jc.MIN_DIST,r,i=null;for(let a=0;a<this.columnNum;a++)for(let o=0;o<this.rowNum;o++)!this.cells[a][o].occupied&&(r=this.sqdist(t,this.cells[a][o]))<n&&(n=r,i=this.cells[a][o]);return i&&(i.occupied=!0),i}insertColumn(t,n){if(!(n<=0)){for(let r=0;r<n;r++){this.cells[r+this.columnNum]=[];for(let i=0;i<this.rowNum;i++)this.cells[r+this.columnNum][i]={dx:r,dy:i,x:r*this.CELL_W,y:i*this.CELL_H,occupied:!1,node:null}}for(let r=this.columnNum-1;r>t;r--)for(let i=0;i<this.rowNum;i++)this.cells[r+n][i]=Object.assign(Object.assign({},this.cells[r][i]),{x:(r+n)*this.CELL_W,y:i*this.CELL_H}),this.cells[r][i]={x:r*this.CELL_W,y:i*this.CELL_H,occupied:!0,node:null};for(let r=0;r<this.additionColumn.length;r++)this.additionColumn[r]>=t&&(this.additionColumn[r]+=n);for(let r=0;r<n;r++)this.additionColumn.push(t+r+1);this.columnNum+=n}}insertRow(t,n){if(!(n<=0)){for(let r=0;r<n;r++)for(let i=0;i<this.columnNum;i++)this.cells[i][r+this.rowNum]={dx:i,dy:r,x:i*this.CELL_W,y:r*this.CELL_H,occupied:!1,node:null};for(let r=0;r<this.columnNum;r++)for(let i=this.rowNum-1;i>t;i--)this.cells[r][i+n]=Object.assign(Object.assign({},this.cells[r][i]),{dx:r,dy:i+n,x:r*this.CELL_W,y:(i+n)*this.CELL_H}),this.cells[r][i]={dx:r,dy:i,x:r*this.CELL_W,y:i*this.CELL_H,occupied:!1,node:null};for(let r=0;r<this.additionRow.length;r++)this.additionRow[r]>=t&&(this.additionRow[r]+=n);for(let r=0;r<n;r++)this.additionRow.push(t+r+1);this.rowNum+=n}}getNodes(){const t=[];for(let n=0;n<this.columnNum;n++)for(let r=0;r<this.rowNum;r++)this.cells[n][r].node&&t.push(this.cells[n][r]);return t}}Jc.MIN_DIST=50,Jc.DEFAULT_CELL_W=80,Jc.DEFAULT_CELL_H=80;function iR(e,t){if(!e.nodes||e.nodes.length===0)return e;const n=t.width,r=t.height,i=t.nodeMinGap;let a=1e4,o=1e4;e.nodes.forEach(c=>{const f=c.size[0]||50,d=c.size[1]||50;a=Math.min(f,a),o=Math.min(d,o)});const s=new Jc;s.init(n,r,{CELL_H:o,CELL_W:a}),e.nodes.forEach(c=>{const f=s.occupyNearest(c);f&&(f.node={id:c.id,size:c.size},c.x=f.x,c.y=f.y,c.dx=f.dx,c.dy=f.dy)});for(let c=0;c<e.nodes.length;c++){const f=e.nodes[c],d=s.findGridByNodeId(f.id);if(!d)throw new Error("can not find node cell");const{column:h,row:v}=d;if(f.size[0]+i>a){const m=Math.ceil((f.size[0]+i)/a)-1;let g=m;for(let _=0;_<m&&(s.additionColumn.indexOf(h+_+1)>-1&&!s.cells[h+_+1][v].node);_++)g--;s.insertColumn(h,g)}if(f.size[1]+i>o){const m=Math.ceil((f.size[1]+i)/o)-1;let g=m;for(let _=0;_<m&&(s.additionRow.indexOf(v+_+1)>-1&&!s.cells[h][v+_+1].node);_++)g--;s.insertRow(v,g)}}for(let c=0;c<s.columnNum;c++)for(let f=0;f<s.rowNum;f++){const d=s.cells[c][f];if(d.node){const h=e.nodes.find(v=>{var m;return v.id===((m=d==null?void 0:d.node)===null||m===void 0?void 0:m.id)});h&&(h.x=d.x+h.size[0]/2,h.y=d.y+h.size[1]/2)}}}const Ux=1200,Bx=800,om=1e7,Yv=10,zx=3.141592653589793,Fy=1.5707963267948966,aR=zx*.375,oR=zx*.625,sm=new Map,sR=10,uR=10;let Uy=.8;const Wx=.1,cR=.5;function fR(e,t,n){const r=e.x-e.size[0]/2,i=e.y-e.size[1]/2,a=e.x+e.size[0]/2,o=e.y+e.size[1]/2,s=t.x-t.size[0]/2,c=t.y-t.size[1]/2,f=t.x+t.size[0]/2,d=t.y+t.size[1]/2,h=e.x,v=e.y,m=t.x,g=t.y,_=m-h,y=Math.atan2(_,g-v);let E=0,b=0,A=0,C=0;y>Fy?(b=i-d,E=s-a,A=parseFloat(b?(b/Math.cos(y)).toFixed(2):E.toFixed(2)),C=parseFloat(E?(E/Math.sin(y)).toFixed(2):b.toFixed(2))):0<y&&y<=Fy?(b=c-o,E=s-a,b>E?A=C=parseFloat(b?(b/Math.cos(y)).toFixed(2):E.toFixed(2)):A=C=parseFloat(E?(E/Math.sin(y)).toFixed(2):b.toFixed(2))):y<-Fy?(b=i-d,E=-(f-r),b>E?A=C=parseFloat(b?(b/Math.cos(y)).toFixed(2):E.toFixed(2)):A=C=parseFloat(E?(E/Math.sin(y)).toFixed(2):b.toFixed(2))):(b=c-o,Math.abs(_)>(a-r)/2?E=r-f:E=_,b>E?A=C=parseFloat(b?(b/Math.cos(y)).toFixed(2):E.toFixed(2)):A=C=parseFloat(E&&y!==0?(E/Math.sin(y)).toFixed(2):b.toFixed(2)));const R=parseFloat(y.toFixed(2));let z=n;return n&&(z=aR<R&&R<oR),{distance:Math.abs(A<C?A:C),isHoriz:z}}function Vx(e,t){const r=(sm.get(e.id)||[]).find(ee=>ee.source===t.id||ee.target===t.id),i=e.size[0]*e.size[1],a=t.size[0]*t.size[1],o=i>a?t:e,s=i>a?e:t,c=o.x-o.size[0]/2,f=o.y-o.size[1]/2,d=o.x+o.size[0]/2,h=o.y+o.size[1]/2,v=s.x-s.size[0]/2,m=s.y-s.size[1]/2,g=s.x+s.size[0]/2,_=s.y+s.size[1]/2,y=o.x,E=o.y,b=s.x,A=s.y,C=d>=v&&g>=c&&h>=m&&_>=f;let R=0,z=0;if(C){z=Math.sqrt(Math.pow(b-y,2)+Math.pow(A-E,2));const ee=c>v?c:v,Q=f>m?f:m,re=d<g?d:g,de=h<_?h:_,Ie=re-ee,ie=de-Q,ke=Ie*ie;z===0&&(z=1e-7),R=Yv*1/z*100+ke,R*=om}else{let ee=!1;const Q=fR(o,s,ee);z=Q.distance,ee=Q.isHoriz,z<=Yv?z!==0?r?R+=Yv+om*1/z:R+=Yv+om*Yv/z:R+=om:(R+=z,r&&(R+=z*z))}return R}function Zx(e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];(r.x<0||r.y<0||r.x>Ux||r.y>Bx)&&(t+=1e12);for(let i=n+1;i<e.length;i++)t+=Vx(r,e[i])}return t}function lR(e,t,n,r){const i=new Map;n.forEach((c,f)=>{i.set(c.id,c)});const a=r.filter(c=>c.source===e.id||c.target===e.id)||[],o=[];a.forEach(c=>{const f=c.source===e.id?c.target:c.source,d=i.get(f);d&&o.push(d)});let s=!0;for(let c=0;c<o.length;c++){const f=o[c],d=Math.atan((e.y-f.y)/(f.x-e.y))*180,h=Math.atan((t.y-f.y)/(f.x-t.y))*180,v=d<30||d>150,m=h<30||h>150,g=d>70&&d<110,_=h>70&&h<110;if(v&&!m||d*h<0){s=!1;break}else if(g&&!_||d*h<0){s=!1;break}else if((f.x-e.x)*(f.x-t.x)<0){s=!1;break}else if((f.y-e.y)*(f.y-t.y)<0){s=!1;break}}return s}function dR(e,t){let n=!1;const r=1,i=sR*r,a=uR*r,o=[i,-i,0,0],s=[0,0,a,-a];for(let c=0;c<e.length;++c){const f=e[c];let d=jx(f,e);for(let h=0;h<o.length;h++)if(lR(f,{x:f.x+o[h],y:f.y+s[h]},e,t)){f.x+=o[h],f.y+=s[h];const m=jx(f,e),g=Math.random();m<d||g<Uy&&g>Wx?(d=m,n=!0):(f.x-=o[h],f.y-=s[h])}}return Uy>Wx&&(Uy*=cR),n?Zx(e):0}function jx(e,t){let n=0;(e.x<0||e.y<0||e.x+e.size[0]+20>Ux||e.y+e.size[1]+20>Bx)&&(n+=1e12);for(let r=0;r<t.length;++r)e.id!==t[r].id&&(n+=Vx(e,t[r]));return n}function hR(e,t){if(e.length===0)return{nodes:e,edges:t};e.forEach(c=>{const f=t.filter(d=>d.source===c.id||d.target===c.id);sm.set(c,f)}),e.sort((c,f)=>{var d,h;return((d=sm.get(c.id))===null||d===void 0?void 0:d.length)-((h=sm.get(f.id))===null||h===void 0?void 0:h.length)});let n=Zx(e),r=20,i=1,a=0;const o=50;let s=0;for(;r>0&&(s++,!(s>=o));){const c=dR(e,t);c!==0&&(a=c),i=a-n,n=a,i===0?--r:r=20}return e.forEach(c=>{c.x=c.x-c.size[0]/2,c.y=c.y-c.size[1]/2}),{nodes:e,edges:t}}var vR=hR;function pR(e,t){const{nodes:n,edges:r}=e,i=t.width,a=t.height;if(!(n==null?void 0:n.length))return Promise.resolve();const o=[];n.forEach(g=>{if(r.filter(y=>y.source===g.id||y.target===g.id).length>1){const y=Object.assign({},g);delete y.size,o.push(y)}});const s=[];r.forEach(g=>{const _=o.find(E=>E.id===g.source),y=o.find(E=>E.id===g.target);_&&y&&s.push(g)});const c=new xs({type:"dagre",ranksep:t.nodeMinGap,nodesep:t.nodeMinGap}),{nodes:f}=c.layout({nodes:o,edges:s});n.forEach(g=>{const _=(f||[]).find(y=>y.id===g.id);g.x=(_==null?void 0:_.x)||i/2,g.y=(_==null?void 0:_.y)||a/2});const d=JSON.parse(JSON.stringify(n)),h=JSON.parse(JSON.stringify(r)),v=uc().nodes(d).force("link",ks(h).id(g=>g.id).distance(g=>s.find(y=>y.source===g.source&&y.target===g.target)?30:20)).force("charge",ss()).force("center",us(i/2,a/2)).force("x",lc(i/2)).force("y",_u(a/2)).alpha(.3).alphaDecay(.08).alphaMin(.001);return new Promise(g=>{v.on("end",()=>{n.forEach(R=>{const z=d.find(ee=>ee.id===R.id);z&&(R.x=z.x,R.y=z.y)});const _=Math.min(...n.map(R=>R.x)),y=Math.max(...n.map(R=>R.x)),E=Math.min(...n.map(R=>R.y)),b=Math.max(...n.map(R=>R.y)),A=i/(y-_),C=a/(b-E);n.forEach(R=>{R.x!==void 0&&A<1&&(R.x=(R.x-_)*A),R.y!==void 0&&C<1&&(R.y=(R.y-E)*C)}),n.forEach(R=>{R.sizeTemp=R.size,R.size=[10,10]}),vR(n,r),n.forEach(R=>{R.size=R.sizeTemp||[],delete R.sizeTemp}),iR({nodes:n,edges:r},t),g()})})}class mR extends ar{constructor(t){super();this.width=300,this.height=300,this.nodeMinGap=50,this.onLayoutEnd=()=>{},t&&this.updateCfg(t)}getDefaultCfg(){return{width:300,height:300,nodeMinGap:50}}execute(){const t=this,n=t.nodes,r=t.edges;return n==null||n.forEach(i=>{i.size||(i.size=[50,50])}),pR({nodes:n,edges:r},{width:this.width,height:this.height,nodeMinGap:this.nodeMinGap}).then(()=>{t.onLayoutEnd&&t.onLayoutEnd()})}getType(){return"er"}}class gR extends ar{constructor(t){super();this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(t)}getDefaultCfg(){return{center:[0,0],width:300,height:300}}execute(){const t=this,n=t.nodes,r=.9,i=t.center;return!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight),n&&n.forEach(a=>{a.x=(Math.random()-.5)*r*t.width+i[0],a.y=(Math.random()-.5)*r*t.height+i[1]}),t.onLayoutEnd&&t.onLayoutEnd(),{nodes:n,edges:this.edges}}getType(){return"random"}}class RN{constructor(t){const n=getLayoutByName(t.type);this.layoutInstance=new n(t)}layout(t){return this.layoutInstance.layout(t)}updateCfg(t){this.layoutInstance.updateCfg(t)}init(t){this.layoutInstance.init(t)}execute(){this.layoutInstance.execute()}getDefaultCfg(){return this.layoutInstance.getDefaultCfg()}destroy(){return this.layoutInstance.destroy()}}const MN={force:bt,fruchterman:jS,forceAtlas2:rR,gForce:ao,force2:Gt,dagre:xs,dagreCompound:sS,circular:xt,radial:VS,concentric:g1,grid:Gi,mds:y1,comboForce:tR,comboCombined:nR,random:gR,"gForce-gpu":eR,"fruchterman-gpu":JC,er:mR}},63252:function(){},49469:function(Te,I){"use strict";var S;S={value:!0};var N;(function(X){X.TextureCompressionBC="texture-compression-bc"})(N=I.UX||(I.UX={}));var x;(function(X){X.ClampToEdge="clamp-to-edge",X.Repeat="repeat",X.MirrorRepeat="mirror-repeat"})(x=I.OB||(I.OB={}));var ne;(function(X){X.UniformBuffer="uniform-buffer",X.StorageBuffer="storage-buffer",X.ReadonlyStorageBuffer="readonly-storage-buffer",X.Sampler="sampler",X.ComparisonSampler="comparison-sampler",X.SampledTexture="sampled-texture",X.ReadonlyStorageTexture="readonly-storage-texture",X.WriteonlyStorageTexture="writeonly-storage-texture"})(ne=I.$l||(I.$l={}));var W;(function(X){X.Zero="zero",X.One="one",X.SrcColor="src-color",X.OneMinusSrcColor="one-minus-src-color",X.SrcAlpha="src-alpha",X.OneMinusSrcAlpha="one-minus-src-alpha",X.DstColor="dst-color",X.OneMinusDstColor="one-minus-dst-color",X.DstAlpha="dst-alpha",X.OneMinusDstAlpha="one-minus-dst-alpha",X.SrcAlphaSaturated="src-alpha-saturated",X.BlendColor="blend-color",X.OneMinusBlendColor="one-minus-blend-color"})(W=I.zi||(I.zi={}));var j;(function(X){X.Add="add",X.Subtract="subtract",X.ReverseSubtract="reverse-subtract",X.Min="min",X.Max="max"})(j=I.db||(I.db={}));var V;(function(X){X.Never="never",X.Less="less",X.Equal="equal",X.LessEqual="less-equal",X.Greater="greater",X.NotEqual="not-equal",X.GreaterEqual="greater-equal",X.Always="always"})(V=I.wb||(I.wb={}));var Z;(function(X){X.None="none",X.Front="front",X.Back="back"})(Z=I.Wf||(I.Wf={}));var De;(function(X){X.Nearest="nearest",X.Linear="linear"})(De=I.X9||(I.X9={}));var he;(function(X){X.CCW="ccw",X.CW="cw"})(he=I.zX||(I.zX={}));var be;(function(X){X.Uint16="uint16",X.Uint32="uint32"})(be=I.iD||(I.iD={}));var at;(function(X){X.Vertex="vertex",X.Instance="instance"})(at=I.V||(I.V={}));var We;(function(X){X.Load="load"})(We=I.Ws||(I.Ws={}));var Ht;(function(X){X.PointList="point-list",X.LineList="line-list",X.LineStrip="line-strip",X.TriangleList="triangle-list",X.TriangleStrip="triangle-strip"})(Ht=I.YV||(I.YV={}));var Yt;(function(X){X.Keep="keep",X.Zero="zero",X.Replace="replace",X.Invert="invert",X.IncrementClamp="increment-clamp",X.DecrementClamp="decrement-clamp",X.IncrementWrap="increment-wrap",X.DecrementWrap="decrement-wrap"})(Yt=I.xS||(I.xS={}));var dt;(function(X){X.Store="store",X.Clear="clear"})(dt=I.EG||(I.EG={}));var Et;(function(X){X.E1d="1d",X.E2d="2d",X.E3d="3d"})(Et=I.kd||(I.kd={}));var ht;(function(X){X.R8Unorm="r8unorm",X.R8Snorm="r8snorm",X.R8Uint="r8uint",X.R8Sint="r8sint",X.R16Uint="r16uint",X.R16Sint="r16sint",X.R16Float="r16float",X.RG8Unorm="rg8unorm",X.RG8Snorm="rg8snorm",X.RG8Uint="rg8uint",X.RG8Sint="rg8sint",X.R32Uint="r32uint",X.R32Sint="r32sint",X.R32Float="r32float",X.RG16Uint="rg16uint",X.RG16Sint="rg16sint",X.RG16Float="rg16float",X.RGBA8Unorm="rgba8unorm",X.RGBA8UnormSRGB="rgba8unorm-srgb",X.RGBA8Snorm="rgba8snorm",X.RGBA8Uint="rgba8uint",X.RGBA8Sint="rgba8sint",X.BGRA8Unorm="bgra8unorm",X.BGRA8UnormSRGB="bgra8unorm-srgb",X.RGB10A2Unorm="rgb10a2unorm",X.RG11B10Float="rg11b10float",X.RG32Uint="rg32uint",X.RG32Sint="rg32sint",X.RG32Float="rg32float",X.RGBA16Uint="rgba16uint",X.RGBA16Sint="rgba16sint",X.RGBA16Float="rgba16float",X.RGBA32Uint="rgba32uint",X.RGBA32Sint="rgba32sint",X.RGBA32Float="rgba32float",X.Depth32Float="depth32float",X.Depth24Plus="depth24plus",X.Depth24PlusStencil8="depth24plus-stencil8"})(ht=I.EV||(I.EV={}));var Oe;(function(X){X.Float="float",X.Sint="sint",X.Uint="uint"})(Oe=I.Ek||(I.Ek={}));var Re;(function(X){X.E1d="1d",X.E2d="2d",X.E2dArray="2d-array",X.Cube="cube",X.CubeArray="cube-array",X.E3d="3d"})(Re=I.p_||(I.p_={}));var Dt;(function(X){X.Uchar2="uchar2",X.Uchar4="uchar4",X.Char2="char2",X.Char4="char4",X.Uchar2Norm="uchar2norm",X.Uchar4Norm="uchar4norm",X.Char2Norm="char2norm",X.Char4Norm="char4norm",X.Ushort2="ushort2",X.Ushort4="ushort4",X.Short2="short2",X.Short4="short4",X.Ushort2Norm="ushort2norm",X.Ushort4Norm="ushort4norm",X.Short2Norm="short2norm",X.Short4Norm="short4norm",X.Half2="half2",X.Half4="half4",X.Float="float",X.Float2="float2",X.Float3="float3",X.Float4="float4",X.Uint="uint",X.Uint2="uint2",X.Uint3="uint3",X.Uint4="uint4",X.Int="int",X.Int2="int2",X.Int3="int3",X.Int4="int4"})(Dt=I.gB||(I.gB={}));var ot;(function(X){X.All="all",X.StencilOnly="stencil-only",X.DepthOnly="depth-only"})(ot=I.H7||(I.H7={}));var ft;(function(X){X.Error="error",X.Warning="warning",X.Info="info"})(ft=I.mj||(I.mj={}));var Ct;(function(X){X.Occlusion="occlusion"})(Ct=I.xL||(I.xL={}));var St;(function(X){X[X.MapRead=1]="MapRead",X[X.MapWrite=2]="MapWrite",X[X.CopySrc=4]="CopySrc",X[X.CopyDst=8]="CopyDst",X[X.Index=16]="Index",X[X.Vertex=32]="Vertex",X[X.Uniform=64]="Uniform",X[X.Storage=128]="Storage",X[X.Indirect=256]="Indirect",X[X.QueryResolve=512]="QueryResolve"})(St=I.FB||(I.FB={}));var Zt;(function(X){X[X.Red=1]="Red",X[X.Green=2]="Green",X[X.Blue=4]="Blue",X[X.Alpha=8]="Alpha",X[X.All=15]="All"})(Zt=I.Yw||(I.Yw={}));var vt;(function(X){X[X.Vertex=1]="Vertex",X[X.Fragment=2]="Fragment",X[X.Compute=4]="Compute"})(vt=I.$X||(I.$X={}));var tn;(function(X){X[X.CopySrc=1]="CopySrc",X[X.CopyDst=2]="CopyDst",X[X.Sampled=4]="Sampled",X[X.Storage=8]="Storage",X[X.OutputAttachment=16]="OutputAttachment"})(tn=I.v2||(I.v2={}));var $n;(function(X){X[X.Read=1]="Read",X[X.Write=2]="Write"})($n=I.gc||(I.gc={}))},9053:function(Te,I,S){"use strict";S.d(I,{Z:function(){return vl}});var N=S(16184),x=S(67294),ne=S(46823),W=S(56255),j=S(65459),V=S(33552),Z=S(33671),De=S(36228),he=S.n(De),be=S(22122),at=S(6610),We=S(5991),Ht=S(10379),Yt=S(54070),dt=S(96156),Et=S(81253),ht=S(87757),Oe=S.n(ht),Re=S(90484),Dt=S(92137),ot=S(85061),ft=S(16246),Ct=S.n(ft),St=S(28991),Zt=`accept acceptCharset accessKey action allowFullScreen allowTransparency
    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge
    charSet checked classID className colSpan cols content contentEditable contextMenu
    controls coords crossOrigin data dateTime default defer dir disabled download draggable
    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder
    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity
    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media
    mediaGroup method min minLength multiple muted name noValidate nonce open
    optimum pattern placeholder poster preload radioGroup readOnly rel required
    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected
    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style
    summary tabIndex target title type useMap value width wmode wrap`,vt=`onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown
    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick
    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown
    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel
    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough
    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata
    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError`,tn="".concat(Zt," ").concat(vt).split(/[\s\n]+/),$n="aria-",X="data-";function Dr(Ye,Ne){return Ye.indexOf(Ne)===0}function Ki(Ye){var Ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,bt;Ne===!1?bt={aria:!0,data:!0,attr:!0}:Ne===!0?bt={aria:!0}:bt=(0,St.Z)({},Ne);var Ue={};return Object.keys(Ye).forEach(function(Tt){(bt.aria&&(Tt==="role"||Dr(Tt,$n))||bt.data&&Dr(Tt,X)||bt.attr&&tn.includes(Tt))&&(Ue[Tt]=Ye[Tt])}),Ue}function es(Ye,Ne){var bt="cannot ".concat(Ye.method," ").concat(Ye.action," ").concat(Ne.status,"'"),Ue=new Error(bt);return Ue.status=Ne.status,Ue.method=Ye.method,Ue.url=Ye.action,Ue}function ar(Ye){var Ne=Ye.responseText||Ye.response;if(!Ne)return Ne;try{return JSON.parse(Ne)}catch(bt){return Ne}}function Gi(Ye){var Ne=new XMLHttpRequest;Ye.onProgress&&Ne.upload&&(Ne.upload.onprogress=function(Lt){Lt.total>0&&(Lt.percent=Lt.loaded/Lt.total*100),Ye.onProgress(Lt)});var bt=new FormData;Ye.data&&Object.keys(Ye.data).forEach(function(Tt){var Lt=Ye.data[Tt];if(Array.isArray(Lt)){Lt.forEach(function(nn){bt.append("".concat(Tt,"[]"),nn)});return}bt.append(Tt,Lt)}),Ye.file instanceof Blob?bt.append(Ye.filename,Ye.file,Ye.file.name):bt.append(Ye.filename,Ye.file),Ne.onerror=function(Lt){Ye.onError(Lt)},Ne.onload=function(){return Ne.status<200||Ne.status>=300?Ye.onError(es(Ye,Ne),ar(Ne)):Ye.onSuccess(ar(Ne),Ne)},Ne.open(Ye.method,Ye.action,!0),Ye.withCredentials&&"withCredentials"in Ne&&(Ne.withCredentials=!0);var Ue=Ye.headers||{};return Ue["X-Requested-With"]!==null&&Ne.setRequestHeader("X-Requested-With","XMLHttpRequest"),Object.keys(Ue).forEach(function(Tt){Ue[Tt]!==null&&Ne.setRequestHeader(Tt,Ue[Tt])}),Ne.send(bt),{abort:function(){Ne.abort()}}}var Fa=+new Date,ao=0;function ki(){return"rc-upload-".concat(Fa,"-").concat(++ao)}var Mo={};function vu(Ye,Ne){}function ei(Ye,Ne){}function oa(){Mo={}}function No(Ye,Ne,bt){!Ne&&!Mo[bt]&&(Ye(!1,bt),Mo[bt]=!0)}function or(Ye,Ne){No(vu,Ye,Ne)}function ts(Ye,Ne){No(ei,Ye,Ne)}var oo=or,ns=function(Ye,Ne){if(Ye&&Ne){var bt=Array.isArray(Ne)?Ne:Ne.split(","),Ue=Ye.name||"",Tt=Ye.type||"",Lt=Tt.replace(/\/.*$/,"");return bt.some(function(nn){var jt=nn.trim();if(/^\*(\/\*)?$/.test(nn))return!0;if(jt.charAt(0)==="."){var xt=Ue.toLowerCase(),sn=jt.toLowerCase(),gn=[sn];return(sn===".jpg"||sn===".jpeg")&&(gn=[".jpg",".jpeg"]),gn.some(function(Jn){return xt.endsWith(Jn)})}return/\/\*$/.test(jt)?Lt===jt.replace(/\/.*$/,""):Tt===jt?!0:/^\w+$/.test(jt)?(oo(!1,"Upload takes an invalidate 'accept' type '".concat(jt,"'.Skip for check.")),!0):!1})}return!0};function Do(Ye,Ne){var bt=Ye.createReader(),Ue=[];function Tt(){bt.readEntries(function(Lt){var nn=Array.prototype.slice.apply(Lt);Ue=Ue.concat(nn);var jt=!nn.length;jt?Ne(Ue):Tt()})}Tt()}var Fi=function(Ne,bt,Ue){var Tt=function Lt(nn,jt){nn.path=jt||"",nn.isFile?nn.file(function(xt){Ue(xt)&&(nn.fullPath&&!xt.webkitRelativePath&&(Object.defineProperties(xt,{webkitRelativePath:{writable:!0}}),xt.webkitRelativePath=nn.fullPath.replace(/^\//,""),Object.defineProperties(xt,{webkitRelativePath:{writable:!1}})),bt([xt]))}):nn.isDirectory&&Do(nn,function(xt){xt.forEach(function(sn){Lt(sn,"".concat(jt).concat(nn.name,"/"))})})};Ne.forEach(function(Lt){Tt(Lt.webkitGetAsEntry())})},rs=Fi,_i=["component","prefixCls","className","disabled","id","style","multiple","accept","capture","children","directory","openFileDialogOnClick","onMouseEnter","onMouseLeave"],ci=function(Ye){(0,Ht.Z)(bt,Ye);var Ne=(0,Yt.Z)(bt);function bt(){var Ue;(0,at.Z)(this,bt);for(var Tt=arguments.length,Lt=new Array(Tt),nn=0;nn<Tt;nn++)Lt[nn]=arguments[nn];return Ue=Ne.call.apply(Ne,[this].concat(Lt)),Ue.state={uid:ki()},Ue.reqs={},Ue.fileInput=void 0,Ue._isMounted=void 0,Ue.onChange=function(jt){var xt=Ue.props,sn=xt.accept,gn=xt.directory,Jn=jt.target.files,Fn=(0,ot.Z)(Jn).filter(function(zr){return!gn||ns(zr,sn)});Ue.uploadFiles(Fn),Ue.reset()},Ue.onClick=function(jt){var xt=Ue.fileInput;if(!!xt){var sn=Ue.props,gn=sn.children,Jn=sn.onClick;if(gn&&gn.type==="button"){var Fn=xt.parentNode;Fn.focus(),Fn.querySelector("button").blur()}xt.click(),Jn&&Jn(jt)}},Ue.onKeyDown=function(jt){jt.key==="Enter"&&Ue.onClick(jt)},Ue.onFileDrop=function(jt){var xt=Ue.props.multiple;if(jt.preventDefault(),jt.type!=="dragover")if(Ue.props.directory)rs(Array.prototype.slice.call(jt.dataTransfer.items),Ue.uploadFiles,function(gn){return ns(gn,Ue.props.accept)});else{var sn=(0,ot.Z)(jt.dataTransfer.files).filter(function(gn){return ns(gn,Ue.props.accept)});xt===!1&&(sn=sn.slice(0,1)),Ue.uploadFiles(sn)}},Ue.uploadFiles=function(jt){var xt=(0,ot.Z)(jt),sn=xt.map(function(gn){return gn.uid=ki(),Ue.processFile(gn,xt)});Promise.all(sn).then(function(gn){var Jn=Ue.props.onBatchStart;Jn==null||Jn(gn.map(function(Fn){var zr=Fn.origin,Pr=Fn.parsedFile;return{file:zr,parsedFile:Pr}})),gn.filter(function(Fn){return Fn.parsedFile!==null}).forEach(function(Fn){Ue.post(Fn)})})},Ue.processFile=function(){var jt=(0,Dt.Z)(Oe().mark(function xt(sn,gn){var Jn,Fn,zr,Pr,Ar,wr,Or,ti,Pi;return Oe().wrap(function(Un){for(;;)switch(Un.prev=Un.next){case 0:if(Jn=Ue.props.beforeUpload,Fn=sn,!Jn){Un.next=14;break}return Un.prev=3,Un.next=6,Jn(sn,gn);case 6:Fn=Un.sent,Un.next=12;break;case 9:Un.prev=9,Un.t0=Un.catch(3),Fn=!1;case 12:if(Fn!==!1){Un.next=14;break}return Un.abrupt("return",{origin:sn,parsedFile:null,action:null,data:null});case 14:if(zr=Ue.props.action,typeof zr!="function"){Un.next=21;break}return Un.next=18,zr(sn);case 18:Pr=Un.sent,Un.next=22;break;case 21:Pr=zr;case 22:if(Ar=Ue.props.data,typeof Ar!="function"){Un.next=29;break}return Un.next=26,Ar(sn);case 26:wr=Un.sent,Un.next=30;break;case 29:wr=Ar;case 30:return Or=((0,Re.Z)(Fn)==="object"||typeof Fn=="string")&&Fn?Fn:sn,Or instanceof File?ti=Or:ti=new File([Or],sn.name,{type:sn.type}),Pi=ti,Pi.uid=sn.uid,Un.abrupt("return",{origin:sn,data:wr,parsedFile:Pi,action:Pr});case 35:case"end":return Un.stop()}},xt,null,[[3,9]])}));return function(xt,sn){return jt.apply(this,arguments)}}(),Ue.saveFileInput=function(jt){Ue.fileInput=jt},Ue}return(0,We.Z)(bt,[{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.abort()}},{key:"post",value:function(Tt){var Lt=this,nn=Tt.data,jt=Tt.origin,xt=Tt.action,sn=Tt.parsedFile;if(!!this._isMounted){var gn=this.props,Jn=gn.onStart,Fn=gn.customRequest,zr=gn.name,Pr=gn.headers,Ar=gn.withCredentials,wr=gn.method,Or=jt.uid,ti=Fn||Gi,Pi={action:xt,filename:zr,data:nn,file:sn,headers:Pr,withCredentials:Ar,method:wr||"post",onProgress:function(Un){var ni=Lt.props.onProgress;ni==null||ni(Un,sn)},onSuccess:function(Un,ni){var Ei=Lt.props.onSuccess;Ei==null||Ei(Un,sn,ni),delete Lt.reqs[Or]},onError:function(Un,ni){var Ei=Lt.props.onError;Ei==null||Ei(Un,ni,sn),delete Lt.reqs[Or]}};Jn(jt),this.reqs[Or]=ti(Pi)}}},{key:"reset",value:function(){this.setState({uid:ki()})}},{key:"abort",value:function(Tt){var Lt=this.reqs;if(Tt){var nn=Tt.uid?Tt.uid:Tt;Lt[nn]&&Lt[nn].abort&&Lt[nn].abort(),delete Lt[nn]}else Object.keys(Lt).forEach(function(jt){Lt[jt]&&Lt[jt].abort&&Lt[jt].abort(),delete Lt[jt]})}},{key:"render",value:function(){var Tt,Lt=this.props,nn=Lt.component,jt=Lt.prefixCls,xt=Lt.className,sn=Lt.disabled,gn=Lt.id,Jn=Lt.style,Fn=Lt.multiple,zr=Lt.accept,Pr=Lt.capture,Ar=Lt.children,wr=Lt.directory,Or=Lt.openFileDialogOnClick,ti=Lt.onMouseEnter,Pi=Lt.onMouseLeave,Ii=(0,Et.Z)(Lt,_i),Un=Ct()((Tt={},(0,dt.Z)(Tt,jt,!0),(0,dt.Z)(Tt,"".concat(jt,"-disabled"),sn),(0,dt.Z)(Tt,xt,xt),Tt)),ni=wr?{directory:"directory",webkitdirectory:"webkitdirectory"}:{},Ei=sn?{}:{onClick:Or?this.onClick:function(){},onKeyDown:Or?this.onKeyDown:function(){},onMouseEnter:ti,onMouseLeave:Pi,onDrop:this.onFileDrop,onDragOver:this.onFileDrop,tabIndex:"0"};return x.createElement(nn,(0,be.Z)({},Ei,{className:Un,role:"button",style:Jn}),x.createElement("input",(0,be.Z)({},Ki(Ii,{aria:!0,data:!0}),{id:gn,type:"file",ref:this.saveFileInput,onClick:function(ua){return ua.stopPropagation()},key:this.state.uid,style:{display:"none"},accept:zr},ni,{multiple:Fn,onChange:this.onChange},Pr!=null?{capture:Pr}:{})),Ar)}}]),bt}(x.Component),pu=ci;function Ti(){}var Ps=function(Ye){(0,Ht.Z)(bt,Ye);var Ne=(0,Yt.Z)(bt);function bt(){var Ue;(0,at.Z)(this,bt);for(var Tt=arguments.length,Lt=new Array(Tt),nn=0;nn<Tt;nn++)Lt[nn]=arguments[nn];return Ue=Ne.call.apply(Ne,[this].concat(Lt)),Ue.uploader=void 0,Ue.saveUploader=function(jt){Ue.uploader=jt},Ue}return(0,We.Z)(bt,[{key:"abort",value:function(Tt){this.uploader.abort(Tt)}},{key:"render",value:function(){return x.createElement(pu,(0,be.Z)({},this.props,{ref:this.saveUploader}))}}]),bt}(x.Component);Ps.defaultProps={component:"span",prefixCls:"rc-upload",data:{},headers:{},name:"file",multipart:!1,onStart:Ti,onError:Ti,onSuccess:Ti,multiple:!1,beforeUpload:null,customRequest:null,withCredentials:!1,openFileDialogOnClick:!0};var is=Ps,G=is,Zi=S(5663),Br=S(73935),so=S(53124),mu=S(98866),Ji=S(42051),as=S(85636),Se={icon:function(Ne,bt){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M534 352V136H232v752h560V394H576a42 42 0 01-42-42z",fill:bt}},{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM602 137.8L790.2 326H602V137.8zM792 888H232V136h302v216a42 42 0 0042 42h216v494z",fill:Ne}}]}},name:"file",theme:"twotone"},Xe=Se,mt=S(27029),Gt=function(Ne,bt){return x.createElement(mt.Z,(0,St.Z)((0,St.Z)({},Ne),{},{ref:bt,icon:Xe}))};Gt.displayName="FileTwoTone";var Ut=x.forwardRef(Gt),kn=S(7085),An={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M779.3 196.6c-94.2-94.2-247.6-94.2-341.7 0l-261 260.8c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l261-260.8c32.4-32.4 75.5-50.2 121.3-50.2s88.9 17.8 121.2 50.2c32.4 32.4 50.2 75.5 50.2 121.2 0 45.8-17.8 88.8-50.2 121.2l-266 265.9-43.1 43.1c-40.3 40.3-105.8 40.3-146.1 0-19.5-19.5-30.2-45.4-30.2-73s10.7-53.5 30.2-73l263.9-263.8c6.7-6.6 15.5-10.3 24.9-10.3h.1c9.4 0 18.1 3.7 24.7 10.3 6.7 6.7 10.3 15.5 10.3 24.9 0 9.3-3.7 18.1-10.3 24.7L372.4 653c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l215.6-215.6c19.9-19.9 30.8-46.3 30.8-74.4s-11-54.6-30.8-74.4c-41.1-41.1-107.9-41-149 0L463 364 224.8 602.1A172.22 172.22 0 00174 724.8c0 46.3 18.1 89.8 50.8 122.5 33.9 33.8 78.3 50.7 122.7 50.7 44.4 0 88.8-16.9 122.6-50.7l309.2-309C824.8 492.7 850 432 850 367.5c.1-64.6-25.1-125.3-70.7-170.9z"}}]},name:"paper-clip",theme:"outlined"},Pn=An,en=function(Ne,bt){return x.createElement(mt.Z,(0,St.Z)((0,St.Z)({},Ne),{},{ref:bt,icon:Pn}))};en.displayName="PaperClipOutlined";var Yn=x.forwardRef(en),Kn={icon:function(Ne,bt){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 632H136v-39.9l138.5-164.3 150.1 178L658.1 489 888 761.6V792zm0-129.8L664.2 396.8c-3.2-3.8-9-3.8-12.2 0L424.6 666.4l-144-170.7c-3.2-3.8-9-3.8-12.2 0L136 652.7V232h752v430.2z",fill:Ne}},{tag:"path",attrs:{d:"M424.6 765.8l-150.1-178L136 752.1V792h752v-30.4L658.1 489z",fill:bt}},{tag:"path",attrs:{d:"M136 652.7l132.4-157c3.2-3.8 9-3.8 12.2 0l144 170.7L652 396.8c3.2-3.8 9-3.8 12.2 0L888 662.2V232H136v420.7zM304 280a88 88 0 110 176 88 88 0 010-176z",fill:bt}},{tag:"path",attrs:{d:"M276 368a28 28 0 1056 0 28 28 0 10-56 0z",fill:bt}},{tag:"path",attrs:{d:"M304 456a88 88 0 100-176 88 88 0 000 176zm0-116c15.5 0 28 12.5 28 28s-12.5 28-28 28-28-12.5-28-28 12.5-28 28-28z",fill:Ne}}]}},name:"picture",theme:"twotone"},ma=Kn,Os=function(Ne,bt){return x.createElement(mt.Z,(0,St.Z)((0,St.Z)({},Ne),{},{ref:bt,icon:ma}))};Os.displayName="PictureTwoTone";var Po=x.forwardRef(Os),Ua=S(65510),Oo=S(71577),tf=S(57838),Ai=S(33603),uo=S(96159);function Lo(Ye){return(0,N.Z)((0,N.Z)({},Ye),{lastModified:Ye.lastModified,lastModifiedDate:Ye.lastModifiedDate,name:Ye.name,size:Ye.size,type:Ye.type,uid:Ye.uid,percent:0,originFileObj:Ye})}function ga(Ye,Ne){var bt=(0,V.Z)(Ne),Ue=bt.findIndex(function(Tt){var Lt=Tt.uid;return Lt===Ye.uid});return Ue===-1?bt.push(Ye):bt[Ue]=Ye,bt}function os(Ye,Ne){var bt=Ye.uid!==void 0?"uid":"name";return Ne.filter(function(Ue){return Ue[bt]===Ye[bt]})[0]}function Ls(Ye,Ne){var bt=Ye.uid!==void 0?"uid":"name",Ue=Ne.filter(function(Tt){return Tt[bt]!==Ye[bt]});return Ue.length===Ne.length?null:Ue}var nf=function(){var Ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",bt=Ne.split("/"),Ue=bt[bt.length-1],Tt=Ue.split(/#|\?/)[0];return(/\.[^./\\]*$/.exec(Tt)||[""])[0]},Gs=function(Ne){return Ne.indexOf("image/")===0},ol=function(Ne){if(Ne.type&&!Ne.thumbUrl)return Gs(Ne.type);var bt=Ne.thumbUrl||Ne.url||"",Ue=nf(bt);return/^data:image\//.test(bt)||/(webp|svg|png|gif|jpg|jpeg|jfif|bmp|dpg|ico)$/i.test(Ue)?!0:!(/^data:/.test(bt)||Ue)},qi=200;function ac(Ye){return new Promise(function(Ne){if(!Ye.type||!Gs(Ye.type)){Ne("");return}var bt=document.createElement("canvas");bt.width=qi,bt.height=qi,bt.style.cssText="position: fixed; left: 0; top: 0; width: ".concat(qi,"px; height: ").concat(qi,"px; z-index: 9999; display: none;"),document.body.appendChild(bt);var Ue=bt.getContext("2d"),Tt=new Image;if(Tt.onload=function(){var nn=Tt.width,jt=Tt.height,xt=qi,sn=qi,gn=0,Jn=0;nn>jt?(sn=jt*(qi/nn),Jn=-(sn-xt)/2):(xt=nn*(qi/jt),gn=-(xt-sn)/2),Ue.drawImage(Tt,gn,Jn,xt,sn);var Fn=bt.toDataURL();document.body.removeChild(bt),Ne(Fn)},Tt.crossOrigin="anonymous",Ye.type.startsWith("image/svg+xml")){var Lt=new FileReader;Lt.addEventListener("load",function(){Lt.result&&(Tt.src=Lt.result)}),Lt.readAsDataURL(Ye)}else Tt.src=window.URL.createObjectURL(Ye)})}var Xr=S(73171),rf={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"download",theme:"outlined"},sl=rf,af=function(Ne,bt){return x.createElement(mt.Z,(0,St.Z)((0,St.Z)({},Ne),{},{ref:bt,icon:sl}))};af.displayName="DownloadOutlined";var oc=x.forwardRef(af),ul=S(95357),cl=S(61873),sc=S(96296),fl=x.forwardRef(function(Ye,Ne){var bt,Ue=Ye.prefixCls,Tt=Ye.className,Lt=Ye.style,nn=Ye.locale,jt=Ye.listType,xt=Ye.file,sn=Ye.items,gn=Ye.progress,Jn=Ye.iconRender,Fn=Ye.actionIconRender,zr=Ye.itemRender,Pr=Ye.isImgUrl,Ar=Ye.showPreviewIcon,wr=Ye.showRemoveIcon,Or=Ye.showDownloadIcon,ti=Ye.previewIcon,Pi=Ye.removeIcon,Ii=Ye.downloadIcon,Un=Ye.onPreview,ni=Ye.onDownload,Ei=Ye.onClose,sa,ua,co=xt.status,ya=x.useState(co),cs=(0,Z.Z)(ya,2),ji=cs[0],Lr=cs[1];x.useEffect(function(){co!=="removed"&&Lr(co)},[co]);var fo=x.useState(!1),Fs=(0,Z.Z)(fo,2),Qi=Fs[0],fs=Fs[1],Ba=x.useRef();x.useEffect(function(){return Ba.current=setTimeout(function(){fs(!0)},300),function(){window.clearTimeout(Ba.current)}},[]);var _a="".concat(Ue,"-span"),ca=Jn(xt),Hi=x.createElement("div",{className:"".concat(Ue,"-text-icon")},ca);if(jt==="picture"||jt==="picture-card")if(ji==="uploading"||!xt.thumbUrl&&!xt.url){var za,gr=he()((za={},(0,ne.Z)(za,"".concat(Ue,"-list-item-thumbnail"),!0),(0,ne.Z)(za,"".concat(Ue,"-list-item-file"),ji!=="uploading"),za));Hi=x.createElement("div",{className:gr},ca)}else{var qn,Ea=(Pr==null?void 0:Pr(xt))?x.createElement("img",{src:xt.thumbUrl||xt.url,alt:xt.name,className:"".concat(Ue,"-list-item-image"),crossOrigin:xt.crossOrigin}):ca,Xn=he()((qn={},(0,ne.Z)(qn,"".concat(Ue,"-list-item-thumbnail"),!0),(0,ne.Z)(qn,"".concat(Ue,"-list-item-file"),Pr&&!Pr(xt)),qn));Hi=x.createElement("a",{className:Xn,onClick:function(dr){return Un(xt,dr)},href:xt.url||xt.thumbUrl,target:"_blank",rel:"noopener noreferrer"},Ea)}var sr=he()((bt={},(0,ne.Z)(bt,"".concat(Ue,"-list-item"),!0),(0,ne.Z)(bt,"".concat(Ue,"-list-item-").concat(ji),!0),(0,ne.Z)(bt,"".concat(Ue,"-list-item-list-type-").concat(jt),!0),bt)),fi=typeof xt.linkProps=="string"?JSON.parse(xt.linkProps):xt.linkProps,Ui=wr?Fn((typeof Pi=="function"?Pi(xt):Pi)||x.createElement(Xr.Z,null),function(){return Ei(xt)},Ue,nn.removeFile):null,ea=Or&&ji==="done"?Fn((typeof Ii=="function"?Ii(xt):Ii)||x.createElement(oc,null),function(){return ni(xt)},Ue,nn.downloadFile):null,Gr=jt!=="picture-card"&&x.createElement("span",{key:"download-delete",className:he()("".concat(Ue,"-list-item-card-actions"),{picture:jt==="picture"})},ea,Ui),Na=he()("".concat(Ue,"-list-item-name")),Wr=xt.url?[x.createElement("a",(0,N.Z)({key:"view",target:"_blank",rel:"noopener noreferrer",className:Na,title:xt.name},fi,{href:xt.url,onClick:function(dr){return Un(xt,dr)}}),xt.name),Gr]:[x.createElement("span",{key:"view",className:Na,onClick:function(dr){return Un(xt,dr)},title:xt.name},xt.name),Gr],fa={pointerEvents:"none",opacity:.5},Go=Ar?x.createElement("a",{href:xt.url||xt.thumbUrl,target:"_blank",rel:"noopener noreferrer",style:xt.url||xt.thumbUrl?void 0:fa,onClick:function(dr){return Un(xt,dr)},title:nn.previewFile},typeof ti=="function"?ti(xt):ti||x.createElement(ul.Z,null)):null,Eu=jt==="picture-card"&&ji!=="uploading"&&x.createElement("span",{className:"".concat(Ue,"-list-item-actions")},Go,ji==="done"&&ea,Ui),la;xt.response&&typeof xt.response=="string"?la=xt.response:la=((sa=xt.error)===null||sa===void 0?void 0:sa.statusText)||((ua=xt.error)===null||ua===void 0?void 0:ua.message)||nn.uploadError;var Ci=x.createElement("span",{className:_a},Hi,Wr),Ri=x.useContext(so.E_),In=Ri.getPrefixCls,xr=In(),vr=x.createElement("div",{className:sr},x.createElement("div",{className:"".concat(Ue,"-list-item-info")},Ci),Eu,Qi&&x.createElement(Ua.Z,{motionName:"".concat(xr,"-fade"),visible:ji==="uploading",motionDeadline:2e3},function(ur){var dr=ur.className,kr="percent"in xt?x.createElement(cl.Z,(0,N.Z)({},gn,{type:"line",percent:xt.percent})):null;return x.createElement("div",{className:he()("".concat(Ue,"-list-item-progress"),dr)},kr)})),On=he()("".concat(Ue,"-list-").concat(jt,"-container"),Tt),rr=ji==="error"?x.createElement(sc.Z,{title:la,getPopupContainer:function(dr){return dr.parentNode}},vr):vr;return x.createElement("div",{className:On,style:Lt,ref:Ne},zr?zr(rr,xt,sn,{download:ni.bind(null,xt),preview:Un.bind(null,xt),remove:Ei.bind(null,xt)}):rr)}),ll=fl,gu=(0,N.Z)({},Ai.ZP);delete gu.onAppearEnd,delete gu.onEnterEnd,delete gu.onLeaveEnd;var dl=function(Ne,bt){var Ue,Tt=Ne.listType,Lt=Ne.previewFile,nn=Ne.onPreview,jt=Ne.onDownload,xt=Ne.onRemove,sn=Ne.locale,gn=Ne.iconRender,Jn=Ne.isImageUrl,Fn=Ne.prefixCls,zr=Ne.items,Pr=zr===void 0?[]:zr,Ar=Ne.showPreviewIcon,wr=Ne.showRemoveIcon,Or=Ne.showDownloadIcon,ti=Ne.removeIcon,Pi=Ne.previewIcon,Ii=Ne.downloadIcon,Un=Ne.progress,ni=Ne.appendAction,Ei=Ne.appendActionVisible,sa=Ne.itemRender,ua=(0,tf.Z)(),co=x.useState(!1),ya=(0,Z.Z)(co,2),cs=ya[0],ji=ya[1];x.useEffect(function(){Tt!=="picture"&&Tt!=="picture-card"||(Pr||[]).forEach(function(Xn){typeof document=="undefined"||typeof window=="undefined"||!window.FileReader||!window.File||!(Xn.originFileObj instanceof File||Xn.originFileObj instanceof Blob)||Xn.thumbUrl!==void 0||(Xn.thumbUrl="",Lt&&Lt(Xn.originFileObj).then(function(sr){Xn.thumbUrl=sr||"",ua()}))})},[Tt,Pr,Lt]),x.useEffect(function(){ji(!0)},[]);var Lr=function(sr,fi){if(!!nn)return fi==null||fi.preventDefault(),nn(sr)},fo=function(sr){typeof jt=="function"?jt(sr):sr.url&&window.open(sr.url)},Fs=function(sr){xt==null||xt(sr)},Qi=function(sr){if(gn)return gn(sr,Tt);var fi=sr.status==="uploading",Ui=Jn&&Jn(sr)?x.createElement(Po,null):x.createElement(Ut,null),ea=fi?x.createElement(kn.Z,null):x.createElement(Yn,null);return Tt==="picture"?ea=fi?x.createElement(kn.Z,null):Ui:Tt==="picture-card"&&(ea=fi?sn.uploading:Ui),ea},fs=function(sr,fi,Ui,ea){var Gr={type:"text",size:"small",title:ea,onClick:function(fa){fi(),(0,uo.l$)(sr)&&sr.props.onClick&&sr.props.onClick(fa)},className:"".concat(Ui,"-list-item-card-actions-btn")};if((0,uo.l$)(sr)){var Na=(0,uo.Tm)(sr,(0,N.Z)((0,N.Z)({},sr.props),{onClick:function(){}}));return x.createElement(Oo.Z,(0,N.Z)({},Gr,{icon:Na}))}return x.createElement(Oo.Z,(0,N.Z)({},Gr),x.createElement("span",null,sr))};x.useImperativeHandle(bt,function(){return{handlePreview:Lr,handleDownload:fo}});var Ba=x.useContext(so.E_),_a=Ba.getPrefixCls,ca=Ba.direction,Hi=_a("upload",Fn),za=he()((Ue={},(0,ne.Z)(Ue,"".concat(Hi,"-list"),!0),(0,ne.Z)(Ue,"".concat(Hi,"-list-").concat(Tt),!0),(0,ne.Z)(Ue,"".concat(Hi,"-list-rtl"),ca==="rtl"),Ue)),gr=(0,V.Z)(Pr.map(function(Xn){return{key:Xn.uid,file:Xn}})),qn=Tt==="picture-card"?"animate-inline":"animate",Ea={motionDeadline:2e3,motionName:"".concat(Hi,"-").concat(qn),keys:gr,motionAppear:cs};return Tt!=="picture-card"&&(Ea=(0,N.Z)((0,N.Z)({},gu),Ea)),x.createElement("div",{className:za},x.createElement(Ua.V,(0,N.Z)({},Ea,{component:!1}),function(Xn){var sr=Xn.key,fi=Xn.file,Ui=Xn.className,ea=Xn.style;return x.createElement(ll,{key:sr,locale:sn,prefixCls:Hi,className:Ui,style:ea,file:fi,items:Pr,progress:Un,listType:Tt,isImgUrl:Jn,showPreviewIcon:Ar,showRemoveIcon:wr,showDownloadIcon:Or,removeIcon:ti,previewIcon:Pi,downloadIcon:Ii,iconRender:Qi,actionIconRender:fs,itemRender:sa,onPreview:Lr,onDownload:fo,onClose:Fs})}),ni&&x.createElement(Ua.Z,(0,N.Z)({},Ea,{visible:Ei,forceRender:!0}),function(Xn){var sr=Xn.className,fi=Xn.style;return(0,uo.Tm)(ni,function(Ui){return{className:he()(Ui.className,sr),style:(0,N.Z)((0,N.Z)((0,N.Z)({},fi),{pointerEvents:sr?"none":void 0}),Ui.style)}})}))},of=x.forwardRef(dl);of.defaultProps={listType:"text",progress:{strokeWidth:2,showInfo:!1},showRemoveIcon:!0,showDownloadIcon:!1,showPreviewIcon:!0,appendActionVisible:!0,previewFile:ac,isImageUrl:ol};var uc=of,ss=function(Ye,Ne,bt,Ue){function Tt(Lt){return Lt instanceof bt?Lt:new bt(function(nn){nn(Lt)})}return new(bt||(bt=Promise))(function(Lt,nn){function jt(gn){try{sn(Ue.next(gn))}catch(Jn){nn(Jn)}}function xt(gn){try{sn(Ue.throw(gn))}catch(Jn){nn(Jn)}}function sn(gn){gn.done?Lt(gn.value):Tt(gn.value).then(jt,xt)}sn((Ue=Ue.apply(Ye,Ne||[])).next())})},us="__LIST_IGNORE_".concat(Date.now(),"__"),yu=function(Ne,bt){var Ue,Tt=Ne.fileList,Lt=Ne.defaultFileList,nn=Ne.onRemove,jt=Ne.showUploadList,xt=Ne.listType,sn=Ne.onPreview,gn=Ne.onDownload,Jn=Ne.onChange,Fn=Ne.onDrop,zr=Ne.previewFile,Pr=Ne.disabled,Ar=Ne.locale,wr=Ne.iconRender,Or=Ne.isImageUrl,ti=Ne.progress,Pi=Ne.prefixCls,Ii=Ne.className,Un=Ne.type,ni=Ne.children,Ei=Ne.style,sa=Ne.itemRender,ua=Ne.maxCount,co=x.useContext(mu.Z),ya=Pr||co,cs=(0,Zi.Z)(Lt||[],{value:Tt,postState:function(In){return In??[]}}),ji=(0,Z.Z)(cs,2),Lr=ji[0],fo=ji[1],Fs=x.useState("drop"),Qi=(0,Z.Z)(Fs,2),fs=Qi[0],Ba=Qi[1],_a=x.useRef();x.useMemo(function(){var Ri=Date.now();(Tt||[]).forEach(function(In,xr){!In.uid&&!Object.isFrozen(In)&&(In.uid="__AUTO__".concat(Ri,"_").concat(xr,"__"))})},[Tt]);var ca=function(In,xr,vr){var On=(0,V.Z)(xr);ua===1?On=On.slice(-1):ua&&(On=On.slice(0,ua)),(0,Br.flushSync)(function(){fo(On)});var rr={file:In,fileList:On};vr&&(rr.event=vr),Jn==null||Jn(rr)},Hi=function(In,xr){return ss(void 0,void 0,void 0,(0,W.Z)().mark(function vr(){var On,rr,ur,dr;return(0,W.Z)().wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:if(On=Ne.beforeUpload,rr=Ne.transformFile,ur=In,!On){Rr.next=13;break}return Rr.next=5,On(In,xr);case 5:if(dr=Rr.sent,dr!==!1){Rr.next=8;break}return Rr.abrupt("return",!1);case 8:if(delete In[us],dr!==us){Rr.next=12;break}return Object.defineProperty(In,us,{value:!0,configurable:!0}),Rr.abrupt("return",!1);case 12:(0,j.Z)(dr)==="object"&&dr&&(ur=dr);case 13:if(!rr){Rr.next=17;break}return Rr.next=16,rr(ur);case 16:ur=Rr.sent;case 17:return Rr.abrupt("return",ur);case 18:case"end":return Rr.stop()}},vr)}))},za=function(In){var xr=In.filter(function(rr){return!rr.file[us]});if(!!xr.length){var vr=xr.map(function(rr){return Lo(rr.file)}),On=(0,V.Z)(Lr);vr.forEach(function(rr){On=ga(rr,On)}),vr.forEach(function(rr,ur){var dr=rr;if(xr[ur].parsedFile)rr.status="uploading";else{var kr=rr.originFileObj,Rr;try{Rr=new File([kr],kr.name,{type:kr.type})}catch(dc){Rr=new Blob([kr],{type:kr.type}),Rr.name=kr.name,Rr.lastModifiedDate=new Date,Rr.lastModified=new Date().getTime()}Rr.uid=rr.uid,dr=Rr}ca(dr,On)})}},gr=function(In,xr,vr){try{typeof In=="string"&&(In=JSON.parse(In))}catch(ur){}if(!!os(xr,Lr)){var On=Lo(xr);On.status="done",On.percent=100,On.response=In,On.xhr=vr;var rr=ga(On,Lr);ca(On,rr)}},qn=function(In,xr){if(!!os(xr,Lr)){var vr=Lo(xr);vr.status="uploading",vr.percent=In.percent;var On=ga(vr,Lr);ca(vr,On,In)}},Ea=function(In,xr,vr){if(!!os(vr,Lr)){var On=Lo(vr);On.error=In,On.response=xr,On.status="error";var rr=ga(On,Lr);ca(On,rr)}},Xn=function(In){var xr;Promise.resolve(typeof nn=="function"?nn(In):nn).then(function(vr){var On;if(vr!==!1){var rr=Ls(In,Lr);rr&&(xr=(0,N.Z)((0,N.Z)({},In),{status:"removed"}),Lr==null||Lr.forEach(function(ur){var dr=xr.uid!==void 0?"uid":"name";ur[dr]===xr[dr]&&!Object.isFrozen(ur)&&(ur.status="removed")}),(On=_a.current)===null||On===void 0||On.abort(xr),ca(xr,rr))}})},sr=function(In){Ba(In.type),In.type==="drop"&&(Fn==null||Fn(In))};x.useImperativeHandle(bt,function(){return{onBatchStart:za,onSuccess:gr,onProgress:qn,onError:Ea,fileList:Lr,upload:_a.current}});var fi=x.useContext(so.E_),Ui=fi.getPrefixCls,ea=fi.direction,Gr=Ui("upload",Pi),Na=(0,N.Z)((0,N.Z)({onBatchStart:za,onError:Ea,onProgress:qn,onSuccess:gr},Ne),{prefixCls:Gr,disabled:ya,beforeUpload:Hi,onChange:void 0});delete Na.className,delete Na.style,(!ni||ya)&&delete Na.id;var Wr=function(In,xr){return jt?x.createElement(Ji.Z,{componentName:"Upload",defaultLocale:as.Z.Upload},function(vr){var On=typeof jt=="boolean"?{}:jt,rr=On.showRemoveIcon,ur=On.showPreviewIcon,dr=On.showDownloadIcon,kr=On.removeIcon,Rr=On.previewIcon,dc=On.downloadIcon;return x.createElement(uc,{prefixCls:Gr,listType:xt,items:Lr,previewFile:zr,onPreview:sn,onDownload:gn,onRemove:Xn,showRemoveIcon:!ya&&rr,showPreviewIcon:ur,showDownloadIcon:dr,removeIcon:kr,previewIcon:Rr,downloadIcon:dc,iconRender:wr,locale:(0,N.Z)((0,N.Z)({},vr),Ar),isImageUrl:Or,progress:ti,appendAction:In,appendActionVisible:xr,itemRender:sa})}):In};if(Un==="drag"){var fa,Go=he()(Gr,(fa={},(0,ne.Z)(fa,"".concat(Gr,"-drag"),!0),(0,ne.Z)(fa,"".concat(Gr,"-drag-uploading"),Lr.some(function(Ri){return Ri.status==="uploading"})),(0,ne.Z)(fa,"".concat(Gr,"-drag-hover"),fs==="dragover"),(0,ne.Z)(fa,"".concat(Gr,"-disabled"),ya),(0,ne.Z)(fa,"".concat(Gr,"-rtl"),ea==="rtl"),fa),Ii);return x.createElement("span",null,x.createElement("div",{className:Go,onDrop:sr,onDragOver:sr,onDragLeave:sr,style:Ei},x.createElement(G,(0,N.Z)({},Na,{ref:_a,className:"".concat(Gr,"-btn")}),x.createElement("div",{className:"".concat(Gr,"-drag-container")},ni))),Wr())}var Eu=he()(Gr,(Ue={},(0,ne.Z)(Ue,"".concat(Gr,"-select"),!0),(0,ne.Z)(Ue,"".concat(Gr,"-select-").concat(xt),!0),(0,ne.Z)(Ue,"".concat(Gr,"-disabled"),ya),(0,ne.Z)(Ue,"".concat(Gr,"-rtl"),ea==="rtl"),Ue)),la=function(In){return x.createElement("div",{className:Eu,style:In},x.createElement(G,(0,N.Z)({},Na,{ref:_a})))},Ci=la(ni?void 0:{display:"none"});return xt==="picture-card"?x.createElement("span",{className:he()("".concat(Gr,"-picture-card-wrapper"),Ii)},Wr(Ci,!!ni)):x.createElement("span",{className:Ii},Ci,Wr())},cc=x.forwardRef(yu);cc.defaultProps={type:"select",multiple:!1,action:"",data:{},accept:"",showUploadList:!0,listType:"text",className:"",disabled:!1,supportServerRender:!0};var ks=cc,hl=function(Ye,Ne){var bt={};for(var Ue in Ye)Object.prototype.hasOwnProperty.call(Ye,Ue)&&Ne.indexOf(Ue)<0&&(bt[Ue]=Ye[Ue]);if(Ye!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Tt=0,Ue=Object.getOwnPropertySymbols(Ye);Tt<Ue.length;Tt++)Ne.indexOf(Ue[Tt])<0&&Object.prototype.propertyIsEnumerable.call(Ye,Ue[Tt])&&(bt[Ue[Tt]]=Ye[Ue[Tt]]);return bt},sf=function(Ne,bt){var Ue=Ne.style,Tt=Ne.height,Lt=hl(Ne,["style","height"]);return x.createElement(ks,(0,N.Z)({ref:bt},Lt,{type:"drag",style:(0,N.Z)((0,N.Z)({},Ue),{height:Tt})}))},fc=x.forwardRef(sf),lc=fc,_u=ks;_u.Dragger=lc,_u.LIST_IGNORE=us;var vl=_u},43185:function(Te,I,S){"use strict";var N=S(38663),x=S.n(N),ne=S(63252),W=S.n(ne),j=S(57663),V=S(34669),Z=S(22385)},89550:function(Te){Te.exports=I;function I(S,N,x){return S[0]=N[0]+x[0],S[1]=N[1]+x[1],S}},62189:function(Te){Te.exports=I;function I(S,N){return S[0]=Math.ceil(N[0]),S[1]=Math.ceil(N[1]),S}},76057:function(Te){Te.exports=I;function I(S){var N=new Float32Array(2);return N[0]=S[0],N[1]=S[1],N}},3492:function(Te){Te.exports=I;function I(S,N){return S[0]=N[0],S[1]=N[1],S}},61589:function(Te){Te.exports=I;function I(){var S=new Float32Array(2);return S[0]=0,S[1]=0,S}},77741:function(Te){Te.exports=I;function I(S,N,x){var ne=N[0]*x[1]-N[1]*x[0];return S[0]=S[1]=0,S[2]=ne,S}},80278:function(Te,I,S){Te.exports=S(27953)},27953:function(Te){Te.exports=I;function I(S,N){var x=N[0]-S[0],ne=N[1]-S[1];return Math.sqrt(x*x+ne*ne)}},49973:function(Te,I,S){Te.exports=S(6773)},6773:function(Te){Te.exports=I;function I(S,N,x){return S[0]=N[0]/x[0],S[1]=N[1]/x[1],S}},56601:function(Te){Te.exports=I;function I(S,N){return S[0]*N[0]+S[1]*N[1]}},89936:function(Te){Te.exports=1e-6},51232:function(Te,I,S){Te.exports=x;var N=S(89936);function x(ne,W){var j=ne[0],V=ne[1],Z=W[0],De=W[1];return Math.abs(j-Z)<=N*Math.max(1,Math.abs(j),Math.abs(Z))&&Math.abs(V-De)<=N*Math.max(1,Math.abs(V),Math.abs(De))}},39546:function(Te){Te.exports=I;function I(S,N){return S[0]===N[0]&&S[1]===N[1]}},67744:function(Te){Te.exports=I;function I(S,N){return S[0]=Math.floor(N[0]),S[1]=Math.floor(N[1]),S}},49002:function(Te,I,S){Te.exports=x;var N=S(61589)();function x(ne,W,j,V,Z,De){var he,be;for(W||(W=2),j||(j=0),V?be=Math.min(V*W+j,ne.length):be=ne.length,he=j;he<be;he+=W)N[0]=ne[he],N[1]=ne[he+1],Z(N,N,De),ne[he]=N[0],ne[he+1]=N[1];return ne}},69878:function(Te){Te.exports=I;function I(S,N){var x=new Float32Array(2);return x[0]=S,x[1]=N,x}},32644:function(Te,I,S){Te.exports={EPSILON:S(89936),create:S(61589),clone:S(76057),fromValues:S(69878),copy:S(3492),set:S(68854),equals:S(51232),exactEquals:S(39546),add:S(89550),subtract:S(43650),sub:S(45222),multiply:S(79920),mul:S(23113),divide:S(6773),div:S(49973),inverse:S(83793),min:S(20676),max:S(97899),rotate:S(48677),floor:S(67744),ceil:S(62189),round:S(57074),scale:S(47838),scaleAndAdd:S(21066),distance:S(27953),dist:S(80278),squaredDistance:S(14290),sqrDist:S(79569),length:S(37781),len:S(8123),squaredLength:S(26791),sqrLen:S(1791),negate:S(90549),normalize:S(36820),dot:S(56601),cross:S(77741),lerp:S(20577),random:S(85773),transformMat2:S(904),transformMat2d:S(60736),transformMat3:S(60221),transformMat4:S(37674),forEach:S(49002),limit:S(82418)}},83793:function(Te){Te.exports=I;function I(S,N){return S[0]=1/N[0],S[1]=1/N[1],S}},8123:function(Te,I,S){Te.exports=S(37781)},37781:function(Te){Te.exports=I;function I(S){var N=S[0],x=S[1];return Math.sqrt(N*N+x*x)}},20577:function(Te){Te.exports=I;function I(S,N,x,ne){var W=N[0],j=N[1];return S[0]=W+ne*(x[0]-W),S[1]=j+ne*(x[1]-j),S}},82418:function(Te){Te.exports=I;function I(S,N,x){var ne=N[0]*N[0]+N[1]*N[1];if(ne>x*x){var W=Math.sqrt(ne);S[0]=N[0]/W*x,S[1]=N[1]/W*x}else S[0]=N[0],S[1]=N[1];return S}},97899:function(Te){Te.exports=I;function I(S,N,x){return S[0]=Math.max(N[0],x[0]),S[1]=Math.max(N[1],x[1]),S}},20676:function(Te){Te.exports=I;function I(S,N,x){return S[0]=Math.min(N[0],x[0]),S[1]=Math.min(N[1],x[1]),S}},23113:function(Te,I,S){Te.exports=S(79920)},79920:function(Te){Te.exports=I;function I(S,N,x){return S[0]=N[0]*x[0],S[1]=N[1]*x[1],S}},90549:function(Te){Te.exports=I;function I(S,N){return S[0]=-N[0],S[1]=-N[1],S}},36820:function(Te){Te.exports=I;function I(S,N){var x=N[0],ne=N[1],W=x*x+ne*ne;return W>0&&(W=1/Math.sqrt(W),S[0]=N[0]*W,S[1]=N[1]*W),S}},85773:function(Te){Te.exports=I;function I(S,N){N=N||1;var x=Math.random()*2*Math.PI;return S[0]=Math.cos(x)*N,S[1]=Math.sin(x)*N,S}},48677:function(Te){Te.exports=I;function I(S,N,x){var ne=Math.cos(x),W=Math.sin(x),j=N[0],V=N[1];return S[0]=j*ne-V*W,S[1]=j*W+V*ne,S}},57074:function(Te){Te.exports=I;function I(S,N){return S[0]=Math.round(N[0]),S[1]=Math.round(N[1]),S}},47838:function(Te){Te.exports=I;function I(S,N,x){return S[0]=N[0]*x,S[1]=N[1]*x,S}},21066:function(Te){Te.exports=I;function I(S,N,x,ne){return S[0]=N[0]+x[0]*ne,S[1]=N[1]+x[1]*ne,S}},68854:function(Te){Te.exports=I;function I(S,N,x){return S[0]=N,S[1]=x,S}},79569:function(Te,I,S){Te.exports=S(14290)},1791:function(Te,I,S){Te.exports=S(26791)},14290:function(Te){Te.exports=I;function I(S,N){var x=N[0]-S[0],ne=N[1]-S[1];return x*x+ne*ne}},26791:function(Te){Te.exports=I;function I(S){var N=S[0],x=S[1];return N*N+x*x}},45222:function(Te,I,S){Te.exports=S(43650)},43650:function(Te){Te.exports=I;function I(S,N,x){return S[0]=N[0]-x[0],S[1]=N[1]-x[1],S}},904:function(Te){Te.exports=I;function I(S,N,x){var ne=N[0],W=N[1];return S[0]=x[0]*ne+x[2]*W,S[1]=x[1]*ne+x[3]*W,S}},60736:function(Te){Te.exports=I;function I(S,N,x){var ne=N[0],W=N[1];return S[0]=x[0]*ne+x[2]*W+x[4],S[1]=x[1]*ne+x[3]*W+x[5],S}},60221:function(Te){Te.exports=I;function I(S,N,x){var ne=N[0],W=N[1];return S[0]=x[0]*ne+x[3]*W+x[6],S[1]=x[1]*ne+x[4]*W+x[7],S}},37674:function(Te){Te.exports=I;function I(S,N,x){var ne=N[0],W=N[1];return S[0]=x[0]*ne+x[4]*W+x[12],S[1]=x[1]*ne+x[5]*W+x[13],S}},7375:function(Te,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0});var S=Symbol.for("INJECTION");function N(V,Z,De,he){function be(){return he&&!Reflect.hasMetadata(S,this,Z)&&Reflect.defineMetadata(S,De(),this,Z),Reflect.hasMetadata(S,this,Z)?Reflect.getMetadata(S,this,Z):De()}function at(We){Reflect.defineMetadata(S,We,this,Z)}Object.defineProperty(V,Z,{configurable:!0,enumerable:!0,get:be,set:at})}function x(V,Z){return function(De){return function(he,be){var at=function(){return V.get(De)};N(he,be,at,Z)}}}I.makePropertyInjectDecorator=x;function ne(V,Z){return function(De,he){return function(be,at){var We=function(){return V.getNamed(De,he)};N(be,at,We,Z)}}}I.makePropertyInjectNamedDecorator=ne;function W(V,Z){return function(De,he,be){return function(at,We){var Ht=function(){return V.getTagged(De,he,be)};N(at,We,Ht,Z)}}}I.makePropertyInjectTaggedDecorator=W;function j(V,Z){return function(De){return function(he,be){var at=function(){return V.getAll(De)};N(he,be,at,Z)}}}I.makePropertyMultiInjectDecorator=j},84879:function(Te,I,S){"use strict";var N;N={value:!0};var x=S(7375);function ne(W,j){j===void 0&&(j=!0);var V=x.makePropertyInjectDecorator(W,j),Z=x.makePropertyInjectNamedDecorator(W,j),De=x.makePropertyInjectTaggedDecorator(W,j),he=x.makePropertyMultiInjectDecorator(W,j);return{lazyInject:V,lazyInjectNamed:Z,lazyInjectTagged:De,lazyMultiInject:he}}I.Z=ne},99934:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.tagProperty=I.tagParameter=I.decorate=void 0;var N=S(16674),x=S(6867);function ne(he,be,at,We){var Ht=x.TAGGED;j(Ht,he,be,We,at)}I.tagParameter=ne;function W(he,be,at){var We=x.TAGGED_PROP;j(We,he.constructor,be,at)}I.tagProperty=W;function j(he,be,at,We,Ht){var Yt={},dt=typeof Ht=="number",Et=Ht!==void 0&&dt?Ht.toString():at;if(dt&&at!==void 0)throw new Error(N.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(he,be)&&(Yt=Reflect.getMetadata(he,be));var ht=Yt[Et];if(!Array.isArray(ht))ht=[];else for(var Oe=0,Re=ht;Oe<Re.length;Oe++){var Dt=Re[Oe];if(Dt.key===We.key)throw new Error(N.DUPLICATED_METADATA+" "+Dt.key.toString())}ht.push(We),Yt[Et]=ht,Reflect.defineMetadata(he,Yt,be)}function V(he,be){Reflect.decorate(he,be)}function Z(he,be){return function(at,We){be(at,We,he)}}function De(he,be,at){typeof at=="number"?V([Z(at,he)],be):typeof at=="string"?Reflect.decorate([he],be,at):V([he],be)}I.decorate=De},5744:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.inject=I.LazyServiceIdentifer=void 0;var N=S(16674),x=S(6867),ne=S(47738),W=S(99934),j=function(){function Z(De){this._cb=De}return Z.prototype.unwrap=function(){return this._cb()},Z}();I.LazyServiceIdentifer=j;function V(Z){return function(De,he,be){if(Z===void 0)throw new Error(N.UNDEFINED_INJECT_ANNOTATION(De.name));var at=new ne.Metadata(x.INJECT_TAG,Z);typeof be=="number"?W.tagParameter(De,he,be,at):W.tagProperty(De,he,at)}}I.inject=V},64315:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.injectable=void 0;var N=S(16674),x=S(6867);function ne(){return function(W){if(Reflect.hasOwnMetadata(x.PARAM_TYPES,W))throw new Error(N.DUPLICATED_INJECTABLE_DECORATOR);var j=Reflect.getMetadata(x.DESIGN_PARAM_TYPES,W)||[];return Reflect.defineMetadata(x.PARAM_TYPES,j,W),W}}I.injectable=ne},71693:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.multiInject=void 0;var N=S(6867),x=S(47738),ne=S(99934);function W(j){return function(V,Z,De){var he=new x.Metadata(N.MULTI_INJECT_TAG,j);typeof De=="number"?ne.tagParameter(V,Z,De,he):ne.tagProperty(V,Z,he)}}I.multiInject=W},38085:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.named=void 0;var N=S(6867),x=S(47738),ne=S(99934);function W(j){return function(V,Z,De){var he=new x.Metadata(N.NAMED_TAG,j);typeof De=="number"?ne.tagParameter(V,Z,De,he):ne.tagProperty(V,Z,he)}}I.named=W},6515:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.optional=void 0;var N=S(6867),x=S(47738),ne=S(99934);function W(){return function(j,V,Z){var De=new x.Metadata(N.OPTIONAL_TAG,!0);typeof Z=="number"?ne.tagParameter(j,V,Z,De):ne.tagProperty(j,V,De)}}I.optional=W},7014:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.postConstruct=void 0;var N=S(16674),x=S(6867),ne=S(47738);function W(){return function(j,V,Z){var De=new ne.Metadata(x.POST_CONSTRUCT,V);if(Reflect.hasOwnMetadata(x.POST_CONSTRUCT,j.constructor))throw new Error(N.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(x.POST_CONSTRUCT,De,j.constructor)}}I.postConstruct=W},32052:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.tagged=void 0;var N=S(47738),x=S(99934);function ne(W,j){return function(V,Z,De){var he=new N.Metadata(W,j);typeof De=="number"?x.tagParameter(V,Z,De,he):x.tagProperty(V,Z,he)}}I.tagged=ne},55638:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.targetName=void 0;var N=S(6867),x=S(47738),ne=S(99934);function W(j){return function(V,Z,De){var he=new x.Metadata(N.NAME_TAG,j);ne.tagParameter(V,Z,De,he)}}I.targetName=W},86757:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.unmanaged=void 0;var N=S(6867),x=S(47738),ne=S(99934);function W(){return function(j,V,Z){var De=new x.Metadata(N.UNMANAGED_TAG,!0);ne.tagParameter(j,V,Z,De)}}I.unmanaged=W},44290:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.Binding=void 0;var N=S(28421),x=S(37791),ne=function(){function W(j,V){this.id=x.id(),this.activated=!1,this.serviceIdentifier=j,this.scope=V,this.type=N.BindingTypeEnum.Invalid,this.constraint=function(Z){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return W.prototype.clone=function(){var j=new W(this.serviceIdentifier,this.scope);return j.activated=j.scope===N.BindingScopeEnum.Singleton?this.activated:!1,j.implementationType=this.implementationType,j.dynamicValue=this.dynamicValue,j.scope=this.scope,j.type=this.type,j.factory=this.factory,j.provider=this.provider,j.constraint=this.constraint,j.onActivation=this.onActivation,j.cache=this.cache,j},W}();I.Binding=ne},23184:function(Te,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.BindingCount=void 0;var S={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};I.BindingCount=S},16674:function(Te,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.STACK_OVERFLOW=I.CIRCULAR_DEPENDENCY_IN_FACTORY=I.POST_CONSTRUCT_ERROR=I.MULTIPLE_POST_CONSTRUCT_METHODS=I.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=I.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=I.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=I.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=I.ARGUMENTS_LENGTH_MISMATCH=I.INVALID_DECORATOR_OPERATION=I.INVALID_TO_SELF_VALUE=I.INVALID_FUNCTION_BINDING=I.INVALID_MIDDLEWARE_RETURN=I.NO_MORE_SNAPSHOTS_AVAILABLE=I.INVALID_BINDING_TYPE=I.NOT_IMPLEMENTED=I.CIRCULAR_DEPENDENCY=I.UNDEFINED_INJECT_ANNOTATION=I.MISSING_INJECT_ANNOTATION=I.MISSING_INJECTABLE_ANNOTATION=I.NOT_REGISTERED=I.CANNOT_UNBIND=I.AMBIGUOUS_MATCH=I.KEY_NOT_FOUND=I.NULL_ARGUMENT=I.DUPLICATED_METADATA=I.DUPLICATED_INJECTABLE_DECORATOR=void 0,I.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",I.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",I.NULL_ARGUMENT="NULL argument",I.KEY_NOT_FOUND="Key Not Found",I.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",I.CANNOT_UNBIND="Could not unbind serviceIdentifier:",I.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",I.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",I.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var S=function(W){return"@inject called with undefined this could mean that the class "+W+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};I.UNDEFINED_INJECT_ANNOTATION=S,I.CIRCULAR_DEPENDENCY="Circular dependency found:",I.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",I.INVALID_BINDING_TYPE="Invalid binding type:",I.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",I.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",I.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",I.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",I.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var N=function(){for(var W=[],j=0;j<arguments.length;j++)W[j]=arguments[j];return"The number of constructor arguments in the derived class "+(W[0]+" must be >= than the number of constructor arguments of its base class.")};I.ARGUMENTS_LENGTH_MISMATCH=N,I.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",I.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",I.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",I.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",I.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";var x=function(){for(var W=[],j=0;j<arguments.length;j++)W[j]=arguments[j];return"@postConstruct error in class "+W[0]+": "+W[1]};I.POST_CONSTRUCT_ERROR=x;var ne=function(){for(var W=[],j=0;j<arguments.length;j++)W[j]=arguments[j];return"It looks like there is a circular dependency "+("in one of the '"+W[0]+"' bindings. Please investigate bindings with")+("service identifier '"+W[1]+"'.")};I.CIRCULAR_DEPENDENCY_IN_FACTORY=ne,I.STACK_OVERFLOW="Maximum call stack size exceeded"},28421:function(Te,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.TargetTypeEnum=I.BindingTypeEnum=I.BindingScopeEnum=void 0;var S={Request:"Request",Singleton:"Singleton",Transient:"Transient"};I.BindingScopeEnum=S;var N={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};I.BindingTypeEnum=N;var x={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};I.TargetTypeEnum=x},6867:function(Te,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.NON_CUSTOM_TAG_KEYS=I.POST_CONSTRUCT=I.DESIGN_PARAM_TYPES=I.PARAM_TYPES=I.TAGGED_PROP=I.TAGGED=I.MULTI_INJECT_TAG=I.INJECT_TAG=I.OPTIONAL_TAG=I.UNMANAGED_TAG=I.NAME_TAG=I.NAMED_TAG=void 0,I.NAMED_TAG="named",I.NAME_TAG="name",I.UNMANAGED_TAG="unmanaged",I.OPTIONAL_TAG="optional",I.INJECT_TAG="inject",I.MULTI_INJECT_TAG="multi_inject",I.TAGGED="inversify:tagged",I.TAGGED_PROP="inversify:tagged_props",I.PARAM_TYPES="inversify:paramtypes",I.DESIGN_PARAM_TYPES="design:paramtypes",I.POST_CONSTRUCT="post_construct";function S(){return[I.INJECT_TAG,I.MULTI_INJECT_TAG,I.NAME_TAG,I.UNMANAGED_TAG,I.NAMED_TAG,I.OPTIONAL_TAG]}I.NON_CUSTOM_TAG_KEYS=S()},51389:function(Te,I,S){"use strict";var N=this&&this.__awaiter||function(ht,Oe,Re,Dt){function ot(ft){return ft instanceof Re?ft:new Re(function(Ct){Ct(ft)})}return new(Re||(Re=Promise))(function(ft,Ct){function St(tn){try{vt(Dt.next(tn))}catch($n){Ct($n)}}function Zt(tn){try{vt(Dt.throw(tn))}catch($n){Ct($n)}}function vt(tn){tn.done?ft(tn.value):ot(tn.value).then(St,Zt)}vt((Dt=Dt.apply(ht,Oe||[])).next())})},x=this&&this.__generator||function(ht,Oe){var Re={label:0,sent:function(){if(ft[0]&1)throw ft[1];return ft[1]},trys:[],ops:[]},Dt,ot,ft,Ct;return Ct={next:St(0),throw:St(1),return:St(2)},typeof Symbol=="function"&&(Ct[Symbol.iterator]=function(){return this}),Ct;function St(vt){return function(tn){return Zt([vt,tn])}}function Zt(vt){if(Dt)throw new TypeError("Generator is already executing.");for(;Re;)try{if(Dt=1,ot&&(ft=vt[0]&2?ot.return:vt[0]?ot.throw||((ft=ot.return)&&ft.call(ot),0):ot.next)&&!(ft=ft.call(ot,vt[1])).done)return ft;switch(ot=0,ft&&(vt=[vt[0]&2,ft.value]),vt[0]){case 0:case 1:ft=vt;break;case 4:return Re.label++,{value:vt[1],done:!1};case 5:Re.label++,ot=vt[1],vt=[0];continue;case 7:vt=Re.ops.pop(),Re.trys.pop();continue;default:if(ft=Re.trys,!(ft=ft.length>0&&ft[ft.length-1])&&(vt[0]===6||vt[0]===2)){Re=0;continue}if(vt[0]===3&&(!ft||vt[1]>ft[0]&&vt[1]<ft[3])){Re.label=vt[1];break}if(vt[0]===6&&Re.label<ft[1]){Re.label=ft[1],ft=vt;break}if(ft&&Re.label<ft[2]){Re.label=ft[2],Re.ops.push(vt);break}ft[2]&&Re.ops.pop(),Re.trys.pop();continue}vt=Oe.call(ht,Re)}catch(tn){vt=[6,tn],ot=0}finally{Dt=ft=0}if(vt[0]&5)throw vt[1];return{value:vt[0]?vt[1]:void 0,done:!0}}},ne=this&&this.__spreadArray||function(ht,Oe){for(var Re=0,Dt=Oe.length,ot=ht.length;Re<Dt;Re++,ot++)ht[ot]=Oe[Re];return ht};Object.defineProperty(I,"__esModule",{value:!0}),I.Container=void 0;var W=S(44290),j=S(16674),V=S(28421),Z=S(6867),De=S(51377),he=S(86311),be=S(31927),at=S(51860),We=S(37791),Ht=S(55800),Yt=S(85700),dt=S(80175),Et=function(){function ht(Oe){this._appliedMiddleware=[];var Re=Oe||{};if(typeof Re!="object")throw new Error(""+j.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(Re.defaultScope===void 0)Re.defaultScope=V.BindingScopeEnum.Transient;else if(Re.defaultScope!==V.BindingScopeEnum.Singleton&&Re.defaultScope!==V.BindingScopeEnum.Transient&&Re.defaultScope!==V.BindingScopeEnum.Request)throw new Error(""+j.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(Re.autoBindInjectable===void 0)Re.autoBindInjectable=!1;else if(typeof Re.autoBindInjectable!="boolean")throw new Error(""+j.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(Re.skipBaseClassChecks===void 0)Re.skipBaseClassChecks=!1;else if(typeof Re.skipBaseClassChecks!="boolean")throw new Error(""+j.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:Re.autoBindInjectable,defaultScope:Re.defaultScope,skipBaseClassChecks:Re.skipBaseClassChecks},this.id=We.id(),this._bindingDictionary=new dt.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new De.MetadataReader}return ht.merge=function(Oe,Re){for(var Dt=[],ot=2;ot<arguments.length;ot++)Dt[ot-2]=arguments[ot];var ft=new ht,Ct=ne([Oe,Re],Dt).map(function(vt){return he.getBindingDictionary(vt)}),St=he.getBindingDictionary(ft);function Zt(vt,tn){vt.traverse(function($n,X){X.forEach(function(Dr){tn.add(Dr.serviceIdentifier,Dr.clone())})})}return Ct.forEach(function(vt){Zt(vt,St)}),ft},ht.prototype.load=function(){for(var Oe=[],Re=0;Re<arguments.length;Re++)Oe[Re]=arguments[Re];for(var Dt=this._getContainerModuleHelpersFactory(),ot=0,ft=Oe;ot<ft.length;ot++){var Ct=ft[ot],St=Dt(Ct.id);Ct.registry(St.bindFunction,St.unbindFunction,St.isboundFunction,St.rebindFunction)}},ht.prototype.loadAsync=function(){for(var Oe=[],Re=0;Re<arguments.length;Re++)Oe[Re]=arguments[Re];return N(this,void 0,void 0,function(){var Dt,ot,ft,Ct,St;return x(this,function(Zt){switch(Zt.label){case 0:Dt=this._getContainerModuleHelpersFactory(),ot=0,ft=Oe,Zt.label=1;case 1:return ot<ft.length?(Ct=ft[ot],St=Dt(Ct.id),[4,Ct.registry(St.bindFunction,St.unbindFunction,St.isboundFunction,St.rebindFunction)]):[3,4];case 2:Zt.sent(),Zt.label=3;case 3:return ot++,[3,1];case 4:return[2]}})})},ht.prototype.unload=function(){for(var Oe=this,Re=[],Dt=0;Dt<arguments.length;Dt++)Re[Dt]=arguments[Dt];var ot=function(ft){return function(Ct){return Ct.moduleId===ft}};Re.forEach(function(ft){var Ct=ot(ft.id);Oe._bindingDictionary.removeByCondition(Ct)})},ht.prototype.bind=function(Oe){var Re=this.options.defaultScope||V.BindingScopeEnum.Transient,Dt=new W.Binding(Oe,Re);return this._bindingDictionary.add(Oe,Dt),new at.BindingToSyntax(Dt)},ht.prototype.rebind=function(Oe){return this.unbind(Oe),this.bind(Oe)},ht.prototype.unbind=function(Oe){try{this._bindingDictionary.remove(Oe)}catch(Re){throw new Error(j.CANNOT_UNBIND+" "+Ht.getServiceIdentifierAsString(Oe))}},ht.prototype.unbindAll=function(){this._bindingDictionary=new dt.Lookup},ht.prototype.isBound=function(Oe){var Re=this._bindingDictionary.hasKey(Oe);return!Re&&this.parent&&(Re=this.parent.isBound(Oe)),Re},ht.prototype.isBoundNamed=function(Oe,Re){return this.isBoundTagged(Oe,Z.NAMED_TAG,Re)},ht.prototype.isBoundTagged=function(Oe,Re,Dt){var ot=!1;if(this._bindingDictionary.hasKey(Oe)){var ft=this._bindingDictionary.get(Oe),Ct=he.createMockRequest(this,Oe,Re,Dt);ot=ft.some(function(St){return St.constraint(Ct)})}return!ot&&this.parent&&(ot=this.parent.isBoundTagged(Oe,Re,Dt)),ot},ht.prototype.snapshot=function(){this._snapshots.push(Yt.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},ht.prototype.restore=function(){var Oe=this._snapshots.pop();if(Oe===void 0)throw new Error(j.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=Oe.bindings,this._middleware=Oe.middleware},ht.prototype.createChild=function(Oe){var Re=new ht(Oe||this.options);return Re.parent=this,Re},ht.prototype.applyMiddleware=function(){for(var Oe=[],Re=0;Re<arguments.length;Re++)Oe[Re]=arguments[Re];this._appliedMiddleware=this._appliedMiddleware.concat(Oe);var Dt=this._middleware?this._middleware:this._planAndResolve();this._middleware=Oe.reduce(function(ot,ft){return ft(ot)},Dt)},ht.prototype.applyCustomMetadataReader=function(Oe){this._metadataReader=Oe},ht.prototype.get=function(Oe){return this._get(!1,!1,V.TargetTypeEnum.Variable,Oe)},ht.prototype.getTagged=function(Oe,Re,Dt){return this._get(!1,!1,V.TargetTypeEnum.Variable,Oe,Re,Dt)},ht.prototype.getNamed=function(Oe,Re){return this.getTagged(Oe,Z.NAMED_TAG,Re)},ht.prototype.getAll=function(Oe){return this._get(!0,!0,V.TargetTypeEnum.Variable,Oe)},ht.prototype.getAllTagged=function(Oe,Re,Dt){return this._get(!1,!0,V.TargetTypeEnum.Variable,Oe,Re,Dt)},ht.prototype.getAllNamed=function(Oe,Re){return this.getAllTagged(Oe,Z.NAMED_TAG,Re)},ht.prototype.resolve=function(Oe){var Re=this.createChild();return Re.bind(Oe).toSelf(),this._appliedMiddleware.forEach(function(Dt){Re.applyMiddleware(Dt)}),Re.get(Oe)},ht.prototype._getContainerModuleHelpersFactory=function(){var Oe=this,Re=function(St,Zt){St._binding.moduleId=Zt},Dt=function(St){return function(Zt){var vt=Oe.bind.bind(Oe),tn=vt(Zt);return Re(tn,St),tn}},ot=function(St){return function(Zt){var vt=Oe.unbind.bind(Oe);vt(Zt)}},ft=function(St){return function(Zt){var vt=Oe.isBound.bind(Oe);return vt(Zt)}},Ct=function(St){return function(Zt){var vt=Oe.rebind.bind(Oe),tn=vt(Zt);return Re(tn,St),tn}};return function(St){return{bindFunction:Dt(St),isboundFunction:ft(St),rebindFunction:Ct(St),unbindFunction:ot(St)}}},ht.prototype._get=function(Oe,Re,Dt,ot,ft,Ct){var St=null,Zt={avoidConstraints:Oe,contextInterceptor:function(vt){return vt},isMultiInject:Re,key:ft,serviceIdentifier:ot,targetType:Dt,value:Ct};if(this._middleware){if(St=this._middleware(Zt),St==null)throw new Error(j.INVALID_MIDDLEWARE_RETURN)}else St=this._planAndResolve()(Zt);return St},ht.prototype._planAndResolve=function(){var Oe=this;return function(Re){var Dt=he.plan(Oe._metadataReader,Oe,Re.isMultiInject,Re.targetType,Re.serviceIdentifier,Re.key,Re.value,Re.avoidConstraints);Dt=Re.contextInterceptor(Dt);var ot=be.resolve(Dt);return ot}},ht}();I.Container=Et},33244:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.AsyncContainerModule=I.ContainerModule=void 0;var N=S(37791),x=function(){function W(j){this.id=N.id(),this.registry=j}return W}();I.ContainerModule=x;var ne=function(){function W(j){this.id=N.id(),this.registry=j}return W}();I.AsyncContainerModule=ne},85700:function(Te,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.ContainerSnapshot=void 0;var S=function(){function N(){}return N.of=function(x,ne){var W=new N;return W.bindings=x,W.middleware=ne,W},N}();I.ContainerSnapshot=S},80175:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.Lookup=void 0;var N=S(16674),x=function(){function ne(){this._map=new Map}return ne.prototype.getMap=function(){return this._map},ne.prototype.add=function(W,j){if(W==null)throw new Error(N.NULL_ARGUMENT);if(j==null)throw new Error(N.NULL_ARGUMENT);var V=this._map.get(W);V!==void 0?(V.push(j),this._map.set(W,V)):this._map.set(W,[j])},ne.prototype.get=function(W){if(W==null)throw new Error(N.NULL_ARGUMENT);var j=this._map.get(W);if(j!==void 0)return j;throw new Error(N.KEY_NOT_FOUND)},ne.prototype.remove=function(W){if(W==null)throw new Error(N.NULL_ARGUMENT);if(!this._map.delete(W))throw new Error(N.KEY_NOT_FOUND)},ne.prototype.removeByCondition=function(W){var j=this;this._map.forEach(function(V,Z){var De=V.filter(function(he){return!W(he)});De.length>0?j._map.set(Z,De):j._map.delete(Z)})},ne.prototype.hasKey=function(W){if(W==null)throw new Error(N.NULL_ARGUMENT);return this._map.has(W)},ne.prototype.clone=function(){var W=new ne;return this._map.forEach(function(j,V){j.forEach(function(Z){return W.add(V,Z.clone())})}),W},ne.prototype.traverse=function(W){this._map.forEach(function(j,V){W(V,j)})},ne}();I.Lookup=x},86700:function(Te,I,S){"use strict";var N;N={value:!0},N=N=N=N=N=N=N=N=N=N=N=N=N=N=N=I.f3=I.t6=N=I.b2=N=N=N=N=N=I.W2=N=void 0;var x=S(6867);N=x;var ne=S(51389);Object.defineProperty(I,"W2",{enumerable:!0,get:function(){return ne.Container}});var W=S(28421);N={enumerable:!0,get:function(){return W.BindingScopeEnum}},N={enumerable:!0,get:function(){return W.BindingTypeEnum}},N={enumerable:!0,get:function(){return W.TargetTypeEnum}};var j=S(33244);N={enumerable:!0,get:function(){return j.AsyncContainerModule}},N={enumerable:!0,get:function(){return j.ContainerModule}};var V=S(64315);Object.defineProperty(I,"b2",{enumerable:!0,get:function(){return V.injectable}});var Z=S(32052);N={enumerable:!0,get:function(){return Z.tagged}};var De=S(38085);Object.defineProperty(I,"t6",{enumerable:!0,get:function(){return De.named}});var he=S(5744);Object.defineProperty(I,"f3",{enumerable:!0,get:function(){return he.inject}}),N={enumerable:!0,get:function(){return he.LazyServiceIdentifer}};var be=S(6515);N={enumerable:!0,get:function(){return be.optional}};var at=S(86757);N={enumerable:!0,get:function(){return at.unmanaged}};var We=S(71693);N={enumerable:!0,get:function(){return We.multiInject}};var Ht=S(55638);N={enumerable:!0,get:function(){return Ht.targetName}};var Yt=S(7014);N={enumerable:!0,get:function(){return Yt.postConstruct}};var dt=S(51377);N={enumerable:!0,get:function(){return dt.MetadataReader}};var Et=S(37791);N={enumerable:!0,get:function(){return Et.id}};var ht=S(99934);N={enumerable:!0,get:function(){return ht.decorate}};var Oe=S(80758);N={enumerable:!0,get:function(){return Oe.traverseAncerstors}},N={enumerable:!0,get:function(){return Oe.taggedConstraint}},N={enumerable:!0,get:function(){return Oe.namedConstraint}},N={enumerable:!0,get:function(){return Oe.typeConstraint}};var Re=S(55800);N={enumerable:!0,get:function(){return Re.getServiceIdentifierAsString}};var Dt=S(70600);N={enumerable:!0,get:function(){return Dt.multiBindToService}}},95228:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.Context=void 0;var N=S(37791),x=function(){function ne(W){this.id=N.id(),this.container=W}return ne.prototype.addPlan=function(W){this.plan=W},ne.prototype.setCurrentRequest=function(W){this.currentRequest=W},ne}();I.Context=x},47738:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.Metadata=void 0;var N=S(6867),x=function(){function ne(W,j){this.key=W,this.value=j}return ne.prototype.toString=function(){return this.key===N.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},ne}();I.Metadata=x},51377:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.MetadataReader=void 0;var N=S(6867),x=function(){function ne(){}return ne.prototype.getConstructorMetadata=function(W){var j=Reflect.getMetadata(N.PARAM_TYPES,W),V=Reflect.getMetadata(N.TAGGED,W);return{compilerGeneratedMetadata:j,userGeneratedMetadata:V||{}}},ne.prototype.getPropertiesMetadata=function(W){var j=Reflect.getMetadata(N.TAGGED_PROP,W)||[];return j},ne}();I.MetadataReader=x},55314:function(Te,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.Plan=void 0;var S=function(){function N(x,ne){this.parentContext=x,this.rootRequest=ne}return N}();I.Plan=S},86311:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.getBindingDictionary=I.createMockRequest=I.plan=void 0;var N=S(23184),x=S(16674),ne=S(28421),W=S(6867),j=S(85265),V=S(55800),Z=S(95228),De=S(47738),he=S(55314),be=S(6e3),at=S(6748),We=S(18924);function Ht(ot){return ot._bindingDictionary}I.getBindingDictionary=Ht;function Yt(ot,ft,Ct,St,Zt,vt){var tn=ot?W.MULTI_INJECT_TAG:W.INJECT_TAG,$n=new De.Metadata(tn,Ct),X=new We.Target(ft,St,Ct,$n);if(Zt!==void 0){var Dr=new De.Metadata(Zt,vt);X.metadata.push(Dr)}return X}function dt(ot,ft,Ct,St,Zt){var vt=Oe(Ct.container,Zt.serviceIdentifier),tn=[];return vt.length===N.BindingCount.NoBindingsAvailable&&Ct.container.options.autoBindInjectable&&typeof Zt.serviceIdentifier=="function"&&ot.getConstructorMetadata(Zt.serviceIdentifier).compilerGeneratedMetadata&&(Ct.container.bind(Zt.serviceIdentifier).toSelf(),vt=Oe(Ct.container,Zt.serviceIdentifier)),ft?tn=vt:tn=vt.filter(function($n){var X=new at.Request($n.serviceIdentifier,Ct,St,$n,Zt);return $n.constraint(X)}),Et(Zt.serviceIdentifier,tn,Zt,Ct.container),tn}function Et(ot,ft,Ct,St){switch(ft.length){case N.BindingCount.NoBindingsAvailable:if(Ct.isOptional())return ft;var Zt=V.getServiceIdentifierAsString(ot),vt=x.NOT_REGISTERED;throw vt+=V.listMetadataForTarget(Zt,Ct),vt+=V.listRegisteredBindingsForServiceIdentifier(St,Zt,Oe),new Error(vt);case N.BindingCount.OnlyOneBindingAvailable:if(!Ct.isArray())return ft;case N.BindingCount.MultipleBindingsAvailable:default:if(Ct.isArray())return ft;var Zt=V.getServiceIdentifierAsString(ot),vt=x.AMBIGUOUS_MATCH+" "+Zt;throw vt+=V.listRegisteredBindingsForServiceIdentifier(St,Zt,Oe),new Error(vt)}}function ht(ot,ft,Ct,St,Zt,vt){var tn,$n;if(Zt===null){tn=dt(ot,ft,St,null,vt),$n=new at.Request(Ct,St,null,tn,vt);var X=new he.Plan(St,$n);St.addPlan(X)}else tn=dt(ot,ft,St,Zt,vt),$n=Zt.addChildRequest(vt.serviceIdentifier,tn,vt);tn.forEach(function(Dr){var Ki=null;if(vt.isArray())Ki=$n.addChildRequest(Dr.serviceIdentifier,Dr,vt);else{if(Dr.cache)return;Ki=$n}if(Dr.type===ne.BindingTypeEnum.Instance&&Dr.implementationType!==null){var es=be.getDependencies(ot,Dr.implementationType);if(!St.container.options.skipBaseClassChecks){var ar=be.getBaseClassDependencyCount(ot,Dr.implementationType);if(es.length<ar){var Gi=x.ARGUMENTS_LENGTH_MISMATCH(be.getFunctionName(Dr.implementationType));throw new Error(Gi)}}es.forEach(function(Fa){ht(ot,!1,Fa.serviceIdentifier,St,Ki,Fa)})}})}function Oe(ot,ft){var Ct=[],St=Ht(ot);return St.hasKey(ft)?Ct=St.get(ft):ot.parent!==null&&(Ct=Oe(ot.parent,ft)),Ct}function Re(ot,ft,Ct,St,Zt,vt,tn,$n){$n===void 0&&($n=!1);var X=new Z.Context(ft),Dr=Yt(Ct,St,Zt,"",vt,tn);try{return ht(ot,$n,Zt,X,null,Dr),X}catch(Ki){throw j.isStackOverflowExeption(Ki)&&X.plan&&V.circularDependencyToException(X.plan.rootRequest),Ki}}I.plan=Re;function Dt(ot,ft,Ct,St){var Zt=new We.Target(ne.TargetTypeEnum.Variable,"",ft,new De.Metadata(Ct,St)),vt=new Z.Context(ot),tn=new at.Request(ft,vt,null,[],Zt);return tn}I.createMockRequest=Dt},88460:function(Te,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.QueryableString=void 0;var S=function(){function N(x){this.str=x}return N.prototype.startsWith=function(x){return this.str.indexOf(x)===0},N.prototype.endsWith=function(x){var ne="",W=x.split("").reverse().join("");return ne=this.str.split("").reverse().join(""),this.startsWith.call({str:ne},W)},N.prototype.contains=function(x){return this.str.indexOf(x)!==-1},N.prototype.equals=function(x){return this.str===x},N.prototype.value=function(){return this.str},N}();I.QueryableString=S},6e3:function(Te,I,S){"use strict";var N=this&&this.__spreadArray||function(dt,Et){for(var ht=0,Oe=Et.length,Re=dt.length;ht<Oe;ht++,Re++)dt[Re]=Et[ht];return dt};Object.defineProperty(I,"__esModule",{value:!0}),I.getFunctionName=I.getBaseClassDependencyCount=I.getDependencies=void 0;var x=S(5744),ne=S(16674),W=S(28421),j=S(6867),V=S(55800);Object.defineProperty(I,"getFunctionName",{enumerable:!0,get:function(){return V.getFunctionName}});var Z=S(18924);function De(dt,Et){var ht=V.getFunctionName(Et),Oe=he(dt,ht,Et,!1);return Oe}I.getDependencies=De;function he(dt,Et,ht,Oe){var Re=dt.getConstructorMetadata(ht),Dt=Re.compilerGeneratedMetadata;if(Dt===void 0){var ot=ne.MISSING_INJECTABLE_ANNOTATION+" "+Et+".";throw new Error(ot)}var ft=Re.userGeneratedMetadata,Ct=Object.keys(ft),St=ht.length===0&&Ct.length>0,Zt=Ct.length>ht.length,vt=St||Zt?Ct.length:ht.length,tn=at(Oe,Et,Dt,ft,vt),$n=We(dt,ht),X=N(N([],tn),$n);return X}function be(dt,Et,ht,Oe,Re){var Dt=Re[dt.toString()]||[],ot=Yt(Dt),ft=ot.unmanaged!==!0,Ct=Oe[dt],St=ot.inject||ot.multiInject;if(Ct=St||Ct,Ct instanceof x.LazyServiceIdentifer&&(Ct=Ct.unwrap()),ft){var Zt=Ct===Object,vt=Ct===Function,tn=Ct===void 0,$n=Zt||vt||tn;if(!Et&&$n){var X=ne.MISSING_INJECT_ANNOTATION+" argument "+dt+" in class "+ht+".";throw new Error(X)}var Dr=new Z.Target(W.TargetTypeEnum.ConstructorArgument,ot.targetName,Ct);return Dr.metadata=Dt,Dr}return null}function at(dt,Et,ht,Oe,Re){for(var Dt=[],ot=0;ot<Re;ot++){var ft=ot,Ct=be(ft,dt,Et,ht,Oe);Ct!==null&&Dt.push(Ct)}return Dt}function We(dt,Et){for(var ht=dt.getPropertiesMetadata(Et),Oe=[],Re=Object.keys(ht),Dt=0,ot=Re;Dt<ot.length;Dt++){var ft=ot[Dt],Ct=ht[ft],St=Yt(ht[ft]),Zt=St.targetName||ft,vt=St.inject||St.multiInject,tn=new Z.Target(W.TargetTypeEnum.ClassProperty,Zt,vt);tn.metadata=Ct,Oe.push(tn)}var $n=Object.getPrototypeOf(Et.prototype).constructor;if($n!==Object){var X=We(dt,$n);Oe=N(N([],Oe),X)}return Oe}function Ht(dt,Et){var ht=Object.getPrototypeOf(Et.prototype).constructor;if(ht!==Object){var Oe=V.getFunctionName(ht),Re=he(dt,Oe,ht,!0),Dt=Re.map(function(Ct){return Ct.metadata.filter(function(St){return St.key===j.UNMANAGED_TAG})}),ot=[].concat.apply([],Dt).length,ft=Re.length-ot;return ft>0?ft:Ht(dt,ht)}else return 0}I.getBaseClassDependencyCount=Ht;function Yt(dt){var Et={};return dt.forEach(function(ht){Et[ht.key.toString()]=ht.value}),{inject:Et[j.INJECT_TAG],multiInject:Et[j.MULTI_INJECT_TAG],targetName:Et[j.NAME_TAG],unmanaged:Et[j.UNMANAGED_TAG]}}},6748:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.Request=void 0;var N=S(37791),x=function(){function ne(W,j,V,Z,De){this.id=N.id(),this.serviceIdentifier=W,this.parentContext=j,this.parentRequest=V,this.target=De,this.childRequests=[],this.bindings=Array.isArray(Z)?Z:[Z],this.requestScope=V===null?new Map:null}return ne.prototype.addChildRequest=function(W,j,V){var Z=new ne(W,this.parentContext,this,j,V);return this.childRequests.push(Z),Z},ne}();I.Request=x},18924:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.Target=void 0;var N=S(6867),x=S(37791),ne=S(47738),W=S(88460),j=function(){function V(Z,De,he,be){this.id=x.id(),this.type=Z,this.serviceIdentifier=he,this.name=new W.QueryableString(De||""),this.metadata=new Array;var at=null;typeof be=="string"?at=new ne.Metadata(N.NAMED_TAG,be):be instanceof ne.Metadata&&(at=be),at!==null&&this.metadata.push(at)}return V.prototype.hasTag=function(Z){for(var De=0,he=this.metadata;De<he.length;De++){var be=he[De];if(be.key===Z)return!0}return!1},V.prototype.isArray=function(){return this.hasTag(N.MULTI_INJECT_TAG)},V.prototype.matchesArray=function(Z){return this.matchesTag(N.MULTI_INJECT_TAG)(Z)},V.prototype.isNamed=function(){return this.hasTag(N.NAMED_TAG)},V.prototype.isTagged=function(){return this.metadata.some(function(Z){return N.NON_CUSTOM_TAG_KEYS.every(function(De){return Z.key!==De})})},V.prototype.isOptional=function(){return this.matchesTag(N.OPTIONAL_TAG)(!0)},V.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(Z){return Z.key===N.NAMED_TAG})[0]:null},V.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(Z){return N.NON_CUSTOM_TAG_KEYS.every(function(De){return Z.key!==De})}):null},V.prototype.matchesNamedTag=function(Z){return this.matchesTag(N.NAMED_TAG)(Z)},V.prototype.matchesTag=function(Z){var De=this;return function(he){for(var be=0,at=De.metadata;be<at.length;be++){var We=at[be];if(We.key===Z&&We.value===he)return!0}return!1}},V}();I.Target=j},52279:function(Te,I,S){"use strict";var N=this&&this.__spreadArray||function(he,be){for(var at=0,We=be.length,Ht=he.length;at<We;at++,Ht++)he[Ht]=be[at];return he};Object.defineProperty(I,"__esModule",{value:!0}),I.resolveInstance=void 0;var x=S(16674),ne=S(28421),W=S(6867);function j(he,be,at){var We=be.filter(function(Yt){return Yt.target!==null&&Yt.target.type===ne.TargetTypeEnum.ClassProperty}),Ht=We.map(at);return We.forEach(function(Yt,dt){var Et="";Et=Yt.target.name.value();var ht=Ht[dt];he[Et]=ht}),he}function V(he,be){return new(he.bind.apply(he,N([void 0],be)))}function Z(he,be){if(Reflect.hasMetadata(W.POST_CONSTRUCT,he)){var at=Reflect.getMetadata(W.POST_CONSTRUCT,he);try{be[at.value]()}catch(We){throw new Error(x.POST_CONSTRUCT_ERROR(he.name,We.message))}}}function De(he,be,at){var We=null;if(be.length>0){var Ht=be.filter(function(dt){return dt.target!==null&&dt.target.type===ne.TargetTypeEnum.ConstructorArgument}),Yt=Ht.map(at);We=V(he,Yt),We=j(We,be,at)}else We=new he;return Z(he,We),We}I.resolveInstance=De},31927:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.resolve=void 0;var N=S(16674),x=S(28421),ne=S(85265),W=S(55800),j=S(52279),V=function(he,be,at){try{return at()}catch(We){throw ne.isStackOverflowExeption(We)?new Error(N.CIRCULAR_DEPENDENCY_IN_FACTORY(he,be.toString())):We}},Z=function(he){return function(be){be.parentContext.setCurrentRequest(be);var at=be.bindings,We=be.childRequests,Ht=be.target&&be.target.isArray(),Yt=!be.parentRequest||!be.parentRequest.target||!be.target||!be.parentRequest.target.matchesArray(be.target.serviceIdentifier);if(Ht&&Yt)return We.map(function(Dt){var ot=Z(he);return ot(Dt)});var dt=null;if(be.target.isOptional()&&at.length===0)return;var Et=at[0],ht=Et.scope===x.BindingScopeEnum.Singleton,Oe=Et.scope===x.BindingScopeEnum.Request;if(ht&&Et.activated)return Et.cache;if(Oe&&he!==null&&he.has(Et.id))return he.get(Et.id);if(Et.type===x.BindingTypeEnum.ConstantValue)dt=Et.cache,Et.activated=!0;else if(Et.type===x.BindingTypeEnum.Function)dt=Et.cache,Et.activated=!0;else if(Et.type===x.BindingTypeEnum.Constructor)dt=Et.implementationType;else if(Et.type===x.BindingTypeEnum.DynamicValue&&Et.dynamicValue!==null)dt=V("toDynamicValue",Et.serviceIdentifier,function(){return Et.dynamicValue(be.parentContext)});else if(Et.type===x.BindingTypeEnum.Factory&&Et.factory!==null)dt=V("toFactory",Et.serviceIdentifier,function(){return Et.factory(be.parentContext)});else if(Et.type===x.BindingTypeEnum.Provider&&Et.provider!==null)dt=V("toProvider",Et.serviceIdentifier,function(){return Et.provider(be.parentContext)});else if(Et.type===x.BindingTypeEnum.Instance&&Et.implementationType!==null)dt=j.resolveInstance(Et.implementationType,We,Z(he));else{var Re=W.getServiceIdentifierAsString(be.serviceIdentifier);throw new Error(N.INVALID_BINDING_TYPE+" "+Re)}return typeof Et.onActivation=="function"&&(dt=Et.onActivation(be.parentContext,dt)),ht&&(Et.cache=dt,Et.activated=!0),Oe&&he!==null&&!he.has(Et.id)&&he.set(Et.id,dt),dt}};function De(he){var be=Z(he.plan.rootRequest.requestScope);return be(he.plan.rootRequest)}I.resolve=De},83366:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.BindingInSyntax=void 0;var N=S(28421),x=S(71325),ne=function(){function W(j){this._binding=j}return W.prototype.inRequestScope=function(){return this._binding.scope=N.BindingScopeEnum.Request,new x.BindingWhenOnSyntax(this._binding)},W.prototype.inSingletonScope=function(){return this._binding.scope=N.BindingScopeEnum.Singleton,new x.BindingWhenOnSyntax(this._binding)},W.prototype.inTransientScope=function(){return this._binding.scope=N.BindingScopeEnum.Transient,new x.BindingWhenOnSyntax(this._binding)},W}();I.BindingInSyntax=ne},99812:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.BindingInWhenOnSyntax=void 0;var N=S(83366),x=S(51811),ne=S(98370),W=function(){function j(V){this._binding=V,this._bindingWhenSyntax=new ne.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new x.BindingOnSyntax(this._binding),this._bindingInSyntax=new N.BindingInSyntax(V)}return j.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},j.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},j.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},j.prototype.when=function(V){return this._bindingWhenSyntax.when(V)},j.prototype.whenTargetNamed=function(V){return this._bindingWhenSyntax.whenTargetNamed(V)},j.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},j.prototype.whenTargetTagged=function(V,Z){return this._bindingWhenSyntax.whenTargetTagged(V,Z)},j.prototype.whenInjectedInto=function(V){return this._bindingWhenSyntax.whenInjectedInto(V)},j.prototype.whenParentNamed=function(V){return this._bindingWhenSyntax.whenParentNamed(V)},j.prototype.whenParentTagged=function(V,Z){return this._bindingWhenSyntax.whenParentTagged(V,Z)},j.prototype.whenAnyAncestorIs=function(V){return this._bindingWhenSyntax.whenAnyAncestorIs(V)},j.prototype.whenNoAncestorIs=function(V){return this._bindingWhenSyntax.whenNoAncestorIs(V)},j.prototype.whenAnyAncestorNamed=function(V){return this._bindingWhenSyntax.whenAnyAncestorNamed(V)},j.prototype.whenAnyAncestorTagged=function(V,Z){return this._bindingWhenSyntax.whenAnyAncestorTagged(V,Z)},j.prototype.whenNoAncestorNamed=function(V){return this._bindingWhenSyntax.whenNoAncestorNamed(V)},j.prototype.whenNoAncestorTagged=function(V,Z){return this._bindingWhenSyntax.whenNoAncestorTagged(V,Z)},j.prototype.whenAnyAncestorMatches=function(V){return this._bindingWhenSyntax.whenAnyAncestorMatches(V)},j.prototype.whenNoAncestorMatches=function(V){return this._bindingWhenSyntax.whenNoAncestorMatches(V)},j.prototype.onActivation=function(V){return this._bindingOnSyntax.onActivation(V)},j}();I.BindingInWhenOnSyntax=W},51811:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.BindingOnSyntax=void 0;var N=S(98370),x=function(){function ne(W){this._binding=W}return ne.prototype.onActivation=function(W){return this._binding.onActivation=W,new N.BindingWhenSyntax(this._binding)},ne}();I.BindingOnSyntax=x},51860:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.BindingToSyntax=void 0;var N=S(16674),x=S(28421),ne=S(99812),W=S(71325),j=function(){function V(Z){this._binding=Z}return V.prototype.to=function(Z){return this._binding.type=x.BindingTypeEnum.Instance,this._binding.implementationType=Z,new ne.BindingInWhenOnSyntax(this._binding)},V.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+N.INVALID_TO_SELF_VALUE);var Z=this._binding.serviceIdentifier;return this.to(Z)},V.prototype.toConstantValue=function(Z){return this._binding.type=x.BindingTypeEnum.ConstantValue,this._binding.cache=Z,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=x.BindingScopeEnum.Singleton,new W.BindingWhenOnSyntax(this._binding)},V.prototype.toDynamicValue=function(Z){return this._binding.type=x.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=Z,this._binding.implementationType=null,new ne.BindingInWhenOnSyntax(this._binding)},V.prototype.toConstructor=function(Z){return this._binding.type=x.BindingTypeEnum.Constructor,this._binding.implementationType=Z,this._binding.scope=x.BindingScopeEnum.Singleton,new W.BindingWhenOnSyntax(this._binding)},V.prototype.toFactory=function(Z){return this._binding.type=x.BindingTypeEnum.Factory,this._binding.factory=Z,this._binding.scope=x.BindingScopeEnum.Singleton,new W.BindingWhenOnSyntax(this._binding)},V.prototype.toFunction=function(Z){if(typeof Z!="function")throw new Error(N.INVALID_FUNCTION_BINDING);var De=this.toConstantValue(Z);return this._binding.type=x.BindingTypeEnum.Function,this._binding.scope=x.BindingScopeEnum.Singleton,De},V.prototype.toAutoFactory=function(Z){return this._binding.type=x.BindingTypeEnum.Factory,this._binding.factory=function(De){var he=function(){return De.container.get(Z)};return he},this._binding.scope=x.BindingScopeEnum.Singleton,new W.BindingWhenOnSyntax(this._binding)},V.prototype.toProvider=function(Z){return this._binding.type=x.BindingTypeEnum.Provider,this._binding.provider=Z,this._binding.scope=x.BindingScopeEnum.Singleton,new W.BindingWhenOnSyntax(this._binding)},V.prototype.toService=function(Z){this.toDynamicValue(function(De){return De.container.get(Z)})},V}();I.BindingToSyntax=j},71325:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.BindingWhenOnSyntax=void 0;var N=S(51811),x=S(98370),ne=function(){function W(j){this._binding=j,this._bindingWhenSyntax=new x.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new N.BindingOnSyntax(this._binding)}return W.prototype.when=function(j){return this._bindingWhenSyntax.when(j)},W.prototype.whenTargetNamed=function(j){return this._bindingWhenSyntax.whenTargetNamed(j)},W.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},W.prototype.whenTargetTagged=function(j,V){return this._bindingWhenSyntax.whenTargetTagged(j,V)},W.prototype.whenInjectedInto=function(j){return this._bindingWhenSyntax.whenInjectedInto(j)},W.prototype.whenParentNamed=function(j){return this._bindingWhenSyntax.whenParentNamed(j)},W.prototype.whenParentTagged=function(j,V){return this._bindingWhenSyntax.whenParentTagged(j,V)},W.prototype.whenAnyAncestorIs=function(j){return this._bindingWhenSyntax.whenAnyAncestorIs(j)},W.prototype.whenNoAncestorIs=function(j){return this._bindingWhenSyntax.whenNoAncestorIs(j)},W.prototype.whenAnyAncestorNamed=function(j){return this._bindingWhenSyntax.whenAnyAncestorNamed(j)},W.prototype.whenAnyAncestorTagged=function(j,V){return this._bindingWhenSyntax.whenAnyAncestorTagged(j,V)},W.prototype.whenNoAncestorNamed=function(j){return this._bindingWhenSyntax.whenNoAncestorNamed(j)},W.prototype.whenNoAncestorTagged=function(j,V){return this._bindingWhenSyntax.whenNoAncestorTagged(j,V)},W.prototype.whenAnyAncestorMatches=function(j){return this._bindingWhenSyntax.whenAnyAncestorMatches(j)},W.prototype.whenNoAncestorMatches=function(j){return this._bindingWhenSyntax.whenNoAncestorMatches(j)},W.prototype.onActivation=function(j){return this._bindingOnSyntax.onActivation(j)},W}();I.BindingWhenOnSyntax=ne},98370:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.BindingWhenSyntax=void 0;var N=S(51811),x=S(80758),ne=function(){function W(j){this._binding=j}return W.prototype.when=function(j){return this._binding.constraint=j,new N.BindingOnSyntax(this._binding)},W.prototype.whenTargetNamed=function(j){return this._binding.constraint=x.namedConstraint(j),new N.BindingOnSyntax(this._binding)},W.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(j){var V=j.target!==null&&!j.target.isNamed()&&!j.target.isTagged();return V},new N.BindingOnSyntax(this._binding)},W.prototype.whenTargetTagged=function(j,V){return this._binding.constraint=x.taggedConstraint(j)(V),new N.BindingOnSyntax(this._binding)},W.prototype.whenInjectedInto=function(j){return this._binding.constraint=function(V){return x.typeConstraint(j)(V.parentRequest)},new N.BindingOnSyntax(this._binding)},W.prototype.whenParentNamed=function(j){return this._binding.constraint=function(V){return x.namedConstraint(j)(V.parentRequest)},new N.BindingOnSyntax(this._binding)},W.prototype.whenParentTagged=function(j,V){return this._binding.constraint=function(Z){return x.taggedConstraint(j)(V)(Z.parentRequest)},new N.BindingOnSyntax(this._binding)},W.prototype.whenAnyAncestorIs=function(j){return this._binding.constraint=function(V){return x.traverseAncerstors(V,x.typeConstraint(j))},new N.BindingOnSyntax(this._binding)},W.prototype.whenNoAncestorIs=function(j){return this._binding.constraint=function(V){return!x.traverseAncerstors(V,x.typeConstraint(j))},new N.BindingOnSyntax(this._binding)},W.prototype.whenAnyAncestorNamed=function(j){return this._binding.constraint=function(V){return x.traverseAncerstors(V,x.namedConstraint(j))},new N.BindingOnSyntax(this._binding)},W.prototype.whenNoAncestorNamed=function(j){return this._binding.constraint=function(V){return!x.traverseAncerstors(V,x.namedConstraint(j))},new N.BindingOnSyntax(this._binding)},W.prototype.whenAnyAncestorTagged=function(j,V){return this._binding.constraint=function(Z){return x.traverseAncerstors(Z,x.taggedConstraint(j)(V))},new N.BindingOnSyntax(this._binding)},W.prototype.whenNoAncestorTagged=function(j,V){return this._binding.constraint=function(Z){return!x.traverseAncerstors(Z,x.taggedConstraint(j)(V))},new N.BindingOnSyntax(this._binding)},W.prototype.whenAnyAncestorMatches=function(j){return this._binding.constraint=function(V){return x.traverseAncerstors(V,j)},new N.BindingOnSyntax(this._binding)},W.prototype.whenNoAncestorMatches=function(j){return this._binding.constraint=function(V){return!x.traverseAncerstors(V,j)},new N.BindingOnSyntax(this._binding)},W}();I.BindingWhenSyntax=ne},80758:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.typeConstraint=I.namedConstraint=I.taggedConstraint=I.traverseAncerstors=void 0;var N=S(6867),x=S(47738),ne=function(Z,De){var he=Z.parentRequest;return he!==null?De(he)?!0:ne(he,De):!1};I.traverseAncerstors=ne;var W=function(Z){return function(De){var he=function(be){return be!==null&&be.target!==null&&be.target.matchesTag(Z)(De)};return he.metaData=new x.Metadata(Z,De),he}};I.taggedConstraint=W;var j=W(N.NAMED_TAG);I.namedConstraint=j;var V=function(Z){return function(De){var he=null;if(De!==null)if(he=De.bindings[0],typeof Z=="string"){var be=he.serviceIdentifier;return be===Z}else{var at=De.bindings[0].implementationType;return Z===at}return!1}};I.typeConstraint=V},70600:function(Te,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.multiBindToService=void 0;var S=function(N){return function(x){return function(){for(var ne=[],W=0;W<arguments.length;W++)ne[W]=arguments[W];return ne.forEach(function(j){return N.bind(j).toService(x)})}}};I.multiBindToService=S},85265:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.isStackOverflowExeption=void 0;var N=S(16674);function x(ne){return ne instanceof RangeError||ne.message===N.STACK_OVERFLOW}I.isStackOverflowExeption=x},37791:function(Te,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.id=void 0;var S=0;function N(){return S++}I.id=N},55800:function(Te,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.circularDependencyToException=I.listMetadataForTarget=I.listRegisteredBindingsForServiceIdentifier=I.getServiceIdentifierAsString=I.getFunctionName=void 0;var N=S(16674);function x(he){if(typeof he=="function"){var be=he;return be.name}else{if(typeof he=="symbol")return he.toString();var be=he;return be}}I.getServiceIdentifierAsString=x;function ne(he,be,at){var We="",Ht=at(he,be);return Ht.length!==0&&(We=`
Registered bindings:`,Ht.forEach(function(Yt){var dt="Object";Yt.implementationType!==null&&(dt=De(Yt.implementationType)),We=We+`
 `+dt,Yt.constraint.metaData&&(We=We+" - "+Yt.constraint.metaData)})),We}I.listRegisteredBindingsForServiceIdentifier=ne;function W(he,be){return he.parentRequest===null?!1:he.parentRequest.serviceIdentifier===be?!0:W(he.parentRequest,be)}function j(he){function be(We,Ht){Ht===void 0&&(Ht=[]);var Yt=x(We.serviceIdentifier);return Ht.push(Yt),We.parentRequest!==null?be(We.parentRequest,Ht):Ht}var at=be(he);return at.reverse().join(" --> ")}function V(he){he.childRequests.forEach(function(be){if(W(be,be.serviceIdentifier)){var at=j(be);throw new Error(N.CIRCULAR_DEPENDENCY+" "+at)}else V(be)})}I.circularDependencyToException=V;function Z(he,be){if(be.isTagged()||be.isNamed()){var at="",We=be.getNamedTag(),Ht=be.getCustomTags();return We!==null&&(at+=We.toString()+`
`),Ht!==null&&Ht.forEach(function(Yt){at+=Yt.toString()+`
`})," "+he+`
 `+he+" - "+at}else return" "+he}I.listMetadataForTarget=Z;function De(he){if(he.name)return he.name;var be=he.toString(),at=be.match(/^function\s*([^\s(]+)/);return at?at[1]:"Anonymous function: "+be}I.getFunctionName=De},96486:function(Te,I,S){Te=S.nmd(Te);var N;/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(){var x,ne="4.17.21",W=200,j="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",V="Expected a function",Z="Invalid `variable` option passed into `_.template`",De="__lodash_hash_undefined__",he=500,be="__lodash_placeholder__",at=1,We=2,Ht=4,Yt=1,dt=2,Et=1,ht=2,Oe=4,Re=8,Dt=16,ot=32,ft=64,Ct=128,St=256,Zt=512,vt=30,tn="...",$n=800,X=16,Dr=1,Ki=2,es=3,ar=1/0,Gi=9007199254740991,Fa=17976931348623157e292,ao=0/0,ki=4294967295,Mo=ki-1,vu=ki>>>1,ei=[["ary",Ct],["bind",Et],["bindKey",ht],["curry",Re],["curryRight",Dt],["flip",Zt],["partial",ot],["partialRight",ft],["rearg",St]],oa="[object Arguments]",No="[object Array]",or="[object AsyncFunction]",ts="[object Boolean]",oo="[object Date]",ns="[object DOMException]",Do="[object Error]",Fi="[object Function]",rs="[object GeneratorFunction]",_i="[object Map]",ci="[object Number]",pu="[object Null]",Ti="[object Object]",Ps="[object Promise]",is="[object Proxy]",G="[object RegExp]",Zi="[object Set]",Br="[object String]",so="[object Symbol]",mu="[object Undefined]",Ji="[object WeakMap]",as="[object WeakSet]",Se="[object ArrayBuffer]",Xe="[object DataView]",mt="[object Float32Array]",Gt="[object Float64Array]",Ut="[object Int8Array]",kn="[object Int16Array]",An="[object Int32Array]",Pn="[object Uint8Array]",en="[object Uint8ClampedArray]",Yn="[object Uint16Array]",Kn="[object Uint32Array]",ma=/\b__p \+= '';/g,Os=/\b(__p \+=) '' \+/g,Po=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ua=/&(?:amp|lt|gt|quot|#39);/g,Oo=/[&<>"']/g,tf=RegExp(Ua.source),Ai=RegExp(Oo.source),uo=/<%-([\s\S]+?)%>/g,Lo=/<%([\s\S]+?)%>/g,ga=/<%=([\s\S]+?)%>/g,os=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ls=/^\w*$/,nf=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Gs=/[\\^$.*+?()[\]{}|]/g,ol=RegExp(Gs.source),qi=/^\s+/,ac=/\s/,Xr=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,rf=/\{\n\/\* \[wrapped with (.+)\] \*/,sl=/,? & /,af=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,oc=/[()=,{}\[\]\/\s]/,ul=/\\(\\)?/g,cl=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,sc=/\w*$/,fl=/^[-+]0x[0-9a-f]+$/i,ll=/^0b[01]+$/i,gu=/^\[object .+?Constructor\]$/,dl=/^0o[0-7]+$/i,of=/^(?:0|[1-9]\d*)$/,uc=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ss=/($^)/,us=/['\n\r\u2028\u2029\\]/g,yu="\\ud800-\\udfff",cc="\\u0300-\\u036f",ks="\\ufe20-\\ufe2f",hl="\\u20d0-\\u20ff",sf=cc+ks+hl,fc="\\u2700-\\u27bf",lc="a-z\\xdf-\\xf6\\xf8-\\xff",_u="\\xac\\xb1\\xd7\\xf7",vl="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ye="\\u2000-\\u206f",Ne=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",bt="A-Z\\xc0-\\xd6\\xd8-\\xde",Ue="\\ufe0e\\ufe0f",Tt=_u+vl+Ye+Ne,Lt="['\u2019]",nn="["+yu+"]",jt="["+Tt+"]",xt="["+sf+"]",sn="\\d+",gn="["+fc+"]",Jn="["+lc+"]",Fn="[^"+yu+Tt+sn+fc+lc+bt+"]",zr="\\ud83c[\\udffb-\\udfff]",Pr="(?:"+xt+"|"+zr+")",Ar="[^"+yu+"]",wr="(?:\\ud83c[\\udde6-\\uddff]){2}",Or="[\\ud800-\\udbff][\\udc00-\\udfff]",ti="["+bt+"]",Pi="\\u200d",Ii="(?:"+Jn+"|"+Fn+")",Un="(?:"+ti+"|"+Fn+")",ni="(?:"+Lt+"(?:d|ll|m|re|s|t|ve))?",Ei="(?:"+Lt+"(?:D|LL|M|RE|S|T|VE))?",sa=Pr+"?",ua="["+Ue+"]?",co="(?:"+Pi+"(?:"+[Ar,wr,Or].join("|")+")"+ua+sa+")*",ya="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",cs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ji=ua+sa+co,Lr="(?:"+[gn,wr,Or].join("|")+")"+ji,fo="(?:"+[Ar+xt+"?",xt,wr,Or,nn].join("|")+")",Fs=RegExp(Lt,"g"),Qi=RegExp(xt,"g"),fs=RegExp(zr+"(?="+zr+")|"+fo+ji,"g"),Ba=RegExp([ti+"?"+Jn+"+"+ni+"(?="+[jt,ti,"$"].join("|")+")",Un+"+"+Ei+"(?="+[jt,ti+Ii,"$"].join("|")+")",ti+"?"+Ii+"+"+ni,ti+"+"+Ei,cs,ya,sn,Lr].join("|"),"g"),_a=RegExp("["+Pi+yu+sf+Ue+"]"),ca=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Hi=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],za=-1,gr={};gr[mt]=gr[Gt]=gr[Ut]=gr[kn]=gr[An]=gr[Pn]=gr[en]=gr[Yn]=gr[Kn]=!0,gr[oa]=gr[No]=gr[Se]=gr[ts]=gr[Xe]=gr[oo]=gr[Do]=gr[Fi]=gr[_i]=gr[ci]=gr[Ti]=gr[G]=gr[Zi]=gr[Br]=gr[Ji]=!1;var qn={};qn[oa]=qn[No]=qn[Se]=qn[Xe]=qn[ts]=qn[oo]=qn[mt]=qn[Gt]=qn[Ut]=qn[kn]=qn[An]=qn[_i]=qn[ci]=qn[Ti]=qn[G]=qn[Zi]=qn[Br]=qn[so]=qn[Pn]=qn[en]=qn[Yn]=qn[Kn]=!0,qn[Do]=qn[Fi]=qn[Ji]=!1;var Ea={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Xn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},sr={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},fi={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ui=parseFloat,ea=parseInt,Gr=typeof S.g=="object"&&S.g&&S.g.Object===Object&&S.g,Na=typeof self=="object"&&self&&self.Object===Object&&self,Wr=Gr||Na||Function("return this")(),fa=I&&!I.nodeType&&I,Go=fa&&!0&&Te&&!Te.nodeType&&Te,Eu=Go&&Go.exports===fa,la=Eu&&Gr.process,Ci=function(){try{var me=Go&&Go.require&&Go.require("util").types;return me||la&&la.binding&&la.binding("util")}catch(Ke){}}(),Ri=Ci&&Ci.isArrayBuffer,In=Ci&&Ci.isDate,xr=Ci&&Ci.isMap,vr=Ci&&Ci.isRegExp,On=Ci&&Ci.isSet,rr=Ci&&Ci.isTypedArray;function ur(me,Ke,Pe){switch(Pe.length){case 0:return me.call(Ke);case 1:return me.call(Ke,Pe[0]);case 2:return me.call(Ke,Pe[0],Pe[1]);case 3:return me.call(Ke,Pe[0],Pe[1],Pe[2])}return me.apply(Ke,Pe)}function dr(me,Ke,Pe,Bt){for(var Nn=-1,cr=me==null?0:me.length;++Nn<cr;){var Yr=me[Nn];Ke(Bt,Yr,Pe(Yr),me)}return Bt}function kr(me,Ke){for(var Pe=-1,Bt=me==null?0:me.length;++Pe<Bt&&Ke(me[Pe],Pe,me)!==!1;);return me}function Rr(me,Ke){for(var Pe=me==null?0:me.length;Pe--&&Ke(me[Pe],Pe,me)!==!1;);return me}function dc(me,Ke){for(var Pe=-1,Bt=me==null?0:me.length;++Pe<Bt;)if(!Ke(me[Pe],Pe,me))return!1;return!0}function ls(me,Ke){for(var Pe=-1,Bt=me==null?0:me.length,Nn=0,cr=[];++Pe<Bt;){var Yr=me[Pe];Ke(Yr,Pe,me)&&(cr[Nn++]=Yr)}return cr}function hc(me,Ke){var Pe=me==null?0:me.length;return!!Pe&&Wa(me,Ke,0)>-1}function uf(me,Ke,Pe){for(var Bt=-1,Nn=me==null?0:me.length;++Bt<Nn;)if(Pe(Ke,me[Bt]))return!0;return!1}function $r(me,Ke){for(var Pe=-1,Bt=me==null?0:me.length,Nn=Array(Bt);++Pe<Bt;)Nn[Pe]=Ke(me[Pe],Pe,me);return Nn}function ko(me,Ke){for(var Pe=-1,Bt=Ke.length,Nn=me.length;++Pe<Bt;)me[Nn+Pe]=Ke[Pe];return me}function Mr(me,Ke,Pe,Bt){var Nn=-1,cr=me==null?0:me.length;for(Bt&&cr&&(Pe=me[++Nn]);++Nn<cr;)Pe=Ke(Pe,me[Nn],Nn,me);return Pe}function pl(me,Ke,Pe,Bt){var Nn=me==null?0:me.length;for(Bt&&Nn&&(Pe=me[--Nn]);Nn--;)Pe=Ke(Pe,me[Nn],Nn,me);return Pe}function ml(me,Ke){for(var Pe=-1,Bt=me==null?0:me.length;++Pe<Bt;)if(Ke(me[Pe],Pe,me))return!0;return!1}var lo=Fo("length");function gl(me){return me.split("")}function cf(me){return me.match(af)||[]}function ds(me,Ke,Pe){var Bt;return Pe(me,function(Nn,cr,Yr){if(Ke(Nn,cr,Yr))return Bt=cr,!1}),Bt}function bu(me,Ke,Pe,Bt){for(var Nn=me.length,cr=Pe+(Bt?1:-1);Bt?cr--:++cr<Nn;)if(Ke(me[cr],cr,me))return cr;return-1}function Wa(me,Ke,Pe){return Ke===Ke?vf(me,Ke,Pe):bu(me,wu,Pe)}function hs(me,Ke,Pe,Bt){for(var Nn=Pe-1,cr=me.length;++Nn<cr;)if(Bt(me[Nn],Ke))return Nn;return-1}function wu(me){return me!==me}function yl(me,Ke){var Pe=me==null?0:me.length;return Pe?lf(me,Ke)/Pe:ao}function Fo(me){return function(Ke){return Ke==null?x:Ke[me]}}function vs(me){return function(Ke){return me==null?x:me[Ke]}}function ff(me,Ke,Pe,Bt,Nn){return Nn(me,function(cr,Yr,yr){Pe=Bt?(Bt=!1,cr):Ke(Pe,cr,Yr,yr)}),Pe}function Fh(me,Ke){var Pe=me.length;for(me.sort(Ke);Pe--;)me[Pe]=me[Pe].value;return me}function lf(me,Ke){for(var Pe,Bt=-1,Nn=me.length;++Bt<Nn;){var cr=Ke(me[Bt]);cr!==x&&(Pe=Pe===x?cr:Pe+cr)}return Pe}function _l(me,Ke){for(var Pe=-1,Bt=Array(me);++Pe<me;)Bt[Pe]=Ke(Pe);return Bt}function El(me,Ke){return $r(Ke,function(Pe){return[Pe,me[Pe]]})}function vc(me){return me&&me.slice(0,pf(me)+1).replace(qi,"")}function ta(me){return function(Ke){return me(Ke)}}function pc(me,Ke){return $r(Ke,function(Pe){return me[Pe]})}function ho(me,Ke){return me.has(Ke)}function df(me,Ke){for(var Pe=-1,Bt=me.length;++Pe<Bt&&Wa(Ke,me[Pe],0)>-1;);return Pe}function hf(me,Ke){for(var Pe=me.length;Pe--&&Wa(Ke,me[Pe],0)>-1;);return Pe}function bl(me,Ke){for(var Pe=me.length,Bt=0;Pe--;)me[Pe]===Ke&&++Bt;return Bt}var wl=vs(Ea),sd=vs(Xn);function ud(me){return"\\"+fi[me]}function cd(me,Ke){return me==null?x:me[Ke]}function ps(me){return _a.test(me)}function fd(me){return ca.test(me)}function ld(me){for(var Ke,Pe=[];!(Ke=me.next()).done;)Pe.push(Ke.value);return Pe}function xl(me){var Ke=-1,Pe=Array(me.size);return me.forEach(function(Bt,Nn){Pe[++Ke]=[Nn,Bt]}),Pe}function dd(me,Ke){return function(Pe){return me(Ke(Pe))}}function Da(me,Ke){for(var Pe=-1,Bt=me.length,Nn=0,cr=[];++Pe<Bt;){var Yr=me[Pe];(Yr===Ke||Yr===be)&&(me[Pe]=be,cr[Nn++]=Pe)}return cr}function mc(me){var Ke=-1,Pe=Array(me.size);return me.forEach(function(Bt){Pe[++Ke]=Bt}),Pe}function hd(me){var Ke=-1,Pe=Array(me.size);return me.forEach(function(Bt){Pe[++Ke]=[Bt,Bt]}),Pe}function vf(me,Ke,Pe){for(var Bt=Pe-1,Nn=me.length;++Bt<Nn;)if(me[Bt]===Ke)return Bt;return-1}function Uh(me,Ke,Pe){for(var Bt=Pe+1;Bt--;)if(me[Bt]===Ke)return Bt;return Bt}function xu(me){return ps(me)?Sl(me):lo(me)}function Va(me){return ps(me)?zh(me):gl(me)}function pf(me){for(var Ke=me.length;Ke--&&ac.test(me.charAt(Ke)););return Ke}var Bh=vs(sr);function Sl(me){for(var Ke=fs.lastIndex=0;fs.test(me);)++Ke;return Ke}function zh(me){return me.match(fs)||[]}function gc(me){return me.match(Ba)||[]}var Wh=function me(Ke){Ke=Ke==null?Wr:Su.defaults(Wr.Object(),Ke,Su.pick(Wr,Hi));var Pe=Ke.Array,Bt=Ke.Date,Nn=Ke.Error,cr=Ke.Function,Yr=Ke.Math,yr=Ke.Object,mf=Ke.RegExp,ip=Ke.String,Za=Ke.TypeError,yc=Pe.prototype,Tu=cr.prototype,vo=yr.prototype,gf=Ke["__core-js_shared__"],ms=Tu.toString,Wn=vo.hasOwnProperty,Au=0,yf=function(){var u=/[^.]+$/.exec(gf&&gf.keys&&gf.keys.IE_PROTO||"");return u?"Symbol(src)_1."+u:""}(),Iu=vo.toString,_f=ms.call(yr),vd=Wr._,pd=mf("^"+ms.call(Wn).replace(Gs,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ef=Eu?Ke.Buffer:x,Uo=Ke.Symbol,ja=Ke.Uint8Array,bi=Ef?Ef.allocUnsafe:x,ba=dd(yr.getPrototypeOf,yr),md=yr.create,Bo=vo.propertyIsEnumerable,_c=yc.splice,bf=Uo?Uo.isConcatSpreadable:x,Ec=Uo?Uo.iterator:x,gs=Uo?Uo.toStringTag:x,bc=function(){try{var u=$e(yr,"defineProperty");return u({},"",{}),u}catch(l){}}(),ap=Ke.clearTimeout!==Wr.clearTimeout&&Ke.clearTimeout,Tl=Bt&&Bt.now!==Wr.Date.now&&Bt.now,gd=Ke.setTimeout!==Wr.setTimeout&&Ke.setTimeout,wf=Yr.ceil,Cu=Yr.floor,xf=yr.getOwnPropertySymbols,Vh=Ef?Ef.isBuffer:x,Ru=Ke.isFinite,yd=yc.join,ys=dd(yr.keys,yr),li=Yr.max,Bi=Yr.min,_d=Bt.now,Ed=Ke.parseInt,Sf=Yr.random,bd=yc.reverse,Tf=$e(Ke,"DataView"),Mu=$e(Ke,"Map"),wc=$e(Ke,"Promise"),Us=$e(Ke,"Set"),na=$e(Ke,"WeakMap"),Nu=$e(yr,"create"),Af=na&&new na,wa={},Al=qr(Tf),Bs=qr(Mu),xc=qr(wc),wd=qr(Us),xd=qr(na),If=Uo?Uo.prototype:x,zs=If?If.valueOf:x,Il=If?If.toString:x;function P(u){if(vi(u)&&!Vn(u)&&!(u instanceof ir)){if(u instanceof Pa)return u;if(Wn.call(u,"__wrapped__"))return hn(u)}return new Pa(u)}var Du=function(){function u(){}return function(l){if(!ui(l))return{};if(md)return md(l);u.prototype=l;var p=new u;return u.prototype=x,p}}();function Cf(){}function Pa(u,l){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!l,this.__index__=0,this.__values__=x}P.templateSettings={escape:uo,evaluate:Lo,interpolate:ga,variable:"",imports:{_:P}},P.prototype=Cf.prototype,P.prototype.constructor=P,Pa.prototype=Du(Cf.prototype),Pa.prototype.constructor=Pa;function ir(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ki,this.__views__=[]}function Sd(){var u=new ir(this.__wrapped__);return u.__actions__=ra(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=ra(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=ra(this.__views__),u}function Zh(){if(this.__filtered__){var u=new ir(this);u.__dir__=-1,u.__filtered__=!0}else u=this.clone(),u.__dir__*=-1;return u}function Rf(){var u=this.__wrapped__.value(),l=this.__dir__,p=Vn(u),w=l<0,M=p?u.length:0,k=_t(0,M,this.__views__),q=k.start,ue=k.end,Ee=ue-q,ut=w?ue:q-1,tt=this.__iteratees__,wt=tt.length,Vt=0,rn=Bi(Ee,this.__takeCount__);if(!p||!w&&M==Ee&&rn==Ee)return jo(u,this.__actions__);var Rn=[];e:for(;Ee--&&Vt<rn;){ut+=l;for(var nr=-1,Mn=u[ut];++nr<wt;){var fr=tt[nr],pr=fr.iteratee,to=fr.type,Ca=pr(Mn);if(to==Ki)Mn=Ca;else if(!Ca){if(to==Dr)continue e;break e}}Rn[Vt++]=Mn}return Rn}ir.prototype=Du(Cf.prototype),ir.prototype.constructor=ir;function _s(u){var l=-1,p=u==null?0:u.length;for(this.clear();++l<p;){var w=u[l];this.set(w[0],w[1])}}function Cl(){this.__data__=Nu?Nu(null):{},this.size=0}function Td(u){var l=this.has(u)&&delete this.__data__[u];return this.size-=l?1:0,l}function Ad(u){var l=this.__data__;if(Nu){var p=l[u];return p===De?x:p}return Wn.call(l,u)?l[u]:x}function Sc(u){var l=this.__data__;return Nu?l[u]!==x:Wn.call(l,u)}function jh(u,l){var p=this.__data__;return this.size+=this.has(u)?0:1,p[u]=Nu&&l===x?De:l,this}_s.prototype.clear=Cl,_s.prototype.delete=Td,_s.prototype.get=Ad,_s.prototype.has=Sc,_s.prototype.set=jh;function Es(u){var l=-1,p=u==null?0:u.length;for(this.clear();++l<p;){var w=u[l];this.set(w[0],w[1])}}function Id(){this.__data__=[],this.size=0}function Hh(u){var l=this.__data__,p=mo(l,u);if(p<0)return!1;var w=l.length-1;return p==w?l.pop():_c.call(l,p,1),--this.size,!0}function Xh(u){var l=this.__data__,p=mo(l,u);return p<0?x:l[p][1]}function Cd(u){return mo(this.__data__,u)>-1}function op(u,l){var p=this.__data__,w=mo(p,u);return w<0?(++this.size,p.push([u,l])):p[w][1]=l,this}Es.prototype.clear=Id,Es.prototype.delete=Hh,Es.prototype.get=Xh,Es.prototype.has=Cd,Es.prototype.set=op;function zo(u){var l=-1,p=u==null?0:u.length;for(this.clear();++l<p;){var w=u[l];this.set(w[0],w[1])}}function sp(){this.size=0,this.__data__={hash:new _s,map:new(Mu||Es),string:new _s}}function $h(u){var l=_e(this,u).delete(u);return this.size-=l?1:0,l}function Yh(u){return _e(this,u).get(u)}function Pu(u){return _e(this,u).has(u)}function Kh(u,l){var p=_e(this,u),w=p.size;return p.set(u,l),this.size+=p.size==w?0:1,this}zo.prototype.clear=sp,zo.prototype.delete=$h,zo.prototype.get=Yh,zo.prototype.has=Pu,zo.prototype.set=Kh;function Ws(u){var l=-1,p=u==null?0:u.length;for(this.__data__=new zo;++l<p;)this.add(u[l])}function Rd(u){return this.__data__.set(u,De),this}function Mf(u){return this.__data__.has(u)}Ws.prototype.add=Ws.prototype.push=Rd,Ws.prototype.has=Mf;function Ha(u){var l=this.__data__=new Es(u);this.size=l.size}function Md(){this.__data__=new Es,this.size=0}function Nd(u){var l=this.__data__,p=l.delete(u);return this.size=l.size,p}function Jh(u){return this.__data__.get(u)}function qh(u){return this.__data__.has(u)}function Qh(u,l){var p=this.__data__;if(p instanceof Es){var w=p.__data__;if(!Mu||w.length<W-1)return w.push([u,l]),this.size=++p.size,this;p=this.__data__=new zo(w)}return p.set(u,l),this.size=p.size,this}Ha.prototype.clear=Md,Ha.prototype.delete=Nd,Ha.prototype.get=Jh,Ha.prototype.has=qh,Ha.prototype.set=Qh;function Dd(u,l){var p=Vn(u),w=!p&&Zc(u),M=!p&&!w&&qu(u),k=!p&&!w&&!M&&jc(u),q=p||w||M||k,ue=q?_l(u.length,ip):[],Ee=ue.length;for(var ut in u)(l||Wn.call(u,ut))&&!(q&&(ut=="length"||M&&(ut=="offset"||ut=="parent")||k&&(ut=="buffer"||ut=="byteLength"||ut=="byteOffset")||At(ut,Ee)))&&ue.push(ut);return ue}function Vs(u){var l=u.length;return l?u[Ll(0,l-1)]:x}function Pd(u,l){return Jr(ra(u),go(l,0,u.length))}function Ou(u){return Jr(ra(u))}function Rl(u,l,p){(p!==x&&!Ko(u[l],p)||p===x&&!(l in u))&&da(u,l,p)}function po(u,l,p){var w=u[l];(!(Wn.call(u,l)&&Ko(w,p))||p===x&&!(l in u))&&da(u,l,p)}function mo(u,l){for(var p=u.length;p--;)if(Ko(u[p][0],l))return p;return-1}function Od(u,l,p,w){return Wo(u,function(M,k,q){l(w,M,p(M),q)}),w}function Zs(u,l){return u&&Ka(l,$i(l),u)}function Ml(u,l){return u&&Ka(l,va(l),u)}function da(u,l,p){l=="__proto__"&&bc?bc(u,l,{configurable:!0,enumerable:!0,value:p,writable:!0}):u[l]=p}function Lu(u,l){for(var p=-1,w=l.length,M=Pe(w),k=u==null;++p<w;)M[p]=k?x:Vl(u,l[p]);return M}function go(u,l,p){return u===u&&(p!==x&&(u=u<=p?u:p),l!==x&&(u=u>=l?u:l)),u}function ha(u,l,p,w,M,k){var q,ue=l&at,Ee=l&We,ut=l&Ht;if(p&&(q=M?p(u,w,M,k):p(u)),q!==x)return q;if(!ui(u))return u;var tt=Vn(u);if(tt){if(q=fe(u),!ue)return ra(u,q)}else{var wt=qe(u),Vt=wt==Fi||wt==rs;if(qu(u))return Ss(u,ue);if(wt==Ti||wt==oa||Vt&&!M){if(q=Ee||Vt?{}:Ae(u),!ue)return Ee?tu(u,Ml(q,u)):Zd(u,Zs(q,u))}else{if(!qn[wt])return M?u:{};q=rt(u,wt,ue)}}k||(k=new Ha);var rn=k.get(u);if(rn)return rn;k.set(u,q),Hp(u)?u.forEach(function(Mn){q.add(ha(Mn,l,p,Mn,u,k))}):Wp(u)&&u.forEach(function(Mn,fr){q.set(fr,ha(Mn,l,p,fr,u,k))});var Rn=ut?Ee?T:jf:Ee?va:$i,nr=tt?x:Rn(u);return kr(nr||u,function(Mn,fr){nr&&(fr=Mn,Mn=u[fr]),po(q,fr,ha(Mn,l,p,fr,u,k))}),q}function Nf(u){var l=$i(u);return function(p){return Tc(p,u,l)}}function Tc(u,l,p){var w=p.length;if(u==null)return!w;for(u=yr(u);w--;){var M=p[w],k=l[M],q=u[M];if(q===x&&!(M in u)||!k(q))return!1}return!0}function Gu(u,l,p){if(typeof u!="function")throw new Za(V);return Cn(function(){u.apply(x,p)},l)}function Ac(u,l,p,w){var M=-1,k=hc,q=!0,ue=u.length,Ee=[],ut=l.length;if(!ue)return Ee;p&&(l=$r(l,ta(p))),w?(k=uf,q=!1):l.length>=W&&(k=ho,q=!1,l=new Ws(l));e:for(;++M<ue;){var tt=u[M],wt=p==null?tt:p(tt);if(tt=w||tt!==0?tt:0,q&&wt===wt){for(var Vt=ut;Vt--;)if(l[Vt]===wt)continue e;Ee.push(tt)}else k(l,wt,w)||Ee.push(tt)}return Ee}var Wo=Ja(Xa),Nl=Ja(Cc,!0);function Ld(u,l){var p=!0;return Wo(u,function(w,M,k){return p=!!l(w,M,k),p}),p}function Ic(u,l,p){for(var w=-1,M=u.length;++w<M;){var k=u[w],q=l(k);if(q!=null&&(ue===x?q===q&&!Aa(q):p(q,ue)))var ue=q,Ee=k}return Ee}function Gd(u,l,p,w){var M=u.length;for(p=Bn(p),p<0&&(p=-p>M?0:M+p),w=w===x||w>M?M:Bn(w),w<0&&(w+=M),w=p>w?0:yv(w);p<w;)u[p++]=l;return u}function Df(u,l){var p=[];return Wo(u,function(w,M,k){l(w,M,k)&&p.push(w)}),p}function zi(u,l,p,w,M){var k=-1,q=u.length;for(p||(p=Ze),M||(M=[]);++k<q;){var ue=u[k];l>0&&p(ue)?l>1?zi(ue,l-1,p,w,M):ko(M,ue):w||(M[M.length]=ue)}return M}var Pf=kl(),Dl=kl(!0);function Xa(u,l){return u&&Pf(u,l,$i)}function Cc(u,l){return u&&Dl(u,l,$i)}function Rc(u,l){return ls(l,function(p){return Is(u[p])})}function bs(u,l){l=Ni(l,u);for(var p=0,w=l.length;u!=null&&p<w;)u=u[Sr(l[p++])];return p&&p==w?u:x}function Of(u,l,p){var w=l(u);return Vn(u)?w:ko(w,p(u))}function Mi(u){return u==null?u===x?mu:pu:gs&&gs in yr(u)?et(u):Dn(u)}function Lf(u,l){return u>l}function Pl(u,l){return u!=null&&Wn.call(u,l)}function kd(u,l){return u!=null&&l in yr(u)}function Fd(u,l,p){return u>=Bi(l,p)&&u<li(l,p)}function js(u,l,p){for(var w=p?uf:hc,M=u[0].length,k=u.length,q=k,ue=Pe(k),Ee=Infinity,ut=[];q--;){var tt=u[q];q&&l&&(tt=$r(tt,ta(l))),Ee=Bi(tt.length,Ee),ue[q]=!p&&(l||M>=120&&tt.length>=120)?new Ws(q&&tt):x}tt=u[0];var wt=-1,Vt=ue[0];e:for(;++wt<M&&ut.length<Ee;){var rn=tt[wt],Rn=l?l(rn):rn;if(rn=p||rn!==0?rn:0,!(Vt?ho(Vt,Rn):w(ut,Rn,p))){for(q=k;--q;){var nr=ue[q];if(!(nr?ho(nr,Rn):w(u[q],Rn,p)))continue e}Vt&&Vt.push(Rn),ut.push(rn)}}return ut}function Ud(u,l,p,w){return Xa(u,function(M,k,q){l(w,p(M),k,q)}),w}function ku(u,l,p){l=Ni(l,u),u=bn(u,l);var w=u==null?u:u[Sr(ae(l))];return w==null?x:ur(w,u,p)}function Gf(u){return vi(u)&&Mi(u)==oa}function Ol(u){return vi(u)&&Mi(u)==Se}function Mc(u){return vi(u)&&Mi(u)==oo}function Fu(u,l,p,w,M){return u===l?!0:u==null||l==null||!vi(u)&&!vi(l)?u!==u&&l!==l:kf(u,l,p,w,Fu,M)}function kf(u,l,p,w,M,k){var q=Vn(u),ue=Vn(l),Ee=q?No:qe(u),ut=ue?No:qe(l);Ee=Ee==oa?Ti:Ee,ut=ut==oa?Ti:ut;var tt=Ee==Ti,wt=ut==Ti,Vt=Ee==ut;if(Vt&&qu(u)){if(!qu(l))return!1;q=!0,tt=!1}if(Vt&&!tt)return k||(k=new Ha),q||jc(u)?Ku(u,l,p,w,M,k):Vc(u,l,Ee,p,w,M,k);if(!(p&Yt)){var rn=tt&&Wn.call(u,"__wrapped__"),Rn=wt&&Wn.call(l,"__wrapped__");if(rn||Rn){var nr=rn?u.value():u,Mn=Rn?l.value():l;return k||(k=new Ha),M(nr,Mn,p,w,k)}}return Vt?(k||(k=new Ha),av(u,l,p,w,M,k)):!1}function Vo(u){return vi(u)&&qe(u)==_i}function Hs(u,l,p,w){var M=p.length,k=M,q=!w;if(u==null)return!k;for(u=yr(u);M--;){var ue=p[M];if(q&&ue[2]?ue[1]!==u[ue[0]]:!(ue[0]in u))return!1}for(;++M<k;){ue=p[M];var Ee=ue[0],ut=u[Ee],tt=ue[1];if(q&&ue[2]){if(ut===x&&!(Ee in u))return!1}else{var wt=new Ha;if(w)var Vt=w(ut,tt,Ee,u,l,wt);if(!(Vt===x?Fu(tt,ut,Yt|dt,w,wt):Vt))return!1}}return!0}function ws(u){if(!ui(u)||Wt(u))return!1;var l=Is(u)?pd:gu;return l.test(qr(u))}function Nc(u){return vi(u)&&Mi(u)==G}function Dc(u){return vi(u)&&qe(u)==Zi}function Xs(u){return vi(u)&&ih(u.length)&&!!gr[Mi(u)]}function yo(u){return typeof u=="function"?u:u==null?Ia:typeof u=="object"?Vn(u)?Ys(u[0],u[1]):$s(u):Iv(u)}function $a(u){if(!gt(u))return ys(u);var l=[];for(var p in yr(u))Wn.call(u,p)&&p!="constructor"&&l.push(p);return l}function Ff(u){if(!ui(u))return kt(u);var l=gt(u),p=[];for(var w in u)w=="constructor"&&(l||!Wn.call(u,w))||p.push(w);return p}function Uu(u,l){return u<l}function xs(u,l){var p=-1,w=La(u)?Pe(u.length):[];return Wo(u,function(M,k,q){w[++p]=l(M,k,q)}),w}function $s(u){var l=xe(u);return l.length==1&&l[0][2]?je(l[0][0],l[0][1]):function(p){return p===u||Hs(p,u,l)}}function Ys(u,l){return pt(u)&&ct(l)?je(Sr(u),l):function(p){var w=Vl(p,u);return w===x&&w===l?Ev(p,u):Fu(l,w,Yt|dt)}}function _o(u,l,p,w,M){u!==l&&Pf(l,function(k,q){if(M||(M=new Ha),ui(k))Ya(u,l,q,p,_o,w,M);else{var ue=w?w(Vr(u,q),k,q+"",u,l,M):x;ue===x&&(ue=k),Rl(u,q,ue)}},va)}function Ya(u,l,p,w,M,k,q){var ue=Vr(u,p),Ee=Vr(l,p),ut=q.get(Ee);if(ut){Rl(u,p,ut);return}var tt=k?k(ue,Ee,p+"",u,l,q):x,wt=tt===x;if(wt){var Vt=Vn(Ee),rn=!Vt&&qu(Ee),Rn=!Vt&&!rn&&jc(Ee);tt=Ee,Vt||rn||Rn?Vn(ue)?tt=ue:Di(ue)?tt=ra(ue):rn?(wt=!1,tt=Ss(Ee,!0)):Rn?(wt=!1,tt=zf(Ee,!0)):tt=[]:Wl(Ee)||Zc(Ee)?(tt=ue,Zc(ue)?tt=Yp(ue):(!ui(ue)||Is(ue))&&(tt=Ae(Ee))):wt=!1}wt&&(q.set(Ee,tt),M(tt,Ee,w,k,q),q.delete(Ee)),Rl(u,p,tt)}function Bd(u,l){var p=u.length;if(!!p)return l+=l<0?p:0,At(l,p)?u[l]:x}function Xi(u,l,p){l.length?l=$r(l,function(k){return Vn(k)?function(q){return bs(q,k.length===1?k[0]:k)}:k}):l=[Ia];var w=-1;l=$r(l,ta(se()));var M=xs(u,function(k,q,ue){var Ee=$r(l,function(ut){return ut(k)});return{criteria:Ee,index:++w,value:k}});return Fh(M,function(k,q){return rv(k,q,p)})}function Ks(u,l){return Js(u,l,function(p,w){return Ev(u,w)})}function Js(u,l,p){for(var w=-1,M=l.length,k={};++w<M;){var q=l[w],ue=bs(u,q);p(ue,q)&&Oc(k,Ni(q,u),ue)}return k}function Pc(u){return function(l){return bs(l,u)}}function Bu(u,l,p,w){var M=w?hs:Wa,k=-1,q=l.length,ue=u;for(u===l&&(l=ra(l)),p&&(ue=$r(u,ta(p)));++k<q;)for(var Ee=0,ut=l[k],tt=p?p(ut):ut;(Ee=M(ue,tt,Ee,w))>-1;)ue!==u&&_c.call(ue,Ee,1),_c.call(u,Ee,1);return u}function Zo(u,l){for(var p=u?l.length:0,w=p-1;p--;){var M=l[p];if(p==w||M!==k){var k=M;At(M)?_c.call(u,M,1):Zu(u,M)}}return u}function Ll(u,l){return u+Cu(Sf()*(l-u+1))}function zu(u,l,p,w){for(var M=-1,k=li(wf((l-u)/(p||1)),0),q=Pe(k);k--;)q[w?k:++M]=u,u+=p;return q}function Wu(u,l){var p="";if(!u||l<1||l>Gi)return p;do l%2&&(p+=u),l=Cu(l/2),l&&(u+=u);while(l);return p}function Zn(u,l){return Zr(un(u,l,Ia),u+"")}function ev(u){return Vs(Yf(u))}function tv(u,l){var p=Yf(u);return Jr(p,go(l,0,p.length))}function Oc(u,l,p,w){if(!ui(u))return u;l=Ni(l,u);for(var M=-1,k=l.length,q=k-1,ue=u;ue!=null&&++M<k;){var Ee=Sr(l[M]),ut=p;if(Ee==="__proto__"||Ee==="constructor"||Ee==="prototype")return u;if(M!=q){var tt=ue[Ee];ut=w?w(tt,Ee,ue):x,ut===x&&(ut=ui(tt)?tt:At(l[M+1])?[]:{})}po(ue,Ee,ut),ue=ue[Ee]}return u}var zd=Af?function(u,l){return Af.set(u,l),u}:Ia,Vu=bc?function(u,l){return bc(u,"toString",{configurable:!0,enumerable:!1,value:ou(l),writable:!0})}:Ia;function Uf(u){return Jr(Yf(u))}function Oa(u,l,p){var w=-1,M=u.length;l<0&&(l=-l>M?0:M+l),p=p>M?M:p,p<0&&(p+=M),M=l>p?0:p-l>>>0,l>>>=0;for(var k=Pe(M);++w<M;)k[w]=u[w+l];return k}function nv(u,l){var p;return Wo(u,function(w,M,k){return p=l(w,M,k),!p}),!!p}function Bf(u,l,p){var w=0,M=u==null?w:u.length;if(typeof l=="number"&&l===l&&M<=vu){for(;w<M;){var k=w+M>>>1,q=u[k];q!==null&&!Aa(q)&&(p?q<=l:q<l)?w=k+1:M=k}return M}return Gl(u,l,Ia,p)}function Gl(u,l,p,w){var M=0,k=u==null?0:u.length;if(k===0)return 0;l=p(l);for(var q=l!==l,ue=l===null,Ee=Aa(l),ut=l===x;M<k;){var tt=Cu((M+k)/2),wt=p(u[tt]),Vt=wt!==x,rn=wt===null,Rn=wt===wt,nr=Aa(wt);if(q)var Mn=w||Rn;else ut?Mn=Rn&&(w||Vt):ue?Mn=Rn&&Vt&&(w||!rn):Ee?Mn=Rn&&Vt&&!rn&&(w||!nr):rn||nr?Mn=!1:Mn=w?wt<=l:wt<l;Mn?M=tt+1:k=tt}return Bi(k,Mo)}function Lc(u,l){for(var p=-1,w=u.length,M=0,k=[];++p<w;){var q=u[p],ue=l?l(q):q;if(!p||!Ko(ue,Ee)){var Ee=ue;k[M++]=q===0?0:q}}return k}function Gc(u){return typeof u=="number"?u:Aa(u)?ao:+u}function Fr(u){if(typeof u=="string")return u;if(Vn(u))return $r(u,Fr)+"";if(Aa(u))return Il?Il.call(u):"";var l=u+"";return l=="0"&&1/u==-ar?"-0":l}function di(u,l,p){var w=-1,M=hc,k=u.length,q=!0,ue=[],Ee=ue;if(p)q=!1,M=uf;else if(k>=W){var ut=l?null:$u(u);if(ut)return mc(ut);q=!1,M=ho,Ee=new Ws}else Ee=l?[]:ue;e:for(;++w<k;){var tt=u[w],wt=l?l(tt):tt;if(tt=p||tt!==0?tt:0,q&&wt===wt){for(var Vt=Ee.length;Vt--;)if(Ee[Vt]===wt)continue e;l&&Ee.push(wt),ue.push(tt)}else M(Ee,wt,p)||(Ee!==ue&&Ee.push(wt),ue.push(tt))}return ue}function Zu(u,l){return l=Ni(l,u),u=bn(u,l),u==null||delete u[Sr(ae(l))]}function kc(u,l,p,w){return Oc(u,l,p(bs(u,l)),w)}function qs(u,l,p,w){for(var M=u.length,k=w?M:-1;(w?k--:++k<M)&&l(u[k],k,u););return p?Oa(u,w?0:k,w?k+1:M):Oa(u,w?k+1:0,w?M:k)}function jo(u,l){var p=u;return p instanceof ir&&(p=p.value()),Mr(l,function(w,M){return M.func.apply(M.thisArg,ko([w],M.args))},p)}function Fc(u,l,p){var w=u.length;if(w<2)return w?di(u[0]):[];for(var M=-1,k=Pe(w);++M<w;)for(var q=u[M],ue=-1;++ue<w;)ue!=M&&(k[M]=Ac(k[M]||q,u[ue],l,p));return di(zi(k,1),l,p)}function Uc(u,l,p){for(var w=-1,M=u.length,k=l.length,q={};++w<M;){var ue=w<k?l[w]:x;p(q,u[w],ue)}return q}function ju(u){return Di(u)?u:[]}function Qs(u){return typeof u=="function"?u:Ia}function Ni(u,l){return Vn(u)?u:pt(u,l)?[u]:ai(Ir(u))}var Oi=Zn;function xa(u,l,p){var w=u.length;return p=p===x?w:p,!l&&p>=w?u:Oa(u,l,p)}var Eo=ap||function(u){return Wr.clearTimeout(u)};function Ss(u,l){if(l)return u.slice();var p=u.length,w=bi?bi(p):new u.constructor(p);return u.copy(w),w}function Bc(u){var l=new u.constructor(u.byteLength);return new ja(l).set(new ja(u)),l}function zc(u,l){var p=l?Bc(u.buffer):u.buffer;return new u.constructor(p,u.byteOffset,u.byteLength)}function eu(u){var l=new u.constructor(u.source,sc.exec(u));return l.lastIndex=u.lastIndex,l}function Ts(u){return zs?yr(zs.call(u)):{}}function zf(u,l){var p=l?Bc(u.buffer):u.buffer;return new u.constructor(p,u.byteOffset,u.length)}function Wd(u,l){if(u!==l){var p=u!==x,w=u===null,M=u===u,k=Aa(u),q=l!==x,ue=l===null,Ee=l===l,ut=Aa(l);if(!ue&&!ut&&!k&&u>l||k&&q&&Ee&&!ue&&!ut||w&&q&&Ee||!p&&Ee||!M)return 1;if(!w&&!k&&!ut&&u<l||ut&&p&&M&&!w&&!k||ue&&p&&M||!q&&M||!Ee)return-1}return 0}function rv(u,l,p){for(var w=-1,M=u.criteria,k=l.criteria,q=M.length,ue=p.length;++w<q;){var Ee=Wd(M[w],k[w]);if(Ee){if(w>=ue)return Ee;var ut=p[w];return Ee*(ut=="desc"?-1:1)}}return u.index-l.index}function Vd(u,l,p,w){for(var M=-1,k=u.length,q=p.length,ue=-1,Ee=l.length,ut=li(k-q,0),tt=Pe(Ee+ut),wt=!w;++ue<Ee;)tt[ue]=l[ue];for(;++M<q;)(wt||M<k)&&(tt[p[M]]=u[M]);for(;ut--;)tt[ue++]=u[M++];return tt}function Ho(u,l,p,w){for(var M=-1,k=u.length,q=-1,ue=p.length,Ee=-1,ut=l.length,tt=li(k-ue,0),wt=Pe(tt+ut),Vt=!w;++M<tt;)wt[M]=u[M];for(var rn=M;++Ee<ut;)wt[rn+Ee]=l[Ee];for(;++q<ue;)(Vt||M<k)&&(wt[rn+p[q]]=u[M++]);return wt}function ra(u,l){var p=-1,w=u.length;for(l||(l=Pe(w));++p<w;)l[p]=u[p];return l}function Ka(u,l,p,w){var M=!p;p||(p={});for(var k=-1,q=l.length;++k<q;){var ue=l[k],Ee=w?w(p[ue],u[ue],ue,p,u):x;Ee===x&&(Ee=u[ue]),M?da(p,ue,Ee):po(p,ue,Ee)}return p}function Zd(u,l){return Ka(u,nt(u),l)}function tu(u,l){return Ka(u,Ge(u),l)}function Xo(u,l){return function(p,w){var M=Vn(p)?dr:Od,k=l?l():{};return M(p,u,se(w,2),k)}}function bo(u){return Zn(function(l,p){var w=-1,M=p.length,k=M>1?p[M-1]:x,q=M>2?p[2]:x;for(k=u.length>3&&typeof k=="function"?(M--,k):x,q&&Fe(p[0],p[1],q)&&(k=M<3?x:k,M=1),l=yr(l);++w<M;){var ue=p[w];ue&&u(l,ue,w,k)}return l})}function Ja(u,l){return function(p,w){if(p==null)return p;if(!La(p))return u(p,w);for(var M=p.length,k=l?M:-1,q=yr(p);(l?k--:++k<M)&&w(q[k],k,q)!==!1;);return p}}function kl(u){return function(l,p,w){for(var M=-1,k=yr(l),q=w(l),ue=q.length;ue--;){var Ee=q[u?ue:++M];if(p(k[Ee],Ee,k)===!1)break}return l}}function Hu(u,l,p){var w=l&Et,M=ru(u);function k(){var q=this&&this!==Wr&&this instanceof k?M:u;return q.apply(w?p:this,arguments)}return k}function $o(u){return function(l){l=Ir(l);var p=ps(l)?Va(l):x,w=p?p[0]:l.charAt(0),M=p?xa(p,1).join(""):l.slice(1);return w[u]()+M}}function nu(u){return function(l){return Mr(v0(Zl(l).replace(Fs,"")),u,"")}}function ru(u){return function(){var l=arguments;switch(l.length){case 0:return new u;case 1:return new u(l[0]);case 2:return new u(l[0],l[1]);case 3:return new u(l[0],l[1],l[2]);case 4:return new u(l[0],l[1],l[2],l[3]);case 5:return new u(l[0],l[1],l[2],l[3],l[4]);case 6:return new u(l[0],l[1],l[2],l[3],l[4],l[5]);case 7:return new u(l[0],l[1],l[2],l[3],l[4],l[5],l[6])}var p=Du(u.prototype),w=u.apply(p,l);return ui(w)?w:p}}function Wf(u,l,p){var w=ru(u);function M(){for(var k=arguments.length,q=Pe(k),ue=k,Ee=ge(M);ue--;)q[ue]=arguments[ue];var ut=k<3&&q[0]!==Ee&&q[k-1]!==Ee?[]:Da(q,Ee);if(k-=ut.length,k<p)return Xu(u,l,qa,M.placeholder,x,q,ut,x,x,p-k);var tt=this&&this!==Wr&&this instanceof M?w:u;return ur(tt,this,q)}return M}function As(u){return function(l,p,w){var M=yr(l);if(!La(l)){var k=se(p,3);l=$i(l),p=function(ue){return k(M[ue],ue,M)}}var q=u(l,p,w);return q>-1?M[k?l[q]:q]:x}}function Wi(u){return xi(function(l){var p=l.length,w=p,M=Pa.prototype.thru;for(u&&l.reverse();w--;){var k=l[w];if(typeof k!="function")throw new Za(V);if(M&&!q&&H(k)=="wrapper")var q=new Pa([],!0)}for(w=q?w:p;++w<p;){k=l[w];var ue=H(k),Ee=ue=="wrapper"?O(k):x;Ee&&st(Ee[0])&&Ee[1]==(Ct|Re|ot|St)&&!Ee[4].length&&Ee[9]==1?q=q[H(Ee[0])].apply(q,Ee[3]):q=k.length==1&&st(k)?q[ue]():q.thru(k)}return function(){var ut=arguments,tt=ut[0];if(q&&ut.length==1&&Vn(tt))return q.plant(tt).value();for(var wt=0,Vt=p?l[wt].apply(this,ut):tt;++wt<p;)Vt=l[wt].call(this,Vt);return Vt}})}function qa(u,l,p,w,M,k,q,ue,Ee,ut){var tt=l&Ct,wt=l&Et,Vt=l&ht,rn=l&(Re|Dt),Rn=l&Zt,nr=Vt?x:ru(u);function Mn(){for(var fr=arguments.length,pr=Pe(fr),to=fr;to--;)pr[to]=arguments[to];if(rn)var Ca=ge(Mn),Ra=bl(pr,Ca);if(w&&(pr=Vd(pr,w,M,rn)),k&&(pr=Ho(pr,k,q,rn)),fr-=Ra,rn&&fr<ut){var pi=Da(pr,Ca);return Xu(u,l,qa,Mn.placeholder,p,pr,pi,ue,Ee,ut-fr)}var Jo=wt?p:this,Cs=Vt?Jo[u]:u;return fr=pr.length,ue?pr=Qn(pr,ue):Rn&&fr>1&&pr.reverse(),tt&&Ee<fr&&(pr.length=Ee),this&&this!==Wr&&this instanceof Mn&&(Cs=nr||ru(Cs)),Cs.apply(Jo,pr)}return Mn}function ri(u,l){return function(p,w){return Ud(p,u,l(w),{})}}function wi(u,l){return function(p,w){var M;if(p===x&&w===x)return l;if(p!==x&&(M=p),w!==x){if(M===x)return w;typeof p=="string"||typeof w=="string"?(p=Fr(p),w=Fr(w)):(p=Gc(p),w=Gc(w)),M=u(p,w)}return M}}function Vf(u){return xi(function(l){return l=$r(l,ta(se())),Zn(function(p){var w=this;return u(l,function(M){return ur(M,w,p)})})})}function Zf(u,l){l=l===x?" ":Fr(l);var p=l.length;if(p<2)return p?Wu(l,u):l;var w=Wu(l,wf(u/xu(l)));return ps(l)?xa(Va(w),0,u).join(""):w.slice(0,u)}function iv(u,l,p,w){var M=l&Et,k=ru(u);function q(){for(var ue=-1,Ee=arguments.length,ut=-1,tt=w.length,wt=Pe(tt+Ee),Vt=this&&this!==Wr&&this instanceof q?k:u;++ut<tt;)wt[ut]=w[ut];for(;Ee--;)wt[ut++]=arguments[++ue];return ur(Vt,M?p:this,wt)}return q}function jd(u){return function(l,p,w){return w&&typeof w!="number"&&Fe(l,p,w)&&(p=w=x),l=au(l),p===x?(p=l,l=0):p=au(p),w=w===x?l<p?1:-1:au(w),zu(l,p,w,u)}}function Yo(u){return function(l,p){return typeof l=="string"&&typeof p=="string"||(l=Ao(l),p=Ao(p)),u(l,p)}}function Xu(u,l,p,w,M,k,q,ue,Ee,ut){var tt=l&Re,wt=tt?q:x,Vt=tt?x:q,rn=tt?k:x,Rn=tt?x:k;l|=tt?ot:ft,l&=~(tt?ft:ot),l&Oe||(l&=~(Et|ht));var nr=[u,l,M,rn,wt,Rn,Vt,ue,Ee,ut],Mn=p.apply(x,nr);return st(u)&&ii(Mn,nr),Mn.placeholder=w,_r(Mn,u,l)}function Fl(u){var l=Yr[u];return function(p,w){if(p=Ao(p),w=w==null?0:Bi(Bn(w),292),w&&Ru(p)){var M=(Ir(p)+"e").split("e"),k=l(M[0]+"e"+(+M[1]+w));return M=(Ir(k)+"e").split("e"),+(M[0]+"e"+(+M[1]-w))}return l(p)}}var $u=Us&&1/mc(new Us([,-0]))[1]==ar?function(u){return new Us(u)}:vh;function iu(u){return function(l){var p=qe(l);return p==_i?xl(l):p==Zi?hd(l):El(l,u(l))}}function Qa(u,l,p,w,M,k,q,ue){var Ee=l&ht;if(!Ee&&typeof u!="function")throw new Za(V);var ut=w?w.length:0;if(ut||(l&=~(ot|ft),w=M=x),q=q===x?q:li(Bn(q),0),ue=ue===x?ue:Bn(ue),ut-=M?M.length:0,l&ft){var tt=w,wt=M;w=M=x}var Vt=Ee?x:O(u),rn=[u,l,p,w,M,tt,wt,k,q,ue];if(Vt&&En(rn,Vt),u=rn[0],l=rn[1],p=rn[2],w=rn[3],M=rn[4],ue=rn[9]=rn[9]===x?Ee?0:u.length:li(rn[9]-ut,0),!ue&&l&(Re|Dt)&&(l&=~(Re|Dt)),!l||l==Et)var Rn=Hu(u,l,p);else l==Re||l==Dt?Rn=Wf(u,l,ue):(l==ot||l==(Et|ot))&&!M.length?Rn=iv(u,l,p,w):Rn=qa.apply(x,rn);var nr=Vt?zd:ii;return _r(nr(Rn,rn),u,l)}function Wc(u,l,p,w){return u===x||Ko(u,vo[p])&&!Wn.call(w,p)?l:u}function Yu(u,l,p,w,M,k){return ui(u)&&ui(l)&&(k.set(l,u),_o(u,l,x,Yu,k),k.delete(l)),u}function Hd(u){return Wl(u)?x:u}function Ku(u,l,p,w,M,k){var q=p&Yt,ue=u.length,Ee=l.length;if(ue!=Ee&&!(q&&Ee>ue))return!1;var ut=k.get(u),tt=k.get(l);if(ut&&tt)return ut==l&&tt==u;var wt=-1,Vt=!0,rn=p&dt?new Ws:x;for(k.set(u,l),k.set(l,u);++wt<ue;){var Rn=u[wt],nr=l[wt];if(w)var Mn=q?w(nr,Rn,wt,l,u,k):w(Rn,nr,wt,u,l,k);if(Mn!==x){if(Mn)continue;Vt=!1;break}if(rn){if(!ml(l,function(fr,pr){if(!ho(rn,pr)&&(Rn===fr||M(Rn,fr,p,w,k)))return rn.push(pr)})){Vt=!1;break}}else if(!(Rn===nr||M(Rn,nr,p,w,k))){Vt=!1;break}}return k.delete(u),k.delete(l),Vt}function Vc(u,l,p,w,M,k,q){switch(p){case Xe:if(u.byteLength!=l.byteLength||u.byteOffset!=l.byteOffset)return!1;u=u.buffer,l=l.buffer;case Se:return!(u.byteLength!=l.byteLength||!k(new ja(u),new ja(l)));case ts:case oo:case ci:return Ko(+u,+l);case Do:return u.name==l.name&&u.message==l.message;case G:case Br:return u==l+"";case _i:var ue=xl;case Zi:var Ee=w&Yt;if(ue||(ue=mc),u.size!=l.size&&!Ee)return!1;var ut=q.get(u);if(ut)return ut==l;w|=dt,q.set(u,l);var tt=Ku(ue(u),ue(l),w,M,k,q);return q.delete(u),tt;case so:if(zs)return zs.call(u)==zs.call(l)}return!1}function av(u,l,p,w,M,k){var q=p&Yt,ue=jf(u),Ee=ue.length,ut=jf(l),tt=ut.length;if(Ee!=tt&&!q)return!1;for(var wt=Ee;wt--;){var Vt=ue[wt];if(!(q?Vt in l:Wn.call(l,Vt)))return!1}var rn=k.get(u),Rn=k.get(l);if(rn&&Rn)return rn==l&&Rn==u;var nr=!0;k.set(u,l),k.set(l,u);for(var Mn=q;++wt<Ee;){Vt=ue[wt];var fr=u[Vt],pr=l[Vt];if(w)var to=q?w(pr,fr,Vt,l,u,k):w(fr,pr,Vt,u,l,k);if(!(to===x?fr===pr||M(fr,pr,p,w,k):to)){nr=!1;break}Mn||(Mn=Vt=="constructor")}if(nr&&!Mn){var Ca=u.constructor,Ra=l.constructor;Ca!=Ra&&"constructor"in u&&"constructor"in l&&!(typeof Ca=="function"&&Ca instanceof Ca&&typeof Ra=="function"&&Ra instanceof Ra)&&(nr=!1)}return k.delete(u),k.delete(l),nr}function xi(u){return Zr(un(u,x,F),u+"")}function jf(u){return Of(u,$i,nt)}function T(u){return Of(u,va,Ge)}var O=Af?function(u){return Af.get(u)}:vh;function H(u){for(var l=u.name+"",p=wa[l],w=Wn.call(wa,l)?p.length:0;w--;){var M=p[w],k=M.func;if(k==null||k==u)return M.name}return l}function ge(u){var l=Wn.call(P,"placeholder")?P:u;return l.placeholder}function se(){var u=P.iteratee||hh;return u=u===hh?yo:u,arguments.length?u(arguments[0],arguments[1]):u}function _e(u,l){var p=u.__data__;return He(l)?p[typeof l=="string"?"string":"hash"]:p.map}function xe(u){for(var l=$i(u),p=l.length;p--;){var w=l[p],M=u[w];l[p]=[w,M,ct(M)]}return l}function $e(u,l){var p=cd(u,l);return ws(p)?p:x}function et(u){var l=Wn.call(u,gs),p=u[gs];try{u[gs]=x;var w=!0}catch(k){}var M=Iu.call(u);return w&&(l?u[gs]=p:delete u[gs]),M}var nt=xf?function(u){return u==null?[]:(u=yr(u),ls(xf(u),function(l){return Bo.call(u,l)}))}:jl,Ge=xf?function(u){for(var l=[];u;)ko(l,nt(u)),u=ba(u);return l}:jl,qe=Mi;(Tf&&qe(new Tf(new ArrayBuffer(1)))!=Xe||Mu&&qe(new Mu)!=_i||wc&&qe(wc.resolve())!=Ps||Us&&qe(new Us)!=Zi||na&&qe(new na)!=Ji)&&(qe=function(u){var l=Mi(u),p=l==Ti?u.constructor:x,w=p?qr(p):"";if(w)switch(w){case Al:return Xe;case Bs:return _i;case xc:return Ps;case wd:return Zi;case xd:return Ji}return l});function _t(u,l,p){for(var w=-1,M=p.length;++w<M;){var k=p[w],q=k.size;switch(k.type){case"drop":u+=q;break;case"dropRight":l-=q;break;case"take":l=Bi(l,u+q);break;case"takeRight":u=li(u,l-q);break}}return{start:u,end:l}}function Je(u){var l=u.match(rf);return l?l[1].split(sl):[]}function lt(u,l,p){l=Ni(l,u);for(var w=-1,M=l.length,k=!1;++w<M;){var q=Sr(l[w]);if(!(k=u!=null&&p(u,q)))break;u=u[q]}return k||++w!=M?k:(M=u==null?0:u.length,!!M&&ih(M)&&At(q,M)&&(Vn(u)||Zc(u)))}function fe(u){var l=u.length,p=new u.constructor(l);return l&&typeof u[0]=="string"&&Wn.call(u,"index")&&(p.index=u.index,p.input=u.input),p}function Ae(u){return typeof u.constructor=="function"&&!gt(u)?Du(ba(u)):{}}function rt(u,l,p){var w=u.constructor;switch(l){case Se:return Bc(u);case ts:case oo:return new w(+u);case Xe:return zc(u,p);case mt:case Gt:case Ut:case kn:case An:case Pn:case en:case Yn:case Kn:return zf(u,p);case _i:return new w;case ci:case Br:return new w(u);case G:return eu(u);case Zi:return new w;case so:return Ts(u)}}function Mt(u,l){var p=l.length;if(!p)return u;var w=p-1;return l[w]=(p>1?"& ":"")+l[w],l=l.join(p>2?", ":" "),u.replace(Xr,`{
/* [wrapped with `+l+`] */
`)}function Ze(u){return Vn(u)||Zc(u)||!!(bf&&u&&u[bf])}function At(u,l){var p=typeof u;return l=l??Gi,!!l&&(p=="number"||p!="symbol"&&of.test(u))&&u>-1&&u%1==0&&u<l}function Fe(u,l,p){if(!ui(p))return!1;var w=typeof l;return(w=="number"?La(p)&&At(l,p.length):w=="string"&&l in p)?Ko(p[l],u):!1}function pt(u,l){if(Vn(u))return!1;var p=typeof u;return p=="number"||p=="symbol"||p=="boolean"||u==null||Aa(u)?!0:Ls.test(u)||!os.test(u)||l!=null&&u in yr(l)}function He(u){var l=typeof u;return l=="string"||l=="number"||l=="symbol"||l=="boolean"?u!=="__proto__":u===null}function st(u){var l=H(u),p=P[l];if(typeof p!="function"||!(l in ir.prototype))return!1;if(u===p)return!0;var w=O(p);return!!w&&u===w[0]}function Wt(u){return!!yf&&yf in u}var cn=gf?Is:Hl;function gt(u){var l=u&&u.constructor,p=typeof l=="function"&&l.prototype||vo;return u===p}function ct(u){return u===u&&!ui(u)}function je(u,l){return function(p){return p==null?!1:p[u]===l&&(l!==x||u in yr(p))}}function Kt(u){var l=eh(u,function(w){return p.size===he&&p.clear(),w}),p=l.cache;return l}function En(u,l){var p=u[1],w=l[1],M=p|w,k=M<(Et|ht|Ct),q=w==Ct&&p==Re||w==Ct&&p==St&&u[7].length<=l[8]||w==(Ct|St)&&l[7].length<=l[8]&&p==Re;if(!(k||q))return u;w&Et&&(u[2]=l[2],M|=p&Et?0:Oe);var ue=l[3];if(ue){var Ee=u[3];u[3]=Ee?Vd(Ee,ue,l[4]):ue,u[4]=Ee?Da(u[3],be):l[4]}return ue=l[5],ue&&(Ee=u[5],u[5]=Ee?Ho(Ee,ue,l[6]):ue,u[6]=Ee?Da(u[5],be):l[6]),ue=l[7],ue&&(u[7]=ue),w&Ct&&(u[8]=u[8]==null?l[8]:Bi(u[8],l[8])),u[9]==null&&(u[9]=l[9]),u[0]=l[0],u[1]=M,u}function kt(u){var l=[];if(u!=null)for(var p in yr(u))l.push(p);return l}function Dn(u){return Iu.call(u)}function un(u,l,p){return l=li(l===x?u.length-1:l,0),function(){for(var w=arguments,M=-1,k=li(w.length-l,0),q=Pe(k);++M<k;)q[M]=w[l+M];M=-1;for(var ue=Pe(l+1);++M<l;)ue[M]=w[M];return ue[l]=p(q),ur(u,this,ue)}}function bn(u,l){return l.length<2?u:bs(u,Oa(l,0,-1))}function Qn(u,l){for(var p=u.length,w=Bi(l.length,p),M=ra(u);w--;){var k=l[w];u[w]=At(k,p)?M[k]:x}return u}function Vr(u,l){if(!(l==="constructor"&&typeof u[l]=="function")&&l!="__proto__")return u[l]}var ii=Kr(zd),Cn=gd||function(u,l){return Wr.setTimeout(u,l)},Zr=Kr(Vu);function _r(u,l,p){var w=l+"";return Zr(u,Mt(w,jr(Je(w),p)))}function Kr(u){var l=0,p=0;return function(){var w=_d(),M=X-(w-p);if(p=w,M>0){if(++l>=$n)return arguments[0]}else l=0;return u.apply(x,arguments)}}function Jr(u,l){var p=-1,w=u.length,M=w-1;for(l=l===x?w:l;++p<l;){var k=Ll(p,M),q=u[k];u[k]=u[p],u[p]=q}return u.length=l,u}var ai=Kt(function(u){var l=[];return u.charCodeAt(0)===46&&l.push(""),u.replace(nf,function(p,w,M,k){l.push(M?k.replace(ul,"$1"):w||p)}),l});function Sr(u){if(typeof u=="string"||Aa(u))return u;var l=u+"";return l=="0"&&1/u==-ar?"-0":l}function qr(u){if(u!=null){try{return ms.call(u)}catch(l){}try{return u+""}catch(l){}}return""}function jr(u,l){return kr(ei,function(p){var w="_."+p[0];l&p[1]&&!hc(u,w)&&u.push(w)}),u.sort()}function hn(u){if(u instanceof ir)return u.clone();var l=new Pa(u.__wrapped__,u.__chain__);return l.__actions__=ra(u.__actions__),l.__index__=u.__index__,l.__values__=u.__values__,l}function oi(u,l,p){(p?Fe(u,l,p):l===x)?l=1:l=li(Bn(l),0);var w=u==null?0:u.length;if(!w||l<1)return[];for(var M=0,k=0,q=Pe(wf(w/l));M<w;)q[k++]=Oa(u,M,M+=l);return q}function er(u){for(var l=-1,p=u==null?0:u.length,w=0,M=[];++l<p;){var k=u[l];k&&(M[w++]=k)}return M}function Jt(){var u=arguments.length;if(!u)return[];for(var l=Pe(u-1),p=arguments[0],w=u;w--;)l[w-1]=arguments[w];return ko(Vn(p)?ra(p):[p],zi(l,1))}var Gn=Zn(function(u,l){return Di(u)?Ac(u,zi(l,1,Di,!0)):[]}),jn=Zn(function(u,l){var p=ae(l);return Di(p)&&(p=x),Di(u)?Ac(u,zi(l,1,Di,!0),se(p,2)):[]}),si=Zn(function(u,l){var p=ae(l);return Di(p)&&(p=x),Di(u)?Ac(u,zi(l,1,Di,!0),x,p):[]});function wo(u,l,p){var w=u==null?0:u.length;return w?(l=p||l===x?1:Bn(l),Oa(u,l<0?0:l,w)):[]}function Sa(u,l,p){var w=u==null?0:u.length;return w?(l=p||l===x?1:Bn(l),l=w-l,Oa(u,0,l<0?0:l)):[]}function B(u,l){return u&&u.length?qs(u,se(l,3),!0,!0):[]}function we(u,l){return u&&u.length?qs(u,se(l,3),!0):[]}function ye(u,l,p,w){var M=u==null?0:u.length;return M?(p&&typeof p!="number"&&Fe(u,l,p)&&(p=0,w=M),Gd(u,l,p,w)):[]}function Pt(u,l,p){var w=u==null?0:u.length;if(!w)return-1;var M=p==null?0:Bn(p);return M<0&&(M=li(w+M,0)),bu(u,se(l,3),M)}function Sn(u,l,p){var w=u==null?0:u.length;if(!w)return-1;var M=w-1;return p!==x&&(M=Bn(p),M=p<0?li(w+M,0):Bi(M,w-1)),bu(u,se(l,3),M,!0)}function F(u){var l=u==null?0:u.length;return l?zi(u,1):[]}function D(u){var l=u==null?0:u.length;return l?zi(u,ar):[]}function Y(u,l){var p=u==null?0:u.length;return p?(l=l===x?1:Bn(l),zi(u,l)):[]}function ce(u){for(var l=-1,p=u==null?0:u.length,w={};++l<p;){var M=u[l];w[M[0]]=M[1]}return w}function le(u){return u&&u.length?u[0]:x}function te(u,l,p){var w=u==null?0:u.length;if(!w)return-1;var M=p==null?0:Bn(p);return M<0&&(M=li(w+M,0)),Wa(u,l,M)}function K(u){var l=u==null?0:u.length;return l?Oa(u,0,-1):[]}var oe=Zn(function(u){var l=$r(u,ju);return l.length&&l[0]===u[0]?js(l):[]}),U=Zn(function(u){var l=ae(u),p=$r(u,ju);return l===ae(p)?l=x:p.pop(),p.length&&p[0]===u[0]?js(p,se(l,2)):[]}),$=Zn(function(u){var l=ae(u),p=$r(u,ju);return l=typeof l=="function"?l:x,l&&p.pop(),p.length&&p[0]===u[0]?js(p,x,l):[]});function L(u,l){return u==null?"":yd.call(u,l)}function ae(u){var l=u==null?0:u.length;return l?u[l-1]:x}function pe(u,l,p){var w=u==null?0:u.length;if(!w)return-1;var M=w;return p!==x&&(M=Bn(p),M=M<0?li(w+M,0):Bi(M,w-1)),l===l?Uh(u,l,M):bu(u,wu,M,!0)}function Le(u,l){return u&&u.length?Bd(u,Bn(l)):x}var Be=Zn(Me);function Me(u,l){return u&&u.length&&l&&l.length?Bu(u,l):u}function it(u,l,p){return u&&u.length&&l&&l.length?Bu(u,l,se(p,2)):u}function It(u,l,p){return u&&u.length&&l&&l.length?Bu(u,l,x,p):u}var yn=xi(function(u,l){var p=u==null?0:u.length,w=Lu(u,l);return Zo(u,$r(l,function(M){return At(M,p)?+M:M}).sort(Wd)),w});function Ft(u,l){var p=[];if(!(u&&u.length))return p;var w=-1,M=[],k=u.length;for(l=se(l,3);++w<k;){var q=u[w];l(q,w,u)&&(p.push(q),M.push(w))}return Zo(u,M),p}function $t(u){return u==null?u:bd.call(u)}function fn(u,l,p){var w=u==null?0:u.length;return w?(p&&typeof p!="number"&&Fe(u,l,p)?(l=0,p=w):(l=l==null?0:Bn(l),p=p===x?w:Bn(p)),Oa(u,l,p)):[]}function Hn(u,l){return Bf(u,l)}function Nr(u,l,p){return Gl(u,l,se(p,2))}function hi(u,l){var p=u==null?0:u.length;if(p){var w=Bf(u,l);if(w<p&&Ko(u[w],l))return w}return-1}function Hf(u,l){return Bf(u,l,!0)}function Ta(u,l,p){return Gl(u,l,se(p,2),!0)}function Ul(u,l){var p=u==null?0:u.length;if(p){var w=Bf(u,l,!0)-1;if(Ko(u[w],l))return w}return-1}function eo(u){return u&&u.length?Lc(u):[]}function Xd(u,l){return u&&u.length?Lc(u,se(l,2)):[]}function hm(u){var l=u==null?0:u.length;return l?Oa(u,1,l):[]}function $d(u,l,p){return u&&u.length?(l=p||l===x?1:Bn(l),Oa(u,0,l<0?0:l)):[]}function up(u,l,p){var w=u==null?0:u.length;return w?(l=p||l===x?1:Bn(l),l=w-l,Oa(u,l<0?0:l,w)):[]}function vm(u,l){return u&&u.length?qs(u,se(l,3),!1,!0):[]}function cp(u,l){return u&&u.length?qs(u,se(l,3)):[]}var fp=Zn(function(u){return di(zi(u,1,Di,!0))}),pm=Zn(function(u){var l=ae(u);return Di(l)&&(l=x),di(zi(u,1,Di,!0),se(l,2))}),ov=Zn(function(u){var l=ae(u);return l=typeof l=="function"?l:x,di(zi(u,1,Di,!0),x,l)});function lp(u){return u&&u.length?di(u):[]}function sv(u,l){return u&&u.length?di(u,se(l,2)):[]}function mm(u,l){return l=typeof l=="function"?l:x,u&&u.length?di(u,x,l):[]}function uv(u){if(!(u&&u.length))return[];var l=0;return u=ls(u,function(p){if(Di(p))return l=li(p.length,l),!0}),_l(l,function(p){return $r(u,Fo(p))})}function dp(u,l){if(!(u&&u.length))return[];var p=uv(u);return l==null?p:$r(p,function(w){return ur(l,x,w)})}var hp=Zn(function(u,l){return Di(u)?Ac(u,l):[]}),gm=Zn(function(u){return Fc(ls(u,Di))}),vp=Zn(function(u){var l=ae(u);return Di(l)&&(l=x),Fc(ls(u,Di),se(l,2))}),ym=Zn(function(u){var l=ae(u);return l=typeof l=="function"?l:x,Fc(ls(u,Di),x,l)}),pp=Zn(uv);function _m(u,l){return Uc(u||[],l||[],po)}function mp(u,l){return Uc(u||[],l||[],Oc)}var Em=Zn(function(u){var l=u.length,p=l>1?u[l-1]:x;return p=typeof p=="function"?(u.pop(),p):x,dp(u,p)});function Ju(u){var l=P(u);return l.__chain__=!0,l}function bm(u,l){return l(u),u}function Yd(u,l){return l(u)}var cv=xi(function(u){var l=u.length,p=l?u[0]:0,w=this.__wrapped__,M=function(k){return Lu(k,u)};return l>1||this.__actions__.length||!(w instanceof ir)||!At(p)?this.thru(M):(w=w.slice(p,+p+(l?1:0)),w.__actions__.push({func:Yd,args:[M],thisArg:x}),new Pa(w,this.__chain__).thru(function(k){return l&&!k.length&&k.push(x),k}))});function fv(){return Ju(this)}function wm(){return new Pa(this.value(),this.__chain__)}function xm(){this.__values__===x&&(this.__values__=To(this.value()));var u=this.__index__>=this.__values__.length,l=u?x:this.__values__[this.__index__++];return{done:u,value:l}}function Sm(){return this}function Tm(u){for(var l,p=this;p instanceof Cf;){var w=hn(p);w.__index__=0,w.__values__=x,l?M.__wrapped__=w:l=w;var M=w;p=p.__wrapped__}return M.__wrapped__=u,l}function Xf(){var u=this.__wrapped__;if(u instanceof ir){var l=u;return this.__actions__.length&&(l=new ir(this)),l=l.reverse(),l.__actions__.push({func:Yd,args:[$t],thisArg:x}),new Pa(l,this.__chain__)}return this.thru($t)}function gp(){return jo(this.__wrapped__,this.__actions__)}var yp=Xo(function(u,l,p){Wn.call(u,p)?++u[p]:da(u,p,1)});function Am(u,l,p){var w=Vn(u)?dc:Ld;return p&&Fe(u,l,p)&&(l=x),w(u,se(l,3))}function _p(u,l){var p=Vn(u)?ls:Df;return p(u,se(l,3))}var Kd=As(Pt),Bl=As(Sn);function Jd(u,l){return zi(xo(u,l),1)}function Im(u,l){return zi(xo(u,l),ar)}function Cm(u,l,p){return p=p===x?1:Bn(p),zi(xo(u,l),p)}function lv(u,l){var p=Vn(u)?kr:Wo;return p(u,se(l,3))}function dv(u,l){var p=Vn(u)?Rr:Nl;return p(u,se(l,3))}var Rm=Xo(function(u,l,p){Wn.call(u,p)?u[p].push(l):da(u,p,[l])});function Ep(u,l,p,w){u=La(u)?u:Yf(u),p=p&&!w?Bn(p):0;var M=u.length;return p<0&&(p=li(M+p,0)),oh(u)?p<=M&&u.indexOf(l,p)>-1:!!M&&Wa(u,l,p)>-1}var Mm=Zn(function(u,l,p){var w=-1,M=typeof l=="function",k=La(u)?Pe(u.length):[];return Wo(u,function(q){k[++w]=M?ur(l,q,p):ku(q,l,p)}),k}),Nm=Xo(function(u,l,p){da(u,p,l)});function xo(u,l){var p=Vn(u)?$r:xs;return p(u,se(l,3))}function bp(u,l,p,w){return u==null?[]:(Vn(l)||(l=l==null?[]:[l]),p=w?x:p,Vn(p)||(p=p==null?[]:[p]),Xi(u,l,p))}var Dm=Xo(function(u,l,p){u[p?0:1].push(l)},function(){return[[],[]]});function Pm(u,l,p){var w=Vn(u)?Mr:ff,M=arguments.length<3;return w(u,se(l,4),p,M,Wo)}function wp(u,l,p){var w=Vn(u)?pl:ff,M=arguments.length<3;return w(u,se(l,4),p,M,Nl)}function Om(u,l){var p=Vn(u)?ls:Df;return p(u,th(se(l,3)))}function Lm(u){var l=Vn(u)?Vs:ev;return l(u)}function xp(u,l,p){(p?Fe(u,l,p):l===x)?l=1:l=Bn(l);var w=Vn(u)?Pd:tv;return w(u,l)}function Sp(u){var l=Vn(u)?Ou:Uf;return l(u)}function Tp(u){if(u==null)return 0;if(La(u))return oh(u)?xu(u):u.length;var l=qe(u);return l==_i||l==Zi?u.size:$a(u).length}function Gm(u,l,p){var w=Vn(u)?ml:nv;return p&&Fe(u,l,p)&&(l=x),w(u,se(l,3))}var km=Zn(function(u,l){if(u==null)return[];var p=l.length;return p>1&&Fe(u,l[0],l[1])?l=[]:p>2&&Fe(l[0],l[1],l[2])&&(l=[l[0]]),Xi(u,zi(l,1),[])}),zl=Tl||function(){return Wr.Date.now()};function Fm(u,l){if(typeof l!="function")throw new Za(V);return u=Bn(u),function(){if(--u<1)return l.apply(this,arguments)}}function Ap(u,l,p){return l=p?x:l,l=u&&l==null?u.length:l,Qa(u,Ct,x,x,x,x,l)}function Ip(u,l){var p;if(typeof l!="function")throw new Za(V);return u=Bn(u),function(){return--u>0&&(p=l.apply(this,arguments)),u<=1&&(l=x),p}}var hv=Zn(function(u,l,p){var w=Et;if(p.length){var M=Da(p,ge(hv));w|=ot}return Qa(u,w,l,p,M)}),Cp=Zn(function(u,l,p){var w=Et|ht;if(p.length){var M=Da(p,ge(Cp));w|=ot}return Qa(l,w,u,p,M)});function qd(u,l,p){l=p?x:l;var w=Qa(u,Re,x,x,x,x,x,l);return w.placeholder=qd.placeholder,w}function Qd(u,l,p){l=p?x:l;var w=Qa(u,Dt,x,x,x,x,x,l);return w.placeholder=Qd.placeholder,w}function vv(u,l,p){var w,M,k,q,ue,Ee,ut=0,tt=!1,wt=!1,Vt=!0;if(typeof u!="function")throw new Za(V);l=Ao(l)||0,ui(p)&&(tt=!!p.leading,wt="maxWait"in p,k=wt?li(Ao(p.maxWait)||0,l):k,Vt="trailing"in p?!!p.trailing:Vt);function rn(pi){var Jo=w,Cs=M;return w=M=x,ut=pi,q=u.apply(Cs,Jo),q}function Rn(pi){return ut=pi,ue=Cn(fr,l),tt?rn(pi):q}function nr(pi){var Jo=pi-Ee,Cs=pi-ut,M0=l-Jo;return wt?Bi(M0,k-Cs):M0}function Mn(pi){var Jo=pi-Ee,Cs=pi-ut;return Ee===x||Jo>=l||Jo<0||wt&&Cs>=k}function fr(){var pi=zl();if(Mn(pi))return pr(pi);ue=Cn(fr,nr(pi))}function pr(pi){return ue=x,Vt&&w?rn(pi):(w=M=x,q)}function to(){ue!==x&&Eo(ue),ut=0,w=Ee=M=ue=x}function Ca(){return ue===x?q:pr(zl())}function Ra(){var pi=zl(),Jo=Mn(pi);if(w=arguments,M=this,Ee=pi,Jo){if(ue===x)return Rn(Ee);if(wt)return Eo(ue),ue=Cn(fr,l),rn(Ee)}return ue===x&&(ue=Cn(fr,l)),q}return Ra.cancel=to,Ra.flush=Ca,Ra}var Rp=Zn(function(u,l){return Gu(u,1,l)}),Mp=Zn(function(u,l,p){return Gu(u,Ao(l)||0,p)});function Np(u){return Qa(u,Zt)}function eh(u,l){if(typeof u!="function"||l!=null&&typeof l!="function")throw new Za(V);var p=function(){var w=arguments,M=l?l.apply(this,w):w[0],k=p.cache;if(k.has(M))return k.get(M);var q=u.apply(this,w);return p.cache=k.set(M,q)||k,q};return p.cache=new(eh.Cache||zo),p}eh.Cache=zo;function th(u){if(typeof u!="function")throw new Za(V);return function(){var l=arguments;switch(l.length){case 0:return!u.call(this);case 1:return!u.call(this,l[0]);case 2:return!u.call(this,l[0],l[1]);case 3:return!u.call(this,l[0],l[1],l[2])}return!u.apply(this,l)}}function Dp(u){return Ip(2,u)}var Um=Oi(function(u,l){l=l.length==1&&Vn(l[0])?$r(l[0],ta(se())):$r(zi(l,1),ta(se()));var p=l.length;return Zn(function(w){for(var M=-1,k=Bi(w.length,p);++M<k;)w[M]=l[M].call(this,w[M]);return ur(u,this,w)})}),pv=Zn(function(u,l){var p=Da(l,ge(pv));return Qa(u,ot,x,l,p)}),Pp=Zn(function(u,l){var p=Da(l,ge(Pp));return Qa(u,ft,x,l,p)}),Bm=xi(function(u,l){return Qa(u,St,x,x,x,l)});function Op(u,l){if(typeof u!="function")throw new Za(V);return l=l===x?l:Bn(l),Zn(u,l)}function zm(u,l){if(typeof u!="function")throw new Za(V);return l=l==null?0:li(Bn(l),0),Zn(function(p){var w=p[l],M=xa(p,0,l);return w&&ko(M,w),ur(u,this,M)})}function mv(u,l,p){var w=!0,M=!0;if(typeof u!="function")throw new Za(V);return ui(p)&&(w="leading"in p?!!p.leading:w,M="trailing"in p?!!p.trailing:M),vv(u,l,{leading:w,maxWait:l,trailing:M})}function Wm(u){return Ap(u,1)}function Lp(u,l){return pv(Qs(l),u)}function Gp(){if(!arguments.length)return[];var u=arguments[0];return Vn(u)?u:[u]}function Vm(u){return ha(u,Ht)}function Zm(u,l){return l=typeof l=="function"?l:x,ha(u,Ht,l)}function kp(u){return ha(u,at|Ht)}function nh(u,l){return l=typeof l=="function"?l:x,ha(u,at|Ht,l)}function Fp(u,l){return l==null||Tc(u,l,$i(l))}function Ko(u,l){return u===l||u!==u&&l!==l}var jm=Yo(Lf),Hm=Yo(function(u,l){return u>=l}),Zc=Gf(function(){return arguments}())?Gf:function(u){return vi(u)&&Wn.call(u,"callee")&&!Bo.call(u,"callee")},Vn=Pe.isArray,Xm=Ri?ta(Ri):Ol;function La(u){return u!=null&&ih(u.length)&&!Is(u)}function Di(u){return vi(u)&&La(u)}function Up(u){return u===!0||u===!1||vi(u)&&Mi(u)==ts}var qu=Vh||Hl,$m=In?ta(In):Mc;function rh(u){return vi(u)&&u.nodeType===1&&!Wl(u)}function Bp(u){if(u==null)return!0;if(La(u)&&(Vn(u)||typeof u=="string"||typeof u.splice=="function"||qu(u)||jc(u)||Zc(u)))return!u.length;var l=qe(u);if(l==_i||l==Zi)return!u.size;if(gt(u))return!$a(u).length;for(var p in u)if(Wn.call(u,p))return!1;return!0}function zt(u,l){return Fu(u,l)}function gv(u,l,p){p=typeof p=="function"?p:x;var w=p?p(u,l):x;return w===x?Fu(u,l,x,p):!!w}function tr(u){if(!vi(u))return!1;var l=Mi(u);return l==Do||l==ns||typeof u.message=="string"&&typeof u.name=="string"&&!Wl(u)}function zp(u){return typeof u=="number"&&Ru(u)}function Is(u){if(!ui(u))return!1;var l=Mi(u);return l==Fi||l==rs||l==or||l==is}function $f(u){return typeof u=="number"&&u==Bn(u)}function ih(u){return typeof u=="number"&&u>-1&&u%1==0&&u<=Gi}function ui(u){var l=typeof u;return u!=null&&(l=="object"||l=="function")}function vi(u){return u!=null&&typeof u=="object"}var Wp=xr?ta(xr):Vo;function Ym(u,l){return u===l||Hs(u,l,xe(l))}function Km(u,l,p){return p=typeof p=="function"?p:x,Hs(u,l,xe(l),p)}function Jm(u){return jp(u)&&u!=+u}function Vp(u){if(cn(u))throw new Nn(j);return ws(u)}function So(u){return u===null}function Zp(u){return u==null}function jp(u){return typeof u=="number"||vi(u)&&Mi(u)==ci}function Wl(u){if(!vi(u)||Mi(u)!=Ti)return!1;var l=ba(u);if(l===null)return!0;var p=Wn.call(l,"constructor")&&l.constructor;return typeof p=="function"&&p instanceof p&&ms.call(p)==_f}var ah=vr?ta(vr):Nc;function qm(u){return $f(u)&&u>=-Gi&&u<=Gi}var Hp=On?ta(On):Dc;function oh(u){return typeof u=="string"||!Vn(u)&&vi(u)&&Mi(u)==Br}function Aa(u){return typeof u=="symbol"||vi(u)&&Mi(u)==so}var jc=rr?ta(rr):Xs;function sh(u){return u===x}function Xp(u){return vi(u)&&qe(u)==Ji}function $p(u){return vi(u)&&Mi(u)==as}var uh=Yo(Uu),Qm=Yo(function(u,l){return u<=l});function To(u){if(!u)return[];if(La(u))return oh(u)?Va(u):ra(u);if(Ec&&u[Ec])return ld(u[Ec]());var l=qe(u),p=l==_i?xl:l==Zi?mc:Yf;return p(u)}function au(u){if(!u)return u===0?u:0;if(u=Ao(u),u===ar||u===-ar){var l=u<0?-1:1;return l*Fa}return u===u?u:0}function Bn(u){var l=au(u),p=l%1;return l===l?p?l-p:l:0}function yv(u){return u?go(Bn(u),0,ki):0}function Ao(u){if(typeof u=="number")return u;if(Aa(u))return ao;if(ui(u)){var l=typeof u.valueOf=="function"?u.valueOf():u;u=ui(l)?l+"":l}if(typeof u!="string")return u===0?u:+u;u=vc(u);var p=ll.test(u);return p||dl.test(u)?ea(u.slice(2),p?2:8):fl.test(u)?ao:+u}function Yp(u){return Ka(u,va(u))}function eg(u){return u?go(Bn(u),-Gi,Gi):u===0?u:0}function Ir(u){return u==null?"":Fr(u)}var tg=bo(function(u,l){if(gt(l)||La(l)){Ka(l,$i(l),u);return}for(var p in l)Wn.call(l,p)&&po(u,p,l[p])}),Kp=bo(function(u,l){Ka(l,va(l),u)}),ch=bo(function(u,l,p,w){Ka(l,va(l),u,w)}),ng=bo(function(u,l,p,w){Ka(l,$i(l),u,w)}),rg=xi(Lu);function fh(u,l){var p=Du(u);return l==null?p:Zs(p,l)}var ig=Zn(function(u,l){u=yr(u);var p=-1,w=l.length,M=w>2?l[2]:x;for(M&&Fe(l[0],l[1],M)&&(w=1);++p<w;)for(var k=l[p],q=va(k),ue=-1,Ee=q.length;++ue<Ee;){var ut=q[ue],tt=u[ut];(tt===x||Ko(tt,vo[ut])&&!Wn.call(u,ut))&&(u[ut]=k[ut])}return u}),ag=Zn(function(u){return u.push(x,Yu),ur(Qp,x,u)});function og(u,l){return ds(u,se(l,3),Xa)}function Jp(u,l){return ds(u,se(l,3),Cc)}function sg(u,l){return u==null?u:Pf(u,se(l,3),va)}function ug(u,l){return u==null?u:Dl(u,se(l,3),va)}function cg(u,l){return u&&Xa(u,se(l,3))}function _v(u,l){return u&&Cc(u,se(l,3))}function fg(u){return u==null?[]:Rc(u,$i(u))}function lg(u){return u==null?[]:Rc(u,va(u))}function Vl(u,l,p){var w=u==null?x:bs(u,l);return w===x?p:w}function dg(u,l){return u!=null&&lt(u,l,Pl)}function Ev(u,l){return u!=null&&lt(u,l,kd)}var qp=ri(function(u,l,p){l!=null&&typeof l.toString!="function"&&(l=Iu.call(l)),u[l]=p},ou(Ia)),hg=ri(function(u,l,p){l!=null&&typeof l.toString!="function"&&(l=Iu.call(l)),Wn.call(u,l)?u[l].push(p):u[l]=[p]},se),vg=Zn(ku);function $i(u){return La(u)?Dd(u):$a(u)}function va(u){return La(u)?Dd(u,!0):Ff(u)}function pg(u,l){var p={};return l=se(l,3),Xa(u,function(w,M,k){da(p,l(w,M,k),w)}),p}function mg(u,l){var p={};return l=se(l,3),Xa(u,function(w,M,k){da(p,M,l(w,M,k))}),p}var gg=bo(function(u,l,p){_o(u,l,p)}),Qp=bo(function(u,l,p,w){_o(u,l,p,w)}),e0=xi(function(u,l){var p={};if(u==null)return p;var w=!1;l=$r(l,function(k){return k=Ni(k,u),w||(w=k.length>1),k}),Ka(u,T(u),p),w&&(p=ha(p,at|We|Ht,Hd));for(var M=l.length;M--;)Zu(p,l[M]);return p});function yg(u,l){return t0(u,th(se(l)))}var _g=xi(function(u,l){return u==null?{}:Ks(u,l)});function t0(u,l){if(u==null)return{};var p=$r(T(u),function(w){return[w]});return l=se(l),Js(u,p,function(w,M){return l(w,M[0])})}function Eg(u,l,p){l=Ni(l,u);var w=-1,M=l.length;for(M||(M=1,u=x);++w<M;){var k=u==null?x:u[Sr(l[w])];k===x&&(w=M,k=p),u=Is(k)?k.call(u):k}return u}function bg(u,l,p){return u==null?u:Oc(u,l,p)}function wg(u,l,p,w){return w=typeof w=="function"?w:x,u==null?u:Oc(u,l,p,w)}var n0=iu($i),r0=iu(va);function xg(u,l,p){var w=Vn(u),M=w||qu(u)||jc(u);if(l=se(l,4),p==null){var k=u&&u.constructor;M?p=w?new k:[]:ui(u)?p=Is(k)?Du(ba(u)):{}:p={}}return(M?kr:Xa)(u,function(q,ue,Ee){return l(p,q,ue,Ee)}),p}function Sg(u,l){return u==null?!0:Zu(u,l)}function Tg(u,l,p){return u==null?u:kc(u,l,Qs(p))}function Ag(u,l,p,w){return w=typeof w=="function"?w:x,u==null?u:kc(u,l,Qs(p),w)}function Yf(u){return u==null?[]:pc(u,$i(u))}function Ig(u){return u==null?[]:pc(u,va(u))}function Cg(u,l,p){return p===x&&(p=l,l=x),p!==x&&(p=Ao(p),p=p===p?p:0),l!==x&&(l=Ao(l),l=l===l?l:0),go(Ao(u),l,p)}function Rg(u,l,p){return l=au(l),p===x?(p=l,l=0):p=au(p),u=Ao(u),Fd(u,l,p)}function Mg(u,l,p){if(p&&typeof p!="boolean"&&Fe(u,l,p)&&(l=p=x),p===x&&(typeof l=="boolean"?(p=l,l=x):typeof u=="boolean"&&(p=u,u=x)),u===x&&l===x?(u=0,l=1):(u=au(u),l===x?(l=u,u=0):l=au(l)),u>l){var w=u;u=l,l=w}if(p||u%1||l%1){var M=Sf();return Bi(u+M*(l-u+Ui("1e-"+((M+"").length-1))),l)}return Ll(u,l)}var Ng=nu(function(u,l,p){return l=l.toLowerCase(),u+(p?i0(l):l)});function i0(u){return xv(Ir(u).toLowerCase())}function Zl(u){return u=Ir(u),u&&u.replace(uc,wl).replace(Qi,"")}function Dg(u,l,p){u=Ir(u),l=Fr(l);var w=u.length;p=p===x?w:go(Bn(p),0,w);var M=p;return p-=l.length,p>=0&&u.slice(p,M)==l}function J(u){return u=Ir(u),u&&Ai.test(u)?u.replace(Oo,sd):u}function Pg(u){return u=Ir(u),u&&ol.test(u)?u.replace(Gs,"\\$&"):u}var lh=nu(function(u,l,p){return u+(p?"-":"")+l.toLowerCase()}),a0=nu(function(u,l,p){return u+(p?" ":"")+l.toLowerCase()}),Og=$o("toLowerCase");function Lg(u,l,p){u=Ir(u),l=Bn(l);var w=l?xu(u):0;if(!l||w>=l)return u;var M=(l-w)/2;return Zf(Cu(M),p)+u+Zf(wf(M),p)}function Gg(u,l,p){u=Ir(u),l=Bn(l);var w=l?xu(u):0;return l&&w<l?u+Zf(l-w,p):u}function kg(u,l,p){u=Ir(u),l=Bn(l);var w=l?xu(u):0;return l&&w<l?Zf(l-w,p)+u:u}function bv(u,l,p){return p||l==null?l=0:l&&(l=+l),Ed(Ir(u).replace(qi,""),l||0)}function wv(u,l,p){return(p?Fe(u,l,p):l===x)?l=1:l=Bn(l),Wu(Ir(u),l)}function o0(){var u=arguments,l=Ir(u[0]);return u.length<3?l:l.replace(u[1],u[2])}var s0=nu(function(u,l,p){return u+(p?"_":"")+l.toLowerCase()});function Yi(u,l,p){return p&&typeof p!="number"&&Fe(u,l,p)&&(l=p=x),p=p===x?ki:p>>>0,p?(u=Ir(u),u&&(typeof l=="string"||l!=null&&!ah(l))&&(l=Fr(l),!l&&ps(u))?xa(Va(u),0,p):u.split(l,p)):[]}var u0=nu(function(u,l,p){return u+(p?" ":"")+xv(l)});function c0(u,l,p){return u=Ir(u),p=p==null?0:go(Bn(p),0,u.length),l=Fr(l),u.slice(p,p+l.length)==l}function f0(u,l,p){var w=P.templateSettings;p&&Fe(u,l,p)&&(l=x),u=Ir(u),l=ch({},l,w,Wc);var M=ch({},l.imports,w.imports,Wc),k=$i(M),q=pc(M,k),ue,Ee,ut=0,tt=l.interpolate||ss,wt="__p += '",Vt=mf((l.escape||ss).source+"|"+tt.source+"|"+(tt===ga?cl:ss).source+"|"+(l.evaluate||ss).source+"|$","g"),rn="//# sourceURL="+(Wn.call(l,"sourceURL")?(l.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++za+"]")+`
`;u.replace(Vt,function(Mn,fr,pr,to,Ca,Ra){return pr||(pr=to),wt+=u.slice(ut,Ra).replace(us,ud),fr&&(ue=!0,wt+=`' +
__e(`+fr+`) +
'`),Ca&&(Ee=!0,wt+=`';
`+Ca+`;
__p += '`),pr&&(wt+=`' +
((__t = (`+pr+`)) == null ? '' : __t) +
'`),ut=Ra+Mn.length,Mn}),wt+=`';
`;var Rn=Wn.call(l,"variable")&&l.variable;if(!Rn)wt=`with (obj) {
`+wt+`
}
`;else if(oc.test(Rn))throw new Nn(Z);wt=(Ee?wt.replace(ma,""):wt).replace(Os,"$1").replace(Po,"$1;"),wt="function("+(Rn||"obj")+`) {
`+(Rn?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ue?", __e = _.escape":"")+(Ee?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+wt+`return __p
}`;var nr=p0(function(){return cr(k,rn+"return "+wt).apply(x,q)});if(nr.source=wt,tr(nr))throw nr;return nr}function l0(u){return Ir(u).toLowerCase()}function d0(u){return Ir(u).toUpperCase()}function Fg(u,l,p){if(u=Ir(u),u&&(p||l===x))return vc(u);if(!u||!(l=Fr(l)))return u;var w=Va(u),M=Va(l),k=df(w,M),q=hf(w,M)+1;return xa(w,k,q).join("")}function dh(u,l,p){if(u=Ir(u),u&&(p||l===x))return u.slice(0,pf(u)+1);if(!u||!(l=Fr(l)))return u;var w=Va(u),M=hf(w,Va(l))+1;return xa(w,0,M).join("")}function h0(u,l,p){if(u=Ir(u),u&&(p||l===x))return u.replace(qi,"");if(!u||!(l=Fr(l)))return u;var w=Va(u),M=df(w,Va(l));return xa(w,M).join("")}function Ug(u,l){var p=vt,w=tn;if(ui(l)){var M="separator"in l?l.separator:M;p="length"in l?Bn(l.length):p,w="omission"in l?Fr(l.omission):w}u=Ir(u);var k=u.length;if(ps(u)){var q=Va(u);k=q.length}if(p>=k)return u;var ue=p-xu(w);if(ue<1)return w;var Ee=q?xa(q,0,ue).join(""):u.slice(0,ue);if(M===x)return Ee+w;if(q&&(ue+=Ee.length-ue),ah(M)){if(u.slice(ue).search(M)){var ut,tt=Ee;for(M.global||(M=mf(M.source,Ir(sc.exec(M))+"g")),M.lastIndex=0;ut=M.exec(tt);)var wt=ut.index;Ee=Ee.slice(0,wt===x?ue:wt)}}else if(u.indexOf(Fr(M),ue)!=ue){var Vt=Ee.lastIndexOf(M);Vt>-1&&(Ee=Ee.slice(0,Vt))}return Ee+w}function Bg(u){return u=Ir(u),u&&tf.test(u)?u.replace(Ua,Bh):u}var zg=nu(function(u,l,p){return u+(p?" ":"")+l.toUpperCase()}),xv=$o("toUpperCase");function v0(u,l,p){return u=Ir(u),l=p?x:l,l===x?fd(u)?gc(u):cf(u):u.match(l)||[]}var p0=Zn(function(u,l){try{return ur(u,x,l)}catch(p){return tr(p)?p:new Nn(p)}}),Wg=xi(function(u,l){return kr(l,function(p){p=Sr(p),da(u,p,hv(u[p],u))}),u});function Vg(u){var l=u==null?0:u.length,p=se();return u=l?$r(u,function(w){if(typeof w[1]!="function")throw new Za(V);return[p(w[0]),w[1]]}):[],Zn(function(w){for(var M=-1;++M<l;){var k=u[M];if(ur(k[0],this,w))return ur(k[1],this,w)}})}function Zg(u){return Nf(ha(u,at))}function ou(u){return function(){return u}}function Sv(u,l){return u==null||u!==u?l:u}var m0=Wi(),Tv=Wi(!0);function Ia(u){return u}function hh(u){return yo(typeof u=="function"?u:ha(u,at))}function g0(u){return $s(ha(u,at))}function y0(u,l){return Ys(u,ha(l,at))}var _0=Zn(function(u,l){return function(p){return ku(p,u,l)}}),E0=Zn(function(u,l){return function(p){return ku(u,p,l)}});function Av(u,l,p){var w=$i(l),M=Rc(l,w);p==null&&!(ui(l)&&(M.length||!w.length))&&(p=l,l=u,u=this,M=Rc(l,$i(l)));var k=!(ui(p)&&"chain"in p)||!!p.chain,q=Is(u);return kr(M,function(ue){var Ee=l[ue];u[ue]=Ee,q&&(u.prototype[ue]=function(){var ut=this.__chain__;if(k||ut){var tt=u(this.__wrapped__),wt=tt.__actions__=ra(this.__actions__);return wt.push({func:Ee,args:arguments,thisArg:u}),tt.__chain__=ut,tt}return Ee.apply(u,ko([this.value()],arguments))})}),u}function jg(){return Wr._===this&&(Wr._=vd),this}function vh(){}function Hg(u){return u=Bn(u),Zn(function(l){return Bd(l,u)})}var b0=Vf($r),w0=Vf(dc),Xg=Vf(ml);function Iv(u){return pt(u)?Fo(Sr(u)):Pc(u)}function x0(u){return function(l){return u==null?x:bs(u,l)}}var S0=jd(),T0=jd(!0);function jl(){return[]}function Hl(){return!1}function $g(){return{}}function Yg(){return""}function Kg(){return!0}function Jg(u,l){if(u=Bn(u),u<1||u>Gi)return[];var p=ki,w=Bi(u,ki);l=se(l),u-=ki;for(var M=_l(w,l);++p<u;)l(p);return M}function qg(u){return Vn(u)?$r(u,Sr):Aa(u)?[u]:ra(ai(Ir(u)))}function Qg(u){var l=++Au;return Ir(u)+l}var A0=wi(function(u,l){return u+l},0),ey=Fl("ceil"),ty=wi(function(u,l){return u/l},1),ny=Fl("floor");function ry(u){return u&&u.length?Ic(u,Ia,Lf):x}function iy(u,l){return u&&u.length?Ic(u,se(l,2),Lf):x}function ay(u){return yl(u,Ia)}function I0(u,l){return yl(u,se(l,2))}function oy(u){return u&&u.length?Ic(u,Ia,Uu):x}function C0(u,l){return u&&u.length?Ic(u,se(l,2),Uu):x}var sy=wi(function(u,l){return u*l},1),uy=Fl("round"),cy=wi(function(u,l){return u-l},0);function fy(u){return u&&u.length?lf(u,Ia):0}function R0(u,l){return u&&u.length?lf(u,se(l,2)):0}return P.after=Fm,P.ary=Ap,P.assign=tg,P.assignIn=Kp,P.assignInWith=ch,P.assignWith=ng,P.at=rg,P.before=Ip,P.bind=hv,P.bindAll=Wg,P.bindKey=Cp,P.castArray=Gp,P.chain=Ju,P.chunk=oi,P.compact=er,P.concat=Jt,P.cond=Vg,P.conforms=Zg,P.constant=ou,P.countBy=yp,P.create=fh,P.curry=qd,P.curryRight=Qd,P.debounce=vv,P.defaults=ig,P.defaultsDeep=ag,P.defer=Rp,P.delay=Mp,P.difference=Gn,P.differenceBy=jn,P.differenceWith=si,P.drop=wo,P.dropRight=Sa,P.dropRightWhile=B,P.dropWhile=we,P.fill=ye,P.filter=_p,P.flatMap=Jd,P.flatMapDeep=Im,P.flatMapDepth=Cm,P.flatten=F,P.flattenDeep=D,P.flattenDepth=Y,P.flip=Np,P.flow=m0,P.flowRight=Tv,P.fromPairs=ce,P.functions=fg,P.functionsIn=lg,P.groupBy=Rm,P.initial=K,P.intersection=oe,P.intersectionBy=U,P.intersectionWith=$,P.invert=qp,P.invertBy=hg,P.invokeMap=Mm,P.iteratee=hh,P.keyBy=Nm,P.keys=$i,P.keysIn=va,P.map=xo,P.mapKeys=pg,P.mapValues=mg,P.matches=g0,P.matchesProperty=y0,P.memoize=eh,P.merge=gg,P.mergeWith=Qp,P.method=_0,P.methodOf=E0,P.mixin=Av,P.negate=th,P.nthArg=Hg,P.omit=e0,P.omitBy=yg,P.once=Dp,P.orderBy=bp,P.over=b0,P.overArgs=Um,P.overEvery=w0,P.overSome=Xg,P.partial=pv,P.partialRight=Pp,P.partition=Dm,P.pick=_g,P.pickBy=t0,P.property=Iv,P.propertyOf=x0,P.pull=Be,P.pullAll=Me,P.pullAllBy=it,P.pullAllWith=It,P.pullAt=yn,P.range=S0,P.rangeRight=T0,P.rearg=Bm,P.reject=Om,P.remove=Ft,P.rest=Op,P.reverse=$t,P.sampleSize=xp,P.set=bg,P.setWith=wg,P.shuffle=Sp,P.slice=fn,P.sortBy=km,P.sortedUniq=eo,P.sortedUniqBy=Xd,P.split=Yi,P.spread=zm,P.tail=hm,P.take=$d,P.takeRight=up,P.takeRightWhile=vm,P.takeWhile=cp,P.tap=bm,P.throttle=mv,P.thru=Yd,P.toArray=To,P.toPairs=n0,P.toPairsIn=r0,P.toPath=qg,P.toPlainObject=Yp,P.transform=xg,P.unary=Wm,P.union=fp,P.unionBy=pm,P.unionWith=ov,P.uniq=lp,P.uniqBy=sv,P.uniqWith=mm,P.unset=Sg,P.unzip=uv,P.unzipWith=dp,P.update=Tg,P.updateWith=Ag,P.values=Yf,P.valuesIn=Ig,P.without=hp,P.words=v0,P.wrap=Lp,P.xor=gm,P.xorBy=vp,P.xorWith=ym,P.zip=pp,P.zipObject=_m,P.zipObjectDeep=mp,P.zipWith=Em,P.entries=n0,P.entriesIn=r0,P.extend=Kp,P.extendWith=ch,Av(P,P),P.add=A0,P.attempt=p0,P.camelCase=Ng,P.capitalize=i0,P.ceil=ey,P.clamp=Cg,P.clone=Vm,P.cloneDeep=kp,P.cloneDeepWith=nh,P.cloneWith=Zm,P.conformsTo=Fp,P.deburr=Zl,P.defaultTo=Sv,P.divide=ty,P.endsWith=Dg,P.eq=Ko,P.escape=J,P.escapeRegExp=Pg,P.every=Am,P.find=Kd,P.findIndex=Pt,P.findKey=og,P.findLast=Bl,P.findLastIndex=Sn,P.findLastKey=Jp,P.floor=ny,P.forEach=lv,P.forEachRight=dv,P.forIn=sg,P.forInRight=ug,P.forOwn=cg,P.forOwnRight=_v,P.get=Vl,P.gt=jm,P.gte=Hm,P.has=dg,P.hasIn=Ev,P.head=le,P.identity=Ia,P.includes=Ep,P.indexOf=te,P.inRange=Rg,P.invoke=vg,P.isArguments=Zc,P.isArray=Vn,P.isArrayBuffer=Xm,P.isArrayLike=La,P.isArrayLikeObject=Di,P.isBoolean=Up,P.isBuffer=qu,P.isDate=$m,P.isElement=rh,P.isEmpty=Bp,P.isEqual=zt,P.isEqualWith=gv,P.isError=tr,P.isFinite=zp,P.isFunction=Is,P.isInteger=$f,P.isLength=ih,P.isMap=Wp,P.isMatch=Ym,P.isMatchWith=Km,P.isNaN=Jm,P.isNative=Vp,P.isNil=Zp,P.isNull=So,P.isNumber=jp,P.isObject=ui,P.isObjectLike=vi,P.isPlainObject=Wl,P.isRegExp=ah,P.isSafeInteger=qm,P.isSet=Hp,P.isString=oh,P.isSymbol=Aa,P.isTypedArray=jc,P.isUndefined=sh,P.isWeakMap=Xp,P.isWeakSet=$p,P.join=L,P.kebabCase=lh,P.last=ae,P.lastIndexOf=pe,P.lowerCase=a0,P.lowerFirst=Og,P.lt=uh,P.lte=Qm,P.max=ry,P.maxBy=iy,P.mean=ay,P.meanBy=I0,P.min=oy,P.minBy=C0,P.stubArray=jl,P.stubFalse=Hl,P.stubObject=$g,P.stubString=Yg,P.stubTrue=Kg,P.multiply=sy,P.nth=Le,P.noConflict=jg,P.noop=vh,P.now=zl,P.pad=Lg,P.padEnd=Gg,P.padStart=kg,P.parseInt=bv,P.random=Mg,P.reduce=Pm,P.reduceRight=wp,P.repeat=wv,P.replace=o0,P.result=Eg,P.round=uy,P.runInContext=me,P.sample=Lm,P.size=Tp,P.snakeCase=s0,P.some=Gm,P.sortedIndex=Hn,P.sortedIndexBy=Nr,P.sortedIndexOf=hi,P.sortedLastIndex=Hf,P.sortedLastIndexBy=Ta,P.sortedLastIndexOf=Ul,P.startCase=u0,P.startsWith=c0,P.subtract=cy,P.sum=fy,P.sumBy=R0,P.template=f0,P.times=Jg,P.toFinite=au,P.toInteger=Bn,P.toLength=yv,P.toLower=l0,P.toNumber=Ao,P.toSafeInteger=eg,P.toString=Ir,P.toUpper=d0,P.trim=Fg,P.trimEnd=dh,P.trimStart=h0,P.truncate=Ug,P.unescape=Bg,P.uniqueId=Qg,P.upperCase=zg,P.upperFirst=xv,P.each=lv,P.eachRight=dv,P.first=le,Av(P,function(){var u={};return Xa(P,function(l,p){Wn.call(P.prototype,p)||(u[p]=l)}),u}(),{chain:!1}),P.VERSION=ne,kr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){P[u].placeholder=P}),kr(["drop","take"],function(u,l){ir.prototype[u]=function(p){p=p===x?1:li(Bn(p),0);var w=this.__filtered__&&!l?new ir(this):this.clone();return w.__filtered__?w.__takeCount__=Bi(p,w.__takeCount__):w.__views__.push({size:Bi(p,ki),type:u+(w.__dir__<0?"Right":"")}),w},ir.prototype[u+"Right"]=function(p){return this.reverse()[u](p).reverse()}}),kr(["filter","map","takeWhile"],function(u,l){var p=l+1,w=p==Dr||p==es;ir.prototype[u]=function(M){var k=this.clone();return k.__iteratees__.push({iteratee:se(M,3),type:p}),k.__filtered__=k.__filtered__||w,k}}),kr(["head","last"],function(u,l){var p="take"+(l?"Right":"");ir.prototype[u]=function(){return this[p](1).value()[0]}}),kr(["initial","tail"],function(u,l){var p="drop"+(l?"":"Right");ir.prototype[u]=function(){return this.__filtered__?new ir(this):this[p](1)}}),ir.prototype.compact=function(){return this.filter(Ia)},ir.prototype.find=function(u){return this.filter(u).head()},ir.prototype.findLast=function(u){return this.reverse().find(u)},ir.prototype.invokeMap=Zn(function(u,l){return typeof u=="function"?new ir(this):this.map(function(p){return ku(p,u,l)})}),ir.prototype.reject=function(u){return this.filter(th(se(u)))},ir.prototype.slice=function(u,l){u=Bn(u);var p=this;return p.__filtered__&&(u>0||l<0)?new ir(p):(u<0?p=p.takeRight(-u):u&&(p=p.drop(u)),l!==x&&(l=Bn(l),p=l<0?p.dropRight(-l):p.take(l-u)),p)},ir.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},ir.prototype.toArray=function(){return this.take(ki)},Xa(ir.prototype,function(u,l){var p=/^(?:filter|find|map|reject)|While$/.test(l),w=/^(?:head|last)$/.test(l),M=P[w?"take"+(l=="last"?"Right":""):l],k=w||/^find/.test(l);!M||(P.prototype[l]=function(){var q=this.__wrapped__,ue=w?[1]:arguments,Ee=q instanceof ir,ut=ue[0],tt=Ee||Vn(q),wt=function(fr){var pr=M.apply(P,ko([fr],ue));return w&&Vt?pr[0]:pr};tt&&p&&typeof ut=="function"&&ut.length!=1&&(Ee=tt=!1);var Vt=this.__chain__,rn=!!this.__actions__.length,Rn=k&&!Vt,nr=Ee&&!rn;if(!k&&tt){q=nr?q:new ir(this);var Mn=u.apply(q,ue);return Mn.__actions__.push({func:Yd,args:[wt],thisArg:x}),new Pa(Mn,Vt)}return Rn&&nr?u.apply(this,ue):(Mn=this.thru(wt),Rn?w?Mn.value()[0]:Mn.value():Mn)})}),kr(["pop","push","shift","sort","splice","unshift"],function(u){var l=yc[u],p=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",w=/^(?:pop|shift)$/.test(u);P.prototype[u]=function(){var M=arguments;if(w&&!this.__chain__){var k=this.value();return l.apply(Vn(k)?k:[],M)}return this[p](function(q){return l.apply(Vn(q)?q:[],M)})}}),Xa(ir.prototype,function(u,l){var p=P[l];if(p){var w=p.name+"";Wn.call(wa,w)||(wa[w]=[]),wa[w].push({name:l,func:p})}}),wa[qa(x,ht).name]=[{name:"wrapper",func:x}],ir.prototype.clone=Sd,ir.prototype.reverse=Zh,ir.prototype.value=Rf,P.prototype.at=cv,P.prototype.chain=fv,P.prototype.commit=wm,P.prototype.next=xm,P.prototype.plant=Tm,P.prototype.reverse=Xf,P.prototype.toJSON=P.prototype.valueOf=P.prototype.value=gp,P.prototype.first=P.prototype.head,Ec&&(P.prototype[Ec]=Sm),P},Su=Wh();Wr._=Su,N=function(){return Su}.call(I,S,I,Te),N!==x&&(Te.exports=N)}).call(this)},40582:function(Te,I,S){var N=S(89550),x=S(68854),ne=S(36820),W=S(43650),j=S(56601),V=[0,0];Te.exports.x7=function(De,he,be,at,We){return N(De,be,at),ne(De,De),x(he,-De[1],De[0]),x(V,-be[1],be[0]),We/j(he,V)},Te.exports.mJ=function(De,he){return x(De,-he[1],he[0]),De},Te.exports.o7=function(De,he,be){return W(De,he,be),ne(De,De),De}},16246:function(Te,I){var S,N;/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){"use strict";var x={}.hasOwnProperty;function ne(){for(var W=[],j=0;j<arguments.length;j++){var V=arguments[j];if(!!V){var Z=typeof V;if(Z==="string"||Z==="number")W.push(V);else if(Array.isArray(V)){if(V.length){var De=ne.apply(null,V);De&&W.push(De)}}else if(Z==="object")if(V.toString===Object.prototype.toString)for(var he in V)x.call(V,he)&&V[he]&&W.push(he);else W.push(V.toString())}}return W.join(" ")}Te.exports?(ne.default=ne,Te.exports=ne):(S=[],N=function(){return ne}.apply(I,S),N!==void 0&&(Te.exports=N))})()},28660:function(Te,I,S){var N=S(34155);/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var x;(function(ne){(function(W){var j=typeof S.g=="object"?S.g:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),V=Z(ne);typeof j.Reflect=="undefined"?j.Reflect=ne:V=Z(j.Reflect,V),W(V);function Z(De,he){return function(be,at){typeof De[be]!="function"&&Object.defineProperty(De,be,{configurable:!0,writable:!0,value:at}),he&&he(be,at)}}})(function(W){var j=Object.prototype.hasOwnProperty,V=typeof Symbol=="function",Z=V&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",De=V&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",he=typeof Object.create=="function",be={__proto__:[]}instanceof Array,at=!he&&!be,We={create:he?function(){return as(Object.create(null))}:be?function(){return as({__proto__:null})}:function(){return as({})},has:at?function(Se,Xe){return j.call(Se,Xe)}:function(Se,Xe){return Xe in Se},get:at?function(Se,Xe){return j.call(Se,Xe)?Se[Xe]:void 0}:function(Se,Xe){return Se[Xe]}},Ht=Object.getPrototypeOf(Function),Yt=typeof N=="object"&&{NODE_ENV:"production"}&&{NODE_ENV:"production"}.REFLECT_METADATA_USE_MAP_POLYFILL==="true",dt=!Yt&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:so(),Et=!Yt&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:mu(),ht=!Yt&&typeof WeakMap=="function"?WeakMap:Ji(),Oe=new ht;function Re(Se,Xe,mt,Gt){if(ei(mt)){if(!rs(Se))throw new TypeError;if(!ci(Xe))throw new TypeError;return X(Se,Xe)}else{if(!rs(Se))throw new TypeError;if(!or(Xe))throw new TypeError;if(!or(Gt)&&!ei(Gt)&&!oa(Gt))throw new TypeError;return oa(Gt)&&(Gt=void 0),mt=Fi(mt),Dr(Se,Xe,mt,Gt)}}W("decorate",Re);function Dt(Se,Xe){function mt(Gt,Ut){if(!or(Gt))throw new TypeError;if(!ei(Ut)&&!pu(Ut))throw new TypeError;ao(Se,Xe,Gt,Ut)}return mt}W("metadata",Dt);function ot(Se,Xe,mt,Gt){if(!or(mt))throw new TypeError;return ei(Gt)||(Gt=Fi(Gt)),ao(Se,Xe,mt,Gt)}W("defineMetadata",ot);function ft(Se,Xe,mt){if(!or(Xe))throw new TypeError;return ei(mt)||(mt=Fi(mt)),es(Se,Xe,mt)}W("hasMetadata",ft);function Ct(Se,Xe,mt){if(!or(Xe))throw new TypeError;return ei(mt)||(mt=Fi(mt)),ar(Se,Xe,mt)}W("hasOwnMetadata",Ct);function St(Se,Xe,mt){if(!or(Xe))throw new TypeError;return ei(mt)||(mt=Fi(mt)),Gi(Se,Xe,mt)}W("getMetadata",St);function Zt(Se,Xe,mt){if(!or(Xe))throw new TypeError;return ei(mt)||(mt=Fi(mt)),Fa(Se,Xe,mt)}W("getOwnMetadata",Zt);function vt(Se,Xe){if(!or(Se))throw new TypeError;return ei(Xe)||(Xe=Fi(Xe)),ki(Se,Xe)}W("getMetadataKeys",vt);function tn(Se,Xe){if(!or(Se))throw new TypeError;return ei(Xe)||(Xe=Fi(Xe)),Mo(Se,Xe)}W("getOwnMetadataKeys",tn);function $n(Se,Xe,mt){if(!or(Xe))throw new TypeError;ei(mt)||(mt=Fi(mt));var Gt=Ki(Xe,mt,!1);if(ei(Gt)||!Gt.delete(Se))return!1;if(Gt.size>0)return!0;var Ut=Oe.get(Xe);return Ut.delete(mt),Ut.size>0||Oe.delete(Xe),!0}W("deleteMetadata",$n);function X(Se,Xe){for(var mt=Se.length-1;mt>=0;--mt){var Gt=Se[mt],Ut=Gt(Xe);if(!ei(Ut)&&!oa(Ut)){if(!ci(Ut))throw new TypeError;Xe=Ut}}return Xe}function Dr(Se,Xe,mt,Gt){for(var Ut=Se.length-1;Ut>=0;--Ut){var kn=Se[Ut],An=kn(Xe,mt,Gt);if(!ei(An)&&!oa(An)){if(!or(An))throw new TypeError;Gt=An}}return Gt}function Ki(Se,Xe,mt){var Gt=Oe.get(Se);if(ei(Gt)){if(!mt)return;Gt=new dt,Oe.set(Se,Gt)}var Ut=Gt.get(Xe);if(ei(Ut)){if(!mt)return;Ut=new dt,Gt.set(Xe,Ut)}return Ut}function es(Se,Xe,mt){var Gt=ar(Se,Xe,mt);if(Gt)return!0;var Ut=Br(Xe);return oa(Ut)?!1:es(Se,Ut,mt)}function ar(Se,Xe,mt){var Gt=Ki(Xe,mt,!1);return ei(Gt)?!1:ns(Gt.has(Se))}function Gi(Se,Xe,mt){var Gt=ar(Se,Xe,mt);if(Gt)return Fa(Se,Xe,mt);var Ut=Br(Xe);if(!oa(Ut))return Gi(Se,Ut,mt)}function Fa(Se,Xe,mt){var Gt=Ki(Xe,mt,!1);if(!ei(Gt))return Gt.get(Se)}function ao(Se,Xe,mt,Gt){var Ut=Ki(mt,Gt,!0);Ut.set(Se,Xe)}function ki(Se,Xe){var mt=Mo(Se,Xe),Gt=Br(Se);if(Gt===null)return mt;var Ut=ki(Gt,Xe);if(Ut.length<=0)return mt;if(mt.length<=0)return Ut;for(var kn=new Et,An=[],Pn=0,en=mt;Pn<en.length;Pn++){var Yn=en[Pn],Kn=kn.has(Yn);Kn||(kn.add(Yn),An.push(Yn))}for(var ma=0,Os=Ut;ma<Os.length;ma++){var Yn=Os[ma],Kn=kn.has(Yn);Kn||(kn.add(Yn),An.push(Yn))}return An}function Mo(Se,Xe){var mt=[],Gt=Ki(Se,Xe,!1);if(ei(Gt))return mt;for(var Ut=Gt.keys(),kn=Ps(Ut),An=0;;){var Pn=G(kn);if(!Pn)return mt.length=An,mt;var en=is(Pn);try{mt[An]=en}catch(Yn){try{Zi(kn)}finally{throw Yn}}An++}}function vu(Se){if(Se===null)return 1;switch(typeof Se){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Se===null?1:6;default:return 6}}function ei(Se){return Se===void 0}function oa(Se){return Se===null}function No(Se){return typeof Se=="symbol"}function or(Se){return typeof Se=="object"?Se!==null:typeof Se=="function"}function ts(Se,Xe){switch(vu(Se)){case 0:return Se;case 1:return Se;case 2:return Se;case 3:return Se;case 4:return Se;case 5:return Se}var mt=Xe===3?"string":Xe===5?"number":"default",Gt=Ti(Se,Z);if(Gt!==void 0){var Ut=Gt.call(Se,mt);if(or(Ut))throw new TypeError;return Ut}return oo(Se,mt==="default"?"number":mt)}function oo(Se,Xe){if(Xe==="string"){var mt=Se.toString;if(_i(mt)){var Gt=mt.call(Se);if(!or(Gt))return Gt}var Ut=Se.valueOf;if(_i(Ut)){var Gt=Ut.call(Se);if(!or(Gt))return Gt}}else{var Ut=Se.valueOf;if(_i(Ut)){var Gt=Ut.call(Se);if(!or(Gt))return Gt}var kn=Se.toString;if(_i(kn)){var Gt=kn.call(Se);if(!or(Gt))return Gt}}throw new TypeError}function ns(Se){return!!Se}function Do(Se){return""+Se}function Fi(Se){var Xe=ts(Se,3);return No(Xe)?Xe:Do(Xe)}function rs(Se){return Array.isArray?Array.isArray(Se):Se instanceof Object?Se instanceof Array:Object.prototype.toString.call(Se)==="[object Array]"}function _i(Se){return typeof Se=="function"}function ci(Se){return typeof Se=="function"}function pu(Se){switch(vu(Se)){case 3:return!0;case 4:return!0;default:return!1}}function Ti(Se,Xe){var mt=Se[Xe];if(mt!=null){if(!_i(mt))throw new TypeError;return mt}}function Ps(Se){var Xe=Ti(Se,De);if(!_i(Xe))throw new TypeError;var mt=Xe.call(Se);if(!or(mt))throw new TypeError;return mt}function is(Se){return Se.value}function G(Se){var Xe=Se.next();return Xe.done?!1:Xe}function Zi(Se){var Xe=Se.return;Xe&&Xe.call(Se)}function Br(Se){var Xe=Object.getPrototypeOf(Se);if(typeof Se!="function"||Se===Ht||Xe!==Ht)return Xe;var mt=Se.prototype,Gt=mt&&Object.getPrototypeOf(mt);if(Gt==null||Gt===Object.prototype)return Xe;var Ut=Gt.constructor;return typeof Ut!="function"||Ut===Se?Xe:Ut}function so(){var Se={},Xe=[],mt=function(){function An(Pn,en,Yn){this._index=0,this._keys=Pn,this._values=en,this._selector=Yn}return An.prototype["@@iterator"]=function(){return this},An.prototype[De]=function(){return this},An.prototype.next=function(){var Pn=this._index;if(Pn>=0&&Pn<this._keys.length){var en=this._selector(this._keys[Pn],this._values[Pn]);return Pn+1>=this._keys.length?(this._index=-1,this._keys=Xe,this._values=Xe):this._index++,{value:en,done:!1}}return{value:void 0,done:!0}},An.prototype.throw=function(Pn){throw this._index>=0&&(this._index=-1,this._keys=Xe,this._values=Xe),Pn},An.prototype.return=function(Pn){return this._index>=0&&(this._index=-1,this._keys=Xe,this._values=Xe),{value:Pn,done:!0}},An}();return function(){function An(){this._keys=[],this._values=[],this._cacheKey=Se,this._cacheIndex=-2}return Object.defineProperty(An.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),An.prototype.has=function(Pn){return this._find(Pn,!1)>=0},An.prototype.get=function(Pn){var en=this._find(Pn,!1);return en>=0?this._values[en]:void 0},An.prototype.set=function(Pn,en){var Yn=this._find(Pn,!0);return this._values[Yn]=en,this},An.prototype.delete=function(Pn){var en=this._find(Pn,!1);if(en>=0){for(var Yn=this._keys.length,Kn=en+1;Kn<Yn;Kn++)this._keys[Kn-1]=this._keys[Kn],this._values[Kn-1]=this._values[Kn];return this._keys.length--,this._values.length--,Pn===this._cacheKey&&(this._cacheKey=Se,this._cacheIndex=-2),!0}return!1},An.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Se,this._cacheIndex=-2},An.prototype.keys=function(){return new mt(this._keys,this._values,Gt)},An.prototype.values=function(){return new mt(this._keys,this._values,Ut)},An.prototype.entries=function(){return new mt(this._keys,this._values,kn)},An.prototype["@@iterator"]=function(){return this.entries()},An.prototype[De]=function(){return this.entries()},An.prototype._find=function(Pn,en){return this._cacheKey!==Pn&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Pn)),this._cacheIndex<0&&en&&(this._cacheIndex=this._keys.length,this._keys.push(Pn),this._values.push(void 0)),this._cacheIndex},An}();function Gt(An,Pn){return An}function Ut(An,Pn){return Pn}function kn(An,Pn){return[An,Pn]}}function mu(){return function(){function Se(){this._map=new dt}return Object.defineProperty(Se.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Se.prototype.has=function(Xe){return this._map.has(Xe)},Se.prototype.add=function(Xe){return this._map.set(Xe,Xe),this},Se.prototype.delete=function(Xe){return this._map.delete(Xe)},Se.prototype.clear=function(){this._map.clear()},Se.prototype.keys=function(){return this._map.keys()},Se.prototype.values=function(){return this._map.values()},Se.prototype.entries=function(){return this._map.entries()},Se.prototype["@@iterator"]=function(){return this.keys()},Se.prototype[De]=function(){return this.keys()},Se}()}function Ji(){var Se=16,Xe=We.create(),mt=Gt();return function(){function en(){this._key=Gt()}return en.prototype.has=function(Yn){var Kn=Ut(Yn,!1);return Kn!==void 0?We.has(Kn,this._key):!1},en.prototype.get=function(Yn){var Kn=Ut(Yn,!1);return Kn!==void 0?We.get(Kn,this._key):void 0},en.prototype.set=function(Yn,Kn){var ma=Ut(Yn,!0);return ma[this._key]=Kn,this},en.prototype.delete=function(Yn){var Kn=Ut(Yn,!1);return Kn!==void 0?delete Kn[this._key]:!1},en.prototype.clear=function(){this._key=Gt()},en}();function Gt(){var en;do en="@@WeakMap@@"+Pn();while(We.has(Xe,en));return Xe[en]=!0,en}function Ut(en,Yn){if(!j.call(en,mt)){if(!Yn)return;Object.defineProperty(en,mt,{value:We.create()})}return en[mt]}function kn(en,Yn){for(var Kn=0;Kn<Yn;++Kn)en[Kn]=Math.random()*255|0;return en}function An(en){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(en)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(en)):kn(new Uint8Array(en),en):kn(new Array(en),en)}function Pn(){var en=An(Se);en[6]=en[6]&79|64,en[8]=en[8]&191|128;for(var Yn="",Kn=0;Kn<Se;++Kn){var ma=en[Kn];(Kn===4||Kn===6||Kn===8)&&(Yn+="-"),ma<16&&(Yn+="0"),Yn+=ma.toString(16).toLowerCase()}return Yn}}function as(Se){return Se.__=void 0,delete Se.__,Se}})})(x||(x={}))},81550:function(Te){(function(I,S){Te.exports=S()})(this,function(){"use strict";var I=function(T){return T instanceof Uint8Array||T instanceof Uint16Array||T instanceof Uint32Array||T instanceof Int8Array||T instanceof Int16Array||T instanceof Int32Array||T instanceof Float32Array||T instanceof Float64Array||T instanceof Uint8ClampedArray},S=function(T,O){for(var H=Object.keys(O),ge=0;ge<H.length;++ge)T[H[ge]]=O[H[ge]];return T},N=`
`;function x(T){return typeof atob!="undefined"?atob(T):"base64:"+T}function ne(T){var O=new Error("(regl) "+T);throw console.error(O),O}function W(T,O){T||ne(O)}function j(T){return T?": "+T:""}function V(T,O,H){T in O||ne("unknown parameter ("+T+")"+j(H)+". possible values: "+Object.keys(O).join())}function Z(T,O){I(T)||ne("invalid parameter type"+j(O)+". must be a typed array")}function De(T,O){switch(O){case"number":return typeof T=="number";case"object":return typeof T=="object";case"string":return typeof T=="string";case"boolean":return typeof T=="boolean";case"function":return typeof T=="function";case"undefined":return typeof T=="undefined";case"symbol":return typeof T=="symbol"}}function he(T,O,H){De(T,O)||ne("invalid parameter type"+j(H)+". expected "+O+", got "+typeof T)}function be(T,O){T>=0&&(T|0)===T||ne("invalid parameter type, ("+T+")"+j(O)+". must be a nonnegative integer")}function at(T,O,H){O.indexOf(T)<0&&ne("invalid value"+j(H)+". must be one of: "+O)}var We=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Ht(T){Object.keys(T).forEach(function(O){We.indexOf(O)<0&&ne('invalid regl constructor argument "'+O+'". must be one of '+We)})}function Yt(T,O){for(T=T+"";T.length<O;)T=" "+T;return T}function dt(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Et(T,O){this.number=T,this.line=O,this.errors=[]}function ht(T,O,H){this.file=T,this.line=O,this.message=H}function Oe(){var T=new Error,O=(T.stack||T).toString(),H=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(O);if(H)return H[1];var ge=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(O);return ge?ge[1]:"unknown"}function Re(){var T=new Error,O=(T.stack||T).toString(),H=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(O);if(H)return H[1];var ge=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(O);return ge?ge[1]:"unknown"}function Dt(T,O){var H=T.split(`
`),ge=1,se=0,_e={unknown:new dt,0:new dt};_e.unknown.name=_e[0].name=O||Oe(),_e.unknown.lines.push(new Et(0,""));for(var xe=0;xe<H.length;++xe){var $e=H[xe],et=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec($e);if(et)switch(et[1]){case"line":var nt=/(\d+)(\s+\d+)?/.exec(et[2]);nt&&(ge=nt[1]|0,nt[2]&&(se=nt[2]|0,se in _e||(_e[se]=new dt)));break;case"define":var Ge=/SHADER_NAME(_B64)?\s+(.*)$/.exec(et[2]);Ge&&(_e[se].name=Ge[1]?x(Ge[2]):Ge[2]);break}_e[se].lines.push(new Et(ge++,$e))}return Object.keys(_e).forEach(function(qe){var _t=_e[qe];_t.lines.forEach(function(Je){_t.index[Je.number]=Je})}),_e}function ot(T){var O=[];return T.split(`
`).forEach(function(H){if(!(H.length<5)){var ge=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(H);ge?O.push(new ht(ge[1]|0,ge[2]|0,ge[3].trim())):H.length>0&&O.push(new ht("unknown",0,H))}}),O}function ft(T,O){O.forEach(function(H){var ge=T[H.file];if(ge){var se=ge.index[H.line];if(se){se.errors.push(H),ge.hasErrors=!0;return}}T.unknown.hasErrors=!0,T.unknown.lines[0].errors.push(H)})}function Ct(T,O,H,ge,se){if(!T.getShaderParameter(O,T.COMPILE_STATUS)){var _e=T.getShaderInfoLog(O),xe=ge===T.FRAGMENT_SHADER?"fragment":"vertex";Dr(H,"string",xe+" shader source must be a string",se);var $e=Dt(H,se),et=ot(_e);ft($e,et),Object.keys($e).forEach(function(nt){var Ge=$e[nt];if(!Ge.hasErrors)return;var qe=[""],_t=[""];function Je(lt,fe){qe.push(lt),_t.push(fe||"")}Je("file number "+nt+": "+Ge.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Ge.lines.forEach(function(lt){if(lt.errors.length>0){Je(Yt(lt.number,4)+"|  ","background-color:yellow; font-weight:bold"),Je(lt.line+N,"color:red; background-color:yellow; font-weight:bold");var fe=0;lt.errors.forEach(function(Ae){var rt=Ae.message,Mt=/^\s*'(.*)'\s*:\s*(.*)$/.exec(rt);if(Mt){var Ze=Mt[1];switch(rt=Mt[2],Ze){case"assign":Ze="=";break}fe=Math.max(lt.line.indexOf(Ze,fe),0)}else fe=0;Je(Yt("| ",6)),Je(Yt("^^^",fe+3)+N,"font-weight:bold"),Je(Yt("| ",6)),Je(rt+N,"font-weight:bold")}),Je(Yt("| ",6)+N)}else Je(Yt(lt.number,4)+"|  "),Je(lt.line+N,"color:red")}),typeof document!="undefined"&&!window.chrome?(_t[0]=qe.join("%c"),console.log.apply(console,_t)):console.log(qe.join(""))}),W.raise("Error compiling "+xe+" shader, "+$e[0].name)}}function St(T,O,H,ge,se){if(!T.getProgramParameter(O,T.LINK_STATUS)){var _e=T.getProgramInfoLog(O),xe=Dt(H,se),$e=Dt(ge,se),et='Error linking program with vertex shader, "'+$e[0].name+'", and fragment shader "'+xe[0].name+'"';typeof document!="undefined"?console.log("%c"+et+N+"%c"+_e,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(et+N+_e),W.raise(et)}}function Zt(T){T._commandRef=Oe()}function vt(T,O,H,ge){Zt(T);function se(et){return et?ge.id(et):0}T._fragId=se(T.static.frag),T._vertId=se(T.static.vert);function _e(et,nt){Object.keys(nt).forEach(function(Ge){et[ge.id(Ge)]=!0})}var xe=T._uniformSet={};_e(xe,O.static),_e(xe,O.dynamic);var $e=T._attributeSet={};_e($e,H.static),_e($e,H.dynamic),T._hasCount="count"in T.static||"count"in T.dynamic||"elements"in T.static||"elements"in T.dynamic}function tn(T,O){var H=Re();ne(T+" in command "+(O||Oe())+(H==="unknown"?"":" called from "+H))}function $n(T,O,H){T||tn(O,H||Oe())}function X(T,O,H,ge){T in O||tn("unknown parameter ("+T+")"+j(H)+". possible values: "+Object.keys(O).join(),ge||Oe())}function Dr(T,O,H,ge){De(T,O)||tn("invalid parameter type"+j(H)+". expected "+O+", got "+typeof T,ge||Oe())}function Ki(T){T()}function es(T,O,H){T.texture?at(T.texture._texture.internalformat,O,"unsupported texture format for attachment"):at(T.renderbuffer._renderbuffer.format,H,"unsupported renderbuffer format for attachment")}var ar=33071,Gi=9728,Fa=9984,ao=9985,ki=9986,Mo=9987,vu=5120,ei=5121,oa=5122,No=5123,or=5124,ts=5125,oo=5126,ns=32819,Do=32820,Fi=33635,rs=34042,_i=36193,ci={};ci[vu]=ci[ei]=1,ci[oa]=ci[No]=ci[_i]=ci[Fi]=ci[ns]=ci[Do]=2,ci[or]=ci[ts]=ci[oo]=ci[rs]=4;function pu(T,O){return T===Do||T===ns||T===Fi?2:T===rs?4:ci[T]*O}function Ti(T){return!(T&T-1)&&!!T}function Ps(T,O,H){var ge,se=O.width,_e=O.height,xe=O.channels;W(se>0&&se<=H.maxTextureSize&&_e>0&&_e<=H.maxTextureSize,"invalid texture shape"),(T.wrapS!==ar||T.wrapT!==ar)&&W(Ti(se)&&Ti(_e),"incompatible wrap mode for texture, both width and height must be power of 2"),O.mipmask===1?se!==1&&_e!==1&&W(T.minFilter!==Fa&&T.minFilter!==ki&&T.minFilter!==ao&&T.minFilter!==Mo,"min filter requires mipmap"):(W(Ti(se)&&Ti(_e),"texture must be a square power of 2 to support mipmapping"),W(O.mipmask===(se<<1)-1,"missing or incomplete mipmap data")),O.type===oo&&(H.extensions.indexOf("oes_texture_float_linear")<0&&W(T.minFilter===Gi&&T.magFilter===Gi,"filter not supported, must enable oes_texture_float_linear"),W(!T.genMipmaps,"mipmap generation not supported with float textures"));var $e=O.images;for(ge=0;ge<16;++ge)if($e[ge]){var et=se>>ge,nt=_e>>ge;W(O.mipmask&1<<ge,"missing mipmap data");var Ge=$e[ge];if(W(Ge.width===et&&Ge.height===nt,"invalid shape for mip images"),W(Ge.format===O.format&&Ge.internalformat===O.internalformat&&Ge.type===O.type,"incompatible type for mip image"),!Ge.compressed)if(Ge.data){var qe=Math.ceil(pu(Ge.type,xe)*et/Ge.unpackAlignment)*Ge.unpackAlignment;W(Ge.data.byteLength===qe*nt,"invalid data for image, buffer size is inconsistent with image format")}else Ge.element||Ge.copy}else T.genMipmaps||W((O.mipmask&1<<ge)==0,"extra mipmap data");O.compressed&&W(!T.genMipmaps,"mipmap generation for compressed images not supported")}function is(T,O,H,ge){var se=T.width,_e=T.height,xe=T.channels;W(se>0&&se<=ge.maxTextureSize&&_e>0&&_e<=ge.maxTextureSize,"invalid texture shape"),W(se===_e,"cube map must be square"),W(O.wrapS===ar&&O.wrapT===ar,"wrap mode not supported by cube map");for(var $e=0;$e<H.length;++$e){var et=H[$e];W(et.width===se&&et.height===_e,"inconsistent cube map face shape"),O.genMipmaps&&(W(!et.compressed,"can not generate mipmap for compressed textures"),W(et.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var nt=et.images,Ge=0;Ge<16;++Ge){var qe=nt[Ge];if(qe){var _t=se>>Ge,Je=_e>>Ge;W(et.mipmask&1<<Ge,"missing mipmap data"),W(qe.width===_t&&qe.height===Je,"invalid shape for mip images"),W(qe.format===T.format&&qe.internalformat===T.internalformat&&qe.type===T.type,"incompatible type for mip image"),qe.compressed||(qe.data?W(qe.data.byteLength===_t*Je*Math.max(pu(qe.type,xe),qe.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):qe.element||qe.copy)}}}}var G=S(W,{optional:Ki,raise:ne,commandRaise:tn,command:$n,parameter:V,commandParameter:X,constructor:Ht,type:he,commandType:Dr,isTypedArray:Z,nni:be,oneOf:at,shaderError:Ct,linkError:St,callSite:Re,saveCommandRef:Zt,saveDrawInfo:vt,framebufferFormat:es,guessCommand:Oe,texture2D:Ps,textureCube:is}),Zi=0,Br=0,so=5,mu=6;function Ji(T,O){this.id=Zi++,this.type=T,this.data=O}function as(T){return T.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function Se(T){if(T.length===0)return[];var O=T.charAt(0),H=T.charAt(T.length-1);if(T.length>1&&O===H&&(O==='"'||O==="'"))return['"'+as(T.substr(1,T.length-2))+'"'];var ge=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(T);if(ge)return Se(T.substr(0,ge.index)).concat(Se(ge[1])).concat(Se(T.substr(ge.index+ge[0].length)));var se=T.split(".");if(se.length===1)return['"'+as(T)+'"'];for(var _e=[],xe=0;xe<se.length;++xe)_e=_e.concat(Se(se[xe]));return _e}function Xe(T){return"["+Se(T).join("][")+"]"}function mt(T,O){return new Ji(T,Xe(O+""))}function Gt(T){return typeof T=="function"&&!T._reglType||T instanceof Ji}function Ut(T,O){if(typeof T=="function")return new Ji(Br,T);if(typeof T=="number"||typeof T=="boolean")return new Ji(so,T);if(Array.isArray(T))return new Ji(mu,T.map((H,ge)=>Ut(H,O+"["+ge+"]")));if(T instanceof Ji)return T;G(!1,"invalid option type in uniform "+O)}var kn={DynamicVariable:Ji,define:mt,isDynamic:Gt,unbox:Ut,accessor:Xe},An={next:typeof requestAnimationFrame=="function"?function(T){return requestAnimationFrame(T)}:function(T){return setTimeout(T,16)},cancel:typeof cancelAnimationFrame=="function"?function(T){return cancelAnimationFrame(T)}:clearTimeout},Pn=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function en(){var T={"":0},O=[""];return{id:function(H){var ge=T[H];return ge||(ge=T[H]=O.length,O.push(H),ge)},str:function(H){return O[H]}}}function Yn(T,O,H){var ge=document.createElement("canvas");S(ge.style,{border:0,margin:0,padding:0,top:0,left:0}),T.appendChild(ge),T===document.body&&(ge.style.position="absolute",S(T.style,{margin:0,padding:0}));function se(){var $e=window.innerWidth,et=window.innerHeight;if(T!==document.body){var nt=T.getBoundingClientRect();$e=nt.right-nt.left,et=nt.bottom-nt.top}ge.width=H*$e,ge.height=H*et,S(ge.style,{width:$e+"px",height:et+"px"})}var _e;T!==document.body&&typeof ResizeObserver=="function"?(_e=new ResizeObserver(function(){setTimeout(se)}),_e.observe(T)):window.addEventListener("resize",se,!1);function xe(){_e?_e.disconnect():window.removeEventListener("resize",se),T.removeChild(ge)}return se(),{canvas:ge,onDestroy:xe}}function Kn(T,O){function H(ge){try{return T.getContext(ge,O)}catch(se){return null}}return H("webgl")||H("experimental-webgl")||H("webgl-experimental")}function ma(T){return typeof T.nodeName=="string"&&typeof T.appendChild=="function"&&typeof T.getBoundingClientRect=="function"}function Os(T){return typeof T.drawArrays=="function"||typeof T.drawElements=="function"}function Po(T){return typeof T=="string"?T.split():(G(Array.isArray(T),"invalid extension array"),T)}function Ua(T){return typeof T=="string"?(G(typeof document!="undefined","not supported outside of DOM"),document.querySelector(T)):T}function Oo(T){var O=T||{},H,ge,se,_e,xe={},$e=[],et=[],nt=typeof window=="undefined"?1:window.devicePixelRatio,Ge=!1,qe=function(lt){lt&&G.raise(lt)},_t=function(){};if(typeof O=="string"?(G(typeof document!="undefined","selector queries only supported in DOM enviroments"),H=document.querySelector(O),G(H,"invalid query string for element")):typeof O=="object"?ma(O)?H=O:Os(O)?(_e=O,se=_e.canvas):(G.constructor(O),"gl"in O?_e=O.gl:"canvas"in O?se=Ua(O.canvas):"container"in O&&(ge=Ua(O.container)),"attributes"in O&&(xe=O.attributes,G.type(xe,"object","invalid context attributes")),"extensions"in O&&($e=Po(O.extensions)),"optionalExtensions"in O&&(et=Po(O.optionalExtensions)),"onDone"in O&&(G.type(O.onDone,"function","invalid or missing onDone callback"),qe=O.onDone),"profile"in O&&(Ge=!!O.profile),"pixelRatio"in O&&(nt=+O.pixelRatio,G(nt>0,"invalid pixel ratio"))):G.raise("invalid arguments to regl"),H&&(H.nodeName.toLowerCase()==="canvas"?se=H:ge=H),!_e){if(!se){G(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var Je=Yn(ge||document.body,qe,nt);if(!Je)return null;se=Je.canvas,_t=Je.onDestroy}xe.premultipliedAlpha===void 0&&(xe.premultipliedAlpha=!0),_e=Kn(se,xe)}return _e?{gl:_e,canvas:se,container:ge,extensions:$e,optionalExtensions:et,pixelRatio:nt,profile:Ge,onDone:qe,onDestroy:_t}:(_t(),qe("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function tf(T,O){var H={};function ge(xe){G.type(xe,"string","extension name must be string");var $e=xe.toLowerCase(),et;try{et=H[$e]=T.getExtension($e)}catch(nt){}return!!et}for(var se=0;se<O.extensions.length;++se){var _e=O.extensions[se];if(!ge(_e))return O.onDestroy(),O.onDone('"'+_e+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return O.optionalExtensions.forEach(ge),{extensions:H,restore:function(){Object.keys(H).forEach(function(xe){if(H[xe]&&!ge(xe))throw new Error("(regl): error restoring extension "+xe)})}}}function Ai(T,O){for(var H=Array(T),ge=0;ge<T;++ge)H[ge]=O(ge);return H}var uo=5120,Lo=5121,ga=5122,os=5123,Ls=5124,nf=5125,Gs=5126;function ol(T){for(var O=16;O<=1<<28;O*=16)if(T<=O)return O;return 0}function qi(T){var O,H;return O=(T>65535)<<4,T>>>=O,H=(T>255)<<3,T>>>=H,O|=H,H=(T>15)<<2,T>>>=H,O|=H,H=(T>3)<<1,T>>>=H,O|=H,O|T>>1}function ac(){var T=Ai(8,function(){return[]});function O(_e){var xe=ol(_e),$e=T[qi(xe)>>2];return $e.length>0?$e.pop():new ArrayBuffer(xe)}function H(_e){T[qi(_e.byteLength)>>2].push(_e)}function ge(_e,xe){var $e=null;switch(_e){case uo:$e=new Int8Array(O(xe),0,xe);break;case Lo:$e=new Uint8Array(O(xe),0,xe);break;case ga:$e=new Int16Array(O(2*xe),0,xe);break;case os:$e=new Uint16Array(O(2*xe),0,xe);break;case Ls:$e=new Int32Array(O(4*xe),0,xe);break;case nf:$e=new Uint32Array(O(4*xe),0,xe);break;case Gs:$e=new Float32Array(O(4*xe),0,xe);break;default:return null}return $e.length!==xe?$e.subarray(0,xe):$e}function se(_e){H(_e.buffer)}return{alloc:O,free:H,allocType:ge,freeType:se}}var Xr=ac();Xr.zero=ac();var rf=3408,sl=3410,af=3411,oc=3412,ul=3413,cl=3414,sc=3415,fl=33901,ll=33902,gu=3379,dl=3386,of=34921,uc=36347,ss=36348,us=35661,yu=35660,cc=34930,ks=36349,hl=34076,sf=34024,fc=7936,lc=7937,_u=7938,vl=35724,Ye=34047,Ne=36063,bt=34852,Ue=3553,Tt=34067,Lt=34069,nn=33984,jt=6408,xt=5126,sn=5121,gn=36160,Jn=36053,Fn=36064,zr=16384,Pr=function(T,O){var H=1;O.ext_texture_filter_anisotropic&&(H=T.getParameter(Ye));var ge=1,se=1;O.webgl_draw_buffers&&(ge=T.getParameter(bt),se=T.getParameter(Ne));var _e=!!O.oes_texture_float;if(_e){var xe=T.createTexture();T.bindTexture(Ue,xe),T.texImage2D(Ue,0,jt,1,1,0,jt,xt,null);var $e=T.createFramebuffer();if(T.bindFramebuffer(gn,$e),T.framebufferTexture2D(gn,Fn,Ue,xe,0),T.bindTexture(Ue,null),T.checkFramebufferStatus(gn)!==Jn)_e=!1;else{T.viewport(0,0,1,1),T.clearColor(1,0,0,1),T.clear(zr);var et=Xr.allocType(xt,4);T.readPixels(0,0,1,1,jt,xt,et),T.getError()?_e=!1:(T.deleteFramebuffer($e),T.deleteTexture(xe),_e=et[0]===1),Xr.freeType(et)}}var nt=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),Ge=!0;if(!nt){var qe=T.createTexture(),_t=Xr.allocType(sn,36);T.activeTexture(nn),T.bindTexture(Tt,qe),T.texImage2D(Lt,0,jt,3,3,0,jt,sn,_t),Xr.freeType(_t),T.bindTexture(Tt,null),T.deleteTexture(qe),Ge=!T.getError()}return{colorBits:[T.getParameter(sl),T.getParameter(af),T.getParameter(oc),T.getParameter(ul)],depthBits:T.getParameter(cl),stencilBits:T.getParameter(sc),subpixelBits:T.getParameter(rf),extensions:Object.keys(O).filter(function(Je){return!!O[Je]}),maxAnisotropic:H,maxDrawbuffers:ge,maxColorAttachments:se,pointSizeDims:T.getParameter(fl),lineWidthDims:T.getParameter(ll),maxViewportDims:T.getParameter(dl),maxCombinedTextureUnits:T.getParameter(us),maxCubeMapSize:T.getParameter(hl),maxRenderbufferSize:T.getParameter(sf),maxTextureUnits:T.getParameter(cc),maxTextureSize:T.getParameter(gu),maxAttributes:T.getParameter(of),maxVertexUniforms:T.getParameter(uc),maxVertexTextureUnits:T.getParameter(yu),maxVaryingVectors:T.getParameter(ss),maxFragmentUniforms:T.getParameter(ks),glsl:T.getParameter(vl),renderer:T.getParameter(lc),vendor:T.getParameter(fc),version:T.getParameter(_u),readFloat:_e,npotTextureCube:Ge}};function Ar(T){return!!T&&typeof T=="object"&&Array.isArray(T.shape)&&Array.isArray(T.stride)&&typeof T.offset=="number"&&T.shape.length===T.stride.length&&(Array.isArray(T.data)||I(T.data))}var wr=function(T){return Object.keys(T).map(function(O){return T[O]})},Or={shape:Ei,flatten:ni};function ti(T,O,H){for(var ge=0;ge<O;++ge)H[ge]=T[ge]}function Pi(T,O,H,ge){for(var se=0,_e=0;_e<O;++_e)for(var xe=T[_e],$e=0;$e<H;++$e)ge[se++]=xe[$e]}function Ii(T,O,H,ge,se,_e){for(var xe=_e,$e=0;$e<O;++$e)for(var et=T[$e],nt=0;nt<H;++nt)for(var Ge=et[nt],qe=0;qe<ge;++qe)se[xe++]=Ge[qe]}function Un(T,O,H,ge,se){for(var _e=1,xe=H+1;xe<O.length;++xe)_e*=O[xe];var $e=O[H];if(O.length-H==4){var et=O[H+1],nt=O[H+2],Ge=O[H+3];for(xe=0;xe<$e;++xe)Ii(T[xe],et,nt,Ge,ge,se),se+=_e}else for(xe=0;xe<$e;++xe)Un(T[xe],O,H+1,ge,se),se+=_e}function ni(T,O,H,ge){var se=1;if(O.length)for(var _e=0;_e<O.length;++_e)se*=O[_e];else se=0;var xe=ge||Xr.allocType(H,se);switch(O.length){case 0:break;case 1:ti(T,O[0],xe);break;case 2:Pi(T,O[0],O[1],xe);break;case 3:Ii(T,O[0],O[1],O[2],xe,0);break;default:Un(T,O,0,xe,0)}return xe}function Ei(T){for(var O=[],H=T;H.length;H=H[0])O.push(H.length);return O}var sa={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},ua=5120,co=5122,ya=5124,cs=5121,ji=5123,Lr=5125,fo=5126,Fs=5126,Qi={int8:ua,int16:co,int32:ya,uint8:cs,uint16:ji,uint32:Lr,float:fo,float32:Fs},fs=35048,Ba=35040,_a={dynamic:fs,stream:Ba,static:35044},ca=Or.flatten,Hi=Or.shape,za=35044,gr=35040,qn=5121,Ea=5126,Xn=[];Xn[5120]=1,Xn[5122]=2,Xn[5124]=4,Xn[5121]=1,Xn[5123]=2,Xn[5125]=4,Xn[5126]=4;function sr(T){return sa[Object.prototype.toString.call(T)]|0}function fi(T,O){for(var H=0;H<O.length;++H)T[H]=O[H]}function Ui(T,O,H,ge,se,_e,xe){for(var $e=0,et=0;et<H;++et)for(var nt=0;nt<ge;++nt)T[$e++]=O[se*et+_e*nt+xe]}function ea(T,O,H,ge){var se=0,_e={};function xe(fe){this.id=se++,this.buffer=T.createBuffer(),this.type=fe,this.usage=za,this.byteLength=0,this.dimension=1,this.dtype=qn,this.persistentData=null,H.profile&&(this.stats={size:0})}xe.prototype.bind=function(){T.bindBuffer(this.type,this.buffer)},xe.prototype.destroy=function(){_t(this)};var $e=[];function et(fe,Ae){var rt=$e.pop();return rt||(rt=new xe(fe)),rt.bind(),qe(rt,Ae,gr,0,1,!1),rt}function nt(fe){$e.push(fe)}function Ge(fe,Ae,rt){fe.byteLength=Ae.byteLength,T.bufferData(fe.type,Ae,rt)}function qe(fe,Ae,rt,Mt,Ze,At){var Fe;if(fe.usage=rt,Array.isArray(Ae)){if(fe.dtype=Mt||Ea,Ae.length>0){var pt;if(Array.isArray(Ae[0])){Fe=Hi(Ae);for(var He=1,st=1;st<Fe.length;++st)He*=Fe[st];fe.dimension=He,pt=ca(Ae,Fe,fe.dtype),Ge(fe,pt,rt),At?fe.persistentData=pt:Xr.freeType(pt)}else if(typeof Ae[0]=="number"){fe.dimension=Ze;var Wt=Xr.allocType(fe.dtype,Ae.length);fi(Wt,Ae),Ge(fe,Wt,rt),At?fe.persistentData=Wt:Xr.freeType(Wt)}else I(Ae[0])?(fe.dimension=Ae[0].length,fe.dtype=Mt||sr(Ae[0])||Ea,pt=ca(Ae,[Ae.length,Ae[0].length],fe.dtype),Ge(fe,pt,rt),At?fe.persistentData=pt:Xr.freeType(pt)):G.raise("invalid buffer data")}}else if(I(Ae))fe.dtype=Mt||sr(Ae),fe.dimension=Ze,Ge(fe,Ae,rt),At&&(fe.persistentData=new Uint8Array(new Uint8Array(Ae.buffer)));else if(Ar(Ae)){Fe=Ae.shape;var cn=Ae.stride,gt=Ae.offset,ct=0,je=0,Kt=0,En=0;Fe.length===1?(ct=Fe[0],je=1,Kt=cn[0],En=0):Fe.length===2?(ct=Fe[0],je=Fe[1],Kt=cn[0],En=cn[1]):G.raise("invalid shape"),fe.dtype=Mt||sr(Ae.data)||Ea,fe.dimension=je;var kt=Xr.allocType(fe.dtype,ct*je);Ui(kt,Ae.data,ct,je,Kt,En,gt),Ge(fe,kt,rt),At?fe.persistentData=kt:Xr.freeType(kt)}else Ae instanceof ArrayBuffer?(fe.dtype=qn,fe.dimension=Ze,Ge(fe,Ae,rt),At&&(fe.persistentData=new Uint8Array(new Uint8Array(Ae)))):G.raise("invalid buffer data")}function _t(fe){O.bufferCount--,ge(fe);var Ae=fe.buffer;G(Ae,"buffer must not be deleted already"),T.deleteBuffer(Ae),fe.buffer=null,delete _e[fe.id]}function Je(fe,Ae,rt,Mt){O.bufferCount++;var Ze=new xe(Ae);_e[Ze.id]=Ze;function At(He){var st=za,Wt=null,cn=0,gt=0,ct=1;return Array.isArray(He)||I(He)||Ar(He)||He instanceof ArrayBuffer?Wt=He:typeof He=="number"?cn=He|0:He&&(G.type(He,"object","buffer arguments must be an object, a number or an array"),"data"in He&&(G(Wt===null||Array.isArray(Wt)||I(Wt)||Ar(Wt),"invalid data for buffer"),Wt=He.data),"usage"in He&&(G.parameter(He.usage,_a,"invalid buffer usage"),st=_a[He.usage]),"type"in He&&(G.parameter(He.type,Qi,"invalid buffer type"),gt=Qi[He.type]),"dimension"in He&&(G.type(He.dimension,"number","invalid dimension"),ct=He.dimension|0),"length"in He&&(G.nni(cn,"buffer length must be a nonnegative integer"),cn=He.length|0)),Ze.bind(),Wt?qe(Ze,Wt,st,gt,ct,Mt):(cn&&T.bufferData(Ze.type,cn,st),Ze.dtype=gt||qn,Ze.usage=st,Ze.dimension=ct,Ze.byteLength=cn),H.profile&&(Ze.stats.size=Ze.byteLength*Xn[Ze.dtype]),At}function Fe(He,st){G(st+He.byteLength<=Ze.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+He.byteLength+" starting from offset "+st+" to a buffer of size "+Ze.byteLength),T.bufferSubData(Ze.type,st,He)}function pt(He,st){var Wt=(st||0)|0,cn;if(Ze.bind(),I(He)||He instanceof ArrayBuffer)Fe(He,Wt);else if(Array.isArray(He)){if(He.length>0)if(typeof He[0]=="number"){var gt=Xr.allocType(Ze.dtype,He.length);fi(gt,He),Fe(gt,Wt),Xr.freeType(gt)}else if(Array.isArray(He[0])||I(He[0])){cn=Hi(He);var ct=ca(He,cn,Ze.dtype);Fe(ct,Wt),Xr.freeType(ct)}else G.raise("invalid buffer data")}else if(Ar(He)){cn=He.shape;var je=He.stride,Kt=0,En=0,kt=0,Dn=0;cn.length===1?(Kt=cn[0],En=1,kt=je[0],Dn=0):cn.length===2?(Kt=cn[0],En=cn[1],kt=je[0],Dn=je[1]):G.raise("invalid shape");var un=Array.isArray(He.data)?Ze.dtype:sr(He.data),bn=Xr.allocType(un,Kt*En);Ui(bn,He.data,Kt,En,kt,Dn,He.offset),Fe(bn,Wt),Xr.freeType(bn)}else G.raise("invalid data for buffer subdata");return At}return rt||At(fe),At._reglType="buffer",At._buffer=Ze,At.subdata=pt,H.profile&&(At.stats=Ze.stats),At.destroy=function(){_t(Ze)},At}function lt(){wr(_e).forEach(function(fe){fe.buffer=T.createBuffer(),T.bindBuffer(fe.type,fe.buffer),T.bufferData(fe.type,fe.persistentData||fe.byteLength,fe.usage)})}return H.profile&&(O.getTotalBufferSize=function(){var fe=0;return Object.keys(_e).forEach(function(Ae){fe+=_e[Ae].stats.size}),fe}),{create:Je,createStream:et,destroyStream:nt,clear:function(){wr(_e).forEach(_t),$e.forEach(_t)},getBuffer:function(fe){return fe&&fe._buffer instanceof xe?fe._buffer:null},restore:lt,_initBuffer:qe}}var Gr=0,Na=0,Wr=1,fa=1,Go=4,Eu=4,la={points:Gr,point:Na,lines:Wr,line:fa,triangles:Go,triangle:Eu,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Ci=0,Ri=1,In=4,xr=5120,vr=5121,On=5122,rr=5123,ur=5124,dr=5125,kr=34963,Rr=35040,dc=35044;function ls(T,O,H,ge){var se={},_e=0,xe={uint8:vr,uint16:rr};O.oes_element_index_uint&&(xe.uint32=dr);function $e(lt){this.id=_e++,se[this.id]=this,this.buffer=lt,this.primType=In,this.vertCount=0,this.type=0}$e.prototype.bind=function(){this.buffer.bind()};var et=[];function nt(lt){var fe=et.pop();return fe||(fe=new $e(H.create(null,kr,!0,!1)._buffer)),qe(fe,lt,Rr,-1,-1,0,0),fe}function Ge(lt){et.push(lt)}function qe(lt,fe,Ae,rt,Mt,Ze,At){lt.buffer.bind();var Fe;if(fe){var pt=At;!At&&(!I(fe)||Ar(fe)&&!I(fe.data))&&(pt=O.oes_element_index_uint?dr:rr),H._initBuffer(lt.buffer,fe,Ae,pt,3)}else T.bufferData(kr,Ze,Ae),lt.buffer.dtype=Fe||vr,lt.buffer.usage=Ae,lt.buffer.dimension=3,lt.buffer.byteLength=Ze;if(Fe=At,!At){switch(lt.buffer.dtype){case vr:case xr:Fe=vr;break;case rr:case On:Fe=rr;break;case dr:case ur:Fe=dr;break;default:G.raise("unsupported type for element array")}lt.buffer.dtype=Fe}lt.type=Fe,G(Fe!==dr||!!O.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var He=Mt;He<0&&(He=lt.buffer.byteLength,Fe===rr?He>>=1:Fe===dr&&(He>>=2)),lt.vertCount=He;var st=rt;if(rt<0){st=In;var Wt=lt.buffer.dimension;Wt===1&&(st=Ci),Wt===2&&(st=Ri),Wt===3&&(st=In)}lt.primType=st}function _t(lt){ge.elementsCount--,G(lt.buffer!==null,"must not double destroy elements"),delete se[lt.id],lt.buffer.destroy(),lt.buffer=null}function Je(lt,fe){var Ae=H.create(null,kr,!0),rt=new $e(Ae._buffer);ge.elementsCount++;function Mt(Ze){if(!Ze)Ae(),rt.primType=In,rt.vertCount=0,rt.type=vr;else if(typeof Ze=="number")Ae(Ze),rt.primType=In,rt.vertCount=Ze|0,rt.type=vr;else{var At=null,Fe=dc,pt=-1,He=-1,st=0,Wt=0;Array.isArray(Ze)||I(Ze)||Ar(Ze)?At=Ze:(G.type(Ze,"object","invalid arguments for elements"),"data"in Ze&&(At=Ze.data,G(Array.isArray(At)||I(At)||Ar(At),"invalid data for element buffer")),"usage"in Ze&&(G.parameter(Ze.usage,_a,"invalid element buffer usage"),Fe=_a[Ze.usage]),"primitive"in Ze&&(G.parameter(Ze.primitive,la,"invalid element buffer primitive"),pt=la[Ze.primitive]),"count"in Ze&&(G(typeof Ze.count=="number"&&Ze.count>=0,"invalid vertex count for elements"),He=Ze.count|0),"type"in Ze&&(G.parameter(Ze.type,xe,"invalid buffer type"),Wt=xe[Ze.type]),"length"in Ze?st=Ze.length|0:(st=He,Wt===rr||Wt===On?st*=2:(Wt===dr||Wt===ur)&&(st*=4))),qe(rt,At,Fe,pt,He,st,Wt)}return Mt}return Mt(lt),Mt._reglType="elements",Mt._elements=rt,Mt.subdata=function(Ze,At){return Ae.subdata(Ze,At),Mt},Mt.destroy=function(){_t(rt)},Mt}return{create:Je,createStream:nt,destroyStream:Ge,getElements:function(lt){return typeof lt=="function"&&lt._elements instanceof $e?lt._elements:null},clear:function(){wr(se).forEach(_t)}}}var hc=new Float32Array(1),uf=new Uint32Array(hc.buffer),$r=5123;function ko(T){for(var O=Xr.allocType($r,T.length),H=0;H<T.length;++H)if(isNaN(T[H]))O[H]=65535;else if(T[H]===Infinity)O[H]=31744;else if(T[H]===-Infinity)O[H]=64512;else{hc[0]=T[H];var ge=uf[0],se=ge>>>31<<15,_e=(ge<<1>>>24)-127,xe=ge>>13&(1<<10)-1;if(_e<-24)O[H]=se;else if(_e<-14){var $e=-14-_e;O[H]=se+(xe+(1<<10)>>$e)}else _e>15?O[H]=se+31744:O[H]=se+(_e+15<<10)+xe}return O}function Mr(T){return Array.isArray(T)||I(T)}var pl=function(T){return!(T&T-1)&&!!T},ml=34467,lo=3553,gl=34067,cf=34069,ds=6408,bu=6406,Wa=6407,hs=6409,wu=6410,yl=32854,Fo=32855,vs=36194,ff=32819,Fh=32820,lf=33635,_l=34042,El=6402,vc=34041,ta=35904,pc=35906,ho=36193,df=33776,hf=33777,bl=33778,wl=33779,sd=35986,ud=35987,cd=34798,ps=35840,fd=35841,ld=35842,xl=35843,dd=36196,Da=5121,mc=5123,hd=5125,vf=5126,Uh=10242,xu=10243,Va=10497,pf=33071,Bh=33648,Sl=10240,zh=10241,gc=9728,Wh=9729,Su=9984,me=9985,Ke=9986,Pe=9987,Bt=33170,Nn=4352,cr=4353,Yr=4354,yr=34046,mf=3317,ip=37440,Za=37441,yc=37443,Tu=37444,vo=33984,gf=[Su,Ke,me,Pe],ms=[0,hs,wu,Wa,ds],Wn={};Wn[hs]=Wn[bu]=Wn[El]=1,Wn[vc]=Wn[wu]=2,Wn[Wa]=Wn[ta]=3,Wn[ds]=Wn[pc]=4;function Au(T){return"[object "+T+"]"}var yf=Au("HTMLCanvasElement"),Iu=Au("OffscreenCanvas"),_f=Au("CanvasRenderingContext2D"),vd=Au("ImageBitmap"),pd=Au("HTMLImageElement"),Ef=Au("HTMLVideoElement"),Uo=Object.keys(sa).concat([yf,Iu,_f,vd,pd,Ef]),ja=[];ja[Da]=1,ja[vf]=4,ja[ho]=2,ja[mc]=2,ja[hd]=4;var bi=[];bi[yl]=2,bi[Fo]=2,bi[vs]=2,bi[vc]=4,bi[df]=.5,bi[hf]=.5,bi[bl]=1,bi[wl]=1,bi[sd]=.5,bi[ud]=1,bi[cd]=1,bi[ps]=.5,bi[fd]=.25,bi[ld]=.5,bi[xl]=.25,bi[dd]=.5;function ba(T){return Array.isArray(T)&&(T.length===0||typeof T[0]=="number")}function md(T){if(!Array.isArray(T))return!1;var O=T.length;return!(O===0||!Mr(T[0]))}function Bo(T){return Object.prototype.toString.call(T)}function _c(T){return Bo(T)===yf}function bf(T){return Bo(T)===Iu}function Ec(T){return Bo(T)===_f}function gs(T){return Bo(T)===vd}function bc(T){return Bo(T)===pd}function ap(T){return Bo(T)===Ef}function Tl(T){if(!T)return!1;var O=Bo(T);return Uo.indexOf(O)>=0?!0:ba(T)||md(T)||Ar(T)}function gd(T){return sa[Object.prototype.toString.call(T)]|0}function wf(T,O){var H=O.length;switch(T.type){case Da:case mc:case hd:case vf:var ge=Xr.allocType(T.type,H);ge.set(O),T.data=ge;break;case ho:T.data=ko(O);break;default:G.raise("unsupported texture type, must specify a typed array")}}function Cu(T,O){return Xr.allocType(T.type===ho?vf:T.type,O)}function xf(T,O){T.type===ho?(T.data=ko(O),Xr.freeType(O)):T.data=O}function Vh(T,O,H,ge,se,_e){for(var xe=T.width,$e=T.height,et=T.channels,nt=xe*$e*et,Ge=Cu(T,nt),qe=0,_t=0;_t<$e;++_t)for(var Je=0;Je<xe;++Je)for(var lt=0;lt<et;++lt)Ge[qe++]=O[H*Je+ge*_t+se*lt+_e];xf(T,Ge)}function Ru(T,O,H,ge,se,_e){var xe;if(typeof bi[T]!="undefined"?xe=bi[T]:xe=Wn[T]*ja[O],_e&&(xe*=6),se){for(var $e=0,et=H;et>=1;)$e+=xe*et*et,et/=2;return $e}else return xe*H*ge}function yd(T,O,H,ge,se,_e,xe){var $e={"don't care":Nn,"dont care":Nn,nice:Yr,fast:cr},et={repeat:Va,clamp:pf,mirror:Bh},nt={nearest:gc,linear:Wh},Ge=S({mipmap:Pe,"nearest mipmap nearest":Su,"linear mipmap nearest":me,"nearest mipmap linear":Ke,"linear mipmap linear":Pe},nt),qe={none:0,browser:Tu},_t={uint8:Da,rgba4:ff,rgb565:lf,"rgb5 a1":Fh},Je={alpha:bu,luminance:hs,"luminance alpha":wu,rgb:Wa,rgba:ds,rgba4:yl,"rgb5 a1":Fo,rgb565:vs},lt={};O.ext_srgb&&(Je.srgb=ta,Je.srgba=pc),O.oes_texture_float&&(_t.float32=_t.float=vf),O.oes_texture_half_float&&(_t.float16=_t["half float"]=ho),O.webgl_depth_texture&&(S(Je,{depth:El,"depth stencil":vc}),S(_t,{uint16:mc,uint32:hd,"depth stencil":_l})),O.webgl_compressed_texture_s3tc&&S(lt,{"rgb s3tc dxt1":df,"rgba s3tc dxt1":hf,"rgba s3tc dxt3":bl,"rgba s3tc dxt5":wl}),O.webgl_compressed_texture_atc&&S(lt,{"rgb atc":sd,"rgba atc explicit alpha":ud,"rgba atc interpolated alpha":cd}),O.webgl_compressed_texture_pvrtc&&S(lt,{"rgb pvrtc 4bppv1":ps,"rgb pvrtc 2bppv1":fd,"rgba pvrtc 4bppv1":ld,"rgba pvrtc 2bppv1":xl}),O.webgl_compressed_texture_etc1&&(lt["rgb etc1"]=dd);var fe=Array.prototype.slice.call(T.getParameter(ml));Object.keys(lt).forEach(function(B){var we=lt[B];fe.indexOf(we)>=0&&(Je[B]=we)});var Ae=Object.keys(Je);H.textureFormats=Ae;var rt=[];Object.keys(Je).forEach(function(B){var we=Je[B];rt[we]=B});var Mt=[];Object.keys(_t).forEach(function(B){var we=_t[B];Mt[we]=B});var Ze=[];Object.keys(nt).forEach(function(B){var we=nt[B];Ze[we]=B});var At=[];Object.keys(Ge).forEach(function(B){var we=Ge[B];At[we]=B});var Fe=[];Object.keys(et).forEach(function(B){var we=et[B];Fe[we]=B});var pt=Ae.reduce(function(B,we){var ye=Je[we];return ye===hs||ye===bu||ye===hs||ye===wu||ye===El||ye===vc||O.ext_srgb&&(ye===ta||ye===pc)?B[ye]=ye:ye===Fo||we.indexOf("rgba")>=0?B[ye]=ds:B[ye]=Wa,B},{});function He(){this.internalformat=ds,this.format=ds,this.type=Da,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Tu,this.width=0,this.height=0,this.channels=0}function st(B,we){B.internalformat=we.internalformat,B.format=we.format,B.type=we.type,B.compressed=we.compressed,B.premultiplyAlpha=we.premultiplyAlpha,B.flipY=we.flipY,B.unpackAlignment=we.unpackAlignment,B.colorSpace=we.colorSpace,B.width=we.width,B.height=we.height,B.channels=we.channels}function Wt(B,we){if(!(typeof we!="object"||!we)){if("premultiplyAlpha"in we&&(G.type(we.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),B.premultiplyAlpha=we.premultiplyAlpha),"flipY"in we&&(G.type(we.flipY,"boolean","invalid texture flip"),B.flipY=we.flipY),"alignment"in we&&(G.oneOf(we.alignment,[1,2,4,8],"invalid texture unpack alignment"),B.unpackAlignment=we.alignment),"colorSpace"in we&&(G.parameter(we.colorSpace,qe,"invalid colorSpace"),B.colorSpace=qe[we.colorSpace]),"type"in we){var ye=we.type;G(O.oes_texture_float||!(ye==="float"||ye==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),G(O.oes_texture_half_float||!(ye==="half float"||ye==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),G(O.webgl_depth_texture||!(ye==="uint16"||ye==="uint32"||ye==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),G.parameter(ye,_t,"invalid texture type"),B.type=_t[ye]}var Pt=B.width,Sn=B.height,F=B.channels,D=!1;"shape"in we?(G(Array.isArray(we.shape)&&we.shape.length>=2,"shape must be an array"),Pt=we.shape[0],Sn=we.shape[1],we.shape.length===3&&(F=we.shape[2],G(F>0&&F<=4,"invalid number of channels"),D=!0),G(Pt>=0&&Pt<=H.maxTextureSize,"invalid width"),G(Sn>=0&&Sn<=H.maxTextureSize,"invalid height")):("radius"in we&&(Pt=Sn=we.radius,G(Pt>=0&&Pt<=H.maxTextureSize,"invalid radius")),"width"in we&&(Pt=we.width,G(Pt>=0&&Pt<=H.maxTextureSize,"invalid width")),"height"in we&&(Sn=we.height,G(Sn>=0&&Sn<=H.maxTextureSize,"invalid height")),"channels"in we&&(F=we.channels,G(F>0&&F<=4,"invalid number of channels"),D=!0)),B.width=Pt|0,B.height=Sn|0,B.channels=F|0;var Y=!1;if("format"in we){var ce=we.format;G(O.webgl_depth_texture||!(ce==="depth"||ce==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),G.parameter(ce,Je,"invalid texture format");var le=B.internalformat=Je[ce];B.format=pt[le],ce in _t&&("type"in we||(B.type=_t[ce])),ce in lt&&(B.compressed=!0),Y=!0}!D&&Y?B.channels=Wn[B.format]:D&&!Y?B.channels!==ms[B.format]&&(B.format=B.internalformat=ms[B.channels]):Y&&D&&G(B.channels===Wn[B.format],"number of channels inconsistent with specified format")}}function cn(B){T.pixelStorei(ip,B.flipY),T.pixelStorei(Za,B.premultiplyAlpha),T.pixelStorei(yc,B.colorSpace),T.pixelStorei(mf,B.unpackAlignment)}function gt(){He.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function ct(B,we){var ye=null;if(Tl(we)?ye=we:we&&(G.type(we,"object","invalid pixel data type"),Wt(B,we),"x"in we&&(B.xOffset=we.x|0),"y"in we&&(B.yOffset=we.y|0),Tl(we.data)&&(ye=we.data)),G(!B.compressed||ye instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),we.copy){G(!ye,"can not specify copy and data field for the same texture");var Pt=se.viewportWidth,Sn=se.viewportHeight;B.width=B.width||Pt-B.xOffset,B.height=B.height||Sn-B.yOffset,B.needsCopy=!0,G(B.xOffset>=0&&B.xOffset<Pt&&B.yOffset>=0&&B.yOffset<Sn&&B.width>0&&B.width<=Pt&&B.height>0&&B.height<=Sn,"copy texture read out of bounds")}else if(!ye)B.width=B.width||1,B.height=B.height||1,B.channels=B.channels||4;else if(I(ye))B.channels=B.channels||4,B.data=ye,!("type"in we)&&B.type===Da&&(B.type=gd(ye));else if(ba(ye))B.channels=B.channels||4,wf(B,ye),B.alignment=1,B.needsFree=!0;else if(Ar(ye)){var F=ye.data;!Array.isArray(F)&&B.type===Da&&(B.type=gd(F));var D=ye.shape,Y=ye.stride,ce,le,te,K,oe,U;D.length===3?(te=D[2],U=Y[2]):(G(D.length===2,"invalid ndarray pixel data, must be 2 or 3D"),te=1,U=1),ce=D[0],le=D[1],K=Y[0],oe=Y[1],B.alignment=1,B.width=ce,B.height=le,B.channels=te,B.format=B.internalformat=ms[te],B.needsFree=!0,Vh(B,F,K,oe,U,ye.offset)}else if(_c(ye)||bf(ye)||Ec(ye))_c(ye)||bf(ye)?B.element=ye:B.element=ye.canvas,B.width=B.element.width,B.height=B.element.height,B.channels=4;else if(gs(ye))B.element=ye,B.width=ye.width,B.height=ye.height,B.channels=4;else if(bc(ye))B.element=ye,B.width=ye.naturalWidth,B.height=ye.naturalHeight,B.channels=4;else if(ap(ye))B.element=ye,B.width=ye.videoWidth,B.height=ye.videoHeight,B.channels=4;else if(md(ye)){var $=B.width||ye[0].length,L=B.height||ye.length,ae=B.channels;Mr(ye[0][0])?ae=ae||ye[0][0].length:ae=ae||1;for(var pe=Or.shape(ye),Le=1,Be=0;Be<pe.length;++Be)Le*=pe[Be];var Me=Cu(B,Le);Or.flatten(ye,pe,"",Me),xf(B,Me),B.alignment=1,B.width=$,B.height=L,B.channels=ae,B.format=B.internalformat=ms[ae],B.needsFree=!0}B.type===vf?G(H.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):B.type===ho&&G(H.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function je(B,we,ye){var Pt=B.element,Sn=B.data,F=B.internalformat,D=B.format,Y=B.type,ce=B.width,le=B.height;cn(B),Pt?T.texImage2D(we,ye,D,D,Y,Pt):B.compressed?T.compressedTexImage2D(we,ye,F,ce,le,0,Sn):B.needsCopy?(ge(),T.copyTexImage2D(we,ye,D,B.xOffset,B.yOffset,ce,le,0)):T.texImage2D(we,ye,D,ce,le,0,D,Y,Sn||null)}function Kt(B,we,ye,Pt,Sn){var F=B.element,D=B.data,Y=B.internalformat,ce=B.format,le=B.type,te=B.width,K=B.height;cn(B),F?T.texSubImage2D(we,Sn,ye,Pt,ce,le,F):B.compressed?T.compressedTexSubImage2D(we,Sn,ye,Pt,Y,te,K,D):B.needsCopy?(ge(),T.copyTexSubImage2D(we,Sn,ye,Pt,B.xOffset,B.yOffset,te,K)):T.texSubImage2D(we,Sn,ye,Pt,te,K,ce,le,D)}var En=[];function kt(){return En.pop()||new gt}function Dn(B){B.needsFree&&Xr.freeType(B.data),gt.call(B),En.push(B)}function un(){He.call(this),this.genMipmaps=!1,this.mipmapHint=Nn,this.mipmask=0,this.images=Array(16)}function bn(B,we,ye){var Pt=B.images[0]=kt();B.mipmask=1,Pt.width=B.width=we,Pt.height=B.height=ye,Pt.channels=B.channels=4}function Qn(B,we){var ye=null;if(Tl(we))ye=B.images[0]=kt(),st(ye,B),ct(ye,we),B.mipmask=1;else if(Wt(B,we),Array.isArray(we.mipmap))for(var Pt=we.mipmap,Sn=0;Sn<Pt.length;++Sn)ye=B.images[Sn]=kt(),st(ye,B),ye.width>>=Sn,ye.height>>=Sn,ct(ye,Pt[Sn]),B.mipmask|=1<<Sn;else ye=B.images[0]=kt(),st(ye,B),ct(ye,we),B.mipmask=1;st(B,B.images[0]),B.compressed&&(B.internalformat===df||B.internalformat===hf||B.internalformat===bl||B.internalformat===wl)&&G(B.width%4==0&&B.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Vr(B,we){for(var ye=B.images,Pt=0;Pt<ye.length;++Pt){if(!ye[Pt])return;je(ye[Pt],we,Pt)}}var ii=[];function Cn(){var B=ii.pop()||new un;He.call(B),B.mipmask=0;for(var we=0;we<16;++we)B.images[we]=null;return B}function Zr(B){for(var we=B.images,ye=0;ye<we.length;++ye)we[ye]&&Dn(we[ye]),we[ye]=null;ii.push(B)}function _r(){this.minFilter=gc,this.magFilter=gc,this.wrapS=pf,this.wrapT=pf,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Nn}function Kr(B,we){if("min"in we){var ye=we.min;G.parameter(ye,Ge),B.minFilter=Ge[ye],gf.indexOf(B.minFilter)>=0&&!("faces"in we)&&(B.genMipmaps=!0)}if("mag"in we){var Pt=we.mag;G.parameter(Pt,nt),B.magFilter=nt[Pt]}var Sn=B.wrapS,F=B.wrapT;if("wrap"in we){var D=we.wrap;typeof D=="string"?(G.parameter(D,et),Sn=F=et[D]):Array.isArray(D)&&(G.parameter(D[0],et),G.parameter(D[1],et),Sn=et[D[0]],F=et[D[1]])}else{if("wrapS"in we){var Y=we.wrapS;G.parameter(Y,et),Sn=et[Y]}if("wrapT"in we){var ce=we.wrapT;G.parameter(ce,et),F=et[ce]}}if(B.wrapS=Sn,B.wrapT=F,"anisotropic"in we){var le=we.anisotropic;G(typeof le=="number"&&le>=1&&le<=H.maxAnisotropic,"aniso samples must be between 1 and "),B.anisotropic=we.anisotropic}if("mipmap"in we){var te=!1;switch(typeof we.mipmap){case"string":G.parameter(we.mipmap,$e,"invalid mipmap hint"),B.mipmapHint=$e[we.mipmap],B.genMipmaps=!0,te=!0;break;case"boolean":te=B.genMipmaps=we.mipmap;break;case"object":G(Array.isArray(we.mipmap),"invalid mipmap type"),B.genMipmaps=!1,te=!0;break;default:G.raise("invalid mipmap type")}te&&!("min"in we)&&(B.minFilter=Su)}}function Jr(B,we){T.texParameteri(we,zh,B.minFilter),T.texParameteri(we,Sl,B.magFilter),T.texParameteri(we,Uh,B.wrapS),T.texParameteri(we,xu,B.wrapT),O.ext_texture_filter_anisotropic&&T.texParameteri(we,yr,B.anisotropic),B.genMipmaps&&(T.hint(Bt,B.mipmapHint),T.generateMipmap(we))}var ai=0,Sr={},qr=H.maxTextureUnits,jr=Array(qr).map(function(){return null});function hn(B){He.call(this),this.mipmask=0,this.internalformat=ds,this.id=ai++,this.refCount=1,this.target=B,this.texture=T.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new _r,xe.profile&&(this.stats={size:0})}function oi(B){T.activeTexture(vo),T.bindTexture(B.target,B.texture)}function er(){var B=jr[0];B?T.bindTexture(B.target,B.texture):T.bindTexture(lo,null)}function Jt(B){var we=B.texture;G(we,"must not double destroy texture");var ye=B.unit,Pt=B.target;ye>=0&&(T.activeTexture(vo+ye),T.bindTexture(Pt,null),jr[ye]=null),T.deleteTexture(we),B.texture=null,B.params=null,B.pixels=null,B.refCount=0,delete Sr[B.id],_e.textureCount--}S(hn.prototype,{bind:function(){var B=this;B.bindCount+=1;var we=B.unit;if(we<0){for(var ye=0;ye<qr;++ye){var Pt=jr[ye];if(Pt){if(Pt.bindCount>0)continue;Pt.unit=-1}jr[ye]=B,we=ye;break}we>=qr&&G.raise("insufficient number of texture units"),xe.profile&&_e.maxTextureUnits<we+1&&(_e.maxTextureUnits=we+1),B.unit=we,T.activeTexture(vo+we),T.bindTexture(B.target,B.texture)}return we},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Jt(this)}});function Gn(B,we){var ye=new hn(lo);Sr[ye.id]=ye,_e.textureCount++;function Pt(D,Y){var ce=ye.texInfo;_r.call(ce);var le=Cn();return typeof D=="number"?typeof Y=="number"?bn(le,D|0,Y|0):bn(le,D|0,D|0):D?(G.type(D,"object","invalid arguments to regl.texture"),Kr(ce,D),Qn(le,D)):bn(le,1,1),ce.genMipmaps&&(le.mipmask=(le.width<<1)-1),ye.mipmask=le.mipmask,st(ye,le),G.texture2D(ce,le,H),ye.internalformat=le.internalformat,Pt.width=le.width,Pt.height=le.height,oi(ye),Vr(le,lo),Jr(ce,lo),er(),Zr(le),xe.profile&&(ye.stats.size=Ru(ye.internalformat,ye.type,le.width,le.height,ce.genMipmaps,!1)),Pt.format=rt[ye.internalformat],Pt.type=Mt[ye.type],Pt.mag=Ze[ce.magFilter],Pt.min=At[ce.minFilter],Pt.wrapS=Fe[ce.wrapS],Pt.wrapT=Fe[ce.wrapT],Pt}function Sn(D,Y,ce,le){G(!!D,"must specify image data");var te=Y|0,K=ce|0,oe=le|0,U=kt();return st(U,ye),U.width=0,U.height=0,ct(U,D),U.width=U.width||(ye.width>>oe)-te,U.height=U.height||(ye.height>>oe)-K,G(ye.type===U.type&&ye.format===U.format&&ye.internalformat===U.internalformat,"incompatible format for texture.subimage"),G(te>=0&&K>=0&&te+U.width<=ye.width&&K+U.height<=ye.height,"texture.subimage write out of bounds"),G(ye.mipmask&1<<oe,"missing mipmap data"),G(U.data||U.element||U.needsCopy,"missing image data"),oi(ye),Kt(U,lo,te,K,oe),er(),Dn(U),Pt}function F(D,Y){var ce=D|0,le=Y|0||ce;if(ce===ye.width&&le===ye.height)return Pt;Pt.width=ye.width=ce,Pt.height=ye.height=le,oi(ye);for(var te=0;ye.mipmask>>te;++te){var K=ce>>te,oe=le>>te;if(!K||!oe)break;T.texImage2D(lo,te,ye.format,K,oe,0,ye.format,ye.type,null)}return er(),xe.profile&&(ye.stats.size=Ru(ye.internalformat,ye.type,ce,le,!1,!1)),Pt}return Pt(B,we),Pt.subimage=Sn,Pt.resize=F,Pt._reglType="texture2d",Pt._texture=ye,xe.profile&&(Pt.stats=ye.stats),Pt.destroy=function(){ye.decRef()},Pt}function jn(B,we,ye,Pt,Sn,F){var D=new hn(gl);Sr[D.id]=D,_e.cubeCount++;var Y=new Array(6);function ce(K,oe,U,$,L,ae){var pe,Le=D.texInfo;for(_r.call(Le),pe=0;pe<6;++pe)Y[pe]=Cn();if(typeof K=="number"||!K){var Be=K|0||1;for(pe=0;pe<6;++pe)bn(Y[pe],Be,Be)}else if(typeof K=="object")if(oe)Qn(Y[0],K),Qn(Y[1],oe),Qn(Y[2],U),Qn(Y[3],$),Qn(Y[4],L),Qn(Y[5],ae);else if(Kr(Le,K),Wt(D,K),"faces"in K){var Me=K.faces;for(G(Array.isArray(Me)&&Me.length===6,"cube faces must be a length 6 array"),pe=0;pe<6;++pe)G(typeof Me[pe]=="object"&&!!Me[pe],"invalid input for cube map face"),st(Y[pe],D),Qn(Y[pe],Me[pe])}else for(pe=0;pe<6;++pe)Qn(Y[pe],K);else G.raise("invalid arguments to cube map");for(st(D,Y[0]),H.npotTextureCube||G(pl(D.width)&&pl(D.height),"your browser does not support non power or two texture dimensions"),Le.genMipmaps?D.mipmask=(Y[0].width<<1)-1:D.mipmask=Y[0].mipmask,G.textureCube(D,Le,Y,H),D.internalformat=Y[0].internalformat,ce.width=Y[0].width,ce.height=Y[0].height,oi(D),pe=0;pe<6;++pe)Vr(Y[pe],cf+pe);for(Jr(Le,gl),er(),xe.profile&&(D.stats.size=Ru(D.internalformat,D.type,ce.width,ce.height,Le.genMipmaps,!0)),ce.format=rt[D.internalformat],ce.type=Mt[D.type],ce.mag=Ze[Le.magFilter],ce.min=At[Le.minFilter],ce.wrapS=Fe[Le.wrapS],ce.wrapT=Fe[Le.wrapT],pe=0;pe<6;++pe)Zr(Y[pe]);return ce}function le(K,oe,U,$,L){G(!!oe,"must specify image data"),G(typeof K=="number"&&K===(K|0)&&K>=0&&K<6,"invalid face");var ae=U|0,pe=$|0,Le=L|0,Be=kt();return st(Be,D),Be.width=0,Be.height=0,ct(Be,oe),Be.width=Be.width||(D.width>>Le)-ae,Be.height=Be.height||(D.height>>Le)-pe,G(D.type===Be.type&&D.format===Be.format&&D.internalformat===Be.internalformat,"incompatible format for texture.subimage"),G(ae>=0&&pe>=0&&ae+Be.width<=D.width&&pe+Be.height<=D.height,"texture.subimage write out of bounds"),G(D.mipmask&1<<Le,"missing mipmap data"),G(Be.data||Be.element||Be.needsCopy,"missing image data"),oi(D),Kt(Be,cf+K,ae,pe,Le),er(),Dn(Be),ce}function te(K){var oe=K|0;if(oe!==D.width){ce.width=D.width=oe,ce.height=D.height=oe,oi(D);for(var U=0;U<6;++U)for(var $=0;D.mipmask>>$;++$)T.texImage2D(cf+U,$,D.format,oe>>$,oe>>$,0,D.format,D.type,null);return er(),xe.profile&&(D.stats.size=Ru(D.internalformat,D.type,ce.width,ce.height,!1,!0)),ce}}return ce(B,we,ye,Pt,Sn,F),ce.subimage=le,ce.resize=te,ce._reglType="textureCube",ce._texture=D,xe.profile&&(ce.stats=D.stats),ce.destroy=function(){D.decRef()},ce}function si(){for(var B=0;B<qr;++B)T.activeTexture(vo+B),T.bindTexture(lo,null),jr[B]=null;wr(Sr).forEach(Jt),_e.cubeCount=0,_e.textureCount=0}xe.profile&&(_e.getTotalTextureSize=function(){var B=0;return Object.keys(Sr).forEach(function(we){B+=Sr[we].stats.size}),B});function wo(){for(var B=0;B<qr;++B){var we=jr[B];we&&(we.bindCount=0,we.unit=-1,jr[B]=null)}wr(Sr).forEach(function(ye){ye.texture=T.createTexture(),T.bindTexture(ye.target,ye.texture);for(var Pt=0;Pt<32;++Pt)if((ye.mipmask&1<<Pt)!=0)if(ye.target===lo)T.texImage2D(lo,Pt,ye.internalformat,ye.width>>Pt,ye.height>>Pt,0,ye.internalformat,ye.type,null);else for(var Sn=0;Sn<6;++Sn)T.texImage2D(cf+Sn,Pt,ye.internalformat,ye.width>>Pt,ye.height>>Pt,0,ye.internalformat,ye.type,null);Jr(ye.texInfo,ye.target)})}function Sa(){for(var B=0;B<qr;++B){var we=jr[B];we&&(we.bindCount=0,we.unit=-1,jr[B]=null),T.activeTexture(vo+B),T.bindTexture(lo,null),T.bindTexture(gl,null)}}return{create2D:Gn,createCube:jn,clear:si,getTexture:function(B){return null},restore:wo,refresh:Sa}}var ys=36161,li=32854,Bi=32855,_d=36194,Ed=33189,Sf=36168,bd=34041,Tf=35907,Mu=34836,wc=34842,Us=34843,na=[];na[li]=2,na[Bi]=2,na[_d]=2,na[Ed]=2,na[Sf]=1,na[bd]=4,na[Tf]=4,na[Mu]=16,na[wc]=8,na[Us]=6;function Nu(T,O,H){return na[T]*O*H}var Af=function(T,O,H,ge,se){var _e={rgba4:li,rgb565:_d,"rgb5 a1":Bi,depth:Ed,stencil:Sf,"depth stencil":bd};O.ext_srgb&&(_e.srgba=Tf),O.ext_color_buffer_half_float&&(_e.rgba16f=wc,_e.rgb16f=Us),O.webgl_color_buffer_float&&(_e.rgba32f=Mu);var xe=[];Object.keys(_e).forEach(function(Je){var lt=_e[Je];xe[lt]=Je});var $e=0,et={};function nt(Je){this.id=$e++,this.refCount=1,this.renderbuffer=Je,this.format=li,this.width=0,this.height=0,se.profile&&(this.stats={size:0})}nt.prototype.decRef=function(){--this.refCount<=0&&Ge(this)};function Ge(Je){var lt=Je.renderbuffer;G(lt,"must not double destroy renderbuffer"),T.bindRenderbuffer(ys,null),T.deleteRenderbuffer(lt),Je.renderbuffer=null,Je.refCount=0,delete et[Je.id],ge.renderbufferCount--}function qe(Je,lt){var fe=new nt(T.createRenderbuffer());et[fe.id]=fe,ge.renderbufferCount++;function Ae(Mt,Ze){var At=0,Fe=0,pt=li;if(typeof Mt=="object"&&Mt){var He=Mt;if("shape"in He){var st=He.shape;G(Array.isArray(st)&&st.length>=2,"invalid renderbuffer shape"),At=st[0]|0,Fe=st[1]|0}else"radius"in He&&(At=Fe=He.radius|0),"width"in He&&(At=He.width|0),"height"in He&&(Fe=He.height|0);"format"in He&&(G.parameter(He.format,_e,"invalid renderbuffer format"),pt=_e[He.format])}else typeof Mt=="number"?(At=Mt|0,typeof Ze=="number"?Fe=Ze|0:Fe=At):Mt?G.raise("invalid arguments to renderbuffer constructor"):At=Fe=1;if(G(At>0&&Fe>0&&At<=H.maxRenderbufferSize&&Fe<=H.maxRenderbufferSize,"invalid renderbuffer size"),!(At===fe.width&&Fe===fe.height&&pt===fe.format))return Ae.width=fe.width=At,Ae.height=fe.height=Fe,fe.format=pt,T.bindRenderbuffer(ys,fe.renderbuffer),T.renderbufferStorage(ys,pt,At,Fe),G(T.getError()===0,"invalid render buffer format"),se.profile&&(fe.stats.size=Nu(fe.format,fe.width,fe.height)),Ae.format=xe[fe.format],Ae}function rt(Mt,Ze){var At=Mt|0,Fe=Ze|0||At;return At===fe.width&&Fe===fe.height||(G(At>0&&Fe>0&&At<=H.maxRenderbufferSize&&Fe<=H.maxRenderbufferSize,"invalid renderbuffer size"),Ae.width=fe.width=At,Ae.height=fe.height=Fe,T.bindRenderbuffer(ys,fe.renderbuffer),T.renderbufferStorage(ys,fe.format,At,Fe),G(T.getError()===0,"invalid render buffer format"),se.profile&&(fe.stats.size=Nu(fe.format,fe.width,fe.height))),Ae}return Ae(Je,lt),Ae.resize=rt,Ae._reglType="renderbuffer",Ae._renderbuffer=fe,se.profile&&(Ae.stats=fe.stats),Ae.destroy=function(){fe.decRef()},Ae}se.profile&&(ge.getTotalRenderbufferSize=function(){var Je=0;return Object.keys(et).forEach(function(lt){Je+=et[lt].stats.size}),Je});function _t(){wr(et).forEach(function(Je){Je.renderbuffer=T.createRenderbuffer(),T.bindRenderbuffer(ys,Je.renderbuffer),T.renderbufferStorage(ys,Je.format,Je.width,Je.height)}),T.bindRenderbuffer(ys,null)}return{create:qe,clear:function(){wr(et).forEach(Ge)},restore:_t}},wa=36160,Al=36161,Bs=3553,xc=34069,wd=36064,xd=36096,If=36128,zs=33306,Il=36053,P=36054,Du=36055,Cf=36057,Pa=36061,ir=36193,Sd=5121,Zh=5126,Rf=6407,_s=6408,Cl=6402,Td=[Rf,_s],Ad=[];Ad[_s]=4,Ad[Rf]=3;var Sc=[];Sc[Sd]=1,Sc[Zh]=4,Sc[ir]=2;var jh=32854,Es=32855,Id=36194,Hh=33189,Xh=36168,Cd=34041,op=35907,zo=34836,sp=34842,$h=34843,Yh=[jh,Es,Id,op,sp,$h,zo],Pu={};Pu[Il]="complete",Pu[P]="incomplete attachment",Pu[Cf]="incomplete dimensions",Pu[Du]="incomplete, missing attachment",Pu[Pa]="unsupported";function Kh(T,O,H,ge,se,_e){var xe={cur:null,next:null,dirty:!1,setFBO:null},$e=["rgba"],et=["rgba4","rgb565","rgb5 a1"];O.ext_srgb&&et.push("srgba"),O.ext_color_buffer_half_float&&et.push("rgba16f","rgb16f"),O.webgl_color_buffer_float&&et.push("rgba32f");var nt=["uint8"];O.oes_texture_half_float&&nt.push("half float","float16"),O.oes_texture_float&&nt.push("float","float32");function Ge(gt,ct,je){this.target=gt,this.texture=ct,this.renderbuffer=je;var Kt=0,En=0;ct?(Kt=ct.width,En=ct.height):je&&(Kt=je.width,En=je.height),this.width=Kt,this.height=En}function qe(gt){gt&&(gt.texture&&gt.texture._texture.decRef(),gt.renderbuffer&&gt.renderbuffer._renderbuffer.decRef())}function _t(gt,ct,je){if(!!gt)if(gt.texture){var Kt=gt.texture._texture,En=Math.max(1,Kt.width),kt=Math.max(1,Kt.height);G(En===ct&&kt===je,"inconsistent width/height for supplied texture"),Kt.refCount+=1}else{var Dn=gt.renderbuffer._renderbuffer;G(Dn.width===ct&&Dn.height===je,"inconsistent width/height for renderbuffer"),Dn.refCount+=1}}function Je(gt,ct){ct&&(ct.texture?T.framebufferTexture2D(wa,gt,ct.target,ct.texture._texture.texture,0):T.framebufferRenderbuffer(wa,gt,Al,ct.renderbuffer._renderbuffer.renderbuffer))}function lt(gt){var ct=Bs,je=null,Kt=null,En=gt;typeof gt=="object"&&(En=gt.data,"target"in gt&&(ct=gt.target|0)),G.type(En,"function","invalid attachment data");var kt=En._reglType;return kt==="texture2d"?(je=En,G(ct===Bs)):kt==="textureCube"?(je=En,G(ct>=xc&&ct<xc+6,"invalid cube map target")):kt==="renderbuffer"?(Kt=En,ct=Al):G.raise("invalid regl object for attachment"),new Ge(ct,je,Kt)}function fe(gt,ct,je,Kt,En){if(je){var kt=ge.create2D({width:gt,height:ct,format:Kt,type:En});return kt._texture.refCount=0,new Ge(Bs,kt,null)}else{var Dn=se.create({width:gt,height:ct,format:Kt});return Dn._renderbuffer.refCount=0,new Ge(Al,null,Dn)}}function Ae(gt){return gt&&(gt.texture||gt.renderbuffer)}function rt(gt,ct,je){gt&&(gt.texture?gt.texture.resize(ct,je):gt.renderbuffer&&gt.renderbuffer.resize(ct,je),gt.width=ct,gt.height=je)}var Mt=0,Ze={};function At(){this.id=Mt++,Ze[this.id]=this,this.framebuffer=T.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Fe(gt){gt.colorAttachments.forEach(qe),qe(gt.depthAttachment),qe(gt.stencilAttachment),qe(gt.depthStencilAttachment)}function pt(gt){var ct=gt.framebuffer;G(ct,"must not double destroy framebuffer"),T.deleteFramebuffer(ct),gt.framebuffer=null,_e.framebufferCount--,delete Ze[gt.id]}function He(gt){var ct;T.bindFramebuffer(wa,gt.framebuffer);var je=gt.colorAttachments;for(ct=0;ct<je.length;++ct)Je(wd+ct,je[ct]);for(ct=je.length;ct<H.maxColorAttachments;++ct)T.framebufferTexture2D(wa,wd+ct,Bs,null,0);T.framebufferTexture2D(wa,zs,Bs,null,0),T.framebufferTexture2D(wa,xd,Bs,null,0),T.framebufferTexture2D(wa,If,Bs,null,0),Je(xd,gt.depthAttachment),Je(If,gt.stencilAttachment),Je(zs,gt.depthStencilAttachment);var Kt=T.checkFramebufferStatus(wa);!T.isContextLost()&&Kt!==Il&&G.raise("framebuffer configuration not supported, status = "+Pu[Kt]),T.bindFramebuffer(wa,xe.next?xe.next.framebuffer:null),xe.cur=xe.next,T.getError()}function st(gt,ct){var je=new At;_e.framebufferCount++;function Kt(kt,Dn){var un;G(xe.next!==je,"can not update framebuffer which is currently in use");var bn=0,Qn=0,Vr=!0,ii=!0,Cn=null,Zr=!0,_r="rgba",Kr="uint8",Jr=1,ai=null,Sr=null,qr=null,jr=!1;if(typeof kt=="number")bn=kt|0,Qn=Dn|0||bn;else if(!kt)bn=Qn=1;else{G.type(kt,"object","invalid arguments for framebuffer");var hn=kt;if("shape"in hn){var oi=hn.shape;G(Array.isArray(oi)&&oi.length>=2,"invalid shape for framebuffer"),bn=oi[0],Qn=oi[1]}else"radius"in hn&&(bn=Qn=hn.radius),"width"in hn&&(bn=hn.width),"height"in hn&&(Qn=hn.height);("color"in hn||"colors"in hn)&&(Cn=hn.color||hn.colors,Array.isArray(Cn)&&G(Cn.length===1||O.webgl_draw_buffers,"multiple render targets not supported")),Cn||("colorCount"in hn&&(Jr=hn.colorCount|0,G(Jr>0,"invalid color buffer count")),"colorTexture"in hn&&(Zr=!!hn.colorTexture,_r="rgba4"),"colorType"in hn&&(Kr=hn.colorType,Zr?(G(O.oes_texture_float||!(Kr==="float"||Kr==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),G(O.oes_texture_half_float||!(Kr==="half float"||Kr==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Kr==="half float"||Kr==="float16"?(G(O.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),_r="rgba16f"):(Kr==="float"||Kr==="float32")&&(G(O.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),_r="rgba32f"),G.oneOf(Kr,nt,"invalid color type")),"colorFormat"in hn&&(_r=hn.colorFormat,$e.indexOf(_r)>=0?Zr=!0:et.indexOf(_r)>=0?Zr=!1:Zr?G.oneOf(hn.colorFormat,$e,"invalid color format for texture"):G.oneOf(hn.colorFormat,et,"invalid color format for renderbuffer"))),("depthTexture"in hn||"depthStencilTexture"in hn)&&(jr=!!(hn.depthTexture||hn.depthStencilTexture),G(!jr||O.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in hn&&(typeof hn.depth=="boolean"?Vr=hn.depth:(ai=hn.depth,ii=!1)),"stencil"in hn&&(typeof hn.stencil=="boolean"?ii=hn.stencil:(Sr=hn.stencil,Vr=!1)),"depthStencil"in hn&&(typeof hn.depthStencil=="boolean"?Vr=ii=hn.depthStencil:(qr=hn.depthStencil,Vr=!1,ii=!1))}var er=null,Jt=null,Gn=null,jn=null;if(Array.isArray(Cn))er=Cn.map(lt);else if(Cn)er=[lt(Cn)];else for(er=new Array(Jr),un=0;un<Jr;++un)er[un]=fe(bn,Qn,Zr,_r,Kr);G(O.webgl_draw_buffers||er.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),G(er.length<=H.maxColorAttachments,"too many color attachments, not supported"),bn=bn||er[0].width,Qn=Qn||er[0].height,ai?Jt=lt(ai):Vr&&!ii&&(Jt=fe(bn,Qn,jr,"depth","uint32")),Sr?Gn=lt(Sr):ii&&!Vr&&(Gn=fe(bn,Qn,!1,"stencil","uint8")),qr?jn=lt(qr):!ai&&!Sr&&ii&&Vr&&(jn=fe(bn,Qn,jr,"depth stencil","depth stencil")),G(!!ai+!!Sr+!!qr<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var si=null;for(un=0;un<er.length;++un)if(_t(er[un],bn,Qn),G(!er[un]||er[un].texture&&Td.indexOf(er[un].texture._texture.format)>=0||er[un].renderbuffer&&Yh.indexOf(er[un].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+un+" is invalid"),er[un]&&er[un].texture){var wo=Ad[er[un].texture._texture.format]*Sc[er[un].texture._texture.type];si===null?si=wo:G(si===wo,"all color attachments much have the same number of bits per pixel.")}return _t(Jt,bn,Qn),G(!Jt||Jt.texture&&Jt.texture._texture.format===Cl||Jt.renderbuffer&&Jt.renderbuffer._renderbuffer.format===Hh,"invalid depth attachment for framebuffer object"),_t(Gn,bn,Qn),G(!Gn||Gn.renderbuffer&&Gn.renderbuffer._renderbuffer.format===Xh,"invalid stencil attachment for framebuffer object"),_t(jn,bn,Qn),G(!jn||jn.texture&&jn.texture._texture.format===Cd||jn.renderbuffer&&jn.renderbuffer._renderbuffer.format===Cd,"invalid depth-stencil attachment for framebuffer object"),Fe(je),je.width=bn,je.height=Qn,je.colorAttachments=er,je.depthAttachment=Jt,je.stencilAttachment=Gn,je.depthStencilAttachment=jn,Kt.color=er.map(Ae),Kt.depth=Ae(Jt),Kt.stencil=Ae(Gn),Kt.depthStencil=Ae(jn),Kt.width=je.width,Kt.height=je.height,He(je),Kt}function En(kt,Dn){G(xe.next!==je,"can not resize a framebuffer which is currently in use");var un=Math.max(kt|0,1),bn=Math.max(Dn|0||un,1);if(un===je.width&&bn===je.height)return Kt;for(var Qn=je.colorAttachments,Vr=0;Vr<Qn.length;++Vr)rt(Qn[Vr],un,bn);return rt(je.depthAttachment,un,bn),rt(je.stencilAttachment,un,bn),rt(je.depthStencilAttachment,un,bn),je.width=Kt.width=un,je.height=Kt.height=bn,He(je),Kt}return Kt(gt,ct),S(Kt,{resize:En,_reglType:"framebuffer",_framebuffer:je,destroy:function(){pt(je),Fe(je)},use:function(kt){xe.setFBO({framebuffer:Kt},kt)}})}function Wt(gt){var ct=Array(6);function je(En){var kt;G(ct.indexOf(xe.next)<0,"can not update framebuffer which is currently in use");var Dn={color:null},un=0,bn=null,Qn="rgba",Vr="uint8",ii=1;if(typeof En=="number")un=En|0;else if(!En)un=1;else{G.type(En,"object","invalid arguments for framebuffer");var Cn=En;if("shape"in Cn){var Zr=Cn.shape;G(Array.isArray(Zr)&&Zr.length>=2,"invalid shape for framebuffer"),G(Zr[0]===Zr[1],"cube framebuffer must be square"),un=Zr[0]}else"radius"in Cn&&(un=Cn.radius|0),"width"in Cn?(un=Cn.width|0,"height"in Cn&&G(Cn.height===un,"must be square")):"height"in Cn&&(un=Cn.height|0);("color"in Cn||"colors"in Cn)&&(bn=Cn.color||Cn.colors,Array.isArray(bn)&&G(bn.length===1||O.webgl_draw_buffers,"multiple render targets not supported")),bn||("colorCount"in Cn&&(ii=Cn.colorCount|0,G(ii>0,"invalid color buffer count")),"colorType"in Cn&&(G.oneOf(Cn.colorType,nt,"invalid color type"),Vr=Cn.colorType),"colorFormat"in Cn&&(Qn=Cn.colorFormat,G.oneOf(Cn.colorFormat,$e,"invalid color format for texture"))),"depth"in Cn&&(Dn.depth=Cn.depth),"stencil"in Cn&&(Dn.stencil=Cn.stencil),"depthStencil"in Cn&&(Dn.depthStencil=Cn.depthStencil)}var _r;if(bn)if(Array.isArray(bn))for(_r=[],kt=0;kt<bn.length;++kt)_r[kt]=bn[kt];else _r=[bn];else{_r=Array(ii);var Kr={radius:un,format:Qn,type:Vr};for(kt=0;kt<ii;++kt)_r[kt]=ge.createCube(Kr)}for(Dn.color=Array(_r.length),kt=0;kt<_r.length;++kt){var Jr=_r[kt];G(typeof Jr=="function"&&Jr._reglType==="textureCube","invalid cube map"),un=un||Jr.width,G(Jr.width===un&&Jr.height===un,"invalid cube map shape"),Dn.color[kt]={target:xc,data:_r[kt]}}for(kt=0;kt<6;++kt){for(var ai=0;ai<_r.length;++ai)Dn.color[ai].target=xc+kt;kt>0&&(Dn.depth=ct[0].depth,Dn.stencil=ct[0].stencil,Dn.depthStencil=ct[0].depthStencil),ct[kt]?ct[kt](Dn):ct[kt]=st(Dn)}return S(je,{width:un,height:un,color:_r})}function Kt(En){var kt,Dn=En|0;if(G(Dn>0&&Dn<=H.maxCubeMapSize,"invalid radius for cube fbo"),Dn===je.width)return je;var un=je.color;for(kt=0;kt<un.length;++kt)un[kt].resize(Dn);for(kt=0;kt<6;++kt)ct[kt].resize(Dn);return je.width=je.height=Dn,je}return je(gt),S(je,{faces:ct,resize:Kt,_reglType:"framebufferCube",destroy:function(){ct.forEach(function(En){En.destroy()})}})}function cn(){xe.cur=null,xe.next=null,xe.dirty=!0,wr(Ze).forEach(function(gt){gt.framebuffer=T.createFramebuffer(),He(gt)})}return S(xe,{getFramebuffer:function(gt){if(typeof gt=="function"&&gt._reglType==="framebuffer"){var ct=gt._framebuffer;if(ct instanceof At)return ct}return null},create:st,createCube:Wt,clear:function(){wr(Ze).forEach(pt)},restore:cn})}var Ws=5126,Rd=34962;function Mf(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Ws,this.offset=0,this.stride=0,this.divisor=0}function Ha(T,O,H,ge,se){for(var _e=H.maxAttributes,xe=new Array(_e),$e=0;$e<_e;++$e)xe[$e]=new Mf;var et=0,nt={},Ge={Record:Mf,scope:{},state:xe,currentVAO:null,targetVAO:null,restore:_t()?Ze:function(){},createVAO:At,getVAO:lt,destroyBuffer:qe,setVAO:_t()?fe:Ae,clear:_t()?rt:function(){}};function qe(Fe){for(var pt=0;pt<xe.length;++pt){var He=xe[pt];He.buffer===Fe&&(T.disableVertexAttribArray(pt),He.buffer=null)}}function _t(){return O.oes_vertex_array_object}function Je(){return O.angle_instanced_arrays}function lt(Fe){return typeof Fe=="function"&&Fe._vao?Fe._vao:null}function fe(Fe){if(Fe!==Ge.currentVAO){var pt=_t();Fe?pt.bindVertexArrayOES(Fe.vao):pt.bindVertexArrayOES(null),Ge.currentVAO=Fe}}function Ae(Fe){if(Fe!==Ge.currentVAO){if(Fe)Fe.bindAttrs();else for(var pt=Je(),He=0;He<xe.length;++He){var st=xe[He];st.buffer?(T.enableVertexAttribArray(He),T.vertexAttribPointer(He,st.size,st.type,st.normalized,st.stride,st.offfset),pt&&st.divisor&&pt.vertexAttribDivisorANGLE(He,st.divisor)):(T.disableVertexAttribArray(He),T.vertexAttrib4f(He,st.x,st.y,st.z,st.w))}Ge.currentVAO=Fe}}function rt(){wr(nt).forEach(function(Fe){Fe.destroy()})}function Mt(){this.id=++et,this.attributes=[];var Fe=_t();Fe?this.vao=Fe.createVertexArrayOES():this.vao=null,nt[this.id]=this,this.buffers=[]}Mt.prototype.bindAttrs=function(){for(var Fe=Je(),pt=this.attributes,He=0;He<pt.length;++He){var st=pt[He];st.buffer?(T.enableVertexAttribArray(He),T.bindBuffer(Rd,st.buffer.buffer),T.vertexAttribPointer(He,st.size,st.type,st.normalized,st.stride,st.offset),Fe&&st.divisor&&Fe.vertexAttribDivisorANGLE(He,st.divisor)):(T.disableVertexAttribArray(He),T.vertexAttrib4f(He,st.x,st.y,st.z,st.w))}for(var Wt=pt.length;Wt<_e;++Wt)T.disableVertexAttribArray(Wt)},Mt.prototype.refresh=function(){var Fe=_t();Fe&&(Fe.bindVertexArrayOES(this.vao),this.bindAttrs(),Ge.currentVAO=this)},Mt.prototype.destroy=function(){if(this.vao){var Fe=_t();this===Ge.currentVAO&&(Ge.currentVAO=null,Fe.bindVertexArrayOES(null)),Fe.deleteVertexArrayOES(this.vao),this.vao=null}nt[this.id]&&(delete nt[this.id],ge.vaoCount-=1)};function Ze(){var Fe=_t();Fe&&wr(nt).forEach(function(pt){pt.refresh()})}function At(Fe){var pt=new Mt;ge.vaoCount+=1;function He(st){G(Array.isArray(st),"arguments to vertex array constructor must be an array"),G(st.length<_e,"too many attributes"),G(st.length>0,"must specify at least one attribute");var Wt={},cn=pt.attributes;cn.length=st.length;for(var gt=0;gt<st.length;++gt){var ct=st[gt],je=cn[gt]=new Mf,Kt=ct.data||ct;if(Array.isArray(Kt)||I(Kt)||Ar(Kt)){var En;pt.buffers[gt]&&(En=pt.buffers[gt],I(Kt)&&En._buffer.byteLength>=Kt.byteLength?En.subdata(Kt):(En.destroy(),pt.buffers[gt]=null)),pt.buffers[gt]||(En=pt.buffers[gt]=se.create(ct,Rd,!1,!0)),je.buffer=se.getBuffer(En),je.size=je.buffer.dimension|0,je.normalized=!1,je.type=je.buffer.dtype,je.offset=0,je.stride=0,je.divisor=0,je.state=1,Wt[gt]=1}else se.getBuffer(ct)?(je.buffer=se.getBuffer(ct),je.size=je.buffer.dimension|0,je.normalized=!1,je.type=je.buffer.dtype,je.offset=0,je.stride=0,je.divisor=0,je.state=1):se.getBuffer(ct.buffer)?(je.buffer=se.getBuffer(ct.buffer),je.size=(+ct.size||je.buffer.dimension)|0,je.normalized=!!ct.normalized||!1,"type"in ct?(G.parameter(ct.type,Qi,"invalid buffer type"),je.type=Qi[ct.type]):je.type=je.buffer.dtype,je.offset=(ct.offset||0)|0,je.stride=(ct.stride||0)|0,je.divisor=(ct.divisor||0)|0,je.state=1,G(je.size>=1&&je.size<=4,"size must be between 1 and 4"),G(je.offset>=0,"invalid offset"),G(je.stride>=0&&je.stride<=255,"stride must be between 0 and 255"),G(je.divisor>=0,"divisor must be positive"),G(!je.divisor||!!O.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in ct?(G(gt>0,"first attribute must not be a constant"),je.x=+ct.x||0,je.y=+ct.y||0,je.z=+ct.z||0,je.w=+ct.w||0,je.state=2):G(!1,"invalid attribute spec for location "+gt)}for(var kt=0;kt<pt.buffers.length;++kt)!Wt[kt]&&pt.buffers[kt]&&(pt.buffers[kt].destroy(),pt.buffers[kt]=null);return pt.refresh(),He}return He.destroy=function(){for(var st=0;st<pt.buffers.length;++st)pt.buffers[st]&&pt.buffers[st].destroy();pt.buffers.length=0,pt.destroy()},He._vao=pt,He._reglType="vao",He(Fe)}return Ge}var Md=35632,Nd=35633,Jh=35718,qh=35721;function Qh(T,O,H,ge){var se={},_e={};function xe(fe,Ae,rt,Mt){this.name=fe,this.id=Ae,this.location=rt,this.info=Mt}function $e(fe,Ae){for(var rt=0;rt<fe.length;++rt)if(fe[rt].id===Ae.id){fe[rt].location=Ae.location;return}fe.push(Ae)}function et(fe,Ae,rt){var Mt=fe===Md?se:_e,Ze=Mt[Ae];if(!Ze){var At=O.str(Ae);Ze=T.createShader(fe),T.shaderSource(Ze,At),T.compileShader(Ze),G.shaderError(T,Ze,At,fe,rt),Mt[Ae]=Ze}return Ze}var nt={},Ge=[],qe=0;function _t(fe,Ae){this.id=qe++,this.fragId=fe,this.vertId=Ae,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,ge.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Je(fe,Ae,rt){var Mt,Ze,At=et(Md,fe.fragId),Fe=et(Nd,fe.vertId),pt=fe.program=T.createProgram();if(T.attachShader(pt,At),T.attachShader(pt,Fe),rt)for(Mt=0;Mt<rt.length;++Mt){var He=rt[Mt];T.bindAttribLocation(pt,He[0],He[1])}T.linkProgram(pt),G.linkError(T,pt,O.str(fe.fragId),O.str(fe.vertId),Ae);var st=T.getProgramParameter(pt,Jh);ge.profile&&(fe.stats.uniformsCount=st);var Wt=fe.uniforms;for(Mt=0;Mt<st;++Mt)if(Ze=T.getActiveUniform(pt,Mt),Ze)if(Ze.size>1)for(var cn=0;cn<Ze.size;++cn){var gt=Ze.name.replace("[0]","["+cn+"]");$e(Wt,new xe(gt,O.id(gt),T.getUniformLocation(pt,gt),Ze))}else $e(Wt,new xe(Ze.name,O.id(Ze.name),T.getUniformLocation(pt,Ze.name),Ze));var ct=T.getProgramParameter(pt,qh);ge.profile&&(fe.stats.attributesCount=ct);var je=fe.attributes;for(Mt=0;Mt<ct;++Mt)Ze=T.getActiveAttrib(pt,Mt),Ze&&$e(je,new xe(Ze.name,O.id(Ze.name),T.getAttribLocation(pt,Ze.name),Ze))}ge.profile&&(H.getMaxUniformsCount=function(){var fe=0;return Ge.forEach(function(Ae){Ae.stats.uniformsCount>fe&&(fe=Ae.stats.uniformsCount)}),fe},H.getMaxAttributesCount=function(){var fe=0;return Ge.forEach(function(Ae){Ae.stats.attributesCount>fe&&(fe=Ae.stats.attributesCount)}),fe});function lt(){se={},_e={};for(var fe=0;fe<Ge.length;++fe)Je(Ge[fe],null,Ge[fe].attributes.map(function(Ae){return[Ae.location,Ae.name]}))}return{clear:function(){var fe=T.deleteShader.bind(T);wr(se).forEach(fe),se={},wr(_e).forEach(fe),_e={},Ge.forEach(function(Ae){T.deleteProgram(Ae.program)}),Ge.length=0,nt={},H.shaderCount=0},program:function(fe,Ae,rt,Mt){G.command(fe>=0,"missing vertex shader",rt),G.command(Ae>=0,"missing fragment shader",rt);var Ze=nt[Ae];Ze||(Ze=nt[Ae]={});var At=Ze[fe];if(At&&(At.refCount++,!Mt))return At;var Fe=new _t(Ae,fe);return H.shaderCount++,Je(Fe,rt,Mt),At||(Ze[fe]=Fe),Ge.push(Fe),S(Fe,{destroy:function(){if(Fe.refCount--,Fe.refCount<=0){T.deleteProgram(Fe.program);var pt=Ge.indexOf(Fe);Ge.splice(pt,1),H.shaderCount--}Ze[Fe.vertId].refCount<=0&&(T.deleteShader(_e[Fe.vertId]),delete _e[Fe.vertId],delete nt[Fe.fragId][Fe.vertId]),Object.keys(nt[Fe.fragId]).length||(T.deleteShader(se[Fe.fragId]),delete se[Fe.fragId],delete nt[Fe.fragId])}})},restore:lt,shader:et,frag:-1,vert:-1}}var Dd=6408,Vs=5121,Pd=3333,Ou=5126;function Rl(T,O,H,ge,se,_e,xe){function $e(Ge){var qe;O.next===null?(G(se.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),qe=Vs):(G(O.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),qe=O.next.colorAttachments[0].texture._texture.type,_e.oes_texture_float?(G(qe===Vs||qe===Ou,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),qe===Ou&&G(xe.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):G(qe===Vs,"Reading from a framebuffer is only allowed for the type 'uint8'"));var _t=0,Je=0,lt=ge.framebufferWidth,fe=ge.framebufferHeight,Ae=null;I(Ge)?Ae=Ge:Ge&&(G.type(Ge,"object","invalid arguments to regl.read()"),_t=Ge.x|0,Je=Ge.y|0,G(_t>=0&&_t<ge.framebufferWidth,"invalid x offset for regl.read"),G(Je>=0&&Je<ge.framebufferHeight,"invalid y offset for regl.read"),lt=(Ge.width||ge.framebufferWidth-_t)|0,fe=(Ge.height||ge.framebufferHeight-Je)|0,Ae=Ge.data||null),Ae&&(qe===Vs?G(Ae instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):qe===Ou&&G(Ae instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),G(lt>0&&lt+_t<=ge.framebufferWidth,"invalid width for read pixels"),G(fe>0&&fe+Je<=ge.framebufferHeight,"invalid height for read pixels"),H();var rt=lt*fe*4;return Ae||(qe===Vs?Ae=new Uint8Array(rt):qe===Ou&&(Ae=Ae||new Float32Array(rt))),G.isTypedArray(Ae,"data buffer for regl.read() must be a typedarray"),G(Ae.byteLength>=rt,"data buffer for regl.read() too small"),T.pixelStorei(Pd,4),T.readPixels(_t,Je,lt,fe,Dd,qe,Ae),Ae}function et(Ge){var qe;return O.setFBO({framebuffer:Ge.framebuffer},function(){qe=$e(Ge)}),qe}function nt(Ge){return!Ge||!("framebuffer"in Ge)?$e(Ge):et(Ge)}return nt}function po(T){return Array.prototype.slice.call(T)}function mo(T){return po(T).join("")}function Od(){var T=0,O=[],H=[];function ge(qe){for(var _t=0;_t<H.length;++_t)if(H[_t]===qe)return O[_t];var Je="g"+T++;return O.push(Je),H.push(qe),Je}function se(){var qe=[];function _t(){qe.push.apply(qe,po(arguments))}var Je=[];function lt(){var fe="v"+T++;return Je.push(fe),arguments.length>0&&(qe.push(fe,"="),qe.push.apply(qe,po(arguments)),qe.push(";")),fe}return S(_t,{def:lt,toString:function(){return mo([Je.length>0?"var "+Je.join(",")+";":"",mo(qe)])}})}function _e(){var qe=se(),_t=se(),Je=qe.toString,lt=_t.toString;function fe(Ae,rt){_t(Ae,rt,"=",qe.def(Ae,rt),";")}return S(function(){qe.apply(qe,po(arguments))},{def:qe.def,entry:qe,exit:_t,save:fe,set:function(Ae,rt,Mt){fe(Ae,rt),qe(Ae,rt,"=",Mt,";")},toString:function(){return Je()+lt()}})}function xe(){var qe=mo(arguments),_t=_e(),Je=_e(),lt=_t.toString,fe=Je.toString;return S(_t,{then:function(){return _t.apply(_t,po(arguments)),this},else:function(){return Je.apply(Je,po(arguments)),this},toString:function(){var Ae=fe();return Ae&&(Ae="else{"+Ae+"}"),mo(["if(",qe,"){",lt(),"}",Ae])}})}var $e=se(),et={};function nt(qe,_t){var Je=[];function lt(){var Ze="a"+Je.length;return Je.push(Ze),Ze}_t=_t||0;for(var fe=0;fe<_t;++fe)lt();var Ae=_e(),rt=Ae.toString,Mt=et[qe]=S(Ae,{arg:lt,toString:function(){return mo(["function(",Je.join(),"){",rt(),"}"])}});return Mt}function Ge(){var qe=['"use strict";',$e,"return {"];Object.keys(et).forEach(function(lt){qe.push('"',lt,'":',et[lt].toString(),",")}),qe.push("}");var _t=mo(qe).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Je=Function.apply(null,O.concat(_t));return Je.apply(null,H)}return{global:$e,link:ge,block:se,proc:nt,scope:_e,cond:xe,compile:Ge}}var Zs="xyzw".split(""),Ml=5121,da=1,Lu=2,go=0,ha=1,Nf=2,Tc=3,Gu=4,Ac=5,Wo=6,Nl="dither",Ld="blend.enable",Ic="blend.color",Gd="blend.equation",Df="blend.func",zi="depth.enable",Pf="depth.func",Dl="depth.range",Xa="depth.mask",Cc="colorMask",Rc="cull.enable",bs="cull.face",Of="frontFace",Mi="lineWidth",Lf="polygonOffset.enable",Pl="polygonOffset.offset",kd="sample.alpha",Fd="sample.enable",js="sample.coverage",Ud="stencil.enable",ku="stencil.mask",Gf="stencil.func",Ol="stencil.opFront",Mc="stencil.opBack",Fu="scissor.enable",kf="scissor.box",Vo="viewport",Hs="profile",ws="framebuffer",Nc="vert",Dc="frag",Xs="elements",yo="primitive",$a="count",Ff="offset",Uu="instances",xs="vao",$s="Width",Ys="Height",_o=ws+$s,Ya=ws+Ys,Bd=Vo+$s,Xi=Vo+Ys,Ks="drawingBuffer",Js=Ks+$s,Pc=Ks+Ys,Bu=[Df,Gd,Gf,Ol,Mc,js,Vo,kf,Pl],Zo=34962,Ll=34963,zu=35632,Wu=35633,Zn=3553,ev=34067,tv=2884,Oc=3042,zd=3024,Vu=2960,Uf=2929,Oa=3089,nv=32823,Bf=32926,Gl=32928,Lc=5126,Gc=35664,Fr=35665,di=35666,Zu=5124,kc=35667,qs=35668,jo=35669,Fc=35670,Uc=35671,ju=35672,Qs=35673,Ni=35674,Oi=35675,xa=35676,Eo=35678,Ss=35680,Bc=4,zc=1028,eu=1029,Ts=2304,zf=2305,Wd=32775,rv=32776,Vd=519,Ho=7680,ra=0,Ka=1,Zd=32774,tu=513,Xo=36160,bo=36064,Ja={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},kl=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Hu={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},$o={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},nu={frag:zu,vert:Wu},ru={cw:Ts,ccw:zf};function Wf(T){return Array.isArray(T)||I(T)||Ar(T)}function As(T){return T.sort(function(O,H){return O===Vo?-1:H===Vo?1:O<H?-1:1})}function Wi(T,O,H,ge){this.thisDep=T,this.contextDep=O,this.propDep=H,this.append=ge}function qa(T){return T&&!(T.thisDep||T.contextDep||T.propDep)}function ri(T){return new Wi(!1,!1,!1,T)}function wi(T,O){var H=T.type;if(H===go){var ge=T.data.length;return new Wi(!0,ge>=1,ge>=2,O)}else if(H===Gu){var se=T.data;return new Wi(se.thisDep,se.contextDep,se.propDep,O)}else{if(H===Ac)return new Wi(!1,!1,!1,O);if(H===Wo){for(var _e=!1,xe=!1,$e=!1,et=0;et<T.data.length;++et){var nt=T.data[et];if(nt.type===ha)$e=!0;else if(nt.type===Nf)xe=!0;else if(nt.type===Tc)_e=!0;else if(nt.type===go){_e=!0;var Ge=nt.data;Ge>=1&&(xe=!0),Ge>=2&&($e=!0)}else nt.type===Gu&&(_e=_e||nt.data.thisDep,xe=xe||nt.data.contextDep,$e=$e||nt.data.propDep)}return new Wi(_e,xe,$e,O)}else return new Wi(H===Tc,H===Nf,H===ha,O)}}var Vf=new Wi(!1,!1,!1,function(){});function Zf(T,O,H,ge,se,_e,xe,$e,et,nt,Ge,qe,_t,Je,lt){var fe=nt.Record,Ae={add:32774,subtract:32778,"reverse subtract":32779};H.ext_blend_minmax&&(Ae.min=Wd,Ae.max=rv);var rt=H.angle_instanced_arrays,Mt=H.webgl_draw_buffers,Ze={dirty:!0,profile:lt.profile},At={},Fe=[],pt={},He={};function st(F){return F.replace(".","_")}function Wt(F,D,Y){var ce=st(F);Fe.push(F),At[ce]=Ze[ce]=!!Y,pt[ce]=D}function cn(F,D,Y){var ce=st(F);Fe.push(F),Array.isArray(Y)?(Ze[ce]=Y.slice(),At[ce]=Y.slice()):Ze[ce]=At[ce]=Y,He[ce]=D}Wt(Nl,zd),Wt(Ld,Oc),cn(Ic,"blendColor",[0,0,0,0]),cn(Gd,"blendEquationSeparate",[Zd,Zd]),cn(Df,"blendFuncSeparate",[Ka,ra,Ka,ra]),Wt(zi,Uf,!0),cn(Pf,"depthFunc",tu),cn(Dl,"depthRange",[0,1]),cn(Xa,"depthMask",!0),cn(Cc,Cc,[!0,!0,!0,!0]),Wt(Rc,tv),cn(bs,"cullFace",eu),cn(Of,Of,zf),cn(Mi,Mi,1),Wt(Lf,nv),cn(Pl,"polygonOffset",[0,0]),Wt(kd,Bf),Wt(Fd,Gl),cn(js,"sampleCoverage",[1,!1]),Wt(Ud,Vu),cn(ku,"stencilMask",-1),cn(Gf,"stencilFunc",[Vd,0,-1]),cn(Ol,"stencilOpSeparate",[zc,Ho,Ho,Ho]),cn(Mc,"stencilOpSeparate",[eu,Ho,Ho,Ho]),Wt(Fu,Oa),cn(kf,"scissor",[0,0,T.drawingBufferWidth,T.drawingBufferHeight]),cn(Vo,Vo,[0,0,T.drawingBufferWidth,T.drawingBufferHeight]);var gt={gl:T,context:_t,strings:O,next:At,current:Ze,draw:qe,elements:_e,buffer:se,shader:Ge,attributes:nt.state,vao:nt,uniforms:et,framebuffer:$e,extensions:H,timer:Je,isBufferArgs:Wf},ct={primTypes:la,compareFuncs:Hu,blendFuncs:Ja,blendEquations:Ae,stencilOps:$o,glTypes:Qi,orientationType:ru};G.optional(function(){gt.isArrayLike=Mr}),Mt&&(ct.backBuffer=[eu],ct.drawBuffer=Ai(ge.maxDrawbuffers,function(F){return F===0?[0]:Ai(F,function(D){return bo+D})}));var je=0;function Kt(){var F=Od(),D=F.link,Y=F.global;F.id=je++,F.batchId="0";var ce=D(gt),le=F.shared={props:"a0"};Object.keys(gt).forEach(function($){le[$]=Y.def(ce,".",$)}),G.optional(function(){F.CHECK=D(G),F.commandStr=G.guessCommand(),F.command=D(F.commandStr),F.assert=function($,L,ae){$("if(!(",L,"))",this.CHECK,".commandRaise(",D(ae),",",this.command,");")},ct.invalidBlendCombinations=kl});var te=F.next={},K=F.current={};Object.keys(He).forEach(function($){Array.isArray(Ze[$])&&(te[$]=Y.def(le.next,".",$),K[$]=Y.def(le.current,".",$))});var oe=F.constants={};Object.keys(ct).forEach(function($){oe[$]=Y.def(JSON.stringify(ct[$]))}),F.invoke=function($,L){switch(L.type){case go:var ae=["this",le.context,le.props,F.batchId];return $.def(D(L.data),".call(",ae.slice(0,Math.max(L.data.length+1,4)),")");case ha:return $.def(le.props,L.data);case Nf:return $.def(le.context,L.data);case Tc:return $.def("this",L.data);case Gu:return L.data.append(F,$),L.data.ref;case Ac:return L.data.toString();case Wo:return L.data.map(function(pe){return F.invoke($,pe)})}},F.attribCache={};var U={};return F.scopeAttrib=function($){var L=O.id($);if(L in U)return U[L];var ae=nt.scope[L];ae||(ae=nt.scope[L]=new fe);var pe=U[L]=D(ae);return pe},F}function En(F){var D=F.static,Y=F.dynamic,ce;if(Hs in D){var le=!!D[Hs];ce=ri(function(K,oe){return le}),ce.enable=le}else if(Hs in Y){var te=Y[Hs];ce=wi(te,function(K,oe){return K.invoke(oe,te)})}return ce}function kt(F,D){var Y=F.static,ce=F.dynamic;if(ws in Y){var le=Y[ws];return le?(le=$e.getFramebuffer(le),G.command(le,"invalid framebuffer object"),ri(function(K,oe){var U=K.link(le),$=K.shared;oe.set($.framebuffer,".next",U);var L=$.context;return oe.set(L,"."+_o,U+".width"),oe.set(L,"."+Ya,U+".height"),U})):ri(function(K,oe){var U=K.shared;oe.set(U.framebuffer,".next","null");var $=U.context;return oe.set($,"."+_o,$+"."+Js),oe.set($,"."+Ya,$+"."+Pc),"null"})}else if(ws in ce){var te=ce[ws];return wi(te,function(K,oe){var U=K.invoke(oe,te),$=K.shared,L=$.framebuffer,ae=oe.def(L,".getFramebuffer(",U,")");G.optional(function(){K.assert(oe,"!"+U+"||"+ae,"invalid framebuffer object")}),oe.set(L,".next",ae);var pe=$.context;return oe.set(pe,"."+_o,ae+"?"+ae+".width:"+pe+"."+Js),oe.set(pe,"."+Ya,ae+"?"+ae+".height:"+pe+"."+Pc),ae})}else return null}function Dn(F,D,Y){var ce=F.static,le=F.dynamic;function te(U){if(U in ce){var $=ce[U];G.commandType($,"object","invalid "+U,Y.commandStr);var L=!0,ae=$.x|0,pe=$.y|0,Le,Be;return"width"in $?(Le=$.width|0,G.command(Le>=0,"invalid "+U,Y.commandStr)):L=!1,"height"in $?(Be=$.height|0,G.command(Be>=0,"invalid "+U,Y.commandStr)):L=!1,new Wi(!L&&D&&D.thisDep,!L&&D&&D.contextDep,!L&&D&&D.propDep,function(It,yn){var Ft=It.shared.context,$t=Le;"width"in $||($t=yn.def(Ft,".",_o,"-",ae));var fn=Be;return"height"in $||(fn=yn.def(Ft,".",Ya,"-",pe)),[ae,pe,$t,fn]})}else if(U in le){var Me=le[U],it=wi(Me,function(It,yn){var Ft=It.invoke(yn,Me);G.optional(function(){It.assert(yn,Ft+"&&typeof "+Ft+'==="object"',"invalid "+U)});var $t=It.shared.context,fn=yn.def(Ft,".x|0"),Hn=yn.def(Ft,".y|0"),Nr=yn.def('"width" in ',Ft,"?",Ft,".width|0:","(",$t,".",_o,"-",fn,")"),hi=yn.def('"height" in ',Ft,"?",Ft,".height|0:","(",$t,".",Ya,"-",Hn,")");return G.optional(function(){It.assert(yn,Nr+">=0&&"+hi+">=0","invalid "+U)}),[fn,Hn,Nr,hi]});return D&&(it.thisDep=it.thisDep||D.thisDep,it.contextDep=it.contextDep||D.contextDep,it.propDep=it.propDep||D.propDep),it}else return D?new Wi(D.thisDep,D.contextDep,D.propDep,function(It,yn){var Ft=It.shared.context;return[0,0,yn.def(Ft,".",_o),yn.def(Ft,".",Ya)]}):null}var K=te(Vo);if(K){var oe=K;K=new Wi(K.thisDep,K.contextDep,K.propDep,function(U,$){var L=oe.append(U,$),ae=U.shared.context;return $.set(ae,"."+Bd,L[2]),$.set(ae,"."+Xi,L[3]),L})}return{viewport:K,scissor_box:te(kf)}}function un(F,D){var Y=F.static,ce=typeof Y[Dc]=="string"&&typeof Y[Nc]=="string";if(ce){if(Object.keys(D.dynamic).length>0)return null;var le=D.static,te=Object.keys(le);if(te.length>0&&typeof le[te[0]]=="number"){for(var K=[],oe=0;oe<te.length;++oe)G(typeof le[te[oe]]=="number","must specify all vertex attribute locations when using vaos"),K.push([le[te[oe]]|0,te[oe]]);return K}}return null}function bn(F,D,Y){var ce=F.static,le=F.dynamic;function te(L){if(L in ce){var ae=O.id(ce[L]);G.optional(function(){Ge.shader(nu[L],ae,G.guessCommand())});var pe=ri(function(){return ae});return pe.id=ae,pe}else if(L in le){var Le=le[L];return wi(Le,function(Be,Me){var it=Be.invoke(Me,Le),It=Me.def(Be.shared.strings,".id(",it,")");return G.optional(function(){Me(Be.shared.shader,".shader(",nu[L],",",It,",",Be.command,");")}),It})}return null}var K=te(Dc),oe=te(Nc),U=null,$;return qa(K)&&qa(oe)?(U=Ge.program(oe.id,K.id,null,Y),$=ri(function(L,ae){return L.link(U)})):$=new Wi(K&&K.thisDep||oe&&oe.thisDep,K&&K.contextDep||oe&&oe.contextDep,K&&K.propDep||oe&&oe.propDep,function(L,ae){var pe=L.shared.shader,Le;K?Le=K.append(L,ae):Le=ae.def(pe,".",Dc);var Be;oe?Be=oe.append(L,ae):Be=ae.def(pe,".",Nc);var Me=pe+".program("+Be+","+Le;return G.optional(function(){Me+=","+L.command}),ae.def(Me+")")}),{frag:K,vert:oe,progVar:$,program:U}}function Qn(F,D){var Y=F.static,ce=F.dynamic;function le(){if(Xs in Y){var L=Y[Xs];Wf(L)?L=_e.getElements(_e.create(L,!0)):L&&(L=_e.getElements(L),G.command(L,"invalid elements",D.commandStr));var ae=ri(function(Le,Be){if(L){var Me=Le.link(L);return Le.ELEMENTS=Me,Me}return Le.ELEMENTS=null,null});return ae.value=L,ae}else if(Xs in ce){var pe=ce[Xs];return wi(pe,function(Le,Be){var Me=Le.shared,it=Me.isBufferArgs,It=Me.elements,yn=Le.invoke(Be,pe),Ft=Be.def("null"),$t=Be.def(it,"(",yn,")"),fn=Le.cond($t).then(Ft,"=",It,".createStream(",yn,");").else(Ft,"=",It,".getElements(",yn,");");return G.optional(function(){Le.assert(fn.else,"!"+yn+"||"+Ft,"invalid elements")}),Be.entry(fn),Be.exit(Le.cond($t).then(It,".destroyStream(",Ft,");")),Le.ELEMENTS=Ft,Ft})}return null}var te=le();function K(){if(yo in Y){var L=Y[yo];return G.commandParameter(L,la,"invalid primitve",D.commandStr),ri(function(pe,Le){return la[L]})}else if(yo in ce){var ae=ce[yo];return wi(ae,function(pe,Le){var Be=pe.constants.primTypes,Me=pe.invoke(Le,ae);return G.optional(function(){pe.assert(Le,Me+" in "+Be,"invalid primitive, must be one of "+Object.keys(la))}),Le.def(Be,"[",Me,"]")})}else if(te)return qa(te)?te.value?ri(function(pe,Le){return Le.def(pe.ELEMENTS,".primType")}):ri(function(){return Bc}):new Wi(te.thisDep,te.contextDep,te.propDep,function(pe,Le){var Be=pe.ELEMENTS;return Le.def(Be,"?",Be,".primType:",Bc)});return null}function oe(L,ae){if(L in Y){var pe=Y[L]|0;return G.command(!ae||pe>=0,"invalid "+L,D.commandStr),ri(function(Be,Me){return ae&&(Be.OFFSET=pe),pe})}else if(L in ce){var Le=ce[L];return wi(Le,function(Be,Me){var it=Be.invoke(Me,Le);return ae&&(Be.OFFSET=it,G.optional(function(){Be.assert(Me,it+">=0","invalid "+L)})),it})}else if(ae&&te)return ri(function(Be,Me){return Be.OFFSET="0",0});return null}var U=oe(Ff,!0);function $(){if($a in Y){var L=Y[$a]|0;return G.command(typeof L=="number"&&L>=0,"invalid vertex count",D.commandStr),ri(function(){return L})}else if($a in ce){var ae=ce[$a];return wi(ae,function(Be,Me){var it=Be.invoke(Me,ae);return G.optional(function(){Be.assert(Me,"typeof "+it+'==="number"&&'+it+">=0&&"+it+"===("+it+"|0)","invalid vertex count")}),it})}else if(te)if(qa(te)){if(te)return U?new Wi(U.thisDep,U.contextDep,U.propDep,function(Be,Me){var it=Me.def(Be.ELEMENTS,".vertCount-",Be.OFFSET);return G.optional(function(){Be.assert(Me,it+">=0","invalid vertex offset/element buffer too small")}),it}):ri(function(Be,Me){return Me.def(Be.ELEMENTS,".vertCount")});var pe=ri(function(){return-1});return G.optional(function(){pe.MISSING=!0}),pe}else{var Le=new Wi(te.thisDep||U.thisDep,te.contextDep||U.contextDep,te.propDep||U.propDep,function(Be,Me){var it=Be.ELEMENTS;return Be.OFFSET?Me.def(it,"?",it,".vertCount-",Be.OFFSET,":-1"):Me.def(it,"?",it,".vertCount:-1")});return G.optional(function(){Le.DYNAMIC=!0}),Le}return null}return{elements:te,primitive:K(),count:$(),instances:oe(Uu,!1),offset:U}}function Vr(F,D){var Y=F.static,ce=F.dynamic,le={};return Fe.forEach(function(te){var K=st(te);function oe(U,$){if(te in Y){var L=U(Y[te]);le[K]=ri(function(){return L})}else if(te in ce){var ae=ce[te];le[K]=wi(ae,function(pe,Le){return $(pe,Le,pe.invoke(Le,ae))})}}switch(te){case Rc:case Ld:case Nl:case Ud:case zi:case Fu:case Lf:case kd:case Fd:case Xa:return oe(function(U){return G.commandType(U,"boolean",te,D.commandStr),U},function(U,$,L){return G.optional(function(){U.assert($,"typeof "+L+'==="boolean"',"invalid flag "+te,U.commandStr)}),L});case Pf:return oe(function(U){return G.commandParameter(U,Hu,"invalid "+te,D.commandStr),Hu[U]},function(U,$,L){var ae=U.constants.compareFuncs;return G.optional(function(){U.assert($,L+" in "+ae,"invalid "+te+", must be one of "+Object.keys(Hu))}),$.def(ae,"[",L,"]")});case Dl:return oe(function(U){return G.command(Mr(U)&&U.length===2&&typeof U[0]=="number"&&typeof U[1]=="number"&&U[0]<=U[1],"depth range is 2d array",D.commandStr),U},function(U,$,L){G.optional(function(){U.assert($,U.shared.isArrayLike+"("+L+")&&"+L+".length===2&&typeof "+L+'[0]==="number"&&typeof '+L+'[1]==="number"&&'+L+"[0]<="+L+"[1]","depth range must be a 2d array")});var ae=$.def("+",L,"[0]"),pe=$.def("+",L,"[1]");return[ae,pe]});case Df:return oe(function(U){G.commandType(U,"object","blend.func",D.commandStr);var $="srcRGB"in U?U.srcRGB:U.src,L="srcAlpha"in U?U.srcAlpha:U.src,ae="dstRGB"in U?U.dstRGB:U.dst,pe="dstAlpha"in U?U.dstAlpha:U.dst;return G.commandParameter($,Ja,K+".srcRGB",D.commandStr),G.commandParameter(L,Ja,K+".srcAlpha",D.commandStr),G.commandParameter(ae,Ja,K+".dstRGB",D.commandStr),G.commandParameter(pe,Ja,K+".dstAlpha",D.commandStr),G.command(kl.indexOf($+", "+ae)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+$+", "+ae+")",D.commandStr),[Ja[$],Ja[ae],Ja[L],Ja[pe]]},function(U,$,L){var ae=U.constants.blendFuncs;G.optional(function(){U.assert($,L+"&&typeof "+L+'==="object"',"invalid blend func, must be an object")});function pe(Ft,$t){var fn=$.def('"',Ft,$t,'" in ',L,"?",L,".",Ft,$t,":",L,".",Ft);return G.optional(function(){U.assert($,fn+" in "+ae,"invalid "+te+"."+Ft+$t+", must be one of "+Object.keys(Ja))}),fn}var Le=pe("src","RGB"),Be=pe("dst","RGB");G.optional(function(){var Ft=U.constants.invalidBlendCombinations;U.assert($,Ft+".indexOf("+Le+'+", "+'+Be+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var Me=$.def(ae,"[",Le,"]"),it=$.def(ae,"[",pe("src","Alpha"),"]"),It=$.def(ae,"[",Be,"]"),yn=$.def(ae,"[",pe("dst","Alpha"),"]");return[Me,It,it,yn]});case Gd:return oe(function(U){if(typeof U=="string")return G.commandParameter(U,Ae,"invalid "+te,D.commandStr),[Ae[U],Ae[U]];if(typeof U=="object")return G.commandParameter(U.rgb,Ae,te+".rgb",D.commandStr),G.commandParameter(U.alpha,Ae,te+".alpha",D.commandStr),[Ae[U.rgb],Ae[U.alpha]];G.commandRaise("invalid blend.equation",D.commandStr)},function(U,$,L){var ae=U.constants.blendEquations,pe=$.def(),Le=$.def(),Be=U.cond("typeof ",L,'==="string"');return G.optional(function(){function Me(it,It,yn){U.assert(it,yn+" in "+ae,"invalid "+It+", must be one of "+Object.keys(Ae))}Me(Be.then,te,L),U.assert(Be.else,L+"&&typeof "+L+'==="object"',"invalid "+te),Me(Be.else,te+".rgb",L+".rgb"),Me(Be.else,te+".alpha",L+".alpha")}),Be.then(pe,"=",Le,"=",ae,"[",L,"];"),Be.else(pe,"=",ae,"[",L,".rgb];",Le,"=",ae,"[",L,".alpha];"),$(Be),[pe,Le]});case Ic:return oe(function(U){return G.command(Mr(U)&&U.length===4,"blend.color must be a 4d array",D.commandStr),Ai(4,function($){return+U[$]})},function(U,$,L){return G.optional(function(){U.assert($,U.shared.isArrayLike+"("+L+")&&"+L+".length===4","blend.color must be a 4d array")}),Ai(4,function(ae){return $.def("+",L,"[",ae,"]")})});case ku:return oe(function(U){return G.commandType(U,"number",K,D.commandStr),U|0},function(U,$,L){return G.optional(function(){U.assert($,"typeof "+L+'==="number"',"invalid stencil.mask")}),$.def(L,"|0")});case Gf:return oe(function(U){G.commandType(U,"object",K,D.commandStr);var $=U.cmp||"keep",L=U.ref||0,ae="mask"in U?U.mask:-1;return G.commandParameter($,Hu,te+".cmp",D.commandStr),G.commandType(L,"number",te+".ref",D.commandStr),G.commandType(ae,"number",te+".mask",D.commandStr),[Hu[$],L,ae]},function(U,$,L){var ae=U.constants.compareFuncs;G.optional(function(){function Me(){U.assert($,Array.prototype.join.call(arguments,""),"invalid stencil.func")}Me(L+"&&typeof ",L,'==="object"'),Me('!("cmp" in ',L,")||(",L,".cmp in ",ae,")")});var pe=$.def('"cmp" in ',L,"?",ae,"[",L,".cmp]",":",Ho),Le=$.def(L,".ref|0"),Be=$.def('"mask" in ',L,"?",L,".mask|0:-1");return[pe,Le,Be]});case Ol:case Mc:return oe(function(U){G.commandType(U,"object",K,D.commandStr);var $=U.fail||"keep",L=U.zfail||"keep",ae=U.zpass||"keep";return G.commandParameter($,$o,te+".fail",D.commandStr),G.commandParameter(L,$o,te+".zfail",D.commandStr),G.commandParameter(ae,$o,te+".zpass",D.commandStr),[te===Mc?eu:zc,$o[$],$o[L],$o[ae]]},function(U,$,L){var ae=U.constants.stencilOps;G.optional(function(){U.assert($,L+"&&typeof "+L+'==="object"',"invalid "+te)});function pe(Le){return G.optional(function(){U.assert($,'!("'+Le+'" in '+L+")||("+L+"."+Le+" in "+ae+")","invalid "+te+"."+Le+", must be one of "+Object.keys($o))}),$.def('"',Le,'" in ',L,"?",ae,"[",L,".",Le,"]:",Ho)}return[te===Mc?eu:zc,pe("fail"),pe("zfail"),pe("zpass")]});case Pl:return oe(function(U){G.commandType(U,"object",K,D.commandStr);var $=U.factor|0,L=U.units|0;return G.commandType($,"number",K+".factor",D.commandStr),G.commandType(L,"number",K+".units",D.commandStr),[$,L]},function(U,$,L){G.optional(function(){U.assert($,L+"&&typeof "+L+'==="object"',"invalid "+te)});var ae=$.def(L,".factor|0"),pe=$.def(L,".units|0");return[ae,pe]});case bs:return oe(function(U){var $=0;return U==="front"?$=zc:U==="back"&&($=eu),G.command(!!$,K,D.commandStr),$},function(U,$,L){return G.optional(function(){U.assert($,L+'==="front"||'+L+'==="back"',"invalid cull.face")}),$.def(L,'==="front"?',zc,":",eu)});case Mi:return oe(function(U){return G.command(typeof U=="number"&&U>=ge.lineWidthDims[0]&&U<=ge.lineWidthDims[1],"invalid line width, must be a positive number between "+ge.lineWidthDims[0]+" and "+ge.lineWidthDims[1],D.commandStr),U},function(U,$,L){return G.optional(function(){U.assert($,"typeof "+L+'==="number"&&'+L+">="+ge.lineWidthDims[0]+"&&"+L+"<="+ge.lineWidthDims[1],"invalid line width")}),L});case Of:return oe(function(U){return G.commandParameter(U,ru,K,D.commandStr),ru[U]},function(U,$,L){return G.optional(function(){U.assert($,L+'==="cw"||'+L+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),$.def(L+'==="cw"?'+Ts+":"+zf)});case Cc:return oe(function(U){return G.command(Mr(U)&&U.length===4,"color.mask must be length 4 array",D.commandStr),U.map(function($){return!!$})},function(U,$,L){return G.optional(function(){U.assert($,U.shared.isArrayLike+"("+L+")&&"+L+".length===4","invalid color.mask")}),Ai(4,function(ae){return"!!"+L+"["+ae+"]"})});case js:return oe(function(U){G.command(typeof U=="object"&&U,K,D.commandStr);var $="value"in U?U.value:1,L=!!U.invert;return G.command(typeof $=="number"&&$>=0&&$<=1,"sample.coverage.value must be a number between 0 and 1",D.commandStr),[$,L]},function(U,$,L){G.optional(function(){U.assert($,L+"&&typeof "+L+'==="object"',"invalid sample.coverage")});var ae=$.def('"value" in ',L,"?+",L,".value:1"),pe=$.def("!!",L,".invert");return[ae,pe]})}}),le}function ii(F,D){var Y=F.static,ce=F.dynamic,le={};return Object.keys(Y).forEach(function(te){var K=Y[te],oe;if(typeof K=="number"||typeof K=="boolean")oe=ri(function(){return K});else if(typeof K=="function"){var U=K._reglType;U==="texture2d"||U==="textureCube"?oe=ri(function($){return $.link(K)}):U==="framebuffer"||U==="framebufferCube"?(G.command(K.color.length>0,'missing color attachment for framebuffer sent to uniform "'+te+'"',D.commandStr),oe=ri(function($){return $.link(K.color[0])})):G.commandRaise('invalid data for uniform "'+te+'"',D.commandStr)}else Mr(K)?oe=ri(function($){var L=$.global.def("[",Ai(K.length,function(ae){return G.command(typeof K[ae]=="number"||typeof K[ae]=="boolean","invalid uniform "+te,$.commandStr),K[ae]}),"]");return L}):G.commandRaise('invalid or missing data for uniform "'+te+'"',D.commandStr);oe.value=K,le[te]=oe}),Object.keys(ce).forEach(function(te){var K=ce[te];le[te]=wi(K,function(oe,U){return oe.invoke(U,K)})}),le}function Cn(F,D){var Y=F.static,ce=F.dynamic,le={};return Object.keys(Y).forEach(function(te){var K=Y[te],oe=O.id(te),U=new fe;if(Wf(K))U.state=da,U.buffer=se.getBuffer(se.create(K,Zo,!1,!0)),U.type=0;else{var $=se.getBuffer(K);if($)U.state=da,U.buffer=$,U.type=0;else if(G.command(typeof K=="object"&&K,"invalid data for attribute "+te,D.commandStr),"constant"in K){var L=K.constant;U.buffer="null",U.state=Lu,typeof L=="number"?U.x=L:(G.command(Mr(L)&&L.length>0&&L.length<=4,"invalid constant for attribute "+te,D.commandStr),Zs.forEach(function(It,yn){yn<L.length&&(U[It]=L[yn])}))}else{Wf(K.buffer)?$=se.getBuffer(se.create(K.buffer,Zo,!1,!0)):$=se.getBuffer(K.buffer),G.command(!!$,'missing buffer for attribute "'+te+'"',D.commandStr);var ae=K.offset|0;G.command(ae>=0,'invalid offset for attribute "'+te+'"',D.commandStr);var pe=K.stride|0;G.command(pe>=0&&pe<256,'invalid stride for attribute "'+te+'", must be integer betweeen [0, 255]',D.commandStr);var Le=K.size|0;G.command(!("size"in K)||Le>0&&Le<=4,'invalid size for attribute "'+te+'", must be 1,2,3,4',D.commandStr);var Be=!!K.normalized,Me=0;"type"in K&&(G.commandParameter(K.type,Qi,"invalid type for attribute "+te,D.commandStr),Me=Qi[K.type]);var it=K.divisor|0;"divisor"in K&&(G.command(it===0||rt,'cannot specify divisor for attribute "'+te+'", instancing not supported',D.commandStr),G.command(it>=0,'invalid divisor for attribute "'+te+'"',D.commandStr)),G.optional(function(){var It=D.commandStr,yn=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(K).forEach(function(Ft){G.command(yn.indexOf(Ft)>=0,'unknown parameter "'+Ft+'" for attribute pointer "'+te+'" (valid parameters are '+yn+")",It)})}),U.buffer=$,U.state=da,U.size=Le,U.normalized=Be,U.type=Me||$.dtype,U.offset=ae,U.stride=pe,U.divisor=it}}le[te]=ri(function(It,yn){var Ft=It.attribCache;if(oe in Ft)return Ft[oe];var $t={isStream:!1};return Object.keys(U).forEach(function(fn){$t[fn]=U[fn]}),U.buffer&&($t.buffer=It.link(U.buffer),$t.type=$t.type||$t.buffer+".dtype"),Ft[oe]=$t,$t})}),Object.keys(ce).forEach(function(te){var K=ce[te];function oe(U,$){var L=U.invoke($,K),ae=U.shared,pe=U.constants,Le=ae.isBufferArgs,Be=ae.buffer;G.optional(function(){U.assert($,L+"&&(typeof "+L+'==="object"||typeof '+L+'==="function")&&('+Le+"("+L+")||"+Be+".getBuffer("+L+")||"+Be+".getBuffer("+L+".buffer)||"+Le+"("+L+'.buffer)||("constant" in '+L+"&&(typeof "+L+'.constant==="number"||'+ae.isArrayLike+"("+L+".constant))))",'invalid dynamic attribute "'+te+'"')});var Me={isStream:$.def(!1)},it=new fe;it.state=da,Object.keys(it).forEach(function($t){Me[$t]=$.def(""+it[$t])});var It=Me.buffer,yn=Me.type;$("if(",Le,"(",L,")){",Me.isStream,"=true;",It,"=",Be,".createStream(",Zo,",",L,");",yn,"=",It,".dtype;","}else{",It,"=",Be,".getBuffer(",L,");","if(",It,"){",yn,"=",It,".dtype;",'}else if("constant" in ',L,"){",Me.state,"=",Lu,";","if(typeof "+L+'.constant === "number"){',Me[Zs[0]],"=",L,".constant;",Zs.slice(1).map(function($t){return Me[$t]}).join("="),"=0;","}else{",Zs.map(function($t,fn){return Me[$t]+"="+L+".constant.length>"+fn+"?"+L+".constant["+fn+"]:0;"}).join(""),"}}else{","if(",Le,"(",L,".buffer)){",It,"=",Be,".createStream(",Zo,",",L,".buffer);","}else{",It,"=",Be,".getBuffer(",L,".buffer);","}",yn,'="type" in ',L,"?",pe.glTypes,"[",L,".type]:",It,".dtype;",Me.normalized,"=!!",L,".normalized;");function Ft($t){$(Me[$t],"=",L,".",$t,"|0;")}return Ft("size"),Ft("offset"),Ft("stride"),Ft("divisor"),$("}}"),$.exit("if(",Me.isStream,"){",Be,".destroyStream(",It,");","}"),Me}le[te]=wi(K,oe)}),le}function Zr(F,D){var Y=F.static,ce=F.dynamic;if(xs in Y){var le=Y[xs];return le!==null&&nt.getVAO(le)===null&&(le=nt.createVAO(le)),ri(function(K){return K.link(nt.getVAO(le))})}else if(xs in ce){var te=ce[xs];return wi(te,function(K,oe){var U=K.invoke(oe,te);return oe.def(K.shared.vao+".getVAO("+U+")")})}return null}function _r(F){var D=F.static,Y=F.dynamic,ce={};return Object.keys(D).forEach(function(le){var te=D[le];ce[le]=ri(function(K,oe){return typeof te=="number"||typeof te=="boolean"?""+te:K.link(te)})}),Object.keys(Y).forEach(function(le){var te=Y[le];ce[le]=wi(te,function(K,oe){return K.invoke(oe,te)})}),ce}function Kr(F,D,Y,ce,le){var te=F.static,K=F.dynamic;G.optional(function(){var Ft=[ws,Nc,Dc,Xs,yo,Ff,$a,Uu,Hs,xs].concat(Fe);function $t(fn){Object.keys(fn).forEach(function(Hn){G.command(Ft.indexOf(Hn)>=0,'unknown parameter "'+Hn+'"',le.commandStr)})}$t(te),$t(K)});var oe=un(F,D),U=kt(F,le),$=Dn(F,U,le),L=Qn(F,le),ae=Vr(F,le),pe=bn(F,le,oe);function Le(Ft){var $t=$[Ft];$t&&(ae[Ft]=$t)}Le(Vo),Le(st(kf));var Be=Object.keys(ae).length>0,Me={framebuffer:U,draw:L,shader:pe,state:ae,dirty:Be,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(Me.profile=En(F,le),Me.uniforms=ii(Y,le),Me.drawVAO=Me.scopeVAO=Zr(F,le),!Me.drawVAO&&pe.program&&!oe&&H.angle_instanced_arrays){var it=!0,It=pe.program.attributes.map(function(Ft){var $t=D.static[Ft];return it=it&&!!$t,$t});if(it&&It.length>0){var yn=nt.getVAO(nt.createVAO(It));Me.drawVAO=new Wi(null,null,null,function(Ft,$t){return Ft.link(yn)}),Me.useVAO=!0}}return oe?Me.useVAO=!0:Me.attributes=Cn(D,le),Me.context=_r(ce,le),Me}function Jr(F,D,Y){var ce=F.shared,le=ce.context,te=F.scope();Object.keys(Y).forEach(function(K){D.save(le,"."+K);var oe=Y[K],U=oe.append(F,D);Array.isArray(U)?te(le,".",K,"=[",U.join(),"];"):te(le,".",K,"=",U,";")}),D(te)}function ai(F,D,Y,ce){var le=F.shared,te=le.gl,K=le.framebuffer,oe;Mt&&(oe=D.def(le.extensions,".webgl_draw_buffers"));var U=F.constants,$=U.drawBuffer,L=U.backBuffer,ae;Y?ae=Y.append(F,D):ae=D.def(K,".next"),ce||D("if(",ae,"!==",K,".cur){"),D("if(",ae,"){",te,".bindFramebuffer(",Xo,",",ae,".framebuffer);"),Mt&&D(oe,".drawBuffersWEBGL(",$,"[",ae,".colorAttachments.length]);"),D("}else{",te,".bindFramebuffer(",Xo,",null);"),Mt&&D(oe,".drawBuffersWEBGL(",L,");"),D("}",K,".cur=",ae,";"),ce||D("}")}function Sr(F,D,Y){var ce=F.shared,le=ce.gl,te=F.current,K=F.next,oe=ce.current,U=ce.next,$=F.cond(oe,".dirty");Fe.forEach(function(L){var ae=st(L);if(!(ae in Y.state)){var pe,Le;if(ae in K){pe=K[ae],Le=te[ae];var Be=Ai(Ze[ae].length,function(it){return $.def(pe,"[",it,"]")});$(F.cond(Be.map(function(it,It){return it+"!=="+Le+"["+It+"]"}).join("||")).then(le,".",He[ae],"(",Be,");",Be.map(function(it,It){return Le+"["+It+"]="+it}).join(";"),";"))}else{pe=$.def(U,".",ae);var Me=F.cond(pe,"!==",oe,".",ae);$(Me),ae in pt?Me(F.cond(pe).then(le,".enable(",pt[ae],");").else(le,".disable(",pt[ae],");"),oe,".",ae,"=",pe,";"):Me(le,".",He[ae],"(",pe,");",oe,".",ae,"=",pe,";")}}}),Object.keys(Y.state).length===0&&$(oe,".dirty=false;"),D($)}function qr(F,D,Y,ce){var le=F.shared,te=F.current,K=le.current,oe=le.gl;As(Object.keys(Y)).forEach(function(U){var $=Y[U];if(!(ce&&!ce($))){var L=$.append(F,D);if(pt[U]){var ae=pt[U];qa($)?L?D(oe,".enable(",ae,");"):D(oe,".disable(",ae,");"):D(F.cond(L).then(oe,".enable(",ae,");").else(oe,".disable(",ae,");")),D(K,".",U,"=",L,";")}else if(Mr(L)){var pe=te[U];D(oe,".",He[U],"(",L,");",L.map(function(Le,Be){return pe+"["+Be+"]="+Le}).join(";"),";")}else D(oe,".",He[U],"(",L,");",K,".",U,"=",L,";")}})}function jr(F,D){rt&&(F.instancing=D.def(F.shared.extensions,".angle_instanced_arrays"))}function hn(F,D,Y,ce,le){var te=F.shared,K=F.stats,oe=te.current,U=te.timer,$=Y.profile;function L(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var ae,pe;function Le(Ft){ae=D.def(),Ft(ae,"=",L(),";"),typeof le=="string"?Ft(K,".count+=",le,";"):Ft(K,".count++;"),Je&&(ce?(pe=D.def(),Ft(pe,"=",U,".getNumPendingQueries();")):Ft(U,".beginQuery(",K,");"))}function Be(Ft){Ft(K,".cpuTime+=",L(),"-",ae,";"),Je&&(ce?Ft(U,".pushScopeStats(",pe,",",U,".getNumPendingQueries(),",K,");"):Ft(U,".endQuery();"))}function Me(Ft){var $t=D.def(oe,".profile");D(oe,".profile=",Ft,";"),D.exit(oe,".profile=",$t,";")}var it;if($){if(qa($)){$.enable?(Le(D),Be(D.exit),Me("true")):Me("false");return}it=$.append(F,D),Me(it)}else it=D.def(oe,".profile");var It=F.block();Le(It),D("if(",it,"){",It,"}");var yn=F.block();Be(yn),D.exit("if(",it,"){",yn,"}")}function oi(F,D,Y,ce,le){var te=F.shared;function K(U){switch(U){case Gc:case kc:case Uc:return 2;case Fr:case qs:case ju:return 3;case di:case jo:case Qs:return 4;default:return 1}}function oe(U,$,L){var ae=te.gl,pe=D.def(U,".location"),Le=D.def(te.attributes,"[",pe,"]"),Be=L.state,Me=L.buffer,it=[L.x,L.y,L.z,L.w],It=["buffer","normalized","offset","stride"];function yn(){D("if(!",Le,".buffer){",ae,".enableVertexAttribArray(",pe,");}");var $t=L.type,fn;if(L.size?fn=D.def(L.size,"||",$):fn=$,D("if(",Le,".type!==",$t,"||",Le,".size!==",fn,"||",It.map(function(Nr){return Le+"."+Nr+"!=="+L[Nr]}).join("||"),"){",ae,".bindBuffer(",Zo,",",Me,".buffer);",ae,".vertexAttribPointer(",[pe,fn,$t,L.normalized,L.stride,L.offset],");",Le,".type=",$t,";",Le,".size=",fn,";",It.map(function(Nr){return Le+"."+Nr+"="+L[Nr]+";"}).join(""),"}"),rt){var Hn=L.divisor;D("if(",Le,".divisor!==",Hn,"){",F.instancing,".vertexAttribDivisorANGLE(",[pe,Hn],");",Le,".divisor=",Hn,";}")}}function Ft(){D("if(",Le,".buffer){",ae,".disableVertexAttribArray(",pe,");",Le,".buffer=null;","}if(",Zs.map(function($t,fn){return Le+"."+$t+"!=="+it[fn]}).join("||"),"){",ae,".vertexAttrib4f(",pe,",",it,");",Zs.map(function($t,fn){return Le+"."+$t+"="+it[fn]+";"}).join(""),"}")}Be===da?yn():Be===Lu?Ft():(D("if(",Be,"===",da,"){"),yn(),D("}else{"),Ft(),D("}"))}ce.forEach(function(U){var $=U.name,L=Y.attributes[$],ae;if(L){if(!le(L))return;ae=L.append(F,D)}else{if(!le(Vf))return;var pe=F.scopeAttrib($);G.optional(function(){F.assert(D,pe+".state","missing attribute "+$)}),ae={},Object.keys(new fe).forEach(function(Le){ae[Le]=D.def(pe,".",Le)})}oe(F.link(U),K(U.info.type),ae)})}function er(F,D,Y,ce,le){for(var te=F.shared,K=te.gl,oe,U=0;U<ce.length;++U){var $=ce[U],L=$.name,ae=$.info.type,pe=Y.uniforms[L],Le=F.link($),Be=Le+".location",Me;if(pe){if(!le(pe))continue;if(qa(pe)){var it=pe.value;if(G.command(it!==null&&typeof it!="undefined",'missing uniform "'+L+'"',F.commandStr),ae===Eo||ae===Ss){G.command(typeof it=="function"&&(ae===Eo&&(it._reglType==="texture2d"||it._reglType==="framebuffer")||ae===Ss&&(it._reglType==="textureCube"||it._reglType==="framebufferCube")),"invalid texture for uniform "+L,F.commandStr);var It=F.link(it._texture||it.color[0]._texture);D(K,".uniform1i(",Be,",",It+".bind());"),D.exit(It,".unbind();")}else if(ae===Ni||ae===Oi||ae===xa){G.optional(function(){G.command(Mr(it),"invalid matrix for uniform "+L,F.commandStr),G.command(ae===Ni&&it.length===4||ae===Oi&&it.length===9||ae===xa&&it.length===16,"invalid length for matrix uniform "+L,F.commandStr)});var yn=F.global.def("new Float32Array(["+Array.prototype.slice.call(it)+"])"),Ft=2;ae===Oi?Ft=3:ae===xa&&(Ft=4),D(K,".uniformMatrix",Ft,"fv(",Be,",false,",yn,");")}else{switch(ae){case Lc:G.commandType(it,"number","uniform "+L,F.commandStr),oe="1f";break;case Gc:G.command(Mr(it)&&it.length===2,"uniform "+L,F.commandStr),oe="2f";break;case Fr:G.command(Mr(it)&&it.length===3,"uniform "+L,F.commandStr),oe="3f";break;case di:G.command(Mr(it)&&it.length===4,"uniform "+L,F.commandStr),oe="4f";break;case Fc:G.commandType(it,"boolean","uniform "+L,F.commandStr),oe="1i";break;case Zu:G.commandType(it,"number","uniform "+L,F.commandStr),oe="1i";break;case Uc:G.command(Mr(it)&&it.length===2,"uniform "+L,F.commandStr),oe="2i";break;case kc:G.command(Mr(it)&&it.length===2,"uniform "+L,F.commandStr),oe="2i";break;case ju:G.command(Mr(it)&&it.length===3,"uniform "+L,F.commandStr),oe="3i";break;case qs:G.command(Mr(it)&&it.length===3,"uniform "+L,F.commandStr),oe="3i";break;case Qs:G.command(Mr(it)&&it.length===4,"uniform "+L,F.commandStr),oe="4i";break;case jo:G.command(Mr(it)&&it.length===4,"uniform "+L,F.commandStr),oe="4i";break}D(K,".uniform",oe,"(",Be,",",Mr(it)?Array.prototype.slice.call(it):it,");")}continue}else Me=pe.append(F,D)}else{if(!le(Vf))continue;Me=D.def(te.uniforms,"[",O.id(L),"]")}ae===Eo?(G(!Array.isArray(Me),"must specify a scalar prop for textures"),D("if(",Me,"&&",Me,'._reglType==="framebuffer"){',Me,"=",Me,".color[0];","}")):ae===Ss&&(G(!Array.isArray(Me),"must specify a scalar prop for cube maps"),D("if(",Me,"&&",Me,'._reglType==="framebufferCube"){',Me,"=",Me,".color[0];","}")),G.optional(function(){function hi(eo,Xd){F.assert(D,eo,'bad data or missing for uniform "'+L+'".  '+Xd)}function Hf(eo){G(!Array.isArray(Me),"must not specify an array type for uniform"),hi("typeof "+Me+'==="'+eo+'"',"invalid type, expected "+eo)}function Ta(eo,Xd){Array.isArray(Me)?G(Me.length===eo,"must have length "+eo):hi(te.isArrayLike+"("+Me+")&&"+Me+".length==="+eo,"invalid vector, should have length "+eo,F.commandStr)}function Ul(eo){G(!Array.isArray(Me),"must not specify a value type"),hi("typeof "+Me+'==="function"&&'+Me+'._reglType==="texture'+(eo===Zn?"2d":"Cube")+'"',"invalid texture type",F.commandStr)}switch(ae){case Zu:Hf("number");break;case kc:Ta(2,"number");break;case qs:Ta(3,"number");break;case jo:Ta(4,"number");break;case Lc:Hf("number");break;case Gc:Ta(2,"number");break;case Fr:Ta(3,"number");break;case di:Ta(4,"number");break;case Fc:Hf("boolean");break;case Uc:Ta(2,"boolean");break;case ju:Ta(3,"boolean");break;case Qs:Ta(4,"boolean");break;case Ni:Ta(4,"number");break;case Oi:Ta(9,"number");break;case xa:Ta(16,"number");break;case Eo:Ul(Zn);break;case Ss:Ul(ev);break}});var $t=1;switch(ae){case Eo:case Ss:var fn=D.def(Me,"._texture");D(K,".uniform1i(",Be,",",fn,".bind());"),D.exit(fn,".unbind();");continue;case Zu:case Fc:oe="1i";break;case kc:case Uc:oe="2i",$t=2;break;case qs:case ju:oe="3i",$t=3;break;case jo:case Qs:oe="4i",$t=4;break;case Lc:oe="1f";break;case Gc:oe="2f",$t=2;break;case Fr:oe="3f",$t=3;break;case di:oe="4f",$t=4;break;case Ni:oe="Matrix2fv";break;case Oi:oe="Matrix3fv";break;case xa:oe="Matrix4fv";break}if(D(K,".uniform",oe,"(",Be,","),oe.charAt(0)==="M"){var Hn=Math.pow(ae-Ni+2,2),Nr=F.global.def("new Float32Array(",Hn,")");Array.isArray(Me)?D("false,(",Ai(Hn,function(hi){return Nr+"["+hi+"]="+Me[hi]}),",",Nr,")"):D("false,(Array.isArray(",Me,")||",Me," instanceof Float32Array)?",Me,":(",Ai(Hn,function(hi){return Nr+"["+hi+"]="+Me+"["+hi+"]"}),",",Nr,")")}else $t>1?D(Ai($t,function(hi){return Array.isArray(Me)?Me[hi]:Me+"["+hi+"]"})):(G(!Array.isArray(Me),"uniform value must not be an array"),D(Me));D(");")}}function Jt(F,D,Y,ce){var le=F.shared,te=le.gl,K=le.draw,oe=ce.draw;function U(){var fn=oe.elements,Hn,Nr=D;return fn?((fn.contextDep&&ce.contextDynamic||fn.propDep)&&(Nr=Y),Hn=fn.append(F,Nr)):Hn=Nr.def(K,".",Xs),Hn&&Nr("if("+Hn+")"+te+".bindBuffer("+Ll+","+Hn+".buffer.buffer);"),Hn}function $(){var fn=oe.count,Hn,Nr=D;return fn?((fn.contextDep&&ce.contextDynamic||fn.propDep)&&(Nr=Y),Hn=fn.append(F,Nr),G.optional(function(){fn.MISSING&&F.assert(D,"false","missing vertex count"),fn.DYNAMIC&&F.assert(Nr,Hn+">=0","missing vertex count")})):(Hn=Nr.def(K,".",$a),G.optional(function(){F.assert(Nr,Hn+">=0","missing vertex count")})),Hn}var L=U();function ae(fn){var Hn=oe[fn];return Hn?Hn.contextDep&&ce.contextDynamic||Hn.propDep?Hn.append(F,Y):Hn.append(F,D):D.def(K,".",fn)}var pe=ae(yo),Le=ae(Ff),Be=$();if(typeof Be=="number"){if(Be===0)return}else Y("if(",Be,"){"),Y.exit("}");var Me,it;rt&&(Me=ae(Uu),it=F.instancing);var It=L+".type",yn=oe.elements&&qa(oe.elements);function Ft(){function fn(){Y(it,".drawElementsInstancedANGLE(",[pe,Be,It,Le+"<<(("+It+"-"+Ml+")>>1)",Me],");")}function Hn(){Y(it,".drawArraysInstancedANGLE(",[pe,Le,Be,Me],");")}L?yn?fn():(Y("if(",L,"){"),fn(),Y("}else{"),Hn(),Y("}")):Hn()}function $t(){function fn(){Y(te+".drawElements("+[pe,Be,It,Le+"<<(("+It+"-"+Ml+")>>1)"]+");")}function Hn(){Y(te+".drawArrays("+[pe,Le,Be]+");")}L?yn?fn():(Y("if(",L,"){"),fn(),Y("}else{"),Hn(),Y("}")):Hn()}rt&&(typeof Me!="number"||Me>=0)?typeof Me=="string"?(Y("if(",Me,">0){"),Ft(),Y("}else if(",Me,"<0){"),$t(),Y("}")):Ft():$t()}function Gn(F,D,Y,ce,le){var te=Kt(),K=te.proc("body",le);return G.optional(function(){te.commandStr=D.commandStr,te.command=te.link(D.commandStr)}),rt&&(te.instancing=K.def(te.shared.extensions,".angle_instanced_arrays")),F(te,K,Y,ce),te.compile().body}function jn(F,D,Y,ce){jr(F,D),Y.useVAO?Y.drawVAO?D(F.shared.vao,".setVAO(",Y.drawVAO.append(F,D),");"):D(F.shared.vao,".setVAO(",F.shared.vao,".targetVAO);"):(D(F.shared.vao,".setVAO(null);"),oi(F,D,Y,ce.attributes,function(){return!0})),er(F,D,Y,ce.uniforms,function(){return!0}),Jt(F,D,D,Y)}function si(F,D){var Y=F.proc("draw",1);jr(F,Y),Jr(F,Y,D.context),ai(F,Y,D.framebuffer),Sr(F,Y,D),qr(F,Y,D.state),hn(F,Y,D,!1,!0);var ce=D.shader.progVar.append(F,Y);if(Y(F.shared.gl,".useProgram(",ce,".program);"),D.shader.program)jn(F,Y,D,D.shader.program);else{Y(F.shared.vao,".setVAO(null);");var le=F.global.def("{}"),te=Y.def(ce,".id"),K=Y.def(le,"[",te,"]");Y(F.cond(K).then(K,".call(this,a0);").else(K,"=",le,"[",te,"]=",F.link(function(oe){return Gn(jn,F,D,oe,1)}),"(",ce,");",K,".call(this,a0);"))}Object.keys(D.state).length>0&&Y(F.shared.current,".dirty=true;")}function wo(F,D,Y,ce){F.batchId="a1",jr(F,D);function le(){return!0}oi(F,D,Y,ce.attributes,le),er(F,D,Y,ce.uniforms,le),Jt(F,D,D,Y)}function Sa(F,D,Y,ce){jr(F,D);var le=Y.contextDep,te=D.def(),K="a0",oe="a1",U=D.def();F.shared.props=U,F.batchId=te;var $=F.scope(),L=F.scope();D($.entry,"for(",te,"=0;",te,"<",oe,";++",te,"){",U,"=",K,"[",te,"];",L,"}",$.exit);function ae(It){return It.contextDep&&le||It.propDep}function pe(It){return!ae(It)}if(Y.needsContext&&Jr(F,L,Y.context),Y.needsFramebuffer&&ai(F,L,Y.framebuffer),qr(F,L,Y.state,ae),Y.profile&&ae(Y.profile)&&hn(F,L,Y,!1,!0),ce)Y.useVAO?Y.drawVAO?ae(Y.drawVAO)?L(F.shared.vao,".setVAO(",Y.drawVAO.append(F,L),");"):$(F.shared.vao,".setVAO(",Y.drawVAO.append(F,$),");"):$(F.shared.vao,".setVAO(",F.shared.vao,".targetVAO);"):($(F.shared.vao,".setVAO(null);"),oi(F,$,Y,ce.attributes,pe),oi(F,L,Y,ce.attributes,ae)),er(F,$,Y,ce.uniforms,pe),er(F,L,Y,ce.uniforms,ae),Jt(F,$,L,Y);else{var Le=F.global.def("{}"),Be=Y.shader.progVar.append(F,L),Me=L.def(Be,".id"),it=L.def(Le,"[",Me,"]");L(F.shared.gl,".useProgram(",Be,".program);","if(!",it,"){",it,"=",Le,"[",Me,"]=",F.link(function(It){return Gn(wo,F,Y,It,2)}),"(",Be,");}",it,".call(this,a0[",te,"],",te,");")}}function B(F,D){var Y=F.proc("batch",2);F.batchId="0",jr(F,Y);var ce=!1,le=!0;Object.keys(D.context).forEach(function(Le){ce=ce||D.context[Le].propDep}),ce||(Jr(F,Y,D.context),le=!1);var te=D.framebuffer,K=!1;te?(te.propDep?ce=K=!0:te.contextDep&&ce&&(K=!0),K||ai(F,Y,te)):ai(F,Y,null),D.state.viewport&&D.state.viewport.propDep&&(ce=!0);function oe(Le){return Le.contextDep&&ce||Le.propDep}Sr(F,Y,D),qr(F,Y,D.state,function(Le){return!oe(Le)}),(!D.profile||!oe(D.profile))&&hn(F,Y,D,!1,"a1"),D.contextDep=ce,D.needsContext=le,D.needsFramebuffer=K;var U=D.shader.progVar;if(U.contextDep&&ce||U.propDep)Sa(F,Y,D,null);else{var $=U.append(F,Y);if(Y(F.shared.gl,".useProgram(",$,".program);"),D.shader.program)Sa(F,Y,D,D.shader.program);else{Y(F.shared.vao,".setVAO(null);");var L=F.global.def("{}"),ae=Y.def($,".id"),pe=Y.def(L,"[",ae,"]");Y(F.cond(pe).then(pe,".call(this,a0,a1);").else(pe,"=",L,"[",ae,"]=",F.link(function(Le){return Gn(Sa,F,D,Le,2)}),"(",$,");",pe,".call(this,a0,a1);"))}}Object.keys(D.state).length>0&&Y(F.shared.current,".dirty=true;")}function we(F,D){var Y=F.proc("scope",3);F.batchId="a2";var ce=F.shared,le=ce.current;Jr(F,Y,D.context),D.framebuffer&&D.framebuffer.append(F,Y),As(Object.keys(D.state)).forEach(function(K){var oe=D.state[K],U=oe.append(F,Y);Mr(U)?U.forEach(function($,L){Y.set(F.next[K],"["+L+"]",$)}):Y.set(ce.next,"."+K,U)}),hn(F,Y,D,!0,!0),[Xs,Ff,$a,Uu,yo].forEach(function(K){var oe=D.draw[K];!oe||Y.set(ce.draw,"."+K,""+oe.append(F,Y))}),Object.keys(D.uniforms).forEach(function(K){var oe=D.uniforms[K].append(F,Y);Array.isArray(oe)&&(oe="["+oe.join()+"]"),Y.set(ce.uniforms,"["+O.id(K)+"]",oe)}),Object.keys(D.attributes).forEach(function(K){var oe=D.attributes[K].append(F,Y),U=F.scopeAttrib(K);Object.keys(new fe).forEach(function($){Y.set(U,"."+$,oe[$])})}),D.scopeVAO&&Y.set(ce.vao,".targetVAO",D.scopeVAO.append(F,Y));function te(K){var oe=D.shader[K];oe&&Y.set(ce.shader,"."+K,oe.append(F,Y))}te(Nc),te(Dc),Object.keys(D.state).length>0&&(Y(le,".dirty=true;"),Y.exit(le,".dirty=true;")),Y("a1(",F.shared.context,",a0,",F.batchId,");")}function ye(F){if(!(typeof F!="object"||Mr(F))){for(var D=Object.keys(F),Y=0;Y<D.length;++Y)if(kn.isDynamic(F[D[Y]]))return!0;return!1}}function Pt(F,D,Y){var ce=D.static[Y];if(!ce||!ye(ce))return;var le=F.global,te=Object.keys(ce),K=!1,oe=!1,U=!1,$=F.global.def("{}");te.forEach(function(ae){var pe=ce[ae];if(kn.isDynamic(pe)){typeof pe=="function"&&(pe=ce[ae]=kn.unbox(pe));var Le=wi(pe,null);K=K||Le.thisDep,U=U||Le.propDep,oe=oe||Le.contextDep}else{switch(le($,".",ae,"="),typeof pe){case"number":le(pe);break;case"string":le('"',pe,'"');break;case"object":Array.isArray(pe)&&le("[",pe.join(),"]");break;default:le(F.link(pe));break}le(";")}});function L(ae,pe){te.forEach(function(Le){var Be=ce[Le];if(!!kn.isDynamic(Be)){var Me=ae.invoke(pe,Be);pe($,".",Le,"=",Me,";")}})}D.dynamic[Y]=new kn.DynamicVariable(Gu,{thisDep:K,contextDep:oe,propDep:U,ref:$,append:L}),delete D.static[Y]}function Sn(F,D,Y,ce,le){var te=Kt();te.stats=te.link(le),Object.keys(D.static).forEach(function(oe){Pt(te,D,oe)}),Bu.forEach(function(oe){Pt(te,F,oe)});var K=Kr(F,D,Y,ce,te);return si(te,K),we(te,K),B(te,K),S(te.compile(),{destroy:function(){K.shader.program.destroy()}})}return{next:At,current:Ze,procs:function(){var F=Kt(),D=F.proc("poll"),Y=F.proc("refresh"),ce=F.block();D(ce),Y(ce);var le=F.shared,te=le.gl,K=le.next,oe=le.current;ce(oe,".dirty=false;"),ai(F,D),ai(F,Y,null,!0);var U;rt&&(U=F.link(rt)),H.oes_vertex_array_object&&Y(F.link(H.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var $=0;$<ge.maxAttributes;++$){var L=Y.def(le.attributes,"[",$,"]"),ae=F.cond(L,".buffer");ae.then(te,".enableVertexAttribArray(",$,");",te,".bindBuffer(",Zo,",",L,".buffer.buffer);",te,".vertexAttribPointer(",$,",",L,".size,",L,".type,",L,".normalized,",L,".stride,",L,".offset);").else(te,".disableVertexAttribArray(",$,");",te,".vertexAttrib4f(",$,",",L,".x,",L,".y,",L,".z,",L,".w);",L,".buffer=null;"),Y(ae),rt&&Y(U,".vertexAttribDivisorANGLE(",$,",",L,".divisor);")}return Y(F.shared.vao,".currentVAO=null;",F.shared.vao,".setVAO(",F.shared.vao,".targetVAO);"),Object.keys(pt).forEach(function(pe){var Le=pt[pe],Be=ce.def(K,".",pe),Me=F.block();Me("if(",Be,"){",te,".enable(",Le,")}else{",te,".disable(",Le,")}",oe,".",pe,"=",Be,";"),Y(Me),D("if(",Be,"!==",oe,".",pe,"){",Me,"}")}),Object.keys(He).forEach(function(pe){var Le=He[pe],Be=Ze[pe],Me,it,It=F.block();if(It(te,".",Le,"("),Mr(Be)){var yn=Be.length;Me=F.global.def(K,".",pe),it=F.global.def(oe,".",pe),It(Ai(yn,function(Ft){return Me+"["+Ft+"]"}),");",Ai(yn,function(Ft){return it+"["+Ft+"]="+Me+"["+Ft+"];"}).join("")),D("if(",Ai(yn,function(Ft){return Me+"["+Ft+"]!=="+it+"["+Ft+"]"}).join("||"),"){",It,"}")}else Me=ce.def(K,".",pe),it=ce.def(oe,".",pe),It(Me,");",oe,".",pe,"=",Me,";"),D("if(",Me,"!==",it,"){",It,"}");Y(It)}),F.compile()}(),compile:Sn}}function iv(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var jd=34918,Yo=34919,Xu=35007,Fl=function(T,O){if(!O.ext_disjoint_timer_query)return null;var H=[];function ge(){return H.pop()||O.ext_disjoint_timer_query.createQueryEXT()}function se(rt){H.push(rt)}var _e=[];function xe(rt){var Mt=ge();O.ext_disjoint_timer_query.beginQueryEXT(Xu,Mt),_e.push(Mt),Je(_e.length-1,_e.length,rt)}function $e(){O.ext_disjoint_timer_query.endQueryEXT(Xu)}function et(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var nt=[];function Ge(){return nt.pop()||new et}function qe(rt){nt.push(rt)}var _t=[];function Je(rt,Mt,Ze){var At=Ge();At.startQueryIndex=rt,At.endQueryIndex=Mt,At.sum=0,At.stats=Ze,_t.push(At)}var lt=[],fe=[];function Ae(){var rt,Mt,Ze=_e.length;if(Ze!==0){fe.length=Math.max(fe.length,Ze+1),lt.length=Math.max(lt.length,Ze+1),lt[0]=0,fe[0]=0;var At=0;for(rt=0,Mt=0;Mt<_e.length;++Mt){var Fe=_e[Mt];O.ext_disjoint_timer_query.getQueryObjectEXT(Fe,Yo)?(At+=O.ext_disjoint_timer_query.getQueryObjectEXT(Fe,jd),se(Fe)):_e[rt++]=Fe,lt[Mt+1]=At,fe[Mt+1]=rt}for(_e.length=rt,rt=0,Mt=0;Mt<_t.length;++Mt){var pt=_t[Mt],He=pt.startQueryIndex,st=pt.endQueryIndex;pt.sum+=lt[st]-lt[He];var Wt=fe[He],cn=fe[st];cn===Wt?(pt.stats.gpuTime+=pt.sum/1e6,qe(pt)):(pt.startQueryIndex=Wt,pt.endQueryIndex=cn,_t[rt++]=pt)}_t.length=rt}}return{beginQuery:xe,endQuery:$e,pushScopeStats:Je,update:Ae,getNumPendingQueries:function(){return _e.length},clear:function(){H.push.apply(H,_e);for(var rt=0;rt<H.length;rt++)O.ext_disjoint_timer_query.deleteQueryEXT(H[rt]);_e.length=0,H.length=0},restore:function(){_e.length=0,H.length=0}}},$u=16384,iu=256,Qa=1024,Wc=34962,Yu="webglcontextlost",Hd="webglcontextrestored",Ku=1,Vc=2,av=3;function xi(T,O){for(var H=0;H<T.length;++H)if(T[H]===O)return H;return-1}function jf(T){var O=Oo(T);if(!O)return null;var H=O.gl,ge=H.getContextAttributes(),se=H.isContextLost(),_e=tf(H,O);if(!_e)return null;var xe=en(),$e=iv(),et=_e.extensions,nt=Fl(H,et),Ge=Pn(),qe=H.drawingBufferWidth,_t=H.drawingBufferHeight,Je={tick:0,time:0,viewportWidth:qe,viewportHeight:_t,framebufferWidth:qe,framebufferHeight:_t,drawingBufferWidth:qe,drawingBufferHeight:_t,pixelRatio:O.pixelRatio},lt={},fe={elements:null,primitive:4,count:-1,offset:0,instances:-1},Ae=Pr(H,et),rt=ea(H,$e,O,Ze),Mt=Ha(H,et,Ae,$e,rt);function Ze(Jt){return Mt.destroyBuffer(Jt)}var At=ls(H,et,rt,$e),Fe=Qh(H,xe,$e,O),pt=yd(H,et,Ae,function(){Wt.procs.poll()},Je,$e,O),He=Af(H,et,Ae,$e,O),st=Kh(H,et,Ae,pt,He,$e),Wt=Zf(H,xe,et,Ae,rt,At,pt,st,lt,Mt,Fe,fe,Je,nt,O),cn=Rl(H,st,Wt.procs.poll,Je,ge,et,Ae),gt=Wt.next,ct=H.canvas,je=[],Kt=[],En=[],kt=[O.onDestroy],Dn=null;function un(){if(je.length===0){nt&&nt.update(),Dn=null;return}Dn=An.next(un),qr();for(var Jt=je.length-1;Jt>=0;--Jt){var Gn=je[Jt];Gn&&Gn(Je,null,0)}H.flush(),nt&&nt.update()}function bn(){!Dn&&je.length>0&&(Dn=An.next(un))}function Qn(){Dn&&(An.cancel(un),Dn=null)}function Vr(Jt){Jt.preventDefault(),se=!0,Qn(),Kt.forEach(function(Gn){Gn()})}function ii(Jt){H.getError(),se=!1,_e.restore(),Fe.restore(),rt.restore(),pt.restore(),He.restore(),st.restore(),Mt.restore(),nt&&nt.restore(),Wt.procs.refresh(),bn(),En.forEach(function(Gn){Gn()})}ct&&(ct.addEventListener(Yu,Vr,!1),ct.addEventListener(Hd,ii,!1));function Cn(){je.length=0,Qn(),ct&&(ct.removeEventListener(Yu,Vr),ct.removeEventListener(Hd,ii)),Fe.clear(),st.clear(),He.clear(),pt.clear(),At.clear(),rt.clear(),Mt.clear(),nt&&nt.clear(),kt.forEach(function(Jt){Jt()})}function Zr(Jt){G(!!Jt,"invalid args to regl({...})"),G.type(Jt,"object","invalid args to regl({...})");function Gn(le){var te=S({},le);delete te.uniforms,delete te.attributes,delete te.context,delete te.vao,"stencil"in te&&te.stencil.op&&(te.stencil.opBack=te.stencil.opFront=te.stencil.op,delete te.stencil.op);function K(oe){if(oe in te){var U=te[oe];delete te[oe],Object.keys(U).forEach(function($){te[oe+"."+$]=U[$]})}}return K("blend"),K("depth"),K("cull"),K("stencil"),K("polygonOffset"),K("scissor"),K("sample"),"vao"in le&&(te.vao=le.vao),te}function jn(le,te){var K={},oe={};return Object.keys(le).forEach(function(U){var $=le[U];if(kn.isDynamic($)){oe[U]=kn.unbox($,U);return}else if(te&&Array.isArray($)){for(var L=0;L<$.length;++L)if(kn.isDynamic($[L])){oe[U]=kn.unbox($,U);return}}K[U]=$}),{dynamic:oe,static:K}}var si=jn(Jt.context||{},!0),wo=jn(Jt.uniforms||{},!0),Sa=jn(Jt.attributes||{},!1),B=jn(Gn(Jt),!1),we={gpuTime:0,cpuTime:0,count:0},ye=Wt.compile(B,Sa,wo,si,we),Pt=ye.draw,Sn=ye.batch,F=ye.scope,D=[];function Y(le){for(;D.length<le;)D.push(null);return D}function ce(le,te){var K;if(se&&G.raise("context lost"),typeof le=="function")return F.call(this,null,le,0);if(typeof te=="function")if(typeof le=="number")for(K=0;K<le;++K)F.call(this,null,te,K);else if(Array.isArray(le))for(K=0;K<le.length;++K)F.call(this,le[K],te,K);else return F.call(this,le,te,0);else if(typeof le=="number"){if(le>0)return Sn.call(this,Y(le|0),le|0)}else if(Array.isArray(le)){if(le.length)return Sn.call(this,le,le.length)}else return Pt.call(this,le)}return S(ce,{stats:we,destroy:function(){ye.destroy()}})}var _r=st.setFBO=Zr({framebuffer:kn.define.call(null,Ku,"framebuffer")});function Kr(Jt,Gn){var jn=0;Wt.procs.poll();var si=Gn.color;si&&(H.clearColor(+si[0]||0,+si[1]||0,+si[2]||0,+si[3]||0),jn|=$u),"depth"in Gn&&(H.clearDepth(+Gn.depth),jn|=iu),"stencil"in Gn&&(H.clearStencil(Gn.stencil|0),jn|=Qa),G(!!jn,"called regl.clear with no buffer specified"),H.clear(jn)}function Jr(Jt){if(G(typeof Jt=="object"&&Jt,"regl.clear() takes an object as input"),"framebuffer"in Jt)if(Jt.framebuffer&&Jt.framebuffer_reglType==="framebufferCube")for(var Gn=0;Gn<6;++Gn)_r(S({framebuffer:Jt.framebuffer.faces[Gn]},Jt),Kr);else _r(Jt,Kr);else Kr(null,Jt)}function ai(Jt){G.type(Jt,"function","regl.frame() callback must be a function"),je.push(Jt);function Gn(){var jn=xi(je,Jt);G(jn>=0,"cannot cancel a frame twice");function si(){var wo=xi(je,si);je[wo]=je[je.length-1],je.length-=1,je.length<=0&&Qn()}je[jn]=si}return bn(),{cancel:Gn}}function Sr(){var Jt=gt.viewport,Gn=gt.scissor_box;Jt[0]=Jt[1]=Gn[0]=Gn[1]=0,Je.viewportWidth=Je.framebufferWidth=Je.drawingBufferWidth=Jt[2]=Gn[2]=H.drawingBufferWidth,Je.viewportHeight=Je.framebufferHeight=Je.drawingBufferHeight=Jt[3]=Gn[3]=H.drawingBufferHeight}function qr(){Je.tick+=1,Je.time=hn(),Sr(),Wt.procs.poll()}function jr(){pt.refresh(),Sr(),Wt.procs.refresh(),nt&&nt.update()}function hn(){return(Pn()-Ge)/1e3}jr();function oi(Jt,Gn){G.type(Gn,"function","listener callback must be a function");var jn;switch(Jt){case"frame":return ai(Gn);case"lost":jn=Kt;break;case"restore":jn=En;break;case"destroy":jn=kt;break;default:G.raise("invalid event, must be one of frame,lost,restore,destroy")}return jn.push(Gn),{cancel:function(){for(var si=0;si<jn.length;++si)if(jn[si]===Gn){jn[si]=jn[jn.length-1],jn.pop();return}}}}var er=S(Zr,{clear:Jr,prop:kn.define.bind(null,Ku),context:kn.define.bind(null,Vc),this:kn.define.bind(null,av),draw:Zr({}),buffer:function(Jt){return rt.create(Jt,Wc,!1,!1)},elements:function(Jt){return At.create(Jt,!1)},texture:pt.create2D,cube:pt.createCube,renderbuffer:He.create,framebuffer:st.create,framebufferCube:st.createCube,vao:Mt.createVAO,attributes:ge,frame:ai,on:oi,limits:Ae,hasExtension:function(Jt){return Ae.extensions.indexOf(Jt.toLowerCase())>=0},read:cn,destroy:Cn,_gl:H,_refresh:jr,poll:function(){qr(),nt&&nt.update()},now:hn,stats:$e});return O.onDone(null,er),er}return jf})}}]);
