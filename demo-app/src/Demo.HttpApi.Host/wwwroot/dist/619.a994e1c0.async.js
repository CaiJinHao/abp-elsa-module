(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[619],{84619:function(_e,Q,i){"use strict";i.d(Q,{Z:function(){return ne}});var L=i(19273),G=i(11849),w=i(34792),k=i(48086),b=i(39428),C=i(3182),Z=i(2824),B=i(64322),U=i(72504),H=i(16130),W=i(258),z=i(32779),S=i(80068),K=i(22699),x=i(99165),ee=i(73171),Y=i(88813),X=i(9504),ve=i(94727),pe=i(83775),$=i(67294),le=i(25377),q=i(35469),ge=i(7359),J=i(27279),Ee=i(22385),he=i(45777),ue=i(24616),T=i(667),h=i(85893),oe=function(_){var re=$.useState([]),te=(0,Z.Z)(re,2),ae=te[0],ie=te[1],ce=(0,le.YB)(),g=function(o){var e=o.currentTarget,u=e.getAttribute("data-type");return _==null||_.onDrag(u,o),o.preventDefault()},r=function(){var a=(0,C.Z)((0,b.Z)().mark(function o(){var e;return(0,b.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,T.pR)();case 2:e=l.sent,ie(e);case 4:case"end":return l.stop()}},o)}));return function(){return a.apply(this,arguments)}}();return(0,$.useEffect)(function(){r()},[]),(0,h.jsxs)("div",{className:"dnd-box",children:[(0,h.jsx)("div",{className:"dnd-header",children:ce.formatMessage({id:"page.designer.component"})}),(0,h.jsx)(J.Z,{collapsible:"header",ghost:!0,className:"dnd-body",children:ae.map(function(a,o){return(0,h.jsx)(J.Z.Panel,{header:a.name,children:(0,h.jsx)("ul",{children:a.children.map(function(e,u){var l,v;return(0,h.jsx)(he.Z,{title:(l=e.description)!==null&&l!==void 0?l:e.label,placement:"right",children:(0,h.jsx)("li",{"data-type":e.type,onMouseDown:g,children:(0,h.jsx)("div",{className:"dnd-rect",children:(0,h.jsxs)("div",{className:"node default",children:[(0,h.jsx)("span",{className:"icon",children:(v=(0,T.Im)(e.type))!==null&&v!==void 0?v:(0,h.jsx)(ue.Z,{})}),(0,h.jsx)("span",{className:"label",children:e.label})]})})},u)},u)})})},o)})},"groups")]})},se=oe,de=function(_){var re,te,ae,ie,ce,g,r=_.actionRef,a=_.graphData,o=(0,le.YB)(),e=(0,$.useRef)(),u=$.useState([]),l=(0,Z.Z)(u,2),v=l[0],c=l[1],P=$.useState(),y=(0,Z.Z)(P,2),I=y[0],j=y[1];(0,$.useImperativeHandle)(r,function(){return{getGraphData:function(){var D=(0,C.Z)((0,b.Z)().mark(function s(){var d,t,f,O;return(0,b.Z)().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return t=(d=e.current)===null||d===void 0?void 0:d.toJSON().cells,f=t==null?void 0:t.filter(function(m){return m.shape=="edge"||m.shape=="elsa-edge"}),O=t==null?void 0:t.filter(function(m){return m.shape!="edge"&&m.shape!="elsa-edge"}),E.abrupt("return",{nodes:O,edges:f});case 4:case"end":return E.stop()}},s)}));function n(){return D.apply(this,arguments)}return n}(),updateNodeProperties:function(n,s){var d,t=(d=e.current)===null||d===void 0?void 0:d.getNodes().find(function(E){return E.id==n});if(!t){k.ZP.error("node id '".concat(n,"' not found"));return}if(t){var f,O;t.prop("name",s.name),t.prop("displayName",s.displayName),t.prop("description",s.description),t.prop("outcomes",s.outcomes),t.prop("properties",s.properties),t.updateData(s.attribtues);var A=(0,T.NQ)(t,s.outcomes,(f=(O=e.current)===null||O===void 0?void 0:O.getOutgoingEdges(t))!==null&&f!==void 0?f:[]);A.forEach(function(E){var m;(m=e.current)===null||m===void 0||m.removeEdge(E)})}},updateNodeOutPorts:function(n,s){var d,t=(d=e.current)===null||d===void 0?void 0:d.getNodes().find(function(O){return O.id==n});if(!t){k.ZP.error("node id '".concat(n,"' not found"));return}var f=(s??[]).map(function(O){return O.toString()});t.prop("outcomes",f)},setAllNodeStatus:function(n){var s,d,t=(s=(d=e.current)===null||d===void 0?void 0:d.getNodes())!==null&&s!==void 0?s:[];t.forEach(function(f){f==null||f.updateData({status:n})})},setNodeStatus:function(n,s){var d,t=(d=e.current)===null||d===void 0?void 0:d.getNodes().find(function(f){return f.id==n});t==null||t.updateData({status:s})},setAllEdgesStyle:function(n){var s,d,t=(s=(d=e.current)===null||d===void 0?void 0:d.getEdges())!==null&&s!==void 0?s:[];t.forEach(function(f){f==null||f.updateData({status:n}),(0,T.rj)(f,n)})},setEdgeStyle:function(n,s){var d,t=(d=e.current)===null||d===void 0?void 0:d.getEdges().find(function(f){return f.id==n});t&&(t==null||t.updateData({status:s}),(0,T.rj)(t,s))},setNodeOutgoingEdgeStyle:function(n,s,d){var t,f=(t=e.current)===null||t===void 0?void 0:t.getNodes().find(function(E){return E.id==n});if(f){var O,A=(O=e.current)===null||O===void 0?void 0:O.getOutgoingEdges(f);A==null||A.forEach(function(E){(E.getProp("outcome")==s||E.id==s)&&(E==null||E.updateData({status:d}),(0,T.rj)(E,d))})}}}});var M=function(n,s,d){switch(s){case"zoomIn":{var t,f,O,A,E,m=(t=n==null?void 0:n.zoom())!==null&&t!==void 0?t:1;if(n!=null&&(f=n.options)!==null&&f!==void 0&&(O=f.mousewheel)!==null&&O!==void 0&&O.maxScale&&m>=(n==null||(A=n.options)===null||A===void 0||(E=A.mousewheel)===null||E===void 0?void 0:E.maxScale))return;n==null||n.zoom(.1,{absolute:!1})}break;case"zoomOut":{var p,N,R,me,De,Me=(p=n==null?void 0:n.zoom())!==null&&p!==void 0?p:1;if(n!=null&&(N=n.options)!==null&&N!==void 0&&(R=N.mousewheel)!==null&&R!==void 0&&R.minScale&&Me<=(n==null||(me=n.options)===null||me===void 0||(De=me.mousewheel)===null||De===void 0?void 0:De.minScale))return;n==null||n.zoom(-.1,{absolute:!1})}break;case"redo":n!=null&&n.canRedo()?n==null||n.redo():k.ZP.info("Nothing to redo");break;case"undo":n!=null&&n.canUndo()?n==null||n.undo():k.ZP.info("Nothing to undo");break;case"center":n==null||n.zoom(1,{absolute:!0}),n==null||n.centerContent({padding:50});break;case"compress":n==null||n.scaleContentToFit(),n==null||n.centerContent({padding:50});break;case"delete":{var Pe,Oe=(Pe=n==null?void 0:n.getSelectedCells())!==null&&Pe!==void 0?Pe:[];Oe.length>0&&n.removeCells(Oe)}break;case"copy":{var Ce,be=(Ce=n==null?void 0:n.getSelectedCells())!==null&&Ce!==void 0?Ce:[];if((be==null?void 0:be.length)==0){k.ZP.info("No node selected.");return}if(n.cleanSelection(),n==null||n.copy(be,{deep:!1}),!(n!=null&&n.isClipboardEmpty())){var Ne=n==null?void 0:n.paste({offset:80,nodeProps:{name:(0,B.CY)()}});Ne&&n.select(Ne)}}break}},V=function(n){var s,d,t;if(!(e!=null&&e.current)){console.error("graph never initial.");return}e==null||(s=e.current)===null||s===void 0||s.fromJSON(n),e==null||(d=e.current)===null||d===void 0||d.centerContent({padding:50}),_==null||(t=_.onDataUpdate)===null||t===void 0||t.call(_,e.current)},F=function(){var D=(0,C.Z)((0,b.Z)().mark(function n(s,d){var t,f,O,A,E,m,p;return(0,b.Z)().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(e.current){R.next=2;break}return R.abrupt("return");case 2:return R.next=4,(0,T.Qr)();case 4:if(A=R.sent,E=A==null||(t=A.items)===null||t===void 0?void 0:t.find(function(me){return me.type==s}),E){R.next=9;break}return k.ZP.error("Node type ".concat(s," not exists.")),R.abrupt("return");case 9:m=(0,T.Xn)({type:s,id:"",outcomes:(f=E.outcomes)!==null&&f!==void 0?f:[],displayName:E.displayName,label:E.displayName,typeDescriptor:s}),p=(O=e.current)===null||O===void 0?void 0:O.createNode(m),p&&(I==null||I.start(p,d));case 12:case"end":return R.stop()}},n)}));return function(s,d){return D.apply(this,arguments)}}(),fe=function(){var D=(0,C.Z)((0,b.Z)().mark(function n(){var s,d,t,f,O;return(0,b.Z)().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:d=(s=_.readonly)!==null&&s!==void 0?s:!1,e.current?t=e.current:(console.debug("graph initial..."),(0,q.hI)(),t=(0,T.eP)(),t.options.connecting.validateMagnet=function(m){return(0,T.Bo)(t,m)},t.options.connecting.validateConnection=function(m){return(0,T.Uw)(t,m)},t.options.connecting.validateEdge=function(m){return(0,T.JQ)(t,m)},t.options.connecting.createEdge=function(m){return(0,T.VU)(t,m)},e.current=t,_==null||(f=_.onGraphInitial)===null||f===void 0||f.call(_,t)),d&&(t.disableClipboard(),t.disableHistory(),t.disableSnapline(),t.disableRubberband(),t.options.interacting.nodeMovable=!1),O=new Y.e9.q6({target:t,scaled:!1,animation:!0}),j(O),t.on("node:click",function(m){var p,N=m.node;console.debug("node",N),console.debug("node data",N.getData()),N.toFront(),_==null||(p=_.onNodeClick)===null||p===void 0||p.call(_,N.getProp(),N)}),t.on("node:dblclick",function(m){var p,N=m.node;(p=_.onNodeDoubleClick)===null||p===void 0||p.call(_,N.getProp(),N)}),t.on("edge:click",function(m){var p,N=m.edge;console.debug(N),N.toFront(),(p=_.onEdgeClick)===null||p===void 0||p.call(_,(0,G.Z)({},N))}),t.on("edge:dblclick",function(m){var p,N=m.edge;(p=_.onEdgeDoubleClick)===null||p===void 0||p.call(_,(0,G.Z)({},N))}),t.on("node:mouseenter",function(m){var p=m.node;d||(p.addTools([{name:"button-remove",args:{x:"100%",y:0,offset:{x:-5,y:5}}}]),(0,T.fH)(p,!0))}),t.on("node:mouseleave",function(m){var p=m.node;p.removeTools(),(0,T.fH)(p,!1)}),t.on("edge:mouseenter",function(m){var p=m.edge;d||(p.toFront(),p.addTools([{name:"button-remove",args:{distance:-40}}]))}),t.on("edge:mouseleave",function(m){var p=m.edge;p.removeTools(),p.setZIndex(-1)}),t.on("blank:click",function(m){var p,N;(0,L.Z)(m),((p=t.getCells())!==null&&p!==void 0?p:[]).forEach(function(R){R.isNode()&&(0,T.fH)(R,!1),R.isEdge()&&(R.setZIndex(-1),R.removeTools())}),_==null||(N=_.onBlankClick)===null||N===void 0||N.call(_)});case 14:case"end":return E.stop()}},n)}));return function(){return D.apply(this,arguments)}}();return(0,$.useEffect)(function(){a&&e.current&&(console.debug("graph load: ",a),V(a))},[a,e.current]),(0,$.useEffect)(function(){return fe(),function(){var D;e&&((D=e.current)===null||D===void 0||D.dispose())}},[0]),(0,$.useEffect)(function(){if(_.toolbars){var n;c((n=_.toolbars)!==null&&n!==void 0?n:[])}else{var D=[{group:"1",items:[{name:"zoomIn",tooltip:o.formatMessage({id:"page.designer.toolbar.zoomIn"}),icon:(0,h.jsx)(U.Z,{}),onClick:function(d){M(d,"zoomIn")}},{name:"zoomOut",tooltip:o.formatMessage({id:"page.designer.toolbar.zoomOut"}),icon:(0,h.jsx)(H.Z,{}),onClick:function(d){M(d,"zoomOut")}}]},{group:"2",items:[{name:"undo",tooltip:o.formatMessage({id:"page.designer.toolbar.undo"}),icon:(0,h.jsx)(W.Z,{}),onClick:function(d){M(d,"undo")}},{name:"redo",tooltip:o.formatMessage({id:"page.designer.toolbar.redo"}),icon:(0,h.jsx)(z.Z,{}),onClick:function(d){M(d,"redo")}}]},{group:"3",items:[{name:"center",tooltip:o.formatMessage({id:"page.designer.toolbar.center"}),icon:(0,h.jsx)(S.Z,{}),onClick:function(d){M(d,"center")}},{name:"compress",tooltip:o.formatMessage({id:"page.designer.toolbar.autoSize"}),icon:(0,h.jsx)(K.Z,{}),onClick:function(d){M(d,"compress")}}]},{group:"4",items:[{name:"copy",tooltip:o.formatMessage({id:"page.designer.toolbar.copy"}),icon:(0,h.jsx)(x.Z,{}),onClick:function(d){M(d,"copy")}},{name:"delete",tooltip:o.formatMessage({id:"page.designer.toolbar.delete"}),icon:(0,h.jsx)(ee.Z,{}),onClick:function(d){M(d,"delete")}}]}];c(D)}},[0]),(0,h.jsxs)("div",{className:"flow-container",children:[((re=_.showNodeTypes)!==null&&re!==void 0?re:!0)&&(0,h.jsx)(se,{onDrag:F},"types"),(0,h.jsx)("div",{id:"graphContainer",className:"graph-container",style:{marginTop:((te=_.showToolbar)!==null&&te!==void 0?te:!0)?40:0,height:((ae=_.showToolbar)!==null&&ae!==void 0?ae:!0)?"calc(100% - 40px)":"100%",overflow:"hidden"}}),((ie=_.showMiniMap)!==null&&ie!==void 0?ie:!0)&&(0,h.jsx)("div",{id:"minimap",className:"minimap-container"}),((ce=_.showToolbar)!==null&&ce!==void 0?ce:!0)&&(0,h.jsx)("div",{id:"toolbar",className:"toolbar-container",style:{left:((g=_.showNodeTypes)!==null&&g!==void 0?g:!0)?260:0},children:(0,h.jsx)(X.o,{hoverEffect:!0,size:"big",children:v.map(function(D,n){return(0,h.jsx)(X.o.Group,{children:D.items.map(function(s,d){return(0,h.jsx)(X.o.Item,{name:s.name,tooltip:s.tooltip,icon:s.icon,onClick:function(){var f;(f=s.onClick)===null||f===void 0||f.call(s,e.current)}},s.name)})},D.group)})})})]})},ne=de},35469:function(_e,Q,i){"use strict";i.d(Q,{Rd:function(){return Y},b6:function(){return X},PP:function(){return ve},hI:function(){return pe}});var L=i(11849),G=i(69610),w=i(54941),k=i(81306),b=i(59206),C=i(88813),Z=i(67294),B=i(48551),U=i(24616),H=i(15873),W=i(73218),z=i(59879),S=i(85893),K=function($){(0,k.Z)(q,$);var le=(0,b.Z)(q);function q(){return(0,G.Z)(this,q),le.apply(this,arguments)}return(0,w.Z)(q,[{key:"shouldComponentUpdate",value:function(){var J=this.props.node;return!!(J&&J.hasChanged("data"))}},{key:"render",value:function(){var J=this.props.node,Ee=J==null?void 0:J.getData(),he=J==null?void 0:J.getProp(),ue=he,T=ue.displayName,h=T===void 0?"":T,oe=ue.icon,se=Ee,de=se.status,ne=de===void 0?"default":de;return(0,S.jsxs)("div",{className:"node ".concat(ne),children:[(0,S.jsx)("span",{className:"icon",children:oe?(0,L.Z)({},oe):(0,S.jsx)(U.Z,{})}),(0,S.jsx)("span",{className:"label",children:h}),(0,S.jsxs)("span",{className:"status",children:[ne=="success"&&(0,S.jsx)(H.Z,{}),ne=="failed"&&(0,S.jsx)(W.Z,{}),ne=="running"&&(0,S.jsx)(z.Z,{spin:!0})]})]})}}]),q}(Z.Component),x={circle:{r:4,magnet:!0,stroke:"#C2C8D5",strokeWidth:1,fill:"#fff",style:{visibility:"hidden",transition:"all 1s"}}},ee={inherit:"react-shape",width:180,height:36,component:(0,S.jsx)(K,{}),ports:{groups:{top:{position:"top",attrs:x,tooltip:"",label:{position:{name:"top"}}},bottom:{position:"bottom",attrs:x,tooltip:"",label:{position:{name:"bottom"}}},left:{position:"left",attrs:x,tooltip:"",label:{position:{name:"left"}}},right:{position:"right",attrs:x,tooltip:"",label:{position:{name:"right"}}}},items:[{id:"top",group:"top"},{id:"bottom",group:"bottom"},{id:"left",group:"left"},{id:"right",group:"right"}]}},Y={zIndex:0,attrs:{line:{stroke:"#C2C8D5",strokeWidth:1,targetMarker:{name:"block",width:12,height:8}}}},X="elsa-node",ve="elsa-edge",pe=function(){C.NB.config(ee),C.kS.config(Y),C.kJ.registerNode(X,(0,L.Z)({inherit:"react-shape"},ee),!0),C.kJ.registerEdge(ve,(0,L.Z)({inherit:"edge"},Y),!0)}},667:function(_e,Q,i){"use strict";i.d(Q,{Im:function(){return X},rj:function(){return ve},fH:function(){return pe},Qr:function(){return $},pR:function(){return le},dv:function(){return q},Oq:function(){return ge},NQ:function(){return h},Xn:function(){return oe},me:function(){return de},MI:function(){return ne},tm:function(){return ye},Bo:function(){return _},Uw:function(){return re},JQ:function(){return te},VU:function(){return ae},eP:function(){return ie}});var L=i(34792),G=i(48086),w=i(11849),k=i(86582),b=i(39428),C=i(3182),Z=i(64860),B=i(64322),U=i(89366),H=i(82738),W=i(64302),z=i(73218),S=i(88813),K=i(29616),x=i(25377),ee=i(35469),Y=i(85893),X=function(r){var a,o={CurrentUser:(0,Y.jsx)(U.Z,{}),Fork:(0,Y.jsx)(H.Z,{}),SendEmail:(0,Y.jsx)(W.Z,{}),Fault:(0,Y.jsx)(z.Z,{})};return(a=o[r])!==null&&a!==void 0?a:null},ve=function(r,a){a=="failed"?(r.attr("line/strokeDasharray",""),r.attr("line/stroke","#f00")):a=="success"?(r.attr("line/strokeDasharray",""),r.attr("line/stroke","#52c41a")):a=="running"?(r.attr("line/strokeDasharray",5),r.attr("line/style/animation","running-line 30s infinite linear")):a=="inactive"&&r.attr("line/strokeDasharray",5)},pe=function(r,a){r.getPorts().forEach(function(o){r.setPortProp(o.id,"attrs/circle",{style:{visibility:a?"visible":"hidden"}})})},$=function(){var g=(0,C.Z)((0,b.Z)().mark(function r(){var a,o,e,u,l=arguments;return(0,b.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(o=l.length>0&&l[0]!==void 0?l[0]:!1,e=localStorage.getItem("nodeType")?JSON.parse((a=localStorage.getItem("nodeType"))!==null&&a!==void 0?a:"{}"):null,!(!e||o)){c.next=10;break}return c.next=5,(0,Z.xr)();case 5:return u=c.sent,localStorage.setItem("nodeType",JSON.stringify(u)),c.abrupt("return",u);case 10:return c.abrupt("return",e);case 11:case"end":return c.stop()}},r)}));return function(){return g.apply(this,arguments)}}(),le=function(){var g=(0,C.Z)((0,b.Z)().mark(function r(){var a,o,e,u,l;return(0,b.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,$(!0);case 2:if(u=c.sent,(u==null||(a=u.items)===null||a===void 0?void 0:a.length)!=0){c.next=5;break}return c.abrupt("return",[]);case 5:return l=((o=u==null?void 0:u.categories)!==null&&o!==void 0?o:[]).map(function(P){return{id:P,name:P,children:[]}}),u==null||(e=u.items)===null||e===void 0||e.forEach(function(P){var y,I,j=l.find(function(M){return M.id===P.category});j==null||(y=j.children)===null||y===void 0||y.push({label:P.displayName,description:P.description,type:P.type,outcomes:(I=P.outcomes)!==null&&I!==void 0?I:[]})}),c.abrupt("return",l);case 8:case"end":return c.stop()}},r)}));return function(){return g.apply(this,arguments)}}(),q=function(r){switch(r){case"JavaScript":return"javascript";case"Json":return"json";case"Liquid":return"handlebars";case"Literal":default:return"plaintext"}},ge=function(r){var a,o,e,u=((a=r.supportedSyntaxes)!==null&&a!==void 0?a:[]).map(function(P){return P}),l=(o=r.defaultSyntax)!==null&&o!==void 0?o:void 0,v="";if(l&&u.length==0&&u.push(l),l=="Switch"&&u.push("Json"),(e=r.options)!==null&&e!==void 0&&e.syntax){var c;u=[],l="Literal",v=(c=r.options)===null||c===void 0?void 0:c.syntax}return(r.uiHint==="single-line"||r.uiHint==="multi-line"||r.uiHint==="dropdown"||r.uiHint==="checkbox")&&u.indexOf("Literal")==-1&&(u=["Literal"].concat((0,k.Z)(u))),u.length>0&&(l=u[0]),{supports:u,default:l,editor:v}},J=function(){},Ee=function(r,a){var o=r.getPortsByGroup("bottom");r.removePorts(o,{silent:!0})},he=function(r){var a,o=r.getPortsByGroup("bottom");r.removePorts(o,{silent:!0});var e=(a=r.getProp("outcomes"))!==null&&a!==void 0?a:[];r.addPorts(e.map(function(u){return{id:uuid(),group:"bottom",label:u,outcome:u}}))},ue=function(r,a){var o,e=(a??[]).map(function(l){var v;return(v=l.getProp("name"))!==null&&v!==void 0?v:""}).filter(function(l){return l}),u=((o=r.getProp("outcomes"))!==null&&o!==void 0?o:[]).map(function(l){return l.toString()});return u.length>e.length},T=function(r,a){var o,e=(a??[]).map(function(v){var c;return(c=v.getProp("name"))!==null&&c!==void 0?c:""}).filter(function(v){return v}),u=((o=r.getProp("outcomes"))!==null&&o!==void 0?o:[]).map(function(v){return v.toString()}),l=u.filter(function(v){return e.indexOf(v)==-1});return l.length>0?l[0].toString():null},h=function(r,a,o){var e=(o??[]).map(function(l){var v;return(v=l.getProp("name"))!==null&&v!==void 0?v:""}),u=e.filter(function(l){return a.indexOf(l)==-1});return u},oe=function(r){var a=r.id,o=r.label,e=r.name,u=r.type,l=r.displayName,v=a||(0,K.V)(),c=o??u,P={id:v,label:c,displayName:l??c,name:e??(0,B.CY)(u),icon:X(u)};return(0,w.Z)((0,w.Z)((0,w.Z)({shape:ee.b6},r),P),{},{data:(0,w.Z)({},P)})},se=function(r){var a,o=r.id,e=r.label,u=r.name,l=o??(0,K.V)(),v=(a=e??u)!==null&&a!==void 0?a:"Done";return(0,w.Z)((0,w.Z)((0,w.Z)({},ee.Rd),{},{shape:ee.PP},r),{},{id:l,name:v,label:v,outcome:v})},de=function(r){console.debug("graph data: ",r);var a=r.edges.map(function(e){var u,l;return{sourceId:e.source.cell,targetId:e.target.cell,sourceActivityId:e.source.cell,targetActivityId:e.target.cell,outcome:(u=(l=e.name)!==null&&l!==void 0?l:e.outcome)!==null&&u!==void 0?u:"Done",attributes:{sourcePort:e.source.port,targetPort:e.target.port}}}),o=r.nodes.map(function(e){var u,l,v,c,P,y,I,j,M,V=(u=e.outcomes)!==null&&u!==void 0?u:[];return V.length||(V=a.filter(function(F){return F.sourceId==e.id}).map(function(F){return F.outcome})),(0,w.Z)((0,w.Z)({},(l=e.data)!==null&&l!==void 0?l:{}),{},{activityId:e.id,type:e.type,name:(v=e.name)!==null&&v!==void 0?v:(0,B.CY)(e.type),displayName:(c=(P=e.displayName)!==null&&P!==void 0?P:e.label)!==null&&c!==void 0?c:e.type,description:e.description,properties:e.properties,attributes:{x:Math.round((y=(I=e.position)===null||I===void 0?void 0:I.x)!==null&&y!==void 0?y:0),y:Math.round((j=(M=e.position)===null||M===void 0?void 0:M.y)!==null&&j!==void 0?j:0),outcomes:V}})});return{activities:o,connections:a}},ne=function(){var g=(0,C.Z)((0,b.Z)().mark(function r(a,o){var e,u;return(0,b.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return e=[],a.forEach(function(){var c=(0,C.Z)((0,b.Z)().mark(function P(y){var I,j,M,V,F,fe,D;return(0,b.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e.push(oe({data:y,id:y.activityId,x:parseInt((I=(j=y.attributes)===null||j===void 0?void 0:j.x)!==null&&I!==void 0?I:0),y:parseInt((M=(V=y.attributes)===null||V===void 0?void 0:V.y)!==null&&M!==void 0?M:0),outcomes:(F=(fe=y.attributes)===null||fe===void 0?void 0:fe.outcomes)!==null&&F!==void 0?F:[],label:(D=y.displayName)!==null&&D!==void 0?D:y.type,displayName:y.displayName,name:y.name,type:y.type,description:y.description,properties:y.properties}));case 1:case"end":return s.stop()}},P)}));return function(P){return c.apply(this,arguments)}}()),u=[],o.forEach(function(c){var P,y=c.sourceId,I=c.targetId,j=(P=c.attributes)!==null&&P!==void 0?P:{};if(y&&e.findIndex(function(F){return F.id==y})>=0&&I&&e.findIndex(function(F){return F.id==I})>=0){var M,V;u.push(se({id:(0,K.V)(),label:c.outcome,outcome:c.outcome,source:{cell:y,port:(M=j==null?void 0:j.sourcePort)!==null&&M!==void 0?M:"bottom"},target:{cell:I,port:(V=j==null?void 0:j.targetPort)!==null&&V!==void 0?V:"top"}}))}else console.debug("edge source id ".concat(y," or target id ").concat(I," not found"))}),v.abrupt("return",{nodes:e,edges:u});case 5:case"end":return v.stop()}},r)}));return function(a,o){return g.apply(this,arguments)}}(),ye=function(){var g=(0,C.Z)((0,b.Z)().mark(function r(a){var o,e;return(0,b.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,Z._T)(a);case 2:return e=l.sent,l.next=5,e==null||(o=e.response)===null||o===void 0?void 0:o.text();case 5:return l.abrupt("return",l.sent);case 6:case"end":return l.stop()}},r)}));return function(a){return g.apply(this,arguments)}}(),_=function(r,a){var o,e=a.cell,u=a.view,l=a.magnet;return l?e.isNode()&&!ue(e,(o=r.getOutgoingEdges(e))!==null&&o!==void 0?o:[])?(G.ZP.error((0,x.wv)({id:"page.designer.noMoreOutcomes"})),!1):!0:!1},re=function(r,a){var o=a.targetMagnet;return!!o},te=function(r,a){var o=a.edge,e=a.type;return o.getProp("shape")=="elsa-edge"},ae=function(r,a){var o=a.sourceCell,e=a.sourceMagnet;if(o.isNode()){var u,l=T(o,(u=r.getOutgoingEdges(o))!==null&&u!==void 0?u:[]);return l?new S.bn.kS(se({id:"",label:l})):(G.ZP.error((0,x.wv)({id:"page.designer.noMoreOutcomes"})),null)}else return null},ie=function(r){return new S.kJ((0,w.Z)({container:document.getElementById("graphContainer"),autoResize:!0,grid:{size:10,visible:!0},history:{enabled:!0,beforeAddCommand:function(o,e){return(e==null?void 0:e.key)!="tools"}},mousewheel:{enabled:!0,zoomAtMousePosition:!0,modifiers:["ctrl"],minScale:.5,maxScale:1.5},scroller:{padding:40},panning:{enabled:!0,modifiers:"ctrl"},minimap:{enabled:!0,container:document.getElementById("minimap"),width:230,height:180},snapline:!0,keyboard:!0,selecting:{enabled:!0,multiple:!0,rubberband:!0},clipboard:{enabled:!0,useLocalStorage:!0},translating:{restrict:!0},connecting:{router:{name:"manhattan",args:{step:10}},connector:{name:"rounded",args:{radius:10}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,allowMulti:"withPort",snap:!0,highlight:!0,allowLoop:!1,allowEdge:!1},highlighting:{magnetAvailable:{name:"stroke",args:{padding:4,attrs:{"stroke-width":1,stroke:"#47C769",fill:"#ffffff"}}},magnetAdsorbed:{name:"stroke",args:{attrs:{stroke:"#47C769",fill:"#47C769"}}}}},r))},ce=function(){return{}}},64860:function(_e,Q,i){"use strict";i.d(Q,{xr:function(){return b},TX:function(){return Z},_T:function(){return U}});var L=i(39428),G=i(11849),w=i(3182),k=i(25377);function b(W){return C.apply(this,arguments)}function C(){return C=(0,w.Z)((0,L.Z)().mark(function W(z){return(0,L.Z)().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.abrupt("return",(0,k.WY)("/api/designer/activity-types",(0,G.Z)({method:"GET"},z||{})));case 1:case"end":return K.stop()}},W)})),C.apply(this,arguments)}function Z(W,z){return B.apply(this,arguments)}function B(){return B=(0,w.Z)((0,L.Z)().mark(function W(z,S){return(0,L.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,k.WY)("/api/designer/runtime-select-list",(0,G.Z)({method:"POST",data:z},S||{})));case 1:case"end":return x.stop()}},W)})),B.apply(this,arguments)}function U(W,z){return H.apply(this,arguments)}function H(){return H=(0,w.Z)((0,L.Z)().mark(function W(z,S){return(0,L.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,k.WY)("/api/designer/scripting/javascript/type-definitions/".concat(z),(0,G.Z)({method:"GET",getResponse:!0},S||{})));case 1:case"end":return x.stop()}},W)})),H.apply(this,arguments)}},64322:function(_e,Q,i){"use strict";i.d(Q,{CY:function(){return L},xy:function(){return G}});var L=function(){for(var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,Z="",B="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",U=B.length,H=0;H<C;H++)Z+=B.charAt(Math.floor(Math.random()*U));return b?"".concat(b,"_").concat(Z):Z},G=function(b,C){var Z=new Blob([C],{type:"application/json"}),B=window.URL.createObjectURL(Z),U=document.createElement("a");U.href=B,U.download=b,document.body.appendChild(U),U.click(),document.body.removeChild(U),window.URL.revokeObjectURL(B)},w=function(b){var C=Object.keys(b).filter(function(Z){return isInteger(Z)}).forEach(function(Z){return _defineProperty({},Z,{text:b[Z]})});return C}}}]);
