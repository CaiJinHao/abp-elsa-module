(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[619],{84619:function(ge,Q,a){"use strict";a.d(Q,{Z:function(){return ne}});var B=a(19273),F=a(11849),A=a(34792),w=a(48086),h=a(39428),C=a(3182),Z=a(2824),U=a(64322),$=a(72504),V=a(16130),W=a(258),G=a(32779),S=a(80068),K=a(22699),R=a(99165),ee=a(73171),Y=a(60538),X=a(29274),ve=a(94727),pe=a(83775),k=a(67294),le=a(25377),q=a(35469),_e=a(7359),z=a(687),be=a(22385),Ee=a(96296),se=a(3248),T=a(667),E=a(85893),oe=function(g){var re=k.useState([]),te=(0,Z.Z)(re,2),ie=te[0],ae=te[1],ce=(0,le.YB)(),_=function(r){var e=r.currentTarget,s=e.getAttribute("data-type");return g==null||g.onDrag(s,r),r.preventDefault()},o=function(){var i=(0,C.Z)((0,h.Z)().mark(function r(){var e;return(0,h.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,T.pR)();case 2:e=l.sent,ae(e);case 4:case"end":return l.stop()}},r)}));return function(){return i.apply(this,arguments)}}();return(0,k.useEffect)(function(){o()},[]),(0,E.jsxs)("div",{className:"dnd-box",children:[(0,E.jsx)("div",{className:"dnd-header",children:ce.formatMessage({id:"page.designer.component"})}),(0,E.jsx)(z.Z,{collapsible:"header",ghost:!0,className:"dnd-body",children:ie.map(function(i,r){return(0,E.jsx)(z.Z.Panel,{header:i.name,children:(0,E.jsx)("ul",{children:i.children.map(function(e,s){var l,v;return(0,E.jsx)(Ee.Z,{title:(l=e.description)!==null&&l!==void 0?l:e.label,placement:"right",children:(0,E.jsx)("li",{"data-type":e.type,onMouseDown:_,children:(0,E.jsx)("div",{className:"dnd-rect",children:(0,E.jsxs)("div",{className:"node default",children:[(0,E.jsx)("span",{className:"icon",children:(v=(0,T.Im)(e.type))!==null&&v!==void 0?v:(0,E.jsx)(se.Z,{})}),(0,E.jsx)("span",{className:"label",children:e.label})]})})},s)},s)})})},r)})},"groups")]})},ue=oe,de=function(g){var re,te,ie,ae,ce,_,o=g.actionRef,i=g.graphData,r=(0,le.YB)(),e=(0,k.useRef)(),s=k.useState([]),l=(0,Z.Z)(s,2),v=l[0],c=l[1],D=k.useState(),y=(0,Z.Z)(D,2),I=y[0],j=y[1];(0,k.useImperativeHandle)(o,function(){return{getGraphData:function(){var P=(0,C.Z)((0,h.Z)().mark(function u(){var d,t,f,O;return(0,h.Z)().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return t=(d=e.current)===null||d===void 0?void 0:d.toJSON().cells,f=t==null?void 0:t.filter(function(m){return m.shape=="edge"||m.shape=="elsa-edge"}),O=t==null?void 0:t.filter(function(m){return m.shape!="edge"&&m.shape!="elsa-edge"}),b.abrupt("return",{nodes:O,edges:f});case 4:case"end":return b.stop()}},u)}));function n(){return P.apply(this,arguments)}return n}(),updateNodeProperties:function(n,u){var d,t=(d=e.current)===null||d===void 0?void 0:d.getNodes().find(function(b){return b.id==n});if(!t){w.ZP.error("node id '".concat(n,"' not found"));return}if(t){var f,O;t.prop("name",u.name),t.prop("displayName",u.displayName),t.prop("description",u.description),t.prop("outcomes",u.outcomes),t.prop("properties",u.properties),t.updateData(u.attribtues);var L=(0,T.NQ)(t,u.outcomes,(f=(O=e.current)===null||O===void 0?void 0:O.getOutgoingEdges(t))!==null&&f!==void 0?f:[]);L.forEach(function(b){var m;(m=e.current)===null||m===void 0||m.removeEdge(b)})}},updateNodeOutPorts:function(n,u){var d,t=(d=e.current)===null||d===void 0?void 0:d.getNodes().find(function(O){return O.id==n});if(!t){w.ZP.error("node id '".concat(n,"' not found"));return}var f=(u??[]).map(function(O){return O.toString()});t.prop("outcomes",f)},setAllNodeStatus:function(n){var u,d,t=(u=(d=e.current)===null||d===void 0?void 0:d.getNodes())!==null&&u!==void 0?u:[];t.forEach(function(f){f==null||f.updateData({status:n})})},setNodeStatus:function(n,u){var d,t=(d=e.current)===null||d===void 0?void 0:d.getNodes().find(function(f){return f.id==n});t==null||t.updateData({status:u})},setAllEdgesStyle:function(n){var u,d,t=(u=(d=e.current)===null||d===void 0?void 0:d.getEdges())!==null&&u!==void 0?u:[];t.forEach(function(f){f==null||f.updateData({status:n}),(0,T.rj)(f,n)})},setEdgeStyle:function(n,u){var d,t=(d=e.current)===null||d===void 0?void 0:d.getEdges().find(function(f){return f.id==n});t&&(t==null||t.updateData({status:u}),(0,T.rj)(t,u))},setNodeOutgoingEdgeStyle:function(n,u,d){var t,f=(t=e.current)===null||t===void 0?void 0:t.getNodes().find(function(b){return b.id==n});if(f){var O,L=(O=e.current)===null||O===void 0?void 0:O.getOutgoingEdges(f);L==null||L.forEach(function(b){(b.getProp("outcome")==u||b.id==u)&&(b==null||b.updateData({status:d}),(0,T.rj)(b,d))})}}}});var N=function(n,u,d){switch(u){case"zoomIn":{var t,f,O,L,b,m=(t=n==null?void 0:n.zoom())!==null&&t!==void 0?t:1;if(n!=null&&(f=n.options)!==null&&f!==void 0&&(O=f.mousewheel)!==null&&O!==void 0&&O.maxScale&&m>=(n==null||(L=n.options)===null||L===void 0||(b=L.mousewheel)===null||b===void 0?void 0:b.maxScale))return;n==null||n.zoom(.1,{absolute:!1})}break;case"zoomOut":{var p,M,x,me,Pe,Ne=(p=n==null?void 0:n.zoom())!==null&&p!==void 0?p:1;if(n!=null&&(M=n.options)!==null&&M!==void 0&&(x=M.mousewheel)!==null&&x!==void 0&&x.minScale&&Ne<=(n==null||(me=n.options)===null||me===void 0||(Pe=me.mousewheel)===null||Pe===void 0?void 0:Pe.minScale))return;n==null||n.zoom(-.1,{absolute:!1})}break;case"redo":n!=null&&n.canRedo()?n==null||n.redo():w.ZP.info("Nothing to redo");break;case"undo":n!=null&&n.canUndo()?n==null||n.undo():w.ZP.info("Nothing to undo");break;case"center":n==null||n.zoom(1,{absolute:!0}),n==null||n.centerContent({padding:50});break;case"compress":n==null||n.scaleContentToFit(),n==null||n.centerContent({padding:50});break;case"delete":{var De,Oe=(De=n==null?void 0:n.getSelectedCells())!==null&&De!==void 0?De:[];Oe.length>0&&n.removeCells(Oe)}break;case"copy":{var Ce,he=(Ce=n==null?void 0:n.getSelectedCells())!==null&&Ce!==void 0?Ce:[];if((he==null?void 0:he.length)==0){w.ZP.info("No node selected.");return}if(n.cleanSelection(),n==null||n.copy(he,{deep:!1}),!(n!=null&&n.isClipboardEmpty())){var Me=n==null?void 0:n.paste({offset:80,nodeProps:{name:(0,U.CY)()}});Me&&n.select(Me)}}break}},J=function(n){var u,d,t;if(!(e!=null&&e.current)){console.error("graph never initial.");return}e==null||(u=e.current)===null||u===void 0||u.fromJSON(n),e==null||(d=e.current)===null||d===void 0||d.centerContent({padding:50}),g==null||(t=g.onDataUpdate)===null||t===void 0||t.call(g,e.current)},H=function(){var P=(0,C.Z)((0,h.Z)().mark(function n(u,d){var t,f,O,L,b,m,p;return(0,h.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(e.current){x.next=2;break}return x.abrupt("return");case 2:return x.next=4,(0,T.Qr)();case 4:if(L=x.sent,b=L==null||(t=L.items)===null||t===void 0?void 0:t.find(function(me){return me.type==u}),b){x.next=9;break}return w.ZP.error("Node type ".concat(u," not exists.")),x.abrupt("return");case 9:m=(0,T.Xn)({type:u,id:"",outcomes:(f=b.outcomes)!==null&&f!==void 0?f:[],displayName:b.displayName,label:b.displayName,typeDescriptor:u}),p=(O=e.current)===null||O===void 0?void 0:O.createNode(m),p&&(I==null||I.start(p,d));case 12:case"end":return x.stop()}},n)}));return function(u,d){return P.apply(this,arguments)}}(),fe=function(){var P=(0,C.Z)((0,h.Z)().mark(function n(){var u,d,t,f,O;return(0,h.Z)().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:d=(u=g.readonly)!==null&&u!==void 0?u:!1,e.current?t=e.current:(console.debug("graph initial..."),(0,q.hI)(),t=(0,T.eP)(),t.options.connecting.validateMagnet=function(m){return(0,T.Bo)(t,m)},t.options.connecting.validateConnection=function(m){return(0,T.Uw)(t,m)},t.options.connecting.validateEdge=function(m){return(0,T.JQ)(t,m)},t.options.connecting.createEdge=function(m){return(0,T.VU)(t,m)},e.current=t,g==null||(f=g.onGraphInitial)===null||f===void 0||f.call(g,t)),d&&(t.disableClipboard(),t.disableHistory(),t.disableSnapline(),t.disableRubberband(),t.options.interacting.nodeMovable=!1),O=new Y.e9.q6({target:t,scaled:!1,animation:!0}),j(O),t.on("node:click",function(m){var p,M=m.node;console.debug("node",M),console.debug("node data",M.getData()),M.toFront(),g==null||(p=g.onNodeClick)===null||p===void 0||p.call(g,M.getProp(),M)}),t.on("node:dblclick",function(m){var p,M=m.node;(p=g.onNodeDoubleClick)===null||p===void 0||p.call(g,M.getProp(),M)}),t.on("edge:click",function(m){var p,M=m.edge;console.debug(M),M.toFront(),(p=g.onEdgeClick)===null||p===void 0||p.call(g,(0,F.Z)({},M))}),t.on("edge:dblclick",function(m){var p,M=m.edge;(p=g.onEdgeDoubleClick)===null||p===void 0||p.call(g,(0,F.Z)({},M))}),t.on("node:mouseenter",function(m){var p=m.node;d||(p.addTools([{name:"button-remove",args:{x:"100%",y:0,offset:{x:-5,y:5}}}]),(0,T.fH)(p,!0))}),t.on("node:mouseleave",function(m){var p=m.node;p.removeTools(),(0,T.fH)(p,!1)}),t.on("edge:mouseenter",function(m){var p=m.edge;d||(p.toFront(),p.addTools([{name:"button-remove",args:{distance:-40}}]))}),t.on("edge:mouseleave",function(m){var p=m.edge;p.removeTools(),p.setZIndex(-1)}),t.on("blank:click",function(m){var p,M;(0,B.Z)(m),((p=t.getCells())!==null&&p!==void 0?p:[]).forEach(function(x){x.isNode()&&(0,T.fH)(x,!1),x.isEdge()&&(x.setZIndex(-1),x.removeTools())}),g==null||(M=g.onBlankClick)===null||M===void 0||M.call(g)});case 14:case"end":return b.stop()}},n)}));return function(){return P.apply(this,arguments)}}();return(0,k.useEffect)(function(){i&&e.current&&(console.debug("graph load: ",i),J(i))},[i,e.current]),(0,k.useEffect)(function(){return fe(),function(){var P;e&&((P=e.current)===null||P===void 0||P.dispose())}},[0]),(0,k.useEffect)(function(){if(g.toolbars){var n;c((n=g.toolbars)!==null&&n!==void 0?n:[])}else{var P=[{group:"1",items:[{name:"zoomIn",tooltip:r.formatMessage({id:"page.designer.toolbar.zoomIn"}),icon:(0,E.jsx)($.Z,{}),onClick:function(d){N(d,"zoomIn")}},{name:"zoomOut",tooltip:r.formatMessage({id:"page.designer.toolbar.zoomOut"}),icon:(0,E.jsx)(V.Z,{}),onClick:function(d){N(d,"zoomOut")}}]},{group:"2",items:[{name:"undo",tooltip:r.formatMessage({id:"page.designer.toolbar.undo"}),icon:(0,E.jsx)(W.Z,{}),onClick:function(d){N(d,"undo")}},{name:"redo",tooltip:r.formatMessage({id:"page.designer.toolbar.redo"}),icon:(0,E.jsx)(G.Z,{}),onClick:function(d){N(d,"redo")}}]},{group:"3",items:[{name:"center",tooltip:r.formatMessage({id:"page.designer.toolbar.center"}),icon:(0,E.jsx)(S.Z,{}),onClick:function(d){N(d,"center")}},{name:"compress",tooltip:r.formatMessage({id:"page.designer.toolbar.autoSize"}),icon:(0,E.jsx)(K.Z,{}),onClick:function(d){N(d,"compress")}}]},{group:"4",items:[{name:"copy",tooltip:r.formatMessage({id:"page.designer.toolbar.copy"}),icon:(0,E.jsx)(R.Z,{}),onClick:function(d){N(d,"copy")}},{name:"delete",tooltip:r.formatMessage({id:"page.designer.toolbar.delete"}),icon:(0,E.jsx)(ee.Z,{}),onClick:function(d){N(d,"delete")}}]}];c(P)}},[0]),(0,E.jsxs)("div",{className:"flow-container",children:[((re=g.showNodeTypes)!==null&&re!==void 0?re:!0)&&(0,E.jsx)(ue,{onDrag:H},"types"),(0,E.jsx)("div",{id:"graphContainer",className:"graph-container",style:{marginTop:((te=g.showToolbar)!==null&&te!==void 0?te:!0)?40:0,height:((ie=g.showToolbar)!==null&&ie!==void 0?ie:!0)?"calc(100% - 40px)":"100%",overflow:"hidden"}}),((ae=g.showMiniMap)!==null&&ae!==void 0?ae:!0)&&(0,E.jsx)("div",{id:"minimap",className:"minimap-container"}),((ce=g.showToolbar)!==null&&ce!==void 0?ce:!0)&&(0,E.jsx)("div",{id:"toolbar",className:"toolbar-container",style:{left:((_=g.showNodeTypes)!==null&&_!==void 0?_:!0)?260:0},children:(0,E.jsx)(X.o,{hoverEffect:!0,size:"big",children:v.map(function(P,n){return(0,E.jsx)(X.o.Group,{children:P.items.map(function(u,d){return(0,E.jsx)(X.o.Item,{name:u.name,tooltip:u.tooltip,icon:u.icon,onClick:function(){var f;(f=u.onClick)===null||f===void 0||f.call(u,e.current)}},u.name)})},P.group)})})})]})},ne=de},35469:function(ge,Q,a){"use strict";a.d(Q,{Rd:function(){return Y},b6:function(){return X},PP:function(){return ve},hI:function(){return pe}});var B=a(11849),F=a(69610),A=a(54941),w=a(81306),h=a(59206),C=a(60538),Z=a(67294),U=a(48551),$=a(3248),V=a(15873),W=a(73218),G=a(59879),S=a(85893),K=function(k){(0,w.Z)(q,k);var le=(0,h.Z)(q);function q(){return(0,F.Z)(this,q),le.apply(this,arguments)}return(0,A.Z)(q,[{key:"shouldComponentUpdate",value:function(){var z=this.props.node;return!!(z&&z.hasChanged("data"))}},{key:"render",value:function(){var z=this.props.node,be=z==null?void 0:z.getData(),Ee=z==null?void 0:z.getProp(),se=Ee,T=se.displayName,E=T===void 0?"":T,oe=se.icon,ue=be,de=ue.status,ne=de===void 0?"default":de;return(0,S.jsxs)("div",{className:"node ".concat(ne),children:[(0,S.jsx)("span",{className:"icon",children:oe?(0,B.Z)({},oe):(0,S.jsx)($.Z,{})}),(0,S.jsx)("span",{className:"label",children:E}),(0,S.jsxs)("span",{className:"status",children:[ne=="success"&&(0,S.jsx)(V.Z,{}),ne=="failed"&&(0,S.jsx)(W.Z,{}),ne=="running"&&(0,S.jsx)(G.Z,{spin:!0})]})]})}}]),q}(Z.Component),R={circle:{r:4,magnet:!0,stroke:"#C2C8D5",strokeWidth:1,fill:"#fff",style:{visibility:"hidden",transition:"all 1s"}}},ee={inherit:"react-shape",width:180,height:36,component:(0,S.jsx)(K,{}),ports:{groups:{top:{position:"top",attrs:R,tooltip:"",label:{position:{name:"top"}}},bottom:{position:"bottom",attrs:R,tooltip:"",label:{position:{name:"bottom"}}},left:{position:"left",attrs:R,tooltip:"",label:{position:{name:"left"}}},right:{position:"right",attrs:R,tooltip:"",label:{position:{name:"right"}}}},items:[{id:"top",group:"top"},{id:"bottom",group:"bottom"},{id:"left",group:"left"},{id:"right",group:"right"}]}},Y={zIndex:0,attrs:{line:{stroke:"#C2C8D5",strokeWidth:1,targetMarker:{name:"block",width:12,height:8}}}},X="elsa-node",ve="elsa-edge",pe=function(){C.NB.config(ee),C.kS.config(Y),C.kJ.registerNode(X,(0,B.Z)({inherit:"react-shape"},ee),!0),C.kJ.registerEdge(ve,(0,B.Z)({inherit:"edge"},Y),!0)}},667:function(ge,Q,a){"use strict";a.d(Q,{Im:function(){return X},rj:function(){return ve},fH:function(){return pe},Qr:function(){return k},pR:function(){return le},dv:function(){return q},Oq:function(){return _e},NQ:function(){return E},Xn:function(){return oe},me:function(){return de},MI:function(){return ne},tm:function(){return ye},Bo:function(){return g},Uw:function(){return re},JQ:function(){return te},VU:function(){return ie},eP:function(){return ae}});var B=a(34792),F=a(48086),A=a(11849),w=a(86582),h=a(39428),C=a(3182),Z=a(64860),U=a(64322),$=a(89366),V=a(82738),W=a(64302),G=a(73218),S=a(60538),K=a(29616),R=a(25377),ee=a(35469),Y=a(85893),X=function(o){var i,r={CurrentUser:(0,Y.jsx)($.Z,{}),Fork:(0,Y.jsx)(V.Z,{}),SendEmail:(0,Y.jsx)(W.Z,{}),Fault:(0,Y.jsx)(G.Z,{})};return(i=r[o])!==null&&i!==void 0?i:null},ve=function(o,i){i=="failed"?(o.attr("line/strokeDasharray",""),o.attr("line/stroke","#f00")):i=="success"?(o.attr("line/strokeDasharray",""),o.attr("line/stroke","#52c41a")):i=="running"?(o.attr("line/strokeDasharray",5),o.attr("line/style/animation","running-line 30s infinite linear")):i=="inactive"&&o.attr("line/strokeDasharray",5)},pe=function(o,i){o.getPorts().forEach(function(r){o.setPortProp(r.id,"attrs/circle",{style:{visibility:i?"visible":"hidden"}})})},k=function(){var _=(0,C.Z)((0,h.Z)().mark(function o(){var i,r,e,s,l=arguments;return(0,h.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(r=l.length>0&&l[0]!==void 0?l[0]:!1,e=localStorage.getItem("nodeType")?JSON.parse((i=localStorage.getItem("nodeType"))!==null&&i!==void 0?i:"{}"):null,!(!e||r)){c.next=10;break}return c.next=5,(0,Z.xr)();case 5:return s=c.sent,localStorage.setItem("nodeType",JSON.stringify(s)),c.abrupt("return",s);case 10:return c.abrupt("return",e);case 11:case"end":return c.stop()}},o)}));return function(){return _.apply(this,arguments)}}(),le=function(){var _=(0,C.Z)((0,h.Z)().mark(function o(){var i,r,e,s,l;return(0,h.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,k(!0);case 2:if(s=c.sent,(s==null||(i=s.items)===null||i===void 0?void 0:i.length)!=0){c.next=5;break}return c.abrupt("return",[]);case 5:return l=((r=s==null?void 0:s.categories)!==null&&r!==void 0?r:[]).map(function(D){return{id:D,name:D,children:[]}}),s==null||(e=s.items)===null||e===void 0||e.forEach(function(D){var y,I,j=l.find(function(N){return N.id===D.category});j==null||(y=j.children)===null||y===void 0||y.push({label:D.displayName,description:D.description,type:D.type,outcomes:(I=D.outcomes)!==null&&I!==void 0?I:[]})}),c.abrupt("return",l);case 8:case"end":return c.stop()}},o)}));return function(){return _.apply(this,arguments)}}(),q=function(o){switch(o){case"JavaScript":return"javascript";case"Json":return"json";case"Liquid":return"liquid";case"SQL":return"sql";case"Literal":default:return"plaintext"}},_e=function(o){var i,r,e,s=((i=o.supportedSyntaxes)!==null&&i!==void 0?i:[]).map(function(D){return D}),l=(r=o.defaultSyntax)!==null&&r!==void 0?r:"Literal",v="";if(l&&s.length==0&&s.push(l),l=="Switch"&&s.indexOf("Json")==-1&&s.push("Json"),(e=o.options)!==null&&e!==void 0&&e.syntax){var c;s=[],l="Literal",v=(c=o.options)===null||c===void 0?void 0:c.syntax}return o.uiHint!="check-list"&&o.uiHint!="radio-list"&&o.uiHint!="code-editor"&&o.uiHint!="dictionary"&&o.uiHint!="dynamic-list"&&o.uiHint!="multi-text"&&o.uiHint!="switch-case-builder"&&s.indexOf("Literal")==-1&&(s=["Literal"].concat((0,w.Z)(s))),s.length>0&&(l=s[0]),{supports:s,default:l,editor:v}},z=function(){},be=function(o,i){var r=o.getPortsByGroup("bottom");o.removePorts(r,{silent:!0})},Ee=function(o){var i,r=o.getPortsByGroup("bottom");o.removePorts(r,{silent:!0});var e=(i=o.getProp("outcomes"))!==null&&i!==void 0?i:[];o.addPorts(e.map(function(s){return{id:uuid(),group:"bottom",label:s,outcome:s}}))},se=function(o,i){var r,e=(i??[]).map(function(l){var v;return(v=l.getProp("name"))!==null&&v!==void 0?v:""}).filter(function(l){return l}),s=((r=o.getProp("outcomes"))!==null&&r!==void 0?r:[]).map(function(l){return l.toString()});return s.length>e.length},T=function(o,i){var r,e=(i??[]).map(function(v){var c;return(c=v.getProp("name"))!==null&&c!==void 0?c:""}).filter(function(v){return v}),s=((r=o.getProp("outcomes"))!==null&&r!==void 0?r:[]).map(function(v){return v.toString()}),l=s.filter(function(v){return e.indexOf(v)==-1});return l.length>0?l[0].toString():null},E=function(o,i,r){var e=(r??[]).map(function(l){var v;return(v=l.getProp("name"))!==null&&v!==void 0?v:""}),s=e.filter(function(l){return i.indexOf(l)==-1});return s},oe=function(o){var i=o.id,r=o.label,e=o.name,s=o.type,l=o.displayName,v=i||(0,K.V)(),c=r??s,D={id:v,label:c,displayName:l??c,name:e??(0,U.CY)(s),icon:X(s)};return(0,A.Z)((0,A.Z)((0,A.Z)({shape:ee.b6},o),D),{},{data:(0,A.Z)({},D)})},ue=function(o){var i,r=o.id,e=o.label,s=o.name,l=r??(0,K.V)(),v=(i=e??s)!==null&&i!==void 0?i:"Done";return(0,A.Z)((0,A.Z)((0,A.Z)({},ee.Rd),{},{shape:ee.PP},o),{},{id:l,name:v,label:v,outcome:v})},de=function(o){console.debug("graph data: ",o);var i=o.edges.map(function(e){var s,l;return{sourceId:e.source.cell,targetId:e.target.cell,sourceActivityId:e.source.cell,targetActivityId:e.target.cell,outcome:(s=(l=e.name)!==null&&l!==void 0?l:e.outcome)!==null&&s!==void 0?s:"Done",attributes:{sourcePort:e.source.port,targetPort:e.target.port}}}),r=o.nodes.map(function(e){var s,l,v,c,D,y,I,j,N,J=(s=e.outcomes)!==null&&s!==void 0?s:[];return J.length||(J=i.filter(function(H){return H.sourceId==e.id}).map(function(H){return H.outcome})),(0,A.Z)((0,A.Z)({},(l=e.data)!==null&&l!==void 0?l:{}),{},{activityId:e.id,type:e.type,name:(v=e.name)!==null&&v!==void 0?v:(0,U.CY)(e.type),displayName:(c=(D=e.displayName)!==null&&D!==void 0?D:e.label)!==null&&c!==void 0?c:e.type,description:e.description,properties:e.properties,attributes:{x:Math.round((y=(I=e.position)===null||I===void 0?void 0:I.x)!==null&&y!==void 0?y:0),y:Math.round((j=(N=e.position)===null||N===void 0?void 0:N.y)!==null&&j!==void 0?j:0),outcomes:J}})});return{activities:r,connections:i}},ne=function(){var _=(0,C.Z)((0,h.Z)().mark(function o(i,r){var e,s;return(0,h.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return e=[],i.forEach(function(){var c=(0,C.Z)((0,h.Z)().mark(function D(y){var I,j,N,J,H,fe,P;return(0,h.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:e.push(oe({data:y,id:y.activityId,x:parseInt((I=(j=y.attributes)===null||j===void 0?void 0:j.x)!==null&&I!==void 0?I:0),y:parseInt((N=(J=y.attributes)===null||J===void 0?void 0:J.y)!==null&&N!==void 0?N:0),outcomes:(H=(fe=y.attributes)===null||fe===void 0?void 0:fe.outcomes)!==null&&H!==void 0?H:[],label:(P=y.displayName)!==null&&P!==void 0?P:y.type,displayName:y.displayName,name:y.name,type:y.type,description:y.description,properties:y.properties}));case 1:case"end":return u.stop()}},D)}));return function(D){return c.apply(this,arguments)}}()),s=[],r.forEach(function(c){var D,y=c.sourceId,I=c.targetId,j=(D=c.attributes)!==null&&D!==void 0?D:{};if(y&&e.findIndex(function(H){return H.id==y})>=0&&I&&e.findIndex(function(H){return H.id==I})>=0){var N,J;s.push(ue({id:(0,K.V)(),label:c.outcome,outcome:c.outcome,source:{cell:y,port:(N=j==null?void 0:j.sourcePort)!==null&&N!==void 0?N:"bottom"},target:{cell:I,port:(J=j==null?void 0:j.targetPort)!==null&&J!==void 0?J:"top"}}))}else console.debug("edge source id ".concat(y," or target id ").concat(I," not found"))}),v.abrupt("return",{nodes:e,edges:s});case 5:case"end":return v.stop()}},o)}));return function(i,r){return _.apply(this,arguments)}}(),ye=function(){var _=(0,C.Z)((0,h.Z)().mark(function o(i){var r,e;return(0,h.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,Z._T)(i);case 2:return e=l.sent,l.next=5,e==null||(r=e.response)===null||r===void 0?void 0:r.text();case 5:return l.abrupt("return",l.sent);case 6:case"end":return l.stop()}},o)}));return function(i){return _.apply(this,arguments)}}(),g=function(o,i){var r,e=i.cell,s=i.view,l=i.magnet;return l?e.isNode()&&!se(e,(r=o.getOutgoingEdges(e))!==null&&r!==void 0?r:[])?(F.ZP.error((0,R.wv)({id:"page.designer.noMoreOutcomes"})),!1):!0:!1},re=function(o,i){var r=i.targetMagnet;return!!r},te=function(o,i){var r=i.edge,e=i.type;return r.getProp("shape")=="elsa-edge"},ie=function(o,i){var r=i.sourceCell,e=i.sourceMagnet;if(r.isNode()){var s,l=T(r,(s=o.getOutgoingEdges(r))!==null&&s!==void 0?s:[]);return l?new S.bn.kS(ue({id:"",label:l})):(F.ZP.error((0,R.wv)({id:"page.designer.noMoreOutcomes"})),null)}else return null},ae=function(o){return new S.kJ((0,A.Z)({container:document.getElementById("graphContainer"),autoResize:!0,grid:{size:10,visible:!0},history:{enabled:!0,beforeAddCommand:function(r,e){return(e==null?void 0:e.key)!="tools"}},mousewheel:{enabled:!0,zoomAtMousePosition:!0,modifiers:["ctrl"],minScale:.5,maxScale:1.5},scroller:{padding:40},panning:{enabled:!0,modifiers:"ctrl"},minimap:{enabled:!0,container:document.getElementById("minimap"),width:230,height:180},snapline:!0,keyboard:!0,selecting:{enabled:!0,multiple:!0,rubberband:!0},clipboard:{enabled:!0,useLocalStorage:!0},translating:{restrict:!0},connecting:{router:{name:"manhattan",args:{step:10}},connector:{name:"rounded",args:{radius:10}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,allowMulti:"withPort",snap:!0,highlight:!0,allowLoop:!1,allowEdge:!1},highlighting:{magnetAvailable:{name:"stroke",args:{padding:4,attrs:{"stroke-width":1,stroke:"#47C769",fill:"#ffffff"}}},magnetAdsorbed:{name:"stroke",args:{attrs:{stroke:"#47C769",fill:"#47C769"}}}}},o))},ce=function(){return{}}},64860:function(ge,Q,a){"use strict";a.d(Q,{xr:function(){return h},TX:function(){return Z},_T:function(){return $}});var B=a(39428),F=a(11849),A=a(3182),w=a(25377);function h(W){return C.apply(this,arguments)}function C(){return C=(0,A.Z)((0,B.Z)().mark(function W(G){return(0,B.Z)().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.abrupt("return",(0,w.WY)("/api/designer/activity-types",(0,F.Z)({method:"GET"},G||{})));case 1:case"end":return K.stop()}},W)})),C.apply(this,arguments)}function Z(W,G){return U.apply(this,arguments)}function U(){return U=(0,A.Z)((0,B.Z)().mark(function W(G,S){return(0,B.Z)().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.abrupt("return",(0,w.WY)("/api/designer/runtime-select-list",(0,F.Z)({method:"POST",data:G},S||{})));case 1:case"end":return R.stop()}},W)})),U.apply(this,arguments)}function $(W,G){return V.apply(this,arguments)}function V(){return V=(0,A.Z)((0,B.Z)().mark(function W(G,S){return(0,B.Z)().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.abrupt("return",(0,w.WY)("/api/designer/scripting/javascript/type-definitions/".concat(G),(0,F.Z)({method:"GET",getResponse:!0},S||{})));case 1:case"end":return R.stop()}},W)})),V.apply(this,arguments)}},64322:function(ge,Q,a){"use strict";a.d(Q,{CY:function(){return B},xy:function(){return F}});var B=function(){for(var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,Z="",U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",$=U.length,V=0;V<C;V++)Z+=U.charAt(Math.floor(Math.random()*$));return h?"".concat(h,"_").concat(Z):Z},F=function(h,C){var Z=new Blob([C],{type:"application/json"}),U=window.URL.createObjectURL(Z),$=document.createElement("a");$.href=U,$.download=h,document.body.appendChild($),$.click(),document.body.removeChild($),window.URL.revokeObjectURL(U)},A=function(h){var C=Object.keys(h).filter(function(Z){return isInteger(Z)}).forEach(function(Z){return _defineProperty({},Z,{text:h[Z]})});return C}}}]);
