(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[784],{62602:function(we,I,S){"use strict";S.d(I,{Z:function(){return Z}});var N=S(28991),x=S(67294),ee={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M342 88H120c-17.7 0-32 14.3-32 32v224c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V168h174c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16zm578 576h-48c-8.8 0-16 7.2-16 16v176H682c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h222c17.7 0 32-14.3 32-32V680c0-8.8-7.2-16-16-16zM342 856H168V680c0-8.8-7.2-16-16-16h-48c-8.8 0-16 7.2-16 16v224c0 17.7 14.3 32 32 32h222c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16zM904 88H682c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h174v176c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V120c0-17.7-14.3-32-32-32z"}}]},name:"expand",theme:"outlined"},V=ee,j=S(27029),H=function(he,me){return x.createElement(j.Z,(0,N.Z)((0,N.Z)({},he),{},{ref:me,icon:V}))};H.displayName="ExpandOutlined";var Z=x.forwardRef(H)},24557:function(we,I,S){"use strict";S.d(I,{Z:function(){return Z}});var N=S(28991),x=S(67294),ee={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.4 800.9c.2-.3.5-.6.7-.9C920.6 722.1 960 621.7 960 512s-39.4-210.1-104.8-288c-.2-.3-.5-.5-.7-.8-1.1-1.3-2.1-2.5-3.2-3.7-.4-.5-.8-.9-1.2-1.4l-4.1-4.7-.1-.1c-1.5-1.7-3.1-3.4-4.6-5.1l-.1-.1c-3.2-3.4-6.4-6.8-9.7-10.1l-.1-.1-4.8-4.8-.3-.3c-1.5-1.5-3-2.9-4.5-4.3-.5-.5-1-1-1.6-1.5-1-1-2-1.9-3-2.8-.3-.3-.7-.6-1-1C736.4 109.2 629.5 64 512 64s-224.4 45.2-304.3 119.2c-.3.3-.7.6-1 1-1 .9-2 1.9-3 2.9-.5.5-1 1-1.6 1.5-1.5 1.4-3 2.9-4.5 4.3l-.3.3-4.8 4.8-.1.1c-3.3 3.3-6.5 6.7-9.7 10.1l-.1.1c-1.6 1.7-3.1 3.4-4.6 5.1l-.1.1c-1.4 1.5-2.8 3.1-4.1 4.7-.4.5-.8.9-1.2 1.4-1.1 1.2-2.1 2.5-3.2 3.7-.2.3-.5.5-.7.8C103.4 301.9 64 402.3 64 512s39.4 210.1 104.8 288c.2.3.5.6.7.9l3.1 3.7c.4.5.8.9 1.2 1.4l4.1 4.7c0 .1.1.1.1.2 1.5 1.7 3 3.4 4.6 5l.1.1c3.2 3.4 6.4 6.8 9.6 10.1l.1.1c1.6 1.6 3.1 3.2 4.7 4.7l.3.3c3.3 3.3 6.7 6.5 10.1 9.6 80.1 74 187 119.2 304.5 119.2s224.4-45.2 304.3-119.2a300 300 0 0010-9.6l.3-.3c1.6-1.6 3.2-3.1 4.7-4.7l.1-.1c3.3-3.3 6.5-6.7 9.6-10.1l.1-.1c1.5-1.7 3.1-3.3 4.6-5 0-.1.1-.1.1-.2 1.4-1.5 2.8-3.1 4.1-4.7.4-.5.8-.9 1.2-1.4a99 99 0 003.3-3.7zm4.1-142.6c-13.8 32.6-32 62.8-54.2 90.2a444.07 444.07 0 00-81.5-55.9c11.6-46.9 18.8-98.4 20.7-152.6H887c-3 40.9-12.6 80.6-28.5 118.3zM887 484H743.5c-1.9-54.2-9.1-105.7-20.7-152.6 29.3-15.6 56.6-34.4 81.5-55.9A373.86 373.86 0 01887 484zM658.3 165.5c39.7 16.8 75.8 40 107.6 69.2a394.72 394.72 0 01-59.4 41.8c-15.7-45-35.8-84.1-59.2-115.4 3.7 1.4 7.4 2.9 11 4.4zm-90.6 700.6c-9.2 7.2-18.4 12.7-27.7 16.4V697a389.1 389.1 0 01115.7 26.2c-8.3 24.6-17.9 47.3-29 67.8-17.4 32.4-37.8 58.3-59 75.1zm59-633.1c11 20.6 20.7 43.3 29 67.8A389.1 389.1 0 01540 327V141.6c9.2 3.7 18.5 9.1 27.7 16.4 21.2 16.7 41.6 42.6 59 75zM540 640.9V540h147.5c-1.6 44.2-7.1 87.1-16.3 127.8l-.3 1.2A445.02 445.02 0 00540 640.9zm0-156.9V383.1c45.8-2.8 89.8-12.5 130.9-28.1l.3 1.2c9.2 40.7 14.7 83.5 16.3 127.8H540zm-56 56v100.9c-45.8 2.8-89.8 12.5-130.9 28.1l-.3-1.2c-9.2-40.7-14.7-83.5-16.3-127.8H484zm-147.5-56c1.6-44.2 7.1-87.1 16.3-127.8l.3-1.2c41.1 15.6 85 25.3 130.9 28.1V484H336.5zM484 697v185.4c-9.2-3.7-18.5-9.1-27.7-16.4-21.2-16.7-41.7-42.7-59.1-75.1-11-20.6-20.7-43.3-29-67.8 37.2-14.6 75.9-23.3 115.8-26.1zm0-370a389.1 389.1 0 01-115.7-26.2c8.3-24.6 17.9-47.3 29-67.8 17.4-32.4 37.8-58.4 59.1-75.1 9.2-7.2 18.4-12.7 27.7-16.4V327zM365.7 165.5c3.7-1.5 7.3-3 11-4.4-23.4 31.3-43.5 70.4-59.2 115.4-21-12-40.9-26-59.4-41.8 31.8-29.2 67.9-52.4 107.6-69.2zM165.5 365.7c13.8-32.6 32-62.8 54.2-90.2 24.9 21.5 52.2 40.3 81.5 55.9-11.6 46.9-18.8 98.4-20.7 152.6H137c3-40.9 12.6-80.6 28.5-118.3zM137 540h143.5c1.9 54.2 9.1 105.7 20.7 152.6a444.07 444.07 0 00-81.5 55.9A373.86 373.86 0 01137 540zm228.7 318.5c-39.7-16.8-75.8-40-107.6-69.2 18.5-15.8 38.4-29.7 59.4-41.8 15.7 45 35.8 84.1 59.2 115.4-3.7-1.4-7.4-2.9-11-4.4zm292.6 0c-3.7 1.5-7.3 3-11 4.4 23.4-31.3 43.5-70.4 59.2-115.4 21 12 40.9 26 59.4 41.8a373.81 373.81 0 01-107.6 69.2z"}}]},name:"global",theme:"outlined"},V=ee,j=S(27029),H=function(he,me){return x.createElement(j.Z,(0,N.Z)((0,N.Z)({},he),{},{ref:me,icon:V}))};H.displayName="GlobalOutlined";var Z=x.forwardRef(H)},92104:function(we,I,S){"use strict";S.d(I,{Z:function(){return Z}});var N=S(28991),x=S(67294),ee={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"},V=ee,j=S(27029),H=function(he,me){return x.createElement(j.Z,(0,N.Z)((0,N.Z)({},he),{},{ref:me,icon:V}))};H.displayName="SaveOutlined";var Z=x.forwardRef(H)},63434:function(we,I,S){"use strict";var N=S(63185),x=S(9676),ee=S(28991),V=S(81253),j=S(85893),H=S(22270),Z=S(67294),De=S(64893),he=S(91939),me=["options","fieldProps","proFieldProps","valueEnum"],rt=Z.forwardRef(function(dt,ht){var vt=dt.options,Ne=dt.fieldProps,Ae=dt.proFieldProps,xt=dt.valueEnum,at=(0,V.Z)(dt,me);return(0,j.jsx)(he.Z,(0,ee.Z)({ref:ht,valueType:"checkbox",valueEnum:(0,H.h)(xt,void 0),fieldProps:(0,ee.Z)({options:vt},Ne),lightProps:(0,ee.Z)({labelFormatter:function(){return(0,j.jsx)(he.Z,(0,ee.Z)({ref:ht,valueType:"checkbox",mode:"read",valueEnum:(0,H.h)(xt,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,ee.Z)({options:vt},Ne),proFieldProps:Ae},at))}},at.lightProps),proFieldProps:Ae},at))}),ke=Z.forwardRef(function(dt,ht){var vt=dt.fieldProps,Ne=dt.children;return(0,j.jsx)(x.Z,(0,ee.Z)((0,ee.Z)({ref:ht},vt),{},{children:Ne}))}),Gt=(0,De.G)(ke,{valuePropName:"checked"}),Yt=Gt;Yt.Group=rt,I.Z=Yt},64317:function(we,I,S){"use strict";var N=S(28991),x=S(81253),ee=S(85893),V=S(22270),j=S(67294),H=S(66758),Z=S(91939),De=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],he=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],me=j.forwardRef(function(dt,ht){var vt=dt.fieldProps,Ne=dt.children,Ae=dt.params,xt=dt.proFieldProps,at=dt.mode,tt=dt.valueEnum,St=dt.request,Mt=dt.showSearch,zt=dt.options,pt=(0,x.Z)(dt,De),en=(0,j.useContext)(H.Z);return(0,ee.jsx)(Z.Z,(0,N.Z)((0,N.Z)({valueEnum:(0,V.h)(tt),request:St,params:Ae,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,N.Z)({options:zt,mode:at,showSearch:Mt,getPopupContainer:en.getPopupContainer},vt),ref:ht,proFieldProps:xt},pt),{},{children:Ne}))}),rt=j.forwardRef(function(dt,ht){var vt=dt.fieldProps,Ne=dt.children,Ae=dt.params,xt=dt.proFieldProps,at=dt.mode,tt=dt.valueEnum,St=dt.request,Mt=dt.options,zt=(0,x.Z)(dt,he),pt=(0,N.Z)({options:Mt,mode:at||"multiple",labelInValue:!0,showSearch:!0,showArrow:!1,autoClearSearchValue:!0,optionLabelProp:"label"},vt),en=(0,j.useContext)(H.Z);return(0,ee.jsx)(Z.Z,(0,N.Z)((0,N.Z)({valueEnum:(0,V.h)(tt),request:St,params:Ae,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,N.Z)({getPopupContainer:en.getPopupContainer},pt),ref:ht,proFieldProps:xt},zt),{},{children:Ne}))}),ke=me,Gt=rt,Yt=ke;Yt.SearchSelect=Gt,Yt.displayName="ProFormComponent",I.Z=Yt},52688:function(we,I,S){"use strict";var N=S(28991),x=S(81253),ee=S(85893),V=S(67294),j=S(91939),H=["fieldProps","unCheckedChildren","checkedChildren","proFieldProps"],Z=V.forwardRef(function(De,he){var me=De.fieldProps,rt=De.unCheckedChildren,ke=De.checkedChildren,Gt=De.proFieldProps,Yt=(0,x.Z)(De,H);return(0,ee.jsx)(j.Z,(0,N.Z)({valueType:"switch",fieldProps:(0,N.Z)({unCheckedChildren:rt,checkedChildren:ke},me),ref:he,valuePropName:"checked",proFieldProps:Gt,filedConfig:{valuePropName:"checked",ignoreWidth:!0}},Yt))});I.Z=Z},5966:function(we,I,S){"use strict";var N=S(28991),x=S(81253),ee=S(85893),V=S(91939),j=["fieldProps","proFieldProps"],H=["fieldProps","proFieldProps"],Z="text",De=function(ke){var Gt=ke.fieldProps,Yt=ke.proFieldProps,dt=(0,x.Z)(ke,j);return(0,ee.jsx)(V.Z,(0,N.Z)({valueType:Z,fieldProps:Gt,filedConfig:{valueType:Z},proFieldProps:Yt},dt))},he=function(ke){var Gt=ke.fieldProps,Yt=ke.proFieldProps,dt=(0,x.Z)(ke,H);return(0,ee.jsx)(V.Z,(0,N.Z)({valueType:"password",fieldProps:Gt,proFieldProps:Yt,filedConfig:{valueType:Z}},dt))},me=De;me.Password=he,me.displayName="ProFormComponent",I.Z=me},90672:function(we,I,S){"use strict";var N=S(28991),x=S(81253),ee=S(85893),V=S(67294),j=S(91939),H=["fieldProps","proFieldProps"],Z=function(he,me){var rt=he.fieldProps,ke=he.proFieldProps,Gt=(0,x.Z)(he,H);return(0,ee.jsx)(j.Z,(0,N.Z)({ref:me,valueType:"textarea",fieldProps:rt,proFieldProps:ke},Gt))};I.Z=V.forwardRef(Z)},16894:function(we,I,S){"use strict";var N=S(78775),x=S(4674);I.ZP=x.Z},20499:function(){},64851:function(){},59518:function(){},26199:function(){},14156:function(){},71468:function(){},48871:function(){},9871:function(){},25612:function(){},92777:function(){},20159:function(){},61622:function(){},69609:function(we,I,S){"use strict";S.d(I,{Vq:function(){return Os}});var N={};S.r(N),S.d(N,{components:function(){return zn},dfs:function(){return Mr},dijkstra:function(){return ad},dijkstraAll:function(){return ws},findCycles:function(){return Yo},floydWarshall:function(){return El},isAcyclic:function(){return yl},postorder:function(){return ca},preorder:function(){return wo},prim:function(){return Zn},tarjan:function(){return hf},topsort:function(){return mf}});const x=e=>typeof e=="string",ee=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},V=/-(\w)/g,j=ee(e=>e.replace(V,(t,n)=>n?n.toUpperCase():"")),H=Array.isArray,Z=e=>typeof e=="number",De=e=>Number.isNaN(Number(e)),he=e=>{const t=parseFloat(e);return De(t)?e:t},me=e=>e!==null&&typeof e=="object",rt=e=>{if(e===null)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof Array){const t=[];return e.forEach(n=>{t.push(n)}),t.map(n=>rt(n))}if(typeof e=="object"&&Object.keys(e).length){const t=Object.assign({},e);return Object.keys(t).forEach(n=>{t[n]=rt(t[n])}),t}return e},ke=(e,t)=>{const n=e[t];return me(n)?n.cell:n},Gt=(e,t,n)=>{const r=[];for(let i=0;i<e;i++)r[i]={in:0,out:0,all:0};return n&&n.forEach(i=>{const a=ke(i,"source"),o=ke(i,"target");a&&r[t[a]]&&(r[t[a]].out+=1,r[t[a]].all+=1),o&&r[t[o]]&&(r[t[o]].in+=1,r[t[o]].all+=1)}),r},Yt=(e,t)=>{const n={};return e.forEach(r=>{n[r.id]={in:0,out:0,all:0}}),t&&t.forEach(r=>{const i=ke(r,"source"),a=ke(r,"target");i&&(n[i].out+=1,n[i].all+=1),a&&(n[a].in+=1,n[a].all+=1)}),n},dt=e=>{const t=[],n=e.length;for(let r=0;r<n;r+=1){t[r]=[];for(let i=0;i<n;i+=1)r===i?t[r][i]=0:e[r][i]===0||!e[r][i]?t[r][i]=Infinity:t[r][i]=e[r][i]}for(let r=0;r<n;r+=1)for(let i=0;i<n;i+=1)for(let a=0;a<n;a+=1)t[i][a]>t[i][r]+t[r][a]&&(t[i][a]=t[i][r]+t[r][a]);return t},ht=(e,t)=>{const{nodes:n,edges:r}=e,i=[],a={};if(!n)throw new Error("invalid nodes data!");return n&&n.forEach((o,s)=>{a[o.id]=s;const c=[];i.push(c)}),r==null||r.forEach(o=>{const s=ke(o,"source"),c=ke(o,"target"),f=a[s],d=a[c];f===void 0||d===void 0||(i[f][d]=1,t||(i[d][f]=1))}),i},vt=(e,t)=>{const n=[];return e.forEach(r=>{const i=[];r.forEach(a=>{i.push(a*t)}),n.push(i)}),n},Ne=(e,t)=>{if(e&&e.children){for(let n=e.children.length-1;n>=0;n--)if(!Ne(e.children[n],t))return}return!!t(e)},Ae=(e,t)=>{typeof t=="function"&&Ne(e,t)},xt=e=>{let t=Infinity,n=Infinity,r=-Infinity,i=-Infinity;return e.forEach(a=>{t>a.x&&(t=a.x),n>a.y&&(n=a.y),r<a.x&&(r=a.x),i<a.y&&(i=a.y)}),{minX:t,minY:n,maxX:r,maxY:i}},at=e=>{let t={x:0,y:0};e.forEach(r=>{t.x+=r.x||0,t.y+=r.y||0});const n=e.length||1;return{x:t.x/n,y:t.y/n}},tt=(e,t,n)=>{var r,i;return e==="source"?((r=n==null?void 0:n.find(a=>a.target===t.id))===null||r===void 0?void 0:r.source)||{}:((i=n==null?void 0:n.find(a=>a.source===t.id))===null||i===void 0?void 0:i.target)||{}},St=(e,t,n)=>{let r=[];switch(e){case"source":r=n==null?void 0:n.filter(a=>a.source===t.id).map(a=>a.target);break;case"target":r=n==null?void 0:n.filter(a=>a.target===t.id).map(a=>a.source);break;case"both":r=n==null?void 0:n.filter(a=>a.source===t.id).map(a=>a.target).concat(n==null?void 0:n.filter(a=>a.target===t.id).map(a=>a.source));break;default:break}const i=new Set(r);return Array.from(i)},Mt=(e,t,n,r,i)=>{const a=n[t]||"";let o=(r==null?void 0:r.filter(s=>s[t]===a))||[];return e==="leaf"&&(o=o.filter(s=>{var c,f;return((c=i[s.id])===null||c===void 0?void 0:c.in)===0||((f=i[s.id])===null||f===void 0?void 0:f.out)===0})),o},zt=(e,t,n,r,i,a)=>{const{in:o,out:s}=i[t.id];let c=t,f=[];o===0?(c=tt("source",t,n),f=St("both",c,n).map(h=>a[h])):s===0&&(c=tt("target",t,n),f=St("both",c,n).map(h=>a[h])),f=f.filter(h=>i[h.id]&&(i[h.id].in===0||i[h.id].out===0));const d=Mt(e,r,t,f,i);return{coreNode:c,relativeLeafNodes:f,sameTypeLeafNodes:d}},pt=e=>typeof e=="function",en=(e,t,n)=>{let r;return n?r=n:Z(e)?r=()=>e:r=()=>t,r},$n=(e,t,n=!0)=>!t&&t!==0?r=>r.size?H(r.size)?r.size[0]>r.size[1]?r.size[0]:r.size[1]:me(r.size)?r.size.width>r.size.height?r.size.width:r.size.height:r.size:e:pt(t)?t:Z(t)?()=>t:H(t)?()=>{if(n){const r=Math.max(...t);return isNaN(r)?e:r}return t}:me(t)?()=>{if(n){const r=Math.max(t.width,t.height);return isNaN(r)?e:r}return[t.width,t.height]}:()=>e,L=new Map,nt=(e,t)=>{if(L.get(e)&&console.warn(`The layout with the name ${e} exists already, it will be overridden`),isObject(t)){class n extends Base{constructor(i){super();const a=this,o={},s=a.getDefaultCfg();Object.assign(o,s,t,i),Object.keys(o).forEach(c=>{const f=o[c];a[c]=f})}}L.set(e,n)}else L.set(e,t);return L.get(e)},$t=e=>{L.has(e)&&L.delete(e)},ln=e=>L.has(e)?L.get(e):null;class jt{constructor(){this.nodes=[],this.edges=[],this.combos=[],this.comboEdges=[],this.hiddenNodes=[],this.hiddenEdges=[],this.hiddenCombos=[],this.positions=[],this.destroyed=!1,this.onLayoutEnd=()=>{}}layout(t){return this.init(t),this.execute(!0)}init(t){this.nodes=t.nodes||[],this.edges=t.edges||[],this.combos=t.combos||[],this.comboEdges=t.comboEdges||[],this.hiddenNodes=t.hiddenNodes||[],this.hiddenEdges=t.hiddenEdges||[],this.hiddenCombos=t.hiddenCombos||[]}execute(t){}executeWithWorker(){}getDefaultCfg(){return{}}updateCfg(t){t&&Object.assign(this,t)}getType(){return"base"}destroy(){this.nodes=null,this.edges=null,this.combos=null,this.positions=null,this.destroyed=!0}}class mn extends jt{constructor(t){super();this.begin=[0,0],this.preventOverlap=!0,this.preventOverlapPadding=10,this.condense=!1,this.sortBy="degree",this.nodes=[],this.edges=[],this.width=300,this.height=300,this.row=0,this.col=0,this.cellWidth=0,this.cellHeight=0,this.cellUsed={},this.id2manPos={},this.onLayoutEnd=()=>{},this.updateCfg(t)}getDefaultCfg(){return{begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30}}execute(){const t=this,{nodes:n,edges:r,begin:i}=t,a=n.length;if(a===0)return t.onLayoutEnd&&t.onLayoutEnd(),{nodes:n,edges:r};if(a===1)return n[0].x=i[0],n[0].y=i[1],t.onLayoutEnd&&t.onLayoutEnd(),{nodes:n,edges:r};let{sortBy:o,width:s,height:c}=t;const{condense:f,preventOverlapPadding:d,preventOverlap:h,nodeSpacing:v,nodeSize:m}=t,g=[];n.forEach(b=>{g.push(b)});const _={};if(g.forEach((b,A)=>{_[b.id]=A}),(o==="degree"||!x(o)||g[0][o]===void 0)&&(o="degree",De(n[0].degree))){const b=Gt(g.length,_,r);g.forEach((A,C)=>{A.degree=b[C].all})}g.sort((b,A)=>A[o]-b[o]),!s&&typeof window!="undefined"&&(s=window.innerWidth),!c&&typeof window!="undefined"&&(c=window.innerHeight);const y=t.rows,E=t.cols!=null?t.cols:t.columns;if(t.cells=a,y!=null&&E!=null?(t.rows=y,t.cols=E):y!=null&&E==null?(t.rows=y,t.cols=Math.ceil(t.cells/t.rows)):y==null&&E!=null?(t.cols=E,t.rows=Math.ceil(t.cells/t.cols)):(t.splits=Math.sqrt(t.cells*t.height/t.width),t.rows=Math.round(t.splits),t.cols=Math.round(t.width/t.height*t.splits)),t.rows=Math.max(t.rows,1),t.cols=Math.max(t.cols,1),t.cols*t.rows>t.cells){const b=t.small(),A=t.large();(b-1)*A>=t.cells?t.small(b-1):(A-1)*b>=t.cells&&t.large(A-1)}else for(;t.cols*t.rows<t.cells;){const b=t.small(),A=t.large();(A+1)*b>=t.cells?t.large(A+1):t.small(b+1)}if(t.cellWidth=s/t.cols,t.cellHeight=c/t.rows,f&&(t.cellWidth=0,t.cellHeight=0),h||v){const b=$n(10,v),A=$n(30,m,!1);g.forEach(C=>{(!C.x||!C.y)&&(C.x=0,C.y=0);const R=A(C)||30;let W,te;H(R)?(W=R[0],te=R[1]):(W=R,te=R);const Q=b!==void 0?b(C):d,re=W+Q,de=te+Q;t.cellWidth=Math.max(t.cellWidth,re),t.cellHeight=Math.max(t.cellHeight,de)})}t.cellUsed={},t.row=0,t.col=0,t.id2manPos={};for(let b=0;b<g.length;b++){const A=g[b];let C;if(t.position&&(C=t.position(A)),C&&(C.row!==void 0||C.col!==void 0)){const R={row:C.row,col:C.col};if(R.col===void 0)for(R.col=0;t.used(R.row,R.col);)R.col++;else if(R.row===void 0)for(R.row=0;t.used(R.row,R.col);)R.row++;t.id2manPos[A.id]=R,t.use(R.row,R.col)}t.getPos(A)}return t.onLayoutEnd&&t.onLayoutEnd(),{edges:r,nodes:g}}small(t){const n=this;let r;const i=n.rows||5,a=n.cols||5;return t==null?r=Math.min(i,a):Math.min(i,a)===n.rows?n.rows=t:n.cols=t,r}large(t){const n=this;let r;const i=n.rows||5,a=n.cols||5;return t==null?r=Math.max(i,a):Math.max(i,a)===n.rows?n.rows=t:n.cols=t,r}used(t,n){return this.cellUsed[`c-${t}-${n}`]||!1}use(t,n){const r=this;r.cellUsed[`c-${t}-${n}`]=!0}moveToNextCell(){const t=this,n=t.cols||5;t.col++,t.col>=n&&(t.col=0,t.row++)}getPos(t){const n=this,{begin:r,cellWidth:i,cellHeight:a}=n;let o,s;const c=n.id2manPos[t.id];if(c)o=c.col*i+i/2+r[0],s=c.row*a+a/2+r[1];else{for(;n.used(n.row,n.col);)n.moveToNextCell();o=n.col*i+i/2+r[0],s=n.row*a+a/2+r[1],n.use(n.row,n.col),n.moveToNextCell()}t.x=o,t.y=s}getType(){return"grid"}}const br=(e,t)=>{let n;return e?Z(e)?n=r=>e:n=e:n=r=>t||1,n};class fi extends jt{constructor(t){super();this.maxIteration=500,this.workerEnabled=!1,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.5,this.interval=.02,this.factor=1,this.linkDistance=1,this.gravity=10,this.preventOverlap=!0,this.collideStrength=1,this.tick=()=>{},this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.animate=!0,this.updateCfg(t)}getDefaultCfg(){return{maxIteration:500,gravity:10,enableTick:!0,animate:!0}}execute(){var t,n;const r=this,i=r.nodes;if(r.timeInterval!==void 0&&typeof window!="undefined"&&window.clearInterval(r.timeInterval),!i||i.length===0){(t=r.onLayoutEnd)===null||t===void 0||t.call(r);return}!r.width&&typeof window!="undefined"&&(r.width=window.innerWidth),!r.height&&typeof window!="undefined"&&(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);const a=r.center;if(i.length===1){i[0].x=a[0],i[0].y=a[1],(n=r.onLayoutEnd)===null||n===void 0||n.call(r);return}const o={},s={};i.forEach((h,v)=>{Z(h.x)||(h.x=Math.random()*r.width),Z(h.y)||(h.y=Math.random()*r.height),o[h.id]=h,s[h.id]=v}),r.nodeMap=o,r.nodeIdxMap=s,r.linkDistance=br(r.linkDistance,1),r.nodeStrength=br(r.nodeStrength,1),r.edgeStrength=br(r.edgeStrength,1);const c=r.nodeSize;let f;if(r.preventOverlap){const h=r.nodeSpacing;let v;Z(h)?v=()=>h:pt(h)?v=h:v=()=>0,c?H(c)?f=m=>Math.max(c[0],c[1])+v(m):f=m=>c+v(m):f=m=>m.size?H(m.size)?Math.max(m.size[0],m.size[1])+v(m):me(m.size)?Math.max(m.size.width,m.size.height)+v(m):m.size+v(m):10+v(m)}r.nodeSize=f;const d=r.edges;r.degrees=Gt(i.length,r.nodeIdxMap,d),r.getMass||(r.getMass=h=>h.mass||r.degrees[r.nodeIdxMap[h.id]].all||1),r.run()}run(){var t;const n=this,{maxIteration:r,nodes:i,workerEnabled:a,minMovement:o,animate:s}=n;if(!!i)if(a||!s){for(let c=0;c<r;c++){const f=n.runOneStep(c);if(n.reachMoveThreshold(i,f,o))break}(t=n.onLayoutEnd)===null||t===void 0||t.call(n)}else{if(typeof window=="undefined")return;let c=0;this.timeInterval=window.setInterval(()=>{var f,d;if(!i)return;const h=n.runOneStep(c)||[];n.reachMoveThreshold(i,h,o)&&((f=n.onLayoutEnd)===null||f===void 0||f.call(n),window.clearInterval(n.timeInterval)),c++,c>=r&&((d=n.onLayoutEnd)===null||d===void 0||d.call(n),window.clearInterval(n.timeInterval))},0)}}reachMoveThreshold(t,n,r){let i=0;return t.forEach((a,o)=>{const s=a.x-n[o].x,c=a.y-n[o].y;i+=Math.sqrt(s*s+c*c)}),i/=t.length,i<r}runOneStep(t){var n;const r=this,{nodes:i,edges:a}=r,o=[],s=[];if(!i)return;i.forEach((d,h)=>{o[2*h]=0,o[2*h+1]=0,s[2*h]=0,s[2*h+1]=0}),r.calRepulsive(o,i),a&&r.calAttractive(o,a),r.calGravity(o,i);const c=Math.max(.02,r.interval-t*.002);r.updateVelocity(o,s,c,i);const f=[];return i.forEach(d=>{f.push({x:d.x,y:d.y})}),r.updatePosition(s,c,i),(n=r.tick)===null||n===void 0||n.call(r),f}calRepulsive(t,n){const r=this,{getMass:i,factor:a,coulombDisScale:o,preventOverlap:s,collideStrength:c=1}=r,f=r.nodeStrength,d=r.nodeSize;n.forEach((h,v)=>{const m=i?i(h):1;n.forEach((g,_)=>{if(v>=_)return;let y=h.x-g.x,E=h.y-g.y;y===0&&E===0&&(y=Math.random()*.01,E=Math.random()*.01);const b=y*y+E*E,A=Math.sqrt(b),C=(A+.1)*o,R=y/A,W=E/A,te=(f(h)+f(g))*.5*a/(C*C),Q=i?i(g):1;if(t[2*v]+=R*te,t[2*v+1]+=W*te,t[2*_]-=R*te,t[2*_+1]-=W*te,s&&(d(h)+d(g))/2>A){const re=c*(f(h)+f(g))*.5/b;t[2*v]+=R*re/m,t[2*v+1]+=W*re/m,t[2*_]-=R*re/Q,t[2*_+1]-=W*re/Q}})})}calAttractive(t,n){const r=this,{nodeMap:i,nodeIdxMap:a,linkDistance:o,edgeStrength:s}=r,c=r.nodeSize,f=r.getMass;n.forEach((d,h)=>{const v=ke(d,"source"),m=ke(d,"target"),g=i[v],_=i[m];let y=_.x-g.x,E=_.y-g.y;y===0&&E===0&&(y=Math.random()*.01,E=Math.random()*.01);const b=Math.sqrt(y*y+E*E),A=y/b,C=E/b,te=((o(d,g,_)||1+(c(g)+c(g)||0)/2)-b)*s(d),Q=a[v],re=a[m],de=f?f(g):1,Ce=f?f(_):1;t[2*Q]-=A*te/de,t[2*Q+1]-=C*te/de,t[2*re]+=A*te/Ce,t[2*re+1]+=C*te/Ce})}calGravity(t,n){const r=this,i=r.center,a=r.gravity,o=r.degrees,s=n.length;for(let c=0;c<s;c++){const f=n[c];let d=f.x-i[0],h=f.y-i[1],v=a;if(r.getCenter){const m=r.getCenter(f,o[c].all);m&&Z(m[0])&&Z(m[1])&&Z(m[2])&&(d=f.x-m[0],h=f.y-m[1],v=m[2])}!v||(t[2*c]-=v*d,t[2*c+1]-=v*h)}}updateVelocity(t,n,r,i){const a=this,o=r*a.damping;i.forEach((s,c)=>{let f=t[2*c]*o||.01,d=t[2*c+1]*o||.01;const h=Math.sqrt(f*f+d*d);if(h>a.maxSpeed){const v=a.maxSpeed/h;f=v*f,d=v*d}n[2*c]=f,n[2*c+1]=d})}updatePosition(t,n,r){r.forEach((i,a)=>{if(Z(i.fx)&&Z(i.fy)){i.x=i.fx,i.y=i.fy;return}const o=t[2*a]*n,s=t[2*a+1]*n;i.x+=o,i.y+=s})}stop(){this.timeInterval&&typeof window!="undefined"&&window.clearInterval(this.timeInterval)}destroy(){const t=this;t.stop(),t.tick=null,t.nodes=null,t.edges=null,t.destroyed=!0}getType(){return"gForce"}}function Nr(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return pr(this.cover(t,n),t,n,e)}function pr(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,a=e._root,o={data:r},s=e._x0,c=e._y0,f=e._x1,d=e._y1,h,v,m,g,_,y,E,b;if(!a)return e._root=o,e;for(;a.length;)if((_=t>=(h=(s+f)/2))?s=h:f=h,(y=n>=(v=(c+d)/2))?c=v:d=v,i=a,!(a=a[E=y<<1|_]))return i[E]=o,e;if(m=+e._x.call(null,a.data),g=+e._y.call(null,a.data),t===m&&n===g)return o.next=a,i?i[E]=o:e._root=o,e;do i=i?i[E]=new Array(4):e._root=new Array(4),(_=t>=(h=(s+f)/2))?s=h:f=h,(y=n>=(v=(c+d)/2))?c=v:d=v;while((E=y<<1|_)==(b=(g>=v)<<1|m>=h));return i[b]=a,i[E]=o,e}function ti(e){var t,n,r=e.length,i,a,o=new Array(r),s=new Array(r),c=Infinity,f=Infinity,d=-Infinity,h=-Infinity;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t))||(o[n]=i,s[n]=a,i<c&&(c=i),i>d&&(d=i),a<f&&(f=a),a>h&&(h=a));if(c>d||f>h)return this;for(this.cover(c,f).cover(d,h),n=0;n<r;++n)pr(this,o[n],s[n],e[n]);return this}function mr(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,a=(r=Math.floor(t))+1;else{for(var o=i-n||1,s=this._root,c,f;n>e||e>=i||r>t||t>=a;)switch(f=(t<r)<<1|e<n,c=new Array(4),c[f]=s,s=c,o*=2,f){case 0:i=n+o,a=r+o;break;case 1:n=i-o,a=r+o;break;case 2:i=n+o,r=a-o;break;case 3:n=i-o,r=a-o;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this}function zr(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Ha(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Jn(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function Bi(e,t,n){var r,i=this._x0,a=this._y0,o,s,c,f,d=this._x1,h=this._y1,v=[],m=this._root,g,_;for(m&&v.push(new Jn(m,i,a,d,h)),n==null?n=Infinity:(i=e-n,a=t-n,d=e+n,h=t+n,n*=n);g=v.pop();)if(!(!(m=g.node)||(o=g.x0)>d||(s=g.y0)>h||(c=g.x1)<i||(f=g.y1)<a))if(m.length){var y=(o+c)/2,E=(s+f)/2;v.push(new Jn(m[3],y,E,c,f),new Jn(m[2],o,E,y,f),new Jn(m[1],y,s,c,E),new Jn(m[0],o,s,y,E)),(_=(t>=E)<<1|e>=y)&&(g=v[v.length-1],v[v.length-1]=v[v.length-1-_],v[v.length-1-_]=g)}else{var b=e-+this._x.call(null,m.data),A=t-+this._y.call(null,m.data),C=b*b+A*A;if(C<n){var R=Math.sqrt(n=C);i=e-R,a=t-R,d=e+R,h=t+R,r=m.data}}return r}function Xa(e){if(isNaN(d=+this._x.call(null,e))||isNaN(h=+this._y.call(null,e)))return this;var t,n=this._root,r,i,a,o=this._x0,s=this._y0,c=this._x1,f=this._y1,d,h,v,m,g,_,y,E;if(!n)return this;if(n.length)for(;;){if((g=d>=(v=(o+c)/2))?o=v:c=v,(_=h>=(m=(s+f)/2))?s=m:f=m,t=n,!(n=n[y=_<<1|g]))return this;if(!n.length)break;(t[y+1&3]||t[y+2&3]||t[y+3&3])&&(r=t,E=y)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):t?(a?t[y]=a:delete t[y],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[E]=n:this._root=n),this):(this._root=a,this)}function Su(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function vo(){return this._root}function Hi(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function ds(e){var t=[],n,r=this._root,i,a,o,s,c;for(r&&t.push(new Jn(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,a=n.x0,o=n.y0,s=n.x1,c=n.y1)&&r.length){var f=(a+s)/2,d=(o+c)/2;(i=r[3])&&t.push(new Jn(i,f,d,s,c)),(i=r[2])&&t.push(new Jn(i,a,d,f,c)),(i=r[1])&&t.push(new Jn(i,f,o,s,d)),(i=r[0])&&t.push(new Jn(i,a,o,f,d))}return this}function gi(e){var t=[],n=[],r;for(this._root&&t.push(new Jn(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var a,o=r.x0,s=r.y0,c=r.x1,f=r.y1,d=(o+c)/2,h=(s+f)/2;(a=i[0])&&t.push(new Jn(a,o,s,d,h)),(a=i[1])&&t.push(new Jn(a,d,s,c,h)),(a=i[2])&&t.push(new Jn(a,o,h,d,f)),(a=i[3])&&t.push(new Jn(a,d,h,c,f))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function li(e){return e[0]}function Tu(e){return arguments.length?(this._x=e,this):this._x}function Xi(e){return e[1]}function Zs(e){return arguments.length?(this._y=e,this):this._y}function hs(e,t,n){var r=new k(t??li,n??Xi,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function k(e,t,n,r,i,a){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function $i(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Wr=hs.prototype=k.prototype;Wr.copy=function(){var e=new k(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=$i(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=$i(r));return e},Wr.add=Nr,Wr.addAll=ti,Wr.cover=mr,Wr.data=zr,Wr.extent=Ha,Wr.find=Bi,Wr.remove=Xa,Wr.removeAll=Su,Wr.root=vo,Wr.size=Hi,Wr.visit=ds,Wr.visitAfter=gi,Wr.x=Tu,Wr.y=Zs;const vs=.81,Uo=.1;function zi(e,t,n,r,i){const a=n/r,o=e.map((c,f)=>{const d=t[c.id],{data:h,x:v,y:m,size:g}=d,{nodeStrength:_}=h.layout.force;return{x:v,y:m,size:g,index:f,vx:0,vy:0,weight:a*_}}),s=hs(o,c=>c.x,c=>c.y).visitAfter($a);return o.forEach(c=>{Xe(c,s)}),o.map((c,f)=>{const d=t[e[f].id],{mass:h=1}=d.data.layout.force;i[2*f]=c.vx/h,i[2*f+1]=c.vy/h}),i}function $a(e){let t=0,n=0,r=0;if(e.length){for(let i=0;i<4;i++){const a=e[i];a&&a.weight&&(t+=a.weight,n+=a.x*a.weight,r+=a.y*a.weight)}e.x=n/t,e.y=r/t,e.weight=t}else{const i=e;e.x=i.data.x,e.y=i.data.y,e.weight=i.data.weight}}const xe=(e,t,n,r,i,a)=>{const o=a.x-e.x||Uo,s=a.y-e.y||Uo,c=r-t,f=o*o+s*s,d=Math.sqrt(f)*f;if(c*c*vs<f){const h=e.weight/d;return a.vx+=o*h,a.vy+=s*h,!0}if(e.length)return!1;if(e.data!==a){const h=e.data.weight/d;a.vx+=o*h,a.vy+=s*h}};function Xe(e,t){t.visit((n,r,i,a,o)=>xe(n,r,i,a,o,e))}const bt=(e,t)=>{let n;return e?Z(e)?n=r=>e:n=e:n=r=>t||1,n};class Ft extends jt{constructor(t){super();this.maxIteration=1e3,this.workerEnabled=!1,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.4,this.interval=.02,this.factor=1,this.linkDistance=200,this.gravity=0,this.clusterNodeStrength=20,this.preventOverlap=!0,this.distanceThresholdMode="mean",this.tick=()=>{},this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.judgingDistance=0,this.centripetalOptions={leaf:2,single:2,others:1,center:r=>({x:this.width/2,y:this.height/2})};const{getMass:n}=t;this.propsGetMass=n,this.updateCfg(t)}getCentripetalOptions(){const{leafCluster:t,clustering:n,nodeClusterBy:r,nodes:i,nodeMap:a,clusterNodeStrength:o}=this,s=m=>typeof o=="function"?o(m):o;let c={},f;if(t){f=this.getSameTypeLeafMap()||{};const m=Array.from(new Set(i==null?void 0:i.map(g=>g[r])))||[];c={single:100,leaf:(g,_,y)=>{const{relativeLeafNodes:E,sameTypeLeafNodes:b}=f[g.id]||{};return(b==null?void 0:b.length)===(E==null?void 0:E.length)||(m==null?void 0:m.length)===1?1:s(g)},others:1,center:(g,_,y)=>{var E;const{degree:b}=((E=g.data)===null||E===void 0?void 0:E.layout)||{};if(!b)return{x:100,y:100};let A;if(b===1){const{sameTypeLeafNodes:C=[]}=f[g.id]||{};C.length===1?A=void 0:C.length>1&&(A=at(C))}else A=void 0;return{x:A==null?void 0:A.x,y:A==null?void 0:A.y}}}}if(n){f||(f=this.getSameTypeLeafMap());const m=Array.from(new Set(i.map((_,y)=>_[r]))).filter(_=>_!==void 0),g={};m.forEach(_=>{const y=i.filter(E=>E[r]===_).map(E=>a[E.id]);g[_]=at(y)}),c={single:_=>s(_),leaf:_=>s(_),others:_=>s(_),center:(_,y,E)=>{const b=g[_[r]];return{x:b==null?void 0:b.x,y:b==null?void 0:b.y}}}}this.centripetalOptions=Object.assign(Object.assign({},this.centripetalOptions),c);const{leaf:d,single:h,others:v}=this.centripetalOptions;d&&typeof d!="function"&&(this.centripetalOptions.leaf=()=>d),h&&typeof h!="function"&&(this.centripetalOptions.single=()=>h),v&&typeof v!="function"&&(this.centripetalOptions.others=()=>v)}updateCfg(t){t&&Object.assign(this,t)}getDefaultCfg(){return{maxIteration:500,gravity:10,enableTick:!0,animate:!0}}execute(){const t=this;t.stop();const{nodes:n,edges:r,defSpringLen:i}=t;if(t.judgingDistance=0,!n||n.length===0){t.onLayoutEnd([]);return}!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight),t.center||(t.center=[t.width/2,t.height/2]);const a=t.center;if(n.length===1){n[0].x=a[0],n[0].y=a[1],t.onLayoutEnd([Object.assign({},n[0])]);return}t.degreesMap=Yt(n,r),t.propsGetMass?t.getMass=t.propsGetMass:t.getMass=d=>{let h=1;Z(d.mass)&&(h=d.mass);const v=t.degreesMap[d.id].all;return!v||v<5?h:v*5*h};const o=t.nodeSize;let s;if(t.preventOverlap){const d=t.nodeSpacing;let h;Z(d)?h=()=>d:pt(d)?h=d:h=()=>0,o?H(o)?s=v=>Math.max(o[0],o[1])+h(v):s=v=>o+h(v):s=v=>v.size?H(v.size)?Math.max(v.size[0],v.size[1])+h(v):me(v.size)?Math.max(v.size.width,v.size.height)+h(v):v.size+h(v):10+h(v)}t.nodeSize=s,t.linkDistance=bt(t.linkDistance,1),t.nodeStrength=bt(t.nodeStrength,1),t.edgeStrength=bt(t.edgeStrength,1);const c={},f={};n.forEach((d,h)=>{Z(d.x)||(d.x=Math.random()*t.width),Z(d.y)||(d.y=Math.random()*t.height);const v=t.degreesMap[d.id];c[d.id]=Object.assign(Object.assign({},d),{data:Object.assign(Object.assign({},d.data),{size:t.nodeSize(d)||30,layout:{inDegree:v.in,outDegree:v.out,degree:v.all,tDegree:v.in,sDegree:v.out,force:{mass:t.getMass(d),nodeStrength:t.nodeStrength(d)}}})}),f[d.id]=h}),t.nodeMap=c,t.nodeIdxMap=f,t.edgeInfos=[],r==null||r.forEach(d=>{const h=c[d.source],v=c[d.target];!h||!v?elf.edgeInfos.push({}):t.edgeInfos.push({edgeStrength:t.edgeStrength(d),linkDistance:i?i(Object.assign(Object.assign({},d),{source:h,target:v}),h,v):t.linkDistance(d,h,v)||1+(o(h)+o(h)||0)/2})}),this.getCentripetalOptions(),t.onLayoutEnd=t.onLayoutEnd||(()=>{}),t.run()}run(){const t=this,{maxIteration:n,nodes:r,workerEnabled:i,minMovement:a,animate:o,nodeMap:s}=t;if(!r)return;const c=[];r.forEach((h,v)=>{c[2*v]=0,c[2*v+1]=0});const f=n;if(i||!o){let h=0;for(let v=0;(t.judgingDistance>a||v<1)&&v<f;v++)h=v,t.runOneStep(v,c);t.onLayoutEnd(Object.values(s))}else{if(typeof window=="undefined")return;let h=0;this.timeInterval=window.setInterval(()=>{!r||(t.runOneStep(h,c),h++,(h>=f||t.judgingDistance<a)&&(t.onLayoutEnd(Object.values(s)),window.clearInterval(t.timeInterval)))},0)}}runOneStep(t,n){var r;const i=this,{nodes:a,edges:o,nodeMap:s,monitor:c}=i,f=[];if(!(a==null?void 0:a.length))return;i.calRepulsive(f),o&&i.calAttractive(f),i.calGravity(f);const d=i.interval;if(i.updateVelocity(f,n,d),i.updatePosition(n,d),(r=i.tick)===null||r===void 0||r.call(i),c){const h=this.calTotalEnergy(f);c({energy:h,nodes:a,edges:o,iterations:t})}}calTotalEnergy(t){const{nodes:n,nodeMap:r}=this;if(!(n==null?void 0:n.length))return 0;let i=0;return n.forEach((a,o)=>{const s=t[2*o],c=t[2*o+1],f=s*s+c*c,{mass:d=1}=r[a.id].data.layout.force;i+=d*f*.5}),i}calRepulsive(t){const n=this,{nodes:r,nodeMap:i,factor:a,coulombDisScale:o}=n,s=n.nodeSize;zi(r,i,a,o*o,t)}calAttractive(t){const n=this,{edges:r,nodeMap:i,nodeIdxMap:a,edgeInfos:o}=n,s=n.nodeSize;r.forEach((c,f)=>{const d=ke(c,"source"),h=ke(c,"target"),v=i[d],m=i[h];if(!v||!m)return;let g=m.x-v.x,_=m.y-v.y;!g&&!_&&(g=Math.random()*.01,_=Math.random()*.01);const y=Math.sqrt(g*g+_*_),E=g/y,b=_/y,{linkDistance:A=200,edgeStrength:C=200}=o[f]||{},W=(A-y)*C,te=v.data.layout.force.mass||1,Q=m.data.layout.force.mass||1,re=1/te,de=1/Q,Ce=E*W,ie=b*W,Ge=2*a[d],We=2*a[h];t[Ge]-=Ce*re,t[Ge+1]-=ie*re,t[We]+=Ce*de,t[We+1]+=ie*de})}calGravity(t){var n;const r=this,{nodes:i,edges:a=[],nodeMap:o,width:s,height:c,center:f,gravity:d,degreesMap:h,centripetalOptions:v}=r;if(!i)return;const m=i.length;for(let g=0;g<m;g++){const _=2*g,y=o[i[g].id],{mass:E=1}=y.data.layout.force;let b=0,A=0,C=d;const{in:R,out:W,all:te}=h[y.id],Q=(n=r.getCenter)===null||n===void 0?void 0:n.call(r,y,te);if(Q){const[re,de,Ce]=Q;b=y.x-re,A=y.y-de,C=Ce}else b=y.x-f[0],A=y.y-f[1];if(C&&(t[_]-=C*b/E,t[_+1]-=C*A/E),v){const{leaf:re,single:de,others:Ce,center:ie}=v,{x:Ge,y:We,centerStrength:It}=(ie==null?void 0:ie(y,i,a,s,c))||{x:0,y:0,centerStrength:0};if(!Z(Ge)||!Z(We))continue;const gn=(y.x-Ge)/E,pn=(y.y-We)/E;if(It&&(t[_]-=It*gn,t[_+1]-=It*pn),te===0){const vr=de(y);if(!vr)continue;t[_]-=vr*gn,t[_+1]-=vr*pn;continue}if(R===0||W===0){const vr=re(y,i,a);if(!vr)continue;t[_]-=vr*gn,t[_+1]-=vr*pn;continue}const bn=Ce(y);if(!bn)continue;t[_]-=bn*gn,t[_+1]-=bn*pn}}}updateVelocity(t,n,r){const i=this,{nodes:a,damping:o,maxSpeed:s}=i;!(a==null?void 0:a.length)||a.forEach((c,f)=>{let d=(n[2*f]+t[2*f]*r)*o||.01,h=(n[2*f+1]+t[2*f+1]*r)*o||.01;const v=Math.sqrt(d*d+h*h);if(v>s){const m=s/v;d=m*d,h=m*h}n[2*f]=d,n[2*f+1]=h})}updatePosition(t,n){const r=this,{nodes:i,distanceThresholdMode:a,nodeMap:o}=r;if(!(i==null?void 0:i.length)){this.judgingDistance=0;return}let s=0;a==="max"?r.judgingDistance=-Infinity:a==="min"&&(r.judgingDistance=Infinity),i.forEach((c,f)=>{const d=o[c.id];if(Z(c.fx)&&Z(c.fy)){c.x=c.fx,c.y=c.fy,d.x=c.x,d.y=c.y;return}const h=t[2*f]*n,v=t[2*f+1]*n;c.x+=h,c.y+=v,d.x=c.x,d.y=c.y;const m=Math.sqrt(h*h+v*v);switch(a){case"max":r.judgingDistance<m&&(r.judgingDistance=m);break;case"min":r.judgingDistance>m&&(r.judgingDistance=m);break;default:s=s+m;break}}),(!a||a==="mean")&&(r.judgingDistance=s/i.length)}stop(){this.timeInterval&&typeof window!="undefined"&&window.clearInterval(this.timeInterval)}destroy(){const t=this;t.stop(),t.tick=null,t.nodes=null,t.edges=null,t.destroyed=!0}getType(){return"force2"}getSameTypeLeafMap(){const{nodeClusterBy:t,nodes:n,edges:r,nodeMap:i,degreesMap:a}=this;if(!(n==null?void 0:n.length))return;const o={};return n.forEach((s,c)=>{a[s.id].all===1&&(o[s.id]=zt("leaf",s,r,t,a,i))}),o}}function Wt(e){return function(){return e}}function Rn(e){return(e()-.5)*1e-6}var Pn={value:function(){}};function Un(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new an(n)}function an(e){this._=e}function ir(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}an.prototype=Un.prototype={constructor:an,on:function(t,n){var r=this._,i=ir(t+"",r),a,o=-1,s=i.length;if(arguments.length<2){for(;++o<s;)if((a=(t=i[o]).type)&&(a=nr(r[a],t.name)))return a;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++o<s;)if(a=(t=i[o]).type)r[a]=wa(r[a],t.name,n);else if(n==null)for(a in r)r[a]=wa(r[a],t.name,null);return this},copy:function(){var t={},n=this._;for(var r in n)t[r]=n[r].slice();return new an(t)},call:function(t,n){if((a=arguments.length-2)>0)for(var r=new Array(a),i=0,a,o;i<a;++i)r[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],i=0,a=o.length;i<a;++i)o[i].value.apply(n,r)},apply:function(t,n,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],a=0,o=i.length;a<o;++a)i[a].value.apply(n,r)}};function nr(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function wa(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=Pn,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Au=Un,Bo=0,zo=0,ps=0,uf=1e3,di,js,Iu=0,po=0,Cu=0,Ya=typeof performance=="object"&&performance.now?performance:Date,cf=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Ru(){return po||(cf(ff),po=Ya.now()+Cu)}function ff(){po=0}function ms(){this._call=this._time=this._next=null}ms.prototype=pc.prototype={constructor:ms,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Ru():+n)+(t==null?0:+t),!this._next&&js!==this&&(js?js._next=this:di=this,js=this),this._call=e,this._time=n,Ue()},stop:function(){this._call&&(this._call=null,this._time=Infinity,Ue())}};function pc(e,t,n){var r=new ms;return r.restart(e,t,n),r}function Xr(){Ru(),++Bo;for(var e=di,t;e;)(t=po-e._time)>=0&&e._call.call(null,t),e=e._next;--Bo}function Mu(){po=(Iu=Ya.now())+Cu,Bo=zo=0;try{Xr()}finally{Bo=0,ft(),po=0}}function ll(){var e=Ya.now(),t=e-Iu;t>uf&&(Cu-=t,Iu=e)}function ft(){for(var e,t=di,n,r=Infinity;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:di=n);js=e,Ue(r)}function Ue(e){if(!Bo){zo&&(zo=clearTimeout(zo));var t=e-po;t>24?(e<Infinity&&(zo=setTimeout(Mu,e-Ya.now()-Cu)),ps&&(ps=clearInterval(ps))):(ps||(Iu=Ya.now(),ps=setInterval(ll,uf)),Bo=1,cf(Mu))}}var Dt=1664525,je=1013904223,kt=4294967296;function Lt(){var e=1;return function(){return(e=(Dt*e+je)%kt)/kt}}function on(e){return e.x}function qt(e){return e.y}var Nt=10,dn=Math.PI*(3-Math.sqrt(5));function yn(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,s=new Map,c=pc(h),f=Au("tick","end"),d=Lt();e==null&&(e=[]);function h(){v(),f.call("tick",t),n<r&&(c.stop(),f.call("end",t))}function v(_){var y,E=e.length,b;_===void 0&&(_=1);for(var A=0;A<_;++A)for(n+=(a-n)*i,s.forEach(function(C){C(n)}),y=0;y<E;++y)b=e[y],b.fx==null?b.x+=b.vx*=o:(b.x=b.fx,b.vx=0),b.fy==null?b.y+=b.vy*=o:(b.y=b.fy,b.vy=0);return t}function m(){for(var _=0,y=e.length,E;_<y;++_){if(E=e[_],E.index=_,E.fx!=null&&(E.x=E.fx),E.fy!=null&&(E.y=E.fy),isNaN(E.x)||isNaN(E.y)){var b=Nt*Math.sqrt(.5+_),A=_*dn;E.x=b*Math.cos(A),E.y=b*Math.sin(A)}(isNaN(E.vx)||isNaN(E.vy))&&(E.vx=E.vy=0)}}function g(_){return _.initialize&&_.initialize(e,d),_}return m(),t={tick:v,restart:function(){return c.restart(h),t},stop:function(){return c.stop(),t},nodes:function(y){return arguments.length?(e=y,m(),s.forEach(g),t):e},alpha:function(y){return arguments.length?(n=+y,t):n},alphaMin:function(y){return arguments.length?(r=+y,t):r},alphaDecay:function(y){return arguments.length?(i=+y,t):+i},alphaTarget:function(y){return arguments.length?(a=+y,t):a},velocityDecay:function(y){return arguments.length?(o=1-y,t):1-o},randomSource:function(y){return arguments.length?(d=y,s.forEach(g),t):d},force:function(y,E){return arguments.length>1?(E==null?s.delete(y):s.set(y,g(E)),t):s.get(y)},find:function(y,E,b){var A=0,C=e.length,R,W,te,Q,re;for(b==null?b=Infinity:b*=b,A=0;A<C;++A)Q=e[A],R=y-Q.x,W=E-Q.y,te=R*R+W*W,te<b&&(re=Q,b=te);return re},on:function(y,E){return arguments.length>1?(f.on(y,E),t):f.on(y)}}}function rr(){var e,t,n,r,i=Wt(-30),a,o=1,s=Infinity,c=.81;function f(m){var g,_=e.length,y=hs(e,on,qt).visitAfter(h);for(r=m,g=0;g<_;++g)t=e[g],y.visit(v)}function d(){if(!!e){var m,g=e.length,_;for(a=new Array(g),m=0;m<g;++m)_=e[m],a[_.index]=+i(_,m,e)}}function h(m){var g=0,_,y,E=0,b,A,C;if(m.length){for(b=A=C=0;C<4;++C)(_=m[C])&&(y=Math.abs(_.value))&&(g+=_.value,E+=y,b+=y*_.x,A+=y*_.y);m.x=b/E,m.y=A/E}else{_=m,_.x=_.data.x,_.y=_.data.y;do g+=a[_.data.index];while(_=_.next)}m.value=g}function v(m,g,_,y){if(!m.value)return!0;var E=m.x-t.x,b=m.y-t.y,A=y-g,C=E*E+b*b;if(A*A/c<C)return C<s&&(E===0&&(E=Rn(n),C+=E*E),b===0&&(b=Rn(n),C+=b*b),C<o&&(C=Math.sqrt(o*C)),t.vx+=E*m.value*r/C,t.vy+=b*m.value*r/C),!0;if(m.length||C>=s)return;(m.data!==t||m.next)&&(E===0&&(E=Rn(n),C+=E*E),b===0&&(b=Rn(n),C+=b*b),C<o&&(C=Math.sqrt(o*C)));do m.data!==t&&(A=a[m.data.index]*r/C,t.vx+=E*A,t.vy+=b*A);while(m=m.next)}return f.initialize=function(m,g){e=m,n=g,d()},f.strength=function(m){return arguments.length?(i=typeof m=="function"?m:Wt(+m),d(),f):i},f.distanceMin=function(m){return arguments.length?(o=m*m,f):Math.sqrt(o)},f.distanceMax=function(m){return arguments.length?(s=m*m,f):Math.sqrt(s)},f.theta=function(m){return arguments.length?(c=m*m,f):Math.sqrt(c)},f}function cr(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var a,o=n.length,s,c=0,f=0;for(a=0;a<o;++a)s=n[a],c+=s.x,f+=s.y;for(c=(c/o-e)*r,f=(f/o-t)*r,a=0;a<o;++a)s=n[a],s.x-=c,s.y-=f}return i.initialize=function(a){n=a},i.x=function(a){return arguments.length?(e=+a,i):e},i.y=function(a){return arguments.length?(t=+a,i):t},i.strength=function(a){return arguments.length?(r=+a,i):r},i}function Or(e){return e.index}function Lr(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function Li(e){var t=Or,n=h,r,i=Wt(30),a,o,s,c,f,d=1;e==null&&(e=[]);function h(y){return 1/Math.min(s[y.source.index],s[y.target.index])}function v(y){for(var E=0,b=e.length;E<d;++E)for(var A=0,C,R,W,te,Q,re,de;A<b;++A)C=e[A],R=C.source,W=C.target,te=W.x+W.vx-R.x-R.vx||Rn(f),Q=W.y+W.vy-R.y-R.vy||Rn(f),re=Math.sqrt(te*te+Q*Q),re=(re-a[A])/re*y*r[A],te*=re,Q*=re,W.vx-=te*(de=c[A]),W.vy-=Q*de,R.vx+=te*(de=1-de),R.vy+=Q*de}function m(){if(!!o){var y,E=o.length,b=e.length,A=new Map(o.map(function(R,W){return[t(R,W,o),R]})),C;for(y=0,s=new Array(E);y<b;++y)C=e[y],C.index=y,typeof C.source!="object"&&(C.source=Lr(A,C.source)),typeof C.target!="object"&&(C.target=Lr(A,C.target)),s[C.source.index]=(s[C.source.index]||0)+1,s[C.target.index]=(s[C.target.index]||0)+1;for(y=0,c=new Array(b);y<b;++y)C=e[y],c[y]=s[C.source.index]/(s[C.source.index]+s[C.target.index]);r=new Array(b),g(),a=new Array(b),_()}}function g(){if(!!o)for(var y=0,E=e.length;y<E;++y)r[y]=+n(e[y],y,e)}function _(){if(!!o)for(var y=0,E=e.length;y<E;++y)a[y]=+i(e[y],y,e)}return v.initialize=function(y,E){o=y,f=E,m()},v.links=function(y){return arguments.length?(e=y,m(),v):e},v.id=function(y){return arguments.length?(t=y,v):t},v.iterations=function(y){return arguments.length?(d=+y,v):d},v.strength=function(y){return arguments.length?(n=typeof y=="function"?y:Wt(+y),g(),v):n},v.distance=function(y){return arguments.length?(i=typeof y=="function"?y:Wt(+y),_(),v):i},v}function Yi(e){return e.x+e.vx}function ni(e){return e.y+e.vy}function Ci(e){var t,n,r,i=1,a=1;typeof e!="function"&&(e=Wt(e==null?1:+e));function o(){for(var f,d=t.length,h,v,m,g,_,y,E=0;E<a;++E)for(h=hs(t,Yi,ni).visitAfter(s),f=0;f<d;++f)v=t[f],_=n[v.index],y=_*_,m=v.x+v.vx,g=v.y+v.vy,h.visit(b);function b(A,C,R,W,te){var Q=A.data,re=A.r,de=_+re;if(Q){if(Q.index>v.index){var Ce=m-Q.x-Q.vx,ie=g-Q.y-Q.vy,Ge=Ce*Ce+ie*ie;Ge<de*de&&(Ce===0&&(Ce=Rn(r),Ge+=Ce*Ce),ie===0&&(ie=Rn(r),Ge+=ie*ie),Ge=(de-(Ge=Math.sqrt(Ge)))/Ge*i,v.vx+=(Ce*=Ge)*(de=(re*=re)/(y+re)),v.vy+=(ie*=Ge)*de,Q.vx-=Ce*(de=1-de),Q.vy-=ie*de)}return}return C>m+de||W<m-de||R>g+de||te<g-de}}function s(f){if(f.data)return f.r=n[f.data.index];for(var d=f.r=0;d<4;++d)f[d]&&f[d].r>f.r&&(f.r=f[d].r)}function c(){if(!!t){var f,d=t.length,h;for(n=new Array(d),f=0;f<d;++f)h=t[f],n[h.index]=+e(h,f,t)}}return o.initialize=function(f,d){t=f,r=d,c()},o.iterations=function(f){return arguments.length?(a=+f,o):a},o.strength=function(f){return arguments.length?(i=+f,o):i},o.radius=function(f){return arguments.length?(e=typeof f=="function"?f:Wt(+f),c(),o):e},o}function Gi(e){var t=Wt(.1),n,r,i;typeof e!="function"&&(e=Wt(e==null?0:+e));function a(s){for(var c=0,f=n.length,d;c<f;++c)d=n[c],d.vx+=(i[c]-d.x)*r[c]*s}function o(){if(!!n){var s,c=n.length;for(r=new Array(c),i=new Array(c),s=0;s<c;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return a.initialize=function(s){n=s,o()},a.strength=function(s){return arguments.length?(t=typeof s=="function"?s:Wt(+s),o(),a):t},a.x=function(s){return arguments.length?(e=typeof s=="function"?s:Wt(+s),o(),a):e},a}function Ki(e){var t=Wt(.1),n,r,i;typeof e!="function"&&(e=Wt(e==null?0:+e));function a(s){for(var c=0,f=n.length,d;c<f;++c)d=n[c],d.vy+=(i[c]-d.y)*r[c]*s}function o(){if(!!n){var s,c=n.length;for(r=new Array(c),i=new Array(c),s=0;s<c;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return a.initialize=function(s){n=s,o()},a.strength=function(s){return arguments.length?(t=typeof s=="function"?s:Wt(+s),o(),a):t},a.y=function(s){return arguments.length?(e=typeof s=="function"?s:Wt(+s),o(),a):e},a}function Hn(){function e(Ot){return()=>Ot}let t=Ot=>Ot.cluster,n=e(1),r=e(-1),i=e(100),a=e(.1),o=[0,0],s=[],c={},f=[],d=100,h=100,v={none:{x:0,y:0}},m=[],g,_="force",y=!0,E=.1;function b(Ot){if(!y)return b;g.tick(),Q();for(let Dn=0,gr=s.length,Xn,wn=Ot*E;Dn<gr;++Dn)Xn=s[Dn],Xn.vx+=(v[t(Xn)].x-Xn.x)*wn,Xn.vy+=(v[t(Xn)].y-Xn.y)*wn}function A(){!s||C()}function C(){if(!s||!s.length)return;if(t(s[0])===void 0)throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInABox.groupBy('clusterAttr') before calling .links()");const Ot=R();g=yn(Ot.nodes).force("x",Gi(d).strength(.1)).force("y",Ki(h).strength(.1)).force("collide",Ci(Dn=>Dn.r).iterations(4)).force("charge",rr().strength(r)).force("links",Li(Ot.nodes.length?Ot.links:[]).distance(i).strength(a)),m=g.nodes(),Q()}function R(){const Ot=[],Dn=[],gr={};let Xn=[],wn={},rn=[];return wn=W(s),rn=te(f),Xn=Object.keys(wn),Xn.forEach((Er,ei)=>{const Tr=wn[Er];Ot.push({id:Er,size:Tr.count,r:Math.sqrt(Tr.sumforceNodeSize/Math.PI)}),gr[Er]=ei}),rn.forEach(Er=>{const ei=ke(Er,"source"),Tr=ke(Er,"target"),lo=gr[ei],Eu=gr[Tr];lo!==void 0&&Eu!==void 0&&Dn.push({source:lo,target:Eu,count:Er.count})}),{nodes:Ot,links:Dn}}function W(Ot){const Dn={};return Ot.forEach(gr=>{const Xn=t(gr);Dn[Xn]||(Dn[Xn]={count:0,sumforceNodeSize:0})}),Ot.forEach(gr=>{const Xn=t(gr),wn=n(gr),rn=Dn[Xn];rn.count=rn.count+1,rn.sumforceNodeSize=rn.sumforceNodeSize+Math.PI*(wn*wn)*1.3,Dn[Xn]=rn}),Dn}function te(Ot){const Dn={},gr=[];return Ot.forEach(wn=>{const rn=re(wn);let Er=0;Dn[rn]!==void 0&&(Er=Dn[rn]),Er+=1,Dn[rn]=Er}),Object.entries(Dn).forEach(([wn,rn])=>{const Er=wn.split("~")[0],ei=wn.split("~")[1];Er!==void 0&&ei!==void 0&&gr.push({source:Er,target:ei,count:rn})}),gr}function Q(){return v={none:{x:0,y:0}},m.forEach(Ot=>{v[Ot.id]={x:Ot.x-o[0],y:Ot.y-o[1]}}),v}function re(Ot){const Dn=ke(Ot,"source"),gr=ke(Ot,"target"),Xn=t(c[Dn]),wn=t(c[gr]);return Xn<=wn?`${Xn}~${wn}`:`${wn}~${Xn}`}function de(Ot){c={},Ot.forEach(Dn=>{c[Dn.id]=Dn})}function Ce(Ot){return arguments.length?(_=Ot,A(),b):_}function ie(Ot){return arguments.length?typeof Ot=="string"?(t=Dn=>Dn[Ot],b):(t=Ot,b):t}function Ge(Ot){return arguments.length?(y=Ot,b):y}function We(Ot){return arguments.length?(E=Ot,b):E}function It(Ot){return arguments.length?(d=Ot,b):d}function gn(Ot){return arguments.length?(h=Ot,b):h}function pn(Ot){return arguments.length?(de(Ot||[]),s=Ot||[],b):s}function bn(Ot){return arguments.length?(f=Ot||[],A(),b):f}function vr(Ot){return arguments.length?(typeof Ot=="function"?n=Ot:n=e(+Ot),A(),b):n}function Oi(Ot){return arguments.length?(typeof Ot=="function"?r=Ot:r=e(+Ot),A(),b):r}function Hr(Ot){return arguments.length?(typeof Ot=="function"?i=Ot:i=e(+Ot),A(),b):i}function Sn(Ot){return arguments.length?(typeof Ot=="function"?a=Ot:a=e(+Ot),A(),b):a}function In(Ot){return arguments.length?(o=Ot,b):o}return b.initialize=Ot=>{s=Ot,A()},b.template=Ce,b.groupBy=ie,b.enableGrouping=Ge,b.strength=We,b.centerX=It,b.centerY=gn,b.nodes=pn,b.links=bn,b.forceNodeSize=vr,b.nodeSize=b.forceNodeSize,b.forceCharge=Oi,b.forceLinkDistance=Hr,b.forceLinkStrength=Sn,b.offset=In,b.getFocis=Q,b}const yi={RUN:"LAYOUT_RUN",END:"LAYOUT_END",ERROR:"LAYOUT_ERROR",TICK:"LAYOUT_TICK",GPURUN:"GPU_LAYOUT_RUN",GPUEND:"GPU_LAYOUT_END"},Ri={gForce:!0,force2:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0};class La extends jt{constructor(t){super();this.center=[0,0],this.nodeStrength=null,this.edgeStrength=null,this.preventOverlap=!1,this.clusterNodeStrength=null,this.clusterEdgeStrength=null,this.clusterEdgeDistance=null,this.clusterNodeSize=null,this.clusterFociStrength=null,this.linkDistance=50,this.alphaDecay=.028,this.alphaMin=.001,this.alpha=.3,this.collideStrength=1,this.workerEnabled=!1,this.tick=()=>{},this.onLayoutEnd=()=>{},this.ticking=void 0,t&&this.updateCfg(t)}getDefaultCfg(){return{center:[0,0],nodeStrength:null,edgeStrength:null,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10,tick(){},onLayoutEnd(){},workerEnabled:!1}}init(t){const n=this;n.nodes=t.nodes||[];const r=t.edges||[];n.edges=r.map(i=>{const a={},o=["targetNode","sourceNode","startPoint","endPoint"];return Object.keys(i).forEach(s=>{o.indexOf(s)>-1||(a[s]=i[s])}),a}),n.ticking=!1}execute(t){const n=this,r=n.nodes,i=n.edges;if(n.ticking)return;let a=n.forceSimulation;const o=n.alphaMin,s=n.alphaDecay,c=n.alpha;if(a){if(t){if(n.clustering&&n.clusterForce&&(n.clusterForce.nodes(r),n.clusterForce.links(i)),a.nodes(r),i&&n.edgeForce)n.edgeForce.links(i);else if(i&&!n.edgeForce){const f=Li().id(d=>d.id).links(i);n.edgeStrength&&f.strength(n.edgeStrength),n.linkDistance&&f.distance(n.linkDistance),n.edgeForce=f,a.force("link",f)}}n.preventOverlap&&n.overlapProcess(a),a.alpha(c).restart(),this.ticking=!0}else try{const f=rr();if(n.nodeStrength&&f.strength(n.nodeStrength),a=yn().nodes(r),n.clustering){const d=Hn();d.centerX(n.center[0]).centerY(n.center[1]).template("force").strength(n.clusterFociStrength),i&&d.links(i),r&&d.nodes(r),d.forceLinkDistance(n.clusterEdgeDistance).forceLinkStrength(n.clusterEdgeStrength).forceCharge(n.clusterNodeStrength).forceNodeSize(n.clusterNodeSize),n.clusterForce=d,a.force("group",d)}if(a.force("center",cr(n.center[0],n.center[1])).force("charge",f).alpha(c).alphaDecay(s).alphaMin(o),n.preventOverlap&&n.overlapProcess(a),i){const d=Li().id(h=>h.id).links(i);n.edgeStrength&&d.strength(n.edgeStrength),n.linkDistance&&d.distance(n.linkDistance),n.edgeForce=d,a.force("link",d)}if(n.workerEnabled&&!sa()&&(n.workerEnabled=!1,console.warn("workerEnabled option is only supported when running in web worker.")),!n.workerEnabled)a.on("tick",()=>{n.tick()}).on("end",()=>{n.ticking=!1,n.onLayoutEnd&&n.onLayoutEnd()}),n.ticking=!0;else{a.stop();const d=oa(a);for(let h=1;h<=d;h++)a.tick(),postMessage({nodes:r,currentTick:h,totalTicks:d,type:yi.TICK},void 0);n.ticking=!1}n.forceSimulation=a,n.ticking=!0}catch(f){n.ticking=!1,console.warn(f)}}overlapProcess(t){const n=this,r=n.nodeSize,i=n.nodeSpacing;let a,o;const s=n.collideStrength;if(Z(i)?o=()=>i:pt(i)?o=i:o=()=>0,!r)a=c=>c.size?H(c.size)?(c.size[0]>c.size[1]?c.size[0]:c.size[1])/2+o(c):me(c.size)?(c.size.width>c.size.height?c.size.width:c.size.height)/2+o(c):c.size/2+o(c):10+o(c);else if(pt(r))a=c=>r(c)+o(c);else if(H(r)){const f=(r[0]>r[1]?r[0]:r[1])/2;a=d=>f+o(d)}else if(Z(r)){const c=r/2;a=f=>c+o(f)}else a=()=>10;t.force("collisionForce",Ci(a).strength(s))}updateCfg(t){const n=this;n.ticking&&(n.forceSimulation.stop(),n.ticking=!1),n.forceSimulation=null,Object.assign(n,t)}destroy(){const t=this;t.ticking&&(t.forceSimulation.stop(),t.ticking=!1),t.nodes=null,t.edges=null,t.destroyed=!0}}function oa(e){const t=e.alphaMin(),n=e.alphaTarget(),r=e.alpha(),i=Math.log((t-n)/(r-n))/Math.log(1-e.alphaDecay());return Math.ceil(i)}function sa(){return typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope}function mo(e,t,n,r){e.forEach((i,a)=>{e[a].children=[],e[a].parent=[]}),r?t.forEach(i=>{const a=ke(i,"source"),o=ke(i,"target");let s=0;a&&(s=n[a]);let c=0;o&&(c=n[o]);const f=e[s].children,d=e[c].parent;f.push(e[c].id),d.push(e[s].id)}):t.forEach(i=>{const a=ke(i,"source"),o=ke(i,"target");let s=0;a&&(s=n[a]);let c=0;o&&(c=n[o]);const f=e[s].children,d=e[c].children;f.push(e[c].id),d.push(e[s].id)})}function gs(e,t,n){const r=n.length;for(let i=0;i<r;i++){const a=ke(n[i],"source"),o=ke(n[i],"target");if(e.id===a&&t.id===o||t.id===a&&e.id===o)return!0}return!1}function hi(e,t){const n=e.degree,r=t.degree;return n<r?-1:n>r?1:0}class va extends jt{constructor(t){super();this.radius=null,this.nodeSize=void 0,this.startRadius=null,this.endRadius=null,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0,this.divisions=1,this.ordering=null,this.angleRatio=1,this.nodes=[],this.edges=[],this.nodeMap={},this.degrees=[],this.width=300,this.height=300,this.updateCfg(t)}getDefaultCfg(){return{radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1}}execute(){var t;const n=this,r=n.nodes,i=n.edges,a=r.length;if(a===0){n.onLayoutEnd&&n.onLayoutEnd();return}!n.width&&typeof window!="undefined"&&(n.width=window.innerWidth),!n.height&&typeof window!="undefined"&&(n.height=window.innerHeight),n.center||(n.center=[n.width/2,n.height/2]);const o=n.center;if(a===1){r[0].x=o[0],r[0].y=o[1],n.onLayoutEnd&&n.onLayoutEnd();return}let{radius:s,startRadius:c,endRadius:f}=n;const{divisions:d,startAngle:h,endAngle:v,angleRatio:m,ordering:g,clockwise:_,nodeSpacing:y,nodeSize:E}=n,b=(v-h)/a,A={};r.forEach((Q,re)=>{A[Q.id]=re}),n.nodeMap=A;const C=Gt(r.length,A,i);if(n.degrees=C,y){const Q=$n(10,y),re=$n(10,E);let de=-Infinity;r.forEach(ie=>{const Ge=re(ie);de<Ge&&(de=Ge)});let Ce=0;r.forEach((ie,Ge)=>{Ge===0?Ce+=de||10:Ce+=(Q(ie)||0)+(de||10)}),s=Ce/(2*Math.PI)}else!s&&!c&&!f?s=n.height>n.width?n.width/2:n.height/2:!c&&f?c=f:c&&!f&&(f=c);const R=b*m;let W=[];g==="topology"?W=n.topologyOrdering():g==="topology-directed"?W=n.topologyOrdering(!0):g==="degree"?W=n.degreeOrdering():W=r;const te=Math.ceil(a/d);for(let Q=0;Q<a;++Q){let re=s;!re&&c!==null&&f!==null&&(re=c+Q*(f-c)/(a-1)),re||(re=10+Q*100/(a-1));let de=h+Q%te*R+2*Math.PI/d*Math.floor(Q/te);_||(de=v-Q%te*R-2*Math.PI/d*Math.floor(Q/te)),W[Q].x=o[0]+Math.cos(de)*re,W[Q].y=o[1]+Math.sin(de)*re,W[Q].weight=C[Q].all}return(t=n.onLayoutEnd)===null||t===void 0||t.call(n),{nodes:W,edges:this.edges}}topologyOrdering(t=!1){const n=this,r=n.degrees,i=n.edges,a=n.nodes,o=rt(a),s=n.nodeMap,c=[o[0]],f=[a[0]],d=[],h=a.length;d[0]=!0,mo(o,i,s,t);let v=0;return o.forEach((m,g)=>{if(g!==0)if((g===h-1||r[g].all!==r[g+1].all||gs(c[v],m,i))&&!d[g])c.push(m),f.push(a[s[m.id]]),d[g]=!0,v++;else{const _=c[v].children;let y=!1;for(let b=0;b<_.length;b++){const A=s[_[b]];if(r[A].all===r[g].all&&!d[A]){c.push(o[A]),f.push(a[s[o[A].id]]),d[A]=!0,y=!0;break}}let E=0;for(;!y&&(d[E]||(c.push(o[E]),f.push(a[s[o[E].id]]),d[E]=!0,y=!0),E++,E!==h););}}),f}degreeOrdering(){const t=this,n=t.nodes,r=[],i=t.degrees;return n.forEach((a,o)=>{a.degree=i[o].all,r.push(a)}),r.sort(hi),r}getType(){return"circular"}}const Wo=(e,t)=>{if(e!=="next"&&e!=="prev")return t},Ga=e=>{e.prev.next=e.next,e.next.prev=e.prev,delete e.next,delete e.prev};class ys{constructor(){const t={};t.prev=t,t.next=t.prev,this.shortcut=t}dequeue(){const t=this.shortcut,n=t.prev;if(n&&n!==t)return Ga(n),n}enqueue(t){const n=this.shortcut;t.prev&&t.next&&Ga(t),t.next=n.next,n.next.prev=t,n.next=t,t.prev=n}toString(){const t=[],n=this.shortcut;let r=n.prev;for(;r!==n;)t.push(JSON.stringify(r,Wo)),r=r==null?void 0:r.prev;return`[${t.join(", ")}]`}}var pa;(function(e){e.DEFAULT_EDGE_NAME="\0",e.GRAPH_NODE="\0",e.EDGE_KEY_DELIM=""})(pa||(pa={}));function ka(e,t){var n=e.get(t)||0;e.set(t,n+1)}function Vo(e,t){var n=e.get(t);n!==void 0&&(n=n-1,n>0?e.set(t,n):e.delete(t))}function _i(e,t,n,r){var i=String(t),a=String(n);if(!e&&i>a){var o=i;i=a,a=o}return i+pa.EDGE_KEY_DELIM+a+pa.EDGE_KEY_DELIM+(r===void 0?pa.DEFAULT_EDGE_NAME:r)}function Fr(e,t,n,r){var i=String(t),a=String(n),o={v:t,w:n};if(!e&&i>a){var s=o.v;o.v=o.w,o.w=s}return r!==void 0&&(o.name=r),o}function Wi(e,t){return _i(e,t.v,t.w,t.name)}function xa(e){return typeof e=="function"}var ua=function(t){return t.nodes().map(function(n){var r=t.node(n),i=t.parent(n),a={id:n,value:r,parent:i};return a.value===void 0&&delete a.value,a.parent===void 0&&delete a.parent,a})},Zo=function(t){return t.edges().map(function(n){var r=t.edge(n),i={v:n.v,w:n.w,value:r,name:n.name};return i.name===void 0&&delete i.name,i.value===void 0&&delete i.value,i})},go=function(t){var n={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:ua(t),edges:Zo(t),value:t.graph()};return n.value===void 0&&delete n.value,n},Ei=function(t){var n=new fr(t.options);return t.value!==void 0&&n.setGraph(t.value),t.nodes.forEach(function(r){n.setNode(r.id,r.value),r.parent&&n.setParent(r.id,r.parent)}),t.edges.forEach(function(r){n.setEdge(r.v,r.w,r.value,r.name)}),n};function jo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function na(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?jo(Object(n),!0).forEach(function(r){yo(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jo(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function yo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ho(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sa(e,t,n){return t&&Ho(e.prototype,t),n&&Ho(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var yr={compound:!1,multigraph:!1,directed:!0},fr=function(){function e(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_s(this,e),this.directed=!0,this.multigraph=!1,this.compound=!1,this.GRAPH_NODE=pa.GRAPH_NODE,this.label=void 0,this.nodeCountNum=0,this.edgeCountNum=0,this.defaultNodeLabelFn=function(){},this.defaultEdgeLabelFn=function(){},this.parentMap=void 0,this.childrenMap=void 0,this.nodesLabelMap=new Map,this.inEdgesMap=new Map,this.outEdgesMap=new Map,this.predecessorsMap=new Map,this.successorsMap=new Map,this.edgesMap=new Map,this.edgesLabelsMap=new Map,this.isDirected=function(){return t.directed},this.isMultigraph=function(){return t.multigraph},this.isCompound=function(){return t.compound},this.setGraph=function(i){return t.label=i,t},this.graph=function(){return t.label},this.setDefaultNodeLabel=function(i){return xa(i)?t.defaultNodeLabelFn=i:t.defaultNodeLabelFn=function(){return i},t},this.nodeCount=function(){return t.nodeCountNum},this.node=function(i){return t.nodesLabelMap.get(i)},this.nodes=function(){return Array.from(t.nodesLabelMap.keys())},this.sources=function(){return t.nodes().filter(function(i){var a;return!((a=t.inEdgesMap.get(i))===null||a===void 0?void 0:a.size)})},this.sinks=function(){return t.nodes().filter(function(i){var a;return!((a=t.outEdgesMap.get(i))===null||a===void 0?void 0:a.size)})},this.setNodes=function(i,a){return i.map(function(o){return t.setNode(o,a)}),t},this.hasNode=function(i){return t.nodesLabelMap.has(i)},this.checkCompound=function(){if(!t.isCompound())throw new Error("Cannot construct parent-children relations in a non-compound graph")},this.parent=function(i){if(t.isCompound()){var a,o=(a=t.parentMap)===null||a===void 0?void 0:a.get(i);if(o!==t.GRAPH_NODE)return o}},this.removeFromParentsChildList=function(i){var a=t.parentMap.get(i);t.childrenMap.get(a).delete(i)},this.setParent=function(i,a){var o,s;t.checkCompound();for(var c=a===void 0?t.GRAPH_NODE:a,f=t.parent(c);f;){if(i===f)throw new Error("Setting "+a+" as parent of "+i+" would create a cycle");f=t.parent(f)}a&&t.setNode(a),t.setNode(i),t.removeFromParentsChildList(i),(o=t.parentMap)===null||o===void 0||o.set(i,c);var d=t.childrenMap.get(c);return d.set(i,!0),(s=t.childrenMap)===null||s===void 0||s.set(c,d),t},this.children=function(i){var a=i===void 0?t.GRAPH_NODE:i;if(t.isCompound()){var o,s=(o=t.childrenMap)===null||o===void 0?void 0:o.get(a);return s?Array.from(s.keys()):void 0}if(a===t.GRAPH_NODE)return t.nodes();if(i&&t.hasNode(i))return[]},this.predecessors=function(i){var a=t.predecessorsMap.get(i);return a?Array.from(a.keys()):void 0},this.successors=function(i){var a=t.successorsMap.get(i);return a?Array.from(a.keys()):void 0},this.neighbors=function(i){var a;if(!!t.hasNode(i))return Array.from(new Set((a=t.predecessors(i))===null||a===void 0?void 0:a.concat(t.successors(i))))},this.isLeaf=function(i){var a;if(t.isDirected()){var o;return!((o=t.successors(i))===null||o===void 0?void 0:o.length)}return!((a=t.neighbors(i))===null||a===void 0?void 0:a.length)},this.filterNodes=function(i){var a=t.directed,o=t.multigraph,s=t.compound,c=new e({directed:a,multigraph:o,compound:s});if(c.setGraph(t.graph()),t.nodes().forEach(function(d){i(d)&&c.setNode(d,t.node(d))}),t.edges().forEach(function(d){c.hasNode(d.v)&&c.hasNode(d.w)&&c.setEdgeObj(d,t.edge(d))}),s){var f=function(h){for(var v=t.parent(h);v!==void 0&&!c.hasNode(v);)v=t.parent(v);return v};c.nodes().forEach(function(d){c.setParent(d,f(d))})}return c},this.setDefaultEdgeLabel=function(i){return xa(i)?t.defaultEdgeLabelFn=i:t.defaultEdgeLabelFn=function(){return i},t},this.edgeCount=function(){return t.edgeCountNum},this.setEdgeObj=function(i,a){return t.setEdge(i.v,i.w,a,i.name)},this.setPath=function(i,a){return i.reduce(function(o,s){return t.setEdge(o,s,a),s}),t},this.edgeFromArgs=function(i,a,o){return t.edge({v:i,w:a,name:o})},this.edge=function(i){return t.edgesLabelsMap.get(Wi(t.isDirected(),i))},this.hasEdge=function(i,a,o){return t.edgesLabelsMap.has(Wi(t.isDirected(),{v:i,w:a,name:o}))},this.removeEdgeObj=function(i){var a=i.v,o=i.w,s=i.name;return t.removeEdge(a,o,s)},this.edges=function(){return Array.from(t.edgesMap.values())},this.inEdges=function(i,a){var o=t.inEdgesMap.get(i);if(o)return Array.from(o.values()).filter(function(s){return!a||s.v===a})},this.outEdges=function(i,a){var o=t.outEdgesMap.get(i);if(o)return Array.from(o.values()).filter(function(s){return!a||s.w===a})},this.nodeEdges=function(i,a){var o;if(!!t.hasNode(i))return(o=t.inEdges(i,a))===null||o===void 0?void 0:o.concat(t.outEdges(i,a))},this.toJSON=function(){return go(t)},this.nodeInDegree=function(i){var a=t.inEdgesMap.get(i);return a?a.size:0},this.nodeOutDegree=function(i){var a=t.outEdgesMap.get(i);return a?a.size:0},this.nodeDegree=function(i){return t.nodeInDegree(i)+t.nodeOutDegree(i)},this.source=function(i){return i.v},this.target=function(i){return i.w};var r=na(na({},yr),n);this.compound=r.compound,this.directed=r.directed,this.multigraph=r.multigraph,this.compound&&(this.parentMap=new Map,this.childrenMap=new Map)}return Sa(e,[{key:"setNode",value:function(n,r){var i=this.nodesLabelMap,a=this.defaultNodeLabelFn,o=this.isCompound,s=this.parentMap,c=this.childrenMap,f=this.inEdgesMap,d=this.outEdgesMap,h=this.predecessorsMap,v=this.successorsMap;if(i.has(n))return r!==void 0&&i.set(n,r),this;if(i.set(n,r||a(n)),o()){var m;s==null||s.set(n,this.GRAPH_NODE),c==null||c.set(n,new Map),(c==null?void 0:c.has(this.GRAPH_NODE))||c==null||c.set(this.GRAPH_NODE,new Map),c==null||(m=c.get(this.GRAPH_NODE))===null||m===void 0||m.set(n,!0)}return[f,d,h,v].forEach(function(g){return g.set(n,new Map)}),this.nodeCountNum+=1,this}},{key:"removeNode",value:function(n){var r=this;if(this.hasNode(n)){var i=function(y){r.removeEdge(y.v,y.w,y.name)},a=this.inEdgesMap,o=this.outEdgesMap,s=this.predecessorsMap,c=this.successorsMap,f=this.nodesLabelMap;if(this.isCompound()){var d,h,v;this.removeFromParentsChildList(n),(d=this.parentMap)===null||d===void 0||d.delete(n),(h=this.children(n))===null||h===void 0||h.forEach(function(_){return r.setParent(_)}),(v=this.childrenMap)===null||v===void 0||v.delete(n)}var m=a.get(n),g=o.get(n);Array.from(m.values()).forEach(function(_){return i(_)}),Array.from(g.values()).forEach(function(_){return i(_)}),f.delete(n),a.delete(n),o.delete(n),s.delete(n),c.delete(n),this.nodeCountNum-=1}return this}},{key:"setEdge",value:function(n,r,i,a){var o,s,c=Fr(this.isDirected(),n,r,a),f=Wi(this.isDirected(),c),d=c.v,h=c.w;if(this.edgesLabelsMap.has(f))return this.edgesLabelsMap.set(f,i),this;if(a!==void 0&&!this.isMultigraph())throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(d),this.setNode(h),this.edgesLabelsMap.set(f,i||this.defaultEdgeLabelFn(d,h,a)),Object.freeze(c),this.edgesMap.set(f,c);var v=this.predecessorsMap.get(h),m=this.successorsMap.get(d);return ka(v,d),ka(m,h),(o=this.inEdgesMap.get(h))===null||o===void 0||o.set(f,c),(s=this.outEdgesMap.get(d))===null||s===void 0||s.set(f,c),this.edgeCountNum+=1,this}},{key:"removeEdge",value:function(n,r,i){var a=_i(this.isDirected(),n,r,i),o=this.edgesMap.get(a);if(o){var s=Fr(this.isDirected(),n,r,i),c=s.v,f=s.w;this.edgesLabelsMap.delete(a),this.edgesMap.delete(a);var d=this.predecessorsMap.get(f),h=this.successorsMap.get(c);Vo(d,c),Vo(h,f),this.inEdgesMap.get(f).delete(a),this.outEdgesMap.get(c).delete(a),this.edgeCountNum-=1}return this}}]),e}();fr.fromJSON=Ei;function vi(e){return vi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vi(e)}function qi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _o(e,t,n){return t&&bi(e.prototype,t),n&&bi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xo(){return typeof Reflect!="undefined"&&Reflect.get?Xo=Reflect.get:Xo=function(t,n,r){var i=Fa(t,n);if(!!i){var a=Object.getOwnPropertyDescriptor(i,n);return a.get?a.get.call(arguments.length<3?t:r):a.value}},Xo.apply(this,arguments)}function Fa(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Mi(e),e!==null););return e}function Eo(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Es(e,t)}function Es(e,t){return Es=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Es(e,t)}function Hs(e){var t=$o();return function(){var r=Mi(e),i;if(t){var a=Mi(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return Mn(this,i)}}function Mn(e,t){if(t&&(vi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bn(e)}function Bn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $o(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Mi(e){return Mi=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},Mi(e)}var mc=null;function gc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lf(e,t,n){return t&&gc(e.prototype,t),n&&gc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function df(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Vi=lf(function e(){var t=this;df(this,e),this.arr=[],this.keyIndice=new Map,this.size=function(){return t.arr.length},this.keys=function(){return t.arr.map(function(n){return n.key})},this.has=function(n){return t.keyIndice.has(n)},this.priority=function(n){var r=t.keyIndice.get(n);if(r!==void 0)return t.arr[r].priority},this.swap=function(n,r){var i=t.arr,a=t.keyIndice,o=[i[n],i[r]],s=o[0],c=o[1];i[n]=c,i[r]=s,a.set(s.key,r),a.set(c.key,n)},this.innerDecrease=function(n){for(var r=t.arr,i=r[n].priority,a,o=n;o!==0;){var s;if(a=o>>1,((s=r[a])===null||s===void 0?void 0:s.priority)<i)break;t.swap(o,a),o=a}},this.heapify=function(n){var r=t.arr,i=n<<1,a=i+1,o=n;i<r.length&&(o=r[i].priority<r[o].priority?i:o,a<r.length&&(o=r[a].priority<r[o].priority?a:o),o!==n&&(t.swap(n,o),t.heapify(o)))},this.min=function(){if(t.size()===0)throw new Error("Queue underflow");return t.arr[0].key},this.add=function(n,r){var i=t.keyIndice,a=t.arr;if(!i.has(n)){var o=a.length;return i.set(n,o),a.push({key:n,priority:r}),t.innerDecrease(o),!0}return!1},this.removeMin=function(){t.swap(0,t.arr.length-1);var n=t.arr.pop();return t.keyIndice.delete(n.key),t.heapify(0),n.key},this.decrease=function(n,r){if(!t.has(n))throw new Error("There's no key named ".concat(n));var i=t.keyIndice.get(n);if(r>t.arr[i].priority)throw new Error("New priority is greater than current priority.Key: ".concat(n," Old: + ").concat(t.arr[i].priority," New: ").concat(r));t.arr[i].priority=r,t.innerDecrease(i)}}),Yn=function(t,n){var r=new fr,i=new Map,a=new Vi,o;function s(d){var h=d.v===o?d.w:d.v,v=a.priority(h);if(v!==void 0){var m=n(d);m<v&&(i.set(h,o),a.decrease(h,m))}}if(t.nodeCount()===0)return r;t.nodes().forEach(function(d){a.add(d,Number.POSITIVE_INFINITY),r.setNode(d)}),a.decrease(t.nodes()[0],0);for(var c=!1;a.size()>0;){var f;if(o=a.removeMin(),i.has(o))r.setEdge(o,i.get(o));else{if(c)throw new Error("Input graph is not connected: "+t.graph());c=!0}(f=t.nodeEdges(o))===null||f===void 0||f.forEach(s)}return r},Zn=Yn,$r=function(t){var n=new Set,r=[],i=t.nodes();return i.forEach(function(a){for(var o=[],s=[a];s.length>0;){var c=s.pop();if(!n.has(c)){var f,d;n.add(c),o.push(c),(f=t.successors(c))===null||f===void 0||f.forEach(function(h){return s.push(h)}),(d=t.predecessors(c))===null||d===void 0||d.forEach(function(h){return s.push(h)})}}o.length&&r.push(o)}),r},zn=$r,Rr=function e(t,n,r,i,a,o){i.includes(n)||(i.push(n),r||o.push(n),a(n).forEach(function(s){return e(t,s,r,i,a,o)}),r&&o.push(n))},ri=function(t,n,r){var i=Array.isArray(n)?n:[n],a=function(f){return t.isDirected()?t.successors(f):t.neighbors(f)},o=[],s=[];return i.forEach(function(c){if(t.hasNode(c))Rr(t,c,r==="post",s,a,o);else throw new Error("Graph does not have node: "+c)}),o},Mr=ri;function Ua(e,t){return Xs(e)||dl(e,t)||yc(e,t)||Ar()}function Ar(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yc(e,t){if(!!e){if(typeof e=="string")return bs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bs(e,t)}}function bs(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dl(e,t){var n=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r=[],i=!0,a=!1,o,s;try{for(n=n.call(e);!(i=(o=n.next()).done)&&(r.push(o.value),!(t&&r.length===t));i=!0);}catch(c){a=!0,s=c}finally{try{!i&&n.return!=null&&n.return()}finally{if(a)throw s}}return r}}function Xs(e){if(Array.isArray(e))return e}var ma=function(){return 1},$s=function(t,n,r,i){return ga(t,n,r||ma,i||function(a){return t.outEdges(a)})},ga=function(t,n,r,i){var a=new Map,o=new Vi,s,c,f=function(v){var m=v.v!==s?v.v:v.w,g=a.get(m),_=r(v),y=c.distance+_;if(_<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+v+" Weight: "+_);y<g.distance&&(g.distance=y,g.predecessor=s,o.decrease(m,y))};for(t.nodes().forEach(function(h){var v=h===n?0:Number.POSITIVE_INFINITY;a.set(h,{distance:v}),o.add(h,v)});o.size()>0&&(s=o.removeMin(),c=a.get(s),!(c&&c.distance===Number.POSITIVE_INFINITY));)i(s).forEach(f);var d={};return Array.from(a.entries()).forEach(function(h){var v=Ua(h,2),m=v[0],g=v[1];return d[String(m)]=g,d}),d},ad=$s,od=function(t,n,r){var i={};return t.nodes().forEach(function(a){return i[String(a)]=ad(t,a,n,r),i}),i},ws=od,_c=function(t){var n=0,r=[],i=new Map,a=[];function o(s){var c,f={onStack:!0,lowlink:n,index:n};if(i.set(s,f),n+=1,r.push(s),(c=t.successors(s))===null||c===void 0||c.forEach(function(m){var g;if(i.has(m)){if((g=i.get(m))===null||g===void 0?void 0:g.onStack){var y=i.get(m);f.lowlink=Math.min(f.lowlink,y.index)}}else{o(m);var _=i.get(m);f.lowlink=Math.min(f.lowlink,_.lowlink)}}),f.lowlink===f.index){var d=[],h;do{h=r.pop();var v=i.get(h);v.onStack=!1,d.push(h)}while(s!==h);a.push(d)}}return t.nodes().forEach(function(s){i.has(s)||o(s)}),a},hf=_c,Yr=function(t){return hf(t).filter(function(n){return n.length>1||n.length===1&&t.hasEdge(n[0],n[0])})},Yo=Yr;function Gr(e){return Gr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gr(e)}function hl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vl(e,t,n){return t&&hl(e.prototype,t),n&&hl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function bo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pl(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ko(e,t)}function vf(e){var t=Du();return function(){var r=Ts(e),i;if(t){var a=Ts(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return xs(this,i)}}function xs(e,t){if(t&&(Gr(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nu(e)}function Nu(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ka(e){var t=typeof Map=="function"?new Map:void 0;return Ka=function(r){if(r===null||!ml(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t!="undefined"){if(t.has(r))return t.get(r);t.set(r,i)}function i(){return Ss(r,arguments,Ts(this).constructor)}return i.prototype=Object.create(r.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Ko(i,r)},Ka(e)}function Ss(e,t,n){return Du()?Ss=Reflect.construct:Ss=function(i,a,o){var s=[null];s.push.apply(s,a);var c=Function.bind.apply(i,s),f=new c;return o&&Ko(f,o.prototype),f},Ss.apply(null,arguments)}function Du(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function ml(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function Ko(e,t){return Ko=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Ko(e,t)}function Ts(e){return Ts=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},Ts(e)}var pf=function(e){pl(n,e);var t=vf(n);function n(){return bo(this,n),t.apply(this,arguments)}return vl(n)}(Ka(Error));function Fh(e){var t=new Set,n=new Set,r=[];function i(a){if(n.has(a))throw new pf;if(!t.has(a)){var o;n.add(a),t.add(a),(o=e.predecessors(a))===null||o===void 0||o.forEach(i),n.delete(a),r.push(a)}}if(e.sinks().forEach(i),t.size!==e.nodeCount())throw new pf;return r}var mf=Fh,gl=function(t){try{mf(t)}catch(n){if(n instanceof pf)return!1;throw n}return!0},yl=gl,Ec=function(t,n){return Mr(t,n,"post")},ca=Ec,bc=function(t,n){return Mr(t,n,"pre")},wo=bc,gf=function(){return 1};function yf(e,t,n){return _l(e,t||gf,n||function(r){return e.outEdges(r)})}function _l(e,t,n){var r={},i=e.nodes();return i.forEach(function(a){var o=String(a);r[o]={},r[o][o]={distance:0},i.forEach(function(s){a!==s&&(r[o][String(s)]={distance:Number.POSITIVE_INFINITY})}),n(a).forEach(function(s){var c=s.v===a?s.w:s.v,f=t(s);r[o][String(c)]={distance:f,predecessor:a}})}),i.forEach(function(a){var o=String(a),s=r[o];i.forEach(function(c){var f=String(c),d=r[f];i.forEach(function(h){var v=String(h),m=d[o],g=s[v],_=d[v],y=m.distance+g.distance;y<_.distance&&(_.distance=y,_.predecessor=g.predecessor)})})}),r}var El=yf;function sd(e,t){return ld(e)||fd(e,t)||cd(e,t)||ud()}function ud(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cd(e,t){if(!!e){if(typeof e=="string")return As(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return As(e,t)}}function As(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fd(e,t){var n=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r=[],i=!0,a=!1,o,s;try{for(n=n.call(e);!(i=(o=n.next()).done)&&(r.push(o.value),!(t&&r.length===t));i=!0);}catch(c){a=!0,s=c}finally{try{!i&&n.return!=null&&n.return()}finally{if(a)throw s}}return r}}function ld(e){if(Array.isArray(e))return e}function bl(e){return e instanceof Graph}function dd(e){if(e.isMultigraph())return!1;for(var t=e.edges(),n=new Map,r=0;r<t.length;r++){var i=t[r];if(i.v===i.w)return!1;var a=[i.v,i.w].sort(),o=sd(a,2),s=o[0],c=o[1],f="".concat(s,"-").concat(c);if(n.has(f))return!1;n.set(f,!0)}return!0}function Ba(e){return e.nodes().length===0}function wc(e){for(var t=e.edges(),n=0;n<t.length;n++){var r=t[n];if(r.v===r.w)return!0}return!1}var hd=function(t,n){if(!isSimpleGraph(t)||!isSimpleGraph(n)||!containAllSameNodes(t,n)||containSameEdges(t,n))return!1;var r=t.nodeCount();return t.edgeCount()+n.edgeCount()===r*(r-1)/2},_f=function(t){if(!isSimpleGraph(t))return null;for(var n=t.nodeCount(),r=new Graph({compound:t.isCompound(),directed:t.isDirected(),multigraph:t.isMultigraph()}),i=t.nodes(),a=0;a<n;a++){var o=i[a];r.setNode(o,t.node(o));for(var s=a+1;s<n;s++){var c=i[s];t.hasEdge(o,c)||r.setEdge(o,c)}}return r};class Uh extends ys{}class Pu extends fr{}const qa=()=>1,Ef=(e,t)=>{var n;if(e.nodeCount()<=1)return[];const r=zh(e,t||qa);return(n=Bh(r.graph,r.buckets,r.zeroIdx).map(a=>e.outEdges(a.v,a.w)))===null||n===void 0?void 0:n.flat()},Bh=(e,t,n)=>{let r=[];const i=t[t.length-1],a=t[0];let o;for(;e.nodeCount();){for(;o=a.dequeue();)wl(e,t,n,o);for(;o=i.dequeue();)wl(e,t,n,o);if(e.nodeCount()){for(let s=t.length-2;s>0;--s)if(o=t[s].dequeue(),o){r=r.concat(wl(e,t,n,o,!0));break}}}return r},wl=(e,t,n,r,i)=>{var a,o;const s=[];return(a=e.inEdges(r.v))===null||a===void 0||a.forEach(c=>{const f=e.edge(c),d=e.node(c.v);i&&s.push({v:c.v,w:c.w,in:0,out:0}),d.out===void 0&&(d.out=0),d.out-=f,xc(t,n,d)}),(o=e.outEdges(r.v))===null||o===void 0||o.forEach(c=>{const f=e.edge(c),d=c.w,h=e.node(d);h.in===void 0&&(h.in=0),h.in-=f,xc(t,n,h)}),e.removeNode(r.v),i?s:void 0},zh=(e,t)=>{const n=new Pu;let r=0,i=0;e.nodes().forEach(c=>{n.setNode(c,{v:c,in:0,out:0})}),e.edges().forEach(c=>{const f=n.edge(c)||0,d=(t==null?void 0:t(c))||1,h=f+d;n.setEdge(c.v,c.w,h),i=Math.max(i,n.node(c.v).out+=d),r=Math.max(r,n.node(c.w).in+=d)});const a=[],o=i+r+3;for(let c=0;c<o;c++)a.push(new Uh);const s=r+1;return n.nodes().forEach(c=>{xc(a,s,n.node(c))}),{buckets:a,zeroIdx:s,graph:n}},xc=(e,t,n)=>{n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)};var Wh=Ef;const Ou=e=>{const t=r=>i=>{var a;return((a=r.edge(i))===null||a===void 0?void 0:a.weight)||1},n=e.graph().acyclicer==="greedy"?Wh(e,t(e)):ge(e);n==null||n.forEach(r=>{const i=e.edge(r);e.removeEdgeObj(r),i.forwardName=r.name,i.reversed=!0,e.setEdge(r.w,r.v,i,`rev-${Math.random()}`)})},ge=e=>{const t=[],n={},r={},i=a=>{var o;r[a]||(r[a]=!0,n[a]=!0,(o=e.outEdges(a))===null||o===void 0||o.forEach(s=>{n[s.w]?t.push(s):i(s.w)}),delete n[a])};return e.nodes().forEach(i),t};var Pe={run:Ou,undo:e=>{e.edges().forEach(t=>{const n=e.edge(t);if(n.reversed){e.removeEdgeObj(t);const r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}};class Vt extends fr{}const kn=(e,t)=>Number(e)-Number(t),dr=(e,t,n,r)=>{let i;do i=`${r}${Math.random()}`;while(e.hasNode(i));return n.dummy=t,e.setNode(i,n),i},Kr=e=>{const t=new Vt().setGraph(e.graph());return e.nodes().forEach(n=>{t.setNode(n,e.node(n))}),e.edges().forEach(n=>{const r=t.edgeFromArgs(n.v,n.w)||{weight:0,minlen:1},i=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})}),t},wr=e=>{const t=new Vt({multigraph:e.isMultigraph()}).setGraph(e.graph());return e.nodes().forEach(n=>{var r;((r=e.children(n))===null||r===void 0?void 0:r.length)||t.setNode(n,e.node(n))}),e.edges().forEach(n=>{t.setEdgeObj(n,e.edge(n))}),t},bf=(e,t)=>e==null?void 0:e.reduce((n,r,i)=>(n[r]=t[i],n),{}),ip=e=>{const t={};return e.nodes().forEach(n=>{var r;const i={};(r=e.outEdges(n))===null||r===void 0||r.forEach(a=>{var o;i[a.w]=(i[a.w]||0)+(((o=e.edge(a))===null||o===void 0?void 0:o.weight)||0)}),t[n]=i}),t},Ja=e=>{const t=e.nodes(),n=t.map(r=>{var i;const a={};return(i=e.inEdges(r))===null||i===void 0||i.forEach(o=>{a[o.v]=(a[o.v]||0)+e.edge(o).weight}),a});return bf(t,n)},Sc=(e,t)=>{const n=Number(e.x),r=Number(e.y),i=Number(t.x)-n,a=Number(t.y)-r;let o=Number(e.width)/2,s=Number(e.height)/2;if(!i&&!a)return{x:0,y:0};let c,f;return Math.abs(a)*o>Math.abs(i)*s?(a<0&&(s=-s),c=s*i/a,f=s):(i<0&&(o=-o),c=o,f=o*a/i),{x:n+c,y:r+f}},Lu=e=>{const t=[],n=Kn(e)+1;for(let r=0;r<n;r++)t.push([]);e.nodes().forEach(r=>{const a=e.node(r).rank;a!==void 0&&t[a]&&t[a].push(r)});for(let r=0;r<n;r++)t[r]=t[r].sort((i,a)=>{var o,s;return kn((o=e.node(i))===null||o===void 0?void 0:o.order,(s=e.node(a))===null||s===void 0?void 0:s.order)});return t},xo=e=>{const t=e.nodes().filter(r=>{var i;return((i=e.node(r))===null||i===void 0?void 0:i.rank)!==void 0}).map(r=>e.node(r).rank),n=Math.min(...t);e.nodes().forEach(r=>{const i=e.node(r);i.hasOwnProperty("rank")&&n!==Infinity&&(i.rank-=n)})},wf=e=>{const t=e.nodes(),n=t.filter(s=>{var c;return((c=e.node(s))===null||c===void 0?void 0:c.rank)!==void 0}).map(s=>e.node(s).rank),r=Math.min(...n),i=[];t.forEach(s=>{var c;const f=(((c=e.node(s))===null||c===void 0?void 0:c.rank)||0)-r;i[f]||(i[f]=[]),i[f].push(s)});let a=0;const o=e.graph().nodeRankFactor||0;for(let s=0;s<i.length;s++){const c=i[s];c===void 0?s%o!=0&&(a-=1):a&&(c==null||c.forEach(f=>{const d=e.node(f);d&&(d.rank=d.rank||0,d.rank+=a)}))}},Is=(e,t,n,r)=>{const i={width:0,height:0};return Z(n)&&Z(r)&&(i.rank=n,i.order=r),dr(e,"border",i,t)},Kn=e=>{let t;return e.nodes().forEach(n=>{var r;const i=(r=e.node(n))===null||r===void 0?void 0:r.rank;i!==void 0&&(t===void 0||i>t)&&(t=i)}),t||(t=0),t},Gu=(e,t)=>{const n={lhs:[],rhs:[]};return e==null||e.forEach(r=>{t(r)?n.lhs.push(r):n.rhs.push(r)}),n},xf=(e,t)=>{const n=Date.now();try{return t()}finally{console.log(`${e} time: ${Date.now()-n}ms`)}},ku=(e,t)=>t(),Sf=(e,t)=>e.reduce((n,r)=>{const i=t(n),a=t(r);return i>a?r:n}),vd=e=>{e.graph().dummyChains=[],e.edges().forEach(t=>pd(e,t))},pd=(e,t)=>{let n=t.v,r=e.node(n).rank;const i=t.w,a=e.node(i).rank,o=t.name,s=e.edge(t),c=s.labelRank;if(a===r+1)return;e.removeEdgeObj(t);const f=e.graph();let d,h,v;for(v=0,++r;r<a;++v,++r)s.points=[],h={edgeLabel:s,width:0,height:0,edgeObj:t,rank:r},d=dr(e,"edge",h,"_d"),r===c&&(h.width=s.width,h.height=s.height,h.dummy="edge-label",h.labelpos=s.labelpos),e.setEdge(n,d,{weight:s.weight},o),v===0&&(f.dummyChains||(f.dummyChains=[]),f.dummyChains.push(d)),n=d;e.setEdge(n,i,{weight:s.weight},o)};var qo={run:vd,undo:e=>{var t;(t=e.graph().dummyChains)===null||t===void 0||t.forEach(n=>{let r=e.node(n);const i=r.edgeLabel;let a;r.edgeObj&&e.setEdgeObj(r.edgeObj,i);let o=n;for(;r.dummy;)a=e.successors(o)[0],e.removeNode(o),i.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height),o=a,r=e.node(o)})}};const Qa=e=>{var t;const n={},r=i=>{var a;const o=e.node(i);if(n[i])return o.rank;n[i]=!0;let s;return(a=e.outEdges(i))===null||a===void 0||a.forEach(c=>{const f=r(c.w),d=e.edge(c).minlen,h=f-d;h&&(s===void 0||h<s)&&(s=h)}),s||(s=0),o.rank=s,s};(t=e.sources())===null||t===void 0||t.forEach(i=>r(i))},Ni=e=>{var t;const n={};let r;const i=o=>{var s;const c=e.node(o);if(n[o])return c.rank;n[o]=!0;let f;return(s=e.outEdges(o))===null||s===void 0||s.forEach(d=>{const h=i(d.w),v=e.edge(d).minlen,m=h-v;m&&(f===void 0||m<f)&&(f=m)}),f||(f=0),(r===void 0||f<r)&&(r=f),c.rank=f,f};(t=e.sources())===null||t===void 0||t.forEach(o=>i(o)),r===void 0&&(r=0);const a=(o,s)=>{var c;const f=e.node(o),d=isNaN(f.layer)?s:f.layer;(f.rank===void 0||f.rank<d)&&(f.rank=d),(c=e.outEdges(o))===null||c===void 0||c.map(h=>{a(h.w,d+e.edge(h).minlen)})};e.nodes().forEach(o=>{const s=e.node(o);isNaN(s.layer)?s.rank-=r:a(o,s.layer)})},Ta=(e,t)=>e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen;var md={longestPath:Qa,longestPathWithLayer:Ni,slack:Ta};const Jo=e=>{const t=new Vt({directed:!1}),n=e.nodes()[0],r=e.nodeCount();t.setNode(n,{});let i,a;for(;Tc(t,e)<r;)i=Cs(t,e),a=t.hasNode(i.v)?Ta(e,i):-Ta(e,i),Ic(t,e,a);return t},Tc=(e,t)=>{const n=r=>{t.nodeEdges(r).forEach(i=>{const a=i.v,o=r===a?i.w:a;!e.hasNode(o)&&!Ta(t,i)&&(e.setNode(o,{}),e.setEdge(r,o,{}),n(o))})};return e.nodes().forEach(n),e.nodeCount()},Af=e=>{const t=new Vt({directed:!1}),n=e.nodes()[0],r=e.nodeCount();t.setNode(n,{});let i,a;for(;Ac(t,e)<r;)i=Cs(t,e),a=t.hasNode(i.v)?Ta(e,i):-Ta(e,i),Ic(t,e,a);return t},Ac=(e,t)=>{const n=r=>{var i;(i=t.nodeEdges(r))===null||i===void 0||i.forEach(a=>{const o=a.v,s=r===o?a.w:o;!e.hasNode(s)&&(t.node(s).layer!==void 0||!Ta(t,a))&&(e.setNode(s,{}),e.setEdge(r,s,{}),n(s))})};return e.nodes().forEach(n),e.nodeCount()},Cs=(e,t)=>Sf(t.edges(),n=>e.hasNode(n.v)!==e.hasNode(n.w)?Ta(t,n):Infinity),Ic=(e,t,n)=>{e.nodes().forEach(r=>{t.node(r).rank||(t.node(r).rank=0),t.node(r).rank+=n})};var ap={feasibleTree:Jo,feasibleTreeWithLayer:Af};const{preorder:xl,postorder:gd}=N,If=e=>{const t=Kr(e);Qa(t);const n=Jo(t);Uu(n),Fu(n,t);let r,i;for(;r=Rs(n);)i=pi(n,t,r),Ji(n,t,r,i)},Fu=(e,t)=>{let n=gd(e,e.nodes());n=n==null?void 0:n.slice(0,(n==null?void 0:n.length)-1),n==null||n.forEach(r=>{Cf(e,t,r)})},Cf=(e,t,n)=>{const i=e.node(n).parent;e.edgeFromArgs(n,i).cutvalue=Vh(e,t,n)},Vh=(e,t,n)=>{var r;const a=e.node(n).parent;let o=!0,s=t.edgeFromArgs(n,a),c=0;return s||(o=!1,s=t.edgeFromArgs(a,n)),c=s.weight,(r=t.nodeEdges(n))===null||r===void 0||r.forEach(f=>{const d=f.v===n,h=d?f.w:f.v;if(h!==a){const v=d===o,m=t.edge(f).weight;if(c+=v?m:-m,Ed(e,n,h)){const g=e.edgeFromArgs(n,h).cutvalue;c+=v?-g:g}}}),c},Uu=(e,t=e.nodes()[0])=>{yd(e,{},1,t)},yd=(e,t,n,r,i)=>{var a;const o=n;let s=n;const c=e.node(r);return t[r]=!0,(a=e.neighbors(r))===null||a===void 0||a.forEach(f=>{t[f]||(s=yd(e,t,s,f,r))}),c.low=o,c.lim=s++,i?c.parent=i:delete c.parent,s},Rs=e=>e.edges().find(t=>e.edge(t).cutvalue<0),pi=(e,t,n)=>{let r=n.v,i=n.w;t.hasEdge(r,i)||(r=n.w,i=n.v);const a=e.node(r),o=e.node(i);let s=a,c=!1;a.lim>o.lim&&(s=o,c=!0);const f=t.edges().filter(d=>c===Rf(e,e.node(d.v),s)&&c!==Rf(e,e.node(d.w),s));return Sf(f,d=>Ta(t,d))},Ji=(e,t,n,r)=>{const i=n.v,a=n.w;e.removeEdge(i,a),e.setEdge(r.v,r.w,{}),Uu(e),Fu(e,t),_d(e,t)},_d=(e,t)=>{const n=e.nodes().find(i=>{var a;return!((a=t.node(i))===null||a===void 0?void 0:a.parent)});let r=xl(e,n);r=r==null?void 0:r.slice(1),r==null||r.forEach(i=>{const a=e.node(i).parent;let o=t.edgeFromArgs(i,a),s=!1;o||(o=t.edgeFromArgs(a,i),s=!0),t.node(i).rank=t.node(a).rank+(s?o.minlen:-o.minlen)})},Ed=(e,t,n)=>e.hasEdge(t,n),Rf=(e,t,n)=>n.low<=t.lim&&t.lim<=n.lim;var bd=If;const Mf=e=>{switch(e.graph().ranker){case"network-simplex":Ys(e);break;case"tight-tree":Cc(e);break;case"longest-path":Bu(e);break;default:Cc(e)}},Bu=Qa,Cc=e=>{Ni(e),Af(e)},Ys=e=>{bd(e)};var fa=Mf;const zu=e=>{var t;const n={};let r=0;const i=a=>{var o;const s=r;(o=e.children(a))===null||o===void 0||o.forEach(i),n[a]={low:s,lim:r++}};return(t=e.children())===null||t===void 0||t.forEach(i),n},Nf=(e,t,n,r)=>{const i=[],a=[],o=Math.min(t[n].low,t[r].low),s=Math.max(t[n].lim,t[r].lim);let c,f;c=n;do c=e.parent(c),i.push(c);while(c&&(t[c].low>o||s>t[c].lim));for(f=c,c=r;c&&c!==f;)a.push(c),c=e.parent(c);return{lca:f,path:i.concat(a.reverse())}};var Sl=e=>{var t;const n=zu(e);(t=e.graph().dummyChains)===null||t===void 0||t.forEach(r=>{var i,a;let o=r,s=e.node(o);const c=s.edgeObj;if(!c)return;const f=Nf(e,n,c.v,c.w),d=f.path,h=f.lca;let v=0,m=d[v],g=!0;for(;o!==c.w;){if(s=e.node(o),g){for(;m!==h&&((i=e.node(m))===null||i===void 0?void 0:i.maxRank)<s.rank;)v++,m=d[v];m===h&&(g=!1)}if(!g){for(;v<d.length-1&&((a=e.node(d[v+1]))===null||a===void 0?void 0:a.minRank)<=s.rank;)v++;m=d[v]}e.setParent(o,m),o=e.successors(o)[0]}})};const Ks=e=>{var t;const n=dr(e,"root",{},"_root"),r=wd(e);let i=Math.max(...Object.values(r));Math.abs(i)===Infinity&&(i=1);const a=i-1,o=2*a+1;e.graph().nestingRoot=n,e.edges().forEach(c=>{e.edge(c).minlen*=o});const s=xd(e)+1;(t=e.children())===null||t===void 0||t.forEach(c=>{Rc(e,n,o,s,a,r,c)}),e.graph().nodeRankFactor=o},Rc=(e,t,n,r,i,a,o)=>{const s=e.children(o);if(!(s==null?void 0:s.length)){o!==t&&e.setEdge(t,o,{weight:0,minlen:n});return}const c=Is(e,"_bt"),f=Is(e,"_bb"),d=e.node(o);e.setParent(c,o),d.borderTop=c,e.setParent(f,o),d.borderBottom=f,s==null||s.forEach(h=>{Rc(e,t,n,r,i,a,h);const v=e.node(h),m=v.borderTop?v.borderTop:h,g=v.borderBottom?v.borderBottom:h,_=v.borderTop?r:2*r,y=m!==g?1:i-a[o]+1;e.setEdge(c,m,{minlen:y,weight:_,nestingEdge:!0}),e.setEdge(g,f,{minlen:y,weight:_,nestingEdge:!0})}),e.parent(o)||e.setEdge(t,c,{weight:0,minlen:i+a[o]})},wd=e=>{var t;const n={},r=(i,a)=>{const o=e.children(i);o==null||o.forEach(s=>r(s,a+1)),n[i]=a};return(t=e.children())===null||t===void 0||t.forEach(i=>r(i,1)),n},xd=e=>{let t=0;return e.edges().forEach(n=>{t+=e.edge(n).weight}),t};var qs={run:Ks,cleanup:e=>{const t=e.graph();t.nestingRoot&&e.removeNode(t.nestingRoot),delete t.nestingRoot,e.edges().forEach(n=>{e.edge(n).nestingEdge&&e.removeEdgeObj(n)})}};const Tl=e=>{var t;const n=r=>{const i=e.children(r),a=e.node(r);if((i==null?void 0:i.length)&&i.forEach(o=>n(o)),a.hasOwnProperty("minRank")){a.borderLeft=[],a.borderRight=[];for(let o=a.minRank,s=a.maxRank+1;o<s;o+=1)P(e,"borderLeft","_bl",r,a,o),P(e,"borderRight","_br",r,a,o)}};(t=e.children())===null||t===void 0||t.forEach(r=>n(r))},P=(e,t,n,r,i,a)=>{const o={rank:a,borderType:t,width:0,height:0},s=i[t][a-1],c=dr(e,"border",o,n);i[t][a]=c,e.setParent(c,r),s&&e.setEdge(s,c,{weight:1})};var Wu=Tl;const Pf=e=>{var t;const n=(t=e.graph().rankdir)===null||t===void 0?void 0:t.toLowerCase();(n==="lr"||n==="rl")&&lr(e)},za=e=>{var t;const n=(t=e.graph().rankdir)===null||t===void 0?void 0:t.toLowerCase();(n==="bt"||n==="rl")&&Zh(e),(n==="lr"||n==="rl")&&(Ms(e),lr(e))},lr=e=>{e.nodes().forEach(t=>{Sd(e.node(t))}),e.edges().forEach(t=>{Sd(e.edge(t))})},Sd=e=>{const t=e.width;e.width=e.height,e.height=t},Zh=e=>{e.nodes().forEach(t=>{Of(e.node(t))}),e.edges().forEach(t=>{var n;const r=e.edge(t);(n=r.points)===null||n===void 0||n.forEach(i=>Of(i)),r.hasOwnProperty("y")&&Of(r)})},Of=e=>{(e==null?void 0:e.y)&&(e.y=-e.y)},Ms=e=>{e.nodes().forEach(t=>{Al(e.node(t))}),e.edges().forEach(t=>{var n;const r=e.edge(t);(n=r.points)===null||n===void 0||n.forEach(i=>Al(i)),r.hasOwnProperty("x")&&Al(r)})},Al=e=>{const t=e.x;e.x=e.y,e.y=t};var Td={adjust:Pf,undo:za},Mc=e=>{const t={},n=e.nodes().filter(d=>{var h;return!((h=e.children(d))===null||h===void 0?void 0:h.length)}),r=n.map(d=>e.node(d).rank),i=Math.max(...r),a=[];for(let d=0;d<i+1;d++)a.push([]);const o=d=>{var h;if(t.hasOwnProperty(d))return;t[d]=!0;const v=e.node(d);isNaN(v.rank)||a[v.rank].push(d),(h=e.successors(d))===null||h===void 0||h.forEach(m=>o(m))},s=n.sort((d,h)=>e.node(d).rank-e.node(h).rank),f=s.filter(d=>e.node(d).fixorder!==void 0).sort((d,h)=>e.node(d).fixorder-e.node(h).fixorder);return f==null||f.forEach(d=>{isNaN(e.node(d).rank)||a[e.node(d).rank].push(d),t[d]=!0}),s==null||s.forEach(o),a};const jh=(e,t,n)=>{const r=bf(n,n.map((d,h)=>h)),a=t.map(d=>{var h;const v=(h=e.outEdges(d))===null||h===void 0?void 0:h.map(m=>({pos:r[m.w]||0,weight:e.edge(m).weight}));return v==null?void 0:v.sort((m,g)=>m.pos-g.pos)}).flat().filter(d=>d!==void 0);let o=1;for(;o<n.length;)o<<=1;const s=2*o-1;o-=1;const c=Array(s).fill(0,0,s);let f=0;return a==null||a.forEach(d=>{if(d){let h=d.pos+o;c[h]+=d.weight;let v=0;for(;h>0;)h%2&&(v+=c[h+1]),h=h-1>>1,c[h]+=d.weight;f+=d.weight*v}}),f};var Id=(e,t)=>{let n=0;for(let r=1;r<(t==null?void 0:t.length);r+=1)n+=jh(e,t[r-1],t[r]);return n};const Hh=(e,t,n)=>{const r=Xh(e),i=new Vt({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(a=>e.node(a));return e.nodes().forEach(a=>{var o;const s=e.node(a),c=e.parent(a);(s.rank===t||s.minRank<=t&&t<=s.maxRank)&&(i.setNode(a),i.setParent(a,c||r),(o=e[n](a))===null||o===void 0||o.forEach(f=>{const d=f.v===a?f.w:f.v,h=i.edgeFromArgs(d,a),v=h!==void 0?h.weight:0;i.setEdge(d,a,{weight:e.edge(f).weight+v})}),s.hasOwnProperty("minRank")&&i.setNode(a,{borderLeft:s.borderLeft[t],borderRight:s.borderRight[t]}))}),i},Xh=e=>{let t;for(;e.hasNode(t=`_root${Math.random()}`););return t};var Cd=Hh,Qo=(e,t,n)=>{const r={};let i;n==null||n.forEach(a=>{let o=e.parent(a),s,c;for(;o;){if(s=e.parent(o),s?(c=r[s],r[s]=o):(c=i,i=o),c&&c!==o){t.setEdge(c,o);return}o=s}})},$h=(e,t)=>t.map(n=>{const r=e.inEdges(n);if(!(r==null?void 0:r.length))return{v:n};{const i={sum:0,weight:0};return r==null||r.forEach(a=>{const o=e.edge(a),s=e.node(a.v);i.sum+=o.weight*s.order,i.weight+=o.weight}),{v:n,barycenter:i.sum/i.weight,weight:i.weight}}});const Yh=(e,t)=>{var n,r,i;const a={};e==null||e.forEach((s,c)=>{a[s.v]={i:c,indegree:0,in:[],out:[],vs:[s.v]};const f=a[s.v];s.barycenter!==void 0&&(f.barycenter=s.barycenter,f.weight=s.weight)}),(n=t.edges())===null||n===void 0||n.forEach(s=>{const c=a[s.v],f=a[s.w];c!==void 0&&f!==void 0&&(f.indegree++,c.out.push(a[s.w]))});const o=(i=(r=Object.values(a)).filter)===null||i===void 0?void 0:i.call(r,s=>!s.indegree);return Vu(o)},Vu=e=>{var t,n;const r=[],i=c=>f=>{f.merged||(f.barycenter===void 0||c.barycenter===void 0||f.barycenter>=c.barycenter)&&Kh(c,f)},a=c=>f=>{f.in.push(c),--f.indegree==0&&e.push(f)};for(;e==null?void 0:e.length;){const c=e.pop();r.push(c),(t=c.in.reverse())===null||t===void 0||t.forEach(f=>i(c)(f)),(n=c.out)===null||n===void 0||n.forEach(f=>a(c)(f))}const o=r.filter(c=>!c.merged),s=["vs","i","barycenter","weight"];return o.map(c=>{const f={};return s==null||s.forEach(d=>{c[d]!==void 0&&(f[d]=c[d])}),f})},Kh=(e,t)=>{var n;let r=0,i=0;e.weight&&(r+=e.barycenter*e.weight,i+=e.weight),t.weight&&(r+=t.barycenter*t.weight,i+=t.weight),e.vs=(n=t.vs)===null||n===void 0?void 0:n.concat(e.vs),e.barycenter=r/i,e.weight=i,e.i=Math.min(t.i,e.i),t.merged=!0};var Js=Yh;const Rd=(e,t,n)=>{const r=Gu(e,h=>h.hasOwnProperty("fixorder")&&!isNaN(h.fixorder)||h.hasOwnProperty("barycenter")),i=r.lhs,a=r.rhs.sort((h,v)=>-h.i- -v.i),o=[];let s=0,c=0,f=0;i==null||i.sort(eo(!!t,!!n)),f=Lf(o,a,f),i==null||i.forEach(h=>{var v;f+=(v=h.vs)===null||v===void 0?void 0:v.length,o.push(h.vs),s+=h.barycenter*h.weight,c+=h.weight,f=Lf(o,a,f)});const d={vs:o.flat()};return c&&(d.barycenter=s/c,d.weight=c),d},Lf=(e,t,n)=>{let r=n,i;for(;t.length&&(i=t[t.length-1]).i<=r;)t.pop(),e==null||e.push(i.vs),r++;return r},eo=(e,t)=>(n,r)=>{if(n.fixorder!==void 0&&r.fixorder!==void 0)return n.fixorder-r.fixorder;if(n.barycenter<r.barycenter)return-1;if(n.barycenter>r.barycenter)return 1;if(t&&n.order!==void 0&&r.order!==void 0){if(n.order<r.order)return-1;if(n.order>r.order)return 1}return e?r.i-n.i:n.i-r.i};var Md=Rd;const Nd=(e,t,n,r,i)=>{var a,o,s,c;let f=e.children(t);const d=e.node(t),h=d?d.borderLeft:void 0,v=d?d.borderRight:void 0,m={};h&&(f=f==null?void 0:f.filter(E=>E!==h&&E!==v));const g=$h(e,f||[]);g==null||g.forEach(E=>{var b;if((b=e.children(E.v))===null||b===void 0?void 0:b.length){const A=Nd(e,E.v,n,r);m[E.v]=A,A.hasOwnProperty("barycenter")&&Jh(E,A)}});const _=Js(g,n);qh(_,m),(a=_.filter(E=>E.vs.length>0))===null||a===void 0||a.forEach(E=>{const b=e.node(E.vs[0]);b&&(E.fixorder=b.fixorder,E.order=b.order)});const y=Md(_,r,i);if(h&&(y.vs=[h,y.vs,v].flat(),(o=e.predecessors(h))===null||o===void 0?void 0:o.length)){const E=e.node(((s=e.predecessors(h))===null||s===void 0?void 0:s[0])||""),b=e.node(((c=e.predecessors(v))===null||c===void 0?void 0:c[0])||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+E.order+b.order)/(y.weight+2),y.weight+=2}return y},qh=(e,t)=>{e==null||e.forEach(n=>{var r;const i=(r=n.vs)===null||r===void 0?void 0:r.map(a=>t[a]?t[a].vs:a);n.vs=i.flat()})},Jh=(e,t)=>{e.barycenter!==void 0?(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight):(e.barycenter=t.barycenter,e.weight=t.weight)};var Qh=Nd;const Dd=e=>{const t=Kn(e),n=[],r=[];for(let f=1;f<t+1;f++)n.push(f);for(let f=t-1;f>-1;f--)r.push(f);const i=Qs(e,n,"inEdges"),a=Qs(e,r,"outEdges");let o=Mc(e);Zu(e,o);let s=Number.POSITIVE_INFINITY,c;for(let f=0,d=0;d<4;++f,++d){Pd(f%2?i:a,f%4>=2),o=Lu(e);const h=Id(e,o);h<s&&(d=0,c=rt(o),s=h)}o=Mc(e),Zu(e,o);for(let f=0,d=0;d<4;++f,++d){Pd(f%2?i:a,f%4>=2,!0),o=Lu(e);const h=Id(e,o);h<s&&(d=0,c=rt(o),s=h)}Zu(e,c)},Qs=(e,t,n)=>t.map(r=>Cd(e,r,n)),Pd=(e,t,n)=>{const r=new Vt;e==null||e.forEach(i=>{var a;const o=i.graph().root,s=Qh(i,o,r,t,n);for(let c=0;c<((a=s.vs)===null||a===void 0?void 0:a.length);c++){const f=i.node(s.vs[c]);f&&(f.order=c)}Qo(i,r,s.vs)})},Zu=(e,t)=>{t==null||t.forEach(n=>{n==null||n.forEach((r,i)=>{e.node(r).order=i})})};var Il=Dd;class So extends fr{}const To=(e,t)=>{const n={},r=(i,a)=>{let o=0,s=0;const c=i.length,f=a==null?void 0:a[(a==null?void 0:a.length)-1];return a==null||a.forEach((d,h)=>{var v;const m=eu(e,d),g=m?e.node(m).order:c;(m||d===f)&&((v=a.slice(s,h+1))===null||v===void 0||v.forEach(_=>{var y;(y=e.predecessors(_))===null||y===void 0||y.forEach(E=>{var b;const A=e.node(E),C=A.order;(C<o||g<C)&&!(A.dummy&&((b=e.node(_))===null||b===void 0?void 0:b.dummy))&&Cl(n,E,_)})}),s=h+1,o=g)}),a};return(t==null?void 0:t.length)&&t.reduce(r),n},Od=(e,t)=>{const n={},r=(a,o,s,c,f)=>{let d;const h=[];for(let v=o;v<s;v++)h.push(v);h.forEach(v=>{var m,g;d=a[v],((m=e.node(d))===null||m===void 0?void 0:m.dummy)&&((g=e.predecessors(d))===null||g===void 0||g.forEach(_=>{const y=e.node(_);y.dummy&&(y.order<c||y.order>f)&&Cl(n,_,d)}))})},i=(a,o)=>{let s=-1,c,f=0;return o==null||o.forEach((d,h)=>{var v;if(((v=e.node(d))===null||v===void 0?void 0:v.dummy)==="border"){const m=e.predecessors(d)||[];m.length&&(c=e.node(m[0]).order,r(o,f,h,s,c),f=h,s=c)}r(o,f,o.length,c,a.length)}),o};return(t==null?void 0:t.length)&&t.reduce(i),n},eu=(e,t)=>{var n,r;if((n=e.node(t))===null||n===void 0?void 0:n.dummy)return(r=e.predecessors(t))===null||r===void 0?void 0:r.find(i=>e.node(i).dummy)},Cl=(e,t,n)=>{let r=t,i=n;if(r>i){const o=r;r=i,i=o}let a=e[r];a||(e[r]=a={}),a[i]=!0},ya=(e,t,n)=>{let r=t,i=n;if(r>i){const a=t;r=i,i=a}return!!e[r]},ju=(e,t,n,r)=>{const i={},a={},o={};return t==null||t.forEach(s=>{s==null||s.forEach((c,f)=>{i[c]=c,a[c]=c,o[c]=f})}),t==null||t.forEach(s=>{let c=-1;s==null||s.forEach(f=>{let d=r(f);if(d.length){d=d.sort((v,m)=>o[v]-o[m]);const h=(d.length-1)/2;for(let v=Math.floor(h),m=Math.ceil(h);v<=m;++v){const g=d[v];a[f]===f&&c<o[g]&&!ya(n,f,g)&&(a[g]=f,a[f]=i[f]=i[g],c=o[g])}}})}),{root:i,align:a}},Ao=(e,t,n,r,i)=>{var a;const o={},s=_a(e,t,n,i),c=i?"borderLeft":"borderRight",f=(v,m)=>{let g=s.nodes(),_=g.pop();const y={};for(;_;)y[_]?v(_):(y[_]=!0,g.push(_),g=g.concat(m(_))),_=g.pop()},d=v=>{o[v]=(s.inEdges(v)||[]).reduce((m,g)=>Math.max(m,(o[g.v]||0)+s.edge(g)),0)},h=v=>{const m=(s.outEdges(v)||[]).reduce((_,y)=>Math.min(_,(o[y.w]||0)-s.edge(y)),Number.POSITIVE_INFINITY),g=e.node(v);m!==Number.POSITIVE_INFINITY&&g.borderType!==c&&(o[v]=Math.max(o[v],m))};return f(d,s.predecessors.bind(s)),f(h,s.successors.bind(s)),(a=Object.values(r))===null||a===void 0||a.forEach(v=>{o[v]=o[n[v]]}),o},_a=(e,t,n,r)=>{const i=new So,a=e.graph(),o=es(a.nodesep,a.edgesep,r);return t==null||t.forEach(s=>{let c;s==null||s.forEach(f=>{const d=n[f];if(i.setNode(d),c){const h=n[c],v=i.edgeFromArgs(h,d);i.setEdge(h,d,Math.max(o(e,f,c),v||0))}c=f})}),i},Gf=(e,t)=>Sf(Object.values(t),n=>{var r;let i=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY;return(r=Object.keys(n))===null||r===void 0||r.forEach(o=>{const s=n[o],c=Rl(e,o)/2;i=Math.max(s+c,i),a=Math.min(s-c,a)}),i-a});function Nc(e,t){const n=Object.values(t),r=Math.min(...n),i=Math.max(...n);["u","d"].forEach(a=>{["l","r"].forEach(o=>{const s=a+o,c=e[s];let f;if(c===t)return;const d=Object.values(c);f=o==="l"?r-Math.min(...d):i-Math.max(...d),f&&(e[s]={},Object.keys(c).forEach(h=>{e[s][h]=c[h]+f}))})})}const Hu=(e,t)=>{const n={};return Object.keys(e.ul).forEach(r=>{if(t)n[r]=e[t.toLowerCase()][r];else{const i=Object.values(e).map(a=>a[r]);n[r]=(i[0]+i[1])/2}}),n},Dc=e=>{const t=buildLayerMatrix(e),n=Object.assign(To(e,t),Od(e,t)),r={};let i;["u","d"].forEach(o=>{i=o==="u"?t:Object.values(t).reverse(),["l","r"].forEach(s=>{s==="r"&&(i=i.map(h=>Object.values(h).reverse()));const c=(o==="u"?e.predecessors:e.successors).bind(e),f=ju(e,i,n,c),d=Ao(e,i,f.root,f.align,s==="r");s==="r"&&Object.keys(d).forEach(h=>{d[h]=-d[h]}),r[o+s]=d})});const a=Gf(e,r);return Nc(r,a),Hu(r,e.graph().align)},es=(e,t,n)=>(r,i,a)=>{const o=r.node(i),s=r.node(a);let c=0,f;if(c+=o.width/2,o.hasOwnProperty("labelpos"))switch((o.labelpos||"").toLowerCase()){case"l":f=-o.width/2;break;case"r":f=o.width/2;break}if(f&&(c+=n?f:-f),f=0,c+=(o.dummy?t:e)/2,c+=(s.dummy?t:e)/2,c+=s.width/2,s.labelpos)switch((s.labelpos||"").toLowerCase()){case"l":f=s.width/2;break;case"r":f=-s.width/2;break}return f&&(c+=n?f:-f),f=0,c},Rl=(e,t)=>e.node(t).width||0,Ld=e=>{const t=Lu(e),n=e.graph().ranksep;let r=0;t==null||t.forEach(i=>{const a=i.map(s=>e.node(s).height),o=Math.max(...a);i==null||i.forEach(s=>{e.node(s).y=r+o/2}),r+=o+n})},Pc=e=>{const t=Lu(e),n=Object.assign(To(e,t),Od(e,t)),r={};let i=[];["u","d"].forEach(o=>{i=o==="u"?t:Object.values(t).reverse(),["l","r"].forEach(s=>{s==="r"&&(i=i.map(h=>Object.values(h).reverse()));const c=(o==="u"?e.predecessors:e.successors).bind(e),f=ju(e,i,n,c),d=Ao(e,i,f.root,f.align,s==="r");s==="r"&&Object.keys(d).forEach(h=>d[h]=-d[h]),r[o+s]=d})});const a=Gf(e,r);return a&&Nc(r,a),Hu(r,e.graph().align)};var kf=e=>{var t;const n=wr(e);Ld(n);const r=Pc(n);(t=Object.keys(r))===null||t===void 0||t.forEach(i=>{n.node(i).x=r[i]})},Ff=(e,t)=>{const r=e.nodes().filter(o=>{var s;return!((s=e.children(o))===null||s===void 0?void 0:s.length)}).map(o=>e.node(o).rank),i=Math.max(...r),a=Array(i+1).fill([]);t==null||t.forEach(o=>{const s=e.node(o);!s||(s==null?void 0:s.dummy)||isNaN(s.rank)||(s.fixorder=a[s.rank].length,a[s.rank].push(o))})};const Ml=(e,t)=>{const n=t&&t.debugTiming?xf:ku;n("layout",()=>{t&&!t.keepNodeOrder&&t.prevGraph&&n("  inheritOrder",()=>{Oc(e,t.prevGraph)});const r=n("  buildLayoutGraph",()=>Ud(e));t&&t.edgeLabelSpace===!1||n("  makeSpaceForEdgeLabels",()=>{Xu(r)});try{n("  runLayout",()=>{to(r,n,t)})}catch(i){if(i.message==="Not possible to find intersection inside of the rectangle"){console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,i);return}throw i}n("  updateInputGraph",()=>{Lc(e,r)})})},to=(e,t,n)=>{t("    removeSelfEdges",()=>{kc(e)}),t("    acyclic",()=>{Pe.run(e)}),t("    nestingGraph.run",()=>{qs.run(e)}),t("    rank",()=>{fa(wr(e))}),t("    injectEdgeLabelProxies",()=>{zf(e)}),t("    removeEmptyRanks",()=>{wf(e)}),t("    nestingGraph.cleanup",()=>{qs.cleanup(e)}),t("    normalizeRanks",()=>{xo(e)}),t("    assignRankMinMax",()=>{Dl(e)}),t("    removeEdgeLabelProxies",()=>{Gc(e)}),t("    normalize.run",()=>{qo.run(e)}),t("    parentDummyChains",()=>{Sl(e)}),t("    addBorderSegments",()=>{Wu(e)}),n&&n.keepNodeOrder&&t("    initDataOrder",()=>{Ff(e,n.nodeOrder)}),t("    order",()=>{Il(e)}),t("    insertSelfEdges",()=>{Fc(e)}),t("    adjustCoordinateSystem",()=>{Td.adjust(e)}),t("    position",()=>{kf(e)}),t("    positionSelfEdges",()=>{ru(e)}),t("    removeBorderNodes",()=>{Ps(e)}),t("    normalize.undo",()=>{qo.undo(e)}),t("    fixupEdgeLabelCoords",()=>{ts(e)}),t("    undoCoordinateSystem",()=>{Td.undo(e)}),t("    translateGraph",()=>{$u(e)}),t("    assignNodeIntersects",()=>{Wf(e)}),t("    reversePoints",()=>{nu(e)}),t("    acyclic.undo",()=>{Pe.undo(e)})},Oc=(e,t)=>{e.nodes().forEach(n=>{const r=e.node(n),i=t.node(n);i!==void 0?(r.fixorder=i._order,delete i._order):delete r.fixorder})},Lc=(e,t)=>{e.nodes().forEach(n=>{var r;const i=e.node(n);if(i){const a=t.node(n);i.x=a.x,i.y=a.y,i._order=a.order,i._rank=a.rank,((r=t.children(n))===null||r===void 0?void 0:r.length)&&(i.width=a.width,i.height=a.height)}}),e.edges().forEach(n=>{const r=e.edge(n),i=t.edge(n);r.points=i.points,i.hasOwnProperty("x")&&(r.x=i.x,r.y=i.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height},Ds=["nodesep","edgesep","ranksep","marginx","marginy"],Uf={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},ki=["acyclicer","ranker","rankdir","align"],Bf=["width","height","layer","fixorder"],Nl={width:0,height:0},kd=["minlen","weight","width","height","labeloffset"],Fd={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},tu=["labelpos"],Ud=e=>{const t=new Vt({multigraph:!0,compound:!0}),n=no(e.graph()),r={};return ki==null||ki.forEach(i=>{n[i]!==void 0&&(r[i]=n[i])}),t.setGraph(Object.assign({},Uf,Io(n,Ds),r)),e.nodes().forEach(i=>{const a=no(e.node(i)),o=Object.assign(Object.assign({},Nl),a),s=Io(o,Bf);t.setNode(i,s),t.setParent(i,e.parent(i))}),e.edges().forEach(i=>{const a=no(e.edge(i)),o={};tu==null||tu.forEach(s=>{a[s]!==void 0&&(o[s]=a[s])}),t.setEdgeObj(i,Object.assign({},Fd,Io(a,kd),o))}),t},Xu=e=>{const t=e.graph();t.ranksep||(t.ranksep=0),t.ranksep/=2,e.nodes().forEach(n=>{const r=e.node(n);isNaN(r.layer)||r.layer||(r.layer=0)}),e.edges().forEach(n=>{var r;const i=e.edge(n);i.minlen*=2,((r=i.labelpos)===null||r===void 0?void 0:r.toLowerCase())!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?i.width+=i.labeloffset:i.height+=i.labeloffset)})},zf=e=>{e.edges().forEach(t=>{const n=e.edge(t);if(n.width&&n.height){const r=e.node(t.v),i=e.node(t.w),a={e:t,rank:(i.rank-r.rank)/2+r.rank};dr(e,"edge-proxy",a,"_ep")}})},Dl=e=>{let t=0;e.nodes().forEach(n=>{var r,i;const a=e.node(n);a.borderTop&&(a.minRank=(r=e.node(a.borderTop))===null||r===void 0?void 0:r.rank,a.maxRank=(i=e.node(a.borderBottom))===null||i===void 0?void 0:i.rank,t=Math.max(t,a.maxRank||-Infinity))}),e.graph().maxRank=t},Gc=e=>{e.nodes().forEach(t=>{const n=e.node(t);n.dummy==="edge-proxy"&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})},$u=e=>{let t,n=0,r,i=0;const a=e.graph(),o=a.marginx||0,s=a.marginy||0,c=f=>{if(!f)return;const d=f.x,h=f.y,v=f.width,m=f.height;!isNaN(d)&&!isNaN(v)&&(t===void 0&&(t=d-v/2),t=Math.min(t,d-v/2),n=Math.max(n,d+v/2)),!isNaN(h)&&!isNaN(m)&&(r===void 0&&(r=h-m/2),r=Math.min(r,h-m/2),i=Math.max(i,h+m/2))};e.nodes().forEach(f=>{c(e.node(f))}),e.edges().forEach(f=>{const d=e.edge(f);(d==null?void 0:d.hasOwnProperty("x"))&&c(d)}),t-=o,r-=s,e.nodes().forEach(f=>{const d=e.node(f);d&&(d.x-=t,d.y-=r)}),e.edges().forEach(f=>{var d;const h=e.edge(f);(d=h.points)===null||d===void 0||d.forEach(v=>{v.x-=t,v.y-=r}),h.hasOwnProperty("x")&&(h.x-=t),h.hasOwnProperty("y")&&(h.y-=r)}),a.width=n-t+o,a.height=i-r+s},Wf=e=>{e.edges().forEach(t=>{const n=e.edge(t),r=e.node(t.v),i=e.node(t.w);let a,o;n.points?(a=n.points[0],o=n.points[n.points.length-1]):(n.points=[],a=i,o=r),n.points.unshift(Sc(r,a)),n.points.push(Sc(i,o))})},ts=e=>{e.edges().forEach(t=>{const n=e.edge(t);if(n==null?void 0:n.hasOwnProperty("x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})},nu=e=>{e.edges().forEach(t=>{var n;const r=e.edge(t);r.reversed&&((n=r.points)===null||n===void 0||n.reverse())})},Ps=e=>{e.nodes().forEach(t=>{var n,r,i;if((n=e.children(t))===null||n===void 0?void 0:n.length){const a=e.node(t),o=e.node(a.borderTop),s=e.node(a.borderBottom),c=e.node(a.borderLeft[((r=a.borderLeft)===null||r===void 0?void 0:r.length)-1]),f=e.node(a.borderRight[((i=a.borderRight)===null||i===void 0?void 0:i.length)-1]);a.width=Math.abs((f==null?void 0:f.x)-(c==null?void 0:c.x))||10,a.height=Math.abs((s==null?void 0:s.y)-(o==null?void 0:o.y))||10,a.x=((c==null?void 0:c.x)||0)+a.width/2,a.y=((o==null?void 0:o.y)||0)+a.height/2}}),e.nodes().forEach(t=>{var n;((n=e.node(t))===null||n===void 0?void 0:n.dummy)==="border"&&e.removeNode(t)})},kc=e=>{e.edges().forEach(t=>{if(t.v===t.w){const n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdgeObj(t)}})},Fc=e=>{const t=Lu(e);t==null||t.forEach(n=>{let r=0;n==null||n.forEach((i,a)=>{var o;const s=e.node(i);s.order=a+r,(o=s.selfEdges)===null||o===void 0||o.forEach(c=>{dr(e,"selfedge",{width:c.label.width,height:c.label.height,rank:s.rank,order:a+ ++r,e:c.e,label:c.label},"_se")}),delete s.selfEdges})})},ru=e=>{e.nodes().forEach(t=>{const n=e.node(t);if(n.dummy==="selfedge"){const r=e.node(n.e.v),i=r.x+r.width/2,a=r.y,o=n.x-i,s=r.height/2;e.setEdgeObj(n.e,n.label),e.removeNode(t),n.label.points=[{x:i+2*o/3,y:a-s},{x:i+5*o/6,y:a-s},{y:a,x:i+o},{x:i+5*o/6,y:a+s},{x:i+2*o/3,y:a+s}],n.label.x=n.x,n.label.y=n.y}})},Io=(e,t)=>{const n={};return t==null||t.forEach(r=>{e[r]!==void 0&&(n[r]=+e[r])}),n},no=(e={})=>{const t={};return Object.keys(e).forEach(n=>{t[n.toLowerCase()]=e[n]}),t};var Vf=Ml,Yu={layout:Vf,util:{time:xf,notime:ku}};class Os extends jt{constructor(t){super();this.rankdir="TB",this.nodesep=50,this.ranksep=50,this.controlPoints=!1,this.sortByCombo=!1,this.edgeLabelSpace=!0,this.radial=!1,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.layoutNode=n=>{const r=this,{nodes:i}=r,a=i.find(o=>o.id===n);return a?a.layout!==!1:!0},this.updateCfg(t)}getDefaultCfg(){return{rankdir:"TB",align:void 0,nodeSize:void 0,nodesepFunc:void 0,ranksepFunc:void 0,nodesep:50,ranksep:50,controlPoints:!1,radial:!1,focusNode:null}}execute(){var t,n;const r=this,{nodes:i,nodeSize:a,rankdir:o,combos:s,begin:c,radial:f}=r;if(!i)return;const d=r.edges||[],h=new Vt({multigraph:!0,compound:!0});let v;a?H(a)?v=()=>a:v=()=>[a,a]:v=C=>C.size?H(C.size)?C.size:me(C.size)?[C.size.width||40,C.size.height||40]:[C.size,C.size]:[40,40];const m=en(r.ranksep,50,r.ranksepFunc),g=en(r.nodesep,50,r.nodesepFunc);let _=g,y=m;(o==="LR"||o==="RL")&&(_=m,y=g),h.setDefaultEdgeLabel(()=>({})),h.setGraph(r);const E={};this.sortByCombo&&s&&s.forEach(C=>{!C.parentId||(E[C.parentId]||(E[C.parentId]=!0,h.setNode(C.parentId,{})),h.setParent(C.id,C.parentId))}),i.filter(C=>C.layout!==!1).forEach(C=>{const R=v(C),W=y(C),te=_(C),Q=R[0]+2*te,re=R[1]+2*W,de=C.layer;Z(de)?h.setNode(C.id,{width:Q,height:re,layer:de}):h.setNode(C.id,{width:Q,height:re}),this.sortByCombo&&C.comboId&&(E[C.comboId]||(E[C.comboId]=!0,h.setNode(C.comboId,{})),h.setParent(C.id,C.comboId))}),d.forEach(C=>{const R=ke(C,"source"),W=ke(C,"target");this.layoutNode(R)&&this.layoutNode(W)&&h.setEdge(R,W,{weight:C.weight||1})});let b;((t=r.preset)===null||t===void 0?void 0:t.nodes)&&(b=new Vt({multigraph:!0,compound:!0}),r.preset.nodes.forEach(C=>{b==null||b.setNode(C.id,C)})),Yu.layout(h,{prevGraph:b,edgeLabelSpace:r.edgeLabelSpace,keepNodeOrder:Boolean(!!r.nodeOrder),nodeOrder:r.nodeOrder});const A=[0,0];if(c){let C=Infinity,R=Infinity;h.nodes().forEach(W=>{const te=h.node(W);C>te.x&&(C=te.x),R>te.y&&(R=te.y)}),h.edges().forEach(W=>{var te;(te=h.edge(W).points)===null||te===void 0||te.forEach(re=>{C>re.x&&(C=re.x),R>re.y&&(R=re.y)})}),A[0]=c[0]-C,A[1]=c[1]-R}if(f){const{focusNode:C,ranksep:R,getRadialPos:W}=this,te=x(C)?C:C==null?void 0:C.id,Q=te?(n=h.node(te))===null||n===void 0?void 0:n._rank:0,re=[],de=o==="LR"||o==="RL",Ce=de?"y":"x",ie=de?"height":"width";let Ge=Infinity,We=-Infinity;h.nodes().forEach(Sn=>{const In=h.node(Sn),Ot=i.findIndex(wn=>wn.id===Sn);if(!i[Ot])return;const Dn=g(i[Ot]);if(Q===0)re[In._rank]||(re[In._rank]={nodes:[],totalWidth:0,maxSize:-Infinity}),re[In._rank].nodes.push(Sn),re[In._rank].totalWidth+=Dn*2+In[ie],re[In._rank].maxSize<Math.max(In.width,In.height)&&(re[In._rank].maxSize=Math.max(In.width,In.height));else{const wn=In._rank-Q;if(wn===0)re[wn]||(re[wn]={nodes:[],totalWidth:0,maxSize:-Infinity}),re[wn].nodes.push(Sn),re[wn].totalWidth+=Dn*2+In[ie],re[wn].maxSize<Math.max(In.width,In.height)&&(re[wn].maxSize=Math.max(In.width,In.height));else{const rn=Math.abs(wn);re[rn]||(re[rn]={left:[],right:[],totalWidth:0,maxSize:-Infinity}),re[rn].totalWidth+=Dn*2+In[ie],re[rn].maxSize<Math.max(In.width,In.height)&&(re[rn].maxSize=Math.max(In.width,In.height)),wn<0?re[rn].left.push(Sn):re[rn].right.push(Sn)}}const gr=In[Ce]-In[ie]/2-Dn,Xn=In[Ce]+In[ie]/2+Dn;gr<Ge&&(Ge=gr),Xn>We&&(We=Xn)});let It=R||50;const gn={},pn=(We-Ge)/.9,bn=[(Ge+We-pn)*.5,(Ge+We+pn)*.5],vr=(Sn,In,Ot=-Infinity,Dn=[0,1])=>{let gr=Ot;return Sn.forEach(Xn=>{const wn=h.node(Xn);gn[Xn]=In;const{x:rn,y:Er}=W(wn[Ce],bn,pn,In,Dn),ei=i.findIndex(lo=>lo.id===Xn);if(!i[ei])return;i[ei].x=rn+A[0],i[ei].y=Er+A[1],i[ei]._order=wn._order;const Tr=m(i[ei]);gr<Tr&&(gr=Tr)}),gr};let Oi=!0;const Hr=0;re.forEach(Sn=>{var In,Ot,Dn,gr,Xn,wn,rn;if(!((In=Sn==null?void 0:Sn.nodes)===null||In===void 0?void 0:In.length)&&!((Ot=Sn==null?void 0:Sn.left)===null||Ot===void 0?void 0:Ot.length)&&!((Dn=Sn==null?void 0:Sn.right)===null||Dn===void 0?void 0:Dn.length))return;if(Oi&&Sn.nodes.length===1){const ei=i.findIndex(Tr=>Tr.id===Sn.nodes[0]);i[ei].x=A[0],i[ei].y=A[1],gn[Sn.nodes[0]]=0,It=m(i[ei]),Oi=!1;return}It=Math.max(It,Sn.totalWidth/(2*Math.PI));let Er=-Infinity;if(Q===0||((gr=Sn.nodes)===null||gr===void 0?void 0:gr.length))Er=vr(Sn.nodes,It,Er,[0,1]);else{const ei=((Xn=Sn.left)===null||Xn===void 0?void 0:Xn.length)/(((wn=Sn.left)===null||wn===void 0?void 0:wn.length)+((rn=Sn.right)===null||rn===void 0?void 0:rn.length));Er=vr(Sn.left,It,Er,[0,ei]),Er=vr(Sn.right,It,Er,[ei+.05,1])}It+=Er,Oi=!1,Hr-Sn.maxSize}),h.edges().forEach(Sn=>{var In,Ot,Dn;const gr=h.edge(Sn),Xn=d.findIndex(wn=>{const rn=ke(wn,"source"),Er=ke(wn,"target");return rn===Sn.v&&Er===Sn.w});if(r.edgeLabelSpace&&r.controlPoints&&d[Xn].type!=="loop"){const wn=Ce==="x"?"y":"x",rn=(In=gr==null?void 0:gr.points)===null||In===void 0?void 0:In.slice(1,gr.points.length-1),Er=[],ei=(Ot=h.node(Sn.v))===null||Ot===void 0?void 0:Ot[wn],Tr=ei-((Dn=h.node(Sn.w))===null||Dn===void 0?void 0:Dn[wn]),lo=gn[Sn.v],Eu=lo-gn[Sn.w];rn==null||rn.forEach(af=>{const of=(af[wn]-ei)/Tr*Eu+lo,sf=W(af[Ce],bn,pn,of);Er.push({x:sf.x+A[0],y:sf.y+A[1]})}),d[Xn].controlPoints=Er}})}else h.nodes().forEach(C=>{const R=h.node(C),W=i.findIndex(te=>te.id===C);!i[W]||(i[W].x=R.x+A[0],i[W].y=R.y+A[1],i[W]._order=R._order)}),h.edges().forEach(C=>{var R;const W=h.edge(C),te=d.findIndex(Q=>{const re=ke(Q,"source"),de=ke(Q,"target");return re===C.v&&de===C.w});r.edgeLabelSpace&&r.controlPoints&&d[te].type!=="loop"&&(d[te].controlPoints=(R=W==null?void 0:W.points)===null||R===void 0?void 0:R.slice(1,W.points.length-1),d[te].controlPoints.forEach(Q=>{Q.x+=A[0],Q.y+=A[1]}))});return r.onLayoutEnd&&r.onLayoutEnd(),{nodes:i,edges:d}}getRadialPos(t,n,r,i,a=[0,1]){let o=(t-n[0])/r;o=o*(a[1]-a[0])+a[0];const s=o*2*Math.PI;return{x:Math.cos(s)*i,y:Math.sin(s)*i}}getType(){return"dagre"}}const iu={graph:{meta:{rankDir:"TB",nodeSep:50,rankSep:50,edgeSep:5,align:void 0}},subScene:{meta:{paddingTop:20,paddingBottom:20,paddingLeft:20,paddingRight:20,labelHeight:20}},nodeSize:{meta:{width:100,maxLabelWidth:0,height:20},node:{width:80,height:20,labelOffset:10,maxLabelWidth:40},bridge:{width:5,height:5,radius:2,labelOffset:0}}};function au(e={},t=iu){var n,r,i,a;const o=JSON.parse(JSON.stringify(t)),s=((n=e==null?void 0:e.graph)===null||n===void 0?void 0:n.meta)||{},c=((r=e==null?void 0:e.subScene)===null||r===void 0?void 0:r.meta)||{},f=((i=e==null?void 0:e.nodeSize)===null||i===void 0?void 0:i.meta)||{},d=((a=e==null?void 0:e.nodeSize)===null||a===void 0?void 0:a.node)||{},h=o.nodeSize.bridge;return{graph:{meta:Object.assign(o.graph.meta,s)},subScene:{meta:Object.assign(o.subScene.meta,c)},nodeSize:{meta:Object.assign(o.nodeSize.meta,f),node:Object.assign(o.nodeSize.node,d),bridge:h}}}function Co(e){return`\u25EC${e}\u25EC`}const ro=Co("ROOT"),Bd=Co("BRIDGE_GRAPH");var ra,ou,su,Uc;(function(e){e[e.META=0]="META",e[e.NODE=1]="NODE",e[e.BRIDGE=2]="BRIDGE"})(ra||(ra={})),function(e){e[e.INCLUDE=0]="INCLUDE",e[e.EXCLUDE=1]="EXCLUDE",e[e.UNSPECIFIED=2]="UNSPECIFIED"}(ou||(ou={})),function(e){e[e.META=0]="META",e[e.CORE=1]="CORE",e[e.BRIDGE=2]="BRIDGE"}(su||(su={})),function(e){e[e.META=0]="META",e[e.OP=1]="OP",e[e.SERIES=2]="SERIES"}(Uc||(Uc={}));var Ku=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof S.g!="undefined"?S.g:typeof self!="undefined"?self:{};function ns(e,t){return e(t={exports:{}},t.exports),t.exports}var Pl=function(){this.__data__=[],this.size=0},qu=function(e,t){return e===t||e!=e&&t!=t},Ju=function(e,t){for(var n=e.length;n--;)if(qu(e[n][0],t))return n;return-1},Qn=Array.prototype.splice,ev=function(e){var t=this.__data__,n=Ju(t,e);return!(n<0)&&(n==t.length-1?t.pop():Qn.call(t,n,1),--this.size,!0)},tv=function(e){var t=this.__data__,n=Ju(t,e);return n<0?void 0:t[n][1]},Bc=function(e){return Ju(this.__data__,e)>-1},zd=function(e,t){var n=this.__data__,r=Ju(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function Qu(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Qu.prototype.clear=Pl,Qu.prototype.delete=ev,Qu.prototype.get=tv,Qu.prototype.has=Bc,Qu.prototype.set=zd;var Zf=Qu,Wa=function(){this.__data__=new Zf,this.size=0},nv=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},jf=function(e){return this.__data__.get(e)},Ol=function(e){return this.__data__.has(e)},zc=typeof Ku=="object"&&Ku&&Ku.Object===Object&&Ku,Wc=typeof self=="object"&&self&&self.Object===Object&&self,Ur=zc||Wc||Function("return this")(),mi=Ur.Symbol,ec=Object.prototype,Vc=ec.hasOwnProperty,uu=ec.toString,rs=mi?mi.toStringTag:void 0,Zc=function(e){var t=Vc.call(e,rs),n=e[rs];try{e[rs]=void 0;var r=!0}catch(a){}var i=uu.call(e);return r&&(t?e[rs]=n:delete e[rs]),i},jc=Object.prototype.toString,tc=function(e){return jc.call(e)},cu=mi?mi.toStringTag:void 0,Fi=function(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":cu&&cu in Object(e)?Zc(e):tc(e)},Zi=function(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")},Ia,Ro=function(e){if(!Zi(e))return!1;var t=Fi(e);return t=="[object Function]"||t=="[object GeneratorFunction]"||t=="[object AsyncFunction]"||t=="[object Proxy]"},Ls=Ur["__core-js_shared__"],Hc=(Ia=/[^.]+$/.exec(Ls&&Ls.keys&&Ls.keys.IE_PROTO||""))?"Symbol(src)_1."+Ia:"",Xc=function(e){return!!Hc&&Hc in e},fu=Function.prototype.toString,Gs=function(e){if(e!=null){try{return fu.call(e)}catch(t){}try{return e+""}catch(t){}}return""},Hf=/^\[object .+?Constructor\]$/,Wd=Function.prototype,rv=Object.prototype,Vd=Wd.toString,is=rv.hasOwnProperty,la=RegExp("^"+Vd.call(is).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),io=function(e){return!(!Zi(e)||Xc(e))&&(Ro(e)?la:Hf).test(Gs(e))},Zd=function(e,t){return e==null?void 0:e[t]},lu=function(e,t){var n=Zd(e,t);return io(n)?n:void 0},as=lu(Ur,"Map"),Mo=lu(Object,"create"),ao=function(){this.__data__=Mo?Mo(null):{},this.size=0},Ll=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},nc=Object.prototype.hasOwnProperty,os=function(e){var t=this.__data__;if(Mo){var n=t[e];return n==="__lodash_hash_undefined__"?void 0:n}return nc.call(t,e)?t[e]:void 0},du=Object.prototype.hasOwnProperty,hu=function(e){var t=this.__data__;return Mo?t[e]!==void 0:du.call(t,e)},Xf=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Mo&&t===void 0?"__lodash_hash_undefined__":t,this};function ks(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ks.prototype.clear=ao,ks.prototype.delete=Ll,ks.prototype.get=os,ks.prototype.has=hu,ks.prototype.set=Xf;var ea=ks,oo=function(){this.size=0,this.__data__={hash:new ea,map:new(as||Zf),string:new ea}},ii=function(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null},Di=function(e,t){var n=e.__data__;return ii(t)?n[typeof t=="string"?"string":"hash"]:n.map},$f=function(e){var t=Di(this,e).delete(e);return this.size-=t?1:0,t},Yf=function(e){return Di(this,e).get(e)},iv=function(e){return Di(this,e).has(e)},jd=function(e,t){var n=Di(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function ss(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ss.prototype.clear=oo,ss.prototype.delete=$f,ss.prototype.get=Yf,ss.prototype.has=iv,ss.prototype.set=jd;var rc=ss,Gl=function(e,t){var n=this.__data__;if(n instanceof Zf){var r=n.__data__;if(!as||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new rc(r)}return n.set(e,t),this.size=n.size,this};function ic(e){var t=this.__data__=new Zf(e);this.size=t.size}ic.prototype.clear=Wa,ic.prototype.delete=nv,ic.prototype.get=jf,ic.prototype.has=Ol,ic.prototype.set=Gl;var vu=ic,so=function(e,t){for(var n=-1,r=e==null?0:e.length;++n<r&&t(e[n],n,e)!==!1;);return e},$c=function(){try{var e=lu(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),ac=function(e,t,n){t=="__proto__"&&$c?$c(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},Hd=Object.prototype.hasOwnProperty,oc=function(e,t,n){var r=e[t];Hd.call(e,t)&&qu(r,n)&&(n!==void 0||t in e)||ac(e,t,n)},Yc=function(e,t,n,r){var i=!n;n||(n={});for(var a=-1,o=t.length;++a<o;){var s=t[a],c=r?r(n[s],e[s],s,n,e):void 0;c===void 0&&(c=e[s]),i?ac(n,s,c):oc(n,s,c)}return n},av=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},Pi=function(e){return e!=null&&typeof e=="object"},Kf=function(e){return Pi(e)&&Fi(e)=="[object Arguments]"},T=Object.prototype,O=T.hasOwnProperty,X=T.propertyIsEnumerable,ye=Kf(function(){return arguments}())?Kf:function(e){return Pi(e)&&O.call(e,"callee")&&!X.call(e,"callee")},se=Array.isArray,Ee=function(){return!1},Te=ns(function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n?Ur.Buffer:void 0,a=(i?i.isBuffer:void 0)||Ee;e.exports=a}),$e=/^(?:0|[1-9]\d*)$/,Qe=function(e,t){var n=typeof e;return!!(t=t??9007199254740991)&&(n=="number"||n!="symbol"&&$e.test(e))&&e>-1&&e%1==0&&e<t},it=function(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=9007199254740991},Le={};Le["[object Float32Array]"]=Le["[object Float64Array]"]=Le["[object Int8Array]"]=Le["[object Int16Array]"]=Le["[object Int32Array]"]=Le["[object Uint8Array]"]=Le["[object Uint8ClampedArray]"]=Le["[object Uint16Array]"]=Le["[object Uint32Array]"]=!0,Le["[object Arguments]"]=Le["[object Array]"]=Le["[object ArrayBuffer]"]=Le["[object Boolean]"]=Le["[object DataView]"]=Le["[object Date]"]=Le["[object Error]"]=Le["[object Function]"]=Le["[object Map]"]=Le["[object Number]"]=Le["[object Object]"]=Le["[object RegExp]"]=Le["[object Set]"]=Le["[object String]"]=Le["[object WeakMap]"]=!1;var qe=function(e){return Pi(e)&&it(e.length)&&!!Le[Fi(e)]},Et=function(e){return function(t){return e(t)}},Ke=ns(function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n&&zc.process,a=function(){try{var o=r&&r.require&&r.require("util").types;return o||i&&i.binding&&i.binding("util")}catch(s){}}();e.exports=a}),mt=Ke&&Ke.isTypedArray,fe=mt?Et(mt):qe,Ie=Object.prototype.hasOwnProperty,ot=function(e,t){var n=se(e),r=!n&&ye(e),i=!n&&!r&&Te(e),a=!n&&!r&&!i&&fe(e),o=n||r||i||a,s=o?av(e.length,String):[],c=s.length;for(var f in e)!t&&!Ie.call(e,f)||o&&(f=="length"||i&&(f=="offset"||f=="parent")||a&&(f=="buffer"||f=="byteLength"||f=="byteOffset")||Qe(f,c))||s.push(f);return s},Ct=Object.prototype,Ve=function(e){var t=e&&e.constructor;return e===(typeof t=="function"&&t.prototype||Ct)},Tt=function(e,t){return function(n){return e(t(n))}},Fe=Tt(Object.keys,Object),gt=Object.prototype.hasOwnProperty,He=function(e){if(!Ve(e))return Fe(e);var t=[];for(var n in Object(e))gt.call(e,n)&&n!="constructor"&&t.push(n);return t},ut=function(e){return e!=null&&it(e.length)&&!Ro(e)},Ht=function(e){return ut(e)?ot(e):He(e)},hn=function(e,t){return e&&Yc(t,Ht(t),e)},yt=function(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t},lt=Object.prototype.hasOwnProperty,Ze=function(e){if(!Zi(e))return yt(e);var t=Ve(e),n=[];for(var r in e)(r!="constructor"||!t&&lt.call(e,r))&&n.push(r);return n},Qt=function(e){return ut(e)?ot(e,!0):Ze(e)},Tn=function(e,t){return e&&Yc(t,Qt(t),e)},Ut=ns(function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n?Ur.Buffer:void 0,a=i?i.allocUnsafe:void 0;e.exports=function(o,s){if(s)return o.slice();var c=o.length,f=a?a(c):new o.constructor(c);return o.copy(f),f}}),Fn=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t},fn=function(e,t){for(var n=-1,r=e==null?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o)}return a},An=function(){return[]},ar=Object.prototype.propertyIsEnumerable,Vr=Object.getOwnPropertySymbols,ai=Vr?function(e){return e==null?[]:(e=Object(e),fn(Vr(e),function(t){return ar.call(e,t)}))}:An,On=function(e,t){return Yc(e,ai(e),t)},Zr=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e},xr=Tt(Object.getPrototypeOf,Object),qr=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Zr(t,ai(e)),e=xr(e);return t}:An,Jr=function(e,t){return Yc(e,qr(e),t)},oi=function(e,t,n){var r=t(e);return se(e)?r:Zr(r,n(e))},Ir=function(e){return oi(e,Ht,ai)},Qr=function(e){return oi(e,Qt,qr)},jr=lu(Ur,"DataView"),_n=lu(Ur,"Promise"),si=lu(Ur,"Set"),or=lu(Ur,"WeakMap"),tn=Gs(jr),Vn=Gs(as),er=Gs(_n),ui=Gs(si),No=Gs(or),Ca=Fi;(jr&&Ca(new jr(new ArrayBuffer(1)))!="[object DataView]"||as&&Ca(new as)!="[object Map]"||_n&&Ca(_n.resolve())!="[object Promise]"||si&&Ca(new si)!="[object Set]"||or&&Ca(new or)!="[object WeakMap]")&&(Ca=function(e){var t=Fi(e),n=t=="[object Object]"?e.constructor:void 0,r=n?Gs(n):"";if(r)switch(r){case tn:return"[object DataView]";case Vn:return"[object Map]";case er:return"[object Promise]";case ui:return"[object Set]";case No:return"[object WeakMap]"}return t});var z=Ca,Se=Object.prototype.hasOwnProperty,_e=function(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&Se.call(e,"index")&&(n.index=e.index,n.input=e.input),n},Pt=Ur.Uint8Array,Nn=function(e){var t=new e.constructor(e.byteLength);return new Pt(t).set(new Pt(e)),t},U=function(e,t){var n=t?Nn(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},D=/\w*$/,Y=function(e){var t=new e.constructor(e.source,D.exec(e));return t.lastIndex=e.lastIndex,t},ce=mi?mi.prototype:void 0,le=ce?ce.valueOf:void 0,ne=function(e){return le?Object(le.call(e)):{}},K=function(e,t){var n=t?Nn(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)},oe=function(e,t,n){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return Nn(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return U(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return K(e,n);case"[object Map]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return Y(e);case"[object Set]":return new r;case"[object Symbol]":return ne(e)}},B=Object.create,$=function(){function e(){}return function(t){if(!Zi(t))return{};if(B)return B(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),G=function(e){return typeof e.constructor!="function"||Ve(e)?{}:$(xr(e))},ae=function(e){return Pi(e)&&z(e)=="[object Map]"},pe=Ke&&Ke.isMap,Oe=pe?Et(pe):ae,Be=function(e){return Pi(e)&&z(e)=="[object Set]"},Me=Ke&&Ke.isSet,st=Me?Et(Me):Be,At={};At["[object Arguments]"]=At["[object Array]"]=At["[object ArrayBuffer]"]=At["[object DataView]"]=At["[object Boolean]"]=At["[object Date]"]=At["[object Float32Array]"]=At["[object Float64Array]"]=At["[object Int8Array]"]=At["[object Int16Array]"]=At["[object Int32Array]"]=At["[object Map]"]=At["[object Number]"]=At["[object Object]"]=At["[object RegExp]"]=At["[object Set]"]=At["[object String]"]=At["[object Symbol]"]=At["[object Uint8Array]"]=At["[object Uint8ClampedArray]"]=At["[object Uint16Array]"]=At["[object Uint32Array]"]=!0,At["[object Error]"]=At["[object Function]"]=At["[object WeakMap]"]=!1;var xn=function e(t,n,r,i,a,o){var s,c=1&n,f=2&n,d=4&n;if(r&&(s=a?r(t,i,a,o):r(t)),s!==void 0)return s;if(!Zi(t))return t;var h=se(t);if(h){if(s=_e(t),!c)return Fn(t,s)}else{var v=z(t),m=v=="[object Function]"||v=="[object GeneratorFunction]";if(Te(t))return Ut(t,c);if(v=="[object Object]"||v=="[object Arguments]"||m&&!a){if(s=f||m?{}:G(t),!c)return f?Jr(t,Tn(s,t)):On(t,hn(s,t))}else{if(!At[v])return a?t:{};s=oe(t,v,c)}}o||(o=new vu);var g=o.get(t);if(g)return g;o.set(t,s),st(t)?t.forEach(function(y){s.add(e(y,n,r,y,t,o))}):Oe(t)&&t.forEach(function(y,E){s.set(E,e(y,n,r,E,t,o))});var _=h?void 0:(d?f?Qr:Ir:f?Qt:Ht)(t);return so(_||t,function(y,E){_&&(y=t[E=y]),oc(s,E,e(y,n,r,E,t,o))}),s},Bt=function(e){return xn(e,4)},Jt=function(e){return function(){return e}},vn=function(e){return function(t,n,r){for(var i=-1,a=Object(t),o=r(t),s=o.length;s--;){var c=o[e?s:++i];if(n(a[c],c,a)===!1)break}return t}}(),tr=function(e,t){return e&&vn(e,t,Ht)},kr=function(e,t){return function(n,r){if(n==null)return n;if(!ut(n))return e(n,r);for(var i=n.length,a=t?i:-1,o=Object(n);(t?a--:++a<i)&&r(o[a],a,o)!==!1;);return n}}(tr),wi=function(e){return e},qf=function(e){return typeof e=="function"?e:wi},Ra=function(e,t){return(se(e)?so:kr)(e,qf(t))},kl=Ra,uo=function(e,t){var n=[];return kr(e,function(r,i,a){t(r,i,a)&&n.push(r)}),n},Xd=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},hm=function(e){return this.__data__.has(e)};function $d(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new rc;++t<n;)this.add(e[t])}$d.prototype.add=$d.prototype.push=Xd,$d.prototype.has=hm;var up=$d,vm=function(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1},cp=function(e,t){return e.has(t)},fp=function(e,t,n,r,i,a){var o=1&n,s=e.length,c=t.length;if(s!=c&&!(o&&c>s))return!1;var f=a.get(e),d=a.get(t);if(f&&d)return f==t&&d==e;var h=-1,v=!0,m=2&n?new up:void 0;for(a.set(e,t),a.set(t,e);++h<s;){var g=e[h],_=t[h];if(r)var y=o?r(_,g,h,t,e,a):r(g,_,h,e,t,a);if(y!==void 0){if(y)continue;v=!1;break}if(m){if(!vm(t,function(E,b){if(!cp(m,b)&&(g===E||i(g,E,n,r,a)))return m.push(b)})){v=!1;break}}else if(g!==_&&!i(g,_,n,r,a)){v=!1;break}}return a.delete(e),a.delete(t),v},pm=function(e){var t=-1,n=Array(e.size);return e.forEach(function(r,i){n[++t]=[i,r]}),n},ov=function(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n},lp=mi?mi.prototype:void 0,sv=lp?lp.valueOf:void 0,mm=function(e,t,n,r,i,a,o){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!a(new Pt(e),new Pt(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return qu(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=pm;case"[object Set]":var c=1&r;if(s||(s=ov),e.size!=t.size&&!c)return!1;var f=o.get(e);if(f)return f==t;r|=2,o.set(e,t);var d=fp(s(e),s(t),r,i,a,o);return o.delete(e),d;case"[object Symbol]":if(sv)return sv.call(e)==sv.call(t)}return!1},uv=Object.prototype.hasOwnProperty,dp=function(e,t,n,r,i,a){var o=1&n,s=Ir(e),c=s.length;if(c!=Ir(t).length&&!o)return!1;for(var f=c;f--;){var d=s[f];if(!(o?d in t:uv.call(t,d)))return!1}var h=a.get(e),v=a.get(t);if(h&&v)return h==t&&v==e;var m=!0;a.set(e,t),a.set(t,e);for(var g=o;++f<c;){var _=e[d=s[f]],y=t[d];if(r)var E=o?r(y,_,d,t,e,a):r(_,y,d,e,t,a);if(!(E===void 0?_===y||i(_,y,n,r,a):E)){m=!1;break}g||(g=d=="constructor")}if(m&&!g){var b=e.constructor,A=t.constructor;b==A||!("constructor"in e)||!("constructor"in t)||typeof b=="function"&&b instanceof b&&typeof A=="function"&&A instanceof A||(m=!1)}return a.delete(e),a.delete(t),m},hp=Object.prototype.hasOwnProperty,gm=function(e,t,n,r,i,a){var o=se(e),s=se(t),c=o?"[object Array]":z(e),f=s?"[object Array]":z(t),d=(c=c=="[object Arguments]"?"[object Object]":c)=="[object Object]",h=(f=f=="[object Arguments]"?"[object Object]":f)=="[object Object]",v=c==f;if(v&&Te(e)){if(!Te(t))return!1;o=!0,d=!1}if(v&&!d)return a||(a=new vu),o||fe(e)?fp(e,t,n,r,i,a):mm(e,t,c,n,r,i,a);if(!(1&n)){var m=d&&hp.call(e,"__wrapped__"),g=h&&hp.call(t,"__wrapped__");if(m||g){var _=m?e.value():e,y=g?t.value():t;return a||(a=new vu),i(_,y,n,r,a)}}return!!v&&(a||(a=new vu),dp(e,t,n,r,i,a))},vp=function e(t,n,r,i,a){return t===n||(t==null||n==null||!Pi(t)&&!Pi(n)?t!=t&&n!=n:gm(t,n,r,i,e,a))},ym=function(e,t,n,r){var i=n.length,a=i,o=!r;if(e==null)return!a;for(e=Object(e);i--;){var s=n[i];if(o&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<a;){var c=(s=n[i])[0],f=e[c],d=s[1];if(o&&s[2]){if(f===void 0&&!(c in e))return!1}else{var h=new vu;if(r)var v=r(f,d,c,e,t,h);if(!(v===void 0?vp(d,f,3,r,h):v))return!1}}return!0},pp=function(e){return e==e&&!Zi(e)},_m=function(e){for(var t=Ht(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,pp(i)]}return t},mp=function(e,t){return function(n){return n!=null&&n[e]===t&&(t!==void 0||e in Object(n))}},Em=function(e){var t=_m(e);return t.length==1&&t[0][2]?mp(t[0][0],t[0][1]):function(n){return n===e||ym(n,e,t)}},sc=function(e){return typeof e=="symbol"||Pi(e)&&Fi(e)=="[object Symbol]"},bm=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Yd=/^\w*$/,cv=function(e,t){if(se(e))return!1;var n=typeof e;return!(n!="number"&&n!="symbol"&&n!="boolean"&&e!=null&&!sc(e))||Yd.test(e)||!bm.test(e)||t!=null&&e in Object(t)};function fv(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=e.apply(this,r);return n.cache=a.set(i,o)||a,o};return n.cache=new(fv.Cache||rc),n}fv.Cache=rc;var wm=fv,xm=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Sm=/\\(\\)?/g,Tm=function(e){var t=wm(e,function(r){return n.size===500&&n.clear(),r}),n=t.cache;return t}(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(xm,function(n,r,i,a){t.push(i?a.replace(Sm,"$1"):r||n)}),t}),Jf=function(e,t){for(var n=-1,r=e==null?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i},gp=mi?mi.prototype:void 0,yp=gp?gp.toString:void 0,Am=function e(t){if(typeof t=="string")return t;if(se(t))return Jf(t,e)+"";if(sc(t))return yp?yp.call(t):"";var n=t+"";return n=="0"&&1/t==-Infinity?"-0":n},_p=function(e){return e==null?"":Am(e)},Kd=function(e,t){return se(e)?e:cv(e,t)?[e]:Tm(_p(e))},Fl=function(e){if(typeof e=="string"||sc(e))return e;var t=e+"";return t=="0"&&1/e==-Infinity?"-0":t},qd=function(e,t){for(var n=0,r=(t=Kd(t,e)).length;e!=null&&n<r;)e=e[Fl(t[n++])];return n&&n==r?e:void 0},Im=function(e,t,n){var r=e==null?void 0:qd(e,t);return r===void 0?n:r},Cm=function(e,t){return e!=null&&t in Object(e)},lv=function(e,t,n){for(var r=-1,i=(t=Kd(t,e)).length,a=!1;++r<i;){var o=Fl(t[r]);if(!(a=e!=null&&n(e,o)))break;e=e[o]}return a||++r!=i?a:!!(i=e==null?0:e.length)&&it(i)&&Qe(o,i)&&(se(e)||ye(e))},dv=function(e,t){return e!=null&&lv(e,t,Cm)},Rm=function(e,t){return cv(e)&&pp(t)?mp(Fl(e),t):function(n){var r=Im(n,e);return r===void 0&&r===t?dv(n,e):vp(t,r,3)}},Ep=function(e){return function(t){return t==null?void 0:t[e]}},Mm=function(e){return function(t){return qd(t,e)}},Nm=function(e){return cv(e)?Ep(Fl(e)):Mm(e)},Do=function(e){return typeof e=="function"?e:e==null?wi:typeof e=="object"?se(e)?Rm(e[0],e[1]):Em(e):Nm(e)},bp=function(e,t){return(se(e)?fn:uo)(e,Do(t))},Dm=Object.prototype.hasOwnProperty,Pm=function(e,t){return e!=null&&Dm.call(e,t)},wp=function(e,t){return e!=null&&lv(e,t,Pm)},Om=Object.prototype.hasOwnProperty,Lm=function(e){if(e==null)return!0;if(ut(e)&&(se(e)||typeof e=="string"||typeof e.splice=="function"||Te(e)||fe(e)||ye(e)))return!e.length;var t=z(e);if(t=="[object Map]"||t=="[object Set]")return!e.size;if(Ve(e))return!He(e).length;for(var n in e)if(Om.call(e,n))return!1;return!0},xp=function(e){return e===void 0},Sp=function(e,t){var n=-1,r=ut(e)?Array(e.length):[];return kr(e,function(i,a,o){r[++n]=t(i,a,o)}),r},Tp=function(e,t){return(se(e)?Jf:Sp)(e,Do(t))},Gm=function(e,t,n,r){var i=-1,a=e==null?0:e.length;for(r&&a&&(n=e[++i]);++i<a;)n=t(n,e[i],i,e);return n},km=function(e,t,n,r,i){return i(e,function(a,o,s){n=r?(r=!1,a):t(n,a,o,s)}),n},Ul=function(e,t,n){var r=se(e)?Gm:km,i=arguments.length<3;return r(e,Do(t),n,i,kr)},Fm=function(e){return typeof e=="string"||!se(e)&&Pi(e)&&Fi(e)=="[object String]"},Ap=Ep("length"),Ip=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),hv=function(e){return Ip.test(e)},Cp="[\\ud800-\\udfff]",Jd="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Qd="\\ud83c[\\udffb-\\udfff]",vv="[^\\ud800-\\udfff]",Rp="(?:\\ud83c[\\udde6-\\uddff]){2}",Mp="[\\ud800-\\udbff][\\udc00-\\udfff]",Np="(?:"+Jd+"|"+Qd+")?",eh="[\\ufe0e\\ufe0f]?"+Np+("(?:\\u200d(?:"+[vv,Rp,Mp].join("|")+")[\\ufe0e\\ufe0f]?"+Np+")*"),th="(?:"+[vv+Jd+"?",Jd,Rp,Mp,Cp].join("|")+")",Dp=RegExp(Qd+"(?="+Qd+")|"+th+eh,"g"),Um=function(e){for(var t=Dp.lastIndex=0;Dp.test(e);)++t;return t},pv=function(e){return hv(e)?Um(e):Ap(e)},Pp=function(e){if(e==null)return 0;if(ut(e))return Fm(e)?pv(e):e.length;var t=z(e);return t=="[object Map]"||t=="[object Set]"?e.size:He(e).length},Bm=function(e,t,n){var r=se(e),i=r||Te(e)||fe(e);if(t=Do(t),n==null){var a=e&&e.constructor;n=i?r?new a:[]:Zi(e)&&Ro(a)?$(xr(e)):{}}return(i?so:tr)(e,function(o,s,c){return t(n,o,s,c)}),n},Op=mi?mi.isConcatSpreadable:void 0,zm=function(e){return se(e)||ye(e)||!!(Op&&e&&e[Op])},mv=function e(t,n,r,i,a){var o=-1,s=t.length;for(r||(r=zm),a||(a=[]);++o<s;){var c=t[o];n>0&&r(c)?n>1?e(c,n-1,r,i,a):Zr(a,c):i||(a[a.length]=c)}return a},Wm=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},Lp=Math.max,Gp=function(e,t,n){return t=Lp(t===void 0?e.length-1:t,0),function(){for(var r=arguments,i=-1,a=Lp(r.length-t,0),o=Array(a);++i<a;)o[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(o),Wm(e,this,s)}},Vm=$c?function(e,t){return $c(e,"toString",{configurable:!0,enumerable:!1,value:Jt(t),writable:!0})}:wi,Zm=Date.now,kp=function(e){var t=0,n=0;return function(){var r=Zm(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Vm),nh=function(e,t){return kp(Gp(e,t,wi),e+"")},Fp=function(e,t,n,r){for(var i=e.length,a=n+(r?1:-1);r?a--:++a<i;)if(t(e[a],a,e))return a;return-1},us=function(e){return e!=e},jm=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1},Hm=function(e,t,n){return t==t?jm(e,t,n):Fp(e,us,n)},Kc=function(e,t){return!!(e==null?0:e.length)&&Hm(e,t,0)>-1},qn=function(e,t,n){for(var r=-1,i=e==null?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1},Xm=function(){},Va=si&&1/ov(new si([,-0]))[1]==1/0?function(e){return new si(e)}:Xm,Ui=function(e,t,n){var r=-1,i=Kc,a=e.length,o=!0,s=[],c=s;if(n)o=!1,i=qn;else if(a>=200){var f=t?null:Va(e);if(f)return ov(f);o=!1,i=cp,c=new up}else c=t?[]:s;e:for(;++r<a;){var d=e[r],h=t?t(d):d;if(d=n||d!==0?d:0,o&&h==h){for(var v=c.length;v--;)if(c[v]===h)continue e;t&&c.push(h),s.push(d)}else i(c,h,n)||(c!==s&&c.push(h),s.push(d))}return s},Up=function(e){return Pi(e)&&ut(e)},uc=nh(function(e){return Ui(mv(e,1,Up,!0))}),$m=function(e,t){return Jf(t,function(n){return e[n]})},rh,Bp=function(e){return e==null?[]:$m(e,Ht(e))};try{rh={clone:Bt,constant:Jt,each:kl,filter:bp,has:wp,isArray:se,isEmpty:Lm,isFunction:Ro,isUndefined:xp,keys:Ht,map:Tp,reduce:Ul,size:Pp,transform:Bm,union:uc,values:Bp}}catch(e){}rh||(rh=window._);var Zt=rh,gv=sr;function sr(e){this._isDirected=!Zt.has(e,"directed")||e.directed,this._isMultigraph=!!Zt.has(e,"multigraph")&&e.multigraph,this._isCompound=!!Zt.has(e,"compound")&&e.compound,this._label=void 0,this._defaultNodeLabelFn=Zt.constant(void 0),this._defaultEdgeLabelFn=Zt.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function zp(e,t){e[t]?e[t]++:e[t]=1}function Fs(e,t){--e[t]||delete e[t]}function Qf(e,t,n,r){var i=""+t,a=""+n;if(!e&&i>a){var o=i;i=a,a=o}return i+""+a+""+(Zt.isUndefined(r)?"\0":r)}function ih(e,t,n,r){var i=""+t,a=""+n;if(!e&&i>a){var o=i;i=a,a=o}var s={v:i,w:a};return r&&(s.name=r),s}function ci(e,t){return Qf(e,t.v,t.w,t.name)}sr.prototype._nodeCount=0,sr.prototype._edgeCount=0,sr.prototype.isDirected=function(){return this._isDirected},sr.prototype.isMultigraph=function(){return this._isMultigraph},sr.prototype.isCompound=function(){return this._isCompound},sr.prototype.setGraph=function(e){return this._label=e,this},sr.prototype.graph=function(){return this._label},sr.prototype.setDefaultNodeLabel=function(e){return Zt.isFunction(e)||(e=Zt.constant(e)),this._defaultNodeLabelFn=e,this},sr.prototype.nodeCount=function(){return this._nodeCount},sr.prototype.nodes=function(){return Zt.keys(this._nodes)},sr.prototype.sources=function(){var e=this;return Zt.filter(this.nodes(),function(t){return Zt.isEmpty(e._in[t])})},sr.prototype.sinks=function(){var e=this;return Zt.filter(this.nodes(),function(t){return Zt.isEmpty(e._out[t])})},sr.prototype.setNodes=function(e,t){var n=arguments,r=this;return Zt.each(e,function(i){n.length>1?r.setNode(i,t):r.setNode(i)}),this},sr.prototype.setNode=function(e,t){return Zt.has(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]="\0",this._children[e]={},this._children["\0"][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)},sr.prototype.node=function(e){return this._nodes[e]},sr.prototype.hasNode=function(e){return Zt.has(this._nodes,e)},sr.prototype.removeNode=function(e){var t=this;if(Zt.has(this._nodes,e)){var n=function(r){t.removeEdge(t._edgeObjs[r])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],Zt.each(this.children(e),function(r){t.setParent(r)}),delete this._children[e]),Zt.each(Zt.keys(this._in[e]),n),delete this._in[e],delete this._preds[e],Zt.each(Zt.keys(this._out[e]),n),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},sr.prototype.setParent=function(e,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(Zt.isUndefined(t))t="\0";else{for(var n=t+="";!Zt.isUndefined(n);n=this.parent(n))if(n===e)throw new Error("Setting "+t+" as parent of "+e+" would create a cycle");this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this},sr.prototype._removeFromParentsChildList=function(e){delete this._children[this._parent[e]][e]},sr.prototype.parent=function(e){if(this._isCompound){var t=this._parent[e];if(t!=="\0")return t}},sr.prototype.children=function(e){if(Zt.isUndefined(e)&&(e="\0"),this._isCompound){var t=this._children[e];if(t)return Zt.keys(t)}else{if(e==="\0")return this.nodes();if(this.hasNode(e))return[]}},sr.prototype.predecessors=function(e){var t=this._preds[e];if(t)return Zt.keys(t)},sr.prototype.successors=function(e){var t=this._sucs[e];if(t)return Zt.keys(t)},sr.prototype.neighbors=function(e){var t=this.predecessors(e);if(t)return Zt.union(t,this.successors(e))},sr.prototype.isLeaf=function(e){return(this.isDirected()?this.successors(e):this.neighbors(e)).length===0},sr.prototype.filterNodes=function(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var n=this;Zt.each(this._nodes,function(a,o){e(o)&&t.setNode(o,a)}),Zt.each(this._edgeObjs,function(a){t.hasNode(a.v)&&t.hasNode(a.w)&&t.setEdge(a,n.edge(a))});var r={};function i(a){var o=n.parent(a);return o===void 0||t.hasNode(o)?(r[a]=o,o):o in r?r[o]:i(o)}return this._isCompound&&Zt.each(t.nodes(),function(a){t.setParent(a,i(a))}),t},sr.prototype.setDefaultEdgeLabel=function(e){return Zt.isFunction(e)||(e=Zt.constant(e)),this._defaultEdgeLabelFn=e,this},sr.prototype.edgeCount=function(){return this._edgeCount},sr.prototype.edges=function(){return Zt.values(this._edgeObjs)},sr.prototype.setPath=function(e,t){var n=this,r=arguments;return Zt.reduce(e,function(i,a){return r.length>1?n.setEdge(i,a,t):n.setEdge(i,a),a}),this},sr.prototype.setEdge=function(){var e,t,n,r,i=!1,a=arguments[0];typeof a=="object"&&a!==null&&"v"in a?(e=a.v,t=a.w,n=a.name,arguments.length===2&&(r=arguments[1],i=!0)):(e=a,t=arguments[1],n=arguments[3],arguments.length>2&&(r=arguments[2],i=!0)),e=""+e,t=""+t,Zt.isUndefined(n)||(n=""+n);var o=Qf(this._isDirected,e,t,n);if(Zt.has(this._edgeLabels,o))return i&&(this._edgeLabels[o]=r),this;if(!Zt.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[o]=i?r:this._defaultEdgeLabelFn(e,t,n);var s=ih(this._isDirected,e,t,n);return e=s.v,t=s.w,Object.freeze(s),this._edgeObjs[o]=s,zp(this._preds[t],e),zp(this._sucs[e],t),this._in[t][o]=s,this._out[e][o]=s,this._edgeCount++,this},sr.prototype.edge=function(e,t,n){var r=arguments.length===1?ci(this._isDirected,arguments[0]):Qf(this._isDirected,e,t,n);return this._edgeLabels[r]},sr.prototype.hasEdge=function(e,t,n){var r=arguments.length===1?ci(this._isDirected,arguments[0]):Qf(this._isDirected,e,t,n);return Zt.has(this._edgeLabels,r)},sr.prototype.removeEdge=function(e,t,n){var r=arguments.length===1?ci(this._isDirected,arguments[0]):Qf(this._isDirected,e,t,n),i=this._edgeObjs[r];return i&&(e=i.v,t=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],Fs(this._preds[t],e),Fs(this._sucs[e],t),delete this._in[t][r],delete this._out[e][r],this._edgeCount--),this},sr.prototype.inEdges=function(e,t){var n=this._in[e];if(n){var r=Zt.values(n);return t?Zt.filter(r,function(i){return i.v===t}):r}},sr.prototype.outEdges=function(e,t){var n=this._out[e];if(n){var r=Zt.values(n);return t?Zt.filter(r,function(i){return i.w===t}):r}},sr.prototype.nodeEdges=function(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t))};var xi={Graph:gv,version:"2.1.8"},Wp={write:function(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:Ym(e),edges:Km(e)};return Zt.isUndefined(e.graph())||(t.value=Zt.clone(e.graph())),t},read:function(e){var t=new gv(e.options).setGraph(e.value);return Zt.each(e.nodes,function(n){t.setNode(n.v,n.value),n.parent&&t.setParent(n.v,n.parent)}),Zt.each(e.edges,function(n){t.setEdge({v:n.v,w:n.w,name:n.name},n.value)}),t}};function Ym(e){return Zt.map(e.nodes(),function(t){var n=e.node(t),r=e.parent(t),i={v:t};return Zt.isUndefined(n)||(i.value=n),Zt.isUndefined(r)||(i.parent=r),i})}function Km(e){return Zt.map(e.edges(),function(t){var n=e.edge(t),r={v:t.v,w:t.w};return Zt.isUndefined(t.name)||(r.name=t.name),Zt.isUndefined(n)||(r.value=n),r})}var qm=function(e){var t,n={},r=[];function i(a){Zt.has(n,a)||(n[a]=!0,t.push(a),Zt.each(e.successors(a),i),Zt.each(e.predecessors(a),i))}return Zt.each(e.nodes(),function(a){t=[],i(a),t.length&&r.push(t)}),r},Vp=Po;function Po(){this._arr=[],this._keyIndices={}}Po.prototype.size=function(){return this._arr.length},Po.prototype.keys=function(){return this._arr.map(function(e){return e.key})},Po.prototype.has=function(e){return Zt.has(this._keyIndices,e)},Po.prototype.priority=function(e){var t=this._keyIndices[e];if(t!==void 0)return this._arr[t].priority},Po.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},Po.prototype.add=function(e,t){var n=this._keyIndices;if(e=String(e),!Zt.has(n,e)){var r=this._arr,i=r.length;return n[e]=i,r.push({key:e,priority:t}),this._decrease(i),!0}return!1},Po.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},Po.prototype.decrease=function(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+t);this._arr[n].priority=t,this._decrease(n)},Po.prototype._heapify=function(e){var t=this._arr,n=2*e,r=n+1,i=e;n<t.length&&(i=t[n].priority<t[i].priority?n:i,r<t.length&&(i=t[r].priority<t[i].priority?r:i),i!==e&&(this._swap(e,i),this._heapify(i)))},Po.prototype._decrease=function(e){for(var t,n=this._arr,r=n[e].priority;e!==0&&!(n[t=e>>1].priority<r);)this._swap(e,t),e=t},Po.prototype._swap=function(e,t){var n=this._arr,r=this._keyIndices,i=n[e],a=n[t];n[e]=a,n[t]=i,r[a.key]=e,r[i.key]=t};var Zp=function(e,t,n,r){return function(i,a,o,s){var c,f,d={},h=new Vp,v=function(m){var g=m.v!==c?m.v:m.w,_=d[g],y=o(m),E=f.distance+y;if(y<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+m+" Weight: "+y);E<_.distance&&(_.distance=E,_.predecessor=c,h.decrease(g,E))};for(i.nodes().forEach(function(m){var g=m===a?0:Number.POSITIVE_INFINITY;d[m]={distance:g},h.add(m,g)});h.size()>0&&(c=h.removeMin(),(f=d[c]).distance!==Number.POSITIVE_INFINITY);)s(c).forEach(v);return d}(e,String(t),n||jp,r||function(i){return e.outEdges(i)})},jp=Zt.constant(1),Bl=function(e,t,n){return Zt.transform(e.nodes(),function(r,i){r[i]=Zp(e,i,t,n)},{})},ah=function(e){var t=0,n=[],r={},i=[];function a(o){var s=r[o]={onStack:!0,lowlink:t,index:t++};if(n.push(o),e.successors(o).forEach(function(d){Zt.has(r,d)?r[d].onStack&&(s.lowlink=Math.min(s.lowlink,r[d].index)):(a(d),s.lowlink=Math.min(s.lowlink,r[d].lowlink))}),s.lowlink===s.index){var c,f=[];do c=n.pop(),r[c].onStack=!1,f.push(c);while(o!==c);i.push(f)}}return e.nodes().forEach(function(o){Zt.has(r,o)||a(o)}),i},Jm=function(e){return Zt.filter(ah(e),function(t){return t.length>1||t.length===1&&e.hasEdge(t[0],t[0])})},Hp=function(e,t,n){return function(r,i,a){var o={},s=r.nodes();return s.forEach(function(c){o[c]={},o[c][c]={distance:0},s.forEach(function(f){c!==f&&(o[c][f]={distance:Number.POSITIVE_INFINITY})}),a(c).forEach(function(f){var d=f.v===c?f.w:f.v,h=i(f);o[c][d]={distance:h,predecessor:c}})}),s.forEach(function(c){var f=o[c];s.forEach(function(d){var h=o[d];s.forEach(function(v){var m=h[c],g=f[v],_=h[v],y=m.distance+g.distance;y<_.distance&&(_.distance=y,_.predecessor=g.predecessor)})})}),o}(e,t||oh,n||function(r){return e.outEdges(r)})},oh=Zt.constant(1),Ma=qc;function qc(e){var t={},n={},r=[];if(Zt.each(e.sinks(),function i(a){if(Zt.has(n,a))throw new sh;Zt.has(t,a)||(n[a]=!0,t[a]=!0,Zt.each(e.predecessors(a),i),delete n[a],r.push(a))}),Zt.size(t)!==e.nodeCount())throw new sh;return r}function sh(){}qc.CycleException=sh,sh.prototype=new Error;var Xp=function(e,t,n){Zt.isArray(t)||(t=[t]);var r=(e.isDirected()?e.successors:e.neighbors).bind(e),i=[],a={};return Zt.each(t,function(o){if(!e.hasNode(o))throw new Error("Graph does not have node: "+o);$p(e,o,n==="post",a,r,i)}),i};function $p(e,t,n,r,i,a){Zt.has(r,t)||(r[t]=!0,n||a.push(t),Zt.each(i(t),function(o){$p(e,o,n,r,i,a)}),n&&a.push(t))}var uh,Qm={Graph:xi.Graph,json:Wp,alg:{components:qm,dijkstra:Zp,dijkstraAll:Bl,findCycles:Jm,floydWarshall:Hp,isAcyclic:function(e){try{Ma(e)}catch(t){if(t instanceof Ma.CycleException)return!1;throw t}return!0},postorder:function(e,t){return Xp(e,t,"post")},preorder:function(e,t){return Xp(e,t,"pre")},prim:function(e,t){var n,r=new gv,i={},a=new Vp;function o(c){var f=c.v===n?c.w:c.v,d=a.priority(f);if(d!==void 0){var h=t(c);h<d&&(i[f]=n,a.decrease(f,h))}}if(e.nodeCount()===0)return r;Zt.each(e.nodes(),function(c){a.add(c,Number.POSITIVE_INFINITY),r.setNode(c)}),a.decrease(e.nodes()[0],0);for(var s=!1;a.size()>0;){if(n=a.removeMin(),Zt.has(i,n))r.setEdge(n,i[n]);else{if(s)throw new Error("Input graph is not connected: "+e);s=!0}e.nodeEdges(n).forEach(o)}return r},tarjan:ah,topsort:Ma},version:xi.version};try{uh=Qm}catch(e){}uh||(uh=window.graphlib);var Oo=uh,pu=function(e){return xn(e,5)},jn=function(e,t,n){if(!Zi(n))return!1;var r=typeof t;return!!(r=="number"?ut(n)&&Qe(t,n.length):r=="string"&&t in n)&&qu(n[t],e)},yv=Object.prototype,Lo=yv.hasOwnProperty,Yp=nh(function(e,t){e=Object(e);var n=-1,r=t.length,i=r>2?t[2]:void 0;for(i&&jn(t[0],t[1],i)&&(r=1);++n<r;)for(var a=t[n],o=Qt(a),s=-1,c=o.length;++s<c;){var f=o[s],d=e[f];(d===void 0||qu(d,yv[f])&&!Lo.call(e,f))&&(e[f]=a[f])}return e}),eg=function(e){return function(t,n,r){var i=Object(t);if(!ut(t)){var a=Do(n);t=Ht(t),n=function(s){return a(i[s],s,i)}}var o=e(t,n,r);return o>-1?i[a?t[o]:o]:void 0}},Dr=/^\s+|\s+$/g,tg=/^[-+]0x[0-9a-f]+$/i,Kp=/^0b[01]+$/i,ch=/^0o[0-7]+$/i,ng=parseInt,rg=function(e){if(typeof e=="number")return e;if(sc(e))return NaN;if(Zi(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Zi(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(Dr,"");var n=Kp.test(e);return n||ch.test(e)?ng(e.slice(2),n?2:8):tg.test(e)?NaN:+e},fh=function(e){return e?(e=rg(e))===Infinity||e===-Infinity?17976931348623157e292*(e<0?-1:1):e==e?e:0:e===0?e:0},ig=function(e){var t=fh(e),n=t%1;return t==t?n?t-n:t:0},ag=Math.max,og=eg(function(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var i=n==null?0:ig(n);return i<0&&(i=ag(r+i,0)),Fp(e,Do(t),i)}),qp=function(e){return(e==null?0:e.length)?mv(e,1):[]},sg=function(e,t){return e==null?e:vn(e,qf(t),Qt)},ug=function(e){var t=e==null?0:e.length;return t?e[t-1]:void 0},cg=function(e,t){var n={};return t=Do(t),tr(e,function(r,i,a){ac(n,i,t(r,i,a))}),n},_v=function(e,t,n){for(var r=-1,i=e.length;++r<i;){var a=e[r],o=t(a);if(o!=null&&(s===void 0?o==o&&!sc(o):n(o,s)))var s=o,c=a}return c},fg=function(e,t){return e>t},lg=function(e){return e&&e.length?_v(e,wi,fg):void 0},zl=function(e,t,n){(n!==void 0&&!qu(e[t],n)||n===void 0&&!(t in e))&&ac(e,t,n)},dg=Function.prototype,Ev=Object.prototype,Jp=dg.toString,hg=Ev.hasOwnProperty,vg=Jp.call(Object),ia=function(e){if(!Pi(e)||Fi(e)!="[object Object]")return!1;var t=xr(e);if(t===null)return!0;var n=hg.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&Jp.call(n)==vg},Ea=function(e,t){if((t!=="constructor"||typeof e[t]!="function")&&t!="__proto__")return e[t]},pg=function(e){return Yc(e,Qt(e))},mg=function(e,t,n,r,i,a,o){var s=Ea(e,n),c=Ea(t,n),f=o.get(c);if(f)zl(e,n,f);else{var d=a?a(s,c,n+"",e,t,o):void 0,h=d===void 0;if(h){var v=se(c),m=!v&&Te(c),g=!v&&!m&&fe(c);d=c,v||m||g?se(s)?d=s:Up(s)?d=Fn(s):m?(h=!1,d=Ut(c,!0)):g?(h=!1,d=K(c,!0)):d=[]:ia(c)||ye(c)?(d=s,ye(s)?d=pg(s):Zi(s)&&!Ro(s)||(d=G(c))):h=!1}h&&(o.set(c,d),i(d,c,r,a,o),o.delete(c)),zl(e,n,d)}},gg=function e(t,n,r,i,a){t!==n&&vn(n,function(o,s){if(a||(a=new vu),Zi(o))mg(t,n,s,r,e,i,a);else{var c=i?i(Ea(t,s),o,s+"",t,n,a):void 0;c===void 0&&(c=o),zl(t,s,c)}},Qt)},Qp=function(e){return nh(function(t,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,o=i>2?n[2]:void 0;for(a=e.length>3&&typeof a=="function"?(i--,a):void 0,o&&jn(n[0],n[1],o)&&(a=i<3?void 0:a,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,a)}return t})}(function(e,t,n){gg(e,t,n)}),e0=function(e,t){return e<t},yg=function(e){return e&&e.length?_v(e,wi,e0):void 0},_g=function(e,t){return e&&e.length?_v(e,Do(t),e0):void 0},t0=function(){return Ur.Date.now()},Eg=function(e,t,n,r){if(!Zi(e))return e;for(var i=-1,a=(t=Kd(t,e)).length,o=a-1,s=e;s!=null&&++i<a;){var c=Fl(t[i]),f=n;if(c==="__proto__"||c==="constructor"||c==="prototype")return e;if(i!=o){var d=s[c];(f=r?r(d,c,s):void 0)===void 0&&(f=Zi(d)?d:Qe(t[i+1])?[]:{})}oc(s,c,f),s=s[c]}return e},bg=function(e,t,n){for(var r=-1,i=t.length,a={};++r<i;){var o=t[r],s=qd(e,o);n(s,o)&&Eg(a,Kd(o,e),s)}return a},wg=function(e,t){return bg(e,t,function(n,r){return dv(e,r)})},n0=function(e){return kp(Gp(e,void 0,qp),e+"")}(function(e,t){return e==null?{}:wg(e,t)}),r0=Math.ceil,xg=Math.max,Sg=function(e,t,n,r){for(var i=-1,a=xg(r0((t-e)/(n||1)),0),o=Array(a);a--;)o[r?a:++i]=e,e+=n;return o},Tg=function(e){return function(t,n,r){return r&&typeof r!="number"&&jn(t,n,r)&&(n=r=void 0),t=fh(t),n===void 0?(n=t,t=0):n=fh(n),r=r===void 0?t<n?1:-1:fh(r),Sg(t,n,r,e)}}(),Ag=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e},el=function(e,t){if(e!==t){var n=e!==void 0,r=e===null,i=e==e,a=sc(e),o=t!==void 0,s=t===null,c=t==t,f=sc(t);if(!s&&!f&&!a&&e>t||a&&o&&c&&!s&&!f||r&&o&&c||!n&&c||!i)return 1;if(!r&&!a&&!f&&e<t||f&&n&&i&&!r&&!a||s&&n&&i||!o&&i||!c)return-1}return 0},Ig=function(e,t,n){for(var r=-1,i=e.criteria,a=t.criteria,o=i.length,s=n.length;++r<o;){var c=el(i[r],a[r]);if(c)return r>=s?c:c*(n[r]=="desc"?-1:1)}return e.index-t.index},Cg=function(e,t,n){t=t.length?Jf(t,function(a){return se(a)?function(o){return qd(o,a.length===1?a[0]:a)}:a}):[wi];var r=-1;t=Jf(t,Et(Do));var i=Sp(e,function(a,o,s){return{criteria:Jf(t,function(c){return c(a)}),index:++r,value:a}});return Ag(i,function(a,o){return Ig(a,o,n)})},Rg=nh(function(e,t){if(e==null)return[];var n=t.length;return n>1&&jn(e,t[0],t[1])?t=[]:n>2&&jn(t[0],t[1],t[2])&&(t=[t[0]]),Cg(e,mv(t,1),[])}),Mg=0,Ng=function(e){var t=++Mg;return _p(e)+t},i0=function(e,t,n){for(var r=-1,i=e.length,a=t.length,o={};++r<i;){var s=r<a?t[r]:void 0;n(o,e[r],s)}return o},Wl,Dg=function(e,t){return i0(e||[],t||[],oc)};try{Wl={cloneDeep:pu,constant:Jt,defaults:Yp,each:kl,filter:bp,find:og,flatten:qp,forEach:Ra,forIn:sg,has:wp,isUndefined:xp,last:ug,map:Tp,mapValues:cg,max:lg,merge:Qp,min:yg,minBy:_g,now:t0,pick:n0,range:Tg,reduce:Ul,sortBy:Rg,uniqueId:Ng,values:Bp,zipObject:Dg}}catch(e){}Wl||(Wl=window._);var q=Wl,Pg=lh;function lh(){var e={};e._next=e._prev=e,this._sentinel=e}function a0(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function Og(e,t){if(e!=="_next"&&e!=="_prev")return t}lh.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return a0(t),t},lh.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&a0(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t},lh.prototype.toString=function(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,Og)),n=n._prev;return"["+e.join(", ")+"]"};var Lg=Oo.Graph,Gg=function(e,t){if(e.nodeCount()<=1)return[];var n=function(i,a){var o=new Lg,s=0,c=0;q.forEach(i.nodes(),function(h){o.setNode(h,{v:h,in:0,out:0})}),q.forEach(i.edges(),function(h){var v=o.edge(h.v,h.w)||0,m=a(h),g=v+m;o.setEdge(h.v,h.w,g),c=Math.max(c,o.node(h.v).out+=m),s=Math.max(s,o.node(h.w).in+=m)});var f=q.range(c+s+3).map(function(){return new Pg}),d=s+1;return q.forEach(o.nodes(),function(h){wv(f,d,o.node(h))}),{graph:o,buckets:f,zeroIdx:d}}(e,t||kg),r=function(i,a,o){for(var s,c=[],f=a[a.length-1],d=a[0];i.nodeCount();){for(;s=d.dequeue();)bv(i,a,o,s);for(;s=f.dequeue();)bv(i,a,o,s);if(i.nodeCount()){for(var h=a.length-2;h>0;--h)if(s=a[h].dequeue()){c=c.concat(bv(i,a,o,s,!0));break}}}return c}(n.graph,n.buckets,n.zeroIdx);return q.flatten(q.map(r,function(i){return e.outEdges(i.v,i.w)}),!0)},kg=q.constant(1);function bv(e,t,n,r,i){var a=i?[]:void 0;return q.forEach(e.inEdges(r.v),function(o){var s=e.edge(o),c=e.node(o.v);i&&a.push({v:o.v,w:o.w}),c.out-=s,wv(t,n,c)}),q.forEach(e.outEdges(r.v),function(o){var s=e.edge(o),c=o.w,f=e.node(c);f.in-=s,wv(t,n,f)}),e.removeNode(r.v),a}function wv(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}var o0={run:function(e){var t=e.graph().acyclicer==="greedy"?Gg(e,function(n){return function(r){return n.edge(r).weight}}(e)):function(n){var r=[],i={},a={};function o(s){q.has(a,s)||(a[s]=!0,i[s]=!0,q.forEach(n.outEdges(s),function(c){q.has(i,c.w)?r.push(c):o(c.w)}),delete i[s])}return q.forEach(n.nodes(),o),r}(e);q.forEach(t,function(n){var r=e.edge(n);e.removeEdge(n),r.forwardName=n.name,r.reversed=!0,e.setEdge(n.w,n.v,r,q.uniqueId("rev"))})},undo:function(e){q.forEach(e.edges(),function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}},s0=Oo.Graph,aa={addDummyNode:u0,simplify:function(e){var t=new s0().setGraph(e.graph());return q.forEach(e.nodes(),function(n){t.setNode(n,e.node(n))}),q.forEach(e.edges(),function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},i=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})}),t},asNonCompoundGraph:function(e){var t=new s0({multigraph:e.isMultigraph()}).setGraph(e.graph());return q.forEach(e.nodes(),function(n){e.children(n).length||t.setNode(n,e.node(n))}),q.forEach(e.edges(),function(n){t.setEdge(n,e.edge(n))}),t},successorWeights:function(e){var t=q.map(e.nodes(),function(n){var r={};return q.forEach(e.outEdges(n),function(i){r[i.w]=(r[i.w]||0)+e.edge(i).weight}),r});return q.zipObject(e.nodes(),t)},predecessorWeights:function(e){var t=q.map(e.nodes(),function(n){var r={};return q.forEach(e.inEdges(n),function(i){r[i.v]=(r[i.v]||0)+e.edge(i).weight}),r});return q.zipObject(e.nodes(),t)},intersectRect:function(e,t){var n,r,i=e.x,a=e.y,o=t.x-i,s=t.y-a,c=e.width/2,f=e.height/2;if(!o&&!s)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(s)*c>Math.abs(o)*f?(s<0&&(f=-f),n=f*o/s,r=f):(o<0&&(c=-c),n=c,r=c*s/o),{x:i+n,y:a+r}},buildLayerMatrix:function(e){var t=q.map(q.range(c0(e)+1),function(){return[]});return q.forEach(e.nodes(),function(n){var r=e.node(n),i=r.rank;q.isUndefined(i)||(t[i][r.order]=n)}),t},normalizeRanks:function(e){var t=q.min(q.map(e.nodes(),function(n){return e.node(n).rank}));q.forEach(e.nodes(),function(n){var r=e.node(n);q.has(r,"rank")&&(r.rank-=t)})},removeEmptyRanks:function(e){var t=q.min(q.map(e.nodes(),function(a){return e.node(a).rank})),n=[];q.forEach(e.nodes(),function(a){var o=e.node(a).rank-t;n[o]||(n[o]=[]),n[o].push(a)});var r=0,i=e.graph().nodeRankFactor;q.forEach(n,function(a,o){q.isUndefined(a)&&o%i!=0?--r:r&&q.forEach(a,function(s){e.node(s).rank+=r})})},addBorderNode:function(e,t,n,r){var i={width:0,height:0};return arguments.length>=4&&(i.rank=n,i.order=r),u0(e,"border",i,t)},maxRank:c0,partition:function(e,t){var n={lhs:[],rhs:[]};return q.forEach(e,function(r){t(r)?n.lhs.push(r):n.rhs.push(r)}),n},time:function(e,t){var n=q.now();try{return t()}finally{console.log(e+" time: "+(q.now()-n)+"ms")}},notime:function(e,t){return t()}};function u0(e,t,n,r){var i;do i=q.uniqueId(r);while(e.hasNode(i));return n.dummy=t,e.setNode(i,n),i}function c0(e){return q.max(q.map(e.nodes(),function(t){var n=e.node(t).rank;if(!q.isUndefined(n))return n}))}var f0={run:function(e){e.graph().dummyChains=[],q.forEach(e.edges(),function(t){(function(n,r){var i,a,o,s=r.v,c=n.node(s).rank,f=r.w,d=n.node(f).rank,h=r.name,v=n.edge(r),m=v.labelRank;if(d!==c+1){for(n.removeEdge(r),o=0,++c;c<d;++o,++c)v.points=[],a={width:0,height:0,edgeLabel:v,edgeObj:r,rank:c},i=aa.addDummyNode(n,"edge",a,"_d"),c===m&&(a.width=v.width,a.height=v.height,a.dummy="edge-label",a.labelpos=v.labelpos),n.setEdge(s,i,{weight:v.weight},h),o===0&&n.graph().dummyChains.push(i),s=i;n.setEdge(s,f,{weight:v.weight},h)}})(e,t)})},undo:function(e){q.forEach(e.graph().dummyChains,function(t){var n,r=e.node(t),i=r.edgeLabel;for(e.setEdge(r.edgeObj,i);r.dummy;)n=e.successors(t)[0],e.removeNode(t),i.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height),t=n,r=e.node(t)})}},l0=function(e){var t={};q.forEach(e.sources(),function n(r){var i=e.node(r);if(q.has(t,r))return i.rank;t[r]=!0;var a=q.min(q.map(e.outEdges(r),function(o){return n(o.w)-e.edge(o).minlen}));return a!==Number.POSITIVE_INFINITY&&a!=null||(a=0),i.rank=a})},d0=function(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen},Fg=Oo.Graph,dh=d0,h0=function(e){var t,n,r=new Fg({directed:!1}),i=e.nodes()[0],a=e.nodeCount();for(r.setNode(i,{});Ug(r,e)<a;)t=Bg(r,e),n=r.hasNode(t.v)?dh(e,t):-dh(e,t),zg(r,e,n);return r};function Ug(e,t){return q.forEach(e.nodes(),function n(r){q.forEach(t.nodeEdges(r),function(i){var a=i.v,o=r===a?i.w:a;e.hasNode(o)||dh(t,i)||(e.setNode(o,{}),e.setEdge(r,o,{}),n(o))})}),e.nodeCount()}function Bg(e,t){return q.minBy(t.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return dh(t,n)})}function zg(e,t,n){q.forEach(e.nodes(),function(r){t.node(r).rank+=n})}var xv=d0,v0=l0,p0=Oo.alg.preorder,Wg=Oo.alg.postorder,Vg=aa.simplify,Zg=mu;function mu(e){e=Vg(e),v0(e);var t,n=h0(e);for(Tv(n),Sv(n,e);t=hh(n);)y0(n,e,t,g0(n,e,t))}function Sv(e,t){var n=Wg(e,e.nodes());n=n.slice(0,n.length-1),q.forEach(n,function(r){(function(i,a,o){var s=i.node(o).parent;i.edge(o,s).cutvalue=m0(i,a,o)})(e,t,r)})}function m0(e,t,n){var r=e.node(n).parent,i=!0,a=t.edge(n,r),o=0;return a||(i=!1,a=t.edge(r,n)),o=a.weight,q.forEach(t.nodeEdges(n),function(s){var c,f,d=s.v===n,h=d?s.w:s.v;if(h!==r){var v=d===i,m=t.edge(s).weight;if(o+=v?m:-m,c=n,f=h,e.hasEdge(c,f)){var g=e.edge(n,h).cutvalue;o+=v?-g:g}}}),o}function Tv(e,t){arguments.length<2&&(t=e.nodes()[0]),Na(e,{},1,t)}function Na(e,t,n,r,i){var a=n,o=e.node(r);return t[r]=!0,q.forEach(e.neighbors(r),function(s){q.has(t,s)||(n=Na(e,t,n,s,r))}),o.low=a,o.lim=n++,i?o.parent=i:delete o.parent,n}function hh(e){return q.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function g0(e,t,n){var r=n.v,i=n.w;t.hasEdge(r,i)||(r=n.w,i=n.v);var a=e.node(r),o=e.node(i),s=a,c=!1;a.lim>o.lim&&(s=o,c=!0);var f=q.filter(t.edges(),function(d){return c===_0(e,e.node(d.v),s)&&c!==_0(e,e.node(d.w),s)});return q.minBy(f,function(d){return xv(t,d)})}function y0(e,t,n,r){var i=n.v,a=n.w;e.removeEdge(i,a),e.setEdge(r.v,r.w,{}),Tv(e),Sv(e,t),function(o,s){var c=q.find(o.nodes(),function(d){return!s.node(d).parent}),f=p0(o,c);f=f.slice(1),q.forEach(f,function(d){var h=o.node(d).parent,v=s.edge(d,h),m=!1;v||(v=s.edge(h,d),m=!0),s.node(d).rank=s.node(h).rank+(m?v.minlen:-v.minlen)})}(e,t)}function _0(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}mu.initLowLimValues=Tv,mu.initCutValues=Sv,mu.calcCutValue=m0,mu.leaveEdge=hh,mu.enterEdge=g0,mu.exchangeEdges=y0;var E0=l0,Av=function(e){switch(e.graph().ranker){case"network-simplex":vh(e);break;case"tight-tree":(function(t){E0(t),h0(t)})(e);break;case"longest-path":jg(e);break;default:vh(e)}},jg=E0;function vh(e){Zg(e)}var Hg=function(e){var t=function(n){var r={},i=0;function a(o){var s=i;q.forEach(n.children(o),a),r[o]={low:s,lim:i++}}return q.forEach(n.children(),a),r}(e);q.forEach(e.graph().dummyChains,function(n){for(var r=e.node(n),i=r.edgeObj,a=function(h,v,m,g){var _,y,E=[],b=[],A=Math.min(v[m].low,v[g].low),C=Math.max(v[m].lim,v[g].lim);_=m;do _=h.parent(_),E.push(_);while(_&&(v[_].low>A||C>v[_].lim));for(y=_,_=g;(_=h.parent(_))!==y;)b.push(_);return{path:E.concat(b.reverse()),lca:y}}(e,t,i.v,i.w),o=a.path,s=a.lca,c=0,f=o[c],d=!0;n!==i.w;){if(r=e.node(n),d){for(;(f=o[c])!==s&&e.node(f).maxRank<r.rank;)c++;f===s&&(d=!1)}if(!d){for(;c<o.length-1&&e.node(f=o[c+1]).minRank<=r.rank;)c++;f=o[c]}e.setParent(n,f),n=e.successors(n)[0]}})},b0={run:function(e){var t=aa.addDummyNode(e,"root",{},"_root"),n=function(o){var s={};function c(f,d){var h=o.children(f);h&&h.length&&q.forEach(h,function(v){c(v,d+1)}),s[f]=d}return q.forEach(o.children(),function(f){c(f,1)}),s}(e),r=q.max(q.values(n))-1,i=2*r+1;e.graph().nestingRoot=t,q.forEach(e.edges(),function(o){e.edge(o).minlen*=i});var a=function(o){return q.reduce(o.edges(),function(s,c){return s+o.edge(c).weight},0)}(e)+1;q.forEach(e.children(),function(o){w0(e,t,i,a,r,n,o)}),e.graph().nodeRankFactor=i},cleanup:function(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,q.forEach(e.edges(),function(n){e.edge(n).nestingEdge&&e.removeEdge(n)})}};function w0(e,t,n,r,i,a,o){var s=e.children(o);if(s.length){var c=aa.addBorderNode(e,"_bt"),f=aa.addBorderNode(e,"_bb"),d=e.node(o);e.setParent(c,o),d.borderTop=c,e.setParent(f,o),d.borderBottom=f,q.forEach(s,function(h){w0(e,t,n,r,i,a,h);var v=e.node(h),m=v.borderTop?v.borderTop:h,g=v.borderBottom?v.borderBottom:h,_=v.borderTop?r:2*r,y=m!==g?1:i-a[o]+1;e.setEdge(c,m,{weight:_,minlen:y,nestingEdge:!0}),e.setEdge(g,f,{weight:_,minlen:y,nestingEdge:!0})}),e.parent(o)||e.setEdge(t,c,{weight:0,minlen:i+a[o]})}else o!==t&&e.setEdge(t,o,{weight:0,minlen:n})}var Xg=function(e){q.forEach(e.children(),function t(n){var r=e.children(n),i=e.node(n);if(r.length&&q.forEach(r,t),q.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var a=i.minRank,o=i.maxRank+1;a<o;++a)Iv(e,"borderLeft","_bl",n,i,a),Iv(e,"borderRight","_br",n,i,a)}})};function Iv(e,t,n,r,i,a){var o={width:0,height:0,rank:a,borderType:t},s=i[t][a-1],c=aa.addDummyNode(e,"border",o,n);i[t][a]=c,e.setParent(c,r),s&&e.setEdge(s,c,{weight:1})}var x0={adjust:function(e){var t=e.graph().rankdir.toLowerCase();t!=="lr"&&t!=="rl"||S0(e)},undo:function(e){var t=e.graph().rankdir.toLowerCase();t!=="bt"&&t!=="rl"||function(n){q.forEach(n.nodes(),function(r){Vl(n.node(r))}),q.forEach(n.edges(),function(r){var i=n.edge(r);q.forEach(i.points,Vl),q.has(i,"y")&&Vl(i)})}(e),t!=="lr"&&t!=="rl"||(function(n){q.forEach(n.nodes(),function(r){Zl(n.node(r))}),q.forEach(n.edges(),function(r){var i=n.edge(r);q.forEach(i.points,Zl),q.has(i,"x")&&Zl(i)})}(e),S0(e))}};function S0(e){q.forEach(e.nodes(),function(t){T0(e.node(t))}),q.forEach(e.edges(),function(t){T0(e.edge(t))})}function T0(e){var t=e.width;e.width=e.height,e.height=t}function Vl(e){e.y=-e.y}function Zl(e){var t=e.x;e.x=e.y,e.y=t}var $g=function(e){var t={},n=q.filter(e.nodes(),function(s){return!e.children(s).length}),r=q.max(q.map(n,function(s){return e.node(s).rank})),i=q.map(q.range(r+1),function(){return[]});function a(s){if(!q.has(t,s)){t[s]=!0;var c=e.node(s);i[c.rank].push(s),q.forEach(e.successors(s),a)}}var o=q.sortBy(n,function(s){return e.node(s).rank});return q.forEach(o,a),i},Yg=function(e,t){for(var n=0,r=1;r<t.length;++r)n+=Kg(e,t[r-1],t[r]);return n};function Kg(e,t,n){for(var r=q.zipObject(n,q.map(n,function(f,d){return d})),i=q.flatten(q.map(t,function(f){return q.sortBy(q.map(e.outEdges(f),function(d){return{pos:r[d.w],weight:e.edge(d).weight}}),"pos")}),!0),a=1;a<n.length;)a<<=1;var o=2*a-1;a-=1;var s=q.map(new Array(o),function(){return 0}),c=0;return q.forEach(i.forEach(function(f){var d=f.pos+a;s[d]+=f.weight;for(var h=0;d>0;)d%2&&(h+=s[d+1]),s[d=d-1>>1]+=f.weight;c+=f.weight*h})),c}var qg=function(e,t){return q.map(t,function(n){var r=e.inEdges(n);if(r.length){var i=q.reduce(r,function(a,o){var s=e.edge(o),c=e.node(o.v);return{sum:a.sum+s.weight*c.order,weight:a.weight+s.weight}},{sum:0,weight:0});return{v:n,barycenter:i.sum/i.weight,weight:i.weight}}return{v:n}})},Jg=function(e,t){var n={};return q.forEach(e,function(r,i){var a=n[r.v]={indegree:0,in:[],out:[],vs:[r.v],i};q.isUndefined(r.barycenter)||(a.barycenter=r.barycenter,a.weight=r.weight)}),q.forEach(t.edges(),function(r){var i=n[r.v],a=n[r.w];q.isUndefined(i)||q.isUndefined(a)||(a.indegree++,i.out.push(n[r.w]))}),function(r){var i=[];function a(c){return function(f){f.merged||(q.isUndefined(f.barycenter)||q.isUndefined(c.barycenter)||f.barycenter>=c.barycenter)&&function(d,h){var v=0,m=0;d.weight&&(v+=d.barycenter*d.weight,m+=d.weight),h.weight&&(v+=h.barycenter*h.weight,m+=h.weight),d.vs=h.vs.concat(d.vs),d.barycenter=v/m,d.weight=m,d.i=Math.min(h.i,d.i),h.merged=!0}(c,f)}}function o(c){return function(f){f.in.push(c),--f.indegree==0&&r.push(f)}}for(;r.length;){var s=r.pop();i.push(s),q.forEach(s.in.reverse(),a(s)),q.forEach(s.out,o(s))}return q.map(q.filter(i,function(c){return!c.merged}),function(c){return q.pick(c,["vs","i","barycenter","weight"])})}(q.filter(n,function(r){return!r.indegree}))},Qg=function(e,t){var n=aa.partition(e,function(h){return q.has(h,"barycenter")}),r=n.lhs,i=q.sortBy(n.rhs,function(h){return-h.i}),a=[],o=0,s=0,c=0;r.sort((f=!!t,function(h,v){return h.barycenter<v.barycenter?-1:h.barycenter>v.barycenter?1:f?v.i-h.i:h.i-v.i})),c=A0(a,i,c),q.forEach(r,function(h){c+=h.vs.length,a.push(h.vs),o+=h.barycenter*h.weight,s+=h.weight,c=A0(a,i,c)});var f,d={vs:q.flatten(a,!0)};return s&&(d.barycenter=o/s,d.weight=s),d};function A0(e,t,n){for(var r;t.length&&(r=q.last(t)).i<=n;)t.pop(),e.push(r.vs),n++;return n}var ey=function e(t,n,r,i){var a=t.children(n),o=t.node(n),s=o?o.borderLeft:void 0,c=o?o.borderRight:void 0,f={};s&&(a=q.filter(a,function(_){return _!==s&&_!==c}));var d=qg(t,a);q.forEach(d,function(_){if(t.children(_.v).length){var y=e(t,_.v,r,i);f[_.v]=y,q.has(y,"barycenter")&&(E=_,b=y,q.isUndefined(E.barycenter)?(E.barycenter=b.barycenter,E.weight=b.weight):(E.barycenter=(E.barycenter*E.weight+b.barycenter*b.weight)/(E.weight+b.weight),E.weight+=b.weight))}var E,b});var h=Jg(d,r);(function(_,y){q.forEach(_,function(E){E.vs=q.flatten(E.vs.map(function(b){return y[b]?y[b].vs:b}),!0)})})(h,f);var v=Qg(h,i);if(s&&(v.vs=q.flatten([s,v.vs,c],!0),t.predecessors(s).length)){var m=t.node(t.predecessors(s)[0]),g=t.node(t.predecessors(c)[0]);q.has(v,"barycenter")||(v.barycenter=0,v.weight=0),v.barycenter=(v.barycenter*v.weight+m.order+g.order)/(v.weight+2),v.weight+=2}return v},ty=Oo.Graph,ny=function(e,t,n){var r=function(a){for(var o;a.hasNode(o=q.uniqueId("_root")););return o}(e),i=new ty({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(function(a){return e.node(a)});return q.forEach(e.nodes(),function(a){var o=e.node(a),s=e.parent(a);(o.rank===t||o.minRank<=t&&t<=o.maxRank)&&(i.setNode(a),i.setParent(a,s||r),q.forEach(e[n](a),function(c){var f=c.v===a?c.w:c.v,d=i.edge(f,a),h=q.isUndefined(d)?0:d.weight;i.setEdge(f,a,{weight:e.edge(c).weight+h})}),q.has(o,"minRank")&&i.setNode(a,{borderLeft:o.borderLeft[t],borderRight:o.borderRight[t]}))}),i},ry=function(e,t,n){var r,i={};q.forEach(n,function(a){for(var o,s,c=e.parent(a);c;){if((o=e.parent(c))?(s=i[o],i[o]=c):(s=r,r=c),s&&s!==c)return void t.setEdge(s,c);c=o}})},iy=Oo.Graph,ay=function(e){var t=aa.maxRank(e),n=I0(e,q.range(1,t+1),"inEdges"),r=I0(e,q.range(t-1,-1,-1),"outEdges"),i=$g(e);C0(e,i);for(var a,o=Number.POSITIVE_INFINITY,s=0,c=0;c<4;++s,++c){oy(s%2?n:r,s%4>=2),i=aa.buildLayerMatrix(e);var f=Yg(e,i);f<o&&(c=0,a=q.cloneDeep(i),o=f)}C0(e,a)};function I0(e,t,n){return q.map(t,function(r){return ny(e,r,n)})}function oy(e,t){var n=new iy;q.forEach(e,function(r){var i=r.graph().root,a=ey(r,i,n,t);q.forEach(a.vs,function(o,s){r.node(o).order=s}),ry(r,n,a.vs)})}function C0(e,t){q.forEach(t,function(n){q.forEach(n,function(r,i){e.node(r).order=i})})}var sy=Oo.Graph,uy=function(e){var t,n=aa.buildLayerMatrix(e),r=q.merge(cy(e,n),fy(e,n)),i={};q.forEach(["u","d"],function(o){t=o==="u"?n:q.values(n).reverse(),q.forEach(["l","r"],function(s){s==="r"&&(t=q.map(t,function(h){return q.values(h).reverse()}));var c=(o==="u"?e.predecessors:e.successors).bind(e),f=l(e,t,r,c),d=p(e,t,f.root,f.align,s==="r");s==="r"&&(d=q.mapValues(d,function(h){return-h})),i[o+s]=d})});var a=w(e,i);return M(i,a),F(i,e.graph().align)};function cy(e,t){var n={};return q.reduce(t,function(r,i){var a=0,o=0,s=r.length,c=q.last(i);return q.forEach(i,function(f,d){var h=function(m,g){if(m.node(g).dummy)return q.find(m.predecessors(g),function(_){return m.node(_).dummy})}(e,f),v=h?e.node(h).order:s;(h||f===c)&&(q.forEach(i.slice(o,d+1),function(m){q.forEach(e.predecessors(m),function(g){var _=e.node(g),y=_.order;!(y<a||v<y)||_.dummy&&e.node(m).dummy||R0(n,g,m)})}),o=d+1,a=v)}),i}),n}function fy(e,t){var n={};function r(i,a,o,s,c){var f;q.forEach(q.range(a,o),function(d){f=i[d],e.node(f).dummy&&q.forEach(e.predecessors(f),function(h){var v=e.node(h);v.dummy&&(v.order<s||v.order>c)&&R0(n,h,f)})})}return q.reduce(t,function(i,a){var o,s=-1,c=0;return q.forEach(a,function(f,d){if(e.node(f).dummy==="border"){var h=e.predecessors(f);h.length&&(o=e.node(h[0]).order,r(a,c,d,s,o),c=d,s=o)}r(a,c,a.length,o,i.length)}),a}),n}function R0(e,t,n){if(t>n){var r=t;t=n,n=r}var i=e[t];i||(e[t]=i={}),i[n]=!0}function u(e,t,n){if(t>n){var r=t;t=n,n=r}return q.has(e[t],n)}function l(e,t,n,r){var i={},a={},o={};return q.forEach(t,function(s){q.forEach(s,function(c,f){i[c]=c,a[c]=c,o[c]=f})}),q.forEach(t,function(s){var c=-1;q.forEach(s,function(f){var d=r(f);if(d.length)for(var h=((d=q.sortBy(d,function(_){return o[_]})).length-1)/2,v=Math.floor(h),m=Math.ceil(h);v<=m;++v){var g=d[v];a[f]===f&&c<o[g]&&!u(n,f,g)&&(a[g]=f,a[f]=i[f]=i[g],c=o[g])}})}),{root:i,align:a}}function p(e,t,n,r,i){var a={},o=function(f,d,h,v){var m=new sy,g=f.graph(),_=function(y,E,b){return function(A,C,R){var W,te=A.node(C),Q=A.node(R),re=0;if(re+=te.width/2,q.has(te,"labelpos"))switch(te.labelpos.toLowerCase()){case"l":W=-te.width/2;break;case"r":W=te.width/2}if(W&&(re+=b?W:-W),W=0,re+=(te.dummy?E:y)/2,re+=(Q.dummy?E:y)/2,re+=Q.width/2,q.has(Q,"labelpos"))switch(Q.labelpos.toLowerCase()){case"l":W=Q.width/2;break;case"r":W=-Q.width/2}return W&&(re+=b?W:-W),W=0,re}}(g.nodesep,g.edgesep,v);return q.forEach(d,function(y){var E;q.forEach(y,function(b){var A=h[b];if(m.setNode(A),E){var C=h[E],R=m.edge(C,A);m.setEdge(C,A,Math.max(_(f,b,E),R||0))}E=b})}),m}(e,t,n,i),s=i?"borderLeft":"borderRight";function c(f,d){for(var h=o.nodes(),v=h.pop(),m={};v;)m[v]?f(v):(m[v]=!0,h.push(v),h=h.concat(d(v))),v=h.pop()}return c(function(f){a[f]=o.inEdges(f).reduce(function(d,h){return Math.max(d,a[h.v]+o.edge(h))},0)},o.predecessors.bind(o)),c(function(f){var d=o.outEdges(f).reduce(function(v,m){return Math.min(v,a[m.w]-o.edge(m))},Number.POSITIVE_INFINITY),h=e.node(f);d!==Number.POSITIVE_INFINITY&&h.borderType!==s&&(a[f]=Math.max(a[f],d))},o.successors.bind(o)),q.forEach(r,function(f){a[f]=a[n[f]]}),a}function w(e,t){return q.minBy(q.values(t),function(n){var r=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return q.forIn(n,function(a,o){var s=function(c,f){return c.node(f).width}(e,o)/2;r=Math.max(a+s,r),i=Math.min(a-s,i)}),r-i})}function M(e,t){var n=q.values(t),r=q.min(n),i=q.max(n);q.forEach(["u","d"],function(a){q.forEach(["l","r"],function(o){var s,c=a+o,f=e[c];if(f!==t){var d=q.values(f);(s=o==="l"?r-q.min(d):i-q.max(d))&&(e[c]=q.mapValues(f,function(h){return h+s}))}})})}function F(e,t){return q.mapValues(e.ul,function(n,r){if(t)return e[t.toLowerCase()][r];var i=q.sortBy(q.map(e,r));return(i[1]+i[2])/2})}var J=uy,ue=function(e){(function(t){var n=aa.buildLayerMatrix(t),r=t.graph().ranksep,i=0;q.forEach(n,function(a){var o=q.max(q.map(a,function(s){return t.node(s).height}));q.forEach(a,function(s){t.node(s).y=i+o/2}),i+=o+r})})(e=aa.asNonCompoundGraph(e)),q.forEach(J(e),function(t,n){e.node(n).x=t})},be=aa.normalizeRanks,ct=aa.removeEmptyRanks,et=aa,wt=Oo.Graph,Xt=function(e,t){var n=t&&t.debugTiming?et.time:et.notime;n("layout",function(){var r=n("  buildLayoutGraph",function(){return function(i){var a=new wt({multigraph:!0,compound:!0}),o=Si(i.graph());return a.setGraph(q.merge({},Ln,Pa(o,sn),q.pick(o,ur))),q.forEach(i.nodes(),function(s){var c=Si(i.node(s));a.setNode(s,q.defaults(Pa(c,Gn),hr)),a.setParent(s,i.parent(s))}),q.forEach(i.edges(),function(s){var c=Si(i.edge(s));a.setEdge(s,q.merge({},co,Pa(c,_r),q.pick(c,Da)))}),a}(e)});n("  runLayout",function(){(function(i,a){a("    makeSpaceForEdgeLabels",function(){(function(o){var s=o.graph();s.ranksep/=2,q.forEach(o.edges(),function(c){var f=o.edge(c);f.minlen*=2,f.labelpos.toLowerCase()!=="c"&&(s.rankdir==="TB"||s.rankdir==="BT"?f.width+=f.labeloffset:f.height+=f.labeloffset)})})(i)}),a("    removeSelfEdges",function(){(function(o){q.forEach(o.edges(),function(s){if(s.v===s.w){var c=o.node(s.v);c.selfEdges||(c.selfEdges=[]),c.selfEdges.push({e:s,label:o.edge(s)}),o.removeEdge(s)}})})(i)}),a("    acyclic",function(){o0.run(i)}),a("    nestingGraph.run",function(){b0.run(i)}),a("    rank",function(){Av(et.asNonCompoundGraph(i))}),a("    injectEdgeLabelProxies",function(){(function(o){q.forEach(o.edges(),function(s){var c=o.edge(s);if(c.width&&c.height){var f=o.node(s.v),d={rank:(o.node(s.w).rank-f.rank)/2+f.rank,e:s};et.addDummyNode(o,"edge-proxy",d,"_ep")}})})(i)}),a("    removeEmptyRanks",function(){ct(i)}),a("    nestingGraph.cleanup",function(){b0.cleanup(i)}),a("    normalizeRanks",function(){be(i)}),a("    assignRankMinMax",function(){(function(o){var s=0;q.forEach(o.nodes(),function(c){var f=o.node(c);f.borderTop&&(f.minRank=o.node(f.borderTop).rank,f.maxRank=o.node(f.borderBottom).rank,s=q.max(s,f.maxRank))}),o.graph().maxRank=s})(i)}),a("    removeEdgeLabelProxies",function(){(function(o){q.forEach(o.nodes(),function(s){var c=o.node(s);c.dummy==="edge-proxy"&&(o.edge(c.e).labelRank=c.rank,o.removeNode(s))})})(i)}),a("    normalize.run",function(){f0.run(i)}),a("    parentDummyChains",function(){Hg(i)}),a("    addBorderSegments",function(){Xg(i)}),a("    order",function(){ay(i)}),a("    insertSelfEdges",function(){(function(o){var s=et.buildLayerMatrix(o);q.forEach(s,function(c){var f=0;q.forEach(c,function(d,h){var v=o.node(d);v.order=h+f,q.forEach(v.selfEdges,function(m){et.addDummyNode(o,"selfedge",{width:m.label.width,height:m.label.height,rank:v.rank,order:h+ ++f,e:m.e,label:m.label},"_se")}),delete v.selfEdges})})})(i)}),a("    adjustCoordinateSystem",function(){x0.adjust(i)}),a("    position",function(){ue(i)}),a("    positionSelfEdges",function(){(function(o){q.forEach(o.nodes(),function(s){var c=o.node(s);if(c.dummy==="selfedge"){var f=o.node(c.e.v),d=f.x+f.width/2,h=f.y,v=c.x-d,m=f.height/2;o.setEdge(c.e,c.label),o.removeNode(s),c.label.points=[{x:d+2*v/3,y:h-m},{x:d+5*v/6,y:h-m},{x:d+v,y:h},{x:d+5*v/6,y:h+m},{x:d+2*v/3,y:h+m}],c.label.x=c.x,c.label.y=c.y}})})(i)}),a("    removeBorderNodes",function(){(function(o){q.forEach(o.nodes(),function(s){if(o.children(s).length){var c=o.node(s),f=o.node(c.borderTop),d=o.node(c.borderBottom),h=o.node(q.last(c.borderLeft)),v=o.node(q.last(c.borderRight));c.width=Math.abs(v.x-h.x),c.height=Math.abs(d.y-f.y),c.x=h.x+c.width/2,c.y=f.y+c.height/2}}),q.forEach(o.nodes(),function(s){o.node(s).dummy==="border"&&o.removeNode(s)})})(i)}),a("    normalize.undo",function(){f0.undo(i)}),a("    fixupEdgeLabelCoords",function(){(function(o){q.forEach(o.edges(),function(s){var c=o.edge(s);if(q.has(c,"x"))switch(c.labelpos!=="l"&&c.labelpos!=="r"||(c.width-=c.labeloffset),c.labelpos){case"l":c.x-=c.width/2+c.labeloffset;break;case"r":c.x+=c.width/2+c.labeloffset}})})(i)}),a("    undoCoordinateSystem",function(){x0.undo(i)}),a("    translateGraph",function(){(function(o){var s=Number.POSITIVE_INFINITY,c=0,f=Number.POSITIVE_INFINITY,d=0,h=o.graph(),v=h.marginx||0,m=h.marginy||0;function g(_){var y=_.x,E=_.y,b=_.width,A=_.height;s=Math.min(s,y-b/2),c=Math.max(c,y+b/2),f=Math.min(f,E-A/2),d=Math.max(d,E+A/2)}q.forEach(o.nodes(),function(_){g(o.node(_))}),q.forEach(o.edges(),function(_){var y=o.edge(_);q.has(y,"x")&&g(y)}),s-=v,f-=m,q.forEach(o.nodes(),function(_){var y=o.node(_);y.x-=s,y.y-=f}),q.forEach(o.edges(),function(_){var y=o.edge(_);q.forEach(y.points,function(E){E.x-=s,E.y-=f}),q.has(y,"x")&&(y.x-=s),q.has(y,"y")&&(y.y-=f)}),h.width=c-s+v,h.height=d-f+m})(i)}),a("    assignNodeIntersects",function(){(function(o){q.forEach(o.edges(),function(s){var c,f,d=o.edge(s),h=o.node(s.v),v=o.node(s.w);d.points?(c=d.points[0],f=d.points[d.points.length-1]):(d.points=[],c=v,f=h),d.points.unshift(et.intersectRect(h,c)),d.points.push(et.intersectRect(v,f))})})(i)}),a("    reversePoints",function(){(function(o){q.forEach(o.edges(),function(s){var c=o.edge(s);c.reversed&&c.points.reverse()})})(i)}),a("    acyclic.undo",function(){o0.undo(i)})})(r,n)}),n("  updateInputGraph",function(){(function(i,a){q.forEach(i.nodes(),function(o){var s=i.node(o),c=a.node(o);s&&(s.x=c.x,s.y=c.y,a.children(o).length&&(s.width=c.width,s.height=c.height))}),q.forEach(i.edges(),function(o){var s=i.edge(o),c=a.edge(o);s.points=c.points,q.has(c,"x")&&(s.x=c.x,s.y=c.y)}),i.graph().width=a.graph().width,i.graph().height=a.graph().height})(e,r)})})},sn=["nodesep","edgesep","ranksep","marginx","marginy"],Ln={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},ur=["acyclicer","ranker","rankdir","align"],Gn=["width","height"],hr={width:0,height:0},_r=["minlen","weight","width","height","labeloffset"],co={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Da=["labelpos"];function Pa(e,t){return q.mapValues(q.pick(e,t),Number)}function Si(e){var t={};return q.forEach(e,function(n,r){t[r.toLowerCase()]=n}),t}var cs=Oo.Graph,Us={graphlib:Oo,layout:Xt,debug:{debugOrdering:function(e){var t=aa.buildLayerMatrix(e),n=new cs({compound:!0,multigraph:!0}).setGraph({});return q.forEach(e.nodes(),function(r){n.setNode(r,{label:r}),n.setParent(r,"layer"+e.node(r).rank)}),q.forEach(e.edges(),function(r){n.setEdge(r.v,r.w,{},r.name)}),q.forEach(t,function(r,i){var a="layer"+i;n.setNode(a,{rank:"same"}),q.reduce(r,function(o,s){return n.setEdge(o,s,{style:"invis"}),s})}),n}},util:{time:aa.time,notime:aa.notime},version:"0.8.5"},M0=Us.graphlib,Yx=Us.layout;class Kx{constructor(t){this.cardinality=1,this.include=ou.UNSPECIFIED,this.isGroupNode=!1,this.parentNode=null,this.type=ra.NODE,this.name=t.name,this.attr=t.attr||{},this.inputs=t.inputs,this.path=t.path||[],this.width=t.width,this.height=t.height}}class qx{constructor(){this.nodes={},this.edges=[],this.nodes={},this.edges=[]}}function Jx(e){const t=new qx;return e.nodes.map(n=>new Kx(n)).forEach(n=>{t.nodes[n.name]=n,n.inputs.forEach(r=>{(function(i,a,o){o.name!==a.name&&i.edges.push(Object.assign(Object.assign({},o.attr),{v:o.name,w:a.name}))})(t,n,r)})}),t}class Qx{constructor(t,n={}){this.attr=null,this.bridgeGraph=null,this.cardinality=0,this.depth=1,this.include=ou.UNSPECIFIED,this.isGroupNode=!0,this.parentNode=null,this.type=ra.META,this.path=[],this.name=t,this.metaGraph=ly(t,su.META,n)}getFirstChild(){return this.metaGraph.node(this.metaGraph.nodes()[0])}getChildren(){return this.metaGraph.nodes().map(t=>this.metaGraph.node(t))}leaves(){let t,n=[],r=[this];for(;r.length;){let i=r.shift();i.isGroupNode?(t=i.metaGraph,t.nodes().forEach(a=>r.push(t.node(a)))):n.push(i.name)}return n}}class eS{constructor(t,n){this.v=t,this.w=n,this.baseEdgeList=[],this.inbound=null,this.name=null}addBaseEdge(t,n){this.baseEdgeList.push(t)}}function qy(e,t={}){return new Qx(e,t)}function Jy(e,t){return new eS(e,t)}function ly(e,t,n){const r=n||{},i=new M0.Graph(r);return i.setGraph({name:e,rankdir:r.rankdir,type:t,align:r.align}),i}class tS{constructor(t={}){this.graphOptions=t,this.index={},this.graphOptions.compound=!0,this.root=qy(ro,this.graphOptions),this.index[ro]=this.root}getNodeMap(){return this.index}node(t){return this.index[t]}setNode(t,n){this.index[t]=n}getBridgeGraph(t){const n=this.index[t];if(!n)throw Error("Could not find node in hierarchy: "+t);if(!("metaGraph"in n))return null;const r=n;if(r.bridgeGraph)return r.bridgeGraph;const i=ly(Bd,su.BRIDGE,this.graphOptions);if(r.bridgeGraph=i,!n.parentNode||!("metaGraph"in n.parentNode))return i;const a=n.parentNode;return[a.metaGraph,this.getBridgeGraph(a.name)].forEach(o=>{o.edges().filter(s=>s.v===t||s.w===t).forEach(s=>{const c=s.w===t;o.edge(s).baseEdgeList.forEach(f=>{const[d,h]=c?[f.w,s.v]:[f.v,s.w],v=this.getChildName(t,d),m={v:c?h:v,w:c?v:h};let g=i.edge(m);g||(g=Jy(m.v,m.w),g.inbound=c,i.setEdge(m.v,m.w,g)),g.addBaseEdge(f,this)})})}),i}getChildName(t,n){let r=this.index[n];for(;r;){if(r.parentNode&&r.parentNode.name===t)return r.name;r=r.parentNode}throw Error("Could not find immediate child for descendant: "+n)}getPredecessors(t){const n=this.index[t];if(!n)throw Error("Could not find node with name: "+t);return this.getOneWayEdges(n,!0)}getSuccessors(t){const n=this.index[t];if(!n)throw Error("Could not find node with name: "+t);return this.getOneWayEdges(n,!1)}getOneWayEdges(t,n){const r=[];if(!t.parentNode||!t.parentNode.isGroupNode)return r;const i=t.parentNode,a=i.metaGraph,o=this.getBridgeGraph(i.name);return Qy(a,t,n,r),Qy(o,t,n,r),r}}function nS(e,t){const{rankDirection:n,align:r}=t,i=new tS({rankdir:n,align:r});return function(a,o){Object.keys(o.nodes).forEach(s=>{const c=o.nodes[s],f=c.path;let d=a.root;d.depth=Math.max(f.length,d.depth);for(let h=0;h<f.length&&(d.depth=Math.max(d.depth,f.length-h),d.cardinality+=c.cardinality,h!==f.length-1);h++){const v=f[h];let m=a.node(v);m||(m=qy(v,a.graphOptions),m.path=c.path.slice(0,h+1),m.parentNode=d,a.setNode(v,m),d.metaGraph.setNode(v,m)),d=m}a.setNode(c.name,c),c.parentNode=d,d.metaGraph.setNode(c.name,c)})}(i,e),function(a,o){const s=a.getNodeMap();let c=[],f=[];const d=(h,v)=>{let m=0;for(;h;)v[m++]=h.name,h=h.parentNode;return m-1};o.edges.forEach(h=>{c=[],f=[];let v=d(o.nodes[h.v],c),m=d(o.nodes[h.w],f);for(;c[v]===f[m];)if(v--,m--,v<0||m<0)throw Error("No difference found between ancestor paths.");const g=s[c[v+1]],_=c[v],y=f[m];let E=g.metaGraph.edge(_,y);E||(E=Jy(_,y),g.metaGraph.setEdge(_,y,E)),E.addBaseEdge(h,a)})}(i,e),i}function Qy(e,t,n,r){(n?e.inEdges(t.name):e.outEdges(t.name)).forEach(i=>{const a=e.edge(i);r.push(a)})}class rS{constructor(t){this.hierarchy=t,this.index={},this.hasSubHierarchy={},this.root=new t1(this.hierarchy.root,this.hierarchy.graphOptions),this.index[t.root.name]=this.root,this.buildSubHierarchy(t.root.name),this.root.expanded=!0}getRenderInfoNodes(){return Object.values(this.index)}getSubHierarchy(){return this.hasSubHierarchy}buildSubHierarchy(t){if(t in this.hasSubHierarchy)return;this.hasSubHierarchy[t]=!0;const n=this.index[t];if(n.node.type!==ra.META)return;const r=n,i=r.node.metaGraph,a=r.coreGraph;i.nodes().forEach(d=>{const h=this.getOrCreateRenderNodeByName(d);a.setNode(d,h)}),i.edges().forEach(d=>{const h=i.edge(d),v=new e1(h);a.setEdge(d.v,d.w,v)});const o=r.node.parentNode;if(!o)return;const s=this.getRenderNodeByName(o.name),c=(d,...h)=>h.concat([d?"IN":"OUT"]).join("~~"),f=this.hierarchy.getBridgeGraph(t);f.edges().forEach(d=>{const h=f.edge(d),v=!!i.node(d.w),[m,g]=v?[d.w,d.v]:[d.v,d.w],_=R=>{const W=v?{v:R,w:t}:{v:t,w:R};return s.coreGraph.edge(W)};let y=_(g);y||(y=_(c(v,g,o.name)));const E=c(v,t),b=c(v,g,t);let A=a.node(b);if(!A){let R=a.node(E);if(!R){const te={name:E,type:ra.BRIDGE,isGroupNode:!1,cardinality:0,parentNode:null,include:ou.UNSPECIFIED,inbound:v,attr:{}};R=new N0(te),this.index[E]=R,a.setNode(E,R)}const W={name:b,type:ra.BRIDGE,isGroupNode:!1,cardinality:1,parentNode:null,include:ou.UNSPECIFIED,inbound:v,attr:{}};A=new N0(W),this.index[b]=A,a.setNode(b,A),a.setParent(b,E),R.node.cardinality++}const C=new e1(h);C.adjoiningMetaEdge=y,v?a.setEdge(b,m,C):a.setEdge(m,b,C)})}getOrCreateRenderNodeByName(t){if(!t)return null;if(t in this.index)return this.index[t];const n=this.getNodeByName(t);return n?(this.index[t]=n.isGroupNode?new t1(n,this.hierarchy.graphOptions):new N0(n),this.index[t]):null}getRenderNodeByName(t){return this.index[t]}getNodeByName(t){return this.hierarchy.node(t)}}class N0{constructor(t){this.node=t,this.expanded=!1,this.x=0,this.y=0,this.coreBox={width:0,height:0},this.outboxWidth=0,this.labelOffset=0,this.radius=0,this.labelHeight=0,this.paddingTop=0,this.paddingLeft=0,this.paddingRight=0,this.paddingBottom=0,this.width=t.width||0,this.height=t.height||0,this.displayName=t.name,this.attr=t.attr}}class e1{constructor(t){this.metaEdge=t,this.adjoiningMetaEdge=null,this.weight=1,this.points=[]}}class t1 extends N0{constructor(t,n){super(t);const r=t.metaGraph.graph();n.compound=!0,this.coreGraph=ly(r.name,su.CORE,n)}}function n1(e,t){e.node.isGroupNode&&function(n,r){const i=au(r);n.coreGraph.nodes().map(a=>n.coreGraph.node(a)).forEach(a=>{var o,s,c,f,d,h;const{height:v,width:m}=a;switch(a.node.type){case ra.NODE:Object.assign(a,i.nodeSize.node),a.height=v||i.nodeSize.node.height,a.width=m||i.nodeSize.node.width;break;case ra.BRIDGE:Object.assign(a,i.nodeSize.bridge);break;case ra.META:a.expanded?n1(a,r):(Object.assign(a,i.nodeSize.meta),a.height=i.nodeSize.meta.height,a.width=i.nodeSize.meta.width);break;default:throw Error("Unrecognized node type: "+a.node.type)}if(!a.expanded){const g=a.attr;(function(_,y=!1){if(_.coreBox.width=_.width,_.coreBox.height=_.height,!y){const E=`${_.displayName}`.length,b=3;_.width=Math.max(_.coreBox.width,E*b)}})(a,r&&(a.node.type===0&&!!((s=(o=r==null?void 0:r.nodeSize)===null||o===void 0?void 0:o.meta)===null||s===void 0?void 0:s.width)||a.node.type===1&&(!!((f=(c=r==null?void 0:r.nodeSize)===null||c===void 0?void 0:c.node)===null||f===void 0?void 0:f.width)||!!g.width)||a.node.type===2&&!!((h=(d=r==null?void 0:r.nodeSize)===null||d===void 0?void 0:d.bridge)===null||h===void 0?void 0:h.width)))}})}(e,t),e.node.type===ra.META&&function(n,r){const i=au(r),a=i.subScene.meta;Object.assign(n,a);const{nodeSep:o,rankSep:s,edgeSep:c,align:f}=i.graph.meta,d={nodesep:o,ranksep:s,edgesep:c,align:f};Object.assign(n.coreBox,function(m,g){const{ranksep:_,nodesep:y,edgesep:E,align:b}=g;Object.assign(m.graph(),{ranksep:_,nodesep:y,edgesep:E,align:b});const A=[];if(m.nodes().forEach(Q=>{m.node(Q).node.type!==ra.BRIDGE&&A.push(Q)}),!A.length)return{width:0,height:0};Yx(m);let C=1/0,R=1/0,W=-1/0,te=-1/0;return A.forEach(Q=>{const re=m.node(Q),de=.5*re.width,Ce=re.x-de,ie=re.x+de;C=Ce<C?Ce:C,W=ie>W?ie:W;const Ge=.5*re.height,We=re.y-Ge,It=re.y+Ge;R=We<R?We:R,te=It>te?It:te}),m.edges().forEach(Q=>{const re=m.edge(Q),de=m.node(re.metaEdge.v),Ce=m.node(re.metaEdge.w);if(re.points.length===3&&function(We){let It=r1(We[0],We[1]);for(let gn=1;gn<We.length-1;gn++){const pn=r1(We[gn],We[gn+1]);if(Math.abs(pn-It)>1)return!1;It=pn}return!0}(re.points)){if(de!=null){const We=de.expanded?de.x:dy(de);re.points[0].x=We}if(Ce!=null){const We=Ce.expanded?Ce.x:dy(Ce);re.points[2].x=We}re.points=[re.points[0],re.points[1]]}const ie=re.points[re.points.length-2];Ce!=null&&(re.points[re.points.length-1]=i1(ie,Ce));const Ge=re.points[1];de!=null&&(re.points[0]=i1(Ge,de)),re.points.forEach(We=>{C=We.x<C?We.x:C,W=We.x>W?We.x:W,R=We.y<R?We.y:R,te=We.y>te?We.y:te})}),m.nodes().forEach(Q=>{const re=m.node(Q);re.x-=C,re.y-=R}),m.edges().forEach(Q=>{m.edge(Q).points.forEach(re=>{re.x-=C,re.y-=R})}),{width:W-C,height:te-R}}(n.coreGraph,d));let h=0;n.coreGraph.nodeCount()>0&&h++;const v=h<=1?0:h;n.coreBox.width+=v+v,n.coreBox.height=a.labelHeight+n.coreBox.height,n.width=n.coreBox.width+a.paddingLeft+a.paddingRight,n.height=n.paddingTop+n.coreBox.height+n.paddingBottom}(e,t)}function r1(e,t){const n=t.x-e.x,r=t.y-e.y;return 180*Math.atan(r/n)/Math.PI}function dy(e){return e.expanded?e.x:e.x-e.width/2+0+e.coreBox.width/2}function i1(e,t){const n=t.expanded?t.x:dy(t),r=t.y,i=e.x-n,a=e.y-r;let o,s,c=t.expanded?t.width:t.coreBox.width,f=t.expanded?t.height:t.coreBox.height;return Math.abs(a)*c/2>Math.abs(i)*f/2?(a<0&&(f=-f),o=a===0?0:f/2*i/a,s=f/2):(i<0&&(c=-c),o=c/2,s=i===0?0:c/2*a/i),{x:n+o,y:r+s}}function iS(e,t,n){var r,i,a,o;const s=e.nodes.filter((h,v,m)=>m.findIndex(g=>g.id===h.id)!==v).map(h=>h.id);if(s.length)throw new Error(`Duplicated ids found: ${s.join(", ")}`);const c=function(h){const v={nodes:[]},m=h.compound,g=Object.keys(m||{}),_=new Map,y=(b,A=[])=>{if(_.has(b))return _.get(b);for(let C=0;C<g.length;C++){let R=g[C];if(m&&m[R].indexOf(b)!==-1)return A.unshift(R),y(R,A)}return A.length===0&&_.set(b,A),A},E=b=>h.edges.filter(A=>A.w===b).map(A=>({name:A.v}));return h.nodes.forEach(b=>{const A=b.id,C=[...y(A),A];let R=E(A);v.nodes.push({name:A,path:C,inputs:R,width:b.width,height:b.height,attr:Object.assign({},b)})}),v}(e),f=function(h,v){const m=(_,y)=>{for(let E of y.values())if(E.includes(_))return!0;return!1},g=(_,y=[])=>{if(Object.keys(_).length===0)return[...new Set(y)];const E=new Map(Object.keys(_).map(A=>[A,_[A]])),b={};for(let[A,C]of E)m(A,E)?b[A]=C:y=y.concat(A,C);return g(b,y)};return g(h).filter(_=>v.includes(_))}(e.compound||{},(t==null?void 0:t.expanded)||[]),d=function(h,v){return function(m){return new rS(m)}(nS(Jx(h),v))}(c,{rankDirection:((i=(r=n==null?void 0:n.graph)===null||r===void 0?void 0:r.meta)===null||i===void 0?void 0:i.rankDir)||(t==null?void 0:t.rankDirection)||iu.graph.meta.rankDir,align:((o=(a=n==null?void 0:n.graph)===null||a===void 0?void 0:a.meta)===null||o===void 0?void 0:o.align)||iu.graph.meta.align});return function(h,v){v.forEach(m=>{const g=h.getRenderInfoNodes().find(E=>E.displayName===m);let _=g&&g.node&&g.node.name||"";const y=h.getRenderNodeByName(_);if(!y)throw new Error(`No nodes found: ${_}`);y.expanded=!0,h.buildSubHierarchy(_)})}(d,f),n1(d.root,n),o1(d.root)}function aS(e,t=!1){const n=JSON.parse(JSON.stringify(e)),r={nodes:[n],edges:[...n.edges]};return n.nodes.forEach(function i(a){(a.type===0||a.type===1)&&r.nodes.push(a),a.type===0&&(r.edges=r.edges.concat(a.edges)),Array.isArray(a.nodes)&&a.nodes.forEach(i)}),t&&r.nodes.forEach(i=>{const a=r.nodes.find(o=>o.id===i.parentNodeName);if(a){const o=a.x-a.width/2+a.paddingLeft,s=a.y-a.height/2+a.labelHeight+a.paddingTop;a.id!==ro&&(i.x+=o,i.y+=s),i.type===0&&i.edges.forEach(c=>{c.points.forEach(f=>{f.x+=i.x-i.width/2+i.paddingLeft,f.y+=i.y-i.height/2+i.labelHeight+i.paddingTop})})}}),r}function a1(e,t,n,r){var i,a;let o=[];const s=((i=n.find(h=>h.id===e))===null||i===void 0?void 0:i.path)||[],c=((a=n.find(h=>h.id===t))===null||a===void 0?void 0:a.path)||[],f=[ro,...s].slice(0,s.length).reverse(),d=[ro,...c].slice(0,c.length);return f.forEach(h=>{const v=n.find(m=>m.id===h);o=o.concat(v.edges.filter(m=>m.baseEdgeList.some(g=>g.v===((r==null?void 0:r.v)||e)&&g.w===((r==null?void 0:r.w)||t))))}),d.filter(h=>!f.includes(h)).forEach(h=>{const v=n.find(m=>m.id===h);o=o.concat(v.edges.filter(m=>m.baseEdgeList.some(g=>g.v===((r==null?void 0:r.v)||e)&&g.w===((r==null?void 0:r.w)||t))))}),o}function o1(e){const t=e.coreGraph.nodes().map(r=>e.coreGraph.node(r));return Object.assign(Object.assign({},s1(e)),{expanded:e.expanded,nodes:e.expanded?(n=t,n.map(r=>r.node.type===ra.META?o1(r):s1(r))):[],edges:e.expanded?oS(e):[]});var n}function s1(e){return{id:e.node.name,name:e.node.name,type:e.node.type,cardinality:e.node.cardinality,attr:e.attr,parentNodeName:e.node.parentNode?e.node.parentNode.name:null,coreBox:Object.assign({},e.coreBox),x:e.x,y:e.y,width:e.width,height:e.height,radius:e.radius,labelHeight:e.labelHeight,labelOffset:e.labelOffset,outboxWidth:e.outboxWidth,paddingLeft:e.paddingLeft,paddingTop:e.paddingTop,paddingRight:e.paddingRight,paddingBottom:e.paddingBottom,path:e.node.path}}function oS(e){return e.coreGraph.edges().map(t=>({renderInfoEdge:e.coreGraph.edge(t),edge:t})).filter(({renderInfoEdge:t})=>t.metaEdge).map(({edge:t,renderInfoEdge:n})=>{const r=function(i,a){const o=a.points.map(s=>Object.assign({},s));if(a.adjoiningMetaEdge){const s=a.adjoiningMetaEdge.points,c=a.metaEdge.inbound,f=c?s[s.length-1]:s[0],d=o[c?0:o.length-1],h=i.x-i.width/2,v=i.y-i.height/2,m=f.x-h,g=f.y-v,_=-i.paddingLeft,y=-(i.paddingTop+i.labelHeight);d.x=m+_,d.y=g+y}return o}(e,n);return{adjoiningEdge:n.adjoiningMetaEdge?{w:n.adjoiningMetaEdge.metaEdge.w,v:n.adjoiningMetaEdge.metaEdge.v}:null,inbound:n.metaEdge.inbound,w:t.w,v:t.v,points:r,weight:n.weight,baseEdgeList:n.metaEdge.baseEdgeList,parentNodeName:e.node.name}})}class sS extends jt{constructor(t){super();this.rankdir="TB",this.nodesep=50,this.edgesep=5,this.ranksep=50,this.controlPoints=!0,this.anchorPoint=!0,this.nodes=[],this.edges=[],this.combos=[],this.onLayoutEnd=()=>{},this.updateCfg(t)}getDefaultCfg(){return{rankdir:"TB",align:void 0,begin:void 0,nodeSize:void 0,nodesep:50,ranksep:50,controlPoints:!0,anchorPoint:!0}}init(t){const n=t.hiddenNodes||[],r=t.hiddenEdges||[],i=t.hiddenCombos||[];this.nodes=this.getDataByOrder((t.nodes||[]).concat(n)),this.edges=this.getDataByOrder((t.edges||[]).concat(r)),this.combos=(t.combos||[]).concat(i.map(a=>Object.assign(Object.assign({},a),{collapsed:!0})))}execute(){const t=this,{nodes:n,edges:r}=t;if(!n)return;const{graphDef:i,graphOption:a,graphSettings:o}=t.getLayoutConfig(),s=iS(i,a,o),c=aS(s,!0);return this.updatePosition(c),t.onLayoutEnd&&t.onLayoutEnd(),{nodes:n,edges:r}}getNodePath(t){const n=this,{nodes:r,combos:i}=n,a=r.find(s=>s.id===t),o=(s,c=[])=>{const f=i.find(d=>d.id===s);return f?(c.unshift(s),f.parentId?o(f.parentId,c):c):c};return a&&a.comboId?o(a.comboId,[t]):[t]}getLayoutConfig(){var t,n,r;const i=this,{nodes:a,edges:o,combos:s,nodeSize:c,rankdir:f,align:d,edgesep:h,nodesep:v,ranksep:m,settings:g}=i,_=(s||[]).reduce((Ge,We)=>{const It=a.filter(pn=>pn.comboId===We.id).map(pn=>pn.id),gn=(s||[]).filter(pn=>pn.parentId===We.id).map(pn=>pn.id);return(It.length||gn.length)&&(Ge[We.id]=[...It,...gn]),Ge},{});let y;c?H(c)?y=()=>c:y=()=>[c,c]:y=Ge=>Ge&&Ge.size?H(Ge.size)?Ge.size:me(Ge.size)?[Ge.size.width||40,Ge.size.height||40]:[Ge.size,Ge.size]:[40,40];const E=Ge=>Ge&&Ge.size?H(Ge.size)?Ge.size:[Ge.size,Ge.size]:[80,40],[b,A]=E(s==null?void 0:s[0]),C=(n=(t=i.graphSettings)===null||t===void 0?void 0:t.subScene)===null||n===void 0?void 0:n.meta,[R,W,te,Q]=((r=s.find(Ge=>!Ge.collapsed))===null||r===void 0?void 0:r.padding)||[20,20,20,20],re={compound:_,nodes:[...(a||[]).map(Ge=>{const We=y(Ge),It=We[0],gn=We[1];return Object.assign(Object.assign({},Ge),{width:It,height:gn})})],edges:[...(o||[]).map(Ge=>Object.assign(Object.assign({},Ge),{v:Ge.source,w:Ge.target}))]},de={expanded:(s||[]).filter(Ge=>!Ge.collapsed).map(Ge=>Ge.id)},Ce={graph:{meta:{align:d,rankDir:f,nodeSep:v,edgeSep:h,rankSep:m}},subScene:{meta:{paddingTop:R||(C==null?void 0:C.paddingTop)||20,paddingRight:W||(C==null?void 0:C.paddingRight)||20,paddingBottom:te||(C==null?void 0:C.paddingBottom)||20,paddingLeft:Q||(C==null?void 0:C.paddingLeft)||20,labelHeight:0}},nodeSize:{meta:{width:b,height:A}}},ie=au(g,Object.assign({},au(Ce,iu)));return i.graphSettings=ie,{graphDef:re,graphOption:de,graphSettings:ie}}updatePosition(t){const{nodes:n,edges:r}=t;this.updateNodePosition(n,r),this.updateEdgePosition(n,r)}getBegin(t,n){const r=this,{begin:i}=r,a=[0,0];if(i){let o=Infinity,s=Infinity;t.forEach(c=>{o>c.x&&(o=c.x),s>c.y&&(s=c.y)}),n.forEach(c=>{c.points.forEach(f=>{o>f.x&&(o=f.x),s>f.y&&(s=f.y)})}),a[0]=i[0]-o,a[1]=i[1]-s}return a}updateNodePosition(t,n){const r=this,{combos:i,nodes:a,edges:o,anchorPoint:s,graphSettings:c}=r,f=this.getBegin(t,n);t.forEach(d=>{var h;const{x:v,y:m,id:g,type:_,coreBox:y}=d;if(_===Uc.META&&g!==ro){const E=i.findIndex(A=>A.id===g),b=(h=c==null?void 0:c.subScene)===null||h===void 0?void 0:h.meta;i[E].offsetX=v+f[0],i[E].offsetY=m+f[1],i[E].fixSize=[y.width,y.height],i[E].fixCollapseSize=[y.width,y.height],d.expanded?i[E].padding=[b==null?void 0:b.paddingTop,b==null?void 0:b.paddingRight,b==null?void 0:b.paddingBottom,b==null?void 0:b.paddingLeft]:i[E].padding=[0,0,0,0]}else if(_===Uc.OP){const E=a.findIndex(b=>b.id===g);if(a[E].x=v+f[0],a[E].y=m+f[1],s){const b=[],A=n.filter(R=>R.v===g),C=n.filter(R=>R.w===g);A.length>0&&A.forEach(R=>{const W=R.points[0],te=(W.x-v)/d.width+.5,Q=(W.y-m)/d.height+.5;b.push([te,Q]),R.baseEdgeList.forEach(re=>{const de=o.find(Ce=>Ce.source===re.v&&Ce.target===re.w);de&&(de.sourceAnchor=b.length-1)})}),C.length>0&&C.forEach(R=>{const W=R.points[R.points.length-1],te=(W.x-v)/d.width+.5,Q=(W.y-m)/d.height+.5;b.push([te,Q]),R.baseEdgeList.forEach(re=>{const de=o.find(Ce=>Ce.source===re.v&&Ce.target===re.w);de&&(de.targetAnchor=b.length-1)})}),a[E].anchorPoints=b.length>0?b:a[E].anchorPoints||[]}}})}updateEdgePosition(t,n){const r=this,{combos:i,edges:a,controlPoints:o}=r,s=this.getBegin(t,n);o&&(i.forEach(c=>{c.inEdges=[],c.outEdges=[]}),a.forEach(c=>{var f,d,h,v;let m=t.find(E=>E.id===c.source),g=t.find(E=>E.id===c.target),_=[],y=[];if(m&&g)y=a1(m==null?void 0:m.id,g==null?void 0:g.id,t);else if(!m||!g){const E=r.getNodePath(c.source),b=r.getNodePath(c.target),A=E.reverse().slice(m?0:1).find(R=>t.find(W=>W.id===R)),C=b.reverse().slice(g?0:1).find(R=>t.find(W=>W.id===R));m=t.find(R=>R.id===A),g=t.find(R=>R.id===C),y=a1(m==null?void 0:m.id,g==null?void 0:g.id,t,{v:c.source,w:c.target})}if(_=y.reduce((E,b)=>[...E,...b.points.map(A=>Object.assign(Object.assign({},A),{x:A.x+s[0],y:A.y+s[1]}))],[]),_=_.slice(1,-1),c.controlPoints=_,(g==null?void 0:g.type)===ra.META){const E=i.findIndex(b=>b.id===(g==null?void 0:g.id));if(!i[E]||((f=i[E].inEdges)===null||f===void 0?void 0:f.some(b=>b.source===m.id&&b.target===g.id)))return;(d=i[E].inEdges)===null||d===void 0||d.push({source:m.id,target:g.id,controlPoints:_})}if((m==null?void 0:m.type)===ra.META){const E=i.findIndex(b=>b.id===(m==null?void 0:m.id));if(!i[E]||((h=i[E].outEdges)===null||h===void 0?void 0:h.some(b=>b.source===m.id&&b.target===g.id)))return;(v=i[E].outEdges)===null||v===void 0||v.push({source:m.id,target:g.id,controlPoints:_})}}))}getType(){return"dagreCompound"}getDataByOrder(t){return t.every(n=>n.layoutOrder!==void 0)||t.forEach((n,r)=>{n.layoutOrder=r}),t.sort((n,r)=>n.layoutOrder-r.layoutOrder)}}var uS=S(79320),u1=S(81306),c1=S(59206),D0=S(69610),P0=S(54941);const cS=Object.prototype.toString;function fs(e){return cS.call(e).endsWith("Array]")}function fS(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!fs(e))throw new TypeError("input must be an array");if(e.length===0)throw new TypeError("input must not be empty");var n=t.fromIndex,r=n===void 0?0:n,i=t.toIndex,a=i===void 0?e.length:i;if(r<0||r>=e.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=r||a>e.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var o=e[r],s=r+1;s<a;s++)e[s]>o&&(o=e[s]);return o}function lS(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!fs(e))throw new TypeError("input must be an array");if(e.length===0)throw new TypeError("input must not be empty");var n=t.fromIndex,r=n===void 0?0:n,i=t.toIndex,a=i===void 0?e.length:i;if(r<0||r>=e.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=r||a>e.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var o=e[r],s=r+1;s<a;s++)e[s]<o&&(o=e[s]);return o}function f1(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(fs(e)){if(e.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var n;if(t.output!==void 0){if(!fs(t.output))throw new TypeError("output option must be an array if specified");n=t.output}else n=new Array(e.length);var r=lS(e),i=fS(e);if(r===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var a=t.min,o=a===void 0?t.autoMinMax?r:0:a,s=t.max,c=s===void 0?t.autoMinMax?i:1:s;if(o>=c)throw new RangeError("min option must be smaller than max option");for(var f=(c-o)/(i-r),d=0;d<e.length;d++)n[d]=(e[d]-r)*f+o;return n}var O0=" ".repeat(2),l1=" ".repeat(4);function dS(){return d1(this)}function d1(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.maxRows,r=n===void 0?15:n,i=t.maxColumns,a=i===void 0?10:i,o=t.maxNumSize,s=o===void 0?8:o;return"".concat(e.constructor.name,` {
`).concat(O0,`[
`).concat(l1).concat(hS(e,r,a,s),`
`).concat(O0,`]
`).concat(O0,"rows: ").concat(e.rows,`
`).concat(O0,"columns: ").concat(e.columns,`
}`)}function hS(e,t,n,r){for(var i=e.rows,a=e.columns,o=Math.min(i,t),s=Math.min(a,n),c=[],f=0;f<o;f++){for(var d=[],h=0;h<s;h++)d.push(vS(e.get(f,h),r));c.push("".concat(d.join(" ")))}return s!==a&&(c[c.length-1]+=" ... ".concat(a-n," more columns")),o!==i&&c.push("... ".concat(i-t," more rows")),c.join(`
`.concat(l1))}function vS(e,t){var n=String(e);if(n.length<=t)return n.padEnd(t," ");var r=e.toPrecision(t-2);if(r.length<=t)return r;var i=e.toExponential(t-2),a=i.indexOf("e"),o=i.slice(a);return i.slice(0,t-o.length)+o}function pS(e,t){e.prototype.add=function(r){return typeof r=="number"?this.addS(r):this.addM(r)},e.prototype.addS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)+r);return this},e.prototype.addM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)+r.get(i,a));return this},e.add=function(r,i){var a=new t(r);return a.add(i)},e.prototype.sub=function(r){return typeof r=="number"?this.subS(r):this.subM(r)},e.prototype.subS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)-r);return this},e.prototype.subM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)-r.get(i,a));return this},e.sub=function(r,i){var a=new t(r);return a.sub(i)},e.prototype.subtract=e.prototype.sub,e.prototype.subtractS=e.prototype.subS,e.prototype.subtractM=e.prototype.subM,e.subtract=e.sub,e.prototype.mul=function(r){return typeof r=="number"?this.mulS(r):this.mulM(r)},e.prototype.mulS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)*r);return this},e.prototype.mulM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)*r.get(i,a));return this},e.mul=function(r,i){var a=new t(r);return a.mul(i)},e.prototype.multiply=e.prototype.mul,e.prototype.multiplyS=e.prototype.mulS,e.prototype.multiplyM=e.prototype.mulM,e.multiply=e.mul,e.prototype.div=function(r){return typeof r=="number"?this.divS(r):this.divM(r)},e.prototype.divS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)/r);return this},e.prototype.divM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)/r.get(i,a));return this},e.div=function(r,i){var a=new t(r);return a.div(i)},e.prototype.divide=e.prototype.div,e.prototype.divideS=e.prototype.divS,e.prototype.divideM=e.prototype.divM,e.divide=e.div,e.prototype.mod=function(r){return typeof r=="number"?this.modS(r):this.modM(r)},e.prototype.modS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)%r);return this},e.prototype.modM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)%r.get(i,a));return this},e.mod=function(r,i){var a=new t(r);return a.mod(i)},e.prototype.modulus=e.prototype.mod,e.prototype.modulusS=e.prototype.modS,e.prototype.modulusM=e.prototype.modM,e.modulus=e.mod,e.prototype.and=function(r){return typeof r=="number"?this.andS(r):this.andM(r)},e.prototype.andS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)&r);return this},e.prototype.andM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)&r.get(i,a));return this},e.and=function(r,i){var a=new t(r);return a.and(i)},e.prototype.or=function(r){return typeof r=="number"?this.orS(r):this.orM(r)},e.prototype.orS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)|r);return this},e.prototype.orM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)|r.get(i,a));return this},e.or=function(r,i){var a=new t(r);return a.or(i)},e.prototype.xor=function(r){return typeof r=="number"?this.xorS(r):this.xorM(r)},e.prototype.xorS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)^r);return this},e.prototype.xorM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)^r.get(i,a));return this},e.xor=function(r,i){var a=new t(r);return a.xor(i)},e.prototype.leftShift=function(r){return typeof r=="number"?this.leftShiftS(r):this.leftShiftM(r)},e.prototype.leftShiftS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)<<r);return this},e.prototype.leftShiftM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)<<r.get(i,a));return this},e.leftShift=function(r,i){var a=new t(r);return a.leftShift(i)},e.prototype.signPropagatingRightShift=function(r){return typeof r=="number"?this.signPropagatingRightShiftS(r):this.signPropagatingRightShiftM(r)},e.prototype.signPropagatingRightShiftS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)>>r);return this},e.prototype.signPropagatingRightShiftM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)>>r.get(i,a));return this},e.signPropagatingRightShift=function(r,i){var a=new t(r);return a.signPropagatingRightShift(i)},e.prototype.rightShift=function(r){return typeof r=="number"?this.rightShiftS(r):this.rightShiftM(r)},e.prototype.rightShiftS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)>>>r);return this},e.prototype.rightShiftM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)>>>r.get(i,a));return this},e.rightShift=function(r,i){var a=new t(r);return a.rightShift(i)},e.prototype.zeroFillRightShift=e.prototype.rightShift,e.prototype.zeroFillRightShiftS=e.prototype.rightShiftS,e.prototype.zeroFillRightShiftM=e.prototype.rightShiftM,e.zeroFillRightShift=e.rightShift,e.prototype.not=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,~this.get(r,i));return this},e.not=function(r){var i=new t(r);return i.not()},e.prototype.abs=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.abs(this.get(r,i)));return this},e.abs=function(r){var i=new t(r);return i.abs()},e.prototype.acos=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.acos(this.get(r,i)));return this},e.acos=function(r){var i=new t(r);return i.acos()},e.prototype.acosh=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.acosh(this.get(r,i)));return this},e.acosh=function(r){var i=new t(r);return i.acosh()},e.prototype.asin=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.asin(this.get(r,i)));return this},e.asin=function(r){var i=new t(r);return i.asin()},e.prototype.asinh=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.asinh(this.get(r,i)));return this},e.asinh=function(r){var i=new t(r);return i.asinh()},e.prototype.atan=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.atan(this.get(r,i)));return this},e.atan=function(r){var i=new t(r);return i.atan()},e.prototype.atanh=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.atanh(this.get(r,i)));return this},e.atanh=function(r){var i=new t(r);return i.atanh()},e.prototype.cbrt=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.cbrt(this.get(r,i)));return this},e.cbrt=function(r){var i=new t(r);return i.cbrt()},e.prototype.ceil=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.ceil(this.get(r,i)));return this},e.ceil=function(r){var i=new t(r);return i.ceil()},e.prototype.clz32=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.clz32(this.get(r,i)));return this},e.clz32=function(r){var i=new t(r);return i.clz32()},e.prototype.cos=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.cos(this.get(r,i)));return this},e.cos=function(r){var i=new t(r);return i.cos()},e.prototype.cosh=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.cosh(this.get(r,i)));return this},e.cosh=function(r){var i=new t(r);return i.cosh()},e.prototype.exp=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.exp(this.get(r,i)));return this},e.exp=function(r){var i=new t(r);return i.exp()},e.prototype.expm1=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.expm1(this.get(r,i)));return this},e.expm1=function(r){var i=new t(r);return i.expm1()},e.prototype.floor=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.floor(this.get(r,i)));return this},e.floor=function(r){var i=new t(r);return i.floor()},e.prototype.fround=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.fround(this.get(r,i)));return this},e.fround=function(r){var i=new t(r);return i.fround()},e.prototype.log=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.log(this.get(r,i)));return this},e.log=function(r){var i=new t(r);return i.log()},e.prototype.log1p=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.log1p(this.get(r,i)));return this},e.log1p=function(r){var i=new t(r);return i.log1p()},e.prototype.log10=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.log10(this.get(r,i)));return this},e.log10=function(r){var i=new t(r);return i.log10()},e.prototype.log2=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.log2(this.get(r,i)));return this},e.log2=function(r){var i=new t(r);return i.log2()},e.prototype.round=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.round(this.get(r,i)));return this},e.round=function(r){var i=new t(r);return i.round()},e.prototype.sign=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.sign(this.get(r,i)));return this},e.sign=function(r){var i=new t(r);return i.sign()},e.prototype.sin=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.sin(this.get(r,i)));return this},e.sin=function(r){var i=new t(r);return i.sin()},e.prototype.sinh=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.sinh(this.get(r,i)));return this},e.sinh=function(r){var i=new t(r);return i.sinh()},e.prototype.sqrt=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.sqrt(this.get(r,i)));return this},e.sqrt=function(r){var i=new t(r);return i.sqrt()},e.prototype.tan=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.tan(this.get(r,i)));return this},e.tan=function(r){var i=new t(r);return i.tan()},e.prototype.tanh=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.tanh(this.get(r,i)));return this},e.tanh=function(r){var i=new t(r);return i.tanh()},e.prototype.trunc=function(){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,Math.trunc(this.get(r,i)));return this},e.trunc=function(r){var i=new t(r);return i.trunc()},e.pow=function(r,i){var a=new t(r);return a.pow(i)},e.prototype.pow=function(r){return typeof r=="number"?this.powS(r):this.powM(r)},e.prototype.powS=function(r){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,Math.pow(this.get(i,a),r));return this},e.prototype.powM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.set(i,a,Math.pow(this.get(i,a),r.get(i,a)));return this}}function gu(e,t,n){var r=n?e.rows:e.rows-1;if(t<0||t>r)throw new RangeError("Row index out of range")}function yu(e,t,n){var r=n?e.columns:e.columns-1;if(t<0||t>r)throw new RangeError("Column index out of range")}function ph(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw new RangeError("vector size must be the same as the number of columns");return t}function mh(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw new RangeError("vector size must be the same as the number of rows");return t}function mS(e,t){if(!fs(t))throw new TypeError("row indices must be an array");for(var n=0;n<t.length;n++)if(t[n]<0||t[n]>=e.rows)throw new RangeError("row indices are out of range")}function gS(e,t){if(!fs(t))throw new TypeError("column indices must be an array");for(var n=0;n<t.length;n++)if(t[n]<0||t[n]>=e.columns)throw new RangeError("column indices are out of range")}function h1(e,t,n,r,i){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(G0("startRow",t),G0("endRow",n),G0("startColumn",r),G0("endColumn",i),t>n||r>i||t<0||t>=e.rows||n<0||n>=e.rows||r<0||r>=e.columns||i<0||i>=e.columns)throw new RangeError("Submatrix indices are out of range")}function L0(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=[],r=0;r<e;r++)n.push(t);return n}function G0(e,t){if(typeof t!="number")throw new TypeError("".concat(e," must be a number"))}function gh(e){if(e.isEmpty())throw new Error("Empty matrix has no elements to index")}function yS(e){for(var t=L0(e.rows),n=0;n<e.rows;++n)for(var r=0;r<e.columns;++r)t[n]+=e.get(n,r);return t}function _S(e){for(var t=L0(e.columns),n=0;n<e.rows;++n)for(var r=0;r<e.columns;++r)t[r]+=e.get(n,r);return t}function ES(e){for(var t=0,n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)t+=e.get(n,r);return t}function bS(e){for(var t=L0(e.rows,1),n=0;n<e.rows;++n)for(var r=0;r<e.columns;++r)t[n]*=e.get(n,r);return t}function wS(e){for(var t=L0(e.columns,1),n=0;n<e.rows;++n)for(var r=0;r<e.columns;++r)t[r]*=e.get(n,r);return t}function xS(e){for(var t=1,n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)t*=e.get(n,r);return t}function SS(e,t,n){for(var r=e.rows,i=e.columns,a=[],o=0;o<r;o++){for(var s=0,c=0,f=0,d=0;d<i;d++)f=e.get(o,d)-n[o],s+=f,c+=f*f;t?a.push((c-s*s/i)/(i-1)):a.push((c-s*s/i)/i)}return a}function TS(e,t,n){for(var r=e.rows,i=e.columns,a=[],o=0;o<i;o++){for(var s=0,c=0,f=0,d=0;d<r;d++)f=e.get(d,o)-n[o],s+=f,c+=f*f;t?a.push((c-s*s/r)/(r-1)):a.push((c-s*s/r)/r)}return a}function AS(e,t,n){for(var r=e.rows,i=e.columns,a=r*i,o=0,s=0,c=0,f=0;f<r;f++)for(var d=0;d<i;d++)c=e.get(f,d)-n,o+=c,s+=c*c;return t?(s-o*o/a)/(a-1):(s-o*o/a)/a}function IS(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t[n])}function CS(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t[r])}function RS(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t)}function MS(e){for(var t=[],n=0;n<e.rows;n++){for(var r=0,i=0;i<e.columns;i++)r+=Math.pow(e.get(n,i),2)/(e.columns-1);t.push(Math.sqrt(r))}return t}function NS(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t[n])}function DS(e){for(var t=[],n=0;n<e.columns;n++){for(var r=0,i=0;i<e.rows;i++)r+=Math.pow(e.get(i,n),2)/(e.rows-1);t.push(Math.sqrt(r))}return t}function PS(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t[r])}function OS(e){for(var t=e.size-1,n=0,r=0;r<e.columns;r++)for(var i=0;i<e.rows;i++)n+=Math.pow(e.get(i,r),2)/t;return Math.sqrt(n)}function LS(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t)}var da=function(){function e(){(0,D0.Z)(this,e)}return(0,P0.Z)(e,[{key:"size",get:function(){return this.rows*this.columns}},{key:"apply",value:function(n){if(typeof n!="function")throw new TypeError("callback must be a function");for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)n.call(this,r,i);return this}},{key:"to1DArray",value:function(){for(var n=[],r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)n.push(this.get(r,i));return n}},{key:"to2DArray",value:function(){for(var n=[],r=0;r<this.rows;r++){n.push([]);for(var i=0;i<this.columns;i++)n[r].push(this.get(r,i))}return n}},{key:"toJSON",value:function(){return this.to2DArray()}},{key:"isRowVector",value:function(){return this.rows===1}},{key:"isColumnVector",value:function(){return this.columns===1}},{key:"isVector",value:function(){return this.rows===1||this.columns===1}},{key:"isSquare",value:function(){return this.rows===this.columns}},{key:"isEmpty",value:function(){return this.rows===0||this.columns===0}},{key:"isSymmetric",value:function(){if(this.isSquare()){for(var n=0;n<this.rows;n++)for(var r=0;r<=n;r++)if(this.get(n,r)!==this.get(r,n))return!1;return!0}return!1}},{key:"isEchelonForm",value:function(){for(var n=0,r=0,i=-1,a=!0,o=!1;n<this.rows&&a;){for(r=0,o=!1;r<this.columns&&o===!1;)this.get(n,r)===0?r++:this.get(n,r)===1&&r>i?(o=!0,i=r):(a=!1,o=!0);n++}return a}},{key:"isReducedEchelonForm",value:function(){for(var n=0,r=0,i=-1,a=!0,o=!1;n<this.rows&&a;){for(r=0,o=!1;r<this.columns&&o===!1;)this.get(n,r)===0?r++:this.get(n,r)===1&&r>i?(o=!0,i=r):(a=!1,o=!0);for(var s=r+1;s<this.rows;s++)this.get(n,s)!==0&&(a=!1);n++}return a}},{key:"echelonForm",value:function(){for(var n=this.clone(),r=0,i=0;r<n.rows&&i<n.columns;){for(var a=r,o=r;o<n.rows;o++)n.get(o,i)>n.get(a,i)&&(a=o);if(n.get(a,i)===0)i++;else{n.swapRows(r,a);for(var s=n.get(r,i),c=i;c<n.columns;c++)n.set(r,c,n.get(r,c)/s);for(var f=r+1;f<n.rows;f++){var d=n.get(f,i)/n.get(r,i);n.set(f,i,0);for(var h=i+1;h<n.columns;h++)n.set(f,h,n.get(f,h)-n.get(r,h)*d)}r++,i++}}return n}},{key:"reducedEchelonForm",value:function(){for(var n=this.echelonForm(),r=n.columns,i=n.rows,a=i-1;a>=0;)if(n.maxRow(a)===0)a--;else{for(var o=0,s=!1;o<i&&s===!1;)n.get(a,o)===1?s=!0:o++;for(var c=0;c<a;c++)for(var f=n.get(c,o),d=o;d<r;d++){var h=n.get(c,d)-f*n.get(a,d);n.set(c,d,h)}a--}return n}},{key:"set",value:function(){throw new Error("set method is unimplemented")}},{key:"get",value:function(){throw new Error("get method is unimplemented")}},{key:"repeat",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof n!="object")throw new TypeError("options must be an object");var r=n.rows,i=r===void 0?1:r,a=n.columns,o=a===void 0?1:a;if(!Number.isInteger(i)||i<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(o)||o<=0)throw new TypeError("columns must be a positive integer");for(var s=new Wn(this.rows*i,this.columns*o),c=0;c<i;c++)for(var f=0;f<o;f++)s.setSubMatrix(this,this.rows*c,this.columns*f);return s}},{key:"fill",value:function(n){for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,n);return this}},{key:"neg",value:function(){return this.mulS(-1)}},{key:"getRow",value:function(n){gu(this,n);for(var r=[],i=0;i<this.columns;i++)r.push(this.get(n,i));return r}},{key:"getRowVector",value:function(n){return Wn.rowVector(this.getRow(n))}},{key:"setRow",value:function(n,r){gu(this,n),r=ph(this,r);for(var i=0;i<this.columns;i++)this.set(n,i,r[i]);return this}},{key:"swapRows",value:function(n,r){gu(this,n),gu(this,r);for(var i=0;i<this.columns;i++){var a=this.get(n,i);this.set(n,i,this.get(r,i)),this.set(r,i,a)}return this}},{key:"getColumn",value:function(n){yu(this,n);for(var r=[],i=0;i<this.rows;i++)r.push(this.get(i,n));return r}},{key:"getColumnVector",value:function(n){return Wn.columnVector(this.getColumn(n))}},{key:"setColumn",value:function(n,r){yu(this,n),r=mh(this,r);for(var i=0;i<this.rows;i++)this.set(i,n,r[i]);return this}},{key:"swapColumns",value:function(n,r){yu(this,n),yu(this,r);for(var i=0;i<this.rows;i++){var a=this.get(i,n);this.set(i,n,this.get(i,r)),this.set(i,r,a)}return this}},{key:"addRowVector",value:function(n){n=ph(this,n);for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)+n[i]);return this}},{key:"subRowVector",value:function(n){n=ph(this,n);for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)-n[i]);return this}},{key:"mulRowVector",value:function(n){n=ph(this,n);for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)*n[i]);return this}},{key:"divRowVector",value:function(n){n=ph(this,n);for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)/n[i]);return this}},{key:"addColumnVector",value:function(n){n=mh(this,n);for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)+n[r]);return this}},{key:"subColumnVector",value:function(n){n=mh(this,n);for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)-n[r]);return this}},{key:"mulColumnVector",value:function(n){n=mh(this,n);for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)*n[r]);return this}},{key:"divColumnVector",value:function(n){n=mh(this,n);for(var r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)/n[r]);return this}},{key:"mulRow",value:function(n,r){gu(this,n);for(var i=0;i<this.columns;i++)this.set(n,i,this.get(n,i)*r);return this}},{key:"mulColumn",value:function(n,r){yu(this,n);for(var i=0;i<this.rows;i++)this.set(i,n,this.get(i,n)*r);return this}},{key:"max",value:function(n){if(this.isEmpty())return NaN;switch(n){case"row":{for(var r=new Array(this.rows).fill(Number.NEGATIVE_INFINITY),i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.get(i,a)>r[i]&&(r[i]=this.get(i,a));return r}case"column":{for(var o=new Array(this.columns).fill(Number.NEGATIVE_INFINITY),s=0;s<this.rows;s++)for(var c=0;c<this.columns;c++)this.get(s,c)>o[c]&&(o[c]=this.get(s,c));return o}case void 0:{for(var f=this.get(0,0),d=0;d<this.rows;d++)for(var h=0;h<this.columns;h++)this.get(d,h)>f&&(f=this.get(d,h));return f}default:throw new Error("invalid option: ".concat(n))}}},{key:"maxIndex",value:function(){gh(this);for(var n=this.get(0,0),r=[0,0],i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.get(i,a)>n&&(n=this.get(i,a),r[0]=i,r[1]=a);return r}},{key:"min",value:function(n){if(this.isEmpty())return NaN;switch(n){case"row":{for(var r=new Array(this.rows).fill(Number.POSITIVE_INFINITY),i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.get(i,a)<r[i]&&(r[i]=this.get(i,a));return r}case"column":{for(var o=new Array(this.columns).fill(Number.POSITIVE_INFINITY),s=0;s<this.rows;s++)for(var c=0;c<this.columns;c++)this.get(s,c)<o[c]&&(o[c]=this.get(s,c));return o}case void 0:{for(var f=this.get(0,0),d=0;d<this.rows;d++)for(var h=0;h<this.columns;h++)this.get(d,h)<f&&(f=this.get(d,h));return f}default:throw new Error("invalid option: ".concat(n))}}},{key:"minIndex",value:function(){gh(this);for(var n=this.get(0,0),r=[0,0],i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)this.get(i,a)<n&&(n=this.get(i,a),r[0]=i,r[1]=a);return r}},{key:"maxRow",value:function(n){if(gu(this,n),this.isEmpty())return NaN;for(var r=this.get(n,0),i=1;i<this.columns;i++)this.get(n,i)>r&&(r=this.get(n,i));return r}},{key:"maxRowIndex",value:function(n){gu(this,n),gh(this);for(var r=this.get(n,0),i=[n,0],a=1;a<this.columns;a++)this.get(n,a)>r&&(r=this.get(n,a),i[1]=a);return i}},{key:"minRow",value:function(n){if(gu(this,n),this.isEmpty())return NaN;for(var r=this.get(n,0),i=1;i<this.columns;i++)this.get(n,i)<r&&(r=this.get(n,i));return r}},{key:"minRowIndex",value:function(n){gu(this,n),gh(this);for(var r=this.get(n,0),i=[n,0],a=1;a<this.columns;a++)this.get(n,a)<r&&(r=this.get(n,a),i[1]=a);return i}},{key:"maxColumn",value:function(n){if(yu(this,n),this.isEmpty())return NaN;for(var r=this.get(0,n),i=1;i<this.rows;i++)this.get(i,n)>r&&(r=this.get(i,n));return r}},{key:"maxColumnIndex",value:function(n){yu(this,n),gh(this);for(var r=this.get(0,n),i=[0,n],a=1;a<this.rows;a++)this.get(a,n)>r&&(r=this.get(a,n),i[0]=a);return i}},{key:"minColumn",value:function(n){if(yu(this,n),this.isEmpty())return NaN;for(var r=this.get(0,n),i=1;i<this.rows;i++)this.get(i,n)<r&&(r=this.get(i,n));return r}},{key:"minColumnIndex",value:function(n){yu(this,n),gh(this);for(var r=this.get(0,n),i=[0,n],a=1;a<this.rows;a++)this.get(a,n)<r&&(r=this.get(a,n),i[0]=a);return i}},{key:"diag",value:function(){for(var n=Math.min(this.rows,this.columns),r=[],i=0;i<n;i++)r.push(this.get(i,i));return r}},{key:"norm",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"frobenius",r=0;if(n==="max")return this.max();if(n==="frobenius"){for(var i=0;i<this.rows;i++)for(var a=0;a<this.columns;a++)r=r+this.get(i,a)*this.get(i,a);return Math.sqrt(r)}else throw new RangeError("unknown norm type: ".concat(n))}},{key:"cumulativeSum",value:function(){for(var n=0,r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)n+=this.get(r,i),this.set(r,i,n);return this}},{key:"dot",value:function(n){e.isMatrix(n)&&(n=n.to1DArray());var r=this.to1DArray();if(r.length!==n.length)throw new RangeError("vectors do not have the same size");for(var i=0,a=0;a<r.length;a++)i+=r[a]*n[a];return i}},{key:"mmul",value:function(n){n=Wn.checkMatrix(n);for(var r=this.rows,i=this.columns,a=n.columns,o=new Wn(r,a),s=new Float64Array(i),c=0;c<a;c++){for(var f=0;f<i;f++)s[f]=n.get(f,c);for(var d=0;d<r;d++){for(var h=0,v=0;v<i;v++)h+=this.get(d,v)*s[v];o.set(d,c,h)}}return o}},{key:"strassen2x2",value:function(n){n=Wn.checkMatrix(n);var r=new Wn(2,2),i=this.get(0,0),a=n.get(0,0),o=this.get(0,1),s=n.get(0,1),c=this.get(1,0),f=n.get(1,0),d=this.get(1,1),h=n.get(1,1),v=(i+d)*(a+h),m=(c+d)*a,g=i*(s-h),_=d*(f-a),y=(i+o)*h,E=(c-i)*(a+s),b=(o-d)*(f+h),A=v+_-y+b,C=g+y,R=m+_,W=v-m+g+E;return r.set(0,0,A),r.set(0,1,C),r.set(1,0,R),r.set(1,1,W),r}},{key:"strassen3x3",value:function(n){n=Wn.checkMatrix(n);var r=new Wn(3,3),i=this.get(0,0),a=this.get(0,1),o=this.get(0,2),s=this.get(1,0),c=this.get(1,1),f=this.get(1,2),d=this.get(2,0),h=this.get(2,1),v=this.get(2,2),m=n.get(0,0),g=n.get(0,1),_=n.get(0,2),y=n.get(1,0),E=n.get(1,1),b=n.get(1,2),A=n.get(2,0),C=n.get(2,1),R=n.get(2,2),W=(i+a+o-s-c-h-v)*E,te=(i-s)*(-g+E),Q=c*(-m+g+y-E-b-A+R),re=(-i+s+c)*(m-g+E),de=(s+c)*(-m+g),Ce=i*m,ie=(-i+d+h)*(m-_+b),Ge=(-i+d)*(_-b),We=(d+h)*(-m+_),It=(i+a+o-c-f-d-h)*b,gn=h*(-m+_+y-E-b-A+C),pn=(-o+h+v)*(E+A-C),bn=(o-v)*(E-C),vr=o*A,Oi=(h+v)*(-A+C),Hr=(-o+c+f)*(b+A-R),Sn=(o-f)*(b-R),In=(c+f)*(-A+R),Ot=a*y,Dn=f*C,gr=s*_,Xn=d*g,wn=v*R,rn=Ce+vr+Ot,Er=W+re+de+Ce+pn+vr+Oi,ei=Ce+ie+We+It+vr+Hr+In,Tr=te+Q+re+Ce+vr+Hr+Sn,lo=te+re+de+Ce+Dn,Eu=vr+Hr+Sn+In+gr,af=Ce+ie+Ge+gn+pn+bn+vr,of=pn+bn+vr+Oi+Xn,sf=Ce+ie+Ge+We+wn;return r.set(0,0,rn),r.set(0,1,Er),r.set(0,2,ei),r.set(1,0,Tr),r.set(1,1,lo),r.set(1,2,Eu),r.set(2,0,af),r.set(2,1,of),r.set(2,2,sf),r}},{key:"mmulStrassen",value:function(n){n=Wn.checkMatrix(n);var r=this.clone(),i=r.rows,a=r.columns,o=n.rows,s=n.columns;a!==o&&console.warn("Multiplying ".concat(i," x ").concat(a," and ").concat(o," x ").concat(s," matrix: dimensions do not match."));function c(v,m,g){var _=v.rows,y=v.columns;if(_===m&&y===g)return v;var E=e.zeros(m,g);return E=E.setSubMatrix(v,0,0),E}var f=Math.max(i,o),d=Math.max(a,s);r=c(r,f,d),n=c(n,f,d);function h(v,m,g,_){if(g<=512||_<=512)return v.mmul(m);g%2==1&&_%2==1?(v=c(v,g+1,_+1),m=c(m,g+1,_+1)):g%2==1?(v=c(v,g+1,_),m=c(m,g+1,_)):_%2==1&&(v=c(v,g,_+1),m=c(m,g,_+1));var y=parseInt(v.rows/2,10),E=parseInt(v.columns/2,10),b=v.subMatrix(0,y-1,0,E-1),A=m.subMatrix(0,y-1,0,E-1),C=v.subMatrix(0,y-1,E,v.columns-1),R=m.subMatrix(0,y-1,E,m.columns-1),W=v.subMatrix(y,v.rows-1,0,E-1),te=m.subMatrix(y,m.rows-1,0,E-1),Q=v.subMatrix(y,v.rows-1,E,v.columns-1),re=m.subMatrix(y,m.rows-1,E,m.columns-1),de=h(e.add(b,Q),e.add(A,re),y,E),Ce=h(e.add(W,Q),A,y,E),ie=h(b,e.sub(R,re),y,E),Ge=h(Q,e.sub(te,A),y,E),We=h(e.add(b,C),re,y,E),It=h(e.sub(W,b),e.add(A,R),y,E),gn=h(e.sub(C,Q),e.add(te,re),y,E),pn=e.add(de,Ge);pn.sub(We),pn.add(gn);var bn=e.add(ie,We),vr=e.add(Ce,Ge),Oi=e.sub(de,Ce);Oi.add(ie),Oi.add(It);var Hr=e.zeros(2*pn.rows,2*pn.columns);return Hr=Hr.setSubMatrix(pn,0,0),Hr=Hr.setSubMatrix(bn,pn.rows,0),Hr=Hr.setSubMatrix(vr,0,pn.columns),Hr=Hr.setSubMatrix(Oi,pn.rows,pn.columns),Hr.subMatrix(0,g-1,0,_-1)}return h(r,n,f,d)}},{key:"scaleRows",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof n!="object")throw new TypeError("options must be an object");var r=n.min,i=r===void 0?0:r,a=n.max,o=a===void 0?1:a;if(!Number.isFinite(i))throw new TypeError("min must be a number");if(!Number.isFinite(o))throw new TypeError("max must be a number");if(i>=o)throw new RangeError("min must be smaller than max");for(var s=new Wn(this.rows,this.columns),c=0;c<this.rows;c++){var f=this.getRow(c);f.length>0&&f1(f,{min:i,max:o,output:f}),s.setRow(c,f)}return s}},{key:"scaleColumns",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof n!="object")throw new TypeError("options must be an object");var r=n.min,i=r===void 0?0:r,a=n.max,o=a===void 0?1:a;if(!Number.isFinite(i))throw new TypeError("min must be a number");if(!Number.isFinite(o))throw new TypeError("max must be a number");if(i>=o)throw new RangeError("min must be smaller than max");for(var s=new Wn(this.rows,this.columns),c=0;c<this.columns;c++){var f=this.getColumn(c);f.length&&f1(f,{min:i,max:o,output:f}),s.setColumn(c,f)}return s}},{key:"flipRows",value:function(){for(var n=Math.ceil(this.columns/2),r=0;r<this.rows;r++)for(var i=0;i<n;i++){var a=this.get(r,i),o=this.get(r,this.columns-1-i);this.set(r,i,o),this.set(r,this.columns-1-i,a)}return this}},{key:"flipColumns",value:function(){for(var n=Math.ceil(this.rows/2),r=0;r<this.columns;r++)for(var i=0;i<n;i++){var a=this.get(i,r),o=this.get(this.rows-1-i,r);this.set(i,r,o),this.set(this.rows-1-i,r,a)}return this}},{key:"kroneckerProduct",value:function(n){n=Wn.checkMatrix(n);for(var r=this.rows,i=this.columns,a=n.rows,o=n.columns,s=new Wn(r*a,i*o),c=0;c<r;c++)for(var f=0;f<i;f++)for(var d=0;d<a;d++)for(var h=0;h<o;h++)s.set(a*c+d,o*f+h,this.get(c,f)*n.get(d,h));return s}},{key:"kroneckerSum",value:function(n){if(n=Wn.checkMatrix(n),!this.isSquare()||!n.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");var r=this.rows,i=n.rows,a=this.kroneckerProduct(Wn.eye(i,i)),o=Wn.eye(r,r).kroneckerProduct(n);return a.add(o)}},{key:"transpose",value:function(){for(var n=new Wn(this.columns,this.rows),r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)n.set(i,r,this.get(r,i));return n}},{key:"sortRows",value:function(){for(var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v1,r=0;r<this.rows;r++)this.setRow(r,this.getRow(r).sort(n));return this}},{key:"sortColumns",value:function(){for(var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v1,r=0;r<this.columns;r++)this.setColumn(r,this.getColumn(r).sort(n));return this}},{key:"subMatrix",value:function(n,r,i,a){h1(this,n,r,i,a);for(var o=new Wn(r-n+1,a-i+1),s=n;s<=r;s++)for(var c=i;c<=a;c++)o.set(s-n,c-i,this.get(s,c));return o}},{key:"subMatrixRow",value:function(n,r,i){if(r===void 0&&(r=0),i===void 0&&(i=this.columns-1),r>i||r<0||r>=this.columns||i<0||i>=this.columns)throw new RangeError("Argument out of range");for(var a=new Wn(n.length,i-r+1),o=0;o<n.length;o++)for(var s=r;s<=i;s++){if(n[o]<0||n[o]>=this.rows)throw new RangeError("Row index out of range: ".concat(n[o]));a.set(o,s-r,this.get(n[o],s))}return a}},{key:"subMatrixColumn",value:function(n,r,i){if(r===void 0&&(r=0),i===void 0&&(i=this.rows-1),r>i||r<0||r>=this.rows||i<0||i>=this.rows)throw new RangeError("Argument out of range");for(var a=new Wn(i-r+1,n.length),o=0;o<n.length;o++)for(var s=r;s<=i;s++){if(n[o]<0||n[o]>=this.columns)throw new RangeError("Column index out of range: ".concat(n[o]));a.set(s-r,o,this.get(s,n[o]))}return a}},{key:"setSubMatrix",value:function(n,r,i){if(n=Wn.checkMatrix(n),n.isEmpty())return this;var a=r+n.rows-1,o=i+n.columns-1;h1(this,r,a,i,o);for(var s=0;s<n.rows;s++)for(var c=0;c<n.columns;c++)this.set(r+s,i+c,n.get(s,c));return this}},{key:"selection",value:function(n,r){mS(this,n),gS(this,r);for(var i=new Wn(n.length,r.length),a=0;a<n.length;a++)for(var o=n[a],s=0;s<r.length;s++){var c=r[s];i.set(a,s,this.get(o,c))}return i}},{key:"trace",value:function(){for(var n=Math.min(this.rows,this.columns),r=0,i=0;i<n;i++)r+=this.get(i,i);return r}},{key:"clone",value:function(){for(var n=new Wn(this.rows,this.columns),r=0;r<this.rows;r++)for(var i=0;i<this.columns;i++)n.set(r,i,this.get(r,i));return n}},{key:"sum",value:function(n){switch(n){case"row":return yS(this);case"column":return _S(this);case void 0:return ES(this);default:throw new Error("invalid option: ".concat(n))}}},{key:"product",value:function(n){switch(n){case"row":return bS(this);case"column":return wS(this);case void 0:return xS(this);default:throw new Error("invalid option: ".concat(n))}}},{key:"mean",value:function(n){var r=this.sum(n);switch(n){case"row":{for(var i=0;i<this.rows;i++)r[i]/=this.columns;return r}case"column":{for(var a=0;a<this.columns;a++)r[a]/=this.rows;return r}case void 0:return r/this.size;default:throw new Error("invalid option: ".concat(n))}}},{key:"variance",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof n=="object"&&(r=n,n=void 0),typeof r!="object")throw new TypeError("options must be an object");var i=r,a=i.unbiased,o=a===void 0?!0:a,s=i.mean,c=s===void 0?this.mean(n):s;if(typeof o!="boolean")throw new TypeError("unbiased must be a boolean");switch(n){case"row":{if(!fs(c))throw new TypeError("mean must be an array");return SS(this,o,c)}case"column":{if(!fs(c))throw new TypeError("mean must be an array");return TS(this,o,c)}case void 0:{if(typeof c!="number")throw new TypeError("mean must be a number");return AS(this,o,c)}default:throw new Error("invalid option: ".concat(n))}}},{key:"standardDeviation",value:function(n,r){typeof n=="object"&&(r=n,n=void 0);var i=this.variance(n,r);if(n===void 0)return Math.sqrt(i);for(var a=0;a<i.length;a++)i[a]=Math.sqrt(i[a]);return i}},{key:"center",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof n=="object"&&(r=n,n=void 0),typeof r!="object")throw new TypeError("options must be an object");var i=r,a=i.center,o=a===void 0?this.mean(n):a;switch(n){case"row":{if(!fs(o))throw new TypeError("center must be an array");return IS(this,o),this}case"column":{if(!fs(o))throw new TypeError("center must be an array");return CS(this,o),this}case void 0:{if(typeof o!="number")throw new TypeError("center must be a number");return RS(this,o),this}default:throw new Error("invalid option: ".concat(n))}}},{key:"scale",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof n=="object"&&(r=n,n=void 0),typeof r!="object")throw new TypeError("options must be an object");var i=r.scale;switch(n){case"row":{if(i===void 0)i=MS(this);else if(!fs(i))throw new TypeError("scale must be an array");return NS(this,i),this}case"column":{if(i===void 0)i=DS(this);else if(!fs(i))throw new TypeError("scale must be an array");return PS(this,i),this}case void 0:{if(i===void 0)i=OS(this);else if(typeof i!="number")throw new TypeError("scale must be a number");return LS(this,i),this}default:throw new Error("invalid option: ".concat(n))}}},{key:"toString",value:function(n){return d1(this,n)}}],[{key:"from1DArray",value:function(n,r,i){var a=n*r;if(a!==i.length)throw new RangeError("data length does not match given dimensions");for(var o=new Wn(n,r),s=0;s<n;s++)for(var c=0;c<r;c++)o.set(s,c,i[s*r+c]);return o}},{key:"rowVector",value:function(n){for(var r=new Wn(1,n.length),i=0;i<n.length;i++)r.set(0,i,n[i]);return r}},{key:"columnVector",value:function(n){for(var r=new Wn(n.length,1),i=0;i<n.length;i++)r.set(i,0,n[i]);return r}},{key:"zeros",value:function(n,r){return new Wn(n,r)}},{key:"ones",value:function(n,r){return new Wn(n,r).fill(1)}},{key:"rand",value:function(n,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof i!="object")throw new TypeError("options must be an object");for(var a=i.random,o=a===void 0?Math.random:a,s=new Wn(n,r),c=0;c<n;c++)for(var f=0;f<r;f++)s.set(c,f,o());return s}},{key:"randInt",value:function(n,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof i!="object")throw new TypeError("options must be an object");var a=i.min,o=a===void 0?0:a,s=i.max,c=s===void 0?1e3:s,f=i.random,d=f===void 0?Math.random:f;if(!Number.isInteger(o))throw new TypeError("min must be an integer");if(!Number.isInteger(c))throw new TypeError("max must be an integer");if(o>=c)throw new RangeError("min must be smaller than max");for(var h=c-o,v=new Wn(n,r),m=0;m<n;m++)for(var g=0;g<r;g++){var _=o+Math.round(d()*h);v.set(m,g,_)}return v}},{key:"eye",value:function(n,r,i){r===void 0&&(r=n),i===void 0&&(i=1);for(var a=Math.min(n,r),o=this.zeros(n,r),s=0;s<a;s++)o.set(s,s,i);return o}},{key:"diag",value:function(n,r,i){var a=n.length;r===void 0&&(r=a),i===void 0&&(i=r);for(var o=Math.min(a,r,i),s=this.zeros(r,i),c=0;c<o;c++)s.set(c,c,n[c]);return s}},{key:"min",value:function(n,r){n=this.checkMatrix(n),r=this.checkMatrix(r);for(var i=n.rows,a=n.columns,o=new Wn(i,a),s=0;s<i;s++)for(var c=0;c<a;c++)o.set(s,c,Math.min(n.get(s,c),r.get(s,c)));return o}},{key:"max",value:function(n,r){n=this.checkMatrix(n),r=this.checkMatrix(r);for(var i=n.rows,a=n.columns,o=new this(i,a),s=0;s<i;s++)for(var c=0;c<a;c++)o.set(s,c,Math.max(n.get(s,c),r.get(s,c)));return o}},{key:"checkMatrix",value:function(n){return e.isMatrix(n)?n:new Wn(n)}},{key:"isMatrix",value:function(n){return n!=null&&n.klass==="Matrix"}}]),e}();da.prototype.klass="Matrix",typeof Symbol!="undefined"&&(da.prototype[Symbol.for("nodejs.util.inspect.custom")]=dS);function v1(e,t){return e-t}function GS(e){return e.every(function(t){return typeof t=="number"})}da.random=da.rand,da.randomInt=da.randInt,da.diagonal=da.diag,da.prototype.diagonal=da.prototype.diag,da.identity=da.eye,da.prototype.negate=da.prototype.neg,da.prototype.tensorProduct=da.prototype.kroneckerProduct;var Wn=function(e){(0,u1.Z)(n,e);var t=(0,c1.Z)(n);function n(r,i){var a;if((0,D0.Z)(this,n),a=t.call(this),n.isMatrix(r))return(0,uS.Z)(a,r.clone());if(Number.isInteger(r)&&r>=0)if(a.data=[],Number.isInteger(i)&&i>=0)for(var o=0;o<r;o++)a.data.push(new Float64Array(i));else throw new TypeError("nColumns must be a positive integer");else if(fs(r)){var s=r;if(r=s.length,i=r?s[0].length:0,typeof i!="number")throw new TypeError("Data must be a 2D array with at least one element");a.data=[];for(var c=0;c<r;c++){if(s[c].length!==i)throw new RangeError("Inconsistent array dimensions");if(!GS(s[c]))throw new TypeError("Input data contains non-numeric values");a.data.push(Float64Array.from(s[c]))}}else throw new TypeError("First argument must be a positive number or an array");return a.rows=r,a.columns=i,a}return(0,P0.Z)(n,[{key:"set",value:function(i,a,o){return this.data[i][a]=o,this}},{key:"get",value:function(i,a){return this.data[i][a]}},{key:"removeRow",value:function(i){return gu(this,i),this.data.splice(i,1),this.rows-=1,this}},{key:"addRow",value:function(i,a){return a===void 0&&(a=i,i=this.rows),gu(this,i,!0),a=Float64Array.from(ph(this,a)),this.data.splice(i,0,a),this.rows+=1,this}},{key:"removeColumn",value:function(i){yu(this,i);for(var a=0;a<this.rows;a++){for(var o=new Float64Array(this.columns-1),s=0;s<i;s++)o[s]=this.data[a][s];for(var c=i+1;c<this.columns;c++)o[c-1]=this.data[a][c];this.data[a]=o}return this.columns-=1,this}},{key:"addColumn",value:function(i,a){typeof a=="undefined"&&(a=i,i=this.columns),yu(this,i,!0),a=mh(this,a);for(var o=0;o<this.rows;o++){for(var s=new Float64Array(this.columns+1),c=0;c<i;c++)s[c]=this.data[o][c];for(s[c++]=a[o];c<this.columns+1;c++)s[c]=this.data[o][c-1];this.data[o]=s}return this.columns+=1,this}}]),n}(da);pS(da,Wn);var kS=function(e){(0,u1.Z)(n,e);var t=(0,c1.Z)(n);function n(r){var i;return(0,D0.Z)(this,n),i=t.call(this),i.data=r,i.rows=r.length,i.columns=r[0].length,i}return(0,P0.Z)(n,[{key:"set",value:function(i,a,o){return this.data[i][a]=o,this}},{key:"get",value:function(i,a){return this.data[i][a]}}]),n}(da);function yh(e,t){var n=0;return Math.abs(e)>Math.abs(t)?(n=t/e,Math.abs(e)*Math.sqrt(1+n*n)):t!==0?(n=e/t,Math.abs(t)*Math.sqrt(1+n*n)):0}var p1=function(){function e(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if((0,D0.Z)(this,e),t=kS.checkMatrix(t),t.isEmpty())throw new Error("Matrix must be non-empty");var r=t.rows,i=t.columns,a=n.computeLeftSingularVectors,o=a===void 0?!0:a,s=n.computeRightSingularVectors,c=s===void 0?!0:s,f=n.autoTranspose,d=f===void 0?!1:f,h=Boolean(o),v=Boolean(c),m=!1,g;if(r<i)if(!d)g=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{g=t.transpose(),r=g.rows,i=g.columns,m=!0;var _=h;h=v,v=_}else g=t.clone();for(var y=Math.min(r,i),E=Math.min(r+1,i),b=new Float64Array(E),A=new Wn(r,y),C=new Wn(i,i),R=new Float64Array(i),W=new Float64Array(r),te=new Float64Array(E),Q=0;Q<E;Q++)te[Q]=Q;for(var re=Math.min(r-1,i),de=Math.max(0,Math.min(i-2,r)),Ce=Math.max(re,de),ie=0;ie<Ce;ie++){if(ie<re){b[ie]=0;for(var Ge=ie;Ge<r;Ge++)b[ie]=yh(b[ie],g.get(Ge,ie));if(b[ie]!==0){g.get(ie,ie)<0&&(b[ie]=-b[ie]);for(var We=ie;We<r;We++)g.set(We,ie,g.get(We,ie)/b[ie]);g.set(ie,ie,g.get(ie,ie)+1)}b[ie]=-b[ie]}for(var It=ie+1;It<i;It++){if(ie<re&&b[ie]!==0){for(var gn=0,pn=ie;pn<r;pn++)gn+=g.get(pn,ie)*g.get(pn,It);gn=-gn/g.get(ie,ie);for(var bn=ie;bn<r;bn++)g.set(bn,It,g.get(bn,It)+gn*g.get(bn,ie))}R[It]=g.get(ie,It)}if(h&&ie<re)for(var vr=ie;vr<r;vr++)A.set(vr,ie,g.get(vr,ie));if(ie<de){R[ie]=0;for(var Oi=ie+1;Oi<i;Oi++)R[ie]=yh(R[ie],R[Oi]);if(R[ie]!==0){R[ie+1]<0&&(R[ie]=0-R[ie]);for(var Hr=ie+1;Hr<i;Hr++)R[Hr]/=R[ie];R[ie+1]+=1}if(R[ie]=-R[ie],ie+1<r&&R[ie]!==0){for(var Sn=ie+1;Sn<r;Sn++)W[Sn]=0;for(var In=ie+1;In<r;In++)for(var Ot=ie+1;Ot<i;Ot++)W[In]+=R[Ot]*g.get(In,Ot);for(var Dn=ie+1;Dn<i;Dn++)for(var gr=-R[Dn]/R[ie+1],Xn=ie+1;Xn<r;Xn++)g.set(Xn,Dn,g.get(Xn,Dn)+gr*W[Xn])}if(v)for(var wn=ie+1;wn<i;wn++)C.set(wn,ie,R[wn])}}var rn=Math.min(i,r+1);if(re<i&&(b[re]=g.get(re,re)),r<rn&&(b[rn-1]=0),de+1<rn&&(R[de]=g.get(de,rn-1)),R[rn-1]=0,h){for(var Er=re;Er<y;Er++){for(var ei=0;ei<r;ei++)A.set(ei,Er,0);A.set(Er,Er,1)}for(var Tr=re-1;Tr>=0;Tr--)if(b[Tr]!==0){for(var lo=Tr+1;lo<y;lo++){for(var Eu=0,af=Tr;af<r;af++)Eu+=A.get(af,Tr)*A.get(af,lo);Eu=-Eu/A.get(Tr,Tr);for(var of=Tr;of<r;of++)A.set(of,lo,A.get(of,lo)+Eu*A.get(of,Tr))}for(var sf=Tr;sf<r;sf++)A.set(sf,Tr,-A.get(sf,Tr));A.set(Tr,Tr,1+A.get(Tr,Tr));for(var By=0;By<Tr-1;By++)A.set(By,Tr,0)}else{for(var zy=0;zy<r;zy++)A.set(zy,Tr,0);A.set(Tr,Tr,1)}}if(v)for(var Fo=i-1;Fo>=0;Fo--){if(Fo<de&&R[Fo]!==0)for(var Kv=Fo+1;Kv<i;Kv++){for(var um=0,cm=Fo+1;cm<i;cm++)um+=C.get(cm,Fo)*C.get(cm,Kv);um=-um/C.get(Fo+1,Fo);for(var qv=Fo+1;qv<i;qv++)C.set(qv,Kv,C.get(qv,Kv)+um*C.get(qv,Fo))}for(var Wy=0;Wy<i;Wy++)C.set(Wy,Fo,0);C.set(Fo,Fo,1)}for(var Hx=rn-1,Vy=0,Xx=Number.EPSILON;rn>0;){var Cn=void 0,Jv=void 0;for(Cn=rn-2;Cn>=-1&&Cn!==-1;Cn--){var yR=Number.MIN_VALUE+Xx*Math.abs(b[Cn]+Math.abs(b[Cn+1]));if(Math.abs(R[Cn])<=yR||Number.isNaN(R[Cn])){R[Cn]=0;break}}if(Cn===rn-2)Jv=4;else{var ls=void 0;for(ls=rn-1;ls>=Cn&&ls!==Cn;ls--){var _R=(ls!==rn?Math.abs(R[ls]):0)+(ls!==Cn+1?Math.abs(R[ls-1]):0);if(Math.abs(b[ls])<=Xx*_R){b[ls]=0;break}}ls===Cn?Jv=3:ls===rn-1?Jv=1:(Jv=2,Cn=ls)}switch(Cn++,Jv){case 1:{var Zy=R[rn-2];R[rn-2]=0;for(var Vs=rn-2;Vs>=Cn;Vs--){var Qv=yh(b[Vs],Zy),jy=b[Vs]/Qv,Hy=Zy/Qv;if(b[Vs]=Qv,Vs!==Cn&&(Zy=-Hy*R[Vs-1],R[Vs-1]=jy*R[Vs-1]),v)for(var sl=0;sl<i;sl++)Qv=jy*C.get(sl,Vs)+Hy*C.get(sl,rn-1),C.set(sl,rn-1,-Hy*C.get(sl,Vs)+jy*C.get(sl,rn-1)),C.set(sl,Vs,Qv)}break}case 2:{var Xy=R[Cn-1];R[Cn-1]=0;for(var bu=Cn;bu<rn;bu++){var ep=yh(b[bu],Xy),$y=b[bu]/ep,Yy=Xy/ep;if(b[bu]=ep,Xy=-Yy*R[bu],R[bu]=$y*R[bu],h)for(var ul=0;ul<r;ul++)ep=$y*A.get(ul,bu)+Yy*A.get(ul,Cn-1),A.set(ul,Cn-1,-Yy*A.get(ul,bu)+$y*A.get(ul,Cn-1)),A.set(ul,bu,ep)}break}case 3:{var tp=Math.max(Math.abs(b[rn-1]),Math.abs(b[rn-2]),Math.abs(R[rn-2]),Math.abs(b[Cn]),Math.abs(R[Cn])),Oh=b[rn-1]/tp,$x=b[rn-2]/tp,fm=R[rn-2]/tp,Ky=b[Cn]/tp,ER=R[Cn]/tp,rd=(($x+Oh)*($x-Oh)+fm*fm)/2,lm=Oh*fm*(Oh*fm),np=0;(rd!==0||lm!==0)&&(rd<0?np=0-Math.sqrt(rd*rd+lm):np=Math.sqrt(rd*rd+lm),np=lm/(rd+np));for(var id=(Ky+Oh)*(Ky-Oh)+np,Lh=Ky*ER,Cr=Cn;Cr<rn-1;Cr++){var ho=yh(id,Lh);ho===0&&(ho=Number.MIN_VALUE);var wu=id/ho,xu=Lh/ho;if(Cr!==Cn&&(R[Cr-1]=ho),id=wu*b[Cr]+xu*R[Cr],R[Cr]=wu*R[Cr]-xu*b[Cr],Lh=xu*b[Cr+1],b[Cr+1]=wu*b[Cr+1],v)for(var cl=0;cl<i;cl++)ho=wu*C.get(cl,Cr)+xu*C.get(cl,Cr+1),C.set(cl,Cr+1,-xu*C.get(cl,Cr)+wu*C.get(cl,Cr+1)),C.set(cl,Cr,ho);if(ho=yh(id,Lh),ho===0&&(ho=Number.MIN_VALUE),wu=id/ho,xu=Lh/ho,b[Cr]=ho,id=wu*R[Cr]+xu*b[Cr+1],b[Cr+1]=-xu*R[Cr]+wu*b[Cr+1],Lh=xu*R[Cr+1],R[Cr+1]=wu*R[Cr+1],h&&Cr<r-1)for(var fl=0;fl<r;fl++)ho=wu*A.get(fl,Cr)+xu*A.get(fl,Cr+1),A.set(fl,Cr+1,-xu*A.get(fl,Cr)+wu*A.get(fl,Cr+1)),A.set(fl,Cr,ho)}R[rn-2]=id,Vy=Vy+1;break}case 4:{if(b[Cn]<=0&&(b[Cn]=b[Cn]<0?-b[Cn]:0,v))for(var dm=0;dm<=Hx;dm++)C.set(dm,Cn,-C.get(dm,Cn));for(;Cn<Hx&&!(b[Cn]>=b[Cn+1]);){var rp=b[Cn];if(b[Cn]=b[Cn+1],b[Cn+1]=rp,v&&Cn<i-1)for(var Gh=0;Gh<i;Gh++)rp=C.get(Gh,Cn+1),C.set(Gh,Cn+1,C.get(Gh,Cn)),C.set(Gh,Cn,rp);if(h&&Cn<r-1)for(var kh=0;kh<r;kh++)rp=A.get(kh,Cn+1),A.set(kh,Cn+1,A.get(kh,Cn)),A.set(kh,Cn,rp);Cn++}Vy=0,rn--;break}}}if(m){var bR=C;C=A,A=bR}this.m=r,this.n=i,this.s=b,this.U=A,this.V=C}return(0,P0.Z)(e,[{key:"solve",value:function(n){for(var r=n,i=this.threshold,a=this.s.length,o=Wn.zeros(a,a),s=0;s<a;s++)Math.abs(this.s[s])<=i?o.set(s,s,0):o.set(s,s,1/this.s[s]);for(var c=this.U,f=this.rightSingularVectors,d=f.mmul(o),h=f.rows,v=c.rows,m=Wn.zeros(h,v),g=0;g<h;g++)for(var _=0;_<v;_++){for(var y=0,E=0;E<a;E++)y+=d.get(g,E)*c.get(_,E);m.set(g,_,y)}return m.mmul(r)}},{key:"solveForDiagonal",value:function(n){return this.solve(Wn.diag(n))}},{key:"inverse",value:function(){for(var n=this.V,r=this.threshold,i=n.rows,a=n.columns,o=new Wn(i,this.s.length),s=0;s<i;s++)for(var c=0;c<a;c++)Math.abs(this.s[c])>r&&o.set(s,c,n.get(s,c)/this.s[c]);for(var f=this.U,d=f.rows,h=f.columns,v=new Wn(i,d),m=0;m<i;m++)for(var g=0;g<d;g++){for(var _=0,y=0;y<h;y++)_+=o.get(m,y)*f.get(g,y);v.set(m,g,_)}return v}},{key:"condition",get:function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}},{key:"norm2",get:function(){return this.s[0]}},{key:"rank",get:function(){for(var n=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,r=0,i=this.s,a=0,o=i.length;a<o;a++)i[a]>n&&r++;return r}},{key:"diagonal",get:function(){return Array.from(this.s)}},{key:"threshold",get:function(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}},{key:"leftSingularVectors",get:function(){return this.U}},{key:"rightSingularVectors",get:function(){return this.V}},{key:"diagonalMatrix",get:function(){return Wn.diag(this.s)}}]),e}();class FS{constructor(t){this.distances=t.distances,this.dimension=t.dimension||2,this.linkDistance=t.linkDistance}layout(){const t=this,{dimension:n,distances:r,linkDistance:i}=t;try{const a=Wn.mul(Wn.pow(r,2),-.5),o=a.mean("row"),s=a.mean("column"),c=a.mean();a.add(c).subRowVector(o).subColumnVector(s);const f=new p1(a),d=Wn.sqrt(f.diagonalMatrix).diagonal();return f.leftSingularVectors.toJSON().map(h=>Wn.mul([h],[d]).toJSON()[0].splice(0,n))}catch(a){const o=[];for(let s=0;s<r.length;s++){const c=Math.random()*i,f=Math.random()*i;o.push([c,f])}return o}}}const US=800;class BS{constructor(t){this.disp=[],this.positions=t.positions,this.adjMatrix=t.adjMatrix,this.focusID=t.focusID,this.radii=t.radii,this.iterations=t.iterations||10,this.height=t.height||10,this.width=t.width||10,this.speed=t.speed||100,this.gravity=t.gravity||10,this.nodeSizeFunc=t.nodeSizeFunc,this.k=t.k||5,this.strictRadial=t.strictRadial,this.nodes=t.nodes}layout(){const t=this,n=t.positions,r=[],i=t.iterations,a=t.width/10;t.maxDisplace=a,t.disp=r;for(let o=0;o<i;o++)n.forEach((s,c)=>{r[c]={x:0,y:0}}),t.getRepulsion(),t.updatePositions();return n}getRepulsion(){const t=this,n=t.positions,r=t.nodes,i=t.disp,a=t.k,o=t.radii||[];n.forEach((s,c)=>{i[c]={x:0,y:0},n.forEach((f,d)=>{if(c===d||o[c]!==o[d])return;let h=s[0]-f[0],v=s[1]-f[1],m=Math.sqrt(h*h+v*v);if(m===0){m=1;const g=c>d?1:-1;h=.01*g,v=.01*g}if(m<t.nodeSizeFunc(r[c])/2+t.nodeSizeFunc(r[d])/2){const g=a*a/m;i[c].x+=h/m*g,i[c].y+=v/m*g}})})}updatePositions(){const t=this,n=t.positions,r=t.disp,i=t.speed,a=t.strictRadial,o=t.focusID,s=t.maxDisplace||t.width/10;a&&r.forEach((f,d)=>{const h=n[d][0]-n[o][0],v=n[d][1]-n[o][1],m=Math.sqrt(h*h+v*v);let g=v/m,_=-h/m;const y=Math.sqrt(f.x*f.x+f.y*f.y);let E=Math.acos((g*f.x+_*f.y)/y);E>Math.PI/2&&(E-=Math.PI/2,g*=-1,_*=-1);const b=Math.cos(E)*y;f.x=g*b,f.y=_*b});const c=t.radii;n.forEach((f,d)=>{if(d===o)return;const h=Math.sqrt(r[d].x*r[d].x+r[d].y*r[d].y);if(h>0&&d!==o){const v=Math.min(s*(i/US),h);if(f[0]+=r[d].x/h*v,f[1]+=r[d].y/h*v,a){let m=f[0]-n[o][0],g=f[1]-n[o][1];const _=Math.sqrt(m*m+g*g);m=m/_*c[d],g=g/_*c[d],f[0]=n[o][0]+m,f[1]=n[o][1]+g}}})}}function zS(e){const t=e.length,n=e[0].length,r=[];for(let i=0;i<t;i++){const a=[];for(let o=0;o<n;o++)e[i][o]!==0?a.push(1/(e[i][o]*e[i][o])):a.push(0);r.push(a)}return r}function WS(e,t){let n=-1;return e.forEach((r,i)=>{r.id===t&&(n=i)}),n}function m1(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}class VS extends jt{constructor(t){super();this.maxIteration=1e3,this.focusNode=null,this.unitRadius=null,this.linkDistance=50,this.preventOverlap=!1,this.strictRadial=!0,this.maxPreventOverlapIteration=200,this.sortStrength=10,this.nodes=[],this.edges=[],this.updateCfg(t)}getDefaultCfg(){return{maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,strictRadial:!0,maxPreventOverlapIteration:200,sortBy:void 0,sortStrength:10}}execute(){const t=this,n=t.nodes,r=t.edges||[];if(!n||n.length===0){t.onLayoutEnd&&t.onLayoutEnd();return}!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight),t.center||(t.center=[t.width/2,t.height/2]);const i=t.center;if(n.length===1){n[0].x=i[0],n[0].y=i[1],t.onLayoutEnd&&t.onLayoutEnd();return}const a=t.linkDistance;let o=null;if(x(t.focusNode)){let Ce=!1;for(let ie=0;ie<n.length;ie++)n[ie].id===t.focusNode&&(o=n[ie],t.focusNode=o,Ce=!0,ie=n.length);Ce||(o=null)}else o=t.focusNode;o||(o=n[0],t.focusNode=o);let s=WS(n,o.id);s<0&&(s=0),t.focusIndex=s;const c=ht({nodes:n,edges:r},!1),f=dt(c),d=t.maxToFocus(f,s);t.handleInfinity(f,s,d+1),t.distances=f;const h=f[s],v=t.width||500,m=t.height||500;let g=v-i[0]>i[0]?i[0]:v-i[0],_=m-i[1]>i[1]?i[1]:m-i[1];g===0&&(g=v/2),_===0&&(_=m/2);const y=_>g?g:_,E=Math.max(...h),b=[];h.forEach((Ce,ie)=>{t.unitRadius||(t.unitRadius=y/E),b[ie]=Ce*t.unitRadius}),t.radii=b;const A=t.eIdealDisMatrix();t.eIdealDistances=A;const C=zS(A);t.weights=C;let W=new FS({linkDistance:a,distances:A}).layout();W.forEach(Ce=>{De(Ce[0])&&(Ce[0]=Math.random()*a),De(Ce[1])&&(Ce[1]=Math.random()*a)}),t.positions=W,W.forEach((Ce,ie)=>{n[ie].x=Ce[0]+i[0],n[ie].y=Ce[1]+i[1]}),W.forEach(Ce=>{Ce[0]-=W[s][0],Ce[1]-=W[s][1]}),t.run();const te=t.preventOverlap,Q=t.nodeSize;let re;const de=t.strictRadial;if(te){const Ce=t.nodeSpacing;let ie;Z(Ce)?ie=()=>Ce:pt(Ce)?ie=Ce:ie=()=>0,Q?H(Q)?re=It=>(Q[0]>Q[1]?Q[0]:Q[1])+ie(It):re=It=>Q+ie(It):re=It=>It.size?H(It.size)?(It.size[0]>It.size[1]?It.size[0]:It.size[1])+ie(It):me(It.size)?(It.size.width>It.size.height?It.size.width:It.size.height)+ie(It):It.size+ie(It):10+ie(It);const Ge={nodes:n,nodeSizeFunc:re,adjMatrix:c,positions:W,radii:b,height:m,width:v,strictRadial:de,focusID:s,iterations:t.maxPreventOverlapIteration||200,k:W.length/4.5};W=new BS(Ge).layout()}return W.forEach((Ce,ie)=>{n[ie].x=Ce[0]+i[0],n[ie].y=Ce[1]+i[1]}),t.onLayoutEnd&&t.onLayoutEnd(),{nodes:n,edges:r}}run(){const t=this,n=t.maxIteration,r=t.positions||[],i=t.weights||[],a=t.eIdealDistances||[],o=t.radii||[];for(let s=0;s<=n;s++){const c=s/n;t.oneIteration(c,r,o,a,i)}}oneIteration(t,n,r,i,a){const o=this,s=1-t,c=o.focusIndex;n.forEach((f,d)=>{const h=m1(f,[0,0]),v=h===0?0:1/h;if(d===c)return;let m=0,g=0,_=0;n.forEach((E,b)=>{if(d===b)return;const A=m1(f,E),C=A===0?0:1/A,R=i[b][d];_+=a[d][b],m+=a[d][b]*(E[0]+R*(f[0]-E[0])*C),g+=a[d][b]*(E[1]+R*(f[1]-E[1])*C)});const y=r[d]===0?0:1/r[d];_*=s,_+=t*y*y,m*=s,m+=t*y*f[0]*v,f[0]=m/_,g*=s,g+=t*y*f[1]*v,f[1]=g/_})}eIdealDisMatrix(){const t=this,n=t.nodes;if(!n)return[];const r=t.distances,i=t.linkDistance,a=t.radii||[],o=t.unitRadius||50,s=[];return r&&r.forEach((c,f)=>{const d=[];c.forEach((h,v)=>{if(f===v)d.push(0);else if(a[f]===a[v])if(t.sortBy==="data")d.push(h*(Math.abs(f-v)*t.sortStrength)/(a[f]/o));else if(t.sortBy){let m=n[f][t.sortBy]||0,g=n[v][t.sortBy]||0;x(m)&&(m=m.charCodeAt(0)),x(g)&&(g=g.charCodeAt(0)),d.push(h*(Math.abs(m-g)*t.sortStrength)/(a[f]/o))}else d.push(h*i/(a[f]/o));else{const m=(i+o)/2;d.push(h*m)}}),s.push(d)}),s}handleInfinity(t,n,r){const i=t.length;for(let a=0;a<i;a++)if(t[n][a]===Infinity){t[n][a]=r,t[a][n]=r;for(let o=0;o<i;o++)t[a][o]!==Infinity&&t[n][o]===Infinity&&(t[n][o]=r+t[a][o],t[o][n]=r+t[a][o])}for(let a=0;a<i;a++)if(a!==n){for(let o=0;o<i;o++)if(t[a][o]===Infinity){let s=Math.abs(t[n][a]-t[n][o]);s=s===0?1:s,t[a][o]=s}}}maxToFocus(t,n){let r=0;for(let i=0;i<t[n].length;i++)t[n][i]!==Infinity&&(r=t[n][i]>r?t[n][i]:r);return r}getType(){return"radial"}}class g1 extends jt{constructor(t){super();this.nodeSize=30,this.minNodeSpacing=10,this.nodeSpacing=10,this.preventOverlap=!1,this.equidistant=!1,this.startAngle=3/2*Math.PI,this.clockwise=!0,this.sortBy="degree",this.nodes=[],this.edges=[],this.width=300,this.height=300,this.onLayoutEnd=()=>{},this.updateCfg(t)}getDefaultCfg(){return{nodeSize:30,minNodeSpacing:10,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:3/2*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"}}execute(){var t,n;const r=this,{nodes:i,edges:a}=r,o=i.length;if(o===0){(t=r.onLayoutEnd)===null||t===void 0||t.call(r);return}!r.width&&typeof window!="undefined"&&(r.width=window.innerWidth),!r.height&&typeof window!="undefined"&&(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);const s=r.center;if(o===1){i[0].x=s[0],i[0].y=s[1],(n=r.onLayoutEnd)===null||n===void 0||n.call(r);return}const{nodeSize:c,nodeSpacing:f}=r,d=[];let h,v=0;H(c)?h=Math.max(c[0],c[1]):h=c,H(f)?v=Math.max(f[0],f[1]):Z(f)&&(v=f),i.forEach(A=>{d.push(A);let C=h;H(A.size)?C=Math.max(A.size[0],A.size[1]):Z(A.size)?C=A.size:me(A.size)&&(C=Math.max(A.size.width,A.size.height)),h=Math.max(h,C),pt(f)&&(v=Math.max(f(A),v))}),r.clockwise=r.counterclockwise!==void 0?!r.counterclockwise:r.clockwise;const m={},g={};if(d.forEach((A,C)=>{m[A.id]=A,g[A.id]=C}),(r.sortBy==="degree"||!x(r.sortBy)||d[0][r.sortBy]===void 0)&&(r.sortBy="degree",!Z(i[0].degree))){const A=Gt(i.length,g,a);d.forEach((C,R)=>{C.degree=A[R].all})}d.sort((A,C)=>C[r.sortBy]-A[r.sortBy]),r.maxValueNode=d[0],r.maxLevelDiff=r.maxLevelDiff||r.maxValueNode[r.sortBy]/4;const _=[[]];let y=_[0];d.forEach(A=>{if(y.length>0){const C=Math.abs(y[0][r.sortBy]-A[r.sortBy]);r.maxLevelDiff&&C>=r.maxLevelDiff&&(y=[],_.push(y))}y.push(A)});let E=h+(v||r.minNodeSpacing);if(!r.preventOverlap){const A=_.length>0&&_[0].length>1,R=(Math.min(r.width,r.height)/2-E)/(_.length+(A?1:0));E=Math.min(E,R)}let b=0;if(_.forEach(A=>{let C=r.sweep;C===void 0&&(C=2*Math.PI-2*Math.PI/A.length);const R=A.dTheta=C/Math.max(1,A.length-1);if(A.length>1&&r.preventOverlap){const W=Math.cos(R)-Math.cos(0),te=Math.sin(R)-Math.sin(0),Q=Math.sqrt(E*E/(W*W+te*te));b=Math.max(Q,b)}A.r=b,b+=E}),r.equidistant){let A=0,C=0;for(let R=0;R<_.length;R++){const te=_[R].r-C;A=Math.max(A,te)}C=0,_.forEach((R,W)=>{W===0&&(C=R.r),R.r=C,C+=A})}return _.forEach(A=>{const C=A.dTheta,R=A.r;A.forEach((W,te)=>{const Q=r.startAngle+(r.clockwise?1:-1)*C*te;W.x=s[0]+R*Math.cos(Q),W.y=s[1]+R*Math.sin(Q)})}),r.onLayoutEnd&&r.onLayoutEnd(),{nodes:i,edges:a}}getType(){return"concentric"}}class y1 extends jt{constructor(t){super();this.center=[0,0],this.linkDistance=50,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(t)}getDefaultCfg(){return{center:[0,0],linkDistance:50}}execute(){const t=this,{nodes:n,edges:r=[]}=t,i=t.center;if(!n||n.length===0){t.onLayoutEnd&&t.onLayoutEnd();return}if(n.length===1){n[0].x=i[0],n[0].y=i[1],t.onLayoutEnd&&t.onLayoutEnd();return}const a=t.linkDistance,o=ht({nodes:n,edges:r},!1),s=dt(o);t.handleInfinity(s);const c=vt(s,a);t.scaledDistances=c;const f=t.runMDS();return t.positions=f,f.forEach((d,h)=>{n[h].x=d[0]+i[0],n[h].y=d[1]+i[1]}),t.onLayoutEnd&&t.onLayoutEnd(),{nodes:n,edges:r}}runMDS(){const t=this,n=2,r=t.scaledDistances,i=Wn.mul(Wn.pow(r,2),-.5),a=i.mean("row"),o=i.mean("column"),s=i.mean();i.add(s).subRowVector(a).subColumnVector(o);const c=new p1(i),f=Wn.sqrt(c.diagonalMatrix).diagonal();return c.leftSingularVectors.toJSON().map(d=>Wn.mul([d],[f]).toJSON()[0].splice(0,n))}handleInfinity(t){let n=-999999;t.forEach(r=>{r.forEach(i=>{i!==Infinity&&n<i&&(n=i)})}),t.forEach((r,i)=>{r.forEach((a,o)=>{a===Infinity&&(t[i][o]=n)})})}getType(){return"mds"}}const ZS=800;class jS extends jt{constructor(t){super();this.maxIteration=1e3,this.workerEnabled=!1,this.gravity=10,this.speed=5,this.clustering=!1,this.clusterGravity=10,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.onLayoutEnd=()=>{},this.tick=()=>{},this.animate=!0,this.updateCfg(t)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10,animate:!0}}execute(){var t,n;const r=this,i=r.nodes;if(r.timeInterval!==void 0&&typeof window!="undefined"&&window.clearInterval(r.timeInterval),!i||i.length===0){(t=r.onLayoutEnd)===null||t===void 0||t.call(r);return}!r.width&&typeof window!="undefined"&&(r.width=window.innerWidth),!r.height&&typeof window!="undefined"&&(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);const a=r.center;if(i.length===1){i[0].x=a[0],i[0].y=a[1],(n=r.onLayoutEnd)===null||n===void 0||n.call(r);return}const o={},s={};return i.forEach((c,f)=>{Z(c.x)||(c.x=Math.random()*this.width),Z(c.y)||(c.y=Math.random()*this.height),o[c.id]=c,s[c.id]=f}),r.nodeMap=o,r.nodeIdxMap=s,r.run()}run(){var t;const n=this,r=n.nodes;if(!r)return;const{edges:i,maxIteration:a,workerEnabled:o,clustering:s,animate:c}=n,f={};if(s&&r.forEach(d=>{f[d.cluster]===void 0&&(f[d.cluster]={name:d.cluster,cx:0,cy:0,count:0})}),o||!c){for(let d=0;d<a;d++)n.runOneStep(f);(t=n.onLayoutEnd)===null||t===void 0||t.call(n)}else{if(typeof window=="undefined")return;let d=0;this.timeInterval=window.setInterval(()=>{var h;n.runOneStep(f),d++,d>=a&&((h=n.onLayoutEnd)===null||h===void 0||h.call(n),window.clearInterval(n.timeInterval))},0)}return{nodes:r,edges:i}}runOneStep(t){var n;const r=this,i=r.nodes;if(!i)return;const{edges:a,center:o,gravity:s,speed:c,clustering:f}=r,d=r.height*r.width,h=Math.sqrt(d)/10,v=d/(i.length+1),m=Math.sqrt(v),g=[];if(i.forEach((_,y)=>{g[y]={x:0,y:0}}),r.applyCalculate(i,a,g,m,v),f){for(const y in t)t[y].cx=0,t[y].cy=0,t[y].count=0;i.forEach(y=>{const E=t[y.cluster];Z(y.x)&&(E.cx+=y.x),Z(y.y)&&(E.cy+=y.y),E.count++});for(const y in t)t[y].cx/=t[y].count,t[y].cy/=t[y].count;const _=r.clusterGravity||s;i.forEach((y,E)=>{if(!Z(y.x)||!Z(y.y))return;const b=t[y.cluster],A=Math.sqrt((y.x-b.cx)*(y.x-b.cx)+(y.y-b.cy)*(y.y-b.cy)),C=m*_;g[E].x-=C*(y.x-b.cx)/A,g[E].y-=C*(y.y-b.cy)/A})}i.forEach((_,y)=>{if(!Z(_.x)||!Z(_.y))return;const E=.01*m*s;g[y].x-=E*(_.x-o[0]),g[y].y-=E*(_.y-o[1])}),i.forEach((_,y)=>{if(Z(_.fx)&&Z(_.fy)){_.x=_.fx,_.y=_.fy;return}if(!Z(_.x)||!Z(_.y))return;const E=Math.sqrt(g[y].x*g[y].x+g[y].y*g[y].y);if(E>0){const b=Math.min(h*(c/ZS),E);_.x+=g[y].x/E*b,_.y+=g[y].y/E*b}}),(n=r.tick)===null||n===void 0||n.call(r)}applyCalculate(t,n,r,i,a){const o=this;o.calRepulsive(t,r,a),n&&o.calAttractive(n,r,i)}calRepulsive(t,n,r){t.forEach((i,a)=>{n[a]={x:0,y:0},t.forEach((o,s)=>{if(a===s||!Z(i.x)||!Z(o.x)||!Z(i.y)||!Z(o.y))return;let c=i.x-o.x,f=i.y-o.y,d=c*c+f*f;if(d===0){d=1;const v=a>s?1:-1;c=.01*v,f=.01*v}const h=r/d;n[a].x+=c*h,n[a].y+=f*h})})}calAttractive(t,n,r){t.forEach(i=>{const a=ke(i,"source"),o=ke(i,"target");if(!a||!o)return;const s=this.nodeIdxMap[a],c=this.nodeIdxMap[o];if(s===c)return;const f=this.nodeMap[a],d=this.nodeMap[o];if(!Z(d.x)||!Z(f.x)||!Z(d.y)||!Z(f.y))return;const h=d.x-f.x,v=d.y-f.y,m=Math.sqrt(h*h+v*v),g=m*m/r;n[c].x-=h/m*g,n[c].y-=v/m*g,n[s].x+=h/m*g,n[s].y+=v/m*g})}stop(){this.timeInterval&&typeof window!="undefined"&&window.clearInterval(this.timeInterval)}destroy(){const t=this;t.stop(),t.tick=null,t.nodes=null,t.edges=null,t.destroyed=!0}getType(){return"fruchterman"}}function un(e,t,n,r){!n||Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}var nn=S(6610),En=S(5991);function cn(e,t,n,r,i){var a={};return Object.keys(r).forEach(function(o){a[o]=r[o]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(o,s){return s(e,t,o)||o},a),i&&a.initializer!==void 0&&(a.value=a.initializer?a.initializer.call(i):void 0,a.initializer=void 0),a.initializer===void 0&&(Object.defineProperty(e,t,a),a=null),a}var wR=S(28660),HS=S(87757),Kt=S.n(HS),Sr=S(92137),XS=-1,$S=1;function cc(){return $S++}var jl=function e(t){(0,nn.Z)(this,e)},Hl=function(){function e(t){(0,nn.Z)(this,e),this.clazz=void 0,this.components=[],this.entities=[],this.lookup={},this.clazz=t}return(0,En.Z)(e,[{key:"clear",value:function(){this.components=[],this.entities=[],this.lookup={}}},{key:"contains",value:function(n){return this.lookup[n]>-1}},{key:"create",value:function(n,r){this.lookup[n]=this.components.length;var i=new this.clazz(r||{});return this.components.push(i),this.entities.push(n),i}},{key:"remove",value:function(n){var r=this.lookup[n];r>-1&&r<this.components.length-1&&(this.components[r]=this.components[this.components.length-1],this.entities[r]=this.entities[this.entities.length-1],this.lookup[this.entities[r]]=r),this.components.pop(),this.entities.pop(),delete this.lookup[n]}},{key:"removeKeepSorted",value:function(n){var r=this.lookup[n];if(r>-1){var i=this.entities[r];if(r<this.components.length-1){for(var a=r+1;a<this.components.length;++a)this.components[a-1]=this.components[a];for(var o=r+1;o<this.entities.length;++o)this.entities[o-1]=this.entities[o],this.lookup[this.entities[o-1]]=o-1}this.components.pop(),this.entities.pop(),delete this.lookup[i]}}},{key:"moveItem",value:function(n,r){if(n!==r){for(var i=this.components[n],a=this.entities[n],o=n<r?1:-1,s=n;s!==r;s+=o){var c=s+o;this.components[s]=this.components[c],this.entities[s]=this.entities[c],this.lookup[this.entities[s]]=s}this.components[r]=i,this.entities[r]=a,this.lookup[a]=r}}},{key:"getEntity",value:function(n){return this.entities[n]}},{key:"getComponent",value:function(n){return this.components[n]}},{key:"getComponentByEntity",value:function(n){var r=this.lookup[n];return r>-1?this.components[r]:null}},{key:"getCount",value:function(){return this.components.length}},{key:"getEntityByComponentIndex",value:function(n){for(var r=0,i=Object.keys(this.lookup);r<i.length;r++){var a=i[r],o=Number(a);if(this.lookup[o]===n)return o}return XS}},{key:"find",value:function(n){for(var r=0;r<this.getCount();r++){var i=this.getComponent(r);if(n(i,r))return i}return null}},{key:"findIndex",value:function(n){for(var r=0;r<this.getCount();r++){var i=this.getComponent(r);if(n(i,r))return r}return-1}},{key:"forEach",value:function(n){for(var r=0,i=Object.keys(this.lookup);r<i.length;r++){var a=i[r],o=Number(a),s=this.lookup[o];n(o,this.getComponent(s))}}},{key:"forEachAsync",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(i){var a,o,s,c,f;return Kt().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:a=0,o=Object.keys(this.lookup);case 1:if(!(a<o.length)){h.next=10;break}return s=o[a],c=Number(s),f=this.lookup[c],h.next=7,i(c,this.getComponent(f));case 7:a++,h.next=1;break;case 10:case"end":return h.stop()}},r,this)}));function n(r){return t.apply(this,arguments)}return n}()},{key:"map",value:function(n){for(var r=[],i=0,a=Object.keys(this.lookup);i<a.length;i++){var o=a[i],s=Number(o),c=this.lookup[s];r.push(n(s,this.getComponent(c)))}return r}}]),e}(),k0=S(28481),_t=S(86700),Je={HierarchyComponentManager:Symbol("HierarchyComponentManager"),TransformComponentManager:Symbol("TransformComponentManager"),NameComponentManager:Symbol("NameComponentManager"),SceneGraphSystem:Symbol("SceneGraphSystem"),FrameGraphSystem:Symbol("FrameGraphSystem"),ResourcePool:Symbol("ResourcePool"),ResourceHandleComponentManager:Symbol("ResourceHandleComponentManager"),PassNodeComponentManager:Symbol("PassNodeComponentManager"),RendererSystem:Symbol("RendererSystem"),RenderPass:Symbol("RenderPass"),RenderPassFactory:Symbol("Factory<IRenderPass>"),Renderable:Symbol("Factory<IRenderPass>"),MeshSystem:Symbol("MeshSystem"),MeshComponentManager:Symbol("MeshComponentManager"),CullableComponentManager:Symbol("CullableComponentManager"),Geometry:Symbol("Geometry"),GeometrySystem:Symbol("GeometrySystem"),GeometryComponentManager:Symbol("GeometryComponentManager"),Material:Symbol("Material"),MaterialSystem:Symbol("MaterialSystem"),MaterialComponentManager:Symbol("MaterialComponentManager"),ForwardRenderPath:Symbol("ForwardRenderPath"),ComputeSystem:Symbol("ComputeSystem"),ComputeComponentManager:Symbol("ComputeComponentManager"),ComputeStrategy:Symbol("ComputeStrategy"),Systems:Symbol("Systems"),World:Symbol("World"),RenderEngine:Symbol("RenderEngine"),WebGPUEngine:Symbol("WebGPUEngine"),WebGLEngine:Symbol("WebGLEngine"),ShaderModuleService:Symbol("ShaderModuleService"),ConfigService:Symbol("ConfigService"),InteractorService:Symbol("InteractorService"),IEventEmitter:Symbol("IEventEmitter"),Light:Symbol("Light")},YS=function e(){(0,nn.Z)(this,e),this.index=void 0},KS=function e(){(0,nn.Z)(this,e),this.name=void 0,this.data=void 0,this.execute=void 0,this.tearDown=void 0},qS=function(){function e(){(0,nn.Z)(this,e),this.name=void 0,this.refCount=0,this.hasSideEffect=!1,this.devirtualize=[],this.destroy=[],this.reads=[],this.writes=[]}return(0,En.Z)(e,[{key:"read",value:function(n){return this.reads.find(function(r){return r.index===n.index})||this.reads.push(n),n}},{key:"sample",value:function(n){return this.read(n),n}},{key:"write",value:function(n,r){var i=this.writes.find(function(c){return c.index===r.index});if(i)return r;var a=n.getResourceNode(r);a.resource.version++,a.resource.imported&&(this.hasSideEffect=!0);var o=n.createResourceNode(a.resource),s=n.getResourceNode(o);return s.writer=this,this.writes.push(o),o}}]),e}(),Za=S(10379),ja=S(46070),Pr=S(77608),JS=function e(){(0,nn.Z)(this,e),this.first=void 0,this.last=void 0};function QS(e){var t=e2();return function(){var r=(0,Pr.Z)(e),i;if(t){var a=(0,Pr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ja.Z)(this,i)}}function e2(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var _1=function(e){(0,Za.Z)(n,e);var t=QS(n);function n(){var r;(0,nn.Z)(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return r=t.call.apply(t,[this].concat(a)),r.version=0,r.refs=0,r.name=void 0,r.imported=void 0,r.priority=void 0,r.discardStart=!0,r.discardEnd=!1,r.descriptor=void 0,r.resource=void 0,r}return(0,En.Z)(n,[{key:"preExecuteDestroy",value:function(){this.discardEnd=!0}},{key:"postExecuteDestroy",value:function(){!this.imported}},{key:"postExecuteDevirtualize",value:function(){this.discardStart=!1}},{key:"preExecuteDevirtualize",value:function(){!this.imported}}]),n}(JS),t2=function e(){(0,nn.Z)(this,e),this.resource=void 0,this.writer=void 0,this.readerCount=0,this.version=void 0},E1,b1,w1,hy,x1,S1;function Bs(e,t){var n;if(typeof Symbol=="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(n=n2(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(f){throw f},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){n=e[Symbol.iterator]()},n:function(){var f=n.next();return a=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!a&&n.return!=null&&n.return()}finally{if(o)throw s}}}}function n2(e,t){if(!!e){if(typeof e=="string")return T1(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T1(e,t)}}function T1(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var r2=(E1=(0,_t.b2)(),b1=(0,_t.f3)(Je.RenderEngine),E1(w1=(hy=(S1=function(){function e(){(0,nn.Z)(this,e),this.passNodes=[],this.resourceNodes=[],this.frameGraphPasses=[],un(this,"engine",x1,this)}return(0,En.Z)(e,[{key:"execute",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(i){return Kt().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.compile(),o.next=3,this.executePassNodes(i);case 3:case"end":return o.stop()}},r,this)}));function n(r){return t.apply(this,arguments)}return n}()},{key:"tearDown",value:function(){this.frameGraphPasses.forEach(function(n){n.tearDown&&n.tearDown()}),this.reset()}},{key:"addPass",value:function(n,r,i,a){var o=new KS;o.execute=i,a&&(o.tearDown=a),o.name=n;var s=new qS;return s.name=n,this.passNodes.push(s),this.frameGraphPasses.push(o),r(this,s,o),o}},{key:"getPass",value:function(n){return this.frameGraphPasses.find(function(r){return r.name===n})}},{key:"compile",value:function(){var n=this,r=Bs(this.passNodes),i;try{for(r.s();!(i=r.n()).done;){var a=i.value;a.refCount=a.writes.length+(a.hasSideEffect?1:0),a.reads.forEach(function(bn){n.resourceNodes[bn.index].readerCount++})}}catch(bn){r.e(bn)}finally{r.f()}var o=[],s=Bs(this.resourceNodes),c;try{for(s.s();!(c=s.n()).done;){var f=c.value;f.readerCount===0&&o.push(f)}}catch(bn){s.e(bn)}finally{s.f()}for(;o.length;){var d=o.pop(),h=d&&d.writer;if(h&&--h.refCount==0){var v=Bs(h.reads),m;try{for(v.s();!(m=v.n()).done;){var g=m.value,_=this.resourceNodes[g.index];--_.readerCount==0&&o.push(_)}}catch(bn){v.e(bn)}finally{v.f()}}}this.resourceNodes.forEach(function(bn){bn.resource.refs+=bn.readerCount});var y=Bs(this.passNodes),E;try{for(y.s();!(E=y.n()).done;){var b=E.value;if(!!b.refCount){var A=Bs(b.reads),C;try{for(A.s();!(C=A.n()).done;){var R=C.value,W=this.resourceNodes[R.index].resource;W.first=W.first?W.first:b,W.last=b}}catch(bn){A.e(bn)}finally{A.f()}var te=Bs(b.writes),Q;try{for(te.s();!(Q=te.n()).done;){var re=Q.value,de=this.resourceNodes[re.index].resource;de.first=de.first?de.first:b,de.last=b}}catch(bn){te.e(bn)}finally{te.f()}}}}catch(bn){y.e(bn)}finally{y.f()}for(var Ce=0;Ce<2;Ce++){var ie=Bs(this.resourceNodes),Ge;try{for(ie.s();!(Ge=ie.n()).done;){var We=Ge.value,It=We.resource;if(It.priority===Ce&&It.refs){var gn=It.first,pn=It.last;gn&&pn&&(gn.devirtualize.push(It),pn.destroy.push(It))}}}catch(bn){ie.e(bn)}finally{ie.f()}}}},{key:"executePassNodes",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(i){var a,o,s,c,f,d,h,v,m,g,_,y,E,b,A,C,R;return Kt().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:a=Bs(this.passNodes.entries()),te.prev=1,a.s();case 3:if((o=a.n()).done){te.next=18;break}if(s=(0,k0.Z)(o.value,2),c=s[0],f=s[1],!f.refCount){te.next=16;break}d=Bs(f.devirtualize);try{for(d.s();!(h=d.n()).done;)v=h.value,v.preExecuteDevirtualize(this.engine)}catch(Q){d.e(Q)}finally{d.f()}m=Bs(f.destroy);try{for(m.s();!(g=m.n()).done;)_=g.value,_.preExecuteDestroy(this.engine)}catch(Q){m.e(Q)}finally{m.f()}return te.next=12,this.frameGraphPasses[c].execute(this,this.frameGraphPasses[c],i);case 12:y=Bs(f.devirtualize);try{for(y.s();!(E=y.n()).done;)b=E.value,b.postExecuteDevirtualize(this.engine)}catch(Q){y.e(Q)}finally{y.f()}A=Bs(f.destroy);try{for(A.s();!(C=A.n()).done;)R=C.value,R.postExecuteDestroy(this.engine)}catch(Q){A.e(Q)}finally{A.f()}case 16:te.next=3;break;case 18:te.next=23;break;case 20:te.prev=20,te.t0=te.catch(1),a.e(te.t0);case 23:return te.prev=23,a.f(),te.finish(23);case 26:this.reset();case 27:case"end":return te.stop()}},r,this,[[1,20,23,26]])}));function n(r){return t.apply(this,arguments)}return n}()},{key:"reset",value:function(){this.passNodes=[],this.resourceNodes=[],this.frameGraphPasses=[]}},{key:"getResourceNode",value:function(n){return this.resourceNodes[n.index]}},{key:"createResourceNode",value:function(n){var r=new t2;r.resource=n,r.version=n.version,this.resourceNodes.push(r);var i=new YS;return i.index=this.resourceNodes.length-1,i}},{key:"createTexture",value:function(n,r,i){var a=new _1;return a.name=r,a.descriptor=i,this.createResourceNode(a)}},{key:"createRenderTarget",value:function(n,r,i){var a=new _1;return a.name=r,a.descriptor=i,this.createResourceNode(a)}},{key:"present",value:function(n){this.addPass("Present",function(r,i){i.read(n),i.hasSideEffect=!0},(0,Sr.Z)(Kt().mark(function r(){return Kt().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:case"end":return a.stop()}},r)})))}}]),e}(),S1),x1=cn(hy.prototype,"engine",[b1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hy))||w1),ze=S(96156),ji=S(63349),ba=S(49685);function Cv(){var e=new ba.WT(4);return ba.WT!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function i2(e){var t=new ba.WT(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function A1(e,t,n,r){var i=new ba.WT(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}function a2(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function o2(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e}function s2(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}function xR(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function SR(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}function TR(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e}function AR(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function IR(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function CR(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e}function RR(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e}function MR(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function u2(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function NR(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e}function DR(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return Math.hypot(n,r,i,a)}function PR(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return n*n+r*r+i*i+a*a}function c2(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.hypot(t,n,r,i)}function f2(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i}function OR(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function LR(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function l2(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n*n+r*r+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),e[0]=n*o,e[1]=r*o,e[2]=i*o,e[3]=a*o,e}function d2(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function GR(e,t,n,r){var i=n[0]*r[1]-n[1]*r[0],a=n[0]*r[2]-n[2]*r[0],o=n[0]*r[3]-n[3]*r[0],s=n[1]*r[2]-n[2]*r[1],c=n[1]*r[3]-n[3]*r[1],f=n[2]*r[3]-n[3]*r[2],d=t[0],h=t[1],v=t[2],m=t[3];return e[0]=h*f-v*c+m*s,e[1]=-(d*f)+v*o-m*a,e[2]=d*c-h*o+m*i,e[3]=-(d*s)+h*a-v*i,e}function h2(e,t,n,r){var i=t[0],a=t[1],o=t[2],s=t[3];return e[0]=i+r*(n[0]-i),e[1]=a+r*(n[1]-a),e[2]=o+r*(n[2]-o),e[3]=s+r*(n[3]-s),e}function kR(e,t){t=t||1;var n,r,i,a,o,s;do n=glMatrix.RANDOM()*2-1,r=glMatrix.RANDOM()*2-1,o=n*n+r*r;while(o>=1);do i=glMatrix.RANDOM()*2-1,a=glMatrix.RANDOM()*2-1,s=i*i+a*a;while(s>=1);var c=Math.sqrt((1-o)/s);return e[0]=t*n,e[1]=t*r,e[2]=t*i*c,e[3]=t*a*c,e}function Rv(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*o,e[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*o,e[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*o,e[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*o,e}function FR(e,t,n){var r=t[0],i=t[1],a=t[2],o=n[0],s=n[1],c=n[2],f=n[3],d=f*r+s*a-c*i,h=f*i+c*r-o*a,v=f*a+o*i-s*r,m=-o*r-s*i-c*a;return e[0]=d*f+m*-o+h*-c-v*-s,e[1]=h*f+m*-s+v*-o-d*-c,e[2]=v*f+m*-c+d*-s-h*-o,e[3]=t[3],e}function UR(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function BR(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function v2(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function p2(e,t){var n=e[0],r=e[1],i=e[2],a=e[3],o=t[0],s=t[1],c=t[2],f=t[3];return Math.abs(n-o)<=ba.Ib*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-s)<=ba.Ib*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-c)<=ba.Ib*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(a-f)<=ba.Ib*Math.max(1,Math.abs(a),Math.abs(f))}var zR=null,WR=null,VR=null,ZR=null,jR=null,HR=null,XR=null,$R=function(){var e=Cv();return function(t,n,r,i,a,o){var s,c;for(n||(n=4),r||(r=0),i?c=Math.min(i*n+r,t.length):c=t.length,s=r;s<c;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],a(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}(),Xl=S(35600),Re=S(77160),_h=S(90484),m2=9007199254740991,g2="[object Arguments]",y2="[object Array]",_2="[object Boolean]",E2="[object Date]",b2="[object Error]",w2="[object Function]",x2="[object Map]",S2="[object Number]",T2="[object Object]",A2="[object RegExp]",I2="[object Set]",C2="[object String]",R2="[object WeakMap]",M2="[object ArrayBuffer]",N2="[object DataView]",D2="[object Float32Array]",P2="[object Float64Array]",O2="[object Int8Array]",L2="[object Int16Array]",G2="[object Int32Array]",k2="[object Uint8Array]",F2="[object Uint8ClampedArray]",U2="[object Uint16Array]",B2="[object Uint32Array]",Ti={};Ti[D2]=Ti[P2]=Ti[O2]=Ti[L2]=Ti[G2]=Ti[k2]=Ti[F2]=Ti[U2]=Ti[B2]=!0,Ti[g2]=Ti[y2]=Ti[M2]=Ti[_2]=Ti[N2]=Ti[E2]=Ti[b2]=Ti[w2]=Ti[x2]=Ti[S2]=Ti[T2]=Ti[A2]=Ti[I2]=Ti[C2]=Ti[R2]=!1;function YR(e){return function(t){return e(t)}}var z2=Object.prototype,W2=z2.toString;function V2(e){return j2(e)&&Z2(e.length)&&!!Ti[W2.call(e)]}function Z2(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=m2}function j2(e){return!!e&&(0,_h.Z)(e)==="object"}var I1=V2;function C1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function R1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?C1(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C1(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function H2(e){var t=X2();return function(){var r=(0,Pr.Z)(e),i;if(t){var a=(0,Pr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ja.Z)(this,i)}}function X2(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var $2=function(e){(0,Za.Z)(n,e);var t=H2(n);function n(r){var i;return(0,nn.Z)(this,n),i=t.call(this,r),i.dirty=!0,i.attributes=[],i.indices=void 0,i.indicesBuffer=void 0,i.vertexCount=0,i.maxInstancedCount=void 0,i.aabb=void 0,i.entity=void 0,Object.assign((0,ji.Z)(i),r),i}return(0,En.Z)(n,[{key:"setAttribute",value:function(i,a,o,s){var c=this.attributes.find(function(f){return f.name===i});return c?(c.data=a,c.dirty=!0):this.attributes.push(R1(R1({dirty:!0,name:i,data:a},o),{},{bufferGetter:s})),this.dirty=!0,this}},{key:"setIndex",value:function(i){return this.indices=new Uint32Array(i.buffer?i.buffer:i),this.dirty=!0,this}},{key:"applyMatrix",value:function(i){var a=this.attributes.find(function(v){var m=v.name;return m==="position"}),o=this.attributes.find(function(v){var m=v.name;return m==="normal"});if(a&&(a.dirty=!0,a.data&&a.data.length))for(var s=0;s<a.data.length;s+=3){var c=A1(a.data[s],a.data[s+1],a.data[s+2],1);Rv(c,c,i),I1(a.data)?a.data.set([c[0],c[1],c[2]],s):(a.data[s]=c[0],a.data[s+1]=c[1],a.data[s+2]=c[2])}if(o){var f=Xl.XL(Xl.Ue(),i);if(o.data&&o.data.length)for(var d=0;d<o.data.length;d+=3){var h=Re.al(o.data[d],o.data[d+1],o.data[d+2]);Re.kK(h,h,f),Re.Fv(h,h),I1(o.data)?o.data.set([h[0],h[1],h[2]],d):(o.data[d]=h[0],o.data[d+1]=h[1],o.data[d+2]=h[2])}}}}]),n}(jl),ve;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.COPY_SRC=1]="COPY_SRC",e[e.COPY_DST=2]="COPY_DST",e[e.SAMPLED=4]="SAMPLED",e[e.STORAGE=8]="STORAGE",e[e.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(ve||(ve={}));var M1,N1,D1,P1,F0,O1,L1,G1,Y2=(M1=(0,_t.b2)(),N1=(0,_t.f3)(Je.GeometryComponentManager),D1=(0,_t.f3)(Je.RenderEngine),M1(P1=(F0=(G1=function(){function e(){(0,nn.Z)(this,e),un(this,"geometry",O1,this),un(this,"engine",L1,this)}return(0,En.Z)(e,[{key:"execute",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(){var i=this;return Kt().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:this.geometry.forEach(function(s,c){c.dirty&&(c.attributes.forEach(function(f){if(f.dirty&&f.data){if(!f.buffer)f.buffer=i.engine.createBuffer({data:f.data,type:ve.FLOAT});else{var d;(d=f.buffer)===null||d===void 0||d.subData({data:f.data,offset:0})}f.dirty=!1}}),c.indices&&(c.indicesBuffer?c.indicesBuffer.subData({data:c.indices,offset:0}):c.indicesBuffer=i.engine.createElements({data:c.indices,count:c.indices.length,type:ve.UNSIGNED_INT,usage:ve.STATIC_DRAW})),c.dirty=!1)});case 1:case"end":return o.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"tearDown",value:function(){this.geometry.forEach(function(n,r){r.indicesBuffer&&r.indicesBuffer.destroy(),r.attributes.forEach(function(i){i.buffer&&i.buffer.destroy()})}),this.geometry.clear()}},{key:"createBufferGeometry",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{vertexCount:3},r=n.vertexCount,i=cc();return this.geometry.create(i,{vertexCount:r})}},{key:"createInstancedBufferGeometry",value:function(n){var r=n.maxInstancedCount,i=n.vertexCount,a=cc();return this.geometry.create(a,{maxInstancedCount:r,vertexCount:i})}}]),e}(),G1),O1=cn(F0.prototype,"geometry",[N1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L1=cn(F0.prototype,"engine",[D1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F0))||P1);function k1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function F1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?k1(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k1(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function K2(e){var t=q2();return function(){var r=(0,Pr.Z)(e),i;if(t){var a=(0,Pr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ja.Z)(this,i)}}function q2(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var J2=function(e){(0,Za.Z)(n,e);var t=K2(n);function n(r){var i;return(0,nn.Z)(this,n),i=t.call(this,r),i.vertexShaderGLSL=void 0,i.fragmentShaderGLSL=void 0,i.defines={},i.dirty=!0,i.uniforms=[],i.cull={enable:!0,face:ve.BACK},i.depth={enable:!0},i.blend=void 0,i.entity=void 0,i.type=void 0,Object.assign((0,ji.Z)(i),r),i}return(0,En.Z)(n,[{key:"setDefines",value:function(i){return this.defines=F1(F1({},this.defines),i),this}},{key:"setCull",value:function(i){return this.cull=i,this}},{key:"setDepth",value:function(i){return this.depth=i,this}},{key:"setBlend",value:function(i){return this.blend=i,this}},{key:"setUniform",value:function(i,a){var o=this;if(typeof i!="string")return Object.keys(i).forEach(function(c){return o.setUniform(c,i[c])}),this;var s=this.uniforms.find(function(c){return c.name===i});return s?(s.dirty=!0,s.data=a):this.uniforms.push({name:i,dirty:!0,data:a}),this.dirty=!0,this}}]),n}(jl),U1,B1,z1,W1,V1,Mv,Z1,j1,H1,X1;function $1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Y1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$1(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$1(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Q2=(U1=(0,_t.b2)(),B1=(0,_t.f3)(Je.MaterialComponentManager),z1=(0,_t.f3)(Je.RenderEngine),W1=(0,_t.f3)(Je.ShaderModuleService),U1(V1=(Mv=(X1=function(){function e(){(0,nn.Z)(this,e),un(this,"material",Z1,this),un(this,"engine",j1,this),un(this,"shaderModule",H1,this)}return(0,En.Z)(e,[{key:"execute",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(){return Kt().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:case"end":return a.stop()}},r)}));function n(){return t.apply(this,arguments)}return n}()},{key:"tearDown",value:function(){this.material.clear()}},{key:"createShaderMaterial",value:function(n){var r=cc(),i=n.vertexShader,a=n.fragmentShader,o=[];if(!this.engine.supportWebGPU){var s="material-".concat(r);this.shaderModule.registerModule(s,{vs:n.vertexShader,fs:n.fragmentShader});var c=this.shaderModule.getModule(s);i=c.vs,a=c.fs,c.uniforms&&(o=Object.keys(c.uniforms).map(function(f){return{dirty:!0,name:f,data:c.uniforms[f]}}))}return this.material.create(r,Y1(Y1({vertexShaderGLSL:i,fragmentShaderGLSL:a},n),{},{uniforms:o}))}}]),e}(),X1),Z1=cn(Mv.prototype,"material",[B1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j1=cn(Mv.prototype,"engine",[z1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H1=cn(Mv.prototype,"shaderModule",[W1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mv))||V1);function eT(e){var t=tT();return function(){var r=(0,Pr.Z)(e),i;if(t){var a=(0,Pr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ja.Z)(this,i)}}function tT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var vy;(function(e){e[e.Standard=0]="Standard"})(vy||(vy={}));var nT=function(e){(0,Za.Z)(n,e);var t=eT(n);function n(r){var i;return(0,nn.Z)(this,n),i=t.call(this,r),i.strategy=vy.Standard,i.visibilityPlaneMask=0,i.visible=!1,Object.assign((0,ji.Z)(i),r),i}return n}(jl),py=function(){function e(t,n){(0,nn.Z)(this,e),this.center=void 0,this.halfExtents=void 0,this.min=Re.Ue(),this.max=Re.Ue(),this.update(t,n)}return(0,En.Z)(e,[{key:"update",value:function(n,r){this.center=n||Re.Ue(),this.halfExtents=r||Re.al(.5,.5,.5),this.min=Re.lu(this.min,this.center,this.halfExtents),this.max=Re.IH(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(n,r){Re.IH(this.center,r,n),Re.bA(this.center,this.center,.5),Re.lu(this.halfExtents,r,n),Re.bA(this.halfExtents,this.halfExtents,.5),Re.JG(this.min,n),Re.JG(this.max,r)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(n){var r=this.center,i=r[0],a=r[1],o=r[2],s=this.halfExtents,c=s[0],f=s[1],d=s[2],h=i-c,v=i+c,m=a-f,g=a+f,_=o-d,y=o+d,E=n.center,b=E[0],A=E[1],C=E[2],R=n.halfExtents,W=R[0],te=R[1],Q=R[2],re=b-W,de=b+W,Ce=A-te,ie=A+te,Ge=C-Q,We=C+Q;re<h&&(h=re),de>v&&(v=de),Ce<m&&(m=Ce),ie>g&&(g=ie),Ge<_&&(_=Ge),We>y&&(y=We),r[0]=(h+v)*.5,r[1]=(m+g)*.5,r[2]=(_+y)*.5,s[0]=(v-h)*.5,s[1]=(g-m)*.5,s[2]=(y-_)*.5,this.min[0]=h,this.min[1]=m,this.min[2]=_,this.max[0]=v,this.max[1]=g,this.max[2]=y}},{key:"intersects",value:function(n){var r=this.getMax(),i=this.getMin(),a=n.getMax(),o=n.getMin();return i[0]<=a[0]&&r[0]>=o[0]&&i[1]<=a[1]&&r[1]>=o[1]&&i[2]<=a[2]&&r[2]>=o[2]}},{key:"containsPoint",value:function(n){var r=this.getMin(),i=this.getMax();return!(n[0]<r[0]||n[0]>i[0]||n[1]<r[1]||n[1]>i[1]||n[2]<r[2]||n[2]>i[2])}},{key:"getNegativeFarPoint",value:function(n){return n.pnVertexFlag===273?Re.JG(Re.Ue(),this.min):n.pnVertexFlag===272?Re.al(this.min[0],this.min[1],this.max[2]):n.pnVertexFlag===257?Re.al(this.min[0],this.max[1],this.min[2]):n.pnVertexFlag===256?Re.al(this.min[0],this.max[1],this.max[2]):n.pnVertexFlag===17?Re.al(this.max[0],this.min[1],this.min[2]):n.pnVertexFlag===16?Re.al(this.max[0],this.min[1],this.max[2]):n.pnVertexFlag===1?Re.al(this.max[0],this.max[1],this.min[2]):Re.al(this.max[0],this.max[1],this.max[2])}},{key:"getPositiveFarPoint",value:function(n){return n.pnVertexFlag===273?Re.JG(Re.Ue(),this.max):n.pnVertexFlag===272?Re.al(this.max[0],this.max[1],this.min[2]):n.pnVertexFlag===257?Re.al(this.max[0],this.min[1],this.max[2]):n.pnVertexFlag===256?Re.al(this.max[0],this.min[1],this.min[2]):n.pnVertexFlag===17?Re.al(this.min[0],this.max[1],this.max[2]):n.pnVertexFlag===16?Re.al(this.min[0],this.max[1],this.min[2]):n.pnVertexFlag===1?Re.al(this.min[0],this.min[1],this.max[2]):Re.al(this.min[0],this.min[1],this.min[2])}}]),e}();function rT(e){var t=iT();return function(){var r=(0,Pr.Z)(e),i;if(t){var a=(0,Pr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ja.Z)(this,i)}}function iT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var aT=function(e){(0,Za.Z)(n,e);var t=rT(n);function n(r){var i;return(0,nn.Z)(this,n),i=t.call(this,r),i.material=void 0,i.geometry=void 0,i.aabb=new py,i.aabbDirty=!0,i.model=void 0,i.visible=!0,i.children=[],Object.assign((0,ji.Z)(i),r),i}return n}(jl),oT=function(){function e(t,n){(0,nn.Z)(this,e),this.distance=void 0,this.normal=void 0,this.pnVertexFlag=void 0,this.distance=t||0,this.normal=n||Re.al(0,1,0),this.updatePNVertexFlag()}return(0,En.Z)(e,[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(n){return Re.AK(n,this.normal)-this.distance}},{key:"normalize",value:function(){var n=1/Re.Zh(this.normal);Re.bA(this.normal,this.normal,n),this.distance*=n}},{key:"intersectsLine",value:function(n,r,i){var a=this.distanceToPoint(n),o=this.distanceToPoint(r),s=a/(a-o),c=s>=0&&s<=1;return c&&i&&Re.t7(i,n,r,s),c}}]),e}(),tl;(function(e){e[e.OUTSIDE=4294967295]="OUTSIDE",e[e.INSIDE=0]="INSIDE",e[e.INDETERMINATE=2147483647]="INDETERMINATE"})(tl||(tl={}));var sT=function(){function e(t){if((0,nn.Z)(this,e),this.planes=[],t)this.planes=t;else for(var n=0;n<6;n++)this.planes.push(new oT)}return(0,En.Z)(e,[{key:"extractFromVPMatrix",value:function(n){var r=(0,k0.Z)(n,16),i=r[0],a=r[1],o=r[2],s=r[3],c=r[4],f=r[5],d=r[6],h=r[7],v=r[8],m=r[9],g=r[10],_=r[11],y=r[12],E=r[13],b=r[14],A=r[15];Re.t8(this.planes[0].normal,s-i,h-c,_-v),this.planes[0].distance=-(A-y),Re.t8(this.planes[1].normal,s+i,h+c,_+v),this.planes[1].distance=-(A+y),Re.t8(this.planes[2].normal,s+a,h+f,_+m),this.planes[2].distance=-(A+E),Re.t8(this.planes[3].normal,s-a,h-f,_-m),this.planes[3].distance=-(A-E),Re.t8(this.planes[4].normal,s-o,h-d,_-g),this.planes[4].distance=-(A-b),Re.t8(this.planes[5].normal,s+o,h+d,_+g),this.planes[5].distance=-(A+b),this.planes.forEach(function(C){C.normalize(),C.updatePNVertexFlag()})}}]),e}();function KR(e){return typeof e=="number"}function qR(e){return e===void 0?0:e>360||e<-360?e%360:e}function JR(e,t,n){return isNumber(e)?vec3.fromValues(e,t,n):e.length===3?vec3.clone(e):vec3.fromValues(e[0],e[1],e[2])}function uT(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function cT(e){var t=(0,k0.Z)(e,3),n=t[0],r=t[1],i=t[2],a=n+r*256+i*65536-1;return a}function QR(e){return[e+1&255,e+1>>8&255,e+1>>8>>8&255]}var K1,q1,J1,Q1,e_,t_,n_,$l,r_,i_,a_,o_,s_,u_;function c_(e,t){var n;if(typeof Symbol=="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(n=fT(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(f){throw f},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){n=e[Symbol.iterator]()},n:function(){var f=n.next();return a=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!a&&n.return!=null&&n.return()}finally{if(o)throw s}}}}function fT(e,t){if(!!e){if(typeof e=="string")return f_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f_(e,t)}}function f_(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var lT=(K1=(0,_t.b2)(),q1=(0,_t.f3)(Je.MeshComponentManager),J1=(0,_t.f3)(Je.CullableComponentManager),Q1=(0,_t.f3)(Je.GeometryComponentManager),e_=(0,_t.f3)(Je.HierarchyComponentManager),t_=(0,_t.f3)(Je.TransformComponentManager),K1(n_=($l=(u_=function(){function e(){(0,nn.Z)(this,e),un(this,"mesh",r_,this),un(this,"cullable",i_,this),un(this,"geometry",a_,this),un(this,"hierarchy",o_,this),un(this,"transform",s_,this),this.planes=void 0}return(0,En.Z)(e,[{key:"setFrustumPlanes",value:function(n){this.planes=n}},{key:"execute",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(i){var a,o,s,c,f,d,h,v,m,g,_,y,E,b,A,C,R,W,te,Q,re;return Kt().wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:a=c_(i);try{for(a.s();!(o=a.n()).done;){s=o.value,c=s.getScene(),f=s.getCamera(),d=c_(c.getEntities());try{for(d.s();!(h=d.n()).done;)v=h.value,m=this.mesh.getComponentByEntity(v),m&&(g=this.hierarchy.getComponentByEntity(v),_=this.cullable.getComponentByEntity(v),y=m.geometry,E=this.transform.getComponentByEntity(v),y&&y.aabb&&E&&m.aabbDirty&&(b=E.worldTransform,A=y.aabb,C=A.center,R=A.halfExtents,W=Re.fF(Re.Ue(),C,b),te=uT(b,Xl.Ue()),Q=Re.kK(Re.Ue(),R,te),m.aabb.update(W,Q),m.aabbDirty=!1),_&&y&&(re=this.cullable.getComponentByEntity((g==null?void 0:g.parentID)||-1),_.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(m.aabb,(re==null?void 0:re.visibilityPlaneMask)||tl.INDETERMINATE,this.planes||f.getFrustum().planes),_.visible=_.visibilityPlaneMask!==tl.OUTSIDE))}catch(ie){d.e(ie)}finally{d.f()}}}catch(ie){a.e(ie)}finally{a.f()}case 2:case"end":return Ce.stop()}},r,this)}));function n(r){return t.apply(this,arguments)}return n}()},{key:"tearDown",value:function(){this.cullable.clear(),this.mesh.clear()}},{key:"computeVisibilityWithPlaneMask",value:function(n,r,i){if(r===tl.OUTSIDE||r===tl.INSIDE)return r;for(var a=tl.INSIDE,o=0,s=i.length;o<s;++o){var c=o<31?1<<o:0;if(!(o<31&&(r&c)==0)){var f=i[o],d=f.normal,h=f.distance;if(Re.AK(d,n.getNegativeFarPoint(i[o]))+h>0)return tl.OUTSIDE;Re.AK(d,n.getPositiveFarPoint(i[o]))+h>0&&(a|=c)}}return a}}]),e}(),u_),r_=cn($l.prototype,"mesh",[q1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i_=cn($l.prototype,"cullable",[J1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a_=cn($l.prototype,"geometry",[Q1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o_=cn($l.prototype,"hierarchy",[e_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s_=cn($l.prototype,"transform",[t_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$l))||n_);function Go(){var e=new ba.WT(16);return ba.WT!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function dT(e){var t=new ba.WT(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function my(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function eM(e,t,n,r,i,a,o,s,c,f,d,h,v,m,g,_){var y=new glMatrix.ARRAY_TYPE(16);return y[0]=e,y[1]=t,y[2]=n,y[3]=r,y[4]=i,y[5]=a,y[6]=o,y[7]=s,y[8]=c,y[9]=f,y[10]=d,y[11]=h,y[12]=v,y[13]=m,y[14]=g,y[15]=_,y}function tM(e,t,n,r,i,a,o,s,c,f,d,h,v,m,g,_,y){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=c,e[8]=f,e[9]=d,e[10]=h,e[11]=v,e[12]=m,e[13]=g,e[14]=_,e[15]=y,e}function l_(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function nM(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function U0(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],f=t[7],d=t[8],h=t[9],v=t[10],m=t[11],g=t[12],_=t[13],y=t[14],E=t[15],b=n*s-r*o,A=n*c-i*o,C=n*f-a*o,R=r*c-i*s,W=r*f-a*s,te=i*f-a*c,Q=d*_-h*g,re=d*y-v*g,de=d*E-m*g,Ce=h*y-v*_,ie=h*E-m*_,Ge=v*E-m*y,We=b*Ge-A*ie+C*Ce+R*de-W*re+te*Q;return We?(We=1/We,e[0]=(s*Ge-c*ie+f*Ce)*We,e[1]=(i*ie-r*Ge-a*Ce)*We,e[2]=(_*te-y*W+E*R)*We,e[3]=(v*W-h*te-m*R)*We,e[4]=(c*de-o*Ge-f*re)*We,e[5]=(n*Ge-i*de+a*re)*We,e[6]=(y*C-g*te-E*A)*We,e[7]=(d*te-v*C+m*A)*We,e[8]=(o*ie-s*de+f*Q)*We,e[9]=(r*de-n*ie-a*Q)*We,e[10]=(g*W-_*C+E*b)*We,e[11]=(h*C-d*W-m*b)*We,e[12]=(s*re-o*Ce-c*Q)*We,e[13]=(n*Ce-r*re+i*Q)*We,e[14]=(_*A-g*R-y*b)*We,e[15]=(d*R-h*A+v*b)*We,e):null}function rM(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],f=t[7],d=t[8],h=t[9],v=t[10],m=t[11],g=t[12],_=t[13],y=t[14],E=t[15];return e[0]=s*(v*E-m*y)-h*(c*E-f*y)+_*(c*m-f*v),e[1]=-(r*(v*E-m*y)-h*(i*E-a*y)+_*(i*m-a*v)),e[2]=r*(c*E-f*y)-s*(i*E-a*y)+_*(i*f-a*c),e[3]=-(r*(c*m-f*v)-s*(i*m-a*v)+h*(i*f-a*c)),e[4]=-(o*(v*E-m*y)-d*(c*E-f*y)+g*(c*m-f*v)),e[5]=n*(v*E-m*y)-d*(i*E-a*y)+g*(i*m-a*v),e[6]=-(n*(c*E-f*y)-o*(i*E-a*y)+g*(i*f-a*c)),e[7]=n*(c*m-f*v)-o*(i*m-a*v)+d*(i*f-a*c),e[8]=o*(h*E-m*_)-d*(s*E-f*_)+g*(s*m-f*h),e[9]=-(n*(h*E-m*_)-d*(r*E-a*_)+g*(r*m-a*h)),e[10]=n*(s*E-f*_)-o*(r*E-a*_)+g*(r*f-a*s),e[11]=-(n*(s*m-f*h)-o*(r*m-a*h)+d*(r*f-a*s)),e[12]=-(o*(h*y-v*_)-d*(s*y-c*_)+g*(s*v-c*h)),e[13]=n*(h*y-v*_)-d*(r*y-i*_)+g*(r*v-i*h),e[14]=-(n*(s*y-c*_)-o*(r*y-i*_)+g*(r*c-i*s)),e[15]=n*(s*v-c*h)-o*(r*v-i*h)+d*(r*c-i*s),e}function iM(e){var t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],c=e[7],f=e[8],d=e[9],h=e[10],v=e[11],m=e[12],g=e[13],_=e[14],y=e[15],E=t*o-n*a,b=t*s-r*a,A=t*c-i*a,C=n*s-r*o,R=n*c-i*o,W=r*c-i*s,te=f*g-d*m,Q=f*_-h*m,re=f*y-v*m,de=d*_-h*g,Ce=d*y-v*g,ie=h*y-v*_;return E*ie-b*Ce+A*de+C*re-R*Q+W*te}function Yl(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],f=t[6],d=t[7],h=t[8],v=t[9],m=t[10],g=t[11],_=t[12],y=t[13],E=t[14],b=t[15],A=n[0],C=n[1],R=n[2],W=n[3];return e[0]=A*r+C*s+R*h+W*_,e[1]=A*i+C*c+R*v+W*y,e[2]=A*a+C*f+R*m+W*E,e[3]=A*o+C*d+R*g+W*b,A=n[4],C=n[5],R=n[6],W=n[7],e[4]=A*r+C*s+R*h+W*_,e[5]=A*i+C*c+R*v+W*y,e[6]=A*a+C*f+R*m+W*E,e[7]=A*o+C*d+R*g+W*b,A=n[8],C=n[9],R=n[10],W=n[11],e[8]=A*r+C*s+R*h+W*_,e[9]=A*i+C*c+R*v+W*y,e[10]=A*a+C*f+R*m+W*E,e[11]=A*o+C*d+R*g+W*b,A=n[12],C=n[13],R=n[14],W=n[15],e[12]=A*r+C*s+R*h+W*_,e[13]=A*i+C*c+R*v+W*y,e[14]=A*a+C*f+R*m+W*E,e[15]=A*o+C*d+R*g+W*b,e}function Nv(e,t,n){var r=n[0],i=n[1],a=n[2],o,s,c,f,d,h,v,m,g,_,y,E;return t===e?(e[12]=t[0]*r+t[4]*i+t[8]*a+t[12],e[13]=t[1]*r+t[5]*i+t[9]*a+t[13],e[14]=t[2]*r+t[6]*i+t[10]*a+t[14],e[15]=t[3]*r+t[7]*i+t[11]*a+t[15]):(o=t[0],s=t[1],c=t[2],f=t[3],d=t[4],h=t[5],v=t[6],m=t[7],g=t[8],_=t[9],y=t[10],E=t[11],e[0]=o,e[1]=s,e[2]=c,e[3]=f,e[4]=d,e[5]=h,e[6]=v,e[7]=m,e[8]=g,e[9]=_,e[10]=y,e[11]=E,e[12]=o*r+d*i+g*a+t[12],e[13]=s*r+h*i+_*a+t[13],e[14]=c*r+v*i+y*a+t[14],e[15]=f*r+m*i+E*a+t[15]),e}function aM(e,t,n){var r=n[0],i=n[1],a=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function oM(e,t,n,r){var i=r[0],a=r[1],o=r[2],s=Math.hypot(i,a,o),c,f,d,h,v,m,g,_,y,E,b,A,C,R,W,te,Q,re,de,Ce,ie,Ge,We,It;return s<glMatrix.EPSILON?null:(s=1/s,i*=s,a*=s,o*=s,c=Math.sin(n),f=Math.cos(n),d=1-f,h=t[0],v=t[1],m=t[2],g=t[3],_=t[4],y=t[5],E=t[6],b=t[7],A=t[8],C=t[9],R=t[10],W=t[11],te=i*i*d+f,Q=a*i*d+o*c,re=o*i*d-a*c,de=i*a*d-o*c,Ce=a*a*d+f,ie=o*a*d+i*c,Ge=i*o*d+a*c,We=a*o*d-i*c,It=o*o*d+f,e[0]=h*te+_*Q+A*re,e[1]=v*te+y*Q+C*re,e[2]=m*te+E*Q+R*re,e[3]=g*te+b*Q+W*re,e[4]=h*de+_*Ce+A*ie,e[5]=v*de+y*Ce+C*ie,e[6]=m*de+E*Ce+R*ie,e[7]=g*de+b*Ce+W*ie,e[8]=h*Ge+_*We+A*It,e[9]=v*Ge+y*We+C*It,e[10]=m*Ge+E*We+R*It,e[11]=g*Ge+b*We+W*It,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function hT(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[4],o=t[5],s=t[6],c=t[7],f=t[8],d=t[9],h=t[10],v=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+f*r,e[5]=o*i+d*r,e[6]=s*i+h*r,e[7]=c*i+v*r,e[8]=f*i-a*r,e[9]=d*i-o*r,e[10]=h*i-s*r,e[11]=v*i-c*r,e}function vT(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[0],o=t[1],s=t[2],c=t[3],f=t[8],d=t[9],h=t[10],v=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-f*r,e[1]=o*i-d*r,e[2]=s*i-h*r,e[3]=c*i-v*r,e[8]=a*r+f*i,e[9]=o*r+d*i,e[10]=s*r+h*i,e[11]=c*r+v*i,e}function sM(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[0],o=t[1],s=t[2],c=t[3],f=t[4],d=t[5],h=t[6],v=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+f*r,e[1]=o*i+d*r,e[2]=s*i+h*r,e[3]=c*i+v*r,e[4]=f*i-a*r,e[5]=d*i-o*r,e[6]=h*i-s*r,e[7]=v*i-c*r,e}function uM(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function cM(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function fM(e,t,n){var r=n[0],i=n[1],a=n[2],o=Math.hypot(r,i,a),s,c,f;return o<glMatrix.EPSILON?null:(o=1/o,r*=o,i*=o,a*=o,s=Math.sin(t),c=Math.cos(t),f=1-c,e[0]=r*r*f+c,e[1]=i*r*f+a*s,e[2]=a*r*f-i*s,e[3]=0,e[4]=r*i*f-a*s,e[5]=i*i*f+c,e[6]=a*i*f+r*s,e[7]=0,e[8]=r*a*f+i*s,e[9]=i*a*f-r*s,e[10]=a*a*f+c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function lM(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function dM(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function hM(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function pT(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=r+r,c=i+i,f=a+a,d=r*s,h=r*c,v=r*f,m=i*c,g=i*f,_=a*f,y=o*s,E=o*c,b=o*f;return e[0]=1-(m+_),e[1]=h+b,e[2]=v-E,e[3]=0,e[4]=h-b,e[5]=1-(d+_),e[6]=g+y,e[7]=0,e[8]=v+E,e[9]=g-y,e[10]=1-(d+m),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function vM(e,t){var n=new glMatrix.ARRAY_TYPE(3),r=-t[0],i=-t[1],a=-t[2],o=t[3],s=t[4],c=t[5],f=t[6],d=t[7],h=r*r+i*i+a*a+o*o;return h>0?(n[0]=(s*o+d*r+c*a-f*i)*2/h,n[1]=(c*o+d*i+f*r-s*a)*2/h,n[2]=(f*o+d*a+s*i-c*r)*2/h):(n[0]=(s*o+d*r+c*a-f*i)*2,n[1]=(c*o+d*i+f*r-s*a)*2,n[2]=(f*o+d*a+s*i-c*r)*2),pT(e,t,n),e}function Dv(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Eh(e,t){var n=t[0],r=t[1],i=t[2],a=t[4],o=t[5],s=t[6],c=t[8],f=t[9],d=t[10];return e[0]=Math.hypot(n,r,i),e[1]=Math.hypot(a,o,s),e[2]=Math.hypot(c,f,d),e}function Pv(e,t){var n=new ba.WT(3);Eh(n,t);var r=1/n[0],i=1/n[1],a=1/n[2],o=t[0]*r,s=t[1]*i,c=t[2]*a,f=t[4]*r,d=t[5]*i,h=t[6]*a,v=t[8]*r,m=t[9]*i,g=t[10]*a,_=o+d+g,y=0;return _>0?(y=Math.sqrt(_+1)*2,e[3]=.25*y,e[0]=(h-m)/y,e[1]=(v-c)/y,e[2]=(s-f)/y):o>d&&o>g?(y=Math.sqrt(1+o-d-g)*2,e[3]=(h-m)/y,e[0]=.25*y,e[1]=(s+f)/y,e[2]=(v+c)/y):d>g?(y=Math.sqrt(1+d-o-g)*2,e[3]=(v-c)/y,e[0]=(s+f)/y,e[1]=.25*y,e[2]=(h+m)/y):(y=Math.sqrt(1+g-o-d)*2,e[3]=(s-f)/y,e[0]=(v+c)/y,e[1]=(h+m)/y,e[2]=.25*y),e}function mT(e,t,n,r){var i=t[0],a=t[1],o=t[2],s=t[3],c=i+i,f=a+a,d=o+o,h=i*c,v=i*f,m=i*d,g=a*f,_=a*d,y=o*d,E=s*c,b=s*f,A=s*d,C=r[0],R=r[1],W=r[2];return e[0]=(1-(g+y))*C,e[1]=(v+A)*C,e[2]=(m-b)*C,e[3]=0,e[4]=(v-A)*R,e[5]=(1-(h+y))*R,e[6]=(_+E)*R,e[7]=0,e[8]=(m+b)*W,e[9]=(_-E)*W,e[10]=(1-(h+g))*W,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function pM(e,t,n,r,i){var a=t[0],o=t[1],s=t[2],c=t[3],f=a+a,d=o+o,h=s+s,v=a*f,m=a*d,g=a*h,_=o*d,y=o*h,E=s*h,b=c*f,A=c*d,C=c*h,R=r[0],W=r[1],te=r[2],Q=i[0],re=i[1],de=i[2],Ce=(1-(_+E))*R,ie=(m+C)*R,Ge=(g-A)*R,We=(m-C)*W,It=(1-(v+E))*W,gn=(y+b)*W,pn=(g+A)*te,bn=(y-b)*te,vr=(1-(v+_))*te;return e[0]=Ce,e[1]=ie,e[2]=Ge,e[3]=0,e[4]=We,e[5]=It,e[6]=gn,e[7]=0,e[8]=pn,e[9]=bn,e[10]=vr,e[11]=0,e[12]=n[0]+Q-(Ce*Q+We*re+pn*de),e[13]=n[1]+re-(ie*Q+It*re+bn*de),e[14]=n[2]+de-(Ge*Q+gn*re+vr*de),e[15]=1,e}function d_(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n+n,s=r+r,c=i+i,f=n*o,d=r*o,h=r*s,v=i*o,m=i*s,g=i*c,_=a*o,y=a*s,E=a*c;return e[0]=1-h-g,e[1]=d+E,e[2]=v-y,e[3]=0,e[4]=d-E,e[5]=1-f-g,e[6]=m+_,e[7]=0,e[8]=v+y,e[9]=m-_,e[10]=1-f-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function mM(e,t,n,r,i,a,o){var s=1/(n-t),c=1/(i-r),f=1/(a-o);return e[0]=a*2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a*2*c,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(i+r)*c,e[10]=(o+a)*f,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*f,e[15]=0,e}function gT(e,t,n,r,i){var a=1/Math.tan(t/2),o;return e[0]=a/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==Infinity?(o=1/(r-i),e[10]=(i+r)*o,e[14]=2*i*r*o):(e[10]=-1,e[14]=-2*r),e}var yT=gT;function gM(e,t,n,r,i){var a=1/Math.tan(t/2),o;return e[0]=a/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==Infinity?(o=1/(r-i),e[10]=i*o,e[14]=i*r*o):(e[10]=-1,e[14]=-r),e}function yM(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),c=2/(o+s),f=2/(i+a);return e[0]=c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f,e[6]=0,e[7]=0,e[8]=-((o-s)*c*.5),e[9]=(i-a)*f*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}function _T(e,t,n,r,i,a,o){var s=1/(t-n),c=1/(r-i),f=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*f,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*c,e[14]=(o+a)*f,e[15]=1,e}var ET=_T;function _M(e,t,n,r,i,a,o){var s=1/(t-n),c=1/(r-i),f=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=f,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*c,e[14]=a*f,e[15]=1,e}function bT(e,t,n,r){var i,a,o,s,c,f,d,h,v,m,g=t[0],_=t[1],y=t[2],E=r[0],b=r[1],A=r[2],C=n[0],R=n[1],W=n[2];return Math.abs(g-C)<ba.Ib&&Math.abs(_-R)<ba.Ib&&Math.abs(y-W)<ba.Ib?l_(e):(d=g-C,h=_-R,v=y-W,m=1/Math.hypot(d,h,v),d*=m,h*=m,v*=m,i=b*v-A*h,a=A*d-E*v,o=E*h-b*d,m=Math.hypot(i,a,o),m?(m=1/m,i*=m,a*=m,o*=m):(i=0,a=0,o=0),s=h*o-v*a,c=v*i-d*o,f=d*a-h*i,m=Math.hypot(s,c,f),m?(m=1/m,s*=m,c*=m,f*=m):(s=0,c=0,f=0),e[0]=i,e[1]=s,e[2]=d,e[3]=0,e[4]=a,e[5]=c,e[6]=h,e[7]=0,e[8]=o,e[9]=f,e[10]=v,e[11]=0,e[12]=-(i*g+a*_+o*y),e[13]=-(s*g+c*_+f*y),e[14]=-(d*g+h*_+v*y),e[15]=1,e)}function EM(e,t,n,r){var i=t[0],a=t[1],o=t[2],s=r[0],c=r[1],f=r[2],d=i-n[0],h=a-n[1],v=o-n[2],m=d*d+h*h+v*v;m>0&&(m=1/Math.sqrt(m),d*=m,h*=m,v*=m);var g=c*v-f*h,_=f*d-s*v,y=s*h-c*d;return m=g*g+_*_+y*y,m>0&&(m=1/Math.sqrt(m),g*=m,_*=m,y*=m),e[0]=g,e[1]=_,e[2]=y,e[3]=0,e[4]=h*y-v*_,e[5]=v*g-d*y,e[6]=d*_-h*g,e[7]=0,e[8]=d,e[9]=h,e[10]=v,e[11]=0,e[12]=i,e[13]=a,e[14]=o,e[15]=1,e}function bM(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function wM(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function xM(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e}function SM(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}function TM(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e}function AM(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e}function IM(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function CM(e,t){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],f=e[7],d=e[8],h=e[9],v=e[10],m=e[11],g=e[12],_=e[13],y=e[14],E=e[15],b=t[0],A=t[1],C=t[2],R=t[3],W=t[4],te=t[5],Q=t[6],re=t[7],de=t[8],Ce=t[9],ie=t[10],Ge=t[11],We=t[12],It=t[13],gn=t[14],pn=t[15];return Math.abs(n-b)<=glMatrix.EPSILON*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(r-A)<=glMatrix.EPSILON*Math.max(1,Math.abs(r),Math.abs(A))&&Math.abs(i-C)<=glMatrix.EPSILON*Math.max(1,Math.abs(i),Math.abs(C))&&Math.abs(a-R)<=glMatrix.EPSILON*Math.max(1,Math.abs(a),Math.abs(R))&&Math.abs(o-W)<=glMatrix.EPSILON*Math.max(1,Math.abs(o),Math.abs(W))&&Math.abs(s-te)<=glMatrix.EPSILON*Math.max(1,Math.abs(s),Math.abs(te))&&Math.abs(c-Q)<=glMatrix.EPSILON*Math.max(1,Math.abs(c),Math.abs(Q))&&Math.abs(f-re)<=glMatrix.EPSILON*Math.max(1,Math.abs(f),Math.abs(re))&&Math.abs(d-de)<=glMatrix.EPSILON*Math.max(1,Math.abs(d),Math.abs(de))&&Math.abs(h-Ce)<=glMatrix.EPSILON*Math.max(1,Math.abs(h),Math.abs(Ce))&&Math.abs(v-ie)<=glMatrix.EPSILON*Math.max(1,Math.abs(v),Math.abs(ie))&&Math.abs(m-Ge)<=glMatrix.EPSILON*Math.max(1,Math.abs(m),Math.abs(Ge))&&Math.abs(g-We)<=glMatrix.EPSILON*Math.max(1,Math.abs(g),Math.abs(We))&&Math.abs(_-It)<=glMatrix.EPSILON*Math.max(1,Math.abs(_),Math.abs(It))&&Math.abs(y-gn)<=glMatrix.EPSILON*Math.max(1,Math.abs(y),Math.abs(gn))&&Math.abs(E-pn)<=glMatrix.EPSILON*Math.max(1,Math.abs(E),Math.abs(pn))}var RM=null,MM=null,h_,v_,p_,m_,g_,y_,__,E_,b_,w_,x_,S_,_u,T_,A_,I_,C_,R_,M_,N_,D_,P_,O_,L_;function B0(e,t){var n;if(typeof Symbol=="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(n=wT(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(f){throw f},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){n=e[Symbol.iterator]()},n:function(){var f=n.next();return a=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!a&&n.return!=null&&n.return()}finally{if(o)throw s}}}}function wT(e,t){if(!!e){if(typeof e=="string")return G_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G_(e,t)}}function G_(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var bh=(h_=(0,_t.b2)(),v_=(0,_t.f3)(Je.MeshComponentManager),p_=(0,_t.f3)(Je.GeometryComponentManager),m_=(0,_t.f3)(Je.MaterialComponentManager),g_=(0,_t.f3)(Je.CullableComponentManager),y_=(0,_t.f3)(Je.TransformComponentManager),__=(0,_t.f3)(Je.HierarchyComponentManager),E_=(0,_t.f3)(Je.Systems),b_=(0,_t.t6)(Je.FrameGraphSystem),w_=(0,_t.f3)(Je.RenderEngine),x_=(0,_t.f3)(Je.ResourcePool),h_(S_=(_u=(L_=O_=function(){function e(){var t=this;(0,nn.Z)(this,e),un(this,"mesh",T_,this),un(this,"geometry",A_,this),un(this,"material",I_,this),un(this,"cullable",C_,this),un(this,"transform",R_,this),un(this,"hierarchy",M_,this),un(this,"frameGraphSystem",N_,this),un(this,"engine",D_,this),un(this,"resourcePool",P_,this),this.modelCache={},this.setup=function(n,r,i){var a=n.createRenderTarget(r,"color buffer",{width:1,height:1,usage:ve.RENDER_ATTACHMENT|ve.SAMPLED|ve.COPY_SRC});i.data={output:r.write(n,a)}},this.execute=function(){var n=(0,Sr.Z)(Kt().mark(function r(i,a,o){var s,c,f,d,h,v;return Kt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:s=i.getResourceNode(a.data.output),c=t.resourcePool.getOrCreateResource(s.resource),f=B0(o),g.prev=3,f.s();case 5:if((d=f.n()).done){g.next=11;break}return h=d.value,g.next=9,t.initView(h);case 9:g.next=5;break;case 11:g.next=16;break;case 13:g.prev=13,g.t0=g.catch(3),f.e(g.t0);case 16:return g.prev=16,f.f(),g.finish(16);case 19:v=t.engine.getCanvas(),c.resize({width:v.width,height:v.height}),t.engine.setScissor({enable:!1}),t.engine.clear({framebuffer:c,color:o[0].getClearColor(),depth:1}),t.engine.useFramebuffer(c,function(){var _=B0(o),y;try{for(_.s();!(y=_.n()).done;){var E=y.value;t.renderView(E)}}catch(b){_.e(b)}finally{_.f()}});case 24:case"end":return g.stop()}},r,null,[[3,13,16,19]])}));return function(r,i,a){return n.apply(this,arguments)}}()}return(0,En.Z)(e,[{key:"renderView",value:function(n){var r=n.getScene(),i=n.getCamera(),a=i.getViewTransform(),o=Yl(Go(),i.getPerspective(),a);i.getFrustum().extractFromVPMatrix(o);var s=n.getViewport(),c=s.x,f=s.y,d=s.width,h=s.height;this.engine.viewport({x:c,y:f,width:d,height:h});var v=B0(r.getEntities()),m;try{for(v.s();!(m=v.n()).done;){var g=m.value;this.renderMesh(g,{camera:i,view:n,viewMatrix:a})}}catch(_){v.e(_)}finally{v.f()}}},{key:"renderMesh",value:function(n,r){var i=r.camera,a=r.view,o=r.viewMatrix,s=this.mesh.getComponentByEntity(n);if(!(!s||!s.visible)){var c=s.material,f=s.geometry;if(!(!f||f.dirty||!c)){var d=this.transform.getComponentByEntity(n),h=Yl(Go(),o,d.worldTransform),v=a.getViewport(),m=v.width,g=v.height;c.setUniform({projectionMatrix:i.getPerspective(),modelViewMatrix:h,modelMatrix:d.worldTransform,viewMatrix:o,cameraPosition:i.getPosition(),u_viewport:[m,g]}),s.model&&(s.model.draw({uniforms:c.uniforms.reduce(function(_,y){return _[y.name]=y.data,_},{})}),c.uniforms.forEach(function(_){_.dirty=!1}),c.dirty=!1)}}}},{key:"initMesh",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(i,a){var o,s,c,f,d,h,v,m;return Kt().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(o=this.mesh.getComponentByEntity(i),o){_.next=3;break}return _.abrupt("return");case 3:if(s=o.material,c=o.geometry,!(!c||c.dirty||!s)){_.next=7;break}return _.abrupt("return");case 7:if(o.model){_.next=24;break}if(f="m-".concat(s.entity,"-g-").concat(c.entity),!this.modelCache[f]){_.next=12;break}return o.model=this.modelCache[f],_.abrupt("return");case 12:return s.setUniform({projectionMatrix:1,modelViewMatrix:1,modelMatrix:1,viewMatrix:1,cameraPosition:1,u_viewport:1}),d=this.engine,h=d.createModel,v=d.createAttribute,m={vs:s.vertexShaderGLSL,fs:s.fragmentShaderGLSL,defines:s.defines,attributes:c.attributes.reduce(function(y,E){return E.data&&E.buffer&&(y[E.name]=v({buffer:E.buffer,attributes:E.attributes,arrayStride:E.arrayStride,stepMode:E.stepMode,divisor:E.stepMode==="vertex"?0:1})),y},{}),uniforms:s.uniforms.reduce(function(y,E){return y[E.name]=E.data,y},{}),scissor:{enable:!0,box:function(){return a.getViewport()}}},s.cull&&(m.cull=s.cull),s.depth&&(m.depth=s.depth),s.blend&&(m.blend=s.blend),c.indicesBuffer&&(m.elements=c.indicesBuffer),c.maxInstancedCount&&(m.instances=c.maxInstancedCount,m.count=c.vertexCount||3),_.next=22,h(m);case 22:o.model=_.sent,this.modelCache[f]=o.model;case 24:case"end":return _.stop()}},r,this)}));function n(r,i){return t.apply(this,arguments)}return n}()},{key:"initView",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(i){var a,o,s,c;return Kt().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:a=i.getScene(),o=B0(a.getEntities()),d.prev=2,o.s();case 4:if((s=o.n()).done){d.next=10;break}return c=s.value,d.next=8,this.initMesh(c,i);case 8:d.next=4;break;case 10:d.next=15;break;case 12:d.prev=12,d.t0=d.catch(2),o.e(d.t0);case 15:return d.prev=15,o.f(),d.finish(15);case 18:case"end":return d.stop()}},r,this,[[2,12,15,18]])}));function n(r){return t.apply(this,arguments)}return n}()}]),e}(),O_.IDENTIFIER="Render Pass",L_),T_=cn(_u.prototype,"mesh",[v_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A_=cn(_u.prototype,"geometry",[p_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I_=cn(_u.prototype,"material",[m_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C_=cn(_u.prototype,"cullable",[g_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R_=cn(_u.prototype,"transform",[y_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M_=cn(_u.prototype,"hierarchy",[__],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N_=cn(_u.prototype,"frameGraphSystem",[E_,b_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D_=cn(_u.prototype,"engine",[w_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P_=cn(_u.prototype,"resourcePool",[x_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_u))||S_),k_,F_,U_,B_,z_,W_,wh,V_,Z_,j_,H_,X_,$_;function gy(e,t){var n;if(typeof Symbol=="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(n=xT(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(f){throw f},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){n=e[Symbol.iterator]()},n:function(){var f=n.next();return a=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!a&&n.return!=null&&n.return()}finally{if(o)throw s}}}}function xT(e,t){if(!!e){if(typeof e=="string")return Y_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Y_(e,t)}}function Y_(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var yy={NONE:0,ENCODE:1,HIGHLIGHT:2},_y=(k_=(0,_t.b2)(),F_=(0,_t.f3)(Je.RenderEngine),U_=(0,_t.f3)(Je.ResourcePool),B_=(0,_t.f3)(Je.RenderPassFactory),z_=(0,_t.f3)(Je.MeshComponentManager),k_(W_=(wh=($_=X_=function(){function e(){var t=this;(0,nn.Z)(this,e),un(this,"engine",V_,this),un(this,"resourcePool",Z_,this),un(this,"renderPassFactory",j_,this),un(this,"mesh",H_,this),this.pickingFBO=void 0,this.views=void 0,this.highlightEnabled=!0,this.highlightColor=[255,0,0,255],this.alreadyInRendering=!1,this.setup=function(n,r,i){var a=n.createRenderTarget(r,"picking fbo",{width:1,height:1});i.data={output:r.write(n,a)},r.hasSideEffect=!0},this.execute=function(){var n=(0,Sr.Z)(Kt().mark(function r(i,a,o){var s,c,f;return Kt().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(t.views=o,!t.alreadyInRendering){h.next=3;break}return h.abrupt("return");case 3:s=gy(o);try{for(f=function(){var m=c.value,g=m.getViewport(),_=g.width,y=g.height;t.alreadyInRendering=!0;var E=i.getResourceNode(a.data.output);t.pickingFBO=t.resourcePool.getOrCreateResource(E.resource),t.pickingFBO.resize({width:_,height:y}),t.engine.useFramebuffer(t.pickingFBO,function(){t.engine.clear({framebuffer:t.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var b=t.renderPassFactory(bh.IDENTIFIER),A=[],C=m.getScene(),R=gy(C.getEntities()),W;try{for(R.s();!(W=R.n()).done;){var te=W.value,Q=t.mesh.getComponentByEntity(te),re=Q.material;re.setUniform("u_PickingStage",yy.ENCODE),A.push(Q)}}catch(de){R.e(de)}finally{R.f()}b.renderView(m),A.forEach(function(de){var Ce=de.material;Ce.setUniform("u_PickingStage",yy.HIGHLIGHT)}),t.alreadyInRendering=!1})},s.s();!(c=s.n()).done;)f()}catch(v){s.e(v)}finally{s.f()}case 5:case"end":return h.stop()}},r)}));return function(r,i,a){return n.apply(this,arguments)}}(),this.pick=function(n,r){var i=n.x,a=n.y,o=t.engine,s=o.readPixels,c=o.useFramebuffer,f=r.getViewport(),d=f.width,h=f.height,v=i*window.devicePixelRatio,m=a*window.devicePixelRatio;if(!(v>d||v<0||m>h||m<0)){var g,_;return c(t.pickingFBO,function(){g=s({x:Math.round(v),y:Math.round(h-(a+1)*window.devicePixelRatio),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:t.pickingFBO}),(g[0]!==0||g[1]!==0||g[2]!==0)&&(_=cT(g),t.highlightEnabled&&t.highlightPickedFeature(g,r))}),_}}}return(0,En.Z)(e,[{key:"enableHighlight",value:function(n){this.highlightEnabled=n}},{key:"setHighlightColor",value:function(n){this.highlightColor=n}},{key:"highlightPickedFeature",value:function(n,r){if(n){var i=gy(r.getScene().getEntities()),a;try{for(i.s();!(a=i.n()).done;){var o=a.value,s=this.mesh.getComponentByEntity(o),c=s.material;c.setUniform("u_PickingStage",yy.HIGHLIGHT),c.setUniform("u_PickingColor",[n[0],n[1],n[2]]),c.setUniform("u_HighlightColor",this.highlightColor)}}catch(f){i.e(f)}finally{i.f()}}}}]),e}(),X_.IDENTIFIER="PixelPicking Pass",$_),V_=cn(wh.prototype,"engine",[F_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z_=cn(wh.prototype,"resourcePool",[U_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j_=cn(wh.prototype,"renderPassFactory",[B_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H_=cn(wh.prototype,"mesh",[z_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wh))||W_),K_,q_,J_,Q_,z0,eE,tE,nE,rE,ST=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,TT=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,AT=`layout(set = 0, binding = 0) uniform sampler u_TextureSampler;
layout(set = 0, binding = 1) uniform texture2D u_Texture;

layout(location = 0) in vec2 v_UV;
layout(location = 0) out vec4 outColor;

void main() {
  outColor = texture(sampler2D(u_Texture, u_TextureSampler), v_UV);
}`,IT=`layout(location = 0) in vec2 a_Position;
layout(location = 0) out vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,W0=(K_=(0,_t.b2)(),q_=(0,_t.f3)(Je.RenderEngine),J_=(0,_t.f3)(Je.ResourcePool),K_(Q_=(z0=(rE=nE=function e(){var t=this;(0,nn.Z)(this,e),un(this,"engine",eE,this),un(this,"resourcePool",tE,this),this.model=void 0,this.setup=function(n,r,i){var a=n.getPass(bh.IDENTIFIER);if(a){var o=n.createRenderTarget(r,"render to screen",{width:1,height:1});i.data={input:r.read(a.data.output),output:r.write(n,o)}}},this.execute=function(){var n=(0,Sr.Z)(Kt().mark(function r(i,a){var o,s,c,f,d,h,v;return Kt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(o=t.engine,s=o.createModel,c=o.createAttribute,f=o.createBuffer,t.model){g.next=6;break}return g.next=4,s({vs:t.engine.supportWebGPU?IT:TT,fs:t.engine.supportWebGPU?AT:ST,attributes:{a_Position:c({buffer:f({data:[-4,-4,4,-4,0,4],type:ve.FLOAT}),size:2,arrayStride:2*4,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]})},uniforms:{u_Texture:null},depth:{enable:!1},count:3,blend:{enable:!0}});case 4:d=g.sent,t.model=d;case 6:h=i.getResourceNode(a.data.input),v=t.resourcePool.getOrCreateResource(h.resource),t.engine.useFramebuffer(null,function(){t.engine.clear({framebuffer:null,color:[0,0,0,0],depth:1,stencil:0}),t.model.draw({uniforms:{u_Texture:v}})});case 9:case"end":return g.stop()}},r)}));return function(r,i){return n.apply(this,arguments)}}(),this.tearDown=function(){t.model=void 0}},nE.IDENTIFIER="Copy Pass",rE),eE=cn(z0.prototype,"engine",[q_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tE=cn(z0.prototype,"resourcePool",[J_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z0))||Q_),iE,aE,oE,sE,uE,cE,fE,xh,lE,dE,hE,vE,pE,CT=(iE=(0,_t.b2)(),aE=(0,_t.f3)(Je.Systems),oE=(0,_t.t6)(Je.FrameGraphSystem),sE=(0,_t.f3)(Je.RenderPassFactory),uE=(0,_t.f3)(Je.ConfigService),cE=(0,_t.f3)(Je.ResourcePool),iE(fE=(xh=(pE=function(){function e(){(0,nn.Z)(this,e),un(this,"frameGraphSystem",lE,this),un(this,"renderPassFactory",dE,this),un(this,"configService",hE,this),un(this,"resourcePool",vE,this)}return(0,En.Z)(e,[{key:"execute",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(i){var a,o,s,c,f,d,h,v,m;return Kt().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:a=this.renderPassFactory(bh.IDENTIFIER),o=a.setup,s=a.execute,c=this.frameGraphSystem.addPass(bh.IDENTIFIER,o,s),f=this.renderPassFactory(W0.IDENTIFIER),d=f.setup,h=f.execute,v=f.tearDown,m=this.frameGraphSystem.addPass(W0.IDENTIFIER,d,h,v),this.frameGraphSystem.present(m.data.output);case 5:case"end":return _.stop()}},r,this)}));function n(r){return t.apply(this,arguments)}return n}()},{key:"tearDown",value:function(){this.resourcePool.clean()}},{key:"pick",value:function(n,r){var i=this.renderPassFactory(_y.IDENTIFIER);return i.pick(n,r)}}]),e}(),pE),lE=cn(xh.prototype,"frameGraphSystem",[aE,oE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dE=cn(xh.prototype,"renderPassFactory",[sE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hE=cn(xh.prototype,"configService",[uE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vE=cn(xh.prototype,"resourcePool",[cE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xh))||fE);function RT(e){var t=MT();return function(){var r=(0,Pr.Z)(e),i;if(t){var a=(0,Pr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ja.Z)(this,i)}}function MT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var NT=function(e){(0,Za.Z)(n,e);var t=RT(n);function n(r){var i;return(0,nn.Z)(this,n),i=t.call(this,r),i.parentID=void 0,Object.assign((0,ji.Z)(i),r),i}return n}(jl),mE,gE,yE,_E,EE,Ov,bE,wE,xE,SE,DT=(mE=(0,_t.b2)(),gE=(0,_t.f3)(Je.HierarchyComponentManager),yE=(0,_t.f3)(Je.TransformComponentManager),_E=(0,_t.f3)(Je.MeshComponentManager),mE(EE=(Ov=(SE=function(){function e(){(0,nn.Z)(this,e),un(this,"hierarchy",bE,this),un(this,"transform",wE,this),un(this,"mesh",xE,this)}return(0,En.Z)(e,[{key:"execute",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(){return Kt().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:this.runTransformUpdateSystem(),this.runHierarchyUpdateSystem();case 2:case"end":return a.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"tearDown",value:function(){this.hierarchy.clear(),this.transform.clear()}},{key:"getHierarchyComponentManager",value:function(){return this.hierarchy}},{key:"getTransformComponentManager",value:function(){return this.transform}},{key:"runTransformUpdateSystem",value:function(){var n=this;this.transform.forEach(function(r,i){(i.isDirty()||i.isLocalDirty())&&(n.setMeshAABBDirty(n.mesh.getComponentByEntity(r)),i.updateTransform())})}},{key:"runHierarchyUpdateSystem",value:function(){var n=this;this.hierarchy.forEach(function(r,i){var a=n.transform.getComponentByEntity(r),o=n.transform.getComponentByEntity(i.parentID);a!==null&&o!==null&&a.updateTransformWithParent(o)})}},{key:"attach",value:function(n,r,i){this.hierarchy.contains(n)&&this.detach(n),this.hierarchy.create(n,{parentID:r});var a=this.mesh.getComponentByEntity(r);if(this.setMeshAABBDirty(a),a&&a.children.indexOf(n)===-1&&a.children.push(n),this.hierarchy.getCount()>1)for(var o=this.hierarchy.getCount()-1;o>0;--o)for(var s=this.hierarchy.getEntity(o),c=0;c<o;++c){var f=this.hierarchy.getComponent(c);if(f.parentID===s){this.hierarchy.moveItem(o,c),++o;break}}var d=this.hierarchy.getComponentByEntity(n),h=this.transform.getComponentByEntity(r);h===null&&(h=this.transform.create(r));var v=this.transform.getComponentByEntity(n);v===null&&(v=this.transform.create(n),h=this.transform.getComponentByEntity(r)),v.parent=h,!i&&h&&(v.matrixTransform(U0(Go(),h.worldTransform)),v.updateTransform()),h&&v.updateTransformWithParent(h)}},{key:"detach",value:function(n){var r=this.hierarchy.getComponentByEntity(n);if(r!==null){var i=this.transform.getComponentByEntity(n);i!==null&&(i.parent=null,i.applyTransform()),this.hierarchy.removeKeepSorted(n);var a=this.mesh.getComponentByEntity(r.parentID);if(a){var o=a.children.indexOf(n);a.children.splice(o,1)}this.setMeshAABBDirty(a)}}},{key:"detachChildren",value:function(n){var r=this.mesh.getComponentByEntity(n);r&&(r.children=[]);for(var i=0;i<this.hierarchy.getCount();){var a;if(((a=this.hierarchy.getComponent(i))===null||a===void 0?void 0:a.parentID)===n){var o=this.hierarchy.getEntity(i);this.detach(o)}else++i}}},{key:"setMeshAABBDirty",value:function(n){n&&(n.aabbDirty=!0)}}]),e}(),SE),bE=cn(Ov.prototype,"hierarchy",[gE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wE=cn(Ov.prototype,"transform",[yE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xE=cn(Ov.prototype,"mesh",[_E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ov))||EE);function ha(){var e=new ba.WT(4);return ba.WT!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function NM(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Kl(e,t,n){n=n*.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function DM(e,t){var n=Math.acos(t[3])*2,r=Math.sin(n/2);return r>glMatrix.EPSILON?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),n}function PM(e,t){var n=FT(e,t);return Math.acos(2*n*n-1)}function zs(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=n[0],c=n[1],f=n[2],d=n[3];return e[0]=r*d+o*s+i*f-a*c,e[1]=i*d+o*c+a*s-r*f,e[2]=a*d+o*f+r*c-i*s,e[3]=o*d-r*s-i*c-a*f,e}function OM(e,t,n){n*=.5;var r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),c=Math.cos(n);return e[0]=r*c+o*s,e[1]=i*c+a*s,e[2]=a*c-i*s,e[3]=o*c-r*s,e}function LM(e,t,n){n*=.5;var r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),c=Math.cos(n);return e[0]=r*c-a*s,e[1]=i*c+o*s,e[2]=a*c+r*s,e[3]=o*c-i*s,e}function GM(e,t,n){n*=.5;var r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),c=Math.cos(n);return e[0]=r*c+i*s,e[1]=i*c-r*s,e[2]=a*c+o*s,e[3]=o*c-a*s,e}function kM(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e}function PT(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=Math.sqrt(n*n+r*r+i*i),s=Math.exp(a),c=o>0?s*Math.sin(o)/o:0;return e[0]=n*c,e[1]=r*c,e[2]=i*c,e[3]=s*Math.cos(o),e}function OT(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=Math.sqrt(n*n+r*r+i*i),s=o>0?Math.atan2(o,a)/o:0;return e[0]=n*s,e[1]=r*s,e[2]=i*s,e[3]=.5*Math.log(n*n+r*r+i*i+a*a),e}function FM(e,t,n){return OT(e,t),kT(e,e,n),PT(e,e),e}function V0(e,t,n,r){var i=t[0],a=t[1],o=t[2],s=t[3],c=n[0],f=n[1],d=n[2],h=n[3],v,m,g,_,y;return m=i*c+a*f+o*d+s*h,m<0&&(m=-m,c=-c,f=-f,d=-d,h=-h),1-m>ba.Ib?(v=Math.acos(m),g=Math.sin(v),_=Math.sin((1-r)*v)/g,y=Math.sin(r*v)/g):(_=1-r,y=r),e[0]=_*i+y*c,e[1]=_*a+y*f,e[2]=_*o+y*d,e[3]=_*s+y*h,e}function UM(e){var t=glMatrix.RANDOM(),n=glMatrix.RANDOM(),r=glMatrix.RANDOM(),i=Math.sqrt(1-t),a=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*n),e[1]=i*Math.cos(2*Math.PI*n),e[2]=a*Math.sin(2*Math.PI*r),e[3]=a*Math.cos(2*Math.PI*r),e}function TE(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n*n+r*r+i*i+a*a,s=o?1/o:0;return e[0]=-n*s,e[1]=-r*s,e[2]=-i*s,e[3]=a*s,e}function BM(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function LT(e,t){var n=t[0]+t[4]+t[8],r;if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;r=Math.sqrt(t[i*3+i]-t[a*3+a]-t[o*3+o]+1),e[i]=.5*r,r=.5/r,e[3]=(t[a*3+o]-t[o*3+a])*r,e[a]=(t[a*3+i]+t[i*3+a])*r,e[o]=(t[o*3+i]+t[i*3+o])*r}return e}function Ey(e,t,n,r){var i=.5*Math.PI/180;t*=i,n*=i,r*=i;var a=Math.sin(t),o=Math.cos(t),s=Math.sin(n),c=Math.cos(n),f=Math.sin(r),d=Math.cos(r);return e[0]=a*c*d-o*s*f,e[1]=o*s*d+a*c*f,e[2]=o*c*f-a*s*d,e[3]=o*c*d+a*s*f,e}function zM(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var WM=i2,by=A1,Lv=a2,VM=o2,ZM=s2,GT=zs,kT=u2,FT=d2,jM=h2,HM=c2,XM=null,$M=f2,YM=null,Sh=l2,KM=v2,qM=p2,JM=function(){var e=Re.Ue(),t=Re.al(1,0,0),n=Re.al(0,1,0);return function(r,i,a){var o=Re.AK(i,a);return o<-.999999?(Re.kC(e,t,i),Re.Zh(e)<1e-6&&Re.kC(e,n,i),Re.Fv(e,e),Kl(r,e,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Re.kC(e,i,a),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+o,Sh(r,r))}}(),QM=function(){var e=ha(),t=ha();return function(n,r,i,a,o,s){return V0(e,r,o,s),V0(t,i,a,s),V0(n,e,t,2*s*(1-s)),n}}(),eN=function(){var e=Xl.Ue();return function(t,n,r,i){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],Sh(t,LT(t,e))}}();function UT(e){var t=BT();return function(){var r=(0,Pr.Z)(e),i;if(t){var a=(0,Pr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ja.Z)(this,i)}}function BT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var AE=function(e){(0,Za.Z)(n,e);var t=UT(n);function n(r){var i;return(0,nn.Z)(this,n),i=t.call(this,r),i.dirtyFlag=void 0,i.localDirtyFlag=void 0,i.parent=null,i.localPosition=Re.al(0,0,0),i.localRotation=by(0,0,0,1),i.localScale=Re.al(1,1,1),i.localTransform=Go(),i.position=Re.al(0,0,0),i.rotation=by(0,0,0,1),i.scaling=Re.al(1,1,1),i.worldTransform=Go(),i.matrixTransform=function(){var a=Go();return function(o){Yl(a,i.getLocalTransform(),o),Eh(i.localScale,a),Dv(i.localPosition,a),Pv(i.localRotation,a)}}(),i.rotateRollPitchYaw=function(){var a=ha(),o=ha(),s=ha();return function(c,f,d){i.setDirty(),Ey(a,c,0,0),Ey(o,0,f,0),Ey(s,0,0,d),zs(i.localRotation,a,i.localRotation),zs(i.localRotation,i.localRotation,o),zs(i.localRotation,s,i.localRotation),Sh(i.localRotation,i.localRotation)}}(),i.lerp=function(){var a=Re.Ue(),o=ha(),s=Re.Ue(),c=Re.Ue(),f=ha(),d=Re.Ue();return function(h,v,m){i.setDirty(),Eh(a,h.worldTransform),Dv(s,h.worldTransform),Pv(o,h.worldTransform),Eh(c,v.worldTransform),Dv(d,v.worldTransform),Pv(f,v.worldTransform),Re.t7(i.localScale,a,c,m),V0(i.localRotation,o,f,m),Re.t7(i.localPosition,s,d,m)}}(),i.translate=function(){var a=Re.Ue();return function(o){return Re.IH(a,i.getPosition(),o),i.setPosition(a),i.setDirty(!0),(0,ji.Z)(i)}}(),i.translateLocal=function(){return function(a){return Re.VC(a,a,i.localRotation),Re.IH(i.localPosition,i.localPosition,a),i.setLocalDirty(!0),(0,ji.Z)(i)}}(),i.setPosition=function(){var a=Go();return function(o){return i.position=o,i.setLocalDirty(!0),i.parent===null?Re.JG(i.localPosition,o):(my(a,i.parent.worldTransform),U0(a,a),Re.fF(i.localPosition,o,a)),(0,ji.Z)(i)}}(),i.rotate=function(){var a=ha();return function(o){if(i.parent===null)zs(i.localRotation,i.localRotation,o),Sh(i.localRotation,i.localRotation);else{var s=i.getRotation(),c=i.parent.getRotation();Lv(a,c),TE(a,a),zs(a,a,o),zs(i.localRotation,o,s),Sh(i.localRotation,i.localRotation)}return i.setLocalDirty(),(0,ji.Z)(i)}}(),i.rotateLocal=function(){return function(a){return zs(i.localRotation,i.localRotation,a),Sh(i.localRotation,i.localRotation),i.setLocalDirty(!0),(0,ji.Z)(i)}}(),i.setRotation=function(){var a=ha();return function(o){return i.parent===null?Lv(i.localRotation,o):(Lv(a,i.parent.getRotation()),TE(a,a),Lv(i.localRotation,a),GT(i.localRotation,i.localRotation,o)),i.setLocalDirty(!0),(0,ji.Z)(i)}}(),i}return(0,En.Z)(n,[{key:"setLocalPosition",value:function(i){Re.JG(this.localPosition,i),this.setLocalDirty(!0)}},{key:"setLocalScale",value:function(i){Re.JG(this.localScale,i),this.setLocalDirty(!0)}},{key:"setLocalRotation",value:function(i){return Lv(this.localRotation,i),this.setLocalDirty(!0),this}},{key:"isDirty",value:function(){return this.dirtyFlag}},{key:"setDirty",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i?this.dirtyFlag|=n.DIRTY:this.dirtyFlag&=~n.DIRTY}},{key:"isLocalDirty",value:function(){return this.localDirtyFlag}},{key:"setLocalDirty",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i?(this.localDirtyFlag|=n.DIRTY,this.setDirty(!0)):this.localDirtyFlag&=~n.DIRTY}},{key:"updateTransform",value:function(){this.isLocalDirty()&&this.getLocalTransform(),this.isDirty()&&this.parent===null&&(my(this.worldTransform,this.getLocalTransform()),this.setDirty(!1))}},{key:"updateTransformWithParent",value:function(i){Yl(this.worldTransform,i.worldTransform,this.getLocalTransform())}},{key:"applyTransform",value:function(){this.setDirty(),Eh(this.localScale,this.worldTransform),Dv(this.localPosition,this.worldTransform),Pv(this.localRotation,this.worldTransform)}},{key:"clearTransform",value:function(){this.setDirty(),this.localPosition=Re.al(0,0,0),this.localRotation=by(0,0,0,1),this.localScale=Re.al(1,1,1)}},{key:"scaleLocal",value:function(i){return this.setLocalDirty(),Re.Jp(this.localScale,this.localScale,i),this}},{key:"getLocalPosition",value:function(){return this.localPosition}},{key:"getLocalRotation",value:function(){return this.localRotation}},{key:"getLocalScale",value:function(){return this.localScale}},{key:"getLocalTransform",value:function(){return this.localDirtyFlag&&(mT(this.localTransform,this.localRotation,this.localPosition,this.localScale),this.setLocalDirty(!1)),this.localTransform}},{key:"getWorldTransform",value:function(){return!this.isLocalDirty()&&!this.isDirty()?this.worldTransform:(this.parent&&this.parent.getWorldTransform(),this.updateTransform(),this.worldTransform)}},{key:"getPosition",value:function(){return Dv(this.position,this.worldTransform),this.position}},{key:"getRotation",value:function(){return Pv(this.rotation,this.worldTransform),this.rotation}},{key:"getScale",value:function(){return Eh(this.scaling,this.worldTransform),this.scaling}}]),n}(jl);AE.DIRTY=1<<0;var zT=S(84879),IE,CE,RE,wy,ME,NE,WT=(IE=(0,_t.b2)(),CE=(0,_t.f3)(Je.RenderEngine),IE(RE=(wy=(NE=function(){function e(){(0,nn.Z)(this,e),un(this,"engine",ME,this),this.resourcePool={}}return(0,En.Z)(e,[{key:"getOrCreateResource",value:function(n){if(!this.resourcePool[n.name]){var r=n.descriptor,i=r.width,a=r.height,o=r.usage;this.resourcePool[n.name]=this.engine.createFramebuffer({color:this.engine.createTexture2D({width:i,height:a,wrapS:ve.CLAMP_TO_EDGE,wrapT:ve.CLAMP_TO_EDGE,usage:o})})}return this.resourcePool[n.name]}},{key:"clean",value:function(){this.resourcePool={}}}]),e}(),NE),ME=cn(wy.prototype,"engine",[CE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wy))||RE);function VT(e){var t=ZT();return function(){var r=(0,Pr.Z)(e),i;if(t){var a=(0,Pr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ja.Z)(this,i)}}function ZT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var jT=function(e){(0,Za.Z)(n,e);var t=VT(n);function n(r){var i;return(0,nn.Z)(this,n),i=t.call(this,r),i.name=void 0,i.name=r.name||"",i}return n}(jl),DE,PE,OE,HT=(DE=(0,_t.b2)(),DE(PE=(OE=function(){function e(){(0,nn.Z)(this,e),this.config=void 0}return(0,En.Z)(e,[{key:"get",value:function(){return this.config}},{key:"set",value:function(n){this.config=n}}]),e}(),OE))||PE),LE,GE,kE;(function(e){e.PANSTART="PANSTART",e.PANEND="PANEND",e.PANMOVE="PANMOVE",e.PINCH="PINCH",e.KEYDOWN="KEYDOWN",e.KEYUP="KEYUP",e.HOVER="HOVER"})(kE||(kE={}));var XT=(LE=(0,_t.b2)(),LE(GE=function(){function e(){(0,nn.Z)(this,e)}return(0,En.Z)(e,[{key:"listen",value:function(n){}},{key:"on",value:function(n,r){}},{key:"connect",value:function(){}},{key:"disconnect",value:function(){}},{key:"destroy",value:function(){}}]),e}())||GE);function $T(e){var t=0;switch(e){case"vec2":case"ivec2":t=2;break;case"vec3":case"ivec3":t=3;break;case"vec4":case"ivec4":case"mat2":t=4;break;case"mat3":t=9;break;case"mat4":t=16;break;default:}return t}var YT=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function FE(e){var t={};return e=e.replace(YT,function(n,r,i){var a=i.split(":"),o=a[0].trim(),s="";switch(a.length>1&&(s=a[1].trim()),r){case"bool":s=s==="true";break;case"float":case"int":s=Number(s);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":s?s=s.replace("[","").replace("]","").split(",").reduce(function(c,f){return c.push(Number(f.trim())),c},[]):s=new Array($T(r)).fill(0);break;default:}return t[o]=s,"uniform ".concat(r," ").concat(o,`;
`)}),{content:e,uniforms:t}}function KT(e){return e.filter(function(t,n,r){return r.indexOf(t)===n})}var UE,BE,zE;function WE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Gv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?WE(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WE(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var qT=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;

#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color) {
  bool selected = bool(v_PickingResult.a);

  if (selected) {
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(resultRGB, color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  return filterPickingColor(filterHighlightColor(color));
}
`,JT=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;

#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  // compares only in highlight stage
  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}`,QT=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}`,eA=/precision\s+(high|low|medium)p\s+float/,tA=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,nA=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,rA=(UE=(0,_t.b2)(),UE(BE=(zE=function(){function e(){(0,nn.Z)(this,e),this.moduleCache={},this.rawContentCache={}}return(0,En.Z)(e,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("picking",{vs:JT,fs:qT}),this.registerModule("sdf2d",{vs:"",fs:QT})}},{key:"registerModule",value:function(n,r){if(!this.rawContentCache[n]){var i=r.vs,a=i===void 0?"":i,o=r.fs,s=o===void 0?"":o,c=r.uniforms,f=FE(a),d=f.content,h=f.uniforms,v=FE(s),m=v.content,g=v.uniforms;this.rawContentCache[n]={fs:m,uniforms:Gv(Gv(Gv({},h),g),c),vs:d}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(n){var r=this;if(this.moduleCache[n])return this.moduleCache[n];var i=this.rawContentCache[n].vs||"",a=this.rawContentCache[n].fs||"",o=this.processModule(i,[],"vs"),s=o.content,c=o.includeList,f=this.processModule(a,[],"fs"),d=f.content,h=f.includeList,v=d,m=KT(c.concat(h).concat(n)).reduce(function(g,_){return Gv(Gv({},g),r.rawContentCache[_].uniforms)},{});return eA.test(d)||(v=tA+d),this.moduleCache[n]={fs:v.trim(),uniforms:m,vs:s.trim()},this.moduleCache[n]}},{key:"processModule",value:function(n,r,i){var a=this,o=n.replace(nA,function(s,c){var f=c.split(" "),d=f[0].replace(/"/g,"");if(r.indexOf(d)>-1)return"";var h=a.rawContentCache[d][i];r.push(d);var v=a.processModule(h||"",r,i),m=v.content;return m});return{content:o,includeList:r}}}]),e}(),zE))||BE),fc=new _t.W2,VE=(0,zT.Z)(fc,!1),tN=function(t){var n=VE.lazyInject(t);return function(r,i,a){n.call(this,r,i),a&&(a.initializer=function(){return r[i]})}},nN=function(t){var n=VE.lazyMultiInject(t);return function(r,i,a){n.call(this,r,i),a&&(a.initializer=function(){return r[i]})}};fc.bind(Je.ShaderModuleService).to(rA).inSingletonScope(),fc.bind(Je.NameComponentManager).toConstantValue(new Hl(jT)),fc.bind(Je.HierarchyComponentManager).toConstantValue(new Hl(NT)),fc.bind(Je.TransformComponentManager).toConstantValue(new Hl(AE)),fc.bind(Je.MeshComponentManager).toConstantValue(new Hl(aT)),fc.bind(Je.CullableComponentManager).toConstantValue(new Hl(nT)),fc.bind(Je.GeometryComponentManager).toConstantValue(new Hl($2)),fc.bind(Je.MaterialComponentManager).toConstantValue(new Hl(J2));function iA(){var e=new _t.W2;return e.parent=fc,e.bind(Je.Systems).to(DT).inSingletonScope().whenTargetNamed(Je.SceneGraphSystem),e.bind(Je.Systems).to(r2).inSingletonScope().whenTargetNamed(Je.FrameGraphSystem),e.bind(Je.Systems).to(lT).inSingletonScope().whenTargetNamed(Je.MeshSystem),e.bind(Je.Systems).to(Y2).inSingletonScope().whenTargetNamed(Je.GeometrySystem),e.bind(Je.Systems).to(Q2).inSingletonScope().whenTargetNamed(Je.MaterialSystem),e.bind(Je.Systems).to(CT).inSingletonScope().whenTargetNamed(Je.RendererSystem),e.bind(Je.ResourcePool).to(WT).inSingletonScope(),e.bind(Je.ConfigService).to(HT).inSingletonScope(),e.bind(Je.InteractorService).to(XT).inSingletonScope(),e.bind(Je.RenderPass).to(bh).inSingletonScope().whenTargetNamed(bh.IDENTIFIER),e.bind(Je.RenderPass).to(W0).inSingletonScope().whenTargetNamed(W0.IDENTIFIER),e.bind(Je.RenderPass).to(_y).inSingletonScope().whenTargetNamed(_y.IDENTIFIER),e.bind(Je.RenderPassFactory).toFactory(function(t){return function(n){return t.container.getNamed(Je.RenderPass,n)}}),e}function xy(e){for(var t=new py,n=Re.al(e[0],e[1],e[2]),r=Re.al(e[0],e[1],e[2]),i=3;i<e.length;){var a=e[i++],o=e[i++],s=e[i++];a<n[0]&&(n[0]=a),o<n[1]&&(n[1]=o),s<n[2]&&(n[2]=s),a>r[0]&&(r[0]=a),o>r[1]&&(r[1]=o),s>r[2]&&(r[2]=s)}return t.setMinMax(n,r),t}var ko=typeof navigator!="undefined"&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),rN=Re.Ue(),iN=null,aN=Re.Ue(),oN=Re.Ue(),sN=Re.Ue(),uN=Re.Ue(),cN=Re.Ue(),fN=null,lN=S(59518),dN=S(26199),hN=S(14156),vN=S(71468),pN=S(48871),mN=S(9871),ZE;(function(e){e.Normal="normal",e.PostProcessing="post-processing"})(ZE||(ZE={}));var gN=S(25612),yN=S(92777),_N=S(20159),EN=S(61622),bN=S(20499),wN=S(64851),ql;(function(e){e.Void="Void",e.Boolean="Boolean",e.Float="Float",e.Uint32="Uint32",e.Int32="Int32",e.Vector="Vector",e.Vector2Float="vec2<f32>",e.Vector3Float="vec3<f32>",e.Vector4Float="vec4<f32>",e.Vector2Boolean="vec2<bool>",e.Vector3Boolean="vec3<bool>",e.Vector4Boolean="vec4<bool>",e.Vector2Uint="vec2<u32>",e.Vector3Uint="vec3<u32>",e.Vector4Uint="vec4<u32>",e.Vector2Int="vec2<i32>",e.Vector3Int="vec3<i32>",e.Vector4Int="vec4<i32>",e.Matrix="Matrix",e.Matrix3x3Float="mat3x3<f32>",e.Matrix4x4Float="mat4x4<i32>",e.Struct="Struct",e.FloatArray="Float[]",e.Vector4FloatArray="vec4<f32>[]"})(ql||(ql={}));var jE;(function(e){e.Program="Program",e.Identifier="Identifier",e.VariableDeclaration="VariableDeclaration",e.BlockStatement="BlockStatement",e.ReturnStatement="ReturnStatement",e.FunctionDeclaration="FunctionDeclaration",e.VariableDeclarator="VariableDeclarator",e.AssignmentExpression="AssignmentExpression",e.LogicalExpression="LogicalExpression",e.BinaryExpression="BinaryExpression",e.ArrayExpression="ArrayExpression",e.UnaryExpression="UnaryExpression",e.UpdateExpression="UpdateExpression",e.FunctionExpression="FunctionExpression",e.MemberExpression="MemberExpression",e.ConditionalExpression="ConditionalExpression",e.ExpressionStatement="ExpressionStatement",e.CallExpression="CallExpression",e.NumThreadStatement="NumThreadStatement",e.StorageStatement="StorageStatement",e.DoWhileStatement="DoWhileStatement",e.WhileStatement="WhileStatement",e.ForStatement="ForStatement",e.BreakStatement="BreakStatement",e.ContinueStatement="ContinueStatement",e.IfStatement="IfStatement",e.ImportedFunctionStatement="ImportedFunctionStatement"})(jE||(jE={}));var nl;(function(e){e.Input="Input",e.Output="Output",e.Uniform="Uniform",e.Workgroup="Workgroup",e.UniformConstant="UniformConstant",e.Image="Image",e.StorageBuffer="StorageBuffer",e.Private="Private",e.Function="Function"})(nl||(nl={}));var kv;(function(e){e.GLSL100="GLSL100",e.GLSL450="GLSL450",e.WGSL="WGSL"})(kv||(kv={}));var aA="__DefineValuePlaceholder__";function Sy(e){return typeof e=="number"}function Jc(e){return e===void 0?0:e>360||e<-360?e%360:e}function Jl(e,t,n){return Sy(e)?Re.al(e,t,n):e.length===3?Re.d9(e):Re.al(e[0],e[1],e[2])}var HE=function(){function e(t,n){(0,nn.Z)(this,e),this.name=void 0,this.matrix=void 0,this.right=void 0,this.up=void 0,this.forward=void 0,this.position=void 0,this.focalPoint=void 0,this.distanceVector=void 0,this.distance=void 0,this.dollyingStep=void 0,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.name=t,this.matrix=dT(n.matrix),this.right=Re.d9(n.right),this.up=Re.d9(n.up),this.forward=Re.d9(n.forward),this.position=Re.d9(n.position),this.focalPoint=Re.d9(n.focalPoint),this.distanceVector=Re.d9(n.distanceVector),this.azimuth=n.azimuth,this.elevation=n.elevation,this.roll=n.roll,this.relAzimuth=n.relAzimuth,this.relElevation=n.relElevation,this.relRoll=n.relRoll,this.dollyingStep=n.dollyingStep,this.distance=n.distance}return(0,En.Z)(e,[{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getRoll",value:function(){return this.roll}},{key:"retrieve",value:function(n){n.matrix=my(n.matrix,this.matrix),n.right=Re.JG(n.right,this.right),n.up=Re.JG(n.up,this.up),n.forward=Re.JG(n.forward,this.forward),n.position=Re.JG(n.position,this.position),n.focalPoint=Re.JG(n.focalPoint,this.focalPoint),n.distanceVector=Re.JG(n.distanceVector,this.distanceVector),n.azimuth=this.azimuth,n.elevation=this.elevation,n.roll=this.roll,n.relAzimuth=this.relAzimuth,n.relElevation=this.relElevation,n.relRoll=this.relRoll,n.dollyingStep=this.dollyingStep,n.distance=this.distance}}]),e}(),XE,$E,YE,Ty,KE,qE,JE,Br;(function(e){e.ORBITING="ORBITING",e.EXPLORING="EXPLORING",e.TRACKING="TRACKING"})(Br||(Br={}));var Z0;(function(e){e.DEFAULT="DEFAULT",e.ROTATIONAL="ROTATIONAL",e.TRANSLATIONAL="TRANSLATIONAL",e.CINEMATIC="CINEMATIC"})(Z0||(Z0={}));var Ql;(function(e){e.ORTHOGRAPHIC="ORTHOGRAPHIC",e.PERSPECTIVE="PERSPECTIVE"})(Ql||(Ql={}));var Qc=Math.PI/180,rl=180/Math.PI,QE=(XE=(0,_t.b2)(),$E=(0,_t.f3)(Je.InteractorService),XE(YE=(Ty=(JE=qE=function(){function e(){(0,nn.Z)(this,e),this.matrix=Go(),this.right=Re.al(1,0,0),this.up=Re.al(0,1,0),this.forward=Re.al(0,0,1),this.position=Re.al(0,0,1),this.focalPoint=Re.al(0,0,0),this.distanceVector=Re.al(0,0,0),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=Infinity,this.minDistance=-Infinity,this.rotateWorld=!1,un(this,"interactor",KE,this),this.fov=30,this.near=.1,this.far=1e4,this.aspect=1,this.left=void 0,this.rright=void 0,this.top=void 0,this.bottom=void 0,this.zoom=1,this.perspective=Go(),this.view=void 0,this.following=void 0,this.type=Br.EXPLORING,this.trackingMode=Z0.DEFAULT,this.projectionMode=Ql.PERSPECTIVE,this.frustum=new sT,this.landmarks=[],this.landmarkAnimationID=void 0}return(0,En.Z)(e,[{key:"clone",value:function(){var n=new e;return n.setType(this.type,void 0),n.interactor=this.interactor,n}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.perspective}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"setType",value:function(n,r){return this.type=n,this.type===Br.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===Br.TRACKING&&r!==void 0&&this.setTrackingMode(r),this}},{key:"setProjectionMode",value:function(n){return this.projectionMode=n,this}},{key:"setTrackingMode",value:function(n){if(this.type!==Br.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=n,this}},{key:"setWorldRotation",value:function(n){this.rotateWorld=n,this._getAngles()}},{key:"getViewTransform",value:function(){return U0(Go(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"setMatrix",value:function(n){return this.matrix=n,this._update(),this}},{key:"setAspect",value:function(n){return this.setPerspective(this.near,this.far,this.fov,n),this}},{key:"setViewOffset",value:function(n,r,i,a,o,s){return this.aspect=n/r,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=n,this.view.fullHeight=r,this.view.offsetX=i,this.view.offsetY=a,this.view.width=o,this.view.height=s,this.projectionMode===Ql.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===Ql.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setPerspective",value:function(n,r,i,a){return this.projectionMode=Ql.PERSPECTIVE,this.fov=i,this.near=n,this.far=r,this.aspect=a,yT(this.perspective,this.fov*Qc,this.aspect,this.near,this.far),this}},{key:"setOrthographic",value:function(n,r,i,a,o,s){this.projectionMode=Ql.ORTHOGRAPHIC,this.rright=r,this.left=n,this.top=i,this.bottom=a,this.near=o,this.far=s;var c=(this.rright-this.left)/(2*this.zoom),f=(this.top-this.bottom)/(2*this.zoom),d=(this.rright+this.left)/2,h=(this.top+this.bottom)/2,v=d-c,m=d+c,g=h+f,_=h-f;if(this.view!==void 0&&this.view.enabled){var y=(this.rright-this.left)/this.view.fullWidth/this.zoom,E=(this.top-this.bottom)/this.view.fullHeight/this.zoom;v+=y*this.view.offsetX,m=v+y*this.view.width,g-=E*this.view.offsetY,_=g-E*this.view.height}return ET(this.perspective,v,m,g,_,o,s),this}},{key:"setPosition",value:function(n,r,i){return this._setPosition(n,r,i),this.setFocalPoint(this.focalPoint),this}},{key:"setFocalPoint",value:function(n,r,i){var a=Re.al(0,1,0);if(this.focalPoint=Jl(n,r,i),this.trackingMode===Z0.CINEMATIC){var o=Re.$X(Re.Ue(),this.focalPoint,this.position);n=o[0],r=o[1],i=o[2];var s=Re.kE(o),c=Math.asin(r/s)*rl,f=90+Math.atan2(i,n)*rl,d=Go();vT(d,d,f*Qc),hT(d,d,c*Qc),a=Re.fF(Re.Ue(),[0,1,0],d)}return U0(this.matrix,bT(Go(),this.position,this.focalPoint,a)),this._getAxes(),this._getDistance(),this._getAngles(),this}},{key:"setDistance",value:function(n){if(!(this.distance===n||n<0)){this.distance=n,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var r=Re.Ue();n=this.distance;var i=this.forward,a=this.focalPoint;return r[0]=n*i[0]+a[0],r[1]=n*i[1]+a[1],r[2]=n*i[2]+a[2],this._setPosition(r),this}}},{key:"setMaxDistance",value:function(n){return this.maxDistance=n,this}},{key:"setMinDistance",value:function(n){return this.minDistance=n,this}},{key:"changeAzimuth",value:function(n){return this.setAzimuth(this.azimuth+n),this}},{key:"changeElevation",value:function(n){return this.setElevation(this.elevation+n),this}},{key:"changeRoll",value:function(n){return this.setRoll(this.roll+n),this}},{key:"setAzimuth",value:function(n){return this.azimuth=Jc(n),this.computeMatrix(),this._getAxes(),this.type===Br.ORBITING||this.type===Br.EXPLORING?this._getPosition():this.type===Br.TRACKING&&this._getFocalPoint(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(n){return this.elevation=Jc(n),this.computeMatrix(),this._getAxes(),this.type===Br.ORBITING||this.type===Br.EXPLORING?this._getPosition():this.type===Br.TRACKING&&this._getFocalPoint(),this}},{key:"setRoll",value:function(n){return this.roll=Jc(n),this.computeMatrix(),this._getAxes(),this.type===Br.ORBITING||this.type===Br.EXPLORING?this._getPosition():this.type===Br.TRACKING&&this._getFocalPoint(),this}},{key:"rotate",value:function(n,r,i){if(this.type===Br.EXPLORING){n=Jc(n),r=Jc(r),i=Jc(i);var a=Kl(ha(),[1,0,0],(this.rotateWorld?1:-1)*r*Qc),o=Kl(ha(),[0,1,0],(this.rotateWorld?1:-1)*n*Qc),s=Kl(ha(),[0,0,1],i*Qc),c=zs(ha(),o,a);c=zs(ha(),c,s);var f=d_(Go(),c);Nv(this.matrix,this.matrix,[0,0,-this.distance]),Yl(this.matrix,this.matrix,f),Nv(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation+r)>90)return;this.relElevation=Jc(r),this.relAzimuth=Jc(n),this.relRoll=Jc(i),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.computeMatrix()}return this._getAxes(),this.type===Br.ORBITING||this.type===Br.EXPLORING?this._getPosition():this.type===Br.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(n,r){var i=Jl(n,r,0),a=Re.d9(this.position);return Re.IH(a,a,Re.bA(Re.Ue(),this.right,i[0])),Re.IH(a,a,Re.bA(Re.Ue(),this.up,i[1])),this._setPosition(a),this}},{key:"dolly",value:function(n){var r=this.forward,i=Re.d9(this.position),a=n*this.dollyingStep,o=this.distance+n*this.dollyingStep;return a=Math.max(Math.min(o,this.maxDistance),this.minDistance)-this.distance,i[0]+=a*r[0],i[1]+=a*r[1],i[2]+=a*r[2],this._setPosition(i),this.type===Br.ORBITING||this.type===Br.EXPLORING?this._getDistance():this.type===Br.TRACKING&&Re.IH(this.focalPoint,i,this.distanceVector),this}},{key:"createLandmark",value:function(n,r){var i=this.clone();i.setPosition(r.position),i.setFocalPoint(r.focalPoint),r.roll!==void 0&&i.setRoll(r.roll);var a=new HE(n,i);return this.landmarks.push(a),a}},{key:"setLandmark",value:function(n){var r=new HE(n,this);return this.landmarks.push(r),this}},{key:"gotoLandmark",value:function(n){var r=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3,a=this.landmarks.find(function(h){return h.name===n});if(a){if(i===0){a.retrieve(this);return}this.landmarkAnimationID!==void 0&&window.cancelAnimationFrame(this.landmarkAnimationID),this.interactor.disconnect();var o=a.getPosition(),s=a.getFocalPoint(),c=a.getRoll(),f,d=function h(v){f===void 0&&(f=v);var m=v-f,g=(1-Math.cos(m/i*Math.PI))/2,_=Re.Ue(),y=Re.Ue(),E=0;Re.t7(_,r.focalPoint,s,g),Re.t7(y,r.position,o,g),E=r.roll*(1-g)+c*g,r.setFocalPoint(_),r.setPosition(y),r.setRoll(E),r.computeMatrix();var b=Re.TK(_,s)+Re.TK(y,o);if(!(b>.01)){r.setFocalPoint(_),r.setPosition(y),r.setRoll(E),r.computeMatrix(),r.interactor.connect();return}m<i&&(r.landmarkAnimationID=window.requestAnimationFrame(h))};window.requestAnimationFrame(d)}}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles()}},{key:"computeMatrix",value:function(){var n,r,i=Kl(ha(),[0,0,1],this.roll*Qc);l_(this.matrix),n=Kl(ha(),[1,0,0],(this.rotateWorld&&this.type!==Br.TRACKING||this.type===Br.TRACKING?1:-1)*this.elevation*Qc),r=Kl(ha(),[0,1,0],(this.rotateWorld&&this.type!==Br.TRACKING||this.type===Br.TRACKING?1:-1)*this.azimuth*Qc);var a=zs(ha(),r,n);a=zs(ha(),a,i);var o=d_(Go(),a);this.type===Br.ORBITING||this.type===Br.EXPLORING?(Nv(this.matrix,this.matrix,this.focalPoint),Yl(this.matrix,this.matrix,o),Nv(this.matrix,this.matrix,[0,0,this.distance])):this.type===Br.TRACKING&&(Nv(this.matrix,this.matrix,this.position),Yl(this.matrix,this.matrix,o))}},{key:"_setPosition",value:function(n,r,i){this.position=Jl(n,r,i);var a=this.matrix;a[12]=this.position[0],a[13]=this.position[1],a[14]=this.position[2],a[15]=1}},{key:"_getAxes",value:function(){Re.JG(this.right,Jl(Rv(Cv(),[1,0,0,0],this.matrix))),Re.JG(this.up,Jl(Rv(Cv(),[0,1,0,0],this.matrix))),Re.JG(this.forward,Jl(Rv(Cv(),[0,0,1,0],this.matrix))),Re.Fv(this.right,this.right),Re.Fv(this.up,this.up),Re.Fv(this.forward,this.forward)}},{key:"_getAngles",value:function(){var n=this.distanceVector[0],r=this.distanceVector[1],i=this.distanceVector[2],a=Re.kE(this.distanceVector);if(a===0){this.elevation=0,this.azimuth=0;return}this.type===Br.TRACKING?(this.elevation=Math.asin(r/a)*rl,this.azimuth=Math.atan2(-n,-i)*rl):this.rotateWorld?(this.elevation=Math.asin(r/a)*rl,this.azimuth=Math.atan2(-n,-i)*rl):(this.elevation=-Math.asin(r/a)*rl,this.azimuth=-Math.atan2(-n,-i)*rl)}},{key:"_getPosition",value:function(){Re.JG(this.position,Jl(Rv(Cv(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){Re.kK(this.distanceVector,[0,0,-this.distance],Xl.xO(Xl.Ue(),this.matrix)),Re.IH(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=Re.$X(Re.Ue(),this.focalPoint,this.position),this.distance=Re.kE(this.distanceVector),this.dollyingStep=this.distance/100}}]),e}(),qE.ProjectionMode={ORTHOGRAPHIC:"ORTHOGRAPHIC",PERSPECTIVE:"PERSPECTIVE"},JE),KE=cn(Ty.prototype,"interactor",[$E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ty))||YE),eb,tb,nb,Ay,rb,Fv,ib,il=(eb=(0,_t.b2)(),tb=(0,_t.f3)(Je.GeometryComponentManager),eb(nb=(Ay=(ib=Fv=function(){function e(){(0,nn.Z)(this,e),this.config=void 0,un(this,"geometry",rb,this),this.entity=void 0,this.component=void 0}return(0,En.Z)(e,[{key:"getEntity",value:function(){return this.entity}},{key:"getComponent",value:function(){return this.component}},{key:"setConfig",value:function(n){this.config=n}},{key:"setEntity",value:function(n){this.entity=n,this.component=this.geometry.create(n),this.component.entity=n,this.onEntityCreated()}},{key:"onEntityCreated",value:function(){}}]),e}(),Fv.BOX="box",Fv.SPHERE="sphere",Fv.PLANE="plane",Fv.MERGED="merged",ib),rb=cn(Ay.prototype,"geometry",[tb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ay))||nb),Rt=S(49469);function ab(){if(typeof document!="undefined")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}var oA={}.toString,sA=function(t,n){return oA.call(t)==="[object "+n+"]"},uA=sA,cA=function(e){return Array.isArray?Array.isArray(e):uA(e,"Array")},fA=9007199254740991,lA="[object Arguments]",dA="[object Array]",hA="[object Boolean]",vA="[object Date]",pA="[object Error]",mA="[object Function]",gA="[object Map]",yA="[object Number]",_A="[object Object]",EA="[object RegExp]",bA="[object Set]",wA="[object String]",xA="[object WeakMap]",SA="[object ArrayBuffer]",TA="[object DataView]",AA="[object Float32Array]",IA="[object Float64Array]",CA="[object Int8Array]",RA="[object Int16Array]",MA="[object Int32Array]",NA="[object Uint8Array]",DA="[object Uint8ClampedArray]",PA="[object Uint16Array]",OA="[object Uint32Array]",Ai={};Ai[AA]=Ai[IA]=Ai[CA]=Ai[RA]=Ai[MA]=Ai[NA]=Ai[DA]=Ai[PA]=Ai[OA]=!0,Ai[lA]=Ai[dA]=Ai[SA]=Ai[hA]=Ai[TA]=Ai[vA]=Ai[pA]=Ai[mA]=Ai[gA]=Ai[yA]=Ai[_A]=Ai[EA]=Ai[bA]=Ai[wA]=Ai[xA]=!1;function xN(e){return function(t){return e(t)}}var LA=Object.prototype,GA=LA.toString;function kA(e){return UA(e)&&FA(e.length)&&!!Ai[GA.call(e)]}function FA(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=fA}function UA(e){return!!e&&(0,_h.Z)(e)==="object"}var ob=kA,sb,ub,cb,fb,j0,lb,db,hb;function vb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function pb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?vb(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var mb=(sb=(0,_t.b2)(),ub=(0,_t.f3)(Je.RenderEngine),cb=(0,_t.f3)(Je.ConfigService),sb(fb=(j0=(hb=function(){function e(){(0,nn.Z)(this,e),un(this,"engine",lb,this),un(this,"configService",db,this),this.entity=cc(),this.model=void 0,this.dirty=!0,this.compiledBundle=void 0,this.initPromise=void 0}return(0,En.Z)(e,[{key:"init",value:function(){var n=this.configService.get(),r=n.canvas,i=n.engineOptions;this.initPromise=this.engine.init(pb({canvas:r||ab(),swapChainFormat:Rt.EV.BGRA8Unorm,antialiasing:!1},i))}},{key:"setBundle",value:function(n){this.compiledBundle=JSON.parse(JSON.stringify(n))}},{key:"setDispatch",value:function(n){return this.compiledBundle.context&&(this.compiledBundle.context.dispatch=n),this}},{key:"setMaxIteration",value:function(n){return this.compiledBundle.context&&(this.compiledBundle.context.maxIteration=n),this}},{key:"setBinding",value:function(n,r){var i=this;if(typeof n=="string"){var a=Sy(r)||ob(r)||cA(r);if(this.compiledBundle&&this.compiledBundle.context){var o=this.compiledBundle.context.defines.find(function(c){return c.name===n});if(o)return o.value=r,this;var s=this.compiledBundle.context.uniforms.find(function(c){return c.name===n});s&&(a?(s.data=r,s.isReferer=!1,s.storageClass===nl.Uniform?this.model&&this.model.updateUniform(n,r):this.model&&this.model.updateBuffer(n,r)):(s.isReferer=!0,s.data=r))}}else Object.keys(n).forEach(function(c){i.setBinding(c,n[c])});return this}},{key:"execute",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(){var i=this,a,o,s=arguments;return Kt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(a=s.length>0&&s[0]!==void 0?s[0]:1,!this.dirty){f.next=6;break}return this.compiledBundle.context&&(a>1?this.compiledBundle.context.maxIteration=a:this.compiledBundle.context.maxIteration++),f.next=5,this.compile();case 5:this.dirty=!1;case 6:for(this.engine.beginFrame(),this.engine.clear({}),this.compiledBundle.context&&this.compiledBundle.context.uniforms.filter(function(d){var h=d.isReferer;return h}).forEach(function(d){var h=d.data,v=d.name;i.model.confirmInput(h.model,v)}),o=0;o<a;o++)this.model.run();return this.engine.endFrame(),f.abrupt("return",this);case 12:case"end":return f.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"getOutput",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(){return Kt().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",this.model.readData());case 1:case"end":return a.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"compile",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(){var i,a,o;return Kt().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.initPromise;case 2:return i=pb({},this.compiledBundle.context),a=this.engine.supportWebGPU?this.engine.useWGSL?kv.WGSL:kv.GLSL450:kv.GLSL100,o=this.compiledBundle.shaders[a],i.defines.filter(function(f){return f.runtime}).forEach(function(f){var d="".concat(aA).concat(f.name);o=o.replace(d,"".concat(f.value))}),i.shader=o,i.uniforms.forEach(function(f){if(!f.data&&f.storageClass===nl.StorageBuffer){var d=1;f.type===ql.FloatArray?d=1:f.type===ql.Vector4FloatArray&&(d=4),f.data=new Float32Array(i.output.length*d).fill(0)}}),this.compiledBundle.context=i,c.next=11,this.engine.createComputeModel(this.compiledBundle.context);case 11:this.model=c.sent;case 12:case"end":return c.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()}]),e}(),hb),lb=cn(j0.prototype,"engine",[ub],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),db=cn(j0.prototype,"configService",[cb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j0))||fb),gb,yb,_b,Iy,Eb,bb,wb,xb=(gb=(0,_t.b2)(),yb=(0,_t.f3)(Je.MaterialComponentManager),gb(_b=(Iy=(wb=bb=function(){function e(){(0,nn.Z)(this,e),this.config=void 0,un(this,"material",Eb,this),this.entity=void 0,this.component=void 0}return(0,En.Z)(e,[{key:"getEntity",value:function(){return this.entity}},{key:"getComponent",value:function(){return this.component}},{key:"setConfig",value:function(n){this.config=n}},{key:"setEntity",value:function(n,r){this.entity=n,this.component=this.material.create(n),this.component.entity=n,this.component.type=r,this.onEntityCreated()}},{key:"onEntityCreated",value:function(){}}]),e}(),bb.BASIC="basic",wb),Eb=cn(Iy.prototype,"material",[yb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Iy))||_b),Sb,Tb,Ab,Ib,Cb,Rb,Mb,Th,Nb,Db,Pb,Ob,H0,Lb,al=(Sb=(0,_t.b2)(),Tb=(0,_t.f3)(Je.MeshComponentManager),Ab=(0,_t.f3)(Je.CullableComponentManager),Ib=(0,_t.f3)(Je.TransformComponentManager),Cb=(0,_t.f3)(Je.Systems),Rb=(0,_t.t6)(Je.SceneGraphSystem),Sb(Mb=(Th=(Lb=H0=function(){function e(){(0,nn.Z)(this,e),this.attributes={},this.config=void 0,un(this,"mesh",Nb,this),un(this,"cullable",Db,this),un(this,"transform",Pb,this),un(this,"sceneGraphSystem",Ob,this),this.meshComponent=void 0,this.transformComponent=void 0,this.entity=void 0}return(0,En.Z)(e,[{key:"getEntity",value:function(){return this.entity}},{key:"getTransformComponent",value:function(){return this.transformComponent}},{key:"getMeshComponent",value:function(){return this.meshComponent}},{key:"setConfig",value:function(n){this.config=n}},{key:"setEntity",value:function(n){this.entity=n,this.cullable.create(n),this.meshComponent=this.mesh.create(n),this.transformComponent=this.transform.create(n),this.onEntityCreated()}},{key:"setMaterial",value:function(n){return this.meshComponent.material=n,this}},{key:"setGeometry",value:function(n){return this.meshComponent.geometry=n,this}},{key:"setAttributes",value:function(n){var r=this;Object.keys(n).forEach(function(i){n[i]!==void 0&&n[i]!==r.attributes[i]&&(r.onAttributeChanged({name:i,data:n[i]}),r.attributes[i]=n[i])})}},{key:"setVisible",value:function(n){var r=this;return this.meshComponent.visible=n,this.meshComponent.children.forEach(function(i){var a=r.mesh.getComponentByEntity(i);a&&(a.visible=n)}),this}},{key:"isVisible",value:function(){return this.meshComponent.visible}},{key:"attach",value:function(n){return this.sceneGraphSystem.attach(this.entity,n.entity),this}},{key:"detach",value:function(){return this.sceneGraphSystem.detach(this.entity),this}},{key:"detachChildren",value:function(){return this.sceneGraphSystem.detachChildren(this.entity),this}},{key:"onEntityCreated",value:function(){}},{key:"onAttributeChanged",value:function(n){var r=n.name,i=n.data;this.meshComponent&&this.meshComponent.material&&this.meshComponent.material.setUniform(this.convertAttributeName2UniformName(r),i)}},{key:"convertAttributeName2UniformName",value:function(n){return n}}]),e}(),H0.POINT="point",H0.LINE="line",H0.GRID="grid",Lb),Nb=cn(Th.prototype,"mesh",[Tb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Db=cn(Th.prototype,"cullable",[Ab],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pb=cn(Th.prototype,"transform",[Ib],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ob=cn(Th.prototype,"sceneGraphSystem",[Cb,Rb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Th))||Mb),BA=S(81550),zA=S.n(BA),WA=function(){function e(t,n){(0,nn.Z)(this,e),this.attribute=void 0,this.buffer=void 0;var r=n.buffer,i=n.offset,a=n.stride,o=n.normalized,s=n.size,c=n.divisor;this.buffer=r,this.attribute={buffer:r.get(),offset:i||0,stride:a||0,normalized:o||!1,divisor:c||0},s&&(this.attribute.size=s)}return(0,En.Z)(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(n){this.buffer.subData(n)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),ef,Uv,tf,Ws,Bv,ol,zv,X0,lc,ed,Oa,dc,hc,$0,VA=(ef={},(0,ze.Z)(ef,ve.POINTS,"points"),(0,ze.Z)(ef,ve.LINES,"lines"),(0,ze.Z)(ef,ve.LINE_LOOP,"line loop"),(0,ze.Z)(ef,ve.LINE_STRIP,"line strip"),(0,ze.Z)(ef,ve.TRIANGLES,"triangles"),(0,ze.Z)(ef,ve.TRIANGLE_FAN,"triangle fan"),(0,ze.Z)(ef,ve.TRIANGLE_STRIP,"triangle strip"),ef),Gb=(Uv={},(0,ze.Z)(Uv,ve.STATIC_DRAW,"static"),(0,ze.Z)(Uv,ve.DYNAMIC_DRAW,"dynamic"),(0,ze.Z)(Uv,ve.STREAM_DRAW,"stream"),Uv),Cy=(tf={},(0,ze.Z)(tf,ve.BYTE,"int8"),(0,ze.Z)(tf,ve.UNSIGNED_INT,"int16"),(0,ze.Z)(tf,ve.INT,"int32"),(0,ze.Z)(tf,ve.UNSIGNED_BYTE,"uint8"),(0,ze.Z)(tf,ve.UNSIGNED_SHORT,"uint16"),(0,ze.Z)(tf,ve.UNSIGNED_INT,"uint32"),(0,ze.Z)(tf,ve.FLOAT,"float"),tf),ZA=(Ws={},(0,ze.Z)(Ws,ve.ALPHA,"alpha"),(0,ze.Z)(Ws,ve.LUMINANCE,"luminance"),(0,ze.Z)(Ws,ve.LUMINANCE_ALPHA,"luminance alpha"),(0,ze.Z)(Ws,ve.RGB,"rgb"),(0,ze.Z)(Ws,ve.RGBA,"rgba"),(0,ze.Z)(Ws,ve.RGBA4,"rgba4"),(0,ze.Z)(Ws,ve.RGB5_A1,"rgb5 a1"),(0,ze.Z)(Ws,ve.RGB565,"rgb565"),(0,ze.Z)(Ws,ve.DEPTH_COMPONENT,"depth"),(0,ze.Z)(Ws,ve.DEPTH_STENCIL,"depth stencil"),Ws),jA=(Bv={},(0,ze.Z)(Bv,ve.DONT_CARE,"dont care"),(0,ze.Z)(Bv,ve.NICEST,"nice"),(0,ze.Z)(Bv,ve.FASTEST,"fast"),Bv),kb=(ol={},(0,ze.Z)(ol,ve.NEAREST,"nearest"),(0,ze.Z)(ol,ve.LINEAR,"linear"),(0,ze.Z)(ol,ve.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,ze.Z)(ol,ve.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,ze.Z)(ol,ve.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,ze.Z)(ol,ve.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),ol),Fb=(zv={},(0,ze.Z)(zv,ve.REPEAT,"repeat"),(0,ze.Z)(zv,ve.CLAMP_TO_EDGE,"clamp"),(0,ze.Z)(zv,ve.MIRRORED_REPEAT,"mirror"),zv),HA=(X0={},(0,ze.Z)(X0,ve.NONE,"none"),(0,ze.Z)(X0,ve.BROWSER_DEFAULT_WEBGL,"browser"),X0),XA=(lc={},(0,ze.Z)(lc,ve.NEVER,"never"),(0,ze.Z)(lc,ve.ALWAYS,"always"),(0,ze.Z)(lc,ve.LESS,"less"),(0,ze.Z)(lc,ve.LEQUAL,"lequal"),(0,ze.Z)(lc,ve.GREATER,"greater"),(0,ze.Z)(lc,ve.GEQUAL,"gequal"),(0,ze.Z)(lc,ve.EQUAL,"equal"),(0,ze.Z)(lc,ve.NOTEQUAL,"notequal"),lc),Ub=(ed={},(0,ze.Z)(ed,ve.FUNC_ADD,"add"),(0,ze.Z)(ed,ve.MIN_EXT,"min"),(0,ze.Z)(ed,ve.MAX_EXT,"max"),(0,ze.Z)(ed,ve.FUNC_SUBTRACT,"subtract"),(0,ze.Z)(ed,ve.FUNC_REVERSE_SUBTRACT,"reverse subtract"),ed),Y0=(Oa={},(0,ze.Z)(Oa,ve.ZERO,"zero"),(0,ze.Z)(Oa,ve.ONE,"one"),(0,ze.Z)(Oa,ve.SRC_COLOR,"src color"),(0,ze.Z)(Oa,ve.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,ze.Z)(Oa,ve.SRC_ALPHA,"src alpha"),(0,ze.Z)(Oa,ve.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,ze.Z)(Oa,ve.DST_COLOR,"dst color"),(0,ze.Z)(Oa,ve.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,ze.Z)(Oa,ve.DST_ALPHA,"dst alpha"),(0,ze.Z)(Oa,ve.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,ze.Z)(Oa,ve.CONSTANT_COLOR,"constant color"),(0,ze.Z)(Oa,ve.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,ze.Z)(Oa,ve.CONSTANT_ALPHA,"constant alpha"),(0,ze.Z)(Oa,ve.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,ze.Z)(Oa,ve.SRC_ALPHA_SATURATE,"src alpha saturate"),Oa),$A=(dc={},(0,ze.Z)(dc,ve.NEVER,"never"),(0,ze.Z)(dc,ve.ALWAYS,"always"),(0,ze.Z)(dc,ve.LESS,"less"),(0,ze.Z)(dc,ve.LEQUAL,"lequal"),(0,ze.Z)(dc,ve.GREATER,"greater"),(0,ze.Z)(dc,ve.GEQUAL,"gequal"),(0,ze.Z)(dc,ve.EQUAL,"equal"),(0,ze.Z)(dc,ve.NOTEQUAL,"notequal"),dc),Ah=(hc={},(0,ze.Z)(hc,ve.ZERO,"zero"),(0,ze.Z)(hc,ve.KEEP,"keep"),(0,ze.Z)(hc,ve.REPLACE,"replace"),(0,ze.Z)(hc,ve.INVERT,"invert"),(0,ze.Z)(hc,ve.INCR,"increment"),(0,ze.Z)(hc,ve.DECR,"decrement"),(0,ze.Z)(hc,ve.INCR_WRAP,"increment wrap"),(0,ze.Z)(hc,ve.DECR_WRAP,"decrement wrap"),hc),YA=($0={},(0,ze.Z)($0,ve.FRONT,"front"),(0,ze.Z)($0,ve.BACK,"back"),$0),KA=function(){function e(t,n){(0,nn.Z)(this,e),this.buffer=void 0;var r=n.data,i=n.usage,a=n.type;this.buffer=t.buffer({data:r,usage:Gb[i||ve.STATIC_DRAW],type:Cy[a||ve.UNSIGNED_BYTE]})}return(0,En.Z)(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){}},{key:"subData",value:function(n){var r=n.data,i=n.offset;this.buffer.subdata(r,i)}}]),e}(),ta=S(85061),qA=9007199254740991,JA="[object Arguments]",QA="[object Array]",eI="[object Boolean]",tI="[object Date]",nI="[object Error]",rI="[object Function]",iI="[object Map]",aI="[object Number]",oI="[object Object]",sI="[object RegExp]",uI="[object Set]",cI="[object String]",fI="[object WeakMap]",lI="[object ArrayBuffer]",dI="[object DataView]",hI="[object Float32Array]",vI="[object Float64Array]",pI="[object Int8Array]",mI="[object Int16Array]",gI="[object Int32Array]",yI="[object Uint8Array]",_I="[object Uint8ClampedArray]",EI="[object Uint16Array]",bI="[object Uint32Array]",Ii={};Ii[hI]=Ii[vI]=Ii[pI]=Ii[mI]=Ii[gI]=Ii[yI]=Ii[_I]=Ii[EI]=Ii[bI]=!0,Ii[JA]=Ii[QA]=Ii[lI]=Ii[eI]=Ii[dI]=Ii[tI]=Ii[nI]=Ii[rI]=Ii[iI]=Ii[aI]=Ii[oI]=Ii[sI]=Ii[uI]=Ii[cI]=Ii[fI]=!1;function SN(e){return function(t){return e(t)}}var wI=Object.prototype,xI=wI.toString;function SI(e){return AI(e)&&TI(e.length)&&!!Ii[xI.call(e)]}function TI(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=qA}function AI(e){return!!e&&(0,_h.Z)(e)==="object"}var Ry=SI;function Bb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function zb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Bb(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var II=`attribute vec3 a_Position;
attribute vec2 a_TexCoord;

varying vec2 v_TexCoord;

void main() {
  gl_Position = vec4(a_Position, 1.0);
  v_TexCoord = a_TexCoord;
}`,Wb=0,K0=!1,CI=function(){function e(t,n){var r=this;(0,nn.Z)(this,e),this.reGl=t,this.context=n,this.entity=cc(),this.texFBO=void 0,this.computeCommand=void 0,this.textureCache={},this.outputTextureName=void 0,this.swapOutputTextureName=void 0,this.compiledPingpong=void 0,this.dynamicPingpong=void 0;var i={};this.context.uniforms.forEach(function(f){var d=f.name,h=f.type,v=f.data,m=f.isReferer,g=f.storageClass;if(g===nl.StorageBuffer){if(m)r.textureCache[d]={data:void 0},i["".concat(d,"Size")]=function(){return v.compiledBundle.context.output.textureSize};else{r.textureCache[d]=r.calcDataTexture(d,h,v);var _=r.textureCache[d],y=_.textureWidth,E=_.isOutput;i["".concat(d,"Size")]=[y,y],E&&(r.outputTextureName=d,r.context.needPingpong&&(r.outputTextureName="".concat(d,"Output"),r.textureCache[r.outputTextureName]=r.calcDataTexture(d,h,v)))}i[d]=function(){return K0&&console.log("[".concat(r.entity,"]: ").concat(d," ").concat(r.textureCache[d].id)),r.textureCache[d].texture}}else if(g===nl.Uniform){if(v&&(Array.isArray(v)||Ry(v))&&v.length>16)throw new Error("invalid data type ".concat(h));i[d]=function(){return f.data}}});var a=this.getOuputDataTexture(),o=a.textureWidth,s=a.texelCount;i.u_OutputTextureSize=[o,o],i.u_OutputTexelCount=s,this.context.output.textureSize=[o,o];var c={attributes:{a_Position:[[-1,1,0],[-1,-1,0],[1,1,0],[1,-1,0]],a_TexCoord:[[0,1],[0,0],[1,1],[1,0]]},frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(this.context.shader),uniforms:i,vert:II,primitive:"triangle strip",count:4};this.computeCommand=this.reGl(c)}return(0,En.Z)(e,[{key:"run",value:function(){var n=this;this.context.maxIteration>1&&this.context.needPingpong&&(this.compiledPingpong=!0),(this.compiledPingpong||this.dynamicPingpong)&&this.swap(),this.texFBO=this.reGl.framebuffer({color:this.getOuputDataTexture().texture}),this.texFBO.use(function(){n.computeCommand()}),K0&&console.log("[".concat(this.entity,"]: output ").concat(this.getOuputDataTexture().id))}},{key:"readData",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(){var i=this,a,o,s,c,f,d,h,v;return Kt().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(this.reGl({framebuffer:this.texFBO})(function(){a=i.reGl.read()}),!a){g.next=6;break}if(o=this.getOuputDataTexture(),s=o.originalDataLength,c=o.elementsPerTexel,f=o.typedArrayConstructor,d=f===void 0?Float32Array:f,h=[],c!==4)for(v=0;v<a.length;v+=4)c===1?h.push(a[v]):c===2?h.push(a[v],a[v+1]):h.push(a[v],a[v+1],a[v+2]);else h=a;return g.abrupt("return",new d(h.slice(0,s)));case 6:return g.abrupt("return",new Float32Array);case 7:case"end":return g.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"confirmInput",value:function(n,r){var i;this.entity===n.entity?(this.dynamicPingpong=!0,i=this):i=n,this.textureCache[r].id=i.getOuputDataTexture().id,this.textureCache[r].texture=i.getOuputDataTexture().texture,K0&&console.log("[".concat(this.entity,"]: confirm input ").concat(r," from model ").concat(i.entity,", ").concat(i.getOuputDataTexture().id))}},{key:"updateUniform",value:function(){}},{key:"updateBuffer",value:function(n,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=this.context.uniforms.find(function(f){var d=f.name;return d===n});if(a){var o=this.calcDataTexture(n,a.type,r),s=o.texture,c=o.data;this.textureCache[n].data=c,this.textureCache[n].texture=s}}},{key:"destroy",value:function(){}},{key:"swap",value:function(){if(this.swapOutputTextureName||this.createSwapOutputDataTexture(),this.compiledPingpong){var n=this.context.output.name;this.textureCache[n].id=this.getOuputDataTexture().id,this.textureCache[n].texture=this.getOuputDataTexture().texture}var r=this.outputTextureName;this.outputTextureName=this.swapOutputTextureName,this.swapOutputTextureName=r,K0&&console.log("[".concat(this.entity,"]: after swap, output ").concat(this.getOuputDataTexture().id))}},{key:"getOuputDataTexture",value:function(){return this.textureCache[this.outputTextureName]}},{key:"createSwapOutputDataTexture",value:function(){var n=this.cloneDataTexture(this.getOuputDataTexture());this.swapOutputTextureName="".concat(this.entity,"-swap"),this.textureCache[this.swapOutputTextureName]=n}},{key:"cloneDataTexture",value:function(n){var r=n.data,i=n.textureWidth;return zb(zb({},n),{},{id:Wb++,texture:this.reGl.texture({width:i,height:i,data:r,type:"float"})})}},{key:"calcDataTexture",value:function(n,r,i){var a=1;r===ql.Vector4FloatArray&&(a=4);for(var o=[],s=0;s<i.length;s+=a)a===1?o.push(i[s],0,0,0):a===2?o.push(i[s],i[s+1],0,0):a===3?o.push(i[s],i[s+1],i[s+2],0):a===4&&o.push(i[s],i[s+1],i[s+2],i[s+3]);var c=i.length,f=Math.ceil(c/a),d=Math.ceil(Math.sqrt(f)),h=d*d;f<h&&o.push.apply(o,(0,ta.Z)(new Array((h-f)*4).fill(0)));var v=this.reGl.texture({width:d,height:d,data:o,type:"float"});return{id:Wb++,data:o,originalDataLength:c,typedArrayConstructor:Ry(i)?i.constructor:void 0,textureWidth:d,texture:v,texelCount:f,elementsPerTexel:a,isOutput:n===this.context.output.name}}}]),e}(),RI=function(){function e(t,n){(0,nn.Z)(this,e),this.elements=void 0;var r=n.data,i=n.usage,a=n.type,o=n.count;this.elements=t.elements({data:r,usage:Gb[i||ve.STATIC_DRAW],type:Cy[a||ve.UNSIGNED_BYTE],count:o})}return(0,En.Z)(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(n){var r=n.data;this.elements.subdata(r)}},{key:"destroy",value:function(){this.elements.destroy()}}]),e}(),MI=function(){function e(t,n){(0,nn.Z)(this,e),this.framebuffer=void 0;var r=n.width,i=n.height,a=n.color,o=n.colors,s=n.depth,c=n.stencil,f={width:r,height:i};Array.isArray(o)&&(f.colors=o.map(function(d){return d.get()})),a&&typeof a!="boolean"&&(f.color=a.get()),this.framebuffer=t.framebuffer(f)}return(0,En.Z)(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(n){var r=n.width,i=n.height;this.framebuffer.resize(r,i)}}]),e}();function NI(e){var t=(0,_h.Z)(e);return e!=null&&(t==="object"||t==="function")}function Wv(e){var t={};return Object.keys(e).forEach(function(n){My(n,e[n],t,"")}),t}function My(e,t,n,r){if(t===null||typeof t=="number"||typeof t=="boolean"||Array.isArray(t)&&typeof t[0]=="number"||Ry(t)||t===""||t.resize!==void 0){n["".concat(r&&r+".").concat(e)]=t;return}NI(t)&&Object.keys(t).forEach(function(i){My(i,t[i],n,"".concat(r&&r+".").concat(e))}),Array.isArray(t)&&t.forEach(function(i,a){Object.keys(i).forEach(function(o){My(o,i[o],n,"".concat(r&&r+".").concat(e,"[").concat(a,"]"))})})}function Vb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Ih(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Vb(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var DI=function(){function e(t,n){(0,nn.Z)(this,e),this.reGl=void 0,this.drawCommand=void 0,this.uniforms={},this.reGl=t;var r=n.vs,i=n.fs,a=n.defines,o=n.attributes,s=n.uniforms,c=n.primitive,f=n.count,d=n.elements,h=n.depth,v=n.blend,m=n.stencil,g=n.cull,_=n.instances,y=n.scissor,E=n.viewport,b={};s&&(this.uniforms=Wv(s),Object.keys(s).forEach(function(W){b[W]=t.prop(W)}));var A={};Object.keys(o).forEach(function(W){A[W]=o[W].get()});var C=a&&this.generateDefines(a)||"",R={attributes:A,frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(C,`
`).concat(i),uniforms:b,vert:`
`.concat(C,`
`).concat(r),primitive:VA[c===void 0?ve.TRIANGLES:c]};_&&(R.instances=_),f&&(R.count=f),d&&(R.elements=d.get()),y&&(R.scissor=y),E&&(R.viewport=E),this.initDepthDrawParams({depth:h},R),this.initBlendDrawParams({blend:v},R),this.initStencilDrawParams({stencil:m},R),this.initCullDrawParams({cull:g},R),this.drawCommand=t(R)}return(0,En.Z)(e,[{key:"addUniforms",value:function(n){this.uniforms=Ih(Ih({},this.uniforms),Wv(n))}},{key:"draw",value:function(n){var r=Ih(Ih({},this.uniforms),Wv(n.uniforms||{})),i={};Object.keys(r).forEach(function(a){var o=(0,_h.Z)(r[a]);o==="boolean"||o==="number"||Array.isArray(r[a])||r[a].BYTES_PER_ELEMENT?i[a]=r[a]:o==="string"||(i[a]=r[a].get())}),this.drawCommand(i)}},{key:"destroy",value:function(){}},{key:"initDepthDrawParams",value:function(n,r){var i=n.depth;i&&(r.depth={enable:i.enable===void 0?!0:!!i.enable,mask:i.mask===void 0?!0:!!i.mask,func:XA[i.func||ve.LESS],range:i.range||[0,1]})}},{key:"initBlendDrawParams",value:function(n,r){var i=n.blend;if(i){var a=i.enable,o=i.func,s=i.equation,c=i.color,f=c===void 0?[0,0,0,0]:c;r.blend={enable:!!a,func:{srcRGB:Y0[o&&o.srcRGB||ve.SRC_ALPHA],srcAlpha:Y0[o&&o.srcAlpha||ve.SRC_ALPHA],dstRGB:Y0[o&&o.dstRGB||ve.ONE_MINUS_SRC_ALPHA],dstAlpha:Y0[o&&o.dstAlpha||ve.ONE_MINUS_SRC_ALPHA]},equation:{rgb:Ub[s&&s.rgb||ve.FUNC_ADD],alpha:Ub[s&&s.alpha||ve.FUNC_ADD]},color:f}}}},{key:"initStencilDrawParams",value:function(n,r){var i=n.stencil;if(i){var a=i.enable,o=i.mask,s=o===void 0?-1:o,c=i.func,f=c===void 0?{cmp:ve.ALWAYS,ref:0,mask:-1}:c,d=i.opFront,h=d===void 0?{fail:ve.KEEP,zfail:ve.KEEP,zpass:ve.KEEP}:d,v=i.opBack,m=v===void 0?{fail:ve.KEEP,zfail:ve.KEEP,zpass:ve.KEEP}:v;r.stencil={enable:!!a,mask:s,func:Ih(Ih({},f),{},{cmp:$A[f.cmp]}),opFront:{fail:Ah[h.fail],zfail:Ah[h.zfail],zpass:Ah[h.zpass]},opBack:{fail:Ah[m.fail],zfail:Ah[m.zfail],zpass:Ah[m.zpass]}}}}},{key:"initCullDrawParams",value:function(n,r){var i=n.cull;if(i){var a=i.enable,o=i.face,s=o===void 0?ve.BACK:o;r.cull={enable:!!a,face:YA[s]}}}},{key:"generateDefines",value:function(n){return Object.keys(n).map(function(r){return"#define ".concat(r," ").concat(Number(n[r]))}).join(`
`)}}]),e}(),PI=function(){function e(t,n){(0,nn.Z)(this,e),this.texture=void 0,this.width=void 0,this.height=void 0;var r=n.data,i=n.type,a=i===void 0?ve.UNSIGNED_BYTE:i,o=n.width,s=n.height,c=n.flipY,f=c===void 0?!1:c,d=n.format,h=d===void 0?ve.RGBA:d,v=n.mipmap,m=v===void 0?!1:v,g=n.wrapS,_=g===void 0?ve.CLAMP_TO_EDGE:g,y=n.wrapT,E=y===void 0?ve.CLAMP_TO_EDGE:y,b=n.aniso,A=b===void 0?0:b,C=n.alignment,R=C===void 0?1:C,W=n.premultiplyAlpha,te=W===void 0?!1:W,Q=n.mag,re=Q===void 0?ve.NEAREST:Q,de=n.min,Ce=de===void 0?ve.NEAREST:de,ie=n.colorSpace,Ge=ie===void 0?ve.BROWSER_DEFAULT_WEBGL:ie;this.width=o,this.height=s;var We={width:o,height:s,type:Cy[a],format:ZA[h],wrapS:Fb[_],wrapT:Fb[E],mag:kb[re],min:kb[Ce],alignment:R,flipY:f,colorSpace:HA[Ge],premultiplyAlpha:te,aniso:A};r&&(We.data=r),typeof m=="number"?We.mipmap=jA[m]:typeof m=="boolean"&&(We.mipmap=m),this.texture=t.texture(We)}return(0,En.Z)(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(n){var r=n.width,i=n.height;this.texture.resize(r,i),this.width=r,this.height=i}},{key:"destroy",value:function(){this.texture.destroy()}}]),e}(),Zb,jb,Hb,OI=(Zb=(0,_t.b2)(),Zb(jb=(Hb=function(){function e(){var t=this;(0,nn.Z)(this,e),this.supportWebGPU=!1,this.useWGSL=!1,this.$canvas=void 0,this.gl=void 0,this.inited=void 0,this.createModel=function(){var n=(0,Sr.Z)(Kt().mark(function r(i){return Kt().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!i.uniforms){o.next=3;break}return o.next=3,Promise.all(Object.keys(i.uniforms).map(function(){var s=(0,Sr.Z)(Kt().mark(function c(f){var d;return Kt().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!(i.uniforms[f]&&i.uniforms[f].load!==void 0)){v.next=5;break}return v.next=3,i.uniforms[f].load();case 3:d=v.sent,i.uniforms[f]=d;case 5:case"end":return v.stop()}},c)}));return function(c){return s.apply(this,arguments)}}()));case 3:return o.abrupt("return",new DI(t.gl,i));case 4:case"end":return o.stop()}},r)}));return function(r){return n.apply(this,arguments)}}(),this.createAttribute=function(n){return new WA(t.gl,n)},this.createBuffer=function(n){return new KA(t.gl,n)},this.createElements=function(n){return new RI(t.gl,n)},this.createTexture2D=function(n){return new PI(t.gl,n)},this.createFramebuffer=function(n){return new MI(t.gl,n)},this.useFramebuffer=function(n,r){t.gl({framebuffer:n?n.get():null})(r)},this.createComputeModel=function(){var n=(0,Sr.Z)(Kt().mark(function r(i){return Kt().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",new CI(t.gl,i));case 1:case"end":return o.stop()}},r)}));return function(r){return n.apply(this,arguments)}}(),this.clear=function(n){var r=n.color,i=n.depth,a=n.stencil,o=n.framebuffer,s=o===void 0?null:o,c={color:r,depth:i,stencil:a};c.framebuffer=s===null?s:s.get(),t.gl.clear(c)},this.setScissor=function(n){t.gl&&t.gl._gl&&(n.enable&&n.box?(t.gl._gl.enable(ve.SCISSOR_TEST),t.gl._gl.scissor(n.box.x,n.box.y,n.box.width,n.box.height)):t.gl._gl.disable(ve.SCISSOR_TEST),t.gl._refresh())},this.viewport=function(n){var r=n.x,i=n.y,a=n.width,o=n.height;t.gl&&t.gl._gl&&(t.gl._gl.viewport(r,i,a,o),t.gl._refresh())},this.readPixels=function(n){var r=n.framebuffer,i=n.x,a=n.y,o=n.width,s=n.height,c={x:i,y:a,width:o,height:s};return r&&(c.framebuffer=r.get()),t.gl.read(c)},this.getCanvas=function(){return t.$canvas},this.getGLContext=function(){return t.gl._gl},this.destroy=function(){t.gl&&(t.gl.destroy(),t.inited=!1)}}return(0,En.Z)(e,[{key:"init",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(i){return Kt().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!this.inited){o.next=2;break}return o.abrupt("return");case 2:return this.$canvas=i.canvas,o.next=5,new Promise(function(s,c){zA()({canvas:i.canvas,attributes:{alpha:!0,antialias:i.antialias,premultipliedAlpha:!0},pixelRatio:1,extensions:["OES_element_index_uint","OES_texture_float","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(d,h){(d||!h)&&c(d),s(h)}})});case 5:this.gl=o.sent,this.inited=!0;case 7:case"end":return o.stop()}},r,this)}));function n(r){return t.apply(this,arguments)}return n}()},{key:"isFloatSupported",value:function(){return this.gl.limits.readFloat}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),e}(),Hb))||jb);function LI(){return typeof window!="undefined"}function GI(e,t,n,r){if(!!LI()){var i=document.getElementsByTagName("head")[0],a=document.createElement("script");a.setAttribute("type","text/javascript"),a.setAttribute("src",e),r&&(a.id=r),a.onload=function(){t&&t()},a.onerror=function(o){n&&n("Unable to load script '".concat(e,"'"),o)},i.appendChild(a)}}function kI(e,t){return new Promise(function(n,r){GI(e,function(){n()},function(i,a){r(a)})})}var q0;function FI(){return Ny.apply(this,arguments)}function Ny(){return Ny=(0,Sr.Z)(Kt().mark(function e(){return Kt().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!q0){n.next=2;break}return n.abrupt("return",q0);case 2:return n.next=4,kI("https://preview.babylonjs.com/glslang/glslang.js");case 4:return q0=window.glslang("https://preview.babylonjs.com/glslang/glslang.wasm"),n.abrupt("return",q0);case 6:case"end":return n.stop()}},e)})),Ny.apply(this,arguments)}var UI=function(){function e(t,n){(0,nn.Z)(this,e),this.engine=t,this.options=n,this.attribute=void 0,this.buffer=void 0;var r=n,i=r.buffer,a=r.offset,o=r.stride,s=r.normalized,c=r.size,f=r.divisor,d=r.arrayStride,h=r.attributes,v=r.stepMode;this.buffer=i,this.attribute={buffer:i.get(),offset:a||0,stride:o||0,normalized:s||!1,divisor:f||0,arrayStride:d||0,attributes:h,stepMode:v||"vertex"},c&&(this.attribute.size=c)}return(0,En.Z)(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(n){this.buffer.subData(n)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),Ch=function(){function e(t,n){(0,nn.Z)(this,e),this.engine=t,this.options=n,this.buffer=void 0;var r=n,i=r.data,a=r.usage,o=r.type;this.buffer=this.createBuffer(i instanceof Array?new Float32Array(i):i,a||Rt.FB.Vertex|Rt.FB.CopyDst)}return(0,En.Z)(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(n){var r=n.data,i=n.offset;this.setSubData(this.buffer,i,r instanceof Array?new Float32Array(r):r)}},{key:"createBuffer",value:function(n,r){var i=n.byteLength%4,a={size:n.byteLength+i,usage:r},o=this.engine.device.createBuffer(a);return this.setSubData(o,0,n),o}},{key:"setSubData",value:function(n,r,i){var a=ko?this.engine.device.getQueue():this.engine.device.defaultQueue;a.writeBuffer(n,r,i)}}]),e}();function BI(e){return typeof e=="number"}var zI=function(){function e(t,n){(0,nn.Z)(this,e),this.engine=t,this.context=n,this.entity=cc(),this.uniformGPUBufferLayout=[],this.uniformBuffer=void 0,this.vertexBuffers={},this.outputBuffer=void 0,this.bindGroupEntries=void 0,this.bindGroup=void 0,this.computePipeline=void 0}return(0,En.Z)(e,[{key:"init",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(){var i=this,a,o,s,c,f,d,h;return Kt().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.compileComputePipelineStageDescriptor(this.context.shader);case 2:a=m.sent,o=a.computeStage,s=this.context.uniforms.filter(function(g){return g.storageClass===nl.StorageBuffer}),c=this.context.uniforms.filter(function(g){return g.storageClass===nl.Uniform}),f=c.length?1:0,this.bindGroupEntries=[],f&&(d=0,h=[],c.forEach(function(g){if(BI(g.data))i.uniformGPUBufferLayout.push({name:g.name,offset:d}),d+=4,h.push(g.data);else{var _,y=((_=g.data)===null||_===void 0?void 0:_.length)||1;y===3&&(y=4,g.data.push(0));var E=d/4%4;if(E>0){var b=4-E;if(y>1&&y<=b)y===2&&(b===3&&(d+=4,h.push(0)),h.push.apply(h,(0,ta.Z)(g.data)),i.uniformGPUBufferLayout.push({name:g.name,offset:d}));else{for(var A=0;A<b;A++)d+=4,h.push(0);h.push.apply(h,(0,ta.Z)(g.data)),i.uniformGPUBufferLayout.push({name:g.name,offset:d})}}d+=4*y}}),this.uniformBuffer=new Ch(this.engine,{data:h instanceof Array?new Float32Array(h):h,usage:Rt.FB.Uniform|Rt.FB.CopyDst}),this.bindGroupEntries.push({binding:0,resource:{buffer:this.uniformBuffer.get()}})),s.forEach(function(g){if(g.data!==null&&(g.type===ql.Vector4FloatArray||g.type===ql.FloatArray)){var _;g.name===i.context.output.name?(_=new Ch(i.engine,{data:isFinite(Number(g.data))?[g.data]:g.data,usage:Rt.FB.Storage|Rt.FB.CopyDst|Rt.FB.CopySrc}),i.outputBuffer=_,i.context.output={name:g.name,length:isFinite(Number(g.data))?1:g.data.length,typedArrayConstructor:Float32Array,gpuBuffer:_.get()}):g.isReferer?g.data.model&&g.data.model.outputBuffer&&(_=g.data.model.outputBuffer):_=new Ch(i.engine,{data:isFinite(Number(g.data))?[g.data]:g.data,usage:Rt.FB.Storage|Rt.FB.CopyDst|Rt.FB.CopySrc}),i.vertexBuffers[g.name]=_,i.bindGroupEntries.push({binding:f,resource:{name:g.name,refer:_?void 0:g.data,buffer:_?_.get():void 0}}),f++}}),this.computePipeline=this.engine.device.createComputePipeline({computeStage:o}),console.log(this.bindGroupEntries),this.bindGroup=this.engine.device.createBindGroup({layout:this.computePipeline.getBindGroupLayout(0),entries:this.bindGroupEntries});case 13:case"end":return m.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"destroy",value:function(){var n=this;this.uniformBuffer&&this.uniformBuffer.destroy(),Object.keys(this.vertexBuffers).forEach(function(r){return n.vertexBuffers[r].destroy()})}},{key:"readData",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(){var i,a,o,s,c,f,d,h,v,m;return Kt().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(i=this.context.output,!i){_.next=16;break}if(a=i.length,o=i.typedArrayConstructor,s=i.gpuBuffer,!s){_.next=16;break}return c=a*o.BYTES_PER_ELEMENT,f=this.engine.device.createBuffer({size:c,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),d=this.engine.device.createCommandEncoder(),d.copyBufferToBuffer(s,0,f,0,c),h=ko?this.engine.device.getQueue():this.engine.device.defaultQueue,h.submit([d.finish()]),_.next=12,f.mapAsync(Rt.gc.Read);case 12:return v=f.getMappedRange(),m=new o(v.slice(0)),f.unmap(),_.abrupt("return",m);case 16:return _.abrupt("return",new Float32Array);case 17:case"end":return _.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"run",value:function(){if(this.engine.currentComputePass){var n;this.engine.currentComputePass.setPipeline(this.computePipeline),this.engine.currentComputePass.setBindGroup(0,this.bindGroup),(n=this.engine.currentComputePass).dispatch.apply(n,(0,ta.Z)(this.context.dispatch))}}},{key:"updateBuffer",value:function(n,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=this.vertexBuffers[n];a&&a.subData({data:r,offset:i})}},{key:"updateUniform",value:function(n,r){var i=this.uniformGPUBufferLayout.find(function(a){return a.name===n});i&&this.uniformBuffer.subData({data:Number.isFinite(r)?new Float32Array([r]):new Float32Array(r),offset:i.offset})}},{key:"confirmInput",value:function(n,r){var i=this.vertexBuffers[r],a=n.outputBuffer;if(i&&a&&i!==a){var o=this.engine.device.createCommandEncoder(),s=n.context.output,c=s.length,f=s.typedArrayConstructor,d=c*f.BYTES_PER_ELEMENT;o.copyBufferToBuffer(a.get(),0,i.get(),0,d);var h=ko?this.engine.device.getQueue():this.engine.device.defaultQueue;h.submit([o.finish()])}}},{key:"compileShaderToSpirV",value:function(n,r,i){return this.compileRawShaderToSpirV(i+n,r)}},{key:"compileRawShaderToSpirV",value:function(n,r){return this.engine.glslang.compileGLSL(n,r)}},{key:"compileComputePipelineStageDescriptor",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(i){var a,o;return Kt().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(a=i,o=`#version 450
`,this.engine.options.useWGSL){c.next=6;break}return c.next=5,this.compileShaderToSpirV(i,"compute",o);case 5:a=c.sent;case 6:return c.abrupt("return",{computeStage:{module:this.engine.device.createShaderModule({code:a,isWHLSL:ko}),entryPoint:"main"}});case 7:case"end":return c.stop()}},r,this)}));function n(r){return t.apply(this,arguments)}return n}()}]),e}(),WI=function(){function e(t,n){(0,nn.Z)(this,e),this.engine=t,this.options=n,this.indexCount=void 0,this.buffer=void 0;var r=n,i=r.data,a=r.usage,o=r.type,s=r.count;this.indexCount=s||0,this.buffer=new Ch(t,{data:i instanceof Array?new Uint16Array(i):i,usage:Rt.FB.Index|Rt.FB.CopyDst})}return(0,En.Z)(e,[{key:"get",value:function(){return this.buffer}},{key:"subData",value:function(n){this.buffer.subData(n)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),VI=function(){function e(t,n){(0,nn.Z)(this,e),this.engine=t,this.options=n,this.colorTexture=void 0,this.depthTexture=void 0,this.width=0,this.height=0;var r=n,i=r.width,a=r.height,o=r.color,s=r.colors,c=r.depth,f=r.stencil;o&&(this.colorTexture=o),c&&(this.depthTexture=c)}return(0,En.Z)(e,[{key:"get",value:function(){var n,r;return{color:(n=this.colorTexture)===null||n===void 0?void 0:n.get(),depth:(r=this.depthTexture)===null||r===void 0?void 0:r.get()}}},{key:"destroy",value:function(){var n,r;(n=this.colorTexture)===null||n===void 0||n.destroy(),(r=this.depthTexture)===null||r===void 0||r.destroy()}},{key:"resize",value:function(n){var r=n.width,i=n.height;if(r!==this.width||i!==this.height){var a,o;(a=this.colorTexture)===null||a===void 0||a.resize({width:r,height:i}),(o=this.depthTexture)===null||o===void 0||o.resize({width:r,height:i})}this.width=r,this.height=i}}]),e}(),nf,vc,td,fo,Rh,J0,Vv,ZI=(nf={},(0,ze.Z)(nf,ve.POINTS,Rt.YV.PointList),(0,ze.Z)(nf,ve.LINES,Rt.YV.LineList),(0,ze.Z)(nf,ve.LINE_LOOP,Rt.YV.LineList),(0,ze.Z)(nf,ve.LINE_STRIP,Rt.YV.LineStrip),(0,ze.Z)(nf,ve.TRIANGLES,Rt.YV.TriangleList),(0,ze.Z)(nf,ve.TRIANGLE_FAN,Rt.YV.TriangleList),(0,ze.Z)(nf,ve.TRIANGLE_STRIP,Rt.YV.TriangleStrip),nf),jI=(vc={},(0,ze.Z)(vc,ve.NEVER,Rt.wb.Never),(0,ze.Z)(vc,ve.ALWAYS,Rt.wb.Always),(0,ze.Z)(vc,ve.LESS,Rt.wb.Less),(0,ze.Z)(vc,ve.LEQUAL,Rt.wb.LessEqual),(0,ze.Z)(vc,ve.GREATER,Rt.wb.Greater),(0,ze.Z)(vc,ve.GEQUAL,Rt.wb.GreaterEqual),(0,ze.Z)(vc,ve.EQUAL,Rt.wb.Equal),(0,ze.Z)(vc,ve.NOTEQUAL,Rt.wb.NotEqual),vc),Xb=(td={},(0,ze.Z)(td,ve.FUNC_ADD,Rt.db.Add),(0,ze.Z)(td,ve.MIN_EXT,Rt.db.Min),(0,ze.Z)(td,ve.MAX_EXT,Rt.db.Max),(0,ze.Z)(td,ve.FUNC_SUBTRACT,Rt.db.Subtract),(0,ze.Z)(td,ve.FUNC_REVERSE_SUBTRACT,Rt.db.ReverseSubtract),td),Q0=(fo={},(0,ze.Z)(fo,ve.ZERO,Rt.zi.Zero),(0,ze.Z)(fo,ve.ONE,Rt.zi.One),(0,ze.Z)(fo,ve.SRC_COLOR,Rt.zi.SrcColor),(0,ze.Z)(fo,ve.ONE_MINUS_SRC_COLOR,Rt.zi.OneMinusSrcColor),(0,ze.Z)(fo,ve.SRC_ALPHA,Rt.zi.SrcAlpha),(0,ze.Z)(fo,ve.ONE_MINUS_SRC_ALPHA,Rt.zi.OneMinusSrcAlpha),(0,ze.Z)(fo,ve.DST_COLOR,Rt.zi.DstColor),(0,ze.Z)(fo,ve.ONE_MINUS_DST_COLOR,Rt.zi.OneMinusDstColor),(0,ze.Z)(fo,ve.DST_ALPHA,Rt.zi.DstAlpha),(0,ze.Z)(fo,ve.ONE_MINUS_DST_ALPHA,Rt.zi.OneMinusDstAlpha),(0,ze.Z)(fo,ve.CONSTANT_COLOR,Rt.zi.BlendColor),(0,ze.Z)(fo,ve.ONE_MINUS_CONSTANT_COLOR,Rt.zi.OneMinusBlendColor),(0,ze.Z)(fo,ve.SRC_ALPHA_SATURATE,Rt.zi.SrcAlphaSaturated),fo),HI=(Rh={},(0,ze.Z)(Rh,ve.ALPHA,"r8unorm"),(0,ze.Z)(Rh,ve.RGBA,"rgba8unorm"),(0,ze.Z)(Rh,ve.DEPTH_COMPONENT,"depth32float"),(0,ze.Z)(Rh,ve.DEPTH_STENCIL,"depth24plus-stencil8"),Rh),$b=(J0={},(0,ze.Z)(J0,ve.NEAREST,"nearest"),(0,ze.Z)(J0,ve.LINEAR,"linear"),J0),Dy=(Vv={},(0,ze.Z)(Vv,ve.REPEAT,"repeat"),(0,ze.Z)(Vv,ve.CLAMP_TO_EDGE,"clamp-to-edge"),(0,ze.Z)(Vv,ve.MIRRORED_REPEAT,"mirror-repeat"),Vv);function XI(e){var t=e.cull;if(!t||!t.enable)return Rt.Wf.None;if(t.face)return t.face===ve.FRONT?Rt.Wf.Front:Rt.Wf.Back}function $I(e){var t=e.depth,n=e.stencil,r={compare:Rt.wb.Always,depthFailOp:Rt.xS.Keep,failOp:Rt.xS.Keep,passOp:Rt.xS.Keep};return{depthWriteEnabled:t&&t.enable,depthCompare:jI[(t==null?void 0:t.func)||ve.ALWAYS],format:Rt.EV.Depth24PlusStencil8,stencilFront:r,stencilBack:r,stencilReadMask:4294967295,stencilWriteMask:4294967295}}function YI(e,t){var n=e.blend;return[{format:t,alphaBlend:{srcFactor:Q0[n&&n.func&&n.func.srcAlpha||ve.ONE],dstFactor:Q0[n&&n.func&&n.func.dstAlpha||ve.ZERO],operation:Xb[n&&n.equation&&n.equation.alpha||ve.FUNC_ADD]},colorBlend:{srcFactor:Q0[n&&n.func&&n.func.srcRGB||ve.ONE],dstFactor:Q0[n&&n.func&&n.func.dstRGB||ve.ZERO],operation:Xb[n&&n.equation&&n.equation.rgb||ve.FUNC_ADD]},writeMask:Rt.Yw.All}]}function Yb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Mh(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Yb(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function KI(e){for(var t=0,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var a=0,o=r;a<o.length;a++){var s=o[a];t+=s.length}for(var c=new e(t),f=0,d=0,h=r;d<h.length;d++){var v=h[d];c.set(v,f),f+=v.length}return c}var qI=function(){function e(t,n){(0,nn.Z)(this,e),this.engine=t,this.options=n,this.pipelineLayout=void 0,this.renderPipeline=void 0,this.uniformsBindGroupLayout=void 0,this.uniformBindGroup=void 0,this.uniformBuffer=void 0,this.uniforms={},this.uniformGPUBufferLayout=[],this.attributeCache={},this.indexBuffer=void 0,this.indexCount=void 0}return(0,En.Z)(e,[{key:"init",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(){var i=this,a,o,s,c,f,d,h,v,m,g,_,y,E,b,A,C,R,W;return Kt().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return a=this.options,o=a.vs,s=a.fs,c=a.attributes,f=a.uniforms,d=a.primitive,h=a.count,v=a.elements,m=a.depth,g=a.blend,_=a.stencil,y=a.cull,E=a.instances,Q.next=3,this.compilePipelineStageDescriptor(o,s,null);case 3:b=Q.sent,A=b.vertexStage,C=b.fragmentStage,f&&this.buildUniformBindGroup(f),v&&(this.indexBuffer=v.get(),this.indexCount=v.indexCount),R={vertexBuffers:Object.keys(c).map(function(re,de){var Ce=c[re],ie=Ce.get(),Ge=ie.arrayStride,We=ie.stepMode,It=ie.attributes;return i.attributeCache[re]=Ce,{arrayStride:Ge,stepMode:We,attributes:It}})},W={sampleCount:this.engine.mainPassSampleCount,primitiveTopology:ZI[d||ve.TRIANGLES],rasterizationState:Mh(Mh({},this.getDefaultRasterizationStateDescriptor()),{},{cullMode:XI({cull:y})}),depthStencilState:$I({depth:m,stencil:_}),colorStates:YI({blend:g},this.engine.options.swapChainFormat),layout:this.pipelineLayout,vertexStage:A,fragmentStage:C,vertexState:R},this.renderPipeline=this.engine.device.createRenderPipeline(W);case 11:case"end":return Q.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"addUniforms",value:function(n){this.uniforms=Mh(Mh({},this.uniforms),Wv(n))}},{key:"draw",value:function(n){var r=this,i=this.engine.getCurrentRenderPass(),a=Mh(Mh({},this.uniforms),Wv(n.uniforms||{})),o=[];Object.keys(a).forEach(function(s){var c=(0,_h.Z)(a[s]);if(c==="boolean"||c==="number"||Array.isArray(a[s])||a[s].BYTES_PER_ELEMENT){var f,d=(f=r.uniformGPUBufferLayout.find(function(E){var b=E.name;return b===s}))===null||f===void 0?void 0:f.offset;d!==null&&r.uniformBuffer.subData({data:a[s],offset:d})}else{var h,v=(h=r.uniformGPUBufferLayout.find(function(E){var b=E.name;return b===s}))===null||h===void 0?void 0:h.offset;if(v!==null){var m=a[s].get(),g=m.color||m,_=g.texture,y=g.sampler;y&&(o.push({binding:v,resource:y}),v++),o.push({binding:v,resource:_.createView()})}}}),this.uniformBuffer&&(o[0]={binding:0,resource:{buffer:this.uniformBuffer.get()}}),this.uniformBindGroup=this.engine.device.createBindGroup({layout:this.uniformsBindGroupLayout,entries:o}),this.renderPipeline&&i.setPipeline(this.renderPipeline),i.setBindGroup(0,this.uniformBindGroup),this.indexBuffer&&i.setIndexBuffer(this.indexBuffer.get(),Rt.iD.Uint32,0),Object.keys(this.attributeCache).forEach(function(s,c){i.setVertexBuffer(0+c,r.attributeCache[s].get().buffer,0)}),this.indexBuffer?i.drawIndexed(this.indexCount,this.options.instances||1,0,0,0):i.draw(this.options.count||0,this.options.instances||0,0,0)}},{key:"destroy",value:function(){throw new Error("Method not implemented.")}},{key:"compilePipelineStageDescriptor",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(i,a,o){var s,c,f;return Kt().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(s=`#version 450
`,c=i,f=a,this.engine.options.useWGSL){h.next=10;break}return h.next=6,this.compileShaderToSpirV(i,"vertex",s);case 6:return c=h.sent,h.next=9,this.compileShaderToSpirV(a,"fragment",s);case 9:f=h.sent;case 10:return h.abrupt("return",this.createPipelineStageDescriptor(c,f));case 11:case"end":return h.stop()}},r,this)}));function n(r,i,a){return t.apply(this,arguments)}return n}()},{key:"compileShaderToSpirV",value:function(n,r,i){return this.compileRawShaderToSpirV(i+n,r)}},{key:"compileRawShaderToSpirV",value:function(n,r){return this.engine.glslang.compileGLSL(n,r)}},{key:"createPipelineStageDescriptor",value:function(n,r){return{vertexStage:{module:this.engine.device.createShaderModule({code:n,isWHLSL:ko}),entryPoint:"main"},fragmentStage:{module:this.engine.device.createShaderModule({code:r,isWHLSL:ko}),entryPoint:"main"}}}},{key:"getDefaultRasterizationStateDescriptor",value:function(){return{frontFace:Rt.zX.CCW,cullMode:Rt.Wf.None,depthBias:0,depthBiasSlopeScale:0,depthBiasClamp:0}}},{key:"buildUniformBindGroup",value:function(n){var r=this,i=0,a=KI.apply(void 0,[Float32Array].concat((0,ta.Z)(Object.keys(n).map(function(c){return n[c]?(r.uniformGPUBufferLayout.push({name:c,offset:i}),i+=(n[c].length||1)*4,n[c]):[]})))),o=[],s=!1;a.length&&(s=!0,o.push({binding:0,visibility:Rt.$X.Fragment|Rt.$X.Vertex,type:Rt.$l.UniformBuffer})),Object.keys(n).filter(function(c){return n[c]===null}).forEach(function(c,f){r.uniformGPUBufferLayout.push({name:c,offset:f*2+(s?1:0)}),o.push({binding:f*2+(s?1:0),visibility:Rt.$X.Fragment,type:Rt.$l.Sampler},{binding:f*2+(s?1:0)+1,visibility:Rt.$X.Fragment,type:Rt.$l.SampledTexture})}),this.uniformsBindGroupLayout=this.engine.device.createBindGroupLayout({entries:o}),this.pipelineLayout=this.engine.device.createPipelineLayout({bindGroupLayouts:[this.uniformsBindGroupLayout]}),s&&(this.uniformBuffer=new Ch(this.engine,{data:a instanceof Array?new Float32Array(a):a,usage:Rt.FB.Uniform|Rt.FB.CopyDst}))}}]),e}(),JI=function(){function e(t,n){(0,nn.Z)(this,e),this.engine=t,this.options=n,this.texture=void 0,this.sampler=void 0,this.width=void 0,this.height=void 0,this.createTexture()}return(0,En.Z)(e,[{key:"get",value:function(){return{texture:this.texture,sampler:this.sampler}}},{key:"update",value:function(){}},{key:"resize",value:function(n){var r=n.width,i=n.height;(r!==this.width||i!==this.height)&&(this.destroy(),this.createTexture()),this.width=r,this.height=i}},{key:"destroy",value:function(){this.texture&&this.texture.destroy()}},{key:"createTexture",value:function(){var n=this.options,r=n.data,i=n.type,a=i===void 0?ve.UNSIGNED_BYTE:i,o=n.width,s=n.height,c=n.flipY,f=c===void 0?!1:c,d=n.format,h=d===void 0?ve.RGBA:d,v=n.mipmap,m=v===void 0?!1:v,g=n.wrapS,_=g===void 0?ve.CLAMP_TO_EDGE:g,y=n.wrapT,E=y===void 0?ve.CLAMP_TO_EDGE:y,b=n.aniso,A=b===void 0?0:b,C=n.alignment,R=C===void 0?1:C,W=n.premultiplyAlpha,te=W===void 0?!1:W,Q=n.mag,re=Q===void 0?ve.NEAREST:Q,de=n.min,Ce=de===void 0?ve.NEAREST:de,ie=n.colorSpace,Ge=ie===void 0?ve.BROWSER_DEFAULT_WEBGL:ie,We=n.usage;this.width=o,this.height=s,this.texture=this.engine.device.createTexture({size:[o,s,1],mipLevelCount:1,sampleCount:1,dimension:Rt.kd.E2d,format:HI[h],usage:We||Rt.v2.Sampled|Rt.v2.CopyDst}),(!We||We&Rt.v2.Sampled)&&(this.sampler=this.engine.device.createSampler({addressModeU:Dy[_],addressModeV:Dy[E],addressModeW:Dy[_],magFilter:$b[re],minFilter:$b[Ce],maxAnisotropy:A}))}}]),e}(),Kb,qb,Jb,QI=(Kb=(0,_t.b2)(),Kb(qb=(Jb=function(){function e(){var t=this;(0,nn.Z)(this,e),this.supportWebGPU=!0,this.useWGSL=!1,this.options=void 0,this.canvas=void 0,this.context=void 0,this.glslang=void 0,this.adapter=void 0,this.device=void 0,this.swapChain=void 0,this.mainPassSampleCount=void 0,this.mainTexture=void 0,this.depthTexture=void 0,this.mainColorAttachments=void 0,this.mainTextureExtends=void 0,this.mainDepthAttachment=void 0,this.uploadEncoder=void 0,this.renderEncoder=void 0,this.computeEncoder=void 0,this.renderTargetEncoder=void 0,this.commandBuffers=new Array(4).fill(void 0),this.currentRenderPass=null,this.mainRenderPass=null,this.currentRenderTargetViewDescriptor=void 0,this.currentComputePass=null,this.bundleEncoder=void 0,this.tempBuffers=[],this.currentRenderTarget=null,this.uploadEncoderDescriptor={label:"upload"},this.renderEncoderDescriptor={label:"render"},this.renderTargetEncoderDescriptor={label:"renderTarget"},this.computeEncoderDescriptor={label:"compute"},this.pipelines={},this.computePipelines={},this.defaultSampleCount=4,this.clearDepthValue=1,this.clearStencilValue=0,this.transientViewport={x:Infinity,y:0,width:0,height:0},this.cachedViewport={x:0,y:0,width:0,height:0},this.clear=function(n){var r=n.framebuffer,i=n.color,a=n.depth,o=n.stencil;t.options.supportCompute&&t.startComputePass(),t.currentRenderTarget?(t.currentRenderPass&&t.endRenderTargetRenderPass(),t.startRenderTargetRenderPass(t.currentRenderTarget,i||null,!!a,!!o)):(t.mainColorAttachments[0].loadValue=i||Rt.Ws.Load,t.mainDepthAttachment.depthLoadValue=a||Rt.Ws.Load,t.mainDepthAttachment.stencilLoadValue=o?t.clearStencilValue:Rt.Ws.Load,t.mainRenderPass&&t.endMainRenderPass(),t.startMainRenderPass())},this.createModel=function(){var n=(0,Sr.Z)(Kt().mark(function r(i){var a;return Kt().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a=new qI(t,i),s.next=3,a.init();case 3:return s.abrupt("return",a);case 4:case"end":return s.stop()}},r)}));return function(r){return n.apply(this,arguments)}}(),this.createAttribute=function(n){return new UI(t,n)},this.createBuffer=function(n){return new Ch(t,n)},this.createElements=function(n){return new WI(t,n)},this.createTexture2D=function(n){return new JI(t,n)},this.createFramebuffer=function(n){return new VI(t,n)},this.useFramebuffer=function(n,r){t.currentRenderTarget&&t.unbindFramebuffer(t.currentRenderTarget),t.currentRenderTarget=n,t.currentRenderTargetViewDescriptor={dimension:Rt.p_.E2d,arrayLayerCount:1,aspect:Rt.H7.All},t.currentRenderPass=null,r()},this.createComputeModel=function(){var n=(0,Sr.Z)(Kt().mark(function r(i){var a;return Kt().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a=new zI(t,i),s.next=3,a.init();case 3:return s.abrupt("return",a);case 4:case"end":return s.stop()}},r)}));return function(r){return n.apply(this,arguments)}}(),this.getCanvas=function(){return t.canvas},this.getGLContext=function(){throw new Error("Method not implemented.")},this.viewport=function(n){var r=n.x,i=n.y,a=n.width,o=n.height;if(!t.currentRenderPass)t.transientViewport={x:r,y:i,width:a,height:o};else if(t.transientViewport.x!==Infinity){var s=t.getCurrentRenderPass();s.setViewport(t.transientViewport.x,t.transientViewport.y,t.transientViewport.width,t.transientViewport.height,0,1)}else if(r!==t.cachedViewport.x||i!==t.cachedViewport.y||a!==t.cachedViewport.width||o!==t.cachedViewport.height){t.cachedViewport={x:r,y:i,width:a,height:o};var c=t.getCurrentRenderPass();c.setViewport(r,i,a,o,0,1)}},this.readPixels=function(n){throw new Error("Method not implemented.")}}return(0,En.Z)(e,[{key:"isFloatSupported",value:function(){return!0}},{key:"init",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(i){return Kt().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.canvas=i.canvas,this.options=i,this.useWGSL=!!i.useWGSL,this.mainPassSampleCount=i.antialiasing?this.defaultSampleCount:1,o.next=6,this.initGlslang();case 6:this.initContextAndSwapChain(),this.initMainAttachments();case 8:case"end":return o.stop()}},r,this)}));function n(r){return t.apply(this,arguments)}return n}()},{key:"setScissor",value:function(n){throw new Error("Method not implemented.")}},{key:"destroy",value:function(){this.mainTexture&&this.mainTexture.destroy(),this.depthTexture&&this.depthTexture.destroy(),this.tempBuffers.forEach(function(n){return n.destroy()}),this.tempBuffers=[]}},{key:"beginFrame",value:function(){this.uploadEncoder=this.device.createCommandEncoder(this.uploadEncoderDescriptor),this.renderEncoder=this.device.createCommandEncoder(this.renderEncoderDescriptor),this.renderTargetEncoder=this.device.createCommandEncoder(this.renderTargetEncoderDescriptor),this.options.supportCompute&&(this.computeEncoder=this.device.createCommandEncoder(this.computeEncoderDescriptor))}},{key:"endFrame",value:function(){this.options.supportCompute&&this.endComputePass(),this.endMainRenderPass(),this.commandBuffers[0]=this.uploadEncoder.finish(),this.commandBuffers[1]=this.renderEncoder.finish(),this.options.supportCompute&&(this.commandBuffers[2]=this.computeEncoder.finish()),this.commandBuffers[3]=this.renderTargetEncoder.finish(),ko?this.device.getQueue().submit(this.commandBuffers.filter(function(n){return n})):this.device.defaultQueue.submit(this.commandBuffers.filter(function(n){return n}))}},{key:"getCurrentRenderPass",value:function(){return this.currentRenderTarget&&!this.currentRenderPass?this.startRenderTargetRenderPass(this.currentRenderTarget,null,!1,!1):this.currentRenderPass||this.startMainRenderPass(),this.currentRenderPass}},{key:"initGlslang",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(){var i,a;return Kt().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,FI();case 2:return this.glslang=s.sent,s.next=5,(i=navigator)===null||i===void 0||(a=i.gpu)===null||a===void 0?void 0:a.requestAdapter();case 5:return this.adapter=s.sent,s.next=8,this.adapter.requestDevice();case 8:this.device=s.sent;case 9:case"end":return s.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"initContextAndSwapChain",value:function(){this.context=this.canvas.getContext(ko?"gpu":"gpupresent"),this.swapChain=this.context.configureSwapChain({device:this.device,format:this.options.swapChainFormat,usage:Rt.v2.OutputAttachment|Rt.v2.CopySrc})}},{key:"initMainAttachments",value:function(){if(this.mainTextureExtends={width:this.canvas.width,height:this.canvas.height,depth:1},this.options.antialiasing){var n={size:this.mainTextureExtends,mipLevelCount:1,sampleCount:this.mainPassSampleCount,dimension:Rt.kd.E2d,format:Rt.EV.BGRA8Unorm,usage:Rt.v2.OutputAttachment};this.mainTexture&&this.mainTexture.destroy(),this.mainTexture=this.device.createTexture(n),this.mainColorAttachments=[{attachment:ko?this.mainTexture.createDefaultView():this.mainTexture.createView(),loadValue:[0,0,0,1],storeOp:Rt.EG.Store}]}else this.mainColorAttachments=[{attachment:ko?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView(),loadValue:[0,0,0,1],storeOp:Rt.EG.Store}];var r={size:this.mainTextureExtends,mipLevelCount:1,sampleCount:this.mainPassSampleCount,dimension:Rt.kd.E2d,format:ko?"depth32float-stencil8":Rt.EV.Depth24PlusStencil8,usage:Rt.v2.OutputAttachment};this.depthTexture&&this.depthTexture.destroy(),this.depthTexture=this.device.createTexture(r),this.mainDepthAttachment={attachment:ko?this.depthTexture.createDefaultView():this.depthTexture.createView(),depthLoadValue:this.clearDepthValue,depthStoreOp:Rt.EG.Store,stencilLoadValue:this.clearStencilValue,stencilStoreOp:Rt.EG.Store}}},{key:"startComputePass",value:function(){this.currentComputePass&&this.endComputePass(),this.currentComputePass=this.computeEncoder.beginComputePass()}},{key:"startMainRenderPass",value:function(){this.currentRenderPass&&!this.currentRenderTarget&&this.endMainRenderPass(),this.options.antialiasing?this.mainColorAttachments[0].resolveTarget=ko?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView():this.mainColorAttachments[0].attachment=ko?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView(),this.currentRenderPass=this.renderEncoder.beginRenderPass({colorAttachments:this.mainColorAttachments,depthStencilAttachment:this.mainDepthAttachment}),this.mainRenderPass=this.currentRenderPass,this.cachedViewport&&this.viewport(this.cachedViewport)}},{key:"startRenderTargetRenderPass",value:function(n,r,i){var a,o,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,c=(a=n.get().color)===null||a===void 0?void 0:a.texture,f;c&&(f=c.createView(this.currentRenderTargetViewDescriptor));var d=(o=n.get().depth)===null||o===void 0?void 0:o.texture,h;d&&(h=d.createView());var v=this.renderTargetEncoder.beginRenderPass({colorAttachments:[{attachment:f,loadValue:r!==null?r:Rt.Ws.Load,storeOp:Rt.EG.Store}],depthStencilAttachment:d&&h?{attachment:h,depthLoadValue:i?this.clearDepthValue:Rt.Ws.Load,depthStoreOp:Rt.EG.Store,stencilLoadValue:s?this.clearStencilValue:Rt.Ws.Load,stencilStoreOp:Rt.EG.Store}:void 0});this.currentRenderPass=v,this.cachedViewport&&this.viewport(this.cachedViewport)}},{key:"endMainRenderPass",value:function(){this.currentRenderPass===this.mainRenderPass&&this.currentRenderPass!==null&&(this.currentRenderPass.endPass(),this.resetCachedViewport(),this.currentRenderPass=null,this.mainRenderPass=null)}},{key:"endComputePass",value:function(){this.currentComputePass&&(this.currentComputePass.endPass(),this.currentComputePass=null)}},{key:"endRenderTargetRenderPass",value:function(){this.currentRenderPass&&(this.currentRenderPass.endPass(),this.resetCachedViewport())}},{key:"resetCachedViewport",value:function(){this.cachedViewport={x:0,y:0,width:0,height:0}}},{key:"unbindFramebuffer",value:function(n){this.currentRenderPass&&this.currentRenderPass!==this.mainRenderPass&&this.endRenderTargetRenderPass(),this.transientViewport.x=Infinity,this.currentRenderTarget=null,this.currentRenderPass=this.mainRenderPass}}]),e}(),Jb))||qb),Qb,ew;function eC(e){var t=tC();return function(){var r=(0,Pr.Z)(e),i;if(t){var a=(0,Pr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ja.Z)(this,i)}}function tC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var Py=4/64,tw=1-Py*2,nC=(Qb=(0,_t.b2)(),Qb(ew=function(e){(0,Za.Z)(n,e);var t=eC(n);function n(){return(0,nn.Z)(this,n),t.apply(this,arguments)}return(0,En.Z)(n,[{key:"onEntityCreated",value:function(){var i=this.config,a=i.widthSegments,o=a===void 0?1:a,s=i.heightSegments,c=s===void 0?1:s,f=i.depthSegments,d=f===void 0?1:f,h=i.halfExtents,v=h===void 0?Re.al(.5,.5,.5):h,m=o,g=c,_=d,y=(0,k0.Z)(v,3),E=y[0],b=y[1],A=y[2],C=[Re.al(-E,-b,A),Re.al(E,-b,A),Re.al(E,b,A),Re.al(-E,b,A),Re.al(E,-b,-A),Re.al(-E,-b,-A),Re.al(-E,b,-A),Re.al(E,b,-A)],R=[[0,1,3],[4,5,7],[3,2,6],[1,0,4],[1,4,2],[5,0,6]],W=[[0,0,1],[0,0,-1],[0,1,0],[0,-1,0],[1,0,0],[-1,0,0]],te={FRONT:0,BACK:1,TOP:2,BOTTOM:3,RIGHT:4,LEFT:5},Q=[],re=[],de=[],Ce=[],ie=[],Ge=0,We=function(bn,vr,Oi){var Hr,Sn,In,Ot;for(In=0;In<=vr;In++)for(Ot=0;Ot<=Oi;Ot++){var Dn=Re.Ue(),gr=Re.Ue(),Xn=Re.Ue(),wn=Re.Ue();Re.t7(Dn,C[R[bn][0]],C[R[bn][1]],In/vr),Re.t7(gr,C[R[bn][0]],C[R[bn][2]],Ot/Oi),Re.lu(Xn,gr,C[R[bn][0]]),Re.IH(wn,Dn,Xn),Hr=In/vr,Sn=Ot/Oi,Q.push(wn[0],wn[1],wn[2]),re.push(W[bn][0],W[bn][1],W[bn][2]),de.push(Hr,Sn),Hr/=3,Sn/=3,Hr=Hr*tw+Py,Sn=Sn*tw+Py,Hr+=bn%3/3,Sn+=Math.floor(bn/3)/3,Ce.push(Hr,Sn),In<vr&&Ot<Oi&&(ie.push(Ge+Oi+1,Ge+1,Ge),ie.push(Ge+Oi+1,Ge+Oi+2,Ge+1)),Ge++}};We(te.FRONT,m,g),We(te.BACK,m,g),We(te.TOP,m,_),We(te.BOTTOM,m,_),We(te.RIGHT,_,g),We(te.LEFT,_,g);var It=xy(Q),gn=this.getComponent();gn.indices=Uint32Array.from(ie),gn.aabb=It,gn.vertexCount=Ge,gn.attributes=[{dirty:!0,name:"position",data:Float32Array.from(Q),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(re),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(de),arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),n}(il))||ew);function rC(e,t){if(!e&&!t)throw new Error("Please specify valid arguments for parameters a and b.");if(!t||t.length===0)return e;if(!e||e.length===0)return t;if(Object.prototype.toString.call(e)!==Object.prototype.toString.call(t))throw new Error("The types of the two arguments passed for parameters a and b do not match.");var n=new e.constructor(e.length+t.length);return n.set(e),n.set(t,e.length),n}var nw,rw;function iC(e){var t=aC();return function(){var r=(0,Pr.Z)(e),i;if(t){var a=(0,Pr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ja.Z)(this,i)}}function aC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var oC=(nw=(0,_t.b2)(),nw(rw=function(e){(0,Za.Z)(n,e);var t=iC(n);function n(){return(0,nn.Z)(this,n),t.apply(this,arguments)}return(0,En.Z)(n,[{key:"onEntityCreated",value:function(){var i=this.config.geometries,a=i===void 0?[]:i,o=this.getComponent();o.aabb=new py;var s=[],c=[],f=0;a.forEach(function(d){var h=d.aabb,v=d.indices,m=d.vertexCount,g=d.attributes;o.aabb.add(h),o.vertexCount+=m,v&&c.push.apply(c,(0,ta.Z)(v.map(function(_){return _+f}))),f+=m,g.forEach(function(_,y){s[y]?_.data&&(Sy(_.data)?s[y].push(_.data):ob(_.data)?s[y].data=rC(s[y].data,_.data):s[y].data=s[y].data.concat(_.data)):(s[y]=_,s[y].dirty=!0)})}),o.attributes=s,o.indices=Uint32Array.from(c),o.dirty=!0}}]),n}(il))||rw),iw,aw;function sC(e){var t=uC();return function(){var r=(0,Pr.Z)(e),i;if(t){var a=(0,Pr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ja.Z)(this,i)}}function uC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var cC=(iw=(0,_t.b2)(),iw(aw=function(e){(0,Za.Z)(n,e);var t=sC(n);function n(){return(0,nn.Z)(this,n),t.apply(this,arguments)}return(0,En.Z)(n,[{key:"onEntityCreated",value:function(){for(var i=this.config,a=i.halfExtents,o=a===void 0?[.5,.5]:a,s=i.widthSegments,c=s===void 0?5:s,f=i.lengthSegments,d=f===void 0?5:f,h=[],v=[],m=[],g=[],_=0,y=0;y<=c;y++)for(var E=0;E<=d;E++){var b=-o[0]+2*o[0]*y/c,A=0,C=-(-o[1]+2*o[1]*E/d),R=y/c,W=E/d;h.push(b,A,C),v.push(0,1,0),m.push(R,W),y<c&&E<d&&(g.push(_+d+1,_+1,_),g.push(_+d+1,_+d+2,_+1)),_++}var te=xy(h),Q=this.getComponent();Q.indices=Uint32Array.from(g),Q.aabb=te,Q.vertexCount=_,Q.attributes=[{dirty:!0,name:"position",data:Float32Array.from(h),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(v),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(m),arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),n}(il))||aw),ow,sw;function fC(e){var t=lC();return function(){var r=(0,Pr.Z)(e),i;if(t){var a=(0,Pr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ja.Z)(this,i)}}function lC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var dC=(ow=(0,_t.b2)(),ow(sw=function(e){(0,Za.Z)(n,e);var t=fC(n);function n(){return(0,nn.Z)(this,n),t.apply(this,arguments)}return(0,En.Z)(n,[{key:"onEntityCreated",value:function(){for(var i=this.config,a=i.radius,o=a===void 0?.5:a,s=i.latitudeBands,c=s===void 0?16:s,f=i.longitudeBands,d=f===void 0?16:f,h=[],v=[],m=[],g=[],_=0;_<=c;_++)for(var y=_*Math.PI/c,E=Math.sin(y),b=Math.cos(y),A=0;A<=d;A++){var C=A*2*Math.PI/d-Math.PI/2,R=Math.sin(C),W=Math.cos(C),te=W*E,Q=b,re=R*E,de=1-A/d,Ce=1-_/c;h.push(te*o,Q*o,re*o),v.push(te,Q,re),m.push(de,Ce)}for(var ie=0;ie<c;++ie)for(var Ge=0;Ge<d;++Ge){var We=ie*(d+1)+Ge,It=We+d+1;g.push(We+1,It,We),g.push(We+1,It+1,It)}var gn=xy(h),pn=this.getComponent();pn.indices=Uint32Array.from(g),pn.aabb=gn,pn.vertexCount=h.length/3,pn.attributes=[{dirty:!0,name:"position",data:Float32Array.from(h),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(v),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(m),arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),n}(il))||sw),uw,cw,fw,lw,em,dw,hw,vw;function hC(e){var t=vC();return function(){var r=(0,Pr.Z)(e),i;if(t){var a=(0,Pr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ja.Z)(this,i)}}function vC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var pC=`varying vec4 fragColor;

#pragma include "uv.frag.declaration"
#pragma include "map.frag.declaration"

void main() {
  vec4 diffuseColor = fragColor;

  #pragma include "map.frag.main"

  gl_FragColor = diffuseColor;
}`,mC=`attribute vec3 position;
attribute vec3 normal;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;
uniform vec4 color;

varying vec4 fragColor;

#pragma include "uv.vert.declaration"

void main() {
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  fragColor = color;

  #pragma include "uv.vert.main"
}`,gC=`// layout(set = 0, binding = 1) uniform WireframeUniforms {
//   float lineWidth;
//   vec4 lineColor;
// } wireframe;

layout(location = 0) in vec4 fragColor;
// layout(location = 1) in vec3 v_Barycentric;

layout(location = 0) out vec4 outColor;

// wireframe
// float edgeFactor() {
//   vec3 d = fwidth(v_Barycentric);
//   vec3 a3 = smoothstep(vec3(0.0), d * wireframe.lineWidth, v_Barycentric);
//   return min(min(a3.x, a3.y), a3.z);
// }

void main() {
  // outColor = mix(fragColor, wireframe.lineColor, (1.0 - edgeFactor()));
  outColor = fragColor;
}`,yC=`layout(set = 0, binding = 0) uniform Uniforms {
  vec4 color;
  mat4 projectionMatrix;
  mat4 modelViewMatrix;
} uniforms;

layout(location = 0) in vec3 position;
// layout(location = 1) in vec3 barycentric;

layout(location = 0) out vec4 fragColor;
// layout(location = 1) out vec3 v_Barycentric;

void main() {
  gl_Position = uniforms.projectionMatrix * uniforms.modelViewMatrix * vec4(position, 1.0);
  fragColor = uniforms.color;
  // v_Barycentric = barycentric;
}`,_C=(uw=(0,_t.b2)(),cw=(0,_t.f3)(Je.RenderEngine),fw=(0,_t.f3)(Je.ShaderModuleService),uw(lw=(em=(vw=function(e){(0,Za.Z)(n,e);var t=hC(n);function n(){var r;(0,nn.Z)(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return r=t.call.apply(t,[this].concat(a)),un(r,"engine",dw,(0,ji.Z)(r)),un(r,"shaderModuleService",hw,(0,ji.Z)(r)),r}return(0,En.Z)(n,[{key:"onEntityCreated",value:function(){var i=this.getComponent(),a=this.engine.supportWebGPU?yC:mC,o=this.engine.supportWebGPU?gC:pC;this.shaderModuleService.registerModule("material-basic",{vs:a,fs:o});var s=this.shaderModuleService.getModule("material-basic"),c=s.vs,f=s.fs,d=s.uniforms;i.vertexShaderGLSL=c,i.fragmentShaderGLSL=f,i.setUniform(d),this.config.map&&(i.setDefines({USE_UV:1,USE_MAP:1}),i.setUniform({map:this.config.map,uvTransform:Xl.Ue()}))}}]),n}(xb),vw),dw=cn(em.prototype,"engine",[cw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hw=cn(em.prototype,"shaderModuleService",[fw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),em))||lw),pw,mw,gw,yw,_w,Ew,bw,Zv,ww,xw,Sw,Tw;function EC(e){var t=bC();return function(){var r=(0,Pr.Z)(e),i;if(t){var a=(0,Pr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ja.Z)(this,i)}}function bC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var wC=`// generate grid, borrow from clay.gl viewer
// @see https://github.com/pissang/clay-viewer/blob/master/src/graphic/ground.glsl
#extension GL_OES_standard_derivatives : enable

varying vec3 v_Position;
// varying vec3 v_Normal;

uniform float u_GridSize : 5;
uniform float u_GridSize2 : .5;
uniform vec4 u_GridColor : [0, 0, 0, 1];
uniform vec4 u_GridColor2 : [0.3, 0.3, 0.3, 1];
uniform bool u_GridEnabled : true;

// uniform vec3 u_LightDirection;
// uniform vec3 u_LightColor;
// uniform vec3 u_Camera;

void main() {
  // vec3 n = v_Normal;
  // vec3 l = normalize(u_LightDirection);
  // float NdotL = clamp(dot(n, l), 0.001, 1.0);

  gl_FragColor = vec4(1.);

  if (u_GridEnabled) {
    float wx = v_Position.x;
    float wz = v_Position.z;
    // float x0 = abs(fract(wx / u_GridSize - 0.5) - 0.5) / fwidth(wx) * u_GridSize / 2.0;
    // float z0 = abs(fract(wz / u_GridSize - 0.5) - 0.5) / fwidth(wz) * u_GridSize / 2.0;

    float x1 = abs(fract(wx / u_GridSize2 - 0.5) - 0.5) / fwidth(wx) * u_GridSize2;
    float z1 = abs(fract(wz / u_GridSize2 - 0.5) - 0.5) / fwidth(wz) * u_GridSize2;

    // float v0 = 1.0 - clamp(min(x0, z0), 0.0, 1.0);
    float v1 = 1.0 - clamp(min(x1, z1), 0.0, 1.0);
    // if (v0 > 0.1) {
        // gl_FragColor = mix(gl_FragColor, u_GridColor, v0);
    // }
    // else {
        gl_FragColor = mix(gl_FragColor, u_GridColor2, v1);
    // }
  }

  // float shadowFactor = calcShadow(u_ShadowMap, v_PositionFromLight, l, n);
  // vec3 diffuseColor = u_LightColor * NdotL * shadowFactor;

  // gl_FragColor.rgb *= diffuseColor;
}`,xC=`attribute vec3 a_Position;

varying vec3 v_Position;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;

void main() {
  v_Position = a_Position;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(a_Position, 1.);
}`,SC=(pw=(0,_t.b2)(),mw=(0,_t.f3)(Je.Systems),gw=(0,_t.t6)(Je.MaterialSystem),yw=(0,_t.f3)(Je.Systems),_w=(0,_t.t6)(Je.GeometrySystem),Ew=(0,_t.f3)(Je.ShaderModuleService),pw(bw=(Zv=(Tw=function(e){(0,Za.Z)(n,e);var t=EC(n);function n(){var r;(0,nn.Z)(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return r=t.call.apply(t,[this].concat(a)),un(r,"materialSystem",ww,(0,ji.Z)(r)),un(r,"geometrySystem",xw,(0,ji.Z)(r)),un(r,"shaderModuleService",Sw,(0,ji.Z)(r)),r}return(0,En.Z)(n,[{key:"onAttributeChanged",value:function(i){var a=i.name,o=i.data,s=this.getMeshComponent();s&&s.material&&(a==="gridColor"?(s.material.setUniform("u_GridColor",o),s.material.setUniform("u_GridColor2",o)):a==="gridSize"&&(s.material.setUniform("u_GridSize",o),s.material.setUniform("u_GridSize2",o)))}},{key:"onEntityCreated",value:function(){this.shaderModuleService.registerModule("grid",{vs:xC,fs:wC});var i=this.shaderModuleService.getModule("grid"),a=i.vs,o=i.fs,s=i.uniforms,c=this.materialSystem.createShaderMaterial({vertexShader:a,fragmentShader:o});this.setMaterial(c);var f=this.geometrySystem.createBufferGeometry({vertexCount:4});this.setGeometry(f),c.setCull({enable:!1,face:ve.BACK}).setDepth({enable:!0,func:ve.LESS}),c.setUniform(s),this.setAttributes({gridColor:this.config.gridColor,gridSize:this.config.gridSize}),f.setIndex([0,3,2,2,1,0]),f.setAttribute("a_Position",Float32Array.from([-4,-1,-4,4,-1,-4,4,-1,4,-4,-1,4]),{arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]})}}]),n}(al),Tw),ww=cn(Zv.prototype,"materialSystem",[mw,gw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xw=cn(Zv.prototype,"geometrySystem",[yw,_w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sw=cn(Zv.prototype,"shaderModuleService",[Ew],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zv))||bw),tm=S(32644),nd=S(40582);function nm(e,t,n,r,i){jv(t,r,-i),jv(t,r,i),e.push(n),e.push(n)}function jv(e,t,n){e.push([[t[0],t[1]],n])}function TC(e,t,n){var r=[0,0],i=[0,0],a=[0,0],o=[0,0],s=-1,c=!1,f=null,d=(0,tm.create)(),h=n||0,v=3,m=[],g=[],_=[],y=[0,0];t&&(e=e.slice(),e.push(e[0]));for(var E=e.length,b=1;b<E;b++){var A=h,C=e[b-1],R=e[b],W=b<e.length-1?e[b+1]:null;if(y.push(b/E,b/E),(0,nd.o7)(r,R,C),f||(f=[0,0],(0,nd.mJ)(f,r)),c||(c=!0,nm(g,m,C,f,1)),_.push([A+0,A+1,A+2]),!W)(0,nd.mJ)(f,r),nm(g,m,R,f,1),_.push(s===1?[A,A+2,A+3]:[A+2,A+1,A+3]),h+=2;else{(0,nd.o7)(i,W,R);var te=(0,nd.x7)(a,o,r,i,1),Q=(0,tm.dot)(a,f)<0?-1:1,re=te>v;if(!isFinite(te)){(0,nd.mJ)(f,r),nm(g,m,R,f,1),_.push(s===1?[A,A+2,A+3]:[A+2,A+1,A+3]),h+=2,s=Q;continue}re?(te=v,y.push(b/E),jv(m,f,-Q),g.push(R),jv(m,o,te*Q),g.push(R),_.push(s!==-Q?[A,A+2,A+3]:[A+2,A+1,A+3]),_.push([A+2,A+3,A+4]),(0,nd.mJ)(d,i),(0,tm.copy)(f,d),jv(m,f,-Q),g.push(R),h+=3):(nm(g,m,R,o,te),_.push(s===1?[A,A+2,A+3]:[A+2,A+1,A+3]),Q=-1,(0,tm.copy)(f,o),h+=2),s=Q}}return{normals:m,attrIndex:_,attrPos:g,attrCounters:y}}var Aw,Iw,Cw,Rw,Mw,Nw,Dw,Hv,Pw,Ow,Lw,Gw;function AC(e){var t=IC();return function(){var r=(0,Pr.Z)(e),i;if(t){var a=(0,Pr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ja.Z)(this,i)}}function IC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var CC=`uniform float u_dash_array : 0.02;
uniform float u_dash_offset : 0;
uniform float u_dash_ratio : 0;
uniform float u_thickness : 0.02;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_counters;

void main() {
    float blur = 1. - smoothstep(0.98, 1., length(v_normal));

    gl_FragColor = v_color;
    gl_FragColor.a *= blur * ceil(mod(v_counters + u_dash_offset, u_dash_array) - (u_dash_array * u_dash_ratio));
}`,RC=`attribute vec2 a_pos;
attribute vec4 a_color;
attribute float a_line_miter;
attribute vec2 a_line_normal;
attribute float a_counters;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;
uniform float u_thickness : 0.02;
uniform vec2 u_viewport;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_counters;

void main() {
  v_color = a_color;
  v_counters = a_counters;

  vec3 normal = normalize(vec3(a_line_normal, 0.0));

  vec4 offset = vec4(normal * u_thickness / 2.0 * a_line_miter, 0.0);

  v_normal = vec2(normal * sign(a_line_miter));

  gl_Position = projectionMatrix * modelViewMatrix * vec4(a_pos, 0.0, 1.0) + offset;
}
`,MC=(Aw=(0,_t.b2)(),Iw=(0,_t.f3)(Je.Systems),Cw=(0,_t.t6)(Je.MaterialSystem),Rw=(0,_t.f3)(Je.Systems),Mw=(0,_t.t6)(Je.GeometrySystem),Nw=(0,_t.f3)(Je.ShaderModuleService),Aw(Dw=(Hv=(Gw=function(e){(0,Za.Z)(n,e);var t=AC(n);function n(){var r;(0,nn.Z)(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return r=t.call.apply(t,[this].concat(a)),un(r,"materialSystem",Pw,(0,ji.Z)(r)),un(r,"geometrySystem",Ow,(0,ji.Z)(r)),un(r,"shaderModuleService",Lw,(0,ji.Z)(r)),r.vertexCount=void 0,r}return(0,En.Z)(n,[{key:"onAttributeChanged",value:function(i){var a=i.name,o=i.data,s=this.getMeshComponent();if(s&&s.material)switch(a){case"dashArray":s.material.setUniform("u_dash_array",o);break;case"dashOffset":s.material.setUniform("u_dash_offset",o);break;case"dashRatio":s.material.setUniform("u_dash_ratio",o);break;case"thickness":s.material.setUniform("u_thickness",o);break;case"color":var c=new Array(this.vertexCount).fill(void 0).map(function(){return o}).reduce(function(f,d){return[].concat((0,ta.Z)(f),(0,ta.Z)(d))},[]);s.geometry.setAttribute("a_color",Float32Array.from(c),{arrayStride:4*4,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float4"}]});break}}},{key:"onEntityCreated",value:function(){var i=this;this.shaderModuleService.registerModule("line",{vs:RC,fs:CC});var a=this.shaderModuleService.getModule("line"),o=a.vs,s=a.fs,c=a.uniforms,f=this.materialSystem.createShaderMaterial({vertexShader:o,fragmentShader:s}),d=TC(this.config.points,!1),h=d.normals,v=d.attrIndex,m=d.attrPos,g=d.attrCounters,_=m.length;this.vertexCount=_;var y=this.geometrySystem.createBufferGeometry({vertexCount:_});this.setMaterial(f),this.setGeometry(y),f.setCull({enable:!1,face:ve.BACK}).setUniform(c),this.setAttributes({dashArray:this.config.dashArray,dashOffset:this.config.dashOffset,dashRatio:this.config.dashRatio,thickness:this.config.thickness});var E=[],b=[];h.forEach(function(C){var R=C[0],W=C[1];E.push([R[0],R[1]]),b.push(W)}),y.setIndex(v.reduce(function(C,R){return[].concat((0,ta.Z)(C),(0,ta.Z)(R))},[])),y.setAttribute("a_pos",Float32Array.from(m.reduce(function(C,R){return[].concat((0,ta.Z)(C),(0,ta.Z)(R))},[])),{arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]});var A=new Array(_).fill(void 0).map(function(){return(0,ta.Z)(i.config.color)}).reduce(function(C,R){return[].concat((0,ta.Z)(C),(0,ta.Z)(R))},[]);y.setAttribute("a_color",Float32Array.from(A),{arrayStride:4*4,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float4"}]}),y.setAttribute("a_line_miter",Float32Array.from(b),{arrayStride:4*1,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float"}]}),y.setAttribute("a_line_normal",Float32Array.from(E.reduce(function(C,R){return[].concat((0,ta.Z)(C),(0,ta.Z)(R))},[])),{arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:3,offset:0,format:"float2"}]}),y.setAttribute("a_counters",Float32Array.from(g),{arrayStride:4*1,stepMode:"vertex",attributes:[{shaderLocation:4,offset:0,format:"float"}]})}}]),n}(al),Gw),Pw=cn(Hv.prototype,"materialSystem",[Iw,Cw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ow=cn(Hv.prototype,"geometrySystem",[Rw,Mw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lw=cn(Hv.prototype,"shaderModuleService",[Nw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hv))||Dw);function NC(e){return[e+1&255,e+1>>8&255,e+1>>8>>8&255]}var kw,Fw,Uw,Bw,zw,Ww,Vw,Xv,Zw,jw,Hw,Xw;function $w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function DC(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$w(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$w(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function PC(e){var t=OC();return function(){var r=(0,Pr.Z)(e),i;if(t){var a=(0,Pr.Z)(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return(0,ja.Z)(this,i)}}function OC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var LC=`uniform float u_blur : 0.05;
uniform float u_opacity : 0.7;
uniform float u_stroke_width : 0.01;
uniform vec4 u_stroke_color : [0, 0, 0, 0];
uniform float u_stroke_opacity : 1;

varying vec4 v_color;
varying vec4 v_data;
varying float v_radius;

#pragma include "sdf2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));

  float antialiasblur = v_data.z;
  float antialiased_blur = -max(u_blur, antialiasblur);
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  // if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  // } else if (shape == 1) {
  //   outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
  //   inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  // } else if (shape == 2) {
  //   outer_df = sdBox(v_data.xy, vec2(1.));
  //   inner_df = sdBox(v_data.xy, vec2(r));
  // } else if (shape == 3) {
  //   outer_df = sdPentagon(v_data.xy, 0.8);
  //   inner_df = sdPentagon(v_data.xy, r * 0.8);
  // } else if (shape == 4) {
  //   outer_df = sdHexagon(v_data.xy, 0.8);
  //   inner_df = sdHexagon(v_data.xy, r * 0.8);
  // } else if (shape == 5) {
  //   outer_df = sdOctogon(v_data.xy, 1.0);
  //   inner_df = sdOctogon(v_data.xy, r);
  // } else if (shape == 6) {
  //   outer_df = sdHexagram(v_data.xy, 0.52);
  //   inner_df = sdHexagram(v_data.xy, r * 0.52);
  // } else if (shape == 7) {
  //   outer_df = sdRhombus(v_data.xy, vec2(1.0));
  //   inner_df = sdRhombus(v_data.xy, vec2(r));
  // } else if (shape == 8) {
  //   outer_df = sdVesica(v_data.xy, 1.1, 0.8);
  //   inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  // }

  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiased_blur,
    0.0,
    inner_df
  );
  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;

  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor.a = gl_FragColor.a * opacity_t;

  gl_FragColor = filterColor(gl_FragColor);
}`,GC=`attribute vec2 position;
attribute vec4 color;
attribute float shape;
attribute vec2 offset;
attribute float size;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;

uniform float u_stroke_width : 0.01;
uniform float u_device_pixel_ratio;
uniform vec2 u_viewport;

varying vec4 v_color;
varying vec4 v_data;
varying float v_radius;

#pragma include "picking"

void main() {
  v_color = color;
  v_radius = size;

  lowp float antialiasblur = 1.0 / u_device_pixel_ratio * (size + u_stroke_width);

  // construct point coords
  v_data = vec4(position, antialiasblur, shape);

  gl_Position = projectionMatrix * modelViewMatrix
    * vec4(position * size + offset, 0.0, 1.0);

  setPickingColor(a_PickingColor);
}`,kC=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],FC=(kw=(0,_t.b2)(),Fw=(0,_t.f3)(Je.Systems),Uw=(0,_t.t6)(Je.MaterialSystem),Bw=(0,_t.f3)(Je.Systems),zw=(0,_t.t6)(Je.GeometrySystem),Ww=(0,_t.f3)(Je.ShaderModuleService),kw(Vw=(Xv=(Xw=function(e){(0,Za.Z)(n,e);var t=PC(n);function n(){var r;(0,nn.Z)(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return r=t.call.apply(t,[this].concat(a)),un(r,"materialSystem",Zw,(0,ji.Z)(r)),un(r,"geometrySystem",jw,(0,ji.Z)(r)),un(r,"shaderModuleService",Hw,(0,ji.Z)(r)),r}return(0,En.Z)(n,[{key:"onAttributeChanged",value:function(i){var a=i.name,o=i.data,s=this.getMeshComponent();s&&s.material&&(a==="strokeWidth"?s.material.setUniform("u_stroke_width",o):a==="strokeColor"?s.material.setUniform("u_stroke_color",o):a==="strokeOpacity"?s.material.setUniform("u_stroke_opacity",o):a==="opacity"?s.material.setUniform("u_opacity",o):a==="blur"&&s.material.setUniform("u_blur",o))}},{key:"onEntityCreated",value:function(){this.shaderModuleService.registerModule("grid",{vs:GC,fs:LC});var i=this.shaderModuleService.getModule("grid"),a=i.vs,o=i.fs,s=i.uniforms,c=this.materialSystem.createShaderMaterial({vertexShader:a,fragmentShader:o,cull:{enable:!1},depth:{enable:!1},blend:{enable:!0,func:{srcRGB:ve.SRC_ALPHA,dstRGB:ve.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}});c.setUniform(DC({u_device_pixel_ratio:window.devicePixelRatio},s));var f=this.buildAttributes(),d=this.geometrySystem.createInstancedBufferGeometry({maxInstancedCount:f.instancedOffsets.length/2,vertexCount:6});d.setIndex([0,2,1,0,3,2]),d.setAttribute("position",Float32Array.from(f.positions),{arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]}),d.setAttribute("offset",Float32Array.from(f.instancedOffsets),{arrayStride:4*2,stepMode:"instance",attributes:[{shaderLocation:1,offset:0,format:"float2"}]}),d.setAttribute("color",Float32Array.from(f.instancedColors),{arrayStride:4*4,stepMode:"instance",attributes:[{shaderLocation:2,offset:0,format:"float4"}]}),d.setAttribute("size",Float32Array.from(f.instancedSizes),{arrayStride:4,stepMode:"instance",attributes:[{shaderLocation:3,offset:0,format:"float"}]}),d.setAttribute("shape",Float32Array.from(f.instancedShapes),{arrayStride:4,stepMode:"instance",attributes:[{shaderLocation:4,offset:0,format:"float"}]}),d.setAttribute("a_PickingColor",Float32Array.from(f.instancedPickingColors),{arrayStride:4*3,stepMode:"instance",attributes:[{shaderLocation:6,offset:0,format:"float3"}]}),this.setMaterial(c),this.setGeometry(d)}},{key:"buildAttribute",value:function(i,a,o){var s,c,f,d;(s=a.instancedPickingColors).push.apply(s,(0,ta.Z)(NC(i.id||o))),a.instancedShapes.push(kC.indexOf(i.shape||"circle")),(c=a.instancedColors).push.apply(c,(0,ta.Z)(i.color||[1,0,0,1])),(f=a.instancedOffsets).push.apply(f,(0,ta.Z)(i.position||[0,0])),(d=a.instancedSizes).push.apply(d,(0,ta.Z)(i.size||[.2,.2]))}},{key:"buildAttributes",value:function(){var i=this,a={positions:[1,1,1,-1,-1,-1,-1,1],instancedOffsets:[],instancedColors:[],instancedSizes:[],instancedShapes:[],instancedPickingColors:[]};return Array.isArray(this.config)?this.config.forEach(function(o,s){i.buildAttribute(o,a,s)}):this.buildAttribute(this.config,a,0),a}}]),n}(al),Xw),Zw=cn(Xv.prototype,"materialSystem",[Fw,Uw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jw=cn(Xv.prototype,"geometrySystem",[Bw,zw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hw=cn(Xv.prototype,"shaderModuleService",[Ww],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xv))||Vw),Yw,Kw,qw,Jw,Qw,$v,ex,tx,nx,rx;function ix(e,t){var n;if(typeof Symbol=="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(n=UC(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(f){throw f},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){n=e[Symbol.iterator]()},n:function(){var f=n.next();return a=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!a&&n.return!=null&&n.return()}finally{if(o)throw s}}}}function UC(e,t){if(!!e){if(typeof e=="string")return ax(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ax(e,t)}}function ax(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var BC=`#ifdef USE_MAP
  uniform sampler2D map;
#endif`,zC=`#ifdef USE_MAP
  vec4 texelColor = texture2D(map, vUv);
  // texelColor = mapTexelToLinear(texelColor);
  diffuseColor *= texelColor;
#endif`,WC=`#if (defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ))
  varying vec2 vUv;
#endif`,VC=`#ifdef USE_UV
  attribute vec2 uv;
	#ifdef UVS_VERTEX_ONLY
    vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,ZC=`#ifdef USE_UV
  vUv = (uvTransform * vec3(uv, 1)).xy;
#endif`,ox=(Yw=(0,_t.b2)(),Kw=(0,_t.f3)(Je.RenderEngine),qw=(0,_t.f3)(Je.ShaderModuleService),Jw=(0,_t.f3)(Je.ConfigService),Yw(Qw=($v=(rx=function(){function e(){(0,nn.Z)(this,e),this.container=void 0,un(this,"engine",ex,this),un(this,"shaderModule",tx,this),un(this,"configService",nx,this),this.inited=!1,this.rendering=!1,this.pendings=[],this.views=[],this.size=void 0}return(0,En.Z)(e,[{key:"init",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(){var i,a,o,s,c;return Kt().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(this.shaderModule.registerBuiltinModules(),this.shaderModule.registerModule("uv.vert.declaration",{vs:VC}),this.shaderModule.registerModule("uv.vert.main",{vs:ZC}),this.shaderModule.registerModule("uv.frag.declaration",{fs:WC}),this.shaderModule.registerModule("map.frag.declaration",{fs:BC}),this.shaderModule.registerModule("map.frag.main",{fs:zC}),i=this.container.getAll(Je.Systems),a=this.configService.get(),!a.canvas){d.next=30;break}return d.next=11,this.engine.init({canvas:a.canvas,swapChainFormat:Rt.EV.BGRA8Unorm,antialiasing:!1});case 11:o=ix(i),d.prev=12,o.s();case 14:if((s=o.n()).done){d.next=21;break}if(c=s.value,!c.initialize){d.next=19;break}return d.next=19,c.initialize();case 19:d.next=14;break;case 21:d.next=26;break;case 23:d.prev=23,d.t0=d.catch(12),o.e(d.t0);case 26:return d.prev=26,o.f(),d.finish(26);case 29:this.inited=!0;case 30:case"end":return d.stop()}},r,this,[[12,23,26,29]])}));function n(){return t.apply(this,arguments)}return n}()},{key:"render",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(){var i,a,o,s,c,f,d,h=arguments;return Kt().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(!this.inited||this.rendering)){m.next=2;break}return m.abrupt("return");case 2:for(this.pendings.length&&this.pendings.forEach(function(g){g()}),this.rendering=!0,this.engine.beginFrame(),i=this.container.getAll(Je.Systems),a=h.length,o=new Array(a),s=0;s<a;s++)o[s]=h[s];c=ix(i),m.prev=8,c.s();case 10:if((f=c.n()).done){m.next=17;break}if(d=f.value,!d.execute){m.next=15;break}return m.next=15,d.execute(o);case 15:m.next=10;break;case 17:m.next=22;break;case 19:m.prev=19,m.t0=m.catch(8),c.e(m.t0);case 22:return m.prev=22,c.f(),m.finish(22);case 25:this.engine.endFrame(),this.rendering=!1;case 27:case"end":return m.stop()}},r,this,[[8,19,22,25]])}));function n(){return t.apply(this,arguments)}return n}()},{key:"clear",value:function(n){var r=this;return this.inited?this.engine.clear(n):this.pendings.unshift(function(){r.engine.clear(n),r.pendings.shift()}),this}},{key:"setSize",value:function(n){var r=n.width,i=n.height,a=this.engine.getCanvas();return this.size={width:r,height:i},a.width=r,a.height=i,this}},{key:"getSize",value:function(){return this.size}}]),e}(),rx),ex=cn($v.prototype,"engine",[Kw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tx=cn($v.prototype,"shaderModule",[qw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nx=cn($v.prototype,"configService",[Jw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$v))||Qw),sx,ux,cx,fx=(sx=(0,_t.b2)(),sx(ux=(cx=function(){function e(){(0,nn.Z)(this,e),this.entities=[]}return(0,En.Z)(e,[{key:"getEntities",value:function(){return this.entities}},{key:"addRenderable",value:function(n){return this.addEntity(n.getEntity()),this}},{key:"removeRenderable",value:function(n){return this.removeEntity(n.getEntity()),this}},{key:"addLight",value:function(){}},{key:"addEntity",value:function(n){return this.entities.indexOf(n)===-1&&this.entities.push(n),this}},{key:"removeEntity",value:function(n){var r=this.entities.indexOf(n);return this.entities.splice(r,1),this}}]),e}(),cx))||ux),lx,dx,hx,vx=(lx=(0,_t.b2)(),lx(dx=(hx=function(){function e(){(0,nn.Z)(this,e),this.cache={}}return(0,En.Z)(e,[{key:"get",value:function(n){return this.cache[n]}},{key:"set",value:function(n,r){this.cache[n]=r}}]),e}(),hx))||dx),px,mx,gx,yx,rm,_x,Ex,bx;function wx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function xx(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wx(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wx(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Sx=(px=(0,_t.b2)(),mx=(0,_t.f3)(vx),gx=(0,_t.f3)(Je.RenderEngine),px(yx=(rm=(bx=function(){function e(){(0,nn.Z)(this,e),un(this,"textureCache",_x,this),un(this,"engine",Ex,this),this.config=void 0,this.loaded=!1,this.texture=void 0}return(0,En.Z)(e,[{key:"setConfig",value:function(n){this.config=n}},{key:"isLoaded",value:function(){return this.loaded}},{key:"load",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(){var i=this;return Kt().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!this.config.url){o.next=4;break}return o.abrupt("return",new Promise(function(s,c){var f=i.textureCache.get(i.config.url);if(f)s(f);else{var d=new Image;d.crossOrigin="Anonymous",d.src=i.config.url,d.onload=function(){var h=i.engine.createTexture2D(xx(xx({},i.config),{},{data:d,width:d.width,height:d.height,flipY:!0}));i.textureCache.set(i.config.url,h),i.texture=h,i.loaded=!0,s(h)},d.onerror=function(){c()}}}));case 4:return this.loaded=!0,this.texture=this.engine.createTexture2D(this.config),o.abrupt("return",this.texture);case 7:case"end":return o.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()}]),e}(),bx),_x=cn(rm.prototype,"textureCache",[mx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ex=cn(rm.prototype,"engine",[gx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rm))||yx),Tx,Ax,Ix,Cx,Oy,Rx,Mx,Nx=(Tx=(0,_t.b2)(),Ax=(0,_t.f3)(Je.Systems),Ix=(0,_t.t6)(Je.RendererSystem),Tx(Cx=(Oy=(Mx=function(){function e(){(0,nn.Z)(this,e),un(this,"rendererSystem",Rx,this),this.camera=void 0,this.scene=void 0,this.viewport={x:0,y:0,width:0,height:0},this.clearColor=[1,1,1,1]}return(0,En.Z)(e,[{key:"getCamera",value:function(){return this.camera}},{key:"getScene",value:function(){return this.scene}},{key:"getViewport",value:function(){return this.viewport}},{key:"getClearColor",value:function(){return this.clearColor}},{key:"setCamera",value:function(n){return this.camera=n,this}},{key:"setScene",value:function(n){return this.scene=n,this}},{key:"setViewport",value:function(n){return this.viewport=n,this}},{key:"setClearColor",value:function(n){return this.clearColor=n,this}},{key:"pick",value:function(n){return this.rendererSystem.pick(n,this)}}]),e}(),Mx),Rx=cn(Oy.prototype,"rendererSystem",[Ax,Ix],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oy))||Cx),Dx,Px,Ox,Ly,Lx,Gx;function kx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function jC(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?kx(Object(n),!0).forEach(function(r){(0,ze.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kx(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var im=(Dx=(0,_t.b2)(),Px=(0,_t.f3)(Je.ConfigService),Dx(Ox=(Ly=(Gx=function(){function e(){(0,nn.Z)(this,e),un(this,"configService",Lx,this),this.container=void 0}return(0,En.Z)(e,[{key:"getEngine",value:function(){var t=(0,Sr.Z)(Kt().mark(function r(){var i,a,o,s;return Kt().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return i=this.container.get(Je.RenderEngine),a=this.configService.get(),o=a.canvas,s=a.engineOptions,f.next=4,i.init(jC({canvas:o||ab(),swapChainFormat:Rt.EV.BGRA8Unorm,antialiasing:!1},s));case 4:return f.abrupt("return",i);case 5:case"end":return f.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"getTransformComponent",value:function(n){var r=this.container.get(Je.TransformComponentManager);return r.getComponentByEntity(n)}},{key:"getMeshComponent",value:function(n){var r=this.container.get(Je.MeshComponentManager);return r.getComponentByEntity(n)}},{key:"setConfig",value:function(n){this.configService.set(n)}},{key:"setContainer",value:function(n){this.container=n}},{key:"getContainer",value:function(){return this.container}},{key:"createEntity",value:function(){return cc()}},{key:"createScene",value:function(){return this.container.get(fx)}},{key:"createCamera",value:function(){return this.container.get(QE)}},{key:"createView",value:function(){return this.container.get(Nx)}},{key:"createRenderable",value:function(n,r){var i=n?this.container.getNamed(Je.Renderable,n):this.container.get(al),a=cc();return i.setConfig(r||{}),i.setEntity(a),i}},{key:"createGeometry",value:function(n,r){var i=this.container.getNamed(Je.Geometry,n),a=cc();return i.setConfig(r||{}),i.setEntity(a),i.getComponent()}},{key:"createMaterial",value:function(n,r){var i=this.container.getNamed(Je.Material,n),a=cc();return i.setConfig(r||{}),i.setEntity(a,n),i.getComponent()}},{key:"createTexture2D",value:function(n){var r=this.container.get(Sx);return r.setConfig(n),r}},{key:"createBufferGeometry",value:function(n){var r=this.container.getNamed(Je.Systems,Je.GeometrySystem);return r.createBufferGeometry(n)}},{key:"createInstancedBufferGeometry",value:function(n){var r=this.container.getNamed(Je.Systems,Je.GeometrySystem);return r.createInstancedBufferGeometry(n)}},{key:"createShaderMaterial",value:function(n){var r=this.container.getNamed(Je.Systems,Je.MaterialSystem);return r.createShaderMaterial(n)}},{key:"createKernel",value:function(n){var r=this.container.get(mb);return typeof n=="string"?r.setBundle(JSON.parse(n)):r.setBundle(n),r.init(),r}},{key:"createRenderer",value:function(){var n=this.container.get(ox);return n.container=this.container,n.init(),n}},{key:"destroy",value:function(){var n=this.container.getAll(Je.Systems);n.forEach(function(a){a.tearDown&&a.tearDown()});var r=this.container.get(Je.RenderEngine);r.destroy();var i=this.container.get(Je.InteractorService);i.destroy()}}],[{key:"create",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=iA(),i=navigator.gpu?QI:OI;r.isBound(Je.RenderEngine)||r.bind(Je.RenderEngine).to(i).inSingletonScope(),r.bind(ox).toSelf(),r.bind(mb).toSelf(),r.bind(al).toSelf(),r.bind(Nx).toSelf(),r.bind(QE).toSelf(),r.bind(fx).toSelf(),r.bind(e).toSelf(),r.bind(vx).toSelf(),r.bind(Sx).toSelf(),r.bind(Je.Geometry).to(nC).whenTargetNamed(il.BOX),r.bind(Je.Geometry).to(dC).whenTargetNamed(il.SPHERE),r.bind(Je.Geometry).to(cC).whenTargetNamed(il.PLANE),r.bind(Je.Geometry).to(oC).whenTargetNamed(il.MERGED),r.bind(Je.Material).to(_C).whenTargetNamed(xb.BASIC),r.bind(Je.Renderable).to(FC).whenTargetNamed(al.POINT),r.bind(Je.Renderable).to(MC).whenTargetNamed(al.LINE),r.bind(Je.Renderable).to(SC).whenTargetNamed(al.GRID);var a=r.get(e);return a.setContainer(r),a.setConfig(n),a}}]),e}(),Gx),Lx=cn(Ly.prototype,"configService",[Px],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ly))||Ox);const Nh=(e,t)=>{let n;return e?Z(e)?n=()=>e:n=e:n=()=>t||1,n},HC=(e,t)=>{const n=[],r=[],i={};let a=0;for(a=0;a<e.length;a++){const s=e[a];i[s.id]=a,n.push(s.x),n.push(s.y),n.push(0),n.push(0),r.push([])}for(a=0;a<t.length;a++){const s=t[a],c=ke(s,"source"),f=ke(s,"target");!isNaN(i[c])&&!isNaN(i[f])&&(r[i[c]].push(i[f]),r[i[f]].push(i[c]))}let o=0;for(a=0;a<e.length;a++){const s=n.length,c=r[a],f=c.length;n[a*4+2]=s,n[a*4+3]=f,o=Math.max(o,f);for(let d=0;d<f;++d){const h=c[d];n.push(+h)}}for(;n.length%4!=0;)n.push(0);return{maxEdgePerVetex:o,array:new Float32Array(n)}},XC=(e,t,n,r)=>{const i=[],a=[],o={};let s=0;for(s=0;s<e.length;s++){const f=e[s];o[f.id]=s,i.push(f.x),i.push(f.y),i.push(0),i.push(0),a.push([])}for(s=0;s<t.length;s++){const f=t[s],d=ke(f,"source"),h=ke(f,"target");a[o[d]].push(o[h]),a[o[d]].push(n(f)),a[o[d]].push(r(f)),a[o[d]].push(0),a[o[h]].push(o[d]),a[o[h]].push(n(f)),a[o[h]].push(r(f)),a[o[h]].push(0)}let c=0;for(s=0;s<e.length;s++){const f=i.length,d=a[s],h=d.length;i[s*4+2]=f+1048576*h/4,i[s*4+3]=0,c=Math.max(c,h/4);for(let v=0;v<h;++v){const m=d[v];i.push(+m)}}for(;i.length%4!=0;)i.push(0);return{maxEdgePerVetex:c,array:new Float32Array(i)}},$C=(e,t)=>{const n=[],r=e.length,i={};return t.forEach(a=>{e.forEach((o,s)=>{if(i[a[o]]===void 0&&(i[a[o]]=Object.keys(i).length),n.push(i[a[o]]),s===r-1)for(;n.length%4!=0;)n.push(0)})}),{array:new Float32Array(n),count:Object.keys(i).length}},Fx=e=>{const t=[],n=e.length,r=e[0].length;for(let i=0;i<r;i++)e.forEach((a,o)=>{if(t.push(a[i]),o===n-1)for(;t.length%4!=0;)t.push(0)});return new Float32Array(t)},TN=null,YC='{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_K : f32;\\n  [[offset 4]] u_K2 : f32;\\n  [[offset 8]] u_Center : vec2<f32>;\\n  [[offset 16]] u_Gravity : f32;\\n  [[offset 20]] u_ClusterGravity : f32;\\n  [[offset 24]] u_Speed : f32;\\n  [[offset 28]] u_MaxDisplace : f32;\\n  [[offset 32]] u_Clustering : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AttributeArray : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_ClusterCenters : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 3, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn calcRepulsive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {if (i != j) {var nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nvar xDist : f32 = currentNode.x - nextNode.x;\\nvar yDist : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nvar param : f32 = gWebGPUUniformParams.u_K2 / dist;\\nif (dist > 0.0) {dx = dx + param * xDist;\\ndy = dy + param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {var sign : f32 = select(1.0, -1.0, i < j);\\ndx = dx + param * std::sign;\\ndy = dy + param * std::sign;}}}}\\nreturn vec2<f32>(dx, dy);}\\nfn calcGravity(currentNode : vec4<f32>, nodeAttributes : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nvar vx : f32 = currentNode.x - gWebGPUUniformParams.u_Center.x;\\nvar vy : f32 = currentNode.y - gWebGPUUniformParams.u_Center.y;\\nvar gf : f32 = (0.01 * gWebGPUUniformParams.u_K) * gWebGPUUniformParams.u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (gWebGPUUniformParams.u_Clustering == 1.0) {var clusterIdx : i32 = i32(nodeAttributes.x);\\nvar center : vec4<f32> = gWebGPUBuffer2.u_ClusterCenters[clusterIdx];\\nvar cvx : f32 = currentNode.x - center.x;\\nvar cvy : f32 = currentNode.y - center.y;\\nvar dist : f32 = std::sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nvar parma : f32 = (gWebGPUUniformParams.u_K * gWebGPUUniformParams.u_ClusterGravity) / dist;\\ndx = dx + parma * cvx;\\ndy = dy + parma * cvy;}\\nreturn vec2<f32>(dx, dy);}\\nfn calcAttractive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nvar arr_offset : i32 = i32(std::floor(currentNode.z + 0.5));\\nvar length : i32 = i32(std::floor(currentNode.w + 0.5));\\nvar node_buffer : vec4<f32>;\\nfor (var p : i32 = 0; p < __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX; p = p + 1) {if (p >= length) {break;}\\nvar arr_idx : i32 = arr_offset + i32(p);\\nvar buf_offset : i32 = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[i32(arr_idx / 4)];}\\nvar float_j : f32 = select(node_buffer.x, select(node_buffer.y, select(node_buffer.z, node_buffer.w, buf_offset == 2), buf_offset == 1), buf_offset == 0);\\nvar nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[i32(float_j)];\\nvar xDist : f32 = currentNode.x - nextNode.x;\\nvar yDist : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = std::sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nvar attractiveF : f32 = dist / gWebGPUUniformParams.u_K;\\nif (dist > 0.0) {dx = dx - xDist * attractiveF;\\ndy = dy - yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {var sign : f32 = select(1.0, -1.0, i < i32(float_j));\\ndx = dx - std::sign * attractiveF;\\ndy = dy - std::sign * attractiveF;}}}\\nreturn vec2<f32>(dx, dy);}\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar currentNode : vec4<f32> = gWebGPUBuffer0.u_Data[i];\\nvar dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nif (i >= __DefineValuePlaceholder__VERTEX_COUNT) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvar nodeAttributes : vec4<f32> = gWebGPUBuffer1.u_AttributeArray[i];\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4<f32>(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w);\\nreturn ;}\\nvar repulsive : vec2<f32> = calcRepulsive(i, currentNode);\\ndx = dx + repulsive.x;\\ndy = dy + repulsive.y;\\nvar attractive : vec2<f32> = calcAttractive(i, currentNode);\\ndx = dx + attractive.x;\\ndy = dy + attractive.y;\\nvar gravity : vec2<f32> = calcGravity(currentNode, nodeAttributes);\\ndx = dx - gravity.x;\\ndy = dy - gravity.y;\\ndx = dx * gWebGPUUniformParams.u_Speed;\\ndy = dy * gWebGPUUniformParams.u_Speed;\\nvar distLength : f32 = std::sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {var limitedDist : f32 = std::min(gWebGPUUniformParams.u_MaxDisplace * gWebGPUUniformParams.u_Speed, distLength);\\ngWebGPUBuffer0.u_Data[i] = vec4<f32>(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w);}\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_K;\\n  float u_K2;\\n  vec2 u_Center;\\n  float u_Gravity;\\n  float u_ClusterGravity;\\n  float u_Speed;\\n  float u_MaxDisplace;\\n  float u_Clustering;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer   GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_AttributeArray[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 3) buffer readonly  GWebGPUBuffer2 {\\n  vec4 u_ClusterCenters[];\\n} gWebGPUBuffer2;\\n\\n\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nvec2 calcRepulsive(int i, vec4 currentNode) {float dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = gWebGPUBuffer0.u_Data[j];\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = gWebGPUUniformParams.u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {float dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - gWebGPUUniformParams.u_Center.x;\\nfloat vy = currentNode.y - gWebGPUUniformParams.u_Center.y;\\nfloat gf = (0.01 * gWebGPUUniformParams.u_K) * gWebGPUUniformParams.u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (gWebGPUUniformParams.u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = gWebGPUBuffer2.u_ClusterCenters[clusterIdx];\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (gWebGPUUniformParams.u_K * gWebGPUUniformParams.u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {float dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[int(arr_idx / 4)];}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = gWebGPUBuffer0.u_Data[int(float_j)];\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / gWebGPUUniformParams.u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {int i = globalInvocationID.x;\\nvec4 currentNode = gWebGPUBuffer0.u_Data[i];\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvec4 nodeAttributes = gWebGPUBuffer1.u_AttributeArray[i];\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w);\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= gWebGPUUniformParams.u_Speed;\\ndy *= gWebGPUUniformParams.u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(gWebGPUUniformParams.u_MaxDisplace * gWebGPUUniformParams.u_Speed, distLength);\\ngWebGPUBuffer0.u_Data[i] = vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w);}}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_K;\\nuniform float u_K2;\\nuniform vec2 u_Center;\\nuniform float u_Gravity;\\nuniform float u_ClusterGravity;\\nuniform float u_Speed;\\nuniform float u_MaxDisplace;\\nuniform float u_Clustering;\\nuniform sampler2D u_AttributeArray;\\nuniform vec2 u_AttributeArraySize;\\nvec4 getDatau_AttributeArray(vec2 address2D) {\\n  return vec4(texture2D(u_AttributeArray, address2D).rgba);\\n}\\nvec4 getDatau_AttributeArray(float address1D) {\\n  return getDatau_AttributeArray(addrTranslation_1Dto2D(address1D, u_AttributeArraySize));\\n}\\nvec4 getDatau_AttributeArray(int address1D) {\\n  return getDatau_AttributeArray(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - u_Center.x;\\nfloat vy = currentNode.y - u_Center.y;\\nfloat gf = (0.01 * u_K) * u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = getDatau_ClusterCenters(clusterIdx);\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (u_K * u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes = getDatau_AttributeArray(i);\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w));\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= u_Speed;\\ndy *= u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(u_MaxDisplace * u_Speed, distLength);\\ngl_FragColor = vec4(vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_K","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_K2","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Center","type":"vec2<f32>","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Gravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterGravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Speed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_MaxDisplace","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Clustering","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AttributeArray","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}',AN=null,KC='{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\n\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 0, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributes : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_ClusterCenters : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar center : vec4<f32> = gWebGPUBuffer2.u_ClusterCenters[i];\\nvar sumx : f32 = 0.0;\\nvar sumy : f32 = 0.0;\\nvar count : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {var attributes : vec4<f32> = gWebGPUBuffer1.u_NodeAttributes[j];\\nvar clusterIdx : i32 = i32(attributes.x);\\nvar vertex : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nif (clusterIdx == i) {sumx = sumx + vertex.x;\\nsumy = sumy + vertex.y;\\ncount = count + 1.0;}}\\ngWebGPUBuffer2.u_ClusterCenters[i] = vec4<f32>(sumx / count, sumy / count, count, i);\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\n\\nlayout(std430, set = 0, binding = 0) buffer readonly  GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 1) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_NodeAttributes[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 2) buffer   GWebGPUBuffer2 {\\n  vec4 u_ClusterCenters[];\\n} gWebGPUBuffer2;\\n\\n\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\nvoid main() {int i = globalInvocationID.x;\\nvec4 center = gWebGPUBuffer2.u_ClusterCenters[i];\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = gWebGPUBuffer1.u_NodeAttributes[j];\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = gWebGPUBuffer0.u_Data[j];\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngWebGPUBuffer2.u_ClusterCenters[i] = vec4(sumx / count, sumy / count, count, i);}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributes;\\nuniform vec2 u_NodeAttributesSize;\\nvec4 getDatau_NodeAttributes(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributes, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributes(float address1D) {\\n  return getDatau_NodeAttributes(addrTranslation_1Dto2D(address1D, u_NodeAttributesSize));\\n}\\nvec4 getDatau_NodeAttributes(int address1D) {\\n  return getDatau_NodeAttributes(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 center = getDatau_ClusterCenters(i);\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = getDatau_NodeAttributes(j);\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = getDatau_Data(j);\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngl_FragColor = vec4(vec4(sumx / count, sumy / count, count, i));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"CLUSTER_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributes","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_ClusterCenters","size":[1,1],"length":1},"needPingpong":true}}';var am=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(d){try{f(r.next(d))}catch(h){o(h)}}function c(d){try{f(r.throw(d))}catch(h){o(h)}}function f(d){d.done?a(d.value):i(d.value).then(s,c)}f((r=r.apply(e,t||[])).next())})};class qC extends jt{constructor(t){super();this.maxIteration=1e3,this.gravity=10,this.speed=1,this.clustering=!1,this.clusterField="cluster",this.clusterGravity=10,this.workerEnabled=!1,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(t)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10}}execute(){return am(this,void 0,void 0,function*(){const t=this,n=t.nodes;if(!n||n.length===0){t.onLayoutEnd&&t.onLayoutEnd();return}!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight),t.center||(t.center=[t.width/2,t.height/2]);const r=t.center;if(n.length===1){n[0].x=r[0],n[0].y=r[1],t.onLayoutEnd&&t.onLayoutEnd();return}const i={},a={};n.forEach((o,s)=>{Z(o.x)||(o.x=Math.random()*this.width),Z(o.y)||(o.y=Math.random()*this.height),i[o.id]=o,a[o.id]=s}),t.nodeMap=i,t.nodeIdxMap=a,yield t.run()})}executeWithWorker(t,n){return am(this,void 0,void 0,function*(){const r=this,i=r.nodes,a=r.center;if(!i||i.length===0)return;if(i.length===1){i[0].x=a[0],i[0].y=a[1];return}const o={},s={};i.forEach((c,f)=>{Z(c.x)||(c.x=Math.random()*this.width),Z(c.y)||(c.y=Math.random()*this.height),o[c.id]=c,s[c.id]=f}),r.nodeMap=o,r.nodeIdxMap=s,yield r.run(t,n)})}run(t,n){return am(this,void 0,void 0,function*(){const r=this,i=r.nodes,a=r.edges,o=r.maxIteration,s=r.center,c=r.height*r.width;let f=Math.sqrt(c)/10;const d=c/(i.length+1),h=Math.sqrt(d),v=r.speed,m=r.clustering,{array:g,count:_}=$C([r.clusterField],i);i.forEach((de,Ce)=>{let ie=0,Ge=0;Z(de.fx)&&Z(de.fy)&&(ie=de.fx||.001,Ge=de.fy||.001),g[4*Ce+1]=ie,g[4*Ce+2]=Ge});const y=i.length,{maxEdgePerVetex:E,array:b}=HC(i,a),A=r.workerEnabled;let C;A?C=im.create({canvas:t,engineOptions:{supportCompute:!0}}):C=im.create({engineOptions:{supportCompute:!0}});const R=r.onLayoutEnd,W=[];for(let de=0;de<_;de++)W.push(0,0,0,0);const te=C.createKernel(YC).setDispatch([y,1,1]).setBinding({u_Data:b,u_K:h,u_K2:d,u_Gravity:r.gravity,u_ClusterGravity:r.clusterGravity||r.gravity||1,u_Speed:v,u_MaxDisplace:f,u_Clustering:m?1:0,u_Center:s,u_AttributeArray:g,u_ClusterCenters:W,MAX_EDGE_PER_VERTEX:E,VERTEX_COUNT:y});let Q;m&&(Q=C.createKernel(KC).setDispatch([_,1,1]).setBinding({u_Data:b,u_NodeAttributes:g,u_ClusterCenters:W,VERTEX_COUNT:y,CLUSTER_COUNT:_})),yield(()=>am(this,void 0,void 0,function*(){for(let Ce=0;Ce<o;Ce++)yield te.execute(),m&&(Q.setBinding({u_Data:te}),yield Q.execute(),te.setBinding({u_ClusterCenters:Q})),te.setBinding({u_MaxDisplace:f*=.99});const de=yield te.getOutput();t?n.postMessage({type:yi.GPUEND,vertexEdgeData:de}):i.forEach((Ce,ie)=>{const Ge=de[4*ie],We=de[4*ie+1];Ce.x=Ge,Ce.y=We}),R&&R()}))()})}getType(){return"fruchterman-gpu"}}const IN=null,JC='{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_damping : f32;\\n  [[offset 4]] u_maxSpeed : f32;\\n  [[offset 8]] u_minMovement : f32;\\n  \\n  [[offset 12]] u_coulombDisScale : f32;\\n  [[offset 16]] u_factor : f32;\\n  \\n  \\n  [[offset 20]] u_interval : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AveMovement : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributeArray1 : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 3, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\ntype GWebGPUBuffer3 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributeArray2 : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 4, set 0]] var<storage_buffer> gWebGPUBuffer3 : GWebGPUBuffer3;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn unpack_float(packedValue : f32) -> vec2<i32> {var packedIntValue : i32 = i32(packedValue);\\nvar v0 : i32 = packedIntValue / 1048576;\\nreturn vec2<i32>(v0, packedIntValue - (v0 * 1048576));}\\nfn calcRepulsive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {if (i != j) {var nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nvar vx : f32 = currentNode.x - nextNode.x;\\nvar vy : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.01;\\nvar n_dist : f32 = (dist + 0.1) * gWebGPUUniformParams.u_coulombDisScale;\\nvar direx : f32 = vx / dist;\\nvar direy : f32 = vy / dist;\\nvar attributesi : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvar attributesj : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[j];\\nvar massi : f32 = attributesi.x;\\nvar nodeStrengthi : f32 = attributesi.z;\\nvar nodeStrengthj : f32 = attributesj.z;\\nvar nodeStrength : f32 = (nodeStrengthi + nodeStrengthj) / 2.0;\\nvar param : f32 = (nodeStrength * gWebGPUUniformParams.u_factor) / (n_dist * n_dist);\\nax = ax + direx * param;\\nay = ay + direy * param;}}\\nreturn vec2<f32>(ax, ay);}\\nfn calcGravity(i : i32, currentNode : vec4<f32>, attributes2 : vec4<f32>) -> vec2<f32> {var vx : f32 = currentNode.x - attributes2.x;\\nvar vy : f32 = currentNode.y - attributes2.y;\\nvar ax : f32 = vx * attributes2.z;\\nvar ay : f32 = vy * attributes2.z;\\nreturn vec2<f32>(ax, ay);}\\nfn calcAttractive(i : i32, currentNode : vec4<f32>, attributes1 : vec4<f32>) -> vec2<f32> {var mass : f32 = attributes1.x;\\nvar ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nvar compressed : vec2<i32> = unpack_float(currentNode.z);\\nvar length : i32 = compressed.x;\\nvar arr_offset : i32 = compressed.y;\\nvar node_buffer : vec4<f32>;\\nfor (var p : i32 = 0; p < __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX; p = p + 1) {if (p >= length) {break;}\\nvar arr_idx : i32 = arr_offset + (4 * p);\\nvar buf_offset : i32 = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[i32(arr_idx / 4)];}\\nvar float_j : f32 = node_buffer.x;\\nvar nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[i32(float_j)];\\nvar vx : f32 = nextNode.x - currentNode.x;\\nvar vy : f32 = nextNode.y - currentNode.y;\\nvar dist : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.01;\\nvar direx : f32 = vx / dist;\\nvar direy : f32 = vy / dist;\\nvar edgeLength : f32 = node_buffer.y;\\nvar edgeStrength : f32 = node_buffer.z;\\nvar diff : f32 = edgeLength - dist;\\nvar param : f32 = (diff * edgeStrength) / mass;\\nax = ax - direx * param;\\nay = ay - direy * param;}\\nreturn vec2<f32>(ax, ay);}\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar currentNode : vec4<f32> = gWebGPUBuffer0.u_Data[i];\\nvar movement : vec4<f32> = gWebGPUBuffer1.u_AveMovement[0];\\nvar ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nif ((i >= __DefineValuePlaceholder__VERTEX_COUNT) || (movement.x < gWebGPUUniformParams.u_minMovement)) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvar nodeAttributes1 : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvar nodeAttributes2 : vec4<f32> = gWebGPUBuffer3.u_NodeAttributeArray2[i];\\nvar repulsive : vec2<f32> = calcRepulsive(i, currentNode);\\nax = ax + repulsive.x;\\nay = ay + repulsive.y;\\nvar attractive : vec2<f32> = calcAttractive(i, currentNode, nodeAttributes1);\\nax = ax + attractive.x;\\nay = ay + attractive.y;\\nvar gravity : vec2<f32> = calcGravity(i, currentNode, nodeAttributes2);\\nax = ax - gravity.x;\\nay = ay - gravity.y;\\nvar param : f32 = gWebGPUUniformParams.u_interval * gWebGPUUniformParams.u_damping;\\nvar vx : f32 = ax * param;\\nvar vy : f32 = ay * param;\\nvar vlength : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > gWebGPUUniformParams.u_maxSpeed) {var param2 : f32 = gWebGPUUniformParams.u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nvar distx : f32 = vx * gWebGPUUniformParams.u_interval;\\nvar disty : f32 = vy * gWebGPUUniformParams.u_interval;\\nvar distLength : f32 = std::sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4<f32>(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0);}else {gWebGPUBuffer0.u_Data[i] = vec4<f32>(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength);}\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_damping;\\n  float u_maxSpeed;\\n  float u_minMovement;\\n  \\n  float u_coulombDisScale;\\n  float u_factor;\\n  \\n  \\n  float u_interval;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer   GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_AveMovement[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 3) buffer readonly  GWebGPUBuffer2 {\\n  vec4 u_NodeAttributeArray1[];\\n} gWebGPUBuffer2;\\n\\nlayout(std430, set = 0, binding = 4) buffer readonly  GWebGPUBuffer3 {\\n  vec4 u_NodeAttributeArray2[];\\n} gWebGPUBuffer3;\\n\\n\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nivec2 unpack_float(float packedValue) {int packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {float ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = gWebGPUBuffer0.u_Data[j];\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * gWebGPUUniformParams.u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvec4 attributesj = gWebGPUBuffer2.u_NodeAttributeArray1[j];\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * gWebGPUUniformParams.u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {float vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {float mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[int(arr_idx / 4)];}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = gWebGPUBuffer0.u_Data[int(float_j)];\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {int i = globalInvocationID.x;\\nvec4 currentNode = gWebGPUBuffer0.u_Data[i];\\nvec4 movement = gWebGPUBuffer1.u_AveMovement[0];\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < gWebGPUUniformParams.u_minMovement)) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvec4 nodeAttributes1 = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvec4 nodeAttributes2 = gWebGPUBuffer3.u_NodeAttributeArray2[i];\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = gWebGPUUniformParams.u_interval * gWebGPUUniformParams.u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > gWebGPUUniformParams.u_maxSpeed) {float param2 = gWebGPUUniformParams.u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nfloat distx = vx * gWebGPUUniformParams.u_interval;\\nfloat disty = vy * gWebGPUUniformParams.u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0);}else {gWebGPUBuffer0.u_Data[i] = vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength);}}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_damping;\\nuniform float u_maxSpeed;\\nuniform float u_minMovement;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nuniform float u_coulombDisScale;\\nuniform float u_factor;\\nuniform sampler2D u_NodeAttributeArray1;\\nuniform vec2 u_NodeAttributeArray1Size;\\nvec4 getDatau_NodeAttributeArray1(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray1, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray1(float address1D) {\\n  return getDatau_NodeAttributeArray1(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray1Size));\\n}\\nvec4 getDatau_NodeAttributeArray1(int address1D) {\\n  return getDatau_NodeAttributeArray1(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributeArray2;\\nuniform vec2 u_NodeAttributeArray2Size;\\nvec4 getDatau_NodeAttributeArray2(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray2, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray2(float address1D) {\\n  return getDatau_NodeAttributeArray2(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray2Size));\\n}\\nvec4 getDatau_NodeAttributeArray2(int address1D) {\\n  return getDatau_NodeAttributeArray2(float(address1D));\\n}\\nuniform float u_interval;\\nivec2 unpack_float(float packedValue) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = getDatau_NodeAttributeArray1(i);\\nvec4 attributesj = getDatau_NodeAttributeArray1(j);\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nvec4 movement = getDatau_AveMovement(0.0);\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < u_minMovement)) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes1 = getDatau_NodeAttributeArray1(i);\\nvec4 nodeAttributes2 = getDatau_NodeAttributeArray2(i);\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = u_interval * u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > u_maxSpeed) {float param2 = u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nfloat distx = vx * u_interval;\\nfloat disty = vy * u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0));}else {gl_FragColor = vec4(vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"SHIFT_20","type":"Float","value":1048576,"runtime":false}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_damping","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_maxSpeed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_minMovement","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_coulombDisScale","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_factor","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray1","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray2","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_interval","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}',CN=null,QC='{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_iter : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AveMovement : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\n\\n\\n\\n\\n\\n\\n\\n\\nfn main() -> void {var movement : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {var vertex : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nmovement = movement + vertex.w;}\\nmovement = movement / f32(__DefineValuePlaceholder__VERTEX_COUNT);\\ngWebGPUBuffer1.u_AveMovement[0] = vec4<f32>(movement, 0.0, 0.0, 0.0);\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_iter;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer readonly  GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer   GWebGPUBuffer1 {\\n  vec4 u_AveMovement[];\\n} gWebGPUBuffer1;\\n\\n\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\nvoid main() {float movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = gWebGPUBuffer0.u_Data[j];\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngWebGPUBuffer1.u_AveMovement[0] = vec4(movement, 0.0, 0.0, 0.0);}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_iter;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = getDatau_Data(j);\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngl_FragColor = vec4(vec4(movement, 0.0, 0.0, 0.0));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_iter","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_AveMovement","size":[1,1],"length":1},"needPingpong":true}}';var Gy=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(d){try{f(r.next(d))}catch(h){o(h)}}function c(d){try{f(r.throw(d))}catch(h){o(h)}}function f(d){d.done?a(d.value):i(d.value).then(s,c)}f((r=r.apply(e,t||[])).next())})};class eR extends jt{constructor(t){super();this.maxIteration=1e3,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.5,this.interval=.02,this.factor=1,this.linkDistance=1,this.gravity=10,this.workerEnabled=!1,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(t)}getDefaultCfg(){return{maxIteration:2e3,gravity:10,clustering:!1,clusterGravity:10}}execute(){return Gy(this,void 0,void 0,function*(){const t=this,n=t.nodes;if(!n||n.length===0){t.onLayoutEnd&&t.onLayoutEnd();return}!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight),t.center||(t.center=[t.width/2,t.height/2]);const r=t.center;if(n.length===1){n[0].x=r[0],n[0].y=r[1],t.onLayoutEnd&&t.onLayoutEnd();return}const i={},a={};n.forEach((o,s)=>{Z(o.x)||(o.x=Math.random()*t.width),Z(o.y)||(o.y=Math.random()*t.height),i[o.id]=o,a[o.id]=s}),t.nodeMap=i,t.nodeIdxMap=a,t.nodeStrength=Nh(t.nodeStrength,1),t.edgeStrength=Nh(t.edgeStrength,1),yield t.run()})}executeWithWorker(t,n){const r=this,i=r.nodes,a=r.center;if(!i||i.length===0)return;if(i.length===1){i[0].x=a[0],i[0].y=a[1];return}const o={},s={};i.forEach((c,f)=>{Z(c.x)||(c.x=Math.random()*r.width),Z(c.y)||(c.y=Math.random()*r.height),o[c.id]=c,s[c.id]=f}),r.nodeMap=o,r.nodeIdxMap=s,r.nodeStrength=Nh(r.nodeStrength,1),r.edgeStrength=Nh(r.edgeStrength,1),r.run(t,n)}run(t,n){return Gy(this,void 0,void 0,function*(){const r=this,i=r.nodes,a=r.edges,o=r.maxIteration;!r.width&&typeof window!="undefined"&&(r.width=window.innerWidth),!r.height&&typeof window!="undefined"&&(r.height=window.innerHeight);const s=i.length;r.linkDistance=Nh(r.linkDistance),r.edgeStrength=Nh(r.edgeStrength);const{maxEdgePerVetex:c,array:f}=XC(i,a,r.linkDistance,r.edgeStrength);r.degrees=Gt(i.length,r.nodeIdxMap,a).map(ie=>ie.all);const d=[],h=[],v=[],m=[],g=[],_=[],y=[];r.getMass||(r.getMass=ie=>r.degrees[r.nodeIdxMap[ie.id]]||1);const E=r.gravity,b=r.center;i.forEach((ie,Ge)=>{d.push(r.getMass(ie)),h.push(r.nodeStrength(ie)),r.degrees[Ge]||(r.degrees[Ge]=0);let We=[b[0],b[1],E];if(r.getCenter){const It=r.getCenter(ie,r.degrees[Ge]);It&&Z(It[0])&&Z(It[1])&&Z(It[2])&&(We=It)}v.push(We[0]),m.push(We[1]),g.push(We[2]),Z(ie.fx)&&Z(ie.fy)?(_.push(ie.fx||.001),y.push(ie.fy||.001)):(_.push(0),y.push(0))});const A=Fx([d,r.degrees,h,_]),C=Fx([v,m,g,y]),R=r.workerEnabled;let W;R?W=im.create({canvas:t,engineOptions:{supportCompute:!0}}):W=im.create({engineOptions:{supportCompute:!0}});const te=r.onLayoutEnd,Q=[];f.forEach(ie=>{Q.push(ie)});for(let ie=0;ie<4;ie++)Q.push(0);const re=W.createKernel(JC).setDispatch([s,1,1]).setBinding({u_Data:f,u_damping:r.damping,u_maxSpeed:r.maxSpeed,u_minMovement:r.minMovement,u_coulombDisScale:r.coulombDisScale,u_factor:r.factor,u_NodeAttributeArray1:A,u_NodeAttributeArray2:C,MAX_EDGE_PER_VERTEX:c,VERTEX_COUNT:s,u_AveMovement:Q,u_interval:r.interval}),de=W.createKernel(QC).setDispatch([1,1,1]).setBinding({u_Data:f,VERTEX_COUNT:s,u_AveMovement:[0,0,0,0]});yield(()=>Gy(this,void 0,void 0,function*(){for(let Ge=0;Ge<o;Ge++){yield re.execute(),de.setBinding({u_Data:re}),yield de.execute();const We=Math.max(.02,r.interval-Ge*.002);re.setBinding({u_interval:We,u_AveMovement:de})}const ie=yield re.getOutput();t?n.postMessage({type:yi.GPUEND,vertexEdgeData:ie}):i.forEach((Ge,We)=>{const It=ie[4*We],gn=ie[4*We+1];Ge.x=It,Ge.y=gn}),te&&te()}))()})}getType(){return"gForce-gpu"}}class tR extends jt{constructor(t){super();this.center=[0,0],this.maxIteration=100,this.gravity=10,this.comboGravity=10,this.linkDistance=10,this.alpha=1,this.alphaMin=.001,this.alphaDecay=1-Math.pow(this.alphaMin,1/300),this.alphaTarget=0,this.velocityDecay=.6,this.edgeStrength=.6,this.nodeStrength=30,this.preventOverlap=!1,this.preventNodeOverlap=!1,this.preventComboOverlap=!1,this.collideStrength=void 0,this.nodeCollideStrength=.5,this.comboCollideStrength=.5,this.comboSpacing=20,this.comboPadding=10,this.optimizeRangeFactor=1,this.onTick=()=>{},this.onLayoutEnd=()=>{},this.depthAttractiveForceScale=1,this.depthRepulsiveForceScale=2,this.nodes=[],this.edges=[],this.combos=[],this.comboTrees=[],this.width=300,this.height=300,this.bias=[],this.nodeMap={},this.oriComboMap={},this.indexMap={},this.comboMap={},this.previousLayouted=!1,this.updateCfg(t)}getDefaultCfg(){return{maxIteration:100,center:[0,0],gravity:10,speed:1,comboGravity:30,preventOverlap:!1,preventComboOverlap:!0,preventNodeOverlap:!0,nodeSpacing:void 0,collideStrength:void 0,nodeCollideStrength:.5,comboCollideStrength:.5,comboSpacing:20,comboPadding:10,edgeStrength:.6,nodeStrength:30,linkDistance:10}}execute(){const t=this,n=t.nodes,r=t.center;if(t.comboTree={id:"comboTreeRoot",depth:-1,children:t.comboTrees},!n||n.length===0){t.onLayoutEnd&&t.onLayoutEnd();return}if(n.length===1){n[0].x=r[0],n[0].y=r[1],t.onLayoutEnd&&t.onLayoutEnd();return}t.initVals(),t.run(),t.onLayoutEnd&&t.onLayoutEnd()}run(){const t=this,n=t.nodes,r=t.previousLayouted?t.maxIteration/5:t.maxIteration;!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight);const i=t.center,a=t.velocityDecay,o=t.comboMap;t.previousLayouted||t.initPos(o);for(let f=0;f<r;f++){const d=[];n.forEach((h,v)=>{d[v]={x:0,y:0}}),t.applyCalculate(d),t.applyComboCenterForce(d),n.forEach((h,v)=>{!Z(h.x)||!Z(h.y)||(h.x+=d[v].x*a,h.y+=d[v].y*a)}),t.alpha+=(t.alphaTarget-t.alpha)*t.alphaDecay,t.onTick()}const s=[0,0];n.forEach(f=>{!Z(f.x)||!Z(f.y)||(s[0]+=f.x,s[1]+=f.y)}),s[0]/=n.length,s[1]/=n.length;const c=[i[0]-s[0],i[1]-s[1]];n.forEach((f,d)=>{!Z(f.x)||!Z(f.y)||(f.x+=c[0],f.y+=c[1])}),t.combos.forEach(f=>{const d=o[f.id];d&&d.empty&&(f.x=d.cx||f.x,f.y=d.cy||f.y)}),t.previousLayouted=!0}initVals(){const t=this,n=t.edges,r=t.nodes,i=t.combos,a={},o={},s={};r.forEach((de,Ce)=>{o[de.id]=de,s[de.id]=Ce}),t.nodeMap=o,t.indexMap=s;const c={};i.forEach(de=>{c[de.id]=de}),t.oriComboMap=c,t.comboMap=t.getComboMap();const f=t.preventOverlap;t.preventComboOverlap=t.preventComboOverlap||f,t.preventNodeOverlap=t.preventNodeOverlap||f;const d=t.collideStrength;d&&(t.comboCollideStrength=d,t.nodeCollideStrength=d),t.comboCollideStrength=t.comboCollideStrength?t.comboCollideStrength:0,t.nodeCollideStrength=t.nodeCollideStrength?t.nodeCollideStrength:0;for(let de=0;de<n.length;++de){const Ce=ke(n[de],"source"),ie=ke(n[de],"target");a[Ce]?a[Ce]++:a[Ce]=1,a[ie]?a[ie]++:a[ie]=1}const h=[];for(let de=0;de<n.length;++de){const Ce=ke(n[de],"source"),ie=ke(n[de],"target");h[de]=a[Ce]/(a[Ce]+a[ie])}this.bias=h;const v=t.nodeSize,m=t.nodeSpacing;let g,_;if(Z(m)?_=()=>m:pt(m)?_=m:_=()=>0,this.nodeSpacing=_,!v)g=de=>de.size?H(de.size)?(de.size[0]>de.size[1]?de.size[0]:de.size[1])/2:me(de.size)?(de.size.width>de.size.height?de.size.width:de.size.height)/2:de.size/2:10;else if(pt(v))g=de=>v(de);else if(H(v)){const Ce=(v[0]>v[1]?v[0]:v[1])/2;g=ie=>Ce}else{const de=v/2;g=Ce=>de}this.nodeSize=g;const y=t.comboSpacing;let E;Z(y)?E=()=>y:pt(y)?E=y:E=()=>0,this.comboSpacing=E;const b=t.comboPadding;let A;Z(b)?A=()=>b:H(b)?A=()=>Math.max.apply(null,b):pt(b)?A=b:A=()=>0,this.comboPadding=A;let C=this.linkDistance,R;C||(C=10),Z(C)?R=de=>C:R=C,this.linkDistance=R;let W=this.edgeStrength,te;W||(W=1),Z(W)?te=de=>W:te=W,this.edgeStrength=te;let Q=this.nodeStrength,re;Q||(Q=30),Z(Q)?re=de=>Q:re=Q,this.nodeStrength=re}initPos(t){this.nodes.forEach((i,a)=>{const o=i.comboId,s=t[o];o&&s?(i.x=s.cx+100/(a+1),i.y=s.cy+100/(a+1)):(i.x=100/(a+1),i.y=100/(a+1))})}getComboMap(){const t=this,n=t.nodeMap,r=t.comboTrees,i=t.oriComboMap,a={};return(r||[]).forEach(o=>{const s=[];Ae(o,c=>{if(c.itemType==="node"||!i[c.id])return!0;if(a[c.id]===void 0){const h={id:c.id,name:c.id,cx:0,cy:0,count:0,depth:t.oriComboMap[c.id].depth||0,children:[]};a[c.id]=h}const f=c.children;f&&f.forEach(h=>{if(!a[h.id]&&!n[h.id])return!0;s.push(h)});const d=a[c.id];if(d.cx=0,d.cy=0,s.length===0){d.empty=!0;const h=i[c.id];d.cx=h.x,d.cy=h.y}return s.forEach(h=>{if(d.count++,h.itemType!=="node"){const m=a[h.id];Z(m.cx)&&(d.cx+=m.cx),Z(m.cy)&&(d.cy+=m.cy);return}const v=n[h.id];!v||(Z(v.x)&&(d.cx+=v.x),Z(v.y)&&(d.cy+=v.y))}),d.cx/=d.count||1,d.cy/=d.count||1,d.children=s,!0})}),a}applyComboCenterForce(t){const n=this,r=n.gravity,i=n.comboGravity||r,a=this.alpha,o=n.comboTrees,s=n.indexMap,c=n.nodeMap,f=n.comboMap;(o||[]).forEach(d=>{Ae(d,h=>{if(h.itemType==="node"||!f[h.id])return!0;const m=f[h.id],g=(m.depth+1)/10*.5,_=m.cx,y=m.cy;return m.cx=0,m.cy=0,m.children.forEach(E=>{if(E.itemType!=="node"){const Q=f[E.id];Q&&Z(Q.cx)&&(m.cx+=Q.cx),Q&&Z(Q.cy)&&(m.cy+=Q.cy);return}const b=c[E.id],A=b.x-_||.005,C=b.y-y||.005,R=Math.sqrt(A*A+C*C),W=s[b.id],te=i*a/R*g;t[W].x-=A*te,t[W].y-=C*te,Z(b.x)&&(m.cx+=b.x),Z(b.y)&&(m.cy+=b.y)}),m.cx/=m.count||1,m.cy/=m.count||1,!0})})}applyCalculate(t){const n=this,r=n.comboMap,i=n.nodes,a={};i.forEach((s,c)=>{i.forEach((f,d)=>{if(c<d)return;const h=s.x-f.x||.005,v=s.y-f.y||.005;let m=h*h+v*v;const g=Math.sqrt(m);m<1&&(m=g),a[`${s.id}-${f.id}`]={vx:h,vy:v,vl2:m,vl:g},a[`${f.id}-${s.id}`]={vl2:m,vl:g,vx:-h,vy:-v}})}),n.updateComboSizes(r),n.calRepulsive(t,a),n.calAttractive(t,a),n.preventComboOverlap&&n.comboNonOverlapping(t,r)}updateComboSizes(t){const n=this,r=n.comboTrees,i=n.nodeMap,a=n.nodeSize,o=n.comboSpacing,s=n.comboPadding;(r||[]).forEach(c=>{const f=[];Ae(c,d=>{if(d.itemType==="node")return!0;const h=t[d.id];if(!h)return!1;const v=d.children;v&&v.forEach(_=>{!t[_.id]&&!i[_.id]||f.push(_)}),h.minX=Infinity,h.minY=Infinity,h.maxX=-Infinity,h.maxY=-Infinity,f.forEach(_=>{if(_.itemType!=="node")return!0;const y=i[_.id];if(!y)return!0;const E=a(y),b=y.x-E,A=y.y-E,C=y.x+E,R=y.y+E;h.minX>b&&(h.minX=b),h.minY>A&&(h.minY=A),h.maxX<C&&(h.maxX=C),h.maxY<R&&(h.maxY=R)});let m=n.oriComboMap[d.id].size||10;H(m)&&(m=m[0]);const g=Math.max(h.maxX-h.minX,h.maxY-h.minY,m);return h.r=g/2+o(h)/2+s(h),!0})})}comboNonOverlapping(t,n){const r=this,i=r.comboTree,a=r.comboCollideStrength,o=r.indexMap,s=r.nodeMap;Ae(i,c=>{if(!n[c.id]&&!s[c.id]&&c.id!=="comboTreeRoot")return!1;const f=c.children;return f&&f.length>1&&f.forEach((d,h)=>{if(d.itemType==="node")return!1;const v=n[d.id];!v||f.forEach((m,g)=>{if(h<=g||m.itemType==="node")return!1;const _=n[m.id];if(!_)return!1;const y=v.cx-_.cx||.005,E=v.cy-_.cy||.005,b=y*y+E*E,A=v.r||1,C=_.r||1,R=A+C,W=C*C,te=A*A;if(b<R*R){const Q=d.children;if(!Q||Q.length===0)return!1;const re=m.children;if(!re||re.length===0)return!1;const de=Math.sqrt(b),Ce=(R-de)/de*a,ie=y*Ce,Ge=E*Ce,We=W/(te+W),It=1-We;Q.forEach(gn=>{if(gn.itemType!=="node")return!1;if(!s[gn.id])return;const pn=o[gn.id];re.forEach(bn=>{if(bn.itemType!=="node"||!s[bn.id])return!1;const vr=o[bn.id];t[pn].x+=ie*We,t[pn].y+=Ge*We,t[vr].x-=ie*It,t[vr].y-=Ge*It})})}})}),!0})}calRepulsive(t,n){const r=this,i=r.nodes,a=r.width*r.optimizeRangeFactor,o=r.nodeStrength,s=r.alpha,c=r.nodeCollideStrength,f=r.preventNodeOverlap,d=r.nodeSize,h=r.nodeSpacing,v=r.depthRepulsiveForceScale,m=r.center;i.forEach((g,_)=>{if(!(!g.x||!g.y)){if(m){const y=r.gravity,E=g.x-m[0]||.005,b=g.y-m[1]||.005,A=Math.sqrt(E*E+b*b);t[_].x-=E*y*s/A,t[_].y-=b*y*s/A}i.forEach((y,E)=>{if(_===E||!y.x||!y.y)return;const{vl2:b,vl:A}=n[`${g.id}-${y.id}`];if(A>a)return;const{vx:C,vy:R}=n[`${g.id}-${y.id}`];let W=Math.log(Math.abs(y.depth-g.depth)/10)+1||1;W=W<1?1:W,y.comboId!==g.comboId&&(W+=1);const te=W?Math.pow(v,W):1,Q=o(y)*s/b*te;if(t[_].x+=C*Q,t[_].y+=R*Q,_<E&&f){const re=d(g)+h(g)||1,de=d(y)+h(y)||1,Ce=re+de;if(b<Ce*Ce){const ie=(Ce-A)/A*c,Ge=de*de;let We=Ge/(re*re+Ge);const It=C*ie,gn=R*ie;t[_].x+=It*We,t[_].y+=gn*We,We=1-We,t[E].x-=It*We,t[E].y-=gn*We}}})}})}calAttractive(t,n){const r=this,i=r.edges,a=r.linkDistance,o=r.alpha,s=r.edgeStrength,c=r.bias,f=r.depthAttractiveForceScale;i.forEach((d,h)=>{const v=ke(d,"source"),m=ke(d,"target");if(!v||!m||v===m)return;const g=r.indexMap[v],_=r.indexMap[m],y=r.nodeMap[v],E=r.nodeMap[m];if(!y||!E)return;let b=y.depth===E.depth?0:Math.log(Math.abs(y.depth-E.depth)/10);y.comboId===E.comboId&&(b=b/2);let A=b?Math.pow(f,b):1;if(y.comboId!==E.comboId&&A===1?A=f/2:y.comboId===E.comboId&&(A=2),!Z(E.x)||!Z(y.x)||!Z(E.y)||!Z(y.y))return;const{vl:C,vx:R,vy:W}=n[`${m}-${v}`],te=(C-a(d))/C*o*s(d)*A,Q=R*te,re=W*te,de=c[h];t[_].x-=Q*de,t[_].y-=re*de,t[g].x+=Q*(1-de),t[g].y+=re*(1-de)})}getType(){return"comboForce"}}class nR extends jt{constructor(t){super();this.center=[0,0],this.nodes=[],this.edges=[],this.combos=[],this.comboEdges=[],this.comboPadding=10,this.comboTrees=[],this.updateCfg(t)}getDefaultCfg(){return{}}execute(){const t=this,n=t.nodes,r=t.center;if(!n||n.length===0){t.onLayoutEnd&&t.onLayoutEnd();return}if(n.length===1){n[0].x=r[0],n[0].y=r[1],t.onLayoutEnd&&t.onLayoutEnd();return}t.initVals(),t.run(),t.onLayoutEnd&&t.onLayoutEnd()}run(){var t;const n=this,{nodes:r,edges:i,combos:a,comboEdges:o,center:s}=n,c={};r.forEach(E=>{c[E.id]=E});const f={};a.forEach(E=>{f[E.id]=E});const d=n.getInnerGraphs(c),h=[],v=[],m={};let g=!0;this.comboTrees.forEach(E=>{const b=d[E.id],A=Object.assign(Object.assign({},E),{x:b.x||f[E.id].x,y:b.y||f[E.id].y,fx:b.fx||f[E.id].fx,fy:b.fy||f[E.id].fy,mass:b.mass||f[E.id].mass,size:b.size});v.push(A),!isNaN(A.x)&&A.x!==0&&!isNaN(A.y)&&A.y!==0?g=!1:(A.x=Math.random()*100,A.y=Math.random()*100),h.push(E.id),Ae(E,C=>(C.id!==E.id&&(m[C.id]=E.id),!0))}),r.forEach(E=>{if(E.comboId&&f[E.comboId])return;const b=Object.assign({},E);v.push(b),!isNaN(b.x)&&b.x!==0&&!isNaN(b.y)&&b.y!==0?g=!1:(b.x=Math.random()*100,b.y=Math.random()*100),h.push(E.id)});const _=[];if(i.concat(o).forEach(E=>{const b=m[E.source]||E.source,A=m[E.target]||E.target;b!==A&&h.includes(b)&&h.includes(A)&&_.push({source:b,target:A})}),v==null?void 0:v.length){if(v.length===1)v[0].x=s[0],v[0].y=s[1];else{const E={nodes:v,edges:_},b=this.outerLayout||new fi({gravity:1,factor:2,linkDistance:(C,R,W)=>{var te,Q;const re=((((te=R.size)===null||te===void 0?void 0:te[0])||30)+(((Q=W.size)===null||Q===void 0?void 0:Q[0])||30))/2;return Math.min(re*1.5,700)}}),A=(t=b.getType)===null||t===void 0?void 0:t.call(b);b.updateCfg({center:s,kg:5,preventOverlap:!0,animate:!1}),g&&Ri[A]&&(v.length<100?new y1:new mn).layout(E),b.layout(E)}v.forEach(E=>{const b=d[E.id];if(!b){const A=c[E.id];A&&(A.x=E.x,A.y=E.y);return}b.visited=!0,b.x=E.x,b.y=E.y,b.nodes.forEach(A=>{A.x+=E.x,A.y+=E.y})})}const y=Object.keys(d);for(let E=y.length-1;E>=0;E--){const b=y[E],A=d[b];!A||(A.nodes.forEach(C=>{A.visited||(C.x+=A.x||0,C.y+=A.y||0),c[C.id]&&(c[C.id].x=C.x,c[C.id].y=C.y)}),f[b]&&(f[b].x=A.x,f[b].y=A.y))}return{nodes:r,edges:i,combos:a,comboEdges:o}}getInnerGraphs(t){const n=this,{comboTrees:r,nodeSize:i,edges:a,comboPadding:o,spacing:s}=n,c={},f=this.innerLayout||new g1({sortBy:"id"});return f.center=[0,0],f.preventOverlap=!0,f.nodeSpacing=s,(r||[]).forEach(d=>{Ae(d,h=>{var v;let m=(o==null?void 0:o(h))||10;if(H(m)&&(m=Math.max(...m)),(v=h.children)===null||v===void 0?void 0:v.length){const g=h.children.map(te=>{if(te.itemType==="combo")return c[te.id];const Q=t[te.id]||{};return Object.assign(Object.assign({},Q),te)}),_=g.map(te=>te.id),y={nodes:g,edges:a.filter(te=>_.includes(te.source)&&_.includes(te.target))};let E=Infinity;g.forEach(te=>{var Q;te.size||(te.size=((Q=c[te.id])===null||Q===void 0?void 0:Q.size)||(i==null?void 0:i(te))||[30,30]),Z(te.size)&&(te.size=[te.size,te.size]),E>te.size[0]&&(E=te.size[0]),E>te.size[1]&&(E=te.size[1])}),f.layout(y);const{minX:b,minY:A,maxX:C,maxY:R}=xt(g),W=Math.max(C-b,R-A,E)+m*2;c[h.id]={id:h.id,nodes:g,size:[W,W]}}else if(h.itemType==="combo"){const g=m?[m*2,m*2]:[30,30];c[h.id]={id:h.id,nodes:[],size:g}}return!0})}),c}initVals(){const t=this,n=t.nodeSize,r=t.spacing;let i,a;if(Z(r)?a=()=>r:pt(r)?a=r:a=()=>0,this.spacing=a,!n)i=c=>{const f=a(c);return c.size?H(c.size)?((c.size[0]>c.size[1]?c.size[0]:c.size[1])+f)/2:me(c.size)?((c.size.width>c.size.height?c.size.width:c.size.height)+f)/2:(c.size+f)/2:10+f/2};else if(pt(n))i=c=>{const f=n(c),d=a(c);return H(c.size)?((c.size[0]>c.size[1]?c.size[0]:c.size[1])+d)/2:((f||10)+d)/2};else if(H(n)){const f=(n[0]>n[1]?n[0]:n[1])/2;i=d=>f+a(d)/2}else{const c=n/2;i=f=>c+a(f)/2}this.nodeSize=i;const o=t.comboPadding;let s;Z(o)?s=()=>o:H(o)?s=()=>Math.max.apply(null,o):pt(o)?s=o:s=()=>0,this.comboPadding=s}getType(){return"comboCombined"}}class ky{constructor(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}distanceTo(t){const n=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(n,r)}setPos(t,n){this.rx=t,this.ry=n}resetForce(){this.fx=0,this.fy=0}addForce(t){const n=t.rx-this.rx,r=t.ry-this.ry;let i=Math.hypot(n,r);i=i<1e-4?1e-4:i;const a=this.g*(this.degree+1)*(t.degree+1)/i;this.fx+=a*n/i,this.fy+=a*r/i}in(t){return t.contains(this.rx,this.ry)}add(t){const n=this.mass+t.mass,r=(this.rx*this.mass+t.rx*t.mass)/n,i=(this.ry*this.mass+t.ry*t.mass)/n,a=this.degree+t.degree,o={rx:r,ry:i,mass:n,degree:a};return new ky(o)}}class Dh{constructor(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}getLength(){return this.length}contains(t,n){const r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&n<=this.ymid+r&&n>=this.ymid-r}NW(){const t=this.xmid-this.length/4,n=this.ymid+this.length/4,r=this.length/2,i={xmid:t,ymid:n,length:r};return new Dh(i)}NE(){const t=this.xmid+this.length/4,n=this.ymid+this.length/4,r=this.length/2,i={xmid:t,ymid:n,length:r};return new Dh(i)}SW(){const t=this.xmid-this.length/4,n=this.ymid-this.length/4,r=this.length/2,i={xmid:t,ymid:n,length:r};return new Dh(i)}SE(){const t=this.xmid+this.length/4,n=this.ymid-this.length/4,r=this.length/2,i={xmid:t,ymid:n,length:r};return new Dh(i)}}class Ph{constructor(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,t!=null&&(this.quad=t)}insert(t){if(this.body==null){this.body=t;return}this._isExternal()?(this.quad&&(this.NW=new Ph(this.quad.NW()),this.NE=new Ph(this.quad.NE()),this.SW=new Ph(this.quad.SW()),this.SE=new Ph(this.quad.SE())),this._putBody(this.body),this._putBody(t),this.body=this.body.add(t)):(this.body=this.body.add(t),this._putBody(t))}_putBody(t){!this.quad||(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))}_isExternal(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null}updateForce(t){if(!(this.body==null||t===this.body))if(this._isExternal())t.addForce(this.body);else{const n=this.quad?this.quad.getLength():0,r=this.body.distanceTo(t);n/r<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t))}}}class rR extends jt{constructor(t){super();this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.kr=5,this.kg=1,this.mode="normal",this.preventOverlap=!1,this.dissuadeHubs=!1,this.barnesHut=void 0,this.maxIteration=0,this.ks=.1,this.ksmax=10,this.tao=.1,this.onLayoutEnd=()=>{},this.prune=void 0,this.updateCfg(t)}getDefaultCfg(){return{}}execute(){const t=this,{nodes:n,onLayoutEnd:r,prune:i}=t;let a=t.maxIteration;!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight);const o=[],s=n.length;for(let c=0;c<s;c+=1){const f=n[c];let d=10,h=10;Z(f.size)&&(d=f.size,h=f.size),H(f.size)?(isNaN(f.size[0])||(d=f.size[0]),isNaN(f.size[1])||(h=f.size[1])):me(f.size)&&(d=f.size.width,h=f.size.height),t.getWidth&&!isNaN(t.getWidth(f))&&(h=t.getWidth(f)),t.getHeight&&!isNaN(t.getHeight(f))&&(d=t.getHeight(f));const v=Math.max(d,h);o.push(v)}t.barnesHut===void 0&&s>250&&(t.barnesHut=!0),t.prune===void 0&&s>100&&(t.prune=!0),this.maxIteration===0&&!t.prune?(a=250,s<=200&&s>100?a=1e3:s>200&&(a=1200),this.maxIteration=a):this.maxIteration===0&&i&&(a=100,s<=200&&s>100?a=500:s>200&&(a=950),this.maxIteration=a),t.kr||(t.kr=50,s>100&&s<=500?t.kr=20:s>500&&(t.kr=1)),t.kg||(t.kg=20,s>100&&s<=500?t.kg=10:s>500&&(t.kg=1)),this.nodes=t.updateNodesByForces(o),r()}updateNodesByForces(t){const n=this,{edges:r,maxIteration:i}=n;let a=n.nodes;const o=r.filter(g=>{const _=ke(g,"source"),y=ke(g,"target");return _!==y}),s=a.length,c=o.length,f=[],d={},h={},v=[];for(let g=0;g<s;g+=1)d[a[g].id]=g,f[g]=0,(a[g].x===void 0||isNaN(a[g].x))&&(a[g].x=Math.random()*1e3),(a[g].y===void 0||isNaN(a[g].y))&&(a[g].y=Math.random()*1e3),v.push({x:a[g].x,y:a[g].y});for(let g=0;g<c;g+=1){let _,y,E=0,b=0;for(let A=0;A<s;A+=1){const C=ke(o[g],"source"),R=ke(o[g],"target");a[A].id===C?(_=a[A],E=A):a[A].id===R&&(y=a[A],b=A),h[g]={sourceIdx:E,targetIdx:b}}_&&(f[d[_.id]]+=1),y&&(f[d[y.id]]+=1)}let m=i;if(a=this.iterate(m,d,h,c,f,t),n.prune){for(let g=0;g<c;g+=1)f[h[g].sourceIdx]<=1?(a[h[g].sourceIdx].x=a[h[g].targetIdx].x,a[h[g].sourceIdx].y=a[h[g].targetIdx].y):f[h[g].targetIdx]<=1&&(a[h[g].targetIdx].x=a[h[g].sourceIdx].x,a[h[g].targetIdx].y=a[h[g].sourceIdx].y);n.prune=!1,n.barnesHut=!1,m=100,a=this.iterate(m,d,h,c,f,t)}return a}iterate(t,n,r,i,a,o){const s=this;let{nodes:c}=s;const{kr:f,preventOverlap:d}=s,{barnesHut:h}=s,v=c.length;let m=0;const g=100;let _=t;const y=50;let E=[];const b=[],A=[];for(let C=0;C<v;C+=1)if(E[2*C]=0,E[2*C+1]=0,h){const R={id:C,rx:c[C].x,ry:c[C].y,mass:1,g:f,degree:a[C]};A[C]=new ky(R)}for(;_>0;){for(let R=0;R<v;R+=1)b[2*R]=E[2*R],b[2*R+1]=E[2*R+1],E[2*R]=0,E[2*R+1]=0;E=this.getAttrForces(_,y,i,n,r,a,o,E),h&&(d&&_>y||!d)?E=this.getOptRepGraForces(E,A,a):E=this.getRepGraForces(_,y,E,g,o,a);const C=this.updatePos(E,b,m,a);c=C.nodes,m=C.sg,_--,s.tick&&s.tick()}return c}getAttrForces(t,n,r,i,a,o,s,c){const f=this,{nodes:d,preventOverlap:h,dissuadeHubs:v,mode:m,prune:g}=f;for(let _=0;_<r;_+=1){const y=d[a[_].sourceIdx],E=a[_].sourceIdx,b=d[a[_].targetIdx],A=a[_].targetIdx;if(g&&(o[E]<=1||o[A]<=1))continue;const C=[b.x-y.x,b.y-y.y];let R=Math.hypot(C[0],C[1]);R=R<1e-4?1e-4:R,C[0]=C[0]/R,C[1]=C[1]/R,h&&t<n&&(R=R-s[E]-s[A]);let W=R,te=W;m==="linlog"&&(W=Math.log(1+R),te=W),v&&(W=R/o[E],te=R/o[A]),h&&t<n&&R<=0?(W=0,te=0):h&&t<n&&R>0&&(W=R,te=R),c[2*i[y.id]]+=W*C[0],c[2*i[b.id]]-=te*C[0],c[2*i[y.id]+1]+=W*C[1],c[2*i[b.id]+1]-=te*C[1]}return c}getRepGraForces(t,n,r,i,a,o){const s=this,{nodes:c,preventOverlap:f,kr:d,kg:h,center:v,prune:m}=s,g=c.length;for(let _=0;_<g;_+=1){for(let A=_+1;A<g;A+=1){if(m&&(o[_]<=1||o[A]<=1))continue;const C=[c[A].x-c[_].x,c[A].y-c[_].y];let R=Math.hypot(C[0],C[1]);R=R<1e-4?1e-4:R,C[0]=C[0]/R,C[1]=C[1]/R,f&&t<n&&(R=R-a[_]-a[A]);let W=d*(o[_]+1)*(o[A]+1)/R;f&&t<n&&R<0?W=i*(o[_]+1)*(o[A]+1):f&&t<n&&R===0?W=0:f&&t<n&&R>0&&(W=d*(o[_]+1)*(o[A]+1)/R),r[2*_]-=W*C[0],r[2*A]+=W*C[0],r[2*_+1]-=W*C[1],r[2*A+1]+=W*C[1]}const y=[c[_].x-v[0],c[_].y-v[1]],E=Math.hypot(y[0],y[1]);y[0]=y[0]/E,y[1]=y[1]/E;const b=h*(o[_]+1);r[2*_]-=b*y[0],r[2*_+1]-=b*y[1]}return r}getOptRepGraForces(t,n,r){const i=this,{nodes:a,kg:o,center:s,prune:c}=i,f=a.length;let d=9e10,h=-9e10,v=9e10,m=-9e10;for(let b=0;b<f;b+=1)c&&r[b]<=1||(n[b].setPos(a[b].x,a[b].y),a[b].x>=h&&(h=a[b].x),a[b].x<=d&&(d=a[b].x),a[b].y>=m&&(m=a[b].y),a[b].y<=v&&(v=a[b].y));const g=Math.max(h-d,m-v),_={xmid:(h+d)/2,ymid:(m+v)/2,length:g,massCenter:s,mass:f},y=new Dh(_),E=new Ph(y);for(let b=0;b<f;b+=1)c&&r[b]<=1||n[b].in(y)&&E.insert(n[b]);for(let b=0;b<f;b+=1){if(c&&r[b]<=1)continue;n[b].resetForce(),E.updateForce(n[b]),t[2*b]-=n[b].fx,t[2*b+1]-=n[b].fy;const A=[a[b].x-s[0],a[b].y-s[1]];let C=Math.hypot(A[0],A[1]);C=C<1e-4?1e-4:C,A[0]=A[0]/C,A[1]=A[1]/C;const R=o*(r[b]+1);t[2*b]-=R*A[0],t[2*b+1]-=R*A[1]}return t}updatePos(t,n,r,i){const a=this,{nodes:o,ks:s,tao:c,prune:f,ksmax:d}=a,h=o.length,v=[],m=[];let g=0,_=0;for(let E=0;E<h;E+=1){if(f&&i[E]<=1)continue;const b=[t[2*E]-n[2*E],t[2*E+1]-n[2*E+1]],A=Math.hypot(b[0],b[1]),C=[t[2*E]+n[2*E],t[2*E+1]+n[2*E+1]],R=Math.hypot(C[0],C[1]);v[E]=A,m[E]=R/2,g+=(i[E]+1)*v[E],_+=(i[E]+1)*m[E]}const y=r;r=c*_/g,y!==0&&(r=r>1.5*y?1.5*y:r);for(let E=0;E<h;E+=1){if(f&&i[E]<=1||Z(o[E].fx)&&Z(o[E].fy))continue;let b=s*r/(1+r*Math.sqrt(v[E])),A=Math.hypot(t[2*E],t[2*E+1]);A=A<1e-4?1e-4:A;const C=d/A;b=b>C?C:b;const R=b*t[2*E],W=b*t[2*E+1];o[E].x+=R,o[E].y+=W}return{nodes:o,sg:r}}}class rf{constructor(){this.cells=[],this.columnNum=0,this.rowNum=0,this.additionColumn=[],this.additionRow=[]}init(t,n,r){this.cells=[],this.CELL_W=r.CELL_W||rf.DEFAULT_CELL_W,this.CELL_H=r.CELL_H||rf.DEFAULT_CELL_H,this.columnNum=Math.ceil(t/this.CELL_W),this.rowNum=Math.ceil(n/this.CELL_H),rf.MIN_DIST=Math.pow(t,2)+Math.pow(n,2);for(let i=0;i<this.columnNum;i++){const a=[];for(let o=0;o<this.rowNum;o++){const s={dx:i,dy:o,x:i*this.CELL_W,y:o*this.CELL_H,occupied:!1};a.push(s)}this.cells.push(a)}}findGridByNodeId(t){var n,r;for(let i=0;i<this.columnNum;i++)for(let a=0;a<this.rowNum;a++)if(this.cells[i][a].node&&((r=(n=this.cells[i][a])===null||n===void 0?void 0:n.node)===null||r===void 0?void 0:r.id)===t)return{column:i,row:a};return null}sqdist(t,n){return Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)}occupyNearest(t){let n=rf.MIN_DIST,r,i=null;for(let a=0;a<this.columnNum;a++)for(let o=0;o<this.rowNum;o++)!this.cells[a][o].occupied&&(r=this.sqdist(t,this.cells[a][o]))<n&&(n=r,i=this.cells[a][o]);return i&&(i.occupied=!0),i}insertColumn(t,n){if(!(n<=0)){for(let r=0;r<n;r++){this.cells[r+this.columnNum]=[];for(let i=0;i<this.rowNum;i++)this.cells[r+this.columnNum][i]={dx:r,dy:i,x:r*this.CELL_W,y:i*this.CELL_H,occupied:!1,node:null}}for(let r=this.columnNum-1;r>t;r--)for(let i=0;i<this.rowNum;i++)this.cells[r+n][i]=Object.assign(Object.assign({},this.cells[r][i]),{x:(r+n)*this.CELL_W,y:i*this.CELL_H}),this.cells[r][i]={x:r*this.CELL_W,y:i*this.CELL_H,occupied:!0,node:null};for(let r=0;r<this.additionColumn.length;r++)this.additionColumn[r]>=t&&(this.additionColumn[r]+=n);for(let r=0;r<n;r++)this.additionColumn.push(t+r+1);this.columnNum+=n}}insertRow(t,n){if(!(n<=0)){for(let r=0;r<n;r++)for(let i=0;i<this.columnNum;i++)this.cells[i][r+this.rowNum]={dx:i,dy:r,x:i*this.CELL_W,y:r*this.CELL_H,occupied:!1,node:null};for(let r=0;r<this.columnNum;r++)for(let i=this.rowNum-1;i>t;i--)this.cells[r][i+n]=Object.assign(Object.assign({},this.cells[r][i]),{dx:r,dy:i+n,x:r*this.CELL_W,y:(i+n)*this.CELL_H}),this.cells[r][i]={dx:r,dy:i,x:r*this.CELL_W,y:i*this.CELL_H,occupied:!1,node:null};for(let r=0;r<this.additionRow.length;r++)this.additionRow[r]>=t&&(this.additionRow[r]+=n);for(let r=0;r<n;r++)this.additionRow.push(t+r+1);this.rowNum+=n}}getNodes(){const t=[];for(let n=0;n<this.columnNum;n++)for(let r=0;r<this.rowNum;r++)this.cells[n][r].node&&t.push(this.cells[n][r]);return t}}rf.MIN_DIST=50,rf.DEFAULT_CELL_W=80,rf.DEFAULT_CELL_H=80;function iR(e,t){if(!e.nodes||e.nodes.length===0)return e;const n=t.width,r=t.height,i=t.nodeMinGap;let a=1e4,o=1e4;e.nodes.forEach(c=>{const f=c.size[0]||50,d=c.size[1]||50;a=Math.min(f,a),o=Math.min(d,o)});const s=new rf;s.init(n,r,{CELL_H:o,CELL_W:a}),e.nodes.forEach(c=>{const f=s.occupyNearest(c);f&&(f.node={id:c.id,size:c.size},c.x=f.x,c.y=f.y,c.dx=f.dx,c.dy=f.dy)});for(let c=0;c<e.nodes.length;c++){const f=e.nodes[c],d=s.findGridByNodeId(f.id);if(!d)throw new Error("can not find node cell");const{column:h,row:v}=d;if(f.size[0]+i>a){const m=Math.ceil((f.size[0]+i)/a)-1;let g=m;for(let _=0;_<m&&(s.additionColumn.indexOf(h+_+1)>-1&&!s.cells[h+_+1][v].node);_++)g--;s.insertColumn(h,g)}if(f.size[1]+i>o){const m=Math.ceil((f.size[1]+i)/o)-1;let g=m;for(let _=0;_<m&&(s.additionRow.indexOf(v+_+1)>-1&&!s.cells[h][v+_+1].node);_++)g--;s.insertRow(v,g)}}for(let c=0;c<s.columnNum;c++)for(let f=0;f<s.rowNum;f++){const d=s.cells[c][f];if(d.node){const h=e.nodes.find(v=>{var m;return v.id===((m=d==null?void 0:d.node)===null||m===void 0?void 0:m.id)});h&&(h.x=d.x+h.size[0]/2,h.y=d.y+h.size[1]/2)}}}const Ux=1200,Bx=800,om=1e7,Yv=10,zx=3.141592653589793,Fy=1.5707963267948966,aR=zx*.375,oR=zx*.625,sm=new Map,sR=10,uR=10;let Uy=.8;const Wx=.1,cR=.5;function fR(e,t,n){const r=e.x-e.size[0]/2,i=e.y-e.size[1]/2,a=e.x+e.size[0]/2,o=e.y+e.size[1]/2,s=t.x-t.size[0]/2,c=t.y-t.size[1]/2,f=t.x+t.size[0]/2,d=t.y+t.size[1]/2,h=e.x,v=e.y,m=t.x,g=t.y,_=m-h,y=Math.atan2(_,g-v);let E=0,b=0,A=0,C=0;y>Fy?(b=i-d,E=s-a,A=parseFloat(b?(b/Math.cos(y)).toFixed(2):E.toFixed(2)),C=parseFloat(E?(E/Math.sin(y)).toFixed(2):b.toFixed(2))):0<y&&y<=Fy?(b=c-o,E=s-a,b>E?A=C=parseFloat(b?(b/Math.cos(y)).toFixed(2):E.toFixed(2)):A=C=parseFloat(E?(E/Math.sin(y)).toFixed(2):b.toFixed(2))):y<-Fy?(b=i-d,E=-(f-r),b>E?A=C=parseFloat(b?(b/Math.cos(y)).toFixed(2):E.toFixed(2)):A=C=parseFloat(E?(E/Math.sin(y)).toFixed(2):b.toFixed(2))):(b=c-o,Math.abs(_)>(a-r)/2?E=r-f:E=_,b>E?A=C=parseFloat(b?(b/Math.cos(y)).toFixed(2):E.toFixed(2)):A=C=parseFloat(E&&y!==0?(E/Math.sin(y)).toFixed(2):b.toFixed(2)));const R=parseFloat(y.toFixed(2));let W=n;return n&&(W=aR<R&&R<oR),{distance:Math.abs(A<C?A:C),isHoriz:W}}function Vx(e,t){const r=(sm.get(e.id)||[]).find(te=>te.source===t.id||te.target===t.id),i=e.size[0]*e.size[1],a=t.size[0]*t.size[1],o=i>a?t:e,s=i>a?e:t,c=o.x-o.size[0]/2,f=o.y-o.size[1]/2,d=o.x+o.size[0]/2,h=o.y+o.size[1]/2,v=s.x-s.size[0]/2,m=s.y-s.size[1]/2,g=s.x+s.size[0]/2,_=s.y+s.size[1]/2,y=o.x,E=o.y,b=s.x,A=s.y,C=d>=v&&g>=c&&h>=m&&_>=f;let R=0,W=0;if(C){W=Math.sqrt(Math.pow(b-y,2)+Math.pow(A-E,2));const te=c>v?c:v,Q=f>m?f:m,re=d<g?d:g,de=h<_?h:_,Ce=re-te,ie=de-Q,Ge=Ce*ie;W===0&&(W=1e-7),R=Yv*1/W*100+Ge,R*=om}else{let te=!1;const Q=fR(o,s,te);W=Q.distance,te=Q.isHoriz,W<=Yv?W!==0?r?R+=Yv+om*1/W:R+=Yv+om*Yv/W:R+=om:(R+=W,r&&(R+=W*W))}return R}function Zx(e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];(r.x<0||r.y<0||r.x>Ux||r.y>Bx)&&(t+=1e12);for(let i=n+1;i<e.length;i++)t+=Vx(r,e[i])}return t}function lR(e,t,n,r){const i=new Map;n.forEach((c,f)=>{i.set(c.id,c)});const a=r.filter(c=>c.source===e.id||c.target===e.id)||[],o=[];a.forEach(c=>{const f=c.source===e.id?c.target:c.source,d=i.get(f);d&&o.push(d)});let s=!0;for(let c=0;c<o.length;c++){const f=o[c],d=Math.atan((e.y-f.y)/(f.x-e.y))*180,h=Math.atan((t.y-f.y)/(f.x-t.y))*180,v=d<30||d>150,m=h<30||h>150,g=d>70&&d<110,_=h>70&&h<110;if(v&&!m||d*h<0){s=!1;break}else if(g&&!_||d*h<0){s=!1;break}else if((f.x-e.x)*(f.x-t.x)<0){s=!1;break}else if((f.y-e.y)*(f.y-t.y)<0){s=!1;break}}return s}function dR(e,t){let n=!1;const r=1,i=sR*r,a=uR*r,o=[i,-i,0,0],s=[0,0,a,-a];for(let c=0;c<e.length;++c){const f=e[c];let d=jx(f,e);for(let h=0;h<o.length;h++)if(lR(f,{x:f.x+o[h],y:f.y+s[h]},e,t)){f.x+=o[h],f.y+=s[h];const m=jx(f,e),g=Math.random();m<d||g<Uy&&g>Wx?(d=m,n=!0):(f.x-=o[h],f.y-=s[h])}}return Uy>Wx&&(Uy*=cR),n?Zx(e):0}function jx(e,t){let n=0;(e.x<0||e.y<0||e.x+e.size[0]+20>Ux||e.y+e.size[1]+20>Bx)&&(n+=1e12);for(let r=0;r<t.length;++r)e.id!==t[r].id&&(n+=Vx(e,t[r]));return n}function hR(e,t){if(e.length===0)return{nodes:e,edges:t};e.forEach(c=>{const f=t.filter(d=>d.source===c.id||d.target===c.id);sm.set(c,f)}),e.sort((c,f)=>{var d,h;return((d=sm.get(c.id))===null||d===void 0?void 0:d.length)-((h=sm.get(f.id))===null||h===void 0?void 0:h.length)});let n=Zx(e),r=20,i=1,a=0;const o=50;let s=0;for(;r>0&&(s++,!(s>=o));){const c=dR(e,t);c!==0&&(a=c),i=a-n,n=a,i===0?--r:r=20}return e.forEach(c=>{c.x=c.x-c.size[0]/2,c.y=c.y-c.size[1]/2}),{nodes:e,edges:t}}var vR=hR;function pR(e,t){const{nodes:n,edges:r}=e,i=t.width,a=t.height;if(!(n==null?void 0:n.length))return Promise.resolve();const o=[];n.forEach(g=>{if(r.filter(y=>y.source===g.id||y.target===g.id).length>1){const y=Object.assign({},g);delete y.size,o.push(y)}});const s=[];r.forEach(g=>{const _=o.find(E=>E.id===g.source),y=o.find(E=>E.id===g.target);_&&y&&s.push(g)});const c=new Os({type:"dagre",ranksep:t.nodeMinGap,nodesep:t.nodeMinGap}),{nodes:f}=c.layout({nodes:o,edges:s});n.forEach(g=>{const _=(f||[]).find(y=>y.id===g.id);g.x=(_==null?void 0:_.x)||i/2,g.y=(_==null?void 0:_.y)||a/2});const d=JSON.parse(JSON.stringify(n)),h=JSON.parse(JSON.stringify(r)),v=yn().nodes(d).force("link",Li(h).id(g=>g.id).distance(g=>s.find(y=>y.source===g.source&&y.target===g.target)?30:20)).force("charge",rr()).force("center",cr(i/2,a/2)).force("x",Gi(i/2)).force("y",Ki(a/2)).alpha(.3).alphaDecay(.08).alphaMin(.001);return new Promise(g=>{v.on("end",()=>{n.forEach(R=>{const W=d.find(te=>te.id===R.id);W&&(R.x=W.x,R.y=W.y)});const _=Math.min(...n.map(R=>R.x)),y=Math.max(...n.map(R=>R.x)),E=Math.min(...n.map(R=>R.y)),b=Math.max(...n.map(R=>R.y)),A=i/(y-_),C=a/(b-E);n.forEach(R=>{R.x!==void 0&&A<1&&(R.x=(R.x-_)*A),R.y!==void 0&&C<1&&(R.y=(R.y-E)*C)}),n.forEach(R=>{R.sizeTemp=R.size,R.size=[10,10]}),vR(n,r),n.forEach(R=>{R.size=R.sizeTemp||[],delete R.sizeTemp}),iR({nodes:n,edges:r},t),g()})})}class mR extends jt{constructor(t){super();this.width=300,this.height=300,this.nodeMinGap=50,this.onLayoutEnd=()=>{},t&&this.updateCfg(t)}getDefaultCfg(){return{width:300,height:300,nodeMinGap:50}}execute(){const t=this,n=t.nodes,r=t.edges;return n==null||n.forEach(i=>{i.size||(i.size=[50,50])}),pR({nodes:n,edges:r},{width:this.width,height:this.height,nodeMinGap:this.nodeMinGap}).then(()=>{t.onLayoutEnd&&t.onLayoutEnd()})}getType(){return"er"}}class gR extends jt{constructor(t){super();this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(t)}getDefaultCfg(){return{center:[0,0],width:300,height:300}}execute(){const t=this,n=t.nodes,r=.9,i=t.center;return!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight),n&&n.forEach(a=>{a.x=(Math.random()-.5)*r*t.width+i[0],a.y=(Math.random()-.5)*r*t.height+i[1]}),t.onLayoutEnd&&t.onLayoutEnd(),{nodes:n,edges:this.edges}}getType(){return"random"}}class RN{constructor(t){const n=getLayoutByName(t.type);this.layoutInstance=new n(t)}layout(t){return this.layoutInstance.layout(t)}updateCfg(t){this.layoutInstance.updateCfg(t)}init(t){this.layoutInstance.init(t)}execute(){this.layoutInstance.execute()}getDefaultCfg(){return this.layoutInstance.getDefaultCfg()}destroy(){return this.layoutInstance.destroy()}}const MN={force:La,fruchterman:jS,forceAtlas2:rR,gForce:fi,force2:Ft,dagre:Os,dagreCompound:sS,circular:va,radial:VS,concentric:g1,grid:mn,mds:y1,comboForce:tR,comboCombined:nR,random:gR,"gForce-gpu":eR,"fruchterman-gpu":qC,er:mR}},59591:function(we,I,S){var N=S(50008).default;function x(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */we.exports=x=function(){return ee},we.exports.__esModule=!0,we.exports.default=we.exports;var ee={},V=Object.prototype,j=V.hasOwnProperty,H=typeof Symbol=="function"?Symbol:{},Z=H.iterator||"@@iterator",De=H.asyncIterator||"@@asyncIterator",he=H.toStringTag||"@@toStringTag";function me(L,nt,$t){return Object.defineProperty(L,nt,{value:$t,enumerable:!0,configurable:!0,writable:!0}),L[nt]}try{me({},"")}catch(L){me=function($t,ln,jt){return $t[ln]=jt}}function rt(L,nt,$t,ln){var jt=nt&&nt.prototype instanceof Yt?nt:Yt,mn=Object.create(jt.prototype),br=new pt(ln||[]);return mn._invoke=function(fi,Nr,pr){var ti="suspendedStart";return function(mr,zr){if(ti==="executing")throw new Error("Generator is already running");if(ti==="completed"){if(mr==="throw")throw zr;return $n()}for(pr.method=mr,pr.arg=zr;;){var Ha=pr.delegate;if(Ha){var Jn=St(Ha,pr);if(Jn){if(Jn===Gt)continue;return Jn}}if(pr.method==="next")pr.sent=pr._sent=pr.arg;else if(pr.method==="throw"){if(ti==="suspendedStart")throw ti="completed",pr.arg;pr.dispatchException(pr.arg)}else pr.method==="return"&&pr.abrupt("return",pr.arg);ti="executing";var Bi=ke(fi,Nr,pr);if(Bi.type==="normal"){if(ti=pr.done?"completed":"suspendedYield",Bi.arg===Gt)continue;return{value:Bi.arg,done:pr.done}}Bi.type==="throw"&&(ti="completed",pr.method="throw",pr.arg=Bi.arg)}}}(L,$t,br),mn}function ke(L,nt,$t){try{return{type:"normal",arg:L.call(nt,$t)}}catch(ln){return{type:"throw",arg:ln}}}ee.wrap=rt;var Gt={};function Yt(){}function dt(){}function ht(){}var vt={};me(vt,Z,function(){return this});var Ne=Object.getPrototypeOf,Ae=Ne&&Ne(Ne(en([])));Ae&&Ae!==V&&j.call(Ae,Z)&&(vt=Ae);var xt=ht.prototype=Yt.prototype=Object.create(vt);function at(L){["next","throw","return"].forEach(function(nt){me(L,nt,function($t){return this._invoke(nt,$t)})})}function tt(L,nt){function $t(jt,mn,br,fi){var Nr=ke(L[jt],L,mn);if(Nr.type!=="throw"){var pr=Nr.arg,ti=pr.value;return ti&&N(ti)=="object"&&j.call(ti,"__await")?nt.resolve(ti.__await).then(function(mr){$t("next",mr,br,fi)},function(mr){$t("throw",mr,br,fi)}):nt.resolve(ti).then(function(mr){pr.value=mr,br(pr)},function(mr){return $t("throw",mr,br,fi)})}fi(Nr.arg)}var ln;this._invoke=function(jt,mn){function br(){return new nt(function(fi,Nr){$t(jt,mn,fi,Nr)})}return ln=ln?ln.then(br,br):br()}}function St(L,nt){var $t=L.iterator[nt.method];if($t===void 0){if(nt.delegate=null,nt.method==="throw"){if(L.iterator.return&&(nt.method="return",nt.arg=void 0,St(L,nt),nt.method==="throw"))return Gt;nt.method="throw",nt.arg=new TypeError("The iterator does not provide a 'throw' method")}return Gt}var ln=ke($t,L.iterator,nt.arg);if(ln.type==="throw")return nt.method="throw",nt.arg=ln.arg,nt.delegate=null,Gt;var jt=ln.arg;return jt?jt.done?(nt[L.resultName]=jt.value,nt.next=L.nextLoc,nt.method!=="return"&&(nt.method="next",nt.arg=void 0),nt.delegate=null,Gt):jt:(nt.method="throw",nt.arg=new TypeError("iterator result is not an object"),nt.delegate=null,Gt)}function Mt(L){var nt={tryLoc:L[0]};1 in L&&(nt.catchLoc=L[1]),2 in L&&(nt.finallyLoc=L[2],nt.afterLoc=L[3]),this.tryEntries.push(nt)}function zt(L){var nt=L.completion||{};nt.type="normal",delete nt.arg,L.completion=nt}function pt(L){this.tryEntries=[{tryLoc:"root"}],L.forEach(Mt,this),this.reset(!0)}function en(L){if(L){var nt=L[Z];if(nt)return nt.call(L);if(typeof L.next=="function")return L;if(!isNaN(L.length)){var $t=-1,ln=function jt(){for(;++$t<L.length;)if(j.call(L,$t))return jt.value=L[$t],jt.done=!1,jt;return jt.value=void 0,jt.done=!0,jt};return ln.next=ln}}return{next:$n}}function $n(){return{value:void 0,done:!0}}return dt.prototype=ht,me(xt,"constructor",ht),me(ht,"constructor",dt),dt.displayName=me(ht,he,"GeneratorFunction"),ee.isGeneratorFunction=function(L){var nt=typeof L=="function"&&L.constructor;return!!nt&&(nt===dt||(nt.displayName||nt.name)==="GeneratorFunction")},ee.mark=function(L){return Object.setPrototypeOf?Object.setPrototypeOf(L,ht):(L.__proto__=ht,me(L,he,"GeneratorFunction")),L.prototype=Object.create(xt),L},ee.awrap=function(L){return{__await:L}},at(tt.prototype),me(tt.prototype,De,function(){return this}),ee.AsyncIterator=tt,ee.async=function(L,nt,$t,ln,jt){jt===void 0&&(jt=Promise);var mn=new tt(rt(L,nt,$t,ln),jt);return ee.isGeneratorFunction(nt)?mn:mn.next().then(function(br){return br.done?br.value:mn.next()})},at(xt),me(xt,he,"Generator"),me(xt,Z,function(){return this}),me(xt,"toString",function(){return"[object Generator]"}),ee.keys=function(L){var nt=[];for(var $t in L)nt.push($t);return nt.reverse(),function ln(){for(;nt.length;){var jt=nt.pop();if(jt in L)return ln.value=jt,ln.done=!1,ln}return ln.done=!0,ln}},ee.values=en,pt.prototype={constructor:pt,reset:function(nt){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(zt),!nt)for(var $t in this)$t.charAt(0)==="t"&&j.call(this,$t)&&!isNaN(+$t.slice(1))&&(this[$t]=void 0)},stop:function(){this.done=!0;var nt=this.tryEntries[0].completion;if(nt.type==="throw")throw nt.arg;return this.rval},dispatchException:function(nt){if(this.done)throw nt;var $t=this;function ln(pr,ti){return br.type="throw",br.arg=nt,$t.next=pr,ti&&($t.method="next",$t.arg=void 0),!!ti}for(var jt=this.tryEntries.length-1;jt>=0;--jt){var mn=this.tryEntries[jt],br=mn.completion;if(mn.tryLoc==="root")return ln("end");if(mn.tryLoc<=this.prev){var fi=j.call(mn,"catchLoc"),Nr=j.call(mn,"finallyLoc");if(fi&&Nr){if(this.prev<mn.catchLoc)return ln(mn.catchLoc,!0);if(this.prev<mn.finallyLoc)return ln(mn.finallyLoc)}else if(fi){if(this.prev<mn.catchLoc)return ln(mn.catchLoc,!0)}else{if(!Nr)throw new Error("try statement without catch or finally");if(this.prev<mn.finallyLoc)return ln(mn.finallyLoc)}}}},abrupt:function(nt,$t){for(var ln=this.tryEntries.length-1;ln>=0;--ln){var jt=this.tryEntries[ln];if(jt.tryLoc<=this.prev&&j.call(jt,"finallyLoc")&&this.prev<jt.finallyLoc){var mn=jt;break}}mn&&(nt==="break"||nt==="continue")&&mn.tryLoc<=$t&&$t<=mn.finallyLoc&&(mn=null);var br=mn?mn.completion:{};return br.type=nt,br.arg=$t,mn?(this.method="next",this.next=mn.finallyLoc,Gt):this.complete(br)},complete:function(nt,$t){if(nt.type==="throw")throw nt.arg;return nt.type==="break"||nt.type==="continue"?this.next=nt.arg:nt.type==="return"?(this.rval=this.arg=nt.arg,this.method="return",this.next="end"):nt.type==="normal"&&$t&&(this.next=$t),Gt},finish:function(nt){for(var $t=this.tryEntries.length-1;$t>=0;--$t){var ln=this.tryEntries[$t];if(ln.finallyLoc===nt)return this.complete(ln.completion,ln.afterLoc),zt(ln),Gt}},catch:function(nt){for(var $t=this.tryEntries.length-1;$t>=0;--$t){var ln=this.tryEntries[$t];if(ln.tryLoc===nt){var jt=ln.completion;if(jt.type==="throw"){var mn=jt.arg;zt(ln)}return mn}}throw new Error("illegal catch attempt")},delegateYield:function(nt,$t,ln){return this.delegate={iterator:en(nt),resultName:$t,nextLoc:ln},this.method==="next"&&(this.arg=void 0),Gt}},ee}we.exports=x,we.exports.__esModule=!0,we.exports.default=we.exports},87757:function(we,I,S){var N=S(59591)();we.exports=N;try{regeneratorRuntime=N}catch(x){typeof globalThis=="object"?globalThis.regeneratorRuntime=N:Function("r","regeneratorRuntime = r")(N)}},63252:function(){},49469:function(we,I){"use strict";var S;S={value:!0};var N;(function(L){L.TextureCompressionBC="texture-compression-bc"})(N=I.UX||(I.UX={}));var x;(function(L){L.ClampToEdge="clamp-to-edge",L.Repeat="repeat",L.MirrorRepeat="mirror-repeat"})(x=I.OB||(I.OB={}));var ee;(function(L){L.UniformBuffer="uniform-buffer",L.StorageBuffer="storage-buffer",L.ReadonlyStorageBuffer="readonly-storage-buffer",L.Sampler="sampler",L.ComparisonSampler="comparison-sampler",L.SampledTexture="sampled-texture",L.ReadonlyStorageTexture="readonly-storage-texture",L.WriteonlyStorageTexture="writeonly-storage-texture"})(ee=I.$l||(I.$l={}));var V;(function(L){L.Zero="zero",L.One="one",L.SrcColor="src-color",L.OneMinusSrcColor="one-minus-src-color",L.SrcAlpha="src-alpha",L.OneMinusSrcAlpha="one-minus-src-alpha",L.DstColor="dst-color",L.OneMinusDstColor="one-minus-dst-color",L.DstAlpha="dst-alpha",L.OneMinusDstAlpha="one-minus-dst-alpha",L.SrcAlphaSaturated="src-alpha-saturated",L.BlendColor="blend-color",L.OneMinusBlendColor="one-minus-blend-color"})(V=I.zi||(I.zi={}));var j;(function(L){L.Add="add",L.Subtract="subtract",L.ReverseSubtract="reverse-subtract",L.Min="min",L.Max="max"})(j=I.db||(I.db={}));var H;(function(L){L.Never="never",L.Less="less",L.Equal="equal",L.LessEqual="less-equal",L.Greater="greater",L.NotEqual="not-equal",L.GreaterEqual="greater-equal",L.Always="always"})(H=I.wb||(I.wb={}));var Z;(function(L){L.None="none",L.Front="front",L.Back="back"})(Z=I.Wf||(I.Wf={}));var De;(function(L){L.Nearest="nearest",L.Linear="linear"})(De=I.X9||(I.X9={}));var he;(function(L){L.CCW="ccw",L.CW="cw"})(he=I.zX||(I.zX={}));var me;(function(L){L.Uint16="uint16",L.Uint32="uint32"})(me=I.iD||(I.iD={}));var rt;(function(L){L.Vertex="vertex",L.Instance="instance"})(rt=I.V||(I.V={}));var ke;(function(L){L.Load="load"})(ke=I.Ws||(I.Ws={}));var Gt;(function(L){L.PointList="point-list",L.LineList="line-list",L.LineStrip="line-strip",L.TriangleList="triangle-list",L.TriangleStrip="triangle-strip"})(Gt=I.YV||(I.YV={}));var Yt;(function(L){L.Keep="keep",L.Zero="zero",L.Replace="replace",L.Invert="invert",L.IncrementClamp="increment-clamp",L.DecrementClamp="decrement-clamp",L.IncrementWrap="increment-wrap",L.DecrementWrap="decrement-wrap"})(Yt=I.xS||(I.xS={}));var dt;(function(L){L.Store="store",L.Clear="clear"})(dt=I.EG||(I.EG={}));var ht;(function(L){L.E1d="1d",L.E2d="2d",L.E3d="3d"})(ht=I.kd||(I.kd={}));var vt;(function(L){L.R8Unorm="r8unorm",L.R8Snorm="r8snorm",L.R8Uint="r8uint",L.R8Sint="r8sint",L.R16Uint="r16uint",L.R16Sint="r16sint",L.R16Float="r16float",L.RG8Unorm="rg8unorm",L.RG8Snorm="rg8snorm",L.RG8Uint="rg8uint",L.RG8Sint="rg8sint",L.R32Uint="r32uint",L.R32Sint="r32sint",L.R32Float="r32float",L.RG16Uint="rg16uint",L.RG16Sint="rg16sint",L.RG16Float="rg16float",L.RGBA8Unorm="rgba8unorm",L.RGBA8UnormSRGB="rgba8unorm-srgb",L.RGBA8Snorm="rgba8snorm",L.RGBA8Uint="rgba8uint",L.RGBA8Sint="rgba8sint",L.BGRA8Unorm="bgra8unorm",L.BGRA8UnormSRGB="bgra8unorm-srgb",L.RGB10A2Unorm="rgb10a2unorm",L.RG11B10Float="rg11b10float",L.RG32Uint="rg32uint",L.RG32Sint="rg32sint",L.RG32Float="rg32float",L.RGBA16Uint="rgba16uint",L.RGBA16Sint="rgba16sint",L.RGBA16Float="rgba16float",L.RGBA32Uint="rgba32uint",L.RGBA32Sint="rgba32sint",L.RGBA32Float="rgba32float",L.Depth32Float="depth32float",L.Depth24Plus="depth24plus",L.Depth24PlusStencil8="depth24plus-stencil8"})(vt=I.EV||(I.EV={}));var Ne;(function(L){L.Float="float",L.Sint="sint",L.Uint="uint"})(Ne=I.Ek||(I.Ek={}));var Ae;(function(L){L.E1d="1d",L.E2d="2d",L.E2dArray="2d-array",L.Cube="cube",L.CubeArray="cube-array",L.E3d="3d"})(Ae=I.p_||(I.p_={}));var xt;(function(L){L.Uchar2="uchar2",L.Uchar4="uchar4",L.Char2="char2",L.Char4="char4",L.Uchar2Norm="uchar2norm",L.Uchar4Norm="uchar4norm",L.Char2Norm="char2norm",L.Char4Norm="char4norm",L.Ushort2="ushort2",L.Ushort4="ushort4",L.Short2="short2",L.Short4="short4",L.Ushort2Norm="ushort2norm",L.Ushort4Norm="ushort4norm",L.Short2Norm="short2norm",L.Short4Norm="short4norm",L.Half2="half2",L.Half4="half4",L.Float="float",L.Float2="float2",L.Float3="float3",L.Float4="float4",L.Uint="uint",L.Uint2="uint2",L.Uint3="uint3",L.Uint4="uint4",L.Int="int",L.Int2="int2",L.Int3="int3",L.Int4="int4"})(xt=I.gB||(I.gB={}));var at;(function(L){L.All="all",L.StencilOnly="stencil-only",L.DepthOnly="depth-only"})(at=I.H7||(I.H7={}));var tt;(function(L){L.Error="error",L.Warning="warning",L.Info="info"})(tt=I.mj||(I.mj={}));var St;(function(L){L.Occlusion="occlusion"})(St=I.xL||(I.xL={}));var Mt;(function(L){L[L.MapRead=1]="MapRead",L[L.MapWrite=2]="MapWrite",L[L.CopySrc=4]="CopySrc",L[L.CopyDst=8]="CopyDst",L[L.Index=16]="Index",L[L.Vertex=32]="Vertex",L[L.Uniform=64]="Uniform",L[L.Storage=128]="Storage",L[L.Indirect=256]="Indirect",L[L.QueryResolve=512]="QueryResolve"})(Mt=I.FB||(I.FB={}));var zt;(function(L){L[L.Red=1]="Red",L[L.Green=2]="Green",L[L.Blue=4]="Blue",L[L.Alpha=8]="Alpha",L[L.All=15]="All"})(zt=I.Yw||(I.Yw={}));var pt;(function(L){L[L.Vertex=1]="Vertex",L[L.Fragment=2]="Fragment",L[L.Compute=4]="Compute"})(pt=I.$X||(I.$X={}));var en;(function(L){L[L.CopySrc=1]="CopySrc",L[L.CopyDst=2]="CopyDst",L[L.Sampled=4]="Sampled",L[L.Storage=8]="Storage",L[L.OutputAttachment=16]="OutputAttachment"})(en=I.v2||(I.v2={}));var $n;(function(L){L[L.Read=1]="Read",L[L.Write=2]="Write"})($n=I.gc||(I.gc={}))},94412:function(we,I,S){"use strict";S.d(I,{Z:function(){return ll}});var N=S(22122),x=S(67294),ee=S(96156),V=S(55507),j=S(90484),H=S(85061),Z=S(28481),De=S(94184),he=S.n(De),me=S(6610),rt=S(5991),ke=S(10379),Gt=S(54070),Yt=S(81253),dt=S(92137),ht=S(64217);function vt(ft,Ue){var Dt="cannot ".concat(ft.method," ").concat(ft.action," ").concat(Ue.status,"'"),je=new Error(Dt);return je.status=Ue.status,je.method=ft.method,je.url=ft.action,je}function Ne(ft){var Ue=ft.responseText||ft.response;if(!Ue)return Ue;try{return JSON.parse(Ue)}catch(Dt){return Ue}}function Ae(ft){var Ue=new XMLHttpRequest;ft.onProgress&&Ue.upload&&(Ue.upload.onprogress=function(Lt){Lt.total>0&&(Lt.percent=Lt.loaded/Lt.total*100),ft.onProgress(Lt)});var Dt=new FormData;ft.data&&Object.keys(ft.data).forEach(function(kt){var Lt=ft.data[kt];if(Array.isArray(Lt)){Lt.forEach(function(on){Dt.append("".concat(kt,"[]"),on)});return}Dt.append(kt,Lt)}),ft.file instanceof Blob?Dt.append(ft.filename,ft.file,ft.file.name):Dt.append(ft.filename,ft.file),Ue.onerror=function(Lt){ft.onError(Lt)},Ue.onload=function(){return Ue.status<200||Ue.status>=300?ft.onError(vt(ft,Ue),Ne(Ue)):ft.onSuccess(Ne(Ue),Ue)},Ue.open(ft.method,ft.action,!0),ft.withCredentials&&"withCredentials"in Ue&&(Ue.withCredentials=!0);var je=ft.headers||{};return je["X-Requested-With"]!==null&&Ue.setRequestHeader("X-Requested-With","XMLHttpRequest"),Object.keys(je).forEach(function(kt){je[kt]!==null&&Ue.setRequestHeader(kt,je[kt])}),Ue.send(Dt),{abort:function(){Ue.abort()}}}var xt=+new Date,at=0;function tt(){return"rc-upload-".concat(xt,"-").concat(++at)}var St=S(80334),Mt=function(ft,Ue){if(ft&&Ue){var Dt=Array.isArray(Ue)?Ue:Ue.split(","),je=ft.name||"",kt=ft.type||"",Lt=kt.replace(/\/.*$/,"");return Dt.some(function(on){var qt=on.trim();if(/^\*(\/\*)?$/.test(on))return!0;if(qt.charAt(0)==="."){var Nt=je.toLowerCase(),dn=qt.toLowerCase(),yn=[dn];return(dn===".jpg"||dn===".jpeg")&&(yn=[".jpg",".jpeg"]),yn.some(function(rr){return Nt.endsWith(rr)})}return/\/\*$/.test(qt)?Lt===qt.replace(/\/.*$/,""):kt===qt?!0:/^\w+$/.test(qt)?((0,St.ZP)(!1,"Upload takes an invalidate 'accept' type '".concat(qt,"'.Skip for check.")),!0):!1})}return!0};function zt(ft,Ue){var Dt=ft.createReader(),je=[];function kt(){Dt.readEntries(function(Lt){var on=Array.prototype.slice.apply(Lt);je=je.concat(on);var qt=!on.length;qt?Ue(je):kt()})}kt()}var pt=function(Ue,Dt,je){var kt=function Lt(on,qt){on.path=qt||"",on.isFile?on.file(function(Nt){je(Nt)&&(on.fullPath&&!Nt.webkitRelativePath&&(Object.defineProperties(Nt,{webkitRelativePath:{writable:!0}}),Nt.webkitRelativePath=on.fullPath.replace(/^\//,""),Object.defineProperties(Nt,{webkitRelativePath:{writable:!1}})),Dt([Nt]))}):on.isDirectory&&zt(on,function(Nt){Nt.forEach(function(dn){Lt(dn,"".concat(qt).concat(on.name,"/"))})})};Ue.forEach(function(Lt){kt(Lt.webkitGetAsEntry())})},en=pt,$n=["component","prefixCls","className","disabled","id","style","multiple","accept","capture","children","directory","openFileDialogOnClick","onMouseEnter","onMouseLeave"],L=function(ft){(0,ke.Z)(Dt,ft);var Ue=(0,Gt.Z)(Dt);function Dt(){var je;(0,me.Z)(this,Dt);for(var kt=arguments.length,Lt=new Array(kt),on=0;on<kt;on++)Lt[on]=arguments[on];return je=Ue.call.apply(Ue,[this].concat(Lt)),je.state={uid:tt()},je.reqs={},je.fileInput=void 0,je._isMounted=void 0,je.onChange=function(qt){var Nt=je.props,dn=Nt.accept,yn=Nt.directory,rr=qt.target.files,cr=(0,H.Z)(rr).filter(function(Or){return!yn||Mt(Or,dn)});je.uploadFiles(cr),je.reset()},je.onClick=function(qt){var Nt=je.fileInput;if(!!Nt){var dn=je.props,yn=dn.children,rr=dn.onClick;if(yn&&yn.type==="button"){var cr=Nt.parentNode;cr.focus(),cr.querySelector("button").blur()}Nt.click(),rr&&rr(qt)}},je.onKeyDown=function(qt){qt.key==="Enter"&&je.onClick(qt)},je.onFileDrop=function(qt){var Nt=je.props.multiple;if(qt.preventDefault(),qt.type!=="dragover")if(je.props.directory)en(Array.prototype.slice.call(qt.dataTransfer.items),je.uploadFiles,function(yn){return Mt(yn,je.props.accept)});else{var dn=(0,H.Z)(qt.dataTransfer.files).filter(function(yn){return Mt(yn,je.props.accept)});Nt===!1&&(dn=dn.slice(0,1)),je.uploadFiles(dn)}},je.uploadFiles=function(qt){var Nt=(0,H.Z)(qt),dn=Nt.map(function(yn){return yn.uid=tt(),je.processFile(yn,Nt)});Promise.all(dn).then(function(yn){var rr=je.props.onBatchStart;rr==null||rr(yn.map(function(cr){var Or=cr.origin,Lr=cr.parsedFile;return{file:Or,parsedFile:Lr}})),yn.filter(function(cr){return cr.parsedFile!==null}).forEach(function(cr){je.post(cr)})})},je.processFile=function(){var qt=(0,dt.Z)((0,V.Z)().mark(function Nt(dn,yn){var rr,cr,Or,Lr,Li,Yi,ni,Ci,Gi;return(0,V.Z)().wrap(function(Hn){for(;;)switch(Hn.prev=Hn.next){case 0:if(rr=je.props.beforeUpload,cr=dn,!rr){Hn.next=14;break}return Hn.prev=3,Hn.next=6,rr(dn,yn);case 6:cr=Hn.sent,Hn.next=12;break;case 9:Hn.prev=9,Hn.t0=Hn.catch(3),cr=!1;case 12:if(cr!==!1){Hn.next=14;break}return Hn.abrupt("return",{origin:dn,parsedFile:null,action:null,data:null});case 14:if(Or=je.props.action,typeof Or!="function"){Hn.next=21;break}return Hn.next=18,Or(dn);case 18:Lr=Hn.sent,Hn.next=22;break;case 21:Lr=Or;case 22:if(Li=je.props.data,typeof Li!="function"){Hn.next=29;break}return Hn.next=26,Li(dn);case 26:Yi=Hn.sent,Hn.next=30;break;case 29:Yi=Li;case 30:return ni=((0,j.Z)(cr)==="object"||typeof cr=="string")&&cr?cr:dn,ni instanceof File?Ci=ni:Ci=new File([ni],dn.name,{type:dn.type}),Gi=Ci,Gi.uid=dn.uid,Hn.abrupt("return",{origin:dn,data:Yi,parsedFile:Gi,action:Lr});case 35:case"end":return Hn.stop()}},Nt,null,[[3,9]])}));return function(Nt,dn){return qt.apply(this,arguments)}}(),je.saveFileInput=function(qt){je.fileInput=qt},je}return(0,rt.Z)(Dt,[{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.abort()}},{key:"post",value:function(kt){var Lt=this,on=kt.data,qt=kt.origin,Nt=kt.action,dn=kt.parsedFile;if(!!this._isMounted){var yn=this.props,rr=yn.onStart,cr=yn.customRequest,Or=yn.name,Lr=yn.headers,Li=yn.withCredentials,Yi=yn.method,ni=qt.uid,Ci=cr||Ae,Gi={action:Nt,filename:Or,data:on,file:dn,headers:Lr,withCredentials:Li,method:Yi||"post",onProgress:function(Hn){var yi=Lt.props.onProgress;yi==null||yi(Hn,dn)},onSuccess:function(Hn,yi){var Ri=Lt.props.onSuccess;Ri==null||Ri(Hn,dn,yi),delete Lt.reqs[ni]},onError:function(Hn,yi){var Ri=Lt.props.onError;Ri==null||Ri(Hn,yi,dn),delete Lt.reqs[ni]}};rr(qt),this.reqs[ni]=Ci(Gi)}}},{key:"reset",value:function(){this.setState({uid:tt()})}},{key:"abort",value:function(kt){var Lt=this.reqs;if(kt){var on=kt.uid?kt.uid:kt;Lt[on]&&Lt[on].abort&&Lt[on].abort(),delete Lt[on]}else Object.keys(Lt).forEach(function(qt){Lt[qt]&&Lt[qt].abort&&Lt[qt].abort(),delete Lt[qt]})}},{key:"render",value:function(){var kt,Lt=this.props,on=Lt.component,qt=Lt.prefixCls,Nt=Lt.className,dn=Lt.disabled,yn=Lt.id,rr=Lt.style,cr=Lt.multiple,Or=Lt.accept,Lr=Lt.capture,Li=Lt.children,Yi=Lt.directory,ni=Lt.openFileDialogOnClick,Ci=Lt.onMouseEnter,Gi=Lt.onMouseLeave,Ki=(0,Yt.Z)(Lt,$n),Hn=he()((kt={},(0,ee.Z)(kt,qt,!0),(0,ee.Z)(kt,"".concat(qt,"-disabled"),dn),(0,ee.Z)(kt,Nt,Nt),kt)),yi=Yi?{directory:"directory",webkitdirectory:"webkitdirectory"}:{},Ri=dn?{}:{onClick:ni?this.onClick:function(){},onKeyDown:ni?this.onKeyDown:function(){},onMouseEnter:Ci,onMouseLeave:Gi,onDrop:this.onFileDrop,onDragOver:this.onFileDrop,tabIndex:"0"};return x.createElement(on,(0,N.Z)({},Ri,{className:Hn,role:"button",style:rr}),x.createElement("input",(0,N.Z)({},(0,ht.Z)(Ki,{aria:!0,data:!0}),{id:yn,type:"file",ref:this.saveFileInput,onClick:function(oa){return oa.stopPropagation()},key:this.state.uid,style:{display:"none"},accept:Or},yi,{multiple:cr,onChange:this.onChange},Lr!=null?{capture:Lr}:{})),Li)}}]),Dt}(x.Component),nt=L;function $t(){}var ln=function(ft){(0,ke.Z)(Dt,ft);var Ue=(0,Gt.Z)(Dt);function Dt(){var je;(0,me.Z)(this,Dt);for(var kt=arguments.length,Lt=new Array(kt),on=0;on<kt;on++)Lt[on]=arguments[on];return je=Ue.call.apply(Ue,[this].concat(Lt)),je.uploader=void 0,je.saveUploader=function(qt){je.uploader=qt},je}return(0,rt.Z)(Dt,[{key:"abort",value:function(kt){this.uploader.abort(kt)}},{key:"render",value:function(){return x.createElement(nt,(0,N.Z)({},this.props,{ref:this.saveUploader}))}}]),Dt}(x.Component);ln.defaultProps={component:"span",prefixCls:"rc-upload",data:{},headers:{},name:"file",multipart:!1,onStart:$t,onError:$t,onSuccess:$t,multiple:!1,beforeUpload:null,customRequest:null,withCredentials:!1,openFileDialogOnClick:!0};var jt=ln,mn=jt,br=S(21770),fi=S(73935),Nr=S(53124),pr=S(98866),ti=S(42051),mr=S(85636),zr=S(28991),Ha={icon:function(Ue,Dt){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M534 352V136H232v752h560V394H576a42 42 0 01-42-42z",fill:Dt}},{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM602 137.8L790.2 326H602V137.8zM792 888H232V136h302v216a42 42 0 0042 42h216v494z",fill:Ue}}]}},name:"file",theme:"twotone"},Jn=Ha,Bi=S(27029),Xa=function(Ue,Dt){return x.createElement(Bi.Z,(0,zr.Z)((0,zr.Z)({},Ue),{},{ref:Dt,icon:Jn}))};Xa.displayName="FileTwoTone";var Su=x.forwardRef(Xa),vo=S(7085),Hi={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M779.3 196.6c-94.2-94.2-247.6-94.2-341.7 0l-261 260.8c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l261-260.8c32.4-32.4 75.5-50.2 121.3-50.2s88.9 17.8 121.2 50.2c32.4 32.4 50.2 75.5 50.2 121.2 0 45.8-17.8 88.8-50.2 121.2l-266 265.9-43.1 43.1c-40.3 40.3-105.8 40.3-146.1 0-19.5-19.5-30.2-45.4-30.2-73s10.7-53.5 30.2-73l263.9-263.8c6.7-6.6 15.5-10.3 24.9-10.3h.1c9.4 0 18.1 3.7 24.7 10.3 6.7 6.7 10.3 15.5 10.3 24.9 0 9.3-3.7 18.1-10.3 24.7L372.4 653c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l215.6-215.6c19.9-19.9 30.8-46.3 30.8-74.4s-11-54.6-30.8-74.4c-41.1-41.1-107.9-41-149 0L463 364 224.8 602.1A172.22 172.22 0 00174 724.8c0 46.3 18.1 89.8 50.8 122.5 33.9 33.8 78.3 50.7 122.7 50.7 44.4 0 88.8-16.9 122.6-50.7l309.2-309C824.8 492.7 850 432 850 367.5c.1-64.6-25.1-125.3-70.7-170.9z"}}]},name:"paper-clip",theme:"outlined"},ds=Hi,gi=function(Ue,Dt){return x.createElement(Bi.Z,(0,zr.Z)((0,zr.Z)({},Ue),{},{ref:Dt,icon:ds}))};gi.displayName="PaperClipOutlined";var li=x.forwardRef(gi),Tu={icon:function(Ue,Dt){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 632H136v-39.9l138.5-164.3 150.1 178L658.1 489 888 761.6V792zm0-129.8L664.2 396.8c-3.2-3.8-9-3.8-12.2 0L424.6 666.4l-144-170.7c-3.2-3.8-9-3.8-12.2 0L136 652.7V232h752v430.2z",fill:Ue}},{tag:"path",attrs:{d:"M424.6 765.8l-150.1-178L136 752.1V792h752v-30.4L658.1 489z",fill:Dt}},{tag:"path",attrs:{d:"M136 652.7l132.4-157c3.2-3.8 9-3.8 12.2 0l144 170.7L652 396.8c3.2-3.8 9-3.8 12.2 0L888 662.2V232H136v420.7zM304 280a88 88 0 110 176 88 88 0 010-176z",fill:Dt}},{tag:"path",attrs:{d:"M276 368a28 28 0 1056 0 28 28 0 10-56 0z",fill:Dt}},{tag:"path",attrs:{d:"M304 456a88 88 0 100-176 88 88 0 000 176zm0-116c15.5 0 28 12.5 28 28s-12.5 28-28 28-28-12.5-28-28 12.5-28 28-28z",fill:Ue}}]}},name:"picture",theme:"twotone"},Xi=Tu,Zs=function(Ue,Dt){return x.createElement(Bi.Z,(0,zr.Z)((0,zr.Z)({},Ue),{},{ref:Dt,icon:Xi}))};Zs.displayName="PictureTwoTone";var hs=x.forwardRef(Zs),k=S(63441),$i=S(71577),Wr=S(57838),vs=S(33603),Uo=S(96159);function zi(ft){return(0,N.Z)((0,N.Z)({},ft),{lastModified:ft.lastModified,lastModifiedDate:ft.lastModifiedDate,name:ft.name,size:ft.size,type:ft.type,uid:ft.uid,percent:0,originFileObj:ft})}function $a(ft,Ue){var Dt=(0,H.Z)(Ue),je=Dt.findIndex(function(kt){var Lt=kt.uid;return Lt===ft.uid});return je===-1?Dt.push(ft):Dt[je]=ft,Dt}function xe(ft,Ue){var Dt=ft.uid!==void 0?"uid":"name";return Ue.filter(function(je){return je[Dt]===ft[Dt]})[0]}function Xe(ft,Ue){var Dt=ft.uid!==void 0?"uid":"name",je=Ue.filter(function(kt){return kt[Dt]!==ft[Dt]});return je.length===Ue.length?null:je}var bt=function(){var Ue=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",Dt=Ue.split("/"),je=Dt[Dt.length-1],kt=je.split(/#|\?/)[0];return(/\.[^./\\]*$/.exec(kt)||[""])[0]},Ft=function(Ue){return Ue.indexOf("image/")===0},Wt=function(Ue){if(Ue.type&&!Ue.thumbUrl)return Ft(Ue.type);var Dt=Ue.thumbUrl||Ue.url||"",je=bt(Dt);return/^data:image\//.test(Dt)||/(webp|svg|png|gif|jpg|jpeg|jfif|bmp|dpg|ico|heic|heif)$/i.test(je)?!0:!(/^data:/.test(Dt)||je)},Rn=200;function Pn(ft){return new Promise(function(Ue){if(!ft.type||!Ft(ft.type)){Ue("");return}var Dt=document.createElement("canvas");Dt.width=Rn,Dt.height=Rn,Dt.style.cssText="position: fixed; left: 0; top: 0; width: ".concat(Rn,"px; height: ").concat(Rn,"px; z-index: 9999; display: none;"),document.body.appendChild(Dt);var je=Dt.getContext("2d"),kt=new Image;if(kt.onload=function(){var on=kt.width,qt=kt.height,Nt=Rn,dn=Rn,yn=0,rr=0;on>qt?(dn=qt*(Rn/on),rr=-(dn-Nt)/2):(Nt=on*(Rn/qt),yn=-(Nt-dn)/2),je.drawImage(kt,yn,rr,Nt,dn);var cr=Dt.toDataURL();document.body.removeChild(Dt),Ue(cr)},kt.crossOrigin="anonymous",ft.type.startsWith("image/svg+xml")){var Lt=new FileReader;Lt.addEventListener("load",function(){Lt.result&&(kt.src=Lt.result)}),Lt.readAsDataURL(ft)}else kt.src=window.URL.createObjectURL(ft)})}var Un=S(73171),an={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"download",theme:"outlined"},ir=an,nr=function(Ue,Dt){return x.createElement(Bi.Z,(0,zr.Z)((0,zr.Z)({},Ue),{},{ref:Dt,icon:ir}))};nr.displayName="DownloadOutlined";var wa=x.forwardRef(nr),Au=S(95357),Bo=S(54458),zo=S(45777),ps=x.forwardRef(function(ft,Ue){var Dt,je=ft.prefixCls,kt=ft.className,Lt=ft.style,on=ft.locale,qt=ft.listType,Nt=ft.file,dn=ft.items,yn=ft.progress,rr=ft.iconRender,cr=ft.actionIconRender,Or=ft.itemRender,Lr=ft.isImgUrl,Li=ft.showPreviewIcon,Yi=ft.showRemoveIcon,ni=ft.showDownloadIcon,Ci=ft.previewIcon,Gi=ft.removeIcon,Ki=ft.downloadIcon,Hn=ft.onPreview,yi=ft.onDownload,Ri=ft.onClose,La,oa,sa=Nt.status,mo=x.useState(sa),gs=(0,Z.Z)(mo,2),hi=gs[0],va=gs[1];x.useEffect(function(){sa!=="removed"&&va(sa)},[sa]);var Wo=x.useState(!1),Ga=(0,Z.Z)(Wo,2),ys=Ga[0],pa=Ga[1],ka=x.useRef();x.useEffect(function(){return ka.current=setTimeout(function(){pa(!0)},300),function(){window.clearTimeout(ka.current)}},[]);var Vo="".concat(je,"-span"),_i=rr(Nt),Fr=x.createElement("div",{className:"".concat(je,"-text-icon")},_i);if(qt==="picture"||qt==="picture-card")if(hi==="uploading"||!Nt.thumbUrl&&!Nt.url){var Wi,xa=he()((Wi={},(0,ee.Z)(Wi,"".concat(je,"-list-item-thumbnail"),!0),(0,ee.Z)(Wi,"".concat(je,"-list-item-file"),hi!=="uploading"),Wi));Fr=x.createElement("div",{className:xa},_i)}else{var ua,Zo=(Lr==null?void 0:Lr(Nt))?x.createElement("img",{src:Nt.thumbUrl||Nt.url,alt:Nt.name,className:"".concat(je,"-list-item-image"),crossOrigin:Nt.crossOrigin}):_i,go=he()((ua={},(0,ee.Z)(ua,"".concat(je,"-list-item-thumbnail"),!0),(0,ee.Z)(ua,"".concat(je,"-list-item-file"),Lr&&!Lr(Nt)),ua));Fr=x.createElement("a",{className:go,onClick:function(Bn){return Hn(Nt,Bn)},href:Nt.url||Nt.thumbUrl,target:"_blank",rel:"noopener noreferrer"},Zo)}var Ei=he()((Dt={},(0,ee.Z)(Dt,"".concat(je,"-list-item"),!0),(0,ee.Z)(Dt,"".concat(je,"-list-item-").concat(hi),!0),(0,ee.Z)(Dt,"".concat(je,"-list-item-list-type-").concat(qt),!0),Dt)),jo=typeof Nt.linkProps=="string"?JSON.parse(Nt.linkProps):Nt.linkProps,na=Yi?cr((typeof Gi=="function"?Gi(Nt):Gi)||x.createElement(Un.Z,null),function(){return Ri(Nt)},je,on.removeFile):null,yo=ni&&hi==="done"?cr((typeof Ki=="function"?Ki(Nt):Ki)||x.createElement(wa,null),function(){return yi(Nt)},je,on.downloadFile):null,_s=qt!=="picture-card"&&x.createElement("span",{key:"download-delete",className:he()("".concat(je,"-list-item-card-actions"),{picture:qt==="picture"})},yo,na),Ho=he()("".concat(je,"-list-item-name")),Sa=Nt.url?[x.createElement("a",(0,N.Z)({key:"view",target:"_blank",rel:"noopener noreferrer",className:Ho,title:Nt.name},jo,{href:Nt.url,onClick:function(Bn){return Hn(Nt,Bn)}}),Nt.name),_s]:[x.createElement("span",{key:"view",className:Ho,onClick:function(Bn){return Hn(Nt,Bn)},title:Nt.name},Nt.name),_s],yr={pointerEvents:"none",opacity:.5},fr=Li?x.createElement("a",{href:Nt.url||Nt.thumbUrl,target:"_blank",rel:"noopener noreferrer",style:Nt.url||Nt.thumbUrl?void 0:yr,onClick:function(Bn){return Hn(Nt,Bn)},title:on.previewFile},typeof Ci=="function"?Ci(Nt):Ci||x.createElement(Au.Z,null)):null,vi=qt==="picture-card"&&hi!=="uploading"&&x.createElement("span",{className:"".concat(je,"-list-item-actions")},fr,hi==="done"&&yo,na),qi;Nt.response&&typeof Nt.response=="string"?qi=Nt.response:qi=((La=Nt.error)===null||La===void 0?void 0:La.statusText)||((oa=Nt.error)===null||oa===void 0?void 0:oa.message)||on.uploadError;var bi=x.createElement("span",{className:Vo},Fr,Sa),_o=x.useContext(Nr.E_),Xo=_o.getPrefixCls,Fa=Xo(),Eo=x.createElement("div",{className:Ei},x.createElement("div",{className:"".concat(je,"-list-item-info")},bi),vi,ys&&x.createElement(k.Z,{motionName:"".concat(Fa,"-fade"),visible:hi==="uploading",motionDeadline:2e3},function(Mn){var Bn=Mn.className,$o="percent"in Nt?x.createElement(Bo.Z,(0,N.Z)({},yn,{type:"line",percent:Nt.percent})):null;return x.createElement("div",{className:he()("".concat(je,"-list-item-progress"),Bn)},$o)})),Es=he()("".concat(je,"-list-").concat(qt,"-container"),kt),Hs=hi==="error"?x.createElement(zo.Z,{title:qi,getPopupContainer:function(Bn){return Bn.parentNode}},Eo):Eo;return x.createElement("div",{className:Es,style:Lt,ref:Ue},Or?Or(Hs,Nt,dn,{download:yi.bind(null,Nt),preview:Hn.bind(null,Nt),remove:Ri.bind(null,Nt)}):Hs)}),uf=ps,di=(0,N.Z)({},vs.ZP);delete di.onAppearEnd,delete di.onEnterEnd,delete di.onLeaveEnd;var js=function(Ue,Dt){var je,kt=Ue.listType,Lt=kt===void 0?"text":kt,on=Ue.previewFile,qt=on===void 0?Pn:on,Nt=Ue.onPreview,dn=Ue.onDownload,yn=Ue.onRemove,rr=Ue.locale,cr=Ue.iconRender,Or=Ue.isImageUrl,Lr=Or===void 0?Wt:Or,Li=Ue.prefixCls,Yi=Ue.items,ni=Yi===void 0?[]:Yi,Ci=Ue.showPreviewIcon,Gi=Ci===void 0?!0:Ci,Ki=Ue.showRemoveIcon,Hn=Ki===void 0?!0:Ki,yi=Ue.showDownloadIcon,Ri=yi===void 0?!1:yi,La=Ue.removeIcon,oa=Ue.previewIcon,sa=Ue.downloadIcon,mo=Ue.progress,gs=mo===void 0?{strokeWidth:2,showInfo:!1}:mo,hi=Ue.appendAction,va=Ue.appendActionVisible,Wo=va===void 0?!0:va,Ga=Ue.itemRender,ys=(0,Wr.Z)(),pa=x.useState(!1),ka=(0,Z.Z)(pa,2),Vo=ka[0],_i=ka[1];x.useEffect(function(){Lt!=="picture"&&Lt!=="picture-card"||(ni||[]).forEach(function(yr){typeof document=="undefined"||typeof window=="undefined"||!window.FileReader||!window.File||!(yr.originFileObj instanceof File||yr.originFileObj instanceof Blob)||yr.thumbUrl!==void 0||(yr.thumbUrl="",qt&&qt(yr.originFileObj).then(function(fr){yr.thumbUrl=fr||"",ys()}))})},[Lt,ni,qt]),x.useEffect(function(){_i(!0)},[]);var Fr=function(fr,vi){if(!!Nt)return vi==null||vi.preventDefault(),Nt(fr)},Wi=function(fr){typeof dn=="function"?dn(fr):fr.url&&window.open(fr.url)},xa=function(fr){yn==null||yn(fr)},ua=function(fr){if(cr)return cr(fr,Lt);var vi=fr.status==="uploading",qi=Lr&&Lr(fr)?x.createElement(hs,null):x.createElement(Su,null),bi=vi?x.createElement(vo.Z,null):x.createElement(li,null);return Lt==="picture"?bi=vi?x.createElement(vo.Z,null):qi:Lt==="picture-card"&&(bi=vi?rr.uploading:qi),bi},Zo=function(fr,vi,qi,bi){var _o={type:"text",size:"small",title:bi,onClick:function(Eo){vi(),(0,Uo.l$)(fr)&&fr.props.onClick&&fr.props.onClick(Eo)},className:"".concat(qi,"-list-item-card-actions-btn")};if((0,Uo.l$)(fr)){var Xo=(0,Uo.Tm)(fr,(0,N.Z)((0,N.Z)({},fr.props),{onClick:function(){}}));return x.createElement($i.Z,(0,N.Z)({},_o,{icon:Xo}))}return x.createElement($i.Z,(0,N.Z)({},_o),x.createElement("span",null,fr))};x.useImperativeHandle(Dt,function(){return{handlePreview:Fr,handleDownload:Wi}});var go=x.useContext(Nr.E_),Ei=go.getPrefixCls,jo=go.direction,na=Ei("upload",Li),yo=he()((je={},(0,ee.Z)(je,"".concat(na,"-list"),!0),(0,ee.Z)(je,"".concat(na,"-list-").concat(Lt),!0),(0,ee.Z)(je,"".concat(na,"-list-rtl"),jo==="rtl"),je)),_s=(0,H.Z)(ni.map(function(yr){return{key:yr.uid,file:yr}})),Ho=Lt==="picture-card"?"animate-inline":"animate",Sa={motionDeadline:2e3,motionName:"".concat(na,"-").concat(Ho),keys:_s,motionAppear:Vo};return Lt!=="picture-card"&&(Sa=(0,N.Z)((0,N.Z)({},di),Sa)),x.createElement("div",{className:yo},x.createElement(k.V,(0,N.Z)({},Sa,{component:!1}),function(yr){var fr=yr.key,vi=yr.file,qi=yr.className,bi=yr.style;return x.createElement(uf,{key:fr,locale:rr,prefixCls:na,className:qi,style:bi,file:vi,items:ni,progress:gs,listType:Lt,isImgUrl:Lr,showPreviewIcon:Gi,showRemoveIcon:Hn,showDownloadIcon:Ri,removeIcon:La,previewIcon:oa,downloadIcon:sa,iconRender:ua,actionIconRender:Zo,itemRender:Ga,onPreview:Fr,onDownload:Wi,onClose:xa})}),hi&&x.createElement(k.Z,(0,N.Z)({},Sa,{visible:Wo,forceRender:!0}),function(yr){var fr=yr.className,vi=yr.style;return(0,Uo.Tm)(hi,function(qi){return{className:he()(qi.className,fr),style:(0,N.Z)((0,N.Z)((0,N.Z)({},vi),{pointerEvents:fr?"none":void 0}),qi.style)}})}))},Iu=x.forwardRef(js),po=Iu,Cu=function(ft,Ue,Dt,je){function kt(Lt){return Lt instanceof Dt?Lt:new Dt(function(on){on(Lt)})}return new(Dt||(Dt=Promise))(function(Lt,on){function qt(yn){try{dn(je.next(yn))}catch(rr){on(rr)}}function Nt(yn){try{dn(je.throw(yn))}catch(rr){on(rr)}}function dn(yn){yn.done?Lt(yn.value):kt(yn.value).then(qt,Nt)}dn((je=je.apply(ft,Ue||[])).next())})},Ya="__LIST_IGNORE_".concat(Date.now(),"__"),cf=function(Ue,Dt){var je,kt=Ue.fileList,Lt=Ue.defaultFileList,on=Ue.onRemove,qt=Ue.showUploadList,Nt=qt===void 0?!0:qt,dn=Ue.listType,yn=dn===void 0?"text":dn,rr=Ue.onPreview,cr=Ue.onDownload,Or=Ue.onChange,Lr=Ue.onDrop,Li=Ue.previewFile,Yi=Ue.disabled,ni=Yi===void 0?!1:Yi,Ci=Ue.locale,Gi=Ue.iconRender,Ki=Ue.isImageUrl,Hn=Ue.progress,yi=Ue.prefixCls,Ri=Ue.className,La=Ue.type,oa=La===void 0?"select":La,sa=Ue.children,mo=Ue.style,gs=Ue.itemRender,hi=Ue.maxCount,va=Ue.data,Wo=va===void 0?{}:va,Ga=Ue.multiple,ys=Ga===void 0?!1:Ga,pa=Ue.action,ka=pa===void 0?"":pa,Vo=Ue.accept,_i=Vo===void 0?"":Vo,Fr=Ue.supportServerRender,Wi=Fr===void 0?!0:Fr,xa=x.useContext(pr.Z),ua=ni||xa,Zo=(0,br.Z)(Lt||[],{value:kt,postState:function(Yn){return Yn??[]}}),go=(0,Z.Z)(Zo,2),Ei=go[0],jo=go[1],na=x.useState("drop"),yo=(0,Z.Z)(na,2),_s=yo[0],Ho=yo[1],Sa=x.useRef();x.useMemo(function(){var Vi=Date.now();(kt||[]).forEach(function(Yn,Zn){!Yn.uid&&!Object.isFrozen(Yn)&&(Yn.uid="__AUTO__".concat(Vi,"_").concat(Zn,"__"))})},[kt]);var yr=function(Yn,Zn,$r){var zn=(0,H.Z)(Zn);hi===1?zn=zn.slice(-1):hi&&(zn=zn.slice(0,hi)),(0,fi.flushSync)(function(){jo(zn)});var Rr={file:Yn,fileList:zn};$r&&(Rr.event=$r),Or==null||Or(Rr)},fr=function(Yn,Zn){return Cu(void 0,void 0,void 0,(0,V.Z)().mark(function $r(){var zn,Rr,ri,Mr;return(0,V.Z)().wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:if(zn=Ue.beforeUpload,Rr=Ue.transformFile,ri=Yn,!zn){Ar.next=13;break}return Ar.next=5,zn(Yn,Zn);case 5:if(Mr=Ar.sent,Mr!==!1){Ar.next=8;break}return Ar.abrupt("return",!1);case 8:if(delete Yn[Ya],Mr!==Ya){Ar.next=12;break}return Object.defineProperty(Yn,Ya,{value:!0,configurable:!0}),Ar.abrupt("return",!1);case 12:(0,j.Z)(Mr)==="object"&&Mr&&(ri=Mr);case 13:if(!Rr){Ar.next=17;break}return Ar.next=16,Rr(ri);case 16:ri=Ar.sent;case 17:return Ar.abrupt("return",ri);case 18:case"end":return Ar.stop()}},$r)}))},vi=function(Yn){var Zn=Yn.filter(function(Rr){return!Rr.file[Ya]});if(!!Zn.length){var $r=Zn.map(function(Rr){return zi(Rr.file)}),zn=(0,H.Z)(Ei);$r.forEach(function(Rr){zn=$a(Rr,zn)}),$r.forEach(function(Rr,ri){var Mr=Rr;if(Zn[ri].parsedFile)Rr.status="uploading";else{var Ua=Rr.originFileObj,Ar;try{Ar=new File([Ua],Ua.name,{type:Ua.type})}catch(yc){Ar=new Blob([Ua],{type:Ua.type}),Ar.name=Ua.name,Ar.lastModifiedDate=new Date,Ar.lastModified=new Date().getTime()}Ar.uid=Rr.uid,Mr=Ar}yr(Mr,zn)})}},qi=function(Yn,Zn,$r){try{typeof Yn=="string"&&(Yn=JSON.parse(Yn))}catch(ri){}if(!!xe(Zn,Ei)){var zn=zi(Zn);zn.status="done",zn.percent=100,zn.response=Yn,zn.xhr=$r;var Rr=$a(zn,Ei);yr(zn,Rr)}},bi=function(Yn,Zn){if(!!xe(Zn,Ei)){var $r=zi(Zn);$r.status="uploading",$r.percent=Yn.percent;var zn=$a($r,Ei);yr($r,zn,Yn)}},_o=function(Yn,Zn,$r){if(!!xe($r,Ei)){var zn=zi($r);zn.error=Yn,zn.response=Zn,zn.status="error";var Rr=$a(zn,Ei);yr(zn,Rr)}},Xo=function(Yn){var Zn;Promise.resolve(typeof on=="function"?on(Yn):on).then(function($r){var zn;if($r!==!1){var Rr=Xe(Yn,Ei);Rr&&(Zn=(0,N.Z)((0,N.Z)({},Yn),{status:"removed"}),Ei==null||Ei.forEach(function(ri){var Mr=Zn.uid!==void 0?"uid":"name";ri[Mr]===Zn[Mr]&&!Object.isFrozen(ri)&&(ri.status="removed")}),(zn=Sa.current)===null||zn===void 0||zn.abort(Zn),yr(Zn,Rr))}})},Fa=function(Yn){Ho(Yn.type),Yn.type==="drop"&&(Lr==null||Lr(Yn))};x.useImperativeHandle(Dt,function(){return{onBatchStart:vi,onSuccess:qi,onProgress:bi,onError:_o,fileList:Ei,upload:Sa.current}});var Eo=x.useContext(Nr.E_),Es=Eo.getPrefixCls,Hs=Eo.direction,Mn=Es("upload",yi),Bn=(0,N.Z)((0,N.Z)({onBatchStart:vi,onError:_o,onProgress:bi,onSuccess:qi},Ue),{data:Wo,multiple:ys,action:ka,accept:_i,supportServerRender:Wi,prefixCls:Mn,disabled:ua,beforeUpload:fr,onChange:void 0});delete Bn.className,delete Bn.style,(!sa||ua)&&delete Bn.id;var $o=function(Yn,Zn){return Nt?x.createElement(ti.Z,{componentName:"Upload",defaultLocale:mr.Z.Upload},function($r){var zn=typeof Nt=="boolean"?{}:Nt,Rr=zn.showRemoveIcon,ri=zn.showPreviewIcon,Mr=zn.showDownloadIcon,Ua=zn.removeIcon,Ar=zn.previewIcon,yc=zn.downloadIcon;return x.createElement(po,{prefixCls:Mn,listType:yn,items:Ei,previewFile:Li,onPreview:rr,onDownload:cr,onRemove:Xo,showRemoveIcon:!ua&&Rr,showPreviewIcon:ri,showDownloadIcon:Mr,removeIcon:Ua,previewIcon:Ar,downloadIcon:yc,iconRender:Gi,locale:(0,N.Z)((0,N.Z)({},$r),Ci),isImageUrl:Ki,progress:Hn,appendAction:Yn,appendActionVisible:Zn,itemRender:gs})}):Yn};if(oa==="drag"){var Mi,mc=he()(Mn,(Mi={},(0,ee.Z)(Mi,"".concat(Mn,"-drag"),!0),(0,ee.Z)(Mi,"".concat(Mn,"-drag-uploading"),Ei.some(function(Vi){return Vi.status==="uploading"})),(0,ee.Z)(Mi,"".concat(Mn,"-drag-hover"),_s==="dragover"),(0,ee.Z)(Mi,"".concat(Mn,"-disabled"),ua),(0,ee.Z)(Mi,"".concat(Mn,"-rtl"),Hs==="rtl"),Mi),Ri);return x.createElement("span",null,x.createElement("div",{className:mc,onDrop:Fa,onDragOver:Fa,onDragLeave:Fa,style:mo},x.createElement(mn,(0,N.Z)({},Bn,{ref:Sa,className:"".concat(Mn,"-btn")}),x.createElement("div",{className:"".concat(Mn,"-drag-container")},sa))),$o())}var gc=he()(Mn,(je={},(0,ee.Z)(je,"".concat(Mn,"-select"),!0),(0,ee.Z)(je,"".concat(Mn,"-select-").concat(yn),!0),(0,ee.Z)(je,"".concat(Mn,"-disabled"),ua),(0,ee.Z)(je,"".concat(Mn,"-rtl"),Hs==="rtl"),je)),lf=function(Yn){return x.createElement("div",{className:gc,style:Yn},x.createElement(mn,(0,N.Z)({},Bn,{ref:Sa})))},df=lf(sa?void 0:{display:"none"});return yn==="picture-card"?x.createElement("span",{className:he()("".concat(Mn,"-picture-card-wrapper"),Ri)},$o(df,!!sa)):x.createElement("span",{className:Ri},df,$o())},Ru=x.forwardRef(cf),ff=Ru,ms=function(ft,Ue){var Dt={};for(var je in ft)Object.prototype.hasOwnProperty.call(ft,je)&&Ue.indexOf(je)<0&&(Dt[je]=ft[je]);if(ft!=null&&typeof Object.getOwnPropertySymbols=="function")for(var kt=0,je=Object.getOwnPropertySymbols(ft);kt<je.length;kt++)Ue.indexOf(je[kt])<0&&Object.prototype.propertyIsEnumerable.call(ft,je[kt])&&(Dt[je[kt]]=ft[je[kt]]);return Dt},pc=x.forwardRef(function(ft,Ue){var Dt=ft.style,je=ft.height,kt=ms(ft,["style","height"]);return x.createElement(ff,(0,N.Z)({ref:Ue},kt,{type:"drag",style:(0,N.Z)((0,N.Z)({},Dt),{height:je})}))}),Xr=pc,Mu=ff;Mu.Dragger=Xr,Mu.LIST_IGNORE=Ya;var ll=Mu},43185:function(we,I,S){"use strict";var N=S(38663),x=S.n(N),ee=S(63252),V=S.n(ee),j=S(57663),H=S(34669),Z=S(22385)},89550:function(we){we.exports=I;function I(S,N,x){return S[0]=N[0]+x[0],S[1]=N[1]+x[1],S}},62189:function(we){we.exports=I;function I(S,N){return S[0]=Math.ceil(N[0]),S[1]=Math.ceil(N[1]),S}},76057:function(we){we.exports=I;function I(S){var N=new Float32Array(2);return N[0]=S[0],N[1]=S[1],N}},3492:function(we){we.exports=I;function I(S,N){return S[0]=N[0],S[1]=N[1],S}},61589:function(we){we.exports=I;function I(){var S=new Float32Array(2);return S[0]=0,S[1]=0,S}},77741:function(we){we.exports=I;function I(S,N,x){var ee=N[0]*x[1]-N[1]*x[0];return S[0]=S[1]=0,S[2]=ee,S}},80278:function(we,I,S){we.exports=S(27953)},27953:function(we){we.exports=I;function I(S,N){var x=N[0]-S[0],ee=N[1]-S[1];return Math.sqrt(x*x+ee*ee)}},49973:function(we,I,S){we.exports=S(6773)},6773:function(we){we.exports=I;function I(S,N,x){return S[0]=N[0]/x[0],S[1]=N[1]/x[1],S}},56601:function(we){we.exports=I;function I(S,N){return S[0]*N[0]+S[1]*N[1]}},89936:function(we){we.exports=1e-6},51232:function(we,I,S){we.exports=x;var N=S(89936);function x(ee,V){var j=ee[0],H=ee[1],Z=V[0],De=V[1];return Math.abs(j-Z)<=N*Math.max(1,Math.abs(j),Math.abs(Z))&&Math.abs(H-De)<=N*Math.max(1,Math.abs(H),Math.abs(De))}},39546:function(we){we.exports=I;function I(S,N){return S[0]===N[0]&&S[1]===N[1]}},67744:function(we){we.exports=I;function I(S,N){return S[0]=Math.floor(N[0]),S[1]=Math.floor(N[1]),S}},49002:function(we,I,S){we.exports=x;var N=S(61589)();function x(ee,V,j,H,Z,De){var he,me;for(V||(V=2),j||(j=0),H?me=Math.min(H*V+j,ee.length):me=ee.length,he=j;he<me;he+=V)N[0]=ee[he],N[1]=ee[he+1],Z(N,N,De),ee[he]=N[0],ee[he+1]=N[1];return ee}},69878:function(we){we.exports=I;function I(S,N){var x=new Float32Array(2);return x[0]=S,x[1]=N,x}},32644:function(we,I,S){we.exports={EPSILON:S(89936),create:S(61589),clone:S(76057),fromValues:S(69878),copy:S(3492),set:S(68854),equals:S(51232),exactEquals:S(39546),add:S(89550),subtract:S(43650),sub:S(45222),multiply:S(79920),mul:S(23113),divide:S(6773),div:S(49973),inverse:S(83793),min:S(20676),max:S(97899),rotate:S(48677),floor:S(67744),ceil:S(62189),round:S(57074),scale:S(47838),scaleAndAdd:S(21066),distance:S(27953),dist:S(80278),squaredDistance:S(14290),sqrDist:S(79569),length:S(37781),len:S(8123),squaredLength:S(26791),sqrLen:S(1791),negate:S(90549),normalize:S(36820),dot:S(56601),cross:S(77741),lerp:S(20577),random:S(85773),transformMat2:S(904),transformMat2d:S(60736),transformMat3:S(60221),transformMat4:S(37674),forEach:S(49002),limit:S(82418)}},83793:function(we){we.exports=I;function I(S,N){return S[0]=1/N[0],S[1]=1/N[1],S}},8123:function(we,I,S){we.exports=S(37781)},37781:function(we){we.exports=I;function I(S){var N=S[0],x=S[1];return Math.sqrt(N*N+x*x)}},20577:function(we){we.exports=I;function I(S,N,x,ee){var V=N[0],j=N[1];return S[0]=V+ee*(x[0]-V),S[1]=j+ee*(x[1]-j),S}},82418:function(we){we.exports=I;function I(S,N,x){var ee=N[0]*N[0]+N[1]*N[1];if(ee>x*x){var V=Math.sqrt(ee);S[0]=N[0]/V*x,S[1]=N[1]/V*x}else S[0]=N[0],S[1]=N[1];return S}},97899:function(we){we.exports=I;function I(S,N,x){return S[0]=Math.max(N[0],x[0]),S[1]=Math.max(N[1],x[1]),S}},20676:function(we){we.exports=I;function I(S,N,x){return S[0]=Math.min(N[0],x[0]),S[1]=Math.min(N[1],x[1]),S}},23113:function(we,I,S){we.exports=S(79920)},79920:function(we){we.exports=I;function I(S,N,x){return S[0]=N[0]*x[0],S[1]=N[1]*x[1],S}},90549:function(we){we.exports=I;function I(S,N){return S[0]=-N[0],S[1]=-N[1],S}},36820:function(we){we.exports=I;function I(S,N){var x=N[0],ee=N[1],V=x*x+ee*ee;return V>0&&(V=1/Math.sqrt(V),S[0]=N[0]*V,S[1]=N[1]*V),S}},85773:function(we){we.exports=I;function I(S,N){N=N||1;var x=Math.random()*2*Math.PI;return S[0]=Math.cos(x)*N,S[1]=Math.sin(x)*N,S}},48677:function(we){we.exports=I;function I(S,N,x){var ee=Math.cos(x),V=Math.sin(x),j=N[0],H=N[1];return S[0]=j*ee-H*V,S[1]=j*V+H*ee,S}},57074:function(we){we.exports=I;function I(S,N){return S[0]=Math.round(N[0]),S[1]=Math.round(N[1]),S}},47838:function(we){we.exports=I;function I(S,N,x){return S[0]=N[0]*x,S[1]=N[1]*x,S}},21066:function(we){we.exports=I;function I(S,N,x,ee){return S[0]=N[0]+x[0]*ee,S[1]=N[1]+x[1]*ee,S}},68854:function(we){we.exports=I;function I(S,N,x){return S[0]=N,S[1]=x,S}},79569:function(we,I,S){we.exports=S(14290)},1791:function(we,I,S){we.exports=S(26791)},14290:function(we){we.exports=I;function I(S,N){var x=N[0]-S[0],ee=N[1]-S[1];return x*x+ee*ee}},26791:function(we){we.exports=I;function I(S){var N=S[0],x=S[1];return N*N+x*x}},45222:function(we,I,S){we.exports=S(43650)},43650:function(we){we.exports=I;function I(S,N,x){return S[0]=N[0]-x[0],S[1]=N[1]-x[1],S}},904:function(we){we.exports=I;function I(S,N,x){var ee=N[0],V=N[1];return S[0]=x[0]*ee+x[2]*V,S[1]=x[1]*ee+x[3]*V,S}},60736:function(we){we.exports=I;function I(S,N,x){var ee=N[0],V=N[1];return S[0]=x[0]*ee+x[2]*V+x[4],S[1]=x[1]*ee+x[3]*V+x[5],S}},60221:function(we){we.exports=I;function I(S,N,x){var ee=N[0],V=N[1];return S[0]=x[0]*ee+x[3]*V+x[6],S[1]=x[1]*ee+x[4]*V+x[7],S}},37674:function(we){we.exports=I;function I(S,N,x){var ee=N[0],V=N[1];return S[0]=x[0]*ee+x[4]*V+x[12],S[1]=x[1]*ee+x[5]*V+x[13],S}},7375:function(we,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0});var S=Symbol.for("INJECTION");function N(H,Z,De,he){function me(){return he&&!Reflect.hasMetadata(S,this,Z)&&Reflect.defineMetadata(S,De(),this,Z),Reflect.hasMetadata(S,this,Z)?Reflect.getMetadata(S,this,Z):De()}function rt(ke){Reflect.defineMetadata(S,ke,this,Z)}Object.defineProperty(H,Z,{configurable:!0,enumerable:!0,get:me,set:rt})}function x(H,Z){return function(De){return function(he,me){var rt=function(){return H.get(De)};N(he,me,rt,Z)}}}I.makePropertyInjectDecorator=x;function ee(H,Z){return function(De,he){return function(me,rt){var ke=function(){return H.getNamed(De,he)};N(me,rt,ke,Z)}}}I.makePropertyInjectNamedDecorator=ee;function V(H,Z){return function(De,he,me){return function(rt,ke){var Gt=function(){return H.getTagged(De,he,me)};N(rt,ke,Gt,Z)}}}I.makePropertyInjectTaggedDecorator=V;function j(H,Z){return function(De){return function(he,me){var rt=function(){return H.getAll(De)};N(he,me,rt,Z)}}}I.makePropertyMultiInjectDecorator=j},84879:function(we,I,S){"use strict";var N;N={value:!0};var x=S(7375);function ee(V,j){j===void 0&&(j=!0);var H=x.makePropertyInjectDecorator(V,j),Z=x.makePropertyInjectNamedDecorator(V,j),De=x.makePropertyInjectTaggedDecorator(V,j),he=x.makePropertyMultiInjectDecorator(V,j);return{lazyInject:H,lazyInjectNamed:Z,lazyInjectTagged:De,lazyMultiInject:he}}I.Z=ee},99934:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.tagProperty=I.tagParameter=I.decorate=void 0;var N=S(16674),x=S(6867);function ee(he,me,rt,ke){var Gt=x.TAGGED;j(Gt,he,me,ke,rt)}I.tagParameter=ee;function V(he,me,rt){var ke=x.TAGGED_PROP;j(ke,he.constructor,me,rt)}I.tagProperty=V;function j(he,me,rt,ke,Gt){var Yt={},dt=typeof Gt=="number",ht=Gt!==void 0&&dt?Gt.toString():rt;if(dt&&rt!==void 0)throw new Error(N.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(he,me)&&(Yt=Reflect.getMetadata(he,me));var vt=Yt[ht];if(!Array.isArray(vt))vt=[];else for(var Ne=0,Ae=vt;Ne<Ae.length;Ne++){var xt=Ae[Ne];if(xt.key===ke.key)throw new Error(N.DUPLICATED_METADATA+" "+xt.key.toString())}vt.push(ke),Yt[ht]=vt,Reflect.defineMetadata(he,Yt,me)}function H(he,me){Reflect.decorate(he,me)}function Z(he,me){return function(rt,ke){me(rt,ke,he)}}function De(he,me,rt){typeof rt=="number"?H([Z(rt,he)],me):typeof rt=="string"?Reflect.decorate([he],me,rt):H([he],me)}I.decorate=De},5744:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.inject=I.LazyServiceIdentifer=void 0;var N=S(16674),x=S(6867),ee=S(47738),V=S(99934),j=function(){function Z(De){this._cb=De}return Z.prototype.unwrap=function(){return this._cb()},Z}();I.LazyServiceIdentifer=j;function H(Z){return function(De,he,me){if(Z===void 0)throw new Error(N.UNDEFINED_INJECT_ANNOTATION(De.name));var rt=new ee.Metadata(x.INJECT_TAG,Z);typeof me=="number"?V.tagParameter(De,he,me,rt):V.tagProperty(De,he,rt)}}I.inject=H},64315:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.injectable=void 0;var N=S(16674),x=S(6867);function ee(){return function(V){if(Reflect.hasOwnMetadata(x.PARAM_TYPES,V))throw new Error(N.DUPLICATED_INJECTABLE_DECORATOR);var j=Reflect.getMetadata(x.DESIGN_PARAM_TYPES,V)||[];return Reflect.defineMetadata(x.PARAM_TYPES,j,V),V}}I.injectable=ee},71693:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.multiInject=void 0;var N=S(6867),x=S(47738),ee=S(99934);function V(j){return function(H,Z,De){var he=new x.Metadata(N.MULTI_INJECT_TAG,j);typeof De=="number"?ee.tagParameter(H,Z,De,he):ee.tagProperty(H,Z,he)}}I.multiInject=V},38085:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.named=void 0;var N=S(6867),x=S(47738),ee=S(99934);function V(j){return function(H,Z,De){var he=new x.Metadata(N.NAMED_TAG,j);typeof De=="number"?ee.tagParameter(H,Z,De,he):ee.tagProperty(H,Z,he)}}I.named=V},6515:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.optional=void 0;var N=S(6867),x=S(47738),ee=S(99934);function V(){return function(j,H,Z){var De=new x.Metadata(N.OPTIONAL_TAG,!0);typeof Z=="number"?ee.tagParameter(j,H,Z,De):ee.tagProperty(j,H,De)}}I.optional=V},7014:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.postConstruct=void 0;var N=S(16674),x=S(6867),ee=S(47738);function V(){return function(j,H,Z){var De=new ee.Metadata(x.POST_CONSTRUCT,H);if(Reflect.hasOwnMetadata(x.POST_CONSTRUCT,j.constructor))throw new Error(N.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(x.POST_CONSTRUCT,De,j.constructor)}}I.postConstruct=V},32052:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.tagged=void 0;var N=S(47738),x=S(99934);function ee(V,j){return function(H,Z,De){var he=new N.Metadata(V,j);typeof De=="number"?x.tagParameter(H,Z,De,he):x.tagProperty(H,Z,he)}}I.tagged=ee},55638:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.targetName=void 0;var N=S(6867),x=S(47738),ee=S(99934);function V(j){return function(H,Z,De){var he=new x.Metadata(N.NAME_TAG,j);ee.tagParameter(H,Z,De,he)}}I.targetName=V},86757:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.unmanaged=void 0;var N=S(6867),x=S(47738),ee=S(99934);function V(){return function(j,H,Z){var De=new x.Metadata(N.UNMANAGED_TAG,!0);ee.tagParameter(j,H,Z,De)}}I.unmanaged=V},44290:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.Binding=void 0;var N=S(28421),x=S(37791),ee=function(){function V(j,H){this.id=x.id(),this.activated=!1,this.serviceIdentifier=j,this.scope=H,this.type=N.BindingTypeEnum.Invalid,this.constraint=function(Z){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return V.prototype.clone=function(){var j=new V(this.serviceIdentifier,this.scope);return j.activated=j.scope===N.BindingScopeEnum.Singleton?this.activated:!1,j.implementationType=this.implementationType,j.dynamicValue=this.dynamicValue,j.scope=this.scope,j.type=this.type,j.factory=this.factory,j.provider=this.provider,j.constraint=this.constraint,j.onActivation=this.onActivation,j.cache=this.cache,j},V}();I.Binding=ee},23184:function(we,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.BindingCount=void 0;var S={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};I.BindingCount=S},16674:function(we,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.STACK_OVERFLOW=I.CIRCULAR_DEPENDENCY_IN_FACTORY=I.POST_CONSTRUCT_ERROR=I.MULTIPLE_POST_CONSTRUCT_METHODS=I.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=I.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=I.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=I.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=I.ARGUMENTS_LENGTH_MISMATCH=I.INVALID_DECORATOR_OPERATION=I.INVALID_TO_SELF_VALUE=I.INVALID_FUNCTION_BINDING=I.INVALID_MIDDLEWARE_RETURN=I.NO_MORE_SNAPSHOTS_AVAILABLE=I.INVALID_BINDING_TYPE=I.NOT_IMPLEMENTED=I.CIRCULAR_DEPENDENCY=I.UNDEFINED_INJECT_ANNOTATION=I.MISSING_INJECT_ANNOTATION=I.MISSING_INJECTABLE_ANNOTATION=I.NOT_REGISTERED=I.CANNOT_UNBIND=I.AMBIGUOUS_MATCH=I.KEY_NOT_FOUND=I.NULL_ARGUMENT=I.DUPLICATED_METADATA=I.DUPLICATED_INJECTABLE_DECORATOR=void 0,I.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",I.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",I.NULL_ARGUMENT="NULL argument",I.KEY_NOT_FOUND="Key Not Found",I.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",I.CANNOT_UNBIND="Could not unbind serviceIdentifier:",I.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",I.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",I.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var S=function(V){return"@inject called with undefined this could mean that the class "+V+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};I.UNDEFINED_INJECT_ANNOTATION=S,I.CIRCULAR_DEPENDENCY="Circular dependency found:",I.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",I.INVALID_BINDING_TYPE="Invalid binding type:",I.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",I.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",I.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",I.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",I.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var N=function(){for(var V=[],j=0;j<arguments.length;j++)V[j]=arguments[j];return"The number of constructor arguments in the derived class "+(V[0]+" must be >= than the number of constructor arguments of its base class.")};I.ARGUMENTS_LENGTH_MISMATCH=N,I.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",I.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",I.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",I.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",I.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";var x=function(){for(var V=[],j=0;j<arguments.length;j++)V[j]=arguments[j];return"@postConstruct error in class "+V[0]+": "+V[1]};I.POST_CONSTRUCT_ERROR=x;var ee=function(){for(var V=[],j=0;j<arguments.length;j++)V[j]=arguments[j];return"It looks like there is a circular dependency "+("in one of the '"+V[0]+"' bindings. Please investigate bindings with")+("service identifier '"+V[1]+"'.")};I.CIRCULAR_DEPENDENCY_IN_FACTORY=ee,I.STACK_OVERFLOW="Maximum call stack size exceeded"},28421:function(we,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.TargetTypeEnum=I.BindingTypeEnum=I.BindingScopeEnum=void 0;var S={Request:"Request",Singleton:"Singleton",Transient:"Transient"};I.BindingScopeEnum=S;var N={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};I.BindingTypeEnum=N;var x={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};I.TargetTypeEnum=x},6867:function(we,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.NON_CUSTOM_TAG_KEYS=I.POST_CONSTRUCT=I.DESIGN_PARAM_TYPES=I.PARAM_TYPES=I.TAGGED_PROP=I.TAGGED=I.MULTI_INJECT_TAG=I.INJECT_TAG=I.OPTIONAL_TAG=I.UNMANAGED_TAG=I.NAME_TAG=I.NAMED_TAG=void 0,I.NAMED_TAG="named",I.NAME_TAG="name",I.UNMANAGED_TAG="unmanaged",I.OPTIONAL_TAG="optional",I.INJECT_TAG="inject",I.MULTI_INJECT_TAG="multi_inject",I.TAGGED="inversify:tagged",I.TAGGED_PROP="inversify:tagged_props",I.PARAM_TYPES="inversify:paramtypes",I.DESIGN_PARAM_TYPES="design:paramtypes",I.POST_CONSTRUCT="post_construct";function S(){return[I.INJECT_TAG,I.MULTI_INJECT_TAG,I.NAME_TAG,I.UNMANAGED_TAG,I.NAMED_TAG,I.OPTIONAL_TAG]}I.NON_CUSTOM_TAG_KEYS=S()},51389:function(we,I,S){"use strict";var N=this&&this.__awaiter||function(vt,Ne,Ae,xt){function at(tt){return tt instanceof Ae?tt:new Ae(function(St){St(tt)})}return new(Ae||(Ae=Promise))(function(tt,St){function Mt(en){try{pt(xt.next(en))}catch($n){St($n)}}function zt(en){try{pt(xt.throw(en))}catch($n){St($n)}}function pt(en){en.done?tt(en.value):at(en.value).then(Mt,zt)}pt((xt=xt.apply(vt,Ne||[])).next())})},x=this&&this.__generator||function(vt,Ne){var Ae={label:0,sent:function(){if(tt[0]&1)throw tt[1];return tt[1]},trys:[],ops:[]},xt,at,tt,St;return St={next:Mt(0),throw:Mt(1),return:Mt(2)},typeof Symbol=="function"&&(St[Symbol.iterator]=function(){return this}),St;function Mt(pt){return function(en){return zt([pt,en])}}function zt(pt){if(xt)throw new TypeError("Generator is already executing.");for(;Ae;)try{if(xt=1,at&&(tt=pt[0]&2?at.return:pt[0]?at.throw||((tt=at.return)&&tt.call(at),0):at.next)&&!(tt=tt.call(at,pt[1])).done)return tt;switch(at=0,tt&&(pt=[pt[0]&2,tt.value]),pt[0]){case 0:case 1:tt=pt;break;case 4:return Ae.label++,{value:pt[1],done:!1};case 5:Ae.label++,at=pt[1],pt=[0];continue;case 7:pt=Ae.ops.pop(),Ae.trys.pop();continue;default:if(tt=Ae.trys,!(tt=tt.length>0&&tt[tt.length-1])&&(pt[0]===6||pt[0]===2)){Ae=0;continue}if(pt[0]===3&&(!tt||pt[1]>tt[0]&&pt[1]<tt[3])){Ae.label=pt[1];break}if(pt[0]===6&&Ae.label<tt[1]){Ae.label=tt[1],tt=pt;break}if(tt&&Ae.label<tt[2]){Ae.label=tt[2],Ae.ops.push(pt);break}tt[2]&&Ae.ops.pop(),Ae.trys.pop();continue}pt=Ne.call(vt,Ae)}catch(en){pt=[6,en],at=0}finally{xt=tt=0}if(pt[0]&5)throw pt[1];return{value:pt[0]?pt[1]:void 0,done:!0}}},ee=this&&this.__spreadArray||function(vt,Ne){for(var Ae=0,xt=Ne.length,at=vt.length;Ae<xt;Ae++,at++)vt[at]=Ne[Ae];return vt};Object.defineProperty(I,"__esModule",{value:!0}),I.Container=void 0;var V=S(44290),j=S(16674),H=S(28421),Z=S(6867),De=S(51377),he=S(86311),me=S(31927),rt=S(51860),ke=S(37791),Gt=S(55800),Yt=S(85700),dt=S(80175),ht=function(){function vt(Ne){this._appliedMiddleware=[];var Ae=Ne||{};if(typeof Ae!="object")throw new Error(""+j.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(Ae.defaultScope===void 0)Ae.defaultScope=H.BindingScopeEnum.Transient;else if(Ae.defaultScope!==H.BindingScopeEnum.Singleton&&Ae.defaultScope!==H.BindingScopeEnum.Transient&&Ae.defaultScope!==H.BindingScopeEnum.Request)throw new Error(""+j.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(Ae.autoBindInjectable===void 0)Ae.autoBindInjectable=!1;else if(typeof Ae.autoBindInjectable!="boolean")throw new Error(""+j.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(Ae.skipBaseClassChecks===void 0)Ae.skipBaseClassChecks=!1;else if(typeof Ae.skipBaseClassChecks!="boolean")throw new Error(""+j.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:Ae.autoBindInjectable,defaultScope:Ae.defaultScope,skipBaseClassChecks:Ae.skipBaseClassChecks},this.id=ke.id(),this._bindingDictionary=new dt.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new De.MetadataReader}return vt.merge=function(Ne,Ae){for(var xt=[],at=2;at<arguments.length;at++)xt[at-2]=arguments[at];var tt=new vt,St=ee([Ne,Ae],xt).map(function(pt){return he.getBindingDictionary(pt)}),Mt=he.getBindingDictionary(tt);function zt(pt,en){pt.traverse(function($n,L){L.forEach(function(nt){en.add(nt.serviceIdentifier,nt.clone())})})}return St.forEach(function(pt){zt(pt,Mt)}),tt},vt.prototype.load=function(){for(var Ne=[],Ae=0;Ae<arguments.length;Ae++)Ne[Ae]=arguments[Ae];for(var xt=this._getContainerModuleHelpersFactory(),at=0,tt=Ne;at<tt.length;at++){var St=tt[at],Mt=xt(St.id);St.registry(Mt.bindFunction,Mt.unbindFunction,Mt.isboundFunction,Mt.rebindFunction)}},vt.prototype.loadAsync=function(){for(var Ne=[],Ae=0;Ae<arguments.length;Ae++)Ne[Ae]=arguments[Ae];return N(this,void 0,void 0,function(){var xt,at,tt,St,Mt;return x(this,function(zt){switch(zt.label){case 0:xt=this._getContainerModuleHelpersFactory(),at=0,tt=Ne,zt.label=1;case 1:return at<tt.length?(St=tt[at],Mt=xt(St.id),[4,St.registry(Mt.bindFunction,Mt.unbindFunction,Mt.isboundFunction,Mt.rebindFunction)]):[3,4];case 2:zt.sent(),zt.label=3;case 3:return at++,[3,1];case 4:return[2]}})})},vt.prototype.unload=function(){for(var Ne=this,Ae=[],xt=0;xt<arguments.length;xt++)Ae[xt]=arguments[xt];var at=function(tt){return function(St){return St.moduleId===tt}};Ae.forEach(function(tt){var St=at(tt.id);Ne._bindingDictionary.removeByCondition(St)})},vt.prototype.bind=function(Ne){var Ae=this.options.defaultScope||H.BindingScopeEnum.Transient,xt=new V.Binding(Ne,Ae);return this._bindingDictionary.add(Ne,xt),new rt.BindingToSyntax(xt)},vt.prototype.rebind=function(Ne){return this.unbind(Ne),this.bind(Ne)},vt.prototype.unbind=function(Ne){try{this._bindingDictionary.remove(Ne)}catch(Ae){throw new Error(j.CANNOT_UNBIND+" "+Gt.getServiceIdentifierAsString(Ne))}},vt.prototype.unbindAll=function(){this._bindingDictionary=new dt.Lookup},vt.prototype.isBound=function(Ne){var Ae=this._bindingDictionary.hasKey(Ne);return!Ae&&this.parent&&(Ae=this.parent.isBound(Ne)),Ae},vt.prototype.isBoundNamed=function(Ne,Ae){return this.isBoundTagged(Ne,Z.NAMED_TAG,Ae)},vt.prototype.isBoundTagged=function(Ne,Ae,xt){var at=!1;if(this._bindingDictionary.hasKey(Ne)){var tt=this._bindingDictionary.get(Ne),St=he.createMockRequest(this,Ne,Ae,xt);at=tt.some(function(Mt){return Mt.constraint(St)})}return!at&&this.parent&&(at=this.parent.isBoundTagged(Ne,Ae,xt)),at},vt.prototype.snapshot=function(){this._snapshots.push(Yt.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},vt.prototype.restore=function(){var Ne=this._snapshots.pop();if(Ne===void 0)throw new Error(j.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=Ne.bindings,this._middleware=Ne.middleware},vt.prototype.createChild=function(Ne){var Ae=new vt(Ne||this.options);return Ae.parent=this,Ae},vt.prototype.applyMiddleware=function(){for(var Ne=[],Ae=0;Ae<arguments.length;Ae++)Ne[Ae]=arguments[Ae];this._appliedMiddleware=this._appliedMiddleware.concat(Ne);var xt=this._middleware?this._middleware:this._planAndResolve();this._middleware=Ne.reduce(function(at,tt){return tt(at)},xt)},vt.prototype.applyCustomMetadataReader=function(Ne){this._metadataReader=Ne},vt.prototype.get=function(Ne){return this._get(!1,!1,H.TargetTypeEnum.Variable,Ne)},vt.prototype.getTagged=function(Ne,Ae,xt){return this._get(!1,!1,H.TargetTypeEnum.Variable,Ne,Ae,xt)},vt.prototype.getNamed=function(Ne,Ae){return this.getTagged(Ne,Z.NAMED_TAG,Ae)},vt.prototype.getAll=function(Ne){return this._get(!0,!0,H.TargetTypeEnum.Variable,Ne)},vt.prototype.getAllTagged=function(Ne,Ae,xt){return this._get(!1,!0,H.TargetTypeEnum.Variable,Ne,Ae,xt)},vt.prototype.getAllNamed=function(Ne,Ae){return this.getAllTagged(Ne,Z.NAMED_TAG,Ae)},vt.prototype.resolve=function(Ne){var Ae=this.createChild();return Ae.bind(Ne).toSelf(),this._appliedMiddleware.forEach(function(xt){Ae.applyMiddleware(xt)}),Ae.get(Ne)},vt.prototype._getContainerModuleHelpersFactory=function(){var Ne=this,Ae=function(Mt,zt){Mt._binding.moduleId=zt},xt=function(Mt){return function(zt){var pt=Ne.bind.bind(Ne),en=pt(zt);return Ae(en,Mt),en}},at=function(Mt){return function(zt){var pt=Ne.unbind.bind(Ne);pt(zt)}},tt=function(Mt){return function(zt){var pt=Ne.isBound.bind(Ne);return pt(zt)}},St=function(Mt){return function(zt){var pt=Ne.rebind.bind(Ne),en=pt(zt);return Ae(en,Mt),en}};return function(Mt){return{bindFunction:xt(Mt),isboundFunction:tt(Mt),rebindFunction:St(Mt),unbindFunction:at(Mt)}}},vt.prototype._get=function(Ne,Ae,xt,at,tt,St){var Mt=null,zt={avoidConstraints:Ne,contextInterceptor:function(pt){return pt},isMultiInject:Ae,key:tt,serviceIdentifier:at,targetType:xt,value:St};if(this._middleware){if(Mt=this._middleware(zt),Mt==null)throw new Error(j.INVALID_MIDDLEWARE_RETURN)}else Mt=this._planAndResolve()(zt);return Mt},vt.prototype._planAndResolve=function(){var Ne=this;return function(Ae){var xt=he.plan(Ne._metadataReader,Ne,Ae.isMultiInject,Ae.targetType,Ae.serviceIdentifier,Ae.key,Ae.value,Ae.avoidConstraints);xt=Ae.contextInterceptor(xt);var at=me.resolve(xt);return at}},vt}();I.Container=ht},33244:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.AsyncContainerModule=I.ContainerModule=void 0;var N=S(37791),x=function(){function V(j){this.id=N.id(),this.registry=j}return V}();I.ContainerModule=x;var ee=function(){function V(j){this.id=N.id(),this.registry=j}return V}();I.AsyncContainerModule=ee},85700:function(we,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.ContainerSnapshot=void 0;var S=function(){function N(){}return N.of=function(x,ee){var V=new N;return V.bindings=x,V.middleware=ee,V},N}();I.ContainerSnapshot=S},80175:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.Lookup=void 0;var N=S(16674),x=function(){function ee(){this._map=new Map}return ee.prototype.getMap=function(){return this._map},ee.prototype.add=function(V,j){if(V==null)throw new Error(N.NULL_ARGUMENT);if(j==null)throw new Error(N.NULL_ARGUMENT);var H=this._map.get(V);H!==void 0?(H.push(j),this._map.set(V,H)):this._map.set(V,[j])},ee.prototype.get=function(V){if(V==null)throw new Error(N.NULL_ARGUMENT);var j=this._map.get(V);if(j!==void 0)return j;throw new Error(N.KEY_NOT_FOUND)},ee.prototype.remove=function(V){if(V==null)throw new Error(N.NULL_ARGUMENT);if(!this._map.delete(V))throw new Error(N.KEY_NOT_FOUND)},ee.prototype.removeByCondition=function(V){var j=this;this._map.forEach(function(H,Z){var De=H.filter(function(he){return!V(he)});De.length>0?j._map.set(Z,De):j._map.delete(Z)})},ee.prototype.hasKey=function(V){if(V==null)throw new Error(N.NULL_ARGUMENT);return this._map.has(V)},ee.prototype.clone=function(){var V=new ee;return this._map.forEach(function(j,H){j.forEach(function(Z){return V.add(H,Z.clone())})}),V},ee.prototype.traverse=function(V){this._map.forEach(function(j,H){V(H,j)})},ee}();I.Lookup=x},86700:function(we,I,S){"use strict";var N;N={value:!0},N=N=N=N=N=N=N=N=N=N=N=N=N=N=N=I.f3=I.t6=N=I.b2=N=N=N=N=N=I.W2=N=void 0;var x=S(6867);N=x;var ee=S(51389);Object.defineProperty(I,"W2",{enumerable:!0,get:function(){return ee.Container}});var V=S(28421);N={enumerable:!0,get:function(){return V.BindingScopeEnum}},N={enumerable:!0,get:function(){return V.BindingTypeEnum}},N={enumerable:!0,get:function(){return V.TargetTypeEnum}};var j=S(33244);N={enumerable:!0,get:function(){return j.AsyncContainerModule}},N={enumerable:!0,get:function(){return j.ContainerModule}};var H=S(64315);Object.defineProperty(I,"b2",{enumerable:!0,get:function(){return H.injectable}});var Z=S(32052);N={enumerable:!0,get:function(){return Z.tagged}};var De=S(38085);Object.defineProperty(I,"t6",{enumerable:!0,get:function(){return De.named}});var he=S(5744);Object.defineProperty(I,"f3",{enumerable:!0,get:function(){return he.inject}}),N={enumerable:!0,get:function(){return he.LazyServiceIdentifer}};var me=S(6515);N={enumerable:!0,get:function(){return me.optional}};var rt=S(86757);N={enumerable:!0,get:function(){return rt.unmanaged}};var ke=S(71693);N={enumerable:!0,get:function(){return ke.multiInject}};var Gt=S(55638);N={enumerable:!0,get:function(){return Gt.targetName}};var Yt=S(7014);N={enumerable:!0,get:function(){return Yt.postConstruct}};var dt=S(51377);N={enumerable:!0,get:function(){return dt.MetadataReader}};var ht=S(37791);N={enumerable:!0,get:function(){return ht.id}};var vt=S(99934);N={enumerable:!0,get:function(){return vt.decorate}};var Ne=S(80758);N={enumerable:!0,get:function(){return Ne.traverseAncerstors}},N={enumerable:!0,get:function(){return Ne.taggedConstraint}},N={enumerable:!0,get:function(){return Ne.namedConstraint}},N={enumerable:!0,get:function(){return Ne.typeConstraint}};var Ae=S(55800);N={enumerable:!0,get:function(){return Ae.getServiceIdentifierAsString}};var xt=S(70600);N={enumerable:!0,get:function(){return xt.multiBindToService}}},95228:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.Context=void 0;var N=S(37791),x=function(){function ee(V){this.id=N.id(),this.container=V}return ee.prototype.addPlan=function(V){this.plan=V},ee.prototype.setCurrentRequest=function(V){this.currentRequest=V},ee}();I.Context=x},47738:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.Metadata=void 0;var N=S(6867),x=function(){function ee(V,j){this.key=V,this.value=j}return ee.prototype.toString=function(){return this.key===N.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},ee}();I.Metadata=x},51377:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.MetadataReader=void 0;var N=S(6867),x=function(){function ee(){}return ee.prototype.getConstructorMetadata=function(V){var j=Reflect.getMetadata(N.PARAM_TYPES,V),H=Reflect.getMetadata(N.TAGGED,V);return{compilerGeneratedMetadata:j,userGeneratedMetadata:H||{}}},ee.prototype.getPropertiesMetadata=function(V){var j=Reflect.getMetadata(N.TAGGED_PROP,V)||[];return j},ee}();I.MetadataReader=x},55314:function(we,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.Plan=void 0;var S=function(){function N(x,ee){this.parentContext=x,this.rootRequest=ee}return N}();I.Plan=S},86311:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.getBindingDictionary=I.createMockRequest=I.plan=void 0;var N=S(23184),x=S(16674),ee=S(28421),V=S(6867),j=S(85265),H=S(55800),Z=S(95228),De=S(47738),he=S(55314),me=S(6e3),rt=S(6748),ke=S(18924);function Gt(at){return at._bindingDictionary}I.getBindingDictionary=Gt;function Yt(at,tt,St,Mt,zt,pt){var en=at?V.MULTI_INJECT_TAG:V.INJECT_TAG,$n=new De.Metadata(en,St),L=new ke.Target(tt,Mt,St,$n);if(zt!==void 0){var nt=new De.Metadata(zt,pt);L.metadata.push(nt)}return L}function dt(at,tt,St,Mt,zt){var pt=Ne(St.container,zt.serviceIdentifier),en=[];return pt.length===N.BindingCount.NoBindingsAvailable&&St.container.options.autoBindInjectable&&typeof zt.serviceIdentifier=="function"&&at.getConstructorMetadata(zt.serviceIdentifier).compilerGeneratedMetadata&&(St.container.bind(zt.serviceIdentifier).toSelf(),pt=Ne(St.container,zt.serviceIdentifier)),tt?en=pt:en=pt.filter(function($n){var L=new rt.Request($n.serviceIdentifier,St,Mt,$n,zt);return $n.constraint(L)}),ht(zt.serviceIdentifier,en,zt,St.container),en}function ht(at,tt,St,Mt){switch(tt.length){case N.BindingCount.NoBindingsAvailable:if(St.isOptional())return tt;var zt=H.getServiceIdentifierAsString(at),pt=x.NOT_REGISTERED;throw pt+=H.listMetadataForTarget(zt,St),pt+=H.listRegisteredBindingsForServiceIdentifier(Mt,zt,Ne),new Error(pt);case N.BindingCount.OnlyOneBindingAvailable:if(!St.isArray())return tt;case N.BindingCount.MultipleBindingsAvailable:default:if(St.isArray())return tt;var zt=H.getServiceIdentifierAsString(at),pt=x.AMBIGUOUS_MATCH+" "+zt;throw pt+=H.listRegisteredBindingsForServiceIdentifier(Mt,zt,Ne),new Error(pt)}}function vt(at,tt,St,Mt,zt,pt){var en,$n;if(zt===null){en=dt(at,tt,Mt,null,pt),$n=new rt.Request(St,Mt,null,en,pt);var L=new he.Plan(Mt,$n);Mt.addPlan(L)}else en=dt(at,tt,Mt,zt,pt),$n=zt.addChildRequest(pt.serviceIdentifier,en,pt);en.forEach(function(nt){var $t=null;if(pt.isArray())$t=$n.addChildRequest(nt.serviceIdentifier,nt,pt);else{if(nt.cache)return;$t=$n}if(nt.type===ee.BindingTypeEnum.Instance&&nt.implementationType!==null){var ln=me.getDependencies(at,nt.implementationType);if(!Mt.container.options.skipBaseClassChecks){var jt=me.getBaseClassDependencyCount(at,nt.implementationType);if(ln.length<jt){var mn=x.ARGUMENTS_LENGTH_MISMATCH(me.getFunctionName(nt.implementationType));throw new Error(mn)}}ln.forEach(function(br){vt(at,!1,br.serviceIdentifier,Mt,$t,br)})}})}function Ne(at,tt){var St=[],Mt=Gt(at);return Mt.hasKey(tt)?St=Mt.get(tt):at.parent!==null&&(St=Ne(at.parent,tt)),St}function Ae(at,tt,St,Mt,zt,pt,en,$n){$n===void 0&&($n=!1);var L=new Z.Context(tt),nt=Yt(St,Mt,zt,"",pt,en);try{return vt(at,$n,zt,L,null,nt),L}catch($t){throw j.isStackOverflowExeption($t)&&L.plan&&H.circularDependencyToException(L.plan.rootRequest),$t}}I.plan=Ae;function xt(at,tt,St,Mt){var zt=new ke.Target(ee.TargetTypeEnum.Variable,"",tt,new De.Metadata(St,Mt)),pt=new Z.Context(at),en=new rt.Request(tt,pt,null,[],zt);return en}I.createMockRequest=xt},88460:function(we,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.QueryableString=void 0;var S=function(){function N(x){this.str=x}return N.prototype.startsWith=function(x){return this.str.indexOf(x)===0},N.prototype.endsWith=function(x){var ee="",V=x.split("").reverse().join("");return ee=this.str.split("").reverse().join(""),this.startsWith.call({str:ee},V)},N.prototype.contains=function(x){return this.str.indexOf(x)!==-1},N.prototype.equals=function(x){return this.str===x},N.prototype.value=function(){return this.str},N}();I.QueryableString=S},6e3:function(we,I,S){"use strict";var N=this&&this.__spreadArray||function(dt,ht){for(var vt=0,Ne=ht.length,Ae=dt.length;vt<Ne;vt++,Ae++)dt[Ae]=ht[vt];return dt};Object.defineProperty(I,"__esModule",{value:!0}),I.getFunctionName=I.getBaseClassDependencyCount=I.getDependencies=void 0;var x=S(5744),ee=S(16674),V=S(28421),j=S(6867),H=S(55800);Object.defineProperty(I,"getFunctionName",{enumerable:!0,get:function(){return H.getFunctionName}});var Z=S(18924);function De(dt,ht){var vt=H.getFunctionName(ht),Ne=he(dt,vt,ht,!1);return Ne}I.getDependencies=De;function he(dt,ht,vt,Ne){var Ae=dt.getConstructorMetadata(vt),xt=Ae.compilerGeneratedMetadata;if(xt===void 0){var at=ee.MISSING_INJECTABLE_ANNOTATION+" "+ht+".";throw new Error(at)}var tt=Ae.userGeneratedMetadata,St=Object.keys(tt),Mt=vt.length===0&&St.length>0,zt=St.length>vt.length,pt=Mt||zt?St.length:vt.length,en=rt(Ne,ht,xt,tt,pt),$n=ke(dt,vt),L=N(N([],en),$n);return L}function me(dt,ht,vt,Ne,Ae){var xt=Ae[dt.toString()]||[],at=Yt(xt),tt=at.unmanaged!==!0,St=Ne[dt],Mt=at.inject||at.multiInject;if(St=Mt||St,St instanceof x.LazyServiceIdentifer&&(St=St.unwrap()),tt){var zt=St===Object,pt=St===Function,en=St===void 0,$n=zt||pt||en;if(!ht&&$n){var L=ee.MISSING_INJECT_ANNOTATION+" argument "+dt+" in class "+vt+".";throw new Error(L)}var nt=new Z.Target(V.TargetTypeEnum.ConstructorArgument,at.targetName,St);return nt.metadata=xt,nt}return null}function rt(dt,ht,vt,Ne,Ae){for(var xt=[],at=0;at<Ae;at++){var tt=at,St=me(tt,dt,ht,vt,Ne);St!==null&&xt.push(St)}return xt}function ke(dt,ht){for(var vt=dt.getPropertiesMetadata(ht),Ne=[],Ae=Object.keys(vt),xt=0,at=Ae;xt<at.length;xt++){var tt=at[xt],St=vt[tt],Mt=Yt(vt[tt]),zt=Mt.targetName||tt,pt=Mt.inject||Mt.multiInject,en=new Z.Target(V.TargetTypeEnum.ClassProperty,zt,pt);en.metadata=St,Ne.push(en)}var $n=Object.getPrototypeOf(ht.prototype).constructor;if($n!==Object){var L=ke(dt,$n);Ne=N(N([],Ne),L)}return Ne}function Gt(dt,ht){var vt=Object.getPrototypeOf(ht.prototype).constructor;if(vt!==Object){var Ne=H.getFunctionName(vt),Ae=he(dt,Ne,vt,!0),xt=Ae.map(function(St){return St.metadata.filter(function(Mt){return Mt.key===j.UNMANAGED_TAG})}),at=[].concat.apply([],xt).length,tt=Ae.length-at;return tt>0?tt:Gt(dt,vt)}else return 0}I.getBaseClassDependencyCount=Gt;function Yt(dt){var ht={};return dt.forEach(function(vt){ht[vt.key.toString()]=vt.value}),{inject:ht[j.INJECT_TAG],multiInject:ht[j.MULTI_INJECT_TAG],targetName:ht[j.NAME_TAG],unmanaged:ht[j.UNMANAGED_TAG]}}},6748:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.Request=void 0;var N=S(37791),x=function(){function ee(V,j,H,Z,De){this.id=N.id(),this.serviceIdentifier=V,this.parentContext=j,this.parentRequest=H,this.target=De,this.childRequests=[],this.bindings=Array.isArray(Z)?Z:[Z],this.requestScope=H===null?new Map:null}return ee.prototype.addChildRequest=function(V,j,H){var Z=new ee(V,this.parentContext,this,j,H);return this.childRequests.push(Z),Z},ee}();I.Request=x},18924:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.Target=void 0;var N=S(6867),x=S(37791),ee=S(47738),V=S(88460),j=function(){function H(Z,De,he,me){this.id=x.id(),this.type=Z,this.serviceIdentifier=he,this.name=new V.QueryableString(De||""),this.metadata=new Array;var rt=null;typeof me=="string"?rt=new ee.Metadata(N.NAMED_TAG,me):me instanceof ee.Metadata&&(rt=me),rt!==null&&this.metadata.push(rt)}return H.prototype.hasTag=function(Z){for(var De=0,he=this.metadata;De<he.length;De++){var me=he[De];if(me.key===Z)return!0}return!1},H.prototype.isArray=function(){return this.hasTag(N.MULTI_INJECT_TAG)},H.prototype.matchesArray=function(Z){return this.matchesTag(N.MULTI_INJECT_TAG)(Z)},H.prototype.isNamed=function(){return this.hasTag(N.NAMED_TAG)},H.prototype.isTagged=function(){return this.metadata.some(function(Z){return N.NON_CUSTOM_TAG_KEYS.every(function(De){return Z.key!==De})})},H.prototype.isOptional=function(){return this.matchesTag(N.OPTIONAL_TAG)(!0)},H.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(Z){return Z.key===N.NAMED_TAG})[0]:null},H.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(Z){return N.NON_CUSTOM_TAG_KEYS.every(function(De){return Z.key!==De})}):null},H.prototype.matchesNamedTag=function(Z){return this.matchesTag(N.NAMED_TAG)(Z)},H.prototype.matchesTag=function(Z){var De=this;return function(he){for(var me=0,rt=De.metadata;me<rt.length;me++){var ke=rt[me];if(ke.key===Z&&ke.value===he)return!0}return!1}},H}();I.Target=j},52279:function(we,I,S){"use strict";var N=this&&this.__spreadArray||function(he,me){for(var rt=0,ke=me.length,Gt=he.length;rt<ke;rt++,Gt++)he[Gt]=me[rt];return he};Object.defineProperty(I,"__esModule",{value:!0}),I.resolveInstance=void 0;var x=S(16674),ee=S(28421),V=S(6867);function j(he,me,rt){var ke=me.filter(function(Yt){return Yt.target!==null&&Yt.target.type===ee.TargetTypeEnum.ClassProperty}),Gt=ke.map(rt);return ke.forEach(function(Yt,dt){var ht="";ht=Yt.target.name.value();var vt=Gt[dt];he[ht]=vt}),he}function H(he,me){return new(he.bind.apply(he,N([void 0],me)))}function Z(he,me){if(Reflect.hasMetadata(V.POST_CONSTRUCT,he)){var rt=Reflect.getMetadata(V.POST_CONSTRUCT,he);try{me[rt.value]()}catch(ke){throw new Error(x.POST_CONSTRUCT_ERROR(he.name,ke.message))}}}function De(he,me,rt){var ke=null;if(me.length>0){var Gt=me.filter(function(dt){return dt.target!==null&&dt.target.type===ee.TargetTypeEnum.ConstructorArgument}),Yt=Gt.map(rt);ke=H(he,Yt),ke=j(ke,me,rt)}else ke=new he;return Z(he,ke),ke}I.resolveInstance=De},31927:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.resolve=void 0;var N=S(16674),x=S(28421),ee=S(85265),V=S(55800),j=S(52279),H=function(he,me,rt){try{return rt()}catch(ke){throw ee.isStackOverflowExeption(ke)?new Error(N.CIRCULAR_DEPENDENCY_IN_FACTORY(he,me.toString())):ke}},Z=function(he){return function(me){me.parentContext.setCurrentRequest(me);var rt=me.bindings,ke=me.childRequests,Gt=me.target&&me.target.isArray(),Yt=!me.parentRequest||!me.parentRequest.target||!me.target||!me.parentRequest.target.matchesArray(me.target.serviceIdentifier);if(Gt&&Yt)return ke.map(function(xt){var at=Z(he);return at(xt)});var dt=null;if(me.target.isOptional()&&rt.length===0)return;var ht=rt[0],vt=ht.scope===x.BindingScopeEnum.Singleton,Ne=ht.scope===x.BindingScopeEnum.Request;if(vt&&ht.activated)return ht.cache;if(Ne&&he!==null&&he.has(ht.id))return he.get(ht.id);if(ht.type===x.BindingTypeEnum.ConstantValue)dt=ht.cache,ht.activated=!0;else if(ht.type===x.BindingTypeEnum.Function)dt=ht.cache,ht.activated=!0;else if(ht.type===x.BindingTypeEnum.Constructor)dt=ht.implementationType;else if(ht.type===x.BindingTypeEnum.DynamicValue&&ht.dynamicValue!==null)dt=H("toDynamicValue",ht.serviceIdentifier,function(){return ht.dynamicValue(me.parentContext)});else if(ht.type===x.BindingTypeEnum.Factory&&ht.factory!==null)dt=H("toFactory",ht.serviceIdentifier,function(){return ht.factory(me.parentContext)});else if(ht.type===x.BindingTypeEnum.Provider&&ht.provider!==null)dt=H("toProvider",ht.serviceIdentifier,function(){return ht.provider(me.parentContext)});else if(ht.type===x.BindingTypeEnum.Instance&&ht.implementationType!==null)dt=j.resolveInstance(ht.implementationType,ke,Z(he));else{var Ae=V.getServiceIdentifierAsString(me.serviceIdentifier);throw new Error(N.INVALID_BINDING_TYPE+" "+Ae)}return typeof ht.onActivation=="function"&&(dt=ht.onActivation(me.parentContext,dt)),vt&&(ht.cache=dt,ht.activated=!0),Ne&&he!==null&&!he.has(ht.id)&&he.set(ht.id,dt),dt}};function De(he){var me=Z(he.plan.rootRequest.requestScope);return me(he.plan.rootRequest)}I.resolve=De},83366:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.BindingInSyntax=void 0;var N=S(28421),x=S(71325),ee=function(){function V(j){this._binding=j}return V.prototype.inRequestScope=function(){return this._binding.scope=N.BindingScopeEnum.Request,new x.BindingWhenOnSyntax(this._binding)},V.prototype.inSingletonScope=function(){return this._binding.scope=N.BindingScopeEnum.Singleton,new x.BindingWhenOnSyntax(this._binding)},V.prototype.inTransientScope=function(){return this._binding.scope=N.BindingScopeEnum.Transient,new x.BindingWhenOnSyntax(this._binding)},V}();I.BindingInSyntax=ee},99812:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.BindingInWhenOnSyntax=void 0;var N=S(83366),x=S(51811),ee=S(98370),V=function(){function j(H){this._binding=H,this._bindingWhenSyntax=new ee.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new x.BindingOnSyntax(this._binding),this._bindingInSyntax=new N.BindingInSyntax(H)}return j.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},j.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},j.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},j.prototype.when=function(H){return this._bindingWhenSyntax.when(H)},j.prototype.whenTargetNamed=function(H){return this._bindingWhenSyntax.whenTargetNamed(H)},j.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},j.prototype.whenTargetTagged=function(H,Z){return this._bindingWhenSyntax.whenTargetTagged(H,Z)},j.prototype.whenInjectedInto=function(H){return this._bindingWhenSyntax.whenInjectedInto(H)},j.prototype.whenParentNamed=function(H){return this._bindingWhenSyntax.whenParentNamed(H)},j.prototype.whenParentTagged=function(H,Z){return this._bindingWhenSyntax.whenParentTagged(H,Z)},j.prototype.whenAnyAncestorIs=function(H){return this._bindingWhenSyntax.whenAnyAncestorIs(H)},j.prototype.whenNoAncestorIs=function(H){return this._bindingWhenSyntax.whenNoAncestorIs(H)},j.prototype.whenAnyAncestorNamed=function(H){return this._bindingWhenSyntax.whenAnyAncestorNamed(H)},j.prototype.whenAnyAncestorTagged=function(H,Z){return this._bindingWhenSyntax.whenAnyAncestorTagged(H,Z)},j.prototype.whenNoAncestorNamed=function(H){return this._bindingWhenSyntax.whenNoAncestorNamed(H)},j.prototype.whenNoAncestorTagged=function(H,Z){return this._bindingWhenSyntax.whenNoAncestorTagged(H,Z)},j.prototype.whenAnyAncestorMatches=function(H){return this._bindingWhenSyntax.whenAnyAncestorMatches(H)},j.prototype.whenNoAncestorMatches=function(H){return this._bindingWhenSyntax.whenNoAncestorMatches(H)},j.prototype.onActivation=function(H){return this._bindingOnSyntax.onActivation(H)},j}();I.BindingInWhenOnSyntax=V},51811:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.BindingOnSyntax=void 0;var N=S(98370),x=function(){function ee(V){this._binding=V}return ee.prototype.onActivation=function(V){return this._binding.onActivation=V,new N.BindingWhenSyntax(this._binding)},ee}();I.BindingOnSyntax=x},51860:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.BindingToSyntax=void 0;var N=S(16674),x=S(28421),ee=S(99812),V=S(71325),j=function(){function H(Z){this._binding=Z}return H.prototype.to=function(Z){return this._binding.type=x.BindingTypeEnum.Instance,this._binding.implementationType=Z,new ee.BindingInWhenOnSyntax(this._binding)},H.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+N.INVALID_TO_SELF_VALUE);var Z=this._binding.serviceIdentifier;return this.to(Z)},H.prototype.toConstantValue=function(Z){return this._binding.type=x.BindingTypeEnum.ConstantValue,this._binding.cache=Z,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=x.BindingScopeEnum.Singleton,new V.BindingWhenOnSyntax(this._binding)},H.prototype.toDynamicValue=function(Z){return this._binding.type=x.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=Z,this._binding.implementationType=null,new ee.BindingInWhenOnSyntax(this._binding)},H.prototype.toConstructor=function(Z){return this._binding.type=x.BindingTypeEnum.Constructor,this._binding.implementationType=Z,this._binding.scope=x.BindingScopeEnum.Singleton,new V.BindingWhenOnSyntax(this._binding)},H.prototype.toFactory=function(Z){return this._binding.type=x.BindingTypeEnum.Factory,this._binding.factory=Z,this._binding.scope=x.BindingScopeEnum.Singleton,new V.BindingWhenOnSyntax(this._binding)},H.prototype.toFunction=function(Z){if(typeof Z!="function")throw new Error(N.INVALID_FUNCTION_BINDING);var De=this.toConstantValue(Z);return this._binding.type=x.BindingTypeEnum.Function,this._binding.scope=x.BindingScopeEnum.Singleton,De},H.prototype.toAutoFactory=function(Z){return this._binding.type=x.BindingTypeEnum.Factory,this._binding.factory=function(De){var he=function(){return De.container.get(Z)};return he},this._binding.scope=x.BindingScopeEnum.Singleton,new V.BindingWhenOnSyntax(this._binding)},H.prototype.toProvider=function(Z){return this._binding.type=x.BindingTypeEnum.Provider,this._binding.provider=Z,this._binding.scope=x.BindingScopeEnum.Singleton,new V.BindingWhenOnSyntax(this._binding)},H.prototype.toService=function(Z){this.toDynamicValue(function(De){return De.container.get(Z)})},H}();I.BindingToSyntax=j},71325:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.BindingWhenOnSyntax=void 0;var N=S(51811),x=S(98370),ee=function(){function V(j){this._binding=j,this._bindingWhenSyntax=new x.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new N.BindingOnSyntax(this._binding)}return V.prototype.when=function(j){return this._bindingWhenSyntax.when(j)},V.prototype.whenTargetNamed=function(j){return this._bindingWhenSyntax.whenTargetNamed(j)},V.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},V.prototype.whenTargetTagged=function(j,H){return this._bindingWhenSyntax.whenTargetTagged(j,H)},V.prototype.whenInjectedInto=function(j){return this._bindingWhenSyntax.whenInjectedInto(j)},V.prototype.whenParentNamed=function(j){return this._bindingWhenSyntax.whenParentNamed(j)},V.prototype.whenParentTagged=function(j,H){return this._bindingWhenSyntax.whenParentTagged(j,H)},V.prototype.whenAnyAncestorIs=function(j){return this._bindingWhenSyntax.whenAnyAncestorIs(j)},V.prototype.whenNoAncestorIs=function(j){return this._bindingWhenSyntax.whenNoAncestorIs(j)},V.prototype.whenAnyAncestorNamed=function(j){return this._bindingWhenSyntax.whenAnyAncestorNamed(j)},V.prototype.whenAnyAncestorTagged=function(j,H){return this._bindingWhenSyntax.whenAnyAncestorTagged(j,H)},V.prototype.whenNoAncestorNamed=function(j){return this._bindingWhenSyntax.whenNoAncestorNamed(j)},V.prototype.whenNoAncestorTagged=function(j,H){return this._bindingWhenSyntax.whenNoAncestorTagged(j,H)},V.prototype.whenAnyAncestorMatches=function(j){return this._bindingWhenSyntax.whenAnyAncestorMatches(j)},V.prototype.whenNoAncestorMatches=function(j){return this._bindingWhenSyntax.whenNoAncestorMatches(j)},V.prototype.onActivation=function(j){return this._bindingOnSyntax.onActivation(j)},V}();I.BindingWhenOnSyntax=ee},98370:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.BindingWhenSyntax=void 0;var N=S(51811),x=S(80758),ee=function(){function V(j){this._binding=j}return V.prototype.when=function(j){return this._binding.constraint=j,new N.BindingOnSyntax(this._binding)},V.prototype.whenTargetNamed=function(j){return this._binding.constraint=x.namedConstraint(j),new N.BindingOnSyntax(this._binding)},V.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(j){var H=j.target!==null&&!j.target.isNamed()&&!j.target.isTagged();return H},new N.BindingOnSyntax(this._binding)},V.prototype.whenTargetTagged=function(j,H){return this._binding.constraint=x.taggedConstraint(j)(H),new N.BindingOnSyntax(this._binding)},V.prototype.whenInjectedInto=function(j){return this._binding.constraint=function(H){return x.typeConstraint(j)(H.parentRequest)},new N.BindingOnSyntax(this._binding)},V.prototype.whenParentNamed=function(j){return this._binding.constraint=function(H){return x.namedConstraint(j)(H.parentRequest)},new N.BindingOnSyntax(this._binding)},V.prototype.whenParentTagged=function(j,H){return this._binding.constraint=function(Z){return x.taggedConstraint(j)(H)(Z.parentRequest)},new N.BindingOnSyntax(this._binding)},V.prototype.whenAnyAncestorIs=function(j){return this._binding.constraint=function(H){return x.traverseAncerstors(H,x.typeConstraint(j))},new N.BindingOnSyntax(this._binding)},V.prototype.whenNoAncestorIs=function(j){return this._binding.constraint=function(H){return!x.traverseAncerstors(H,x.typeConstraint(j))},new N.BindingOnSyntax(this._binding)},V.prototype.whenAnyAncestorNamed=function(j){return this._binding.constraint=function(H){return x.traverseAncerstors(H,x.namedConstraint(j))},new N.BindingOnSyntax(this._binding)},V.prototype.whenNoAncestorNamed=function(j){return this._binding.constraint=function(H){return!x.traverseAncerstors(H,x.namedConstraint(j))},new N.BindingOnSyntax(this._binding)},V.prototype.whenAnyAncestorTagged=function(j,H){return this._binding.constraint=function(Z){return x.traverseAncerstors(Z,x.taggedConstraint(j)(H))},new N.BindingOnSyntax(this._binding)},V.prototype.whenNoAncestorTagged=function(j,H){return this._binding.constraint=function(Z){return!x.traverseAncerstors(Z,x.taggedConstraint(j)(H))},new N.BindingOnSyntax(this._binding)},V.prototype.whenAnyAncestorMatches=function(j){return this._binding.constraint=function(H){return x.traverseAncerstors(H,j)},new N.BindingOnSyntax(this._binding)},V.prototype.whenNoAncestorMatches=function(j){return this._binding.constraint=function(H){return!x.traverseAncerstors(H,j)},new N.BindingOnSyntax(this._binding)},V}();I.BindingWhenSyntax=ee},80758:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.typeConstraint=I.namedConstraint=I.taggedConstraint=I.traverseAncerstors=void 0;var N=S(6867),x=S(47738),ee=function(Z,De){var he=Z.parentRequest;return he!==null?De(he)?!0:ee(he,De):!1};I.traverseAncerstors=ee;var V=function(Z){return function(De){var he=function(me){return me!==null&&me.target!==null&&me.target.matchesTag(Z)(De)};return he.metaData=new x.Metadata(Z,De),he}};I.taggedConstraint=V;var j=V(N.NAMED_TAG);I.namedConstraint=j;var H=function(Z){return function(De){var he=null;if(De!==null)if(he=De.bindings[0],typeof Z=="string"){var me=he.serviceIdentifier;return me===Z}else{var rt=De.bindings[0].implementationType;return Z===rt}return!1}};I.typeConstraint=H},70600:function(we,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.multiBindToService=void 0;var S=function(N){return function(x){return function(){for(var ee=[],V=0;V<arguments.length;V++)ee[V]=arguments[V];return ee.forEach(function(j){return N.bind(j).toService(x)})}}};I.multiBindToService=S},85265:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.isStackOverflowExeption=void 0;var N=S(16674);function x(ee){return ee instanceof RangeError||ee.message===N.STACK_OVERFLOW}I.isStackOverflowExeption=x},37791:function(we,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.id=void 0;var S=0;function N(){return S++}I.id=N},55800:function(we,I,S){"use strict";Object.defineProperty(I,"__esModule",{value:!0}),I.circularDependencyToException=I.listMetadataForTarget=I.listRegisteredBindingsForServiceIdentifier=I.getServiceIdentifierAsString=I.getFunctionName=void 0;var N=S(16674);function x(he){if(typeof he=="function"){var me=he;return me.name}else{if(typeof he=="symbol")return he.toString();var me=he;return me}}I.getServiceIdentifierAsString=x;function ee(he,me,rt){var ke="",Gt=rt(he,me);return Gt.length!==0&&(ke=`
Registered bindings:`,Gt.forEach(function(Yt){var dt="Object";Yt.implementationType!==null&&(dt=De(Yt.implementationType)),ke=ke+`
 `+dt,Yt.constraint.metaData&&(ke=ke+" - "+Yt.constraint.metaData)})),ke}I.listRegisteredBindingsForServiceIdentifier=ee;function V(he,me){return he.parentRequest===null?!1:he.parentRequest.serviceIdentifier===me?!0:V(he.parentRequest,me)}function j(he){function me(ke,Gt){Gt===void 0&&(Gt=[]);var Yt=x(ke.serviceIdentifier);return Gt.push(Yt),ke.parentRequest!==null?me(ke.parentRequest,Gt):Gt}var rt=me(he);return rt.reverse().join(" --> ")}function H(he){he.childRequests.forEach(function(me){if(V(me,me.serviceIdentifier)){var rt=j(me);throw new Error(N.CIRCULAR_DEPENDENCY+" "+rt)}else H(me)})}I.circularDependencyToException=H;function Z(he,me){if(me.isTagged()||me.isNamed()){var rt="",ke=me.getNamedTag(),Gt=me.getCustomTags();return ke!==null&&(rt+=ke.toString()+`
`),Gt!==null&&Gt.forEach(function(Yt){rt+=Yt.toString()+`
`})," "+he+`
 `+he+" - "+rt}else return" "+he}I.listMetadataForTarget=Z;function De(he){if(he.name)return he.name;var me=he.toString(),rt=me.match(/^function\s*([^\s(]+)/);return rt?rt[1]:"Anonymous function: "+me}I.getFunctionName=De},96486:function(we,I,S){we=S.nmd(we);var N;/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(){var x,ee="4.17.21",V=200,j="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",H="Expected a function",Z="Invalid `variable` option passed into `_.template`",De="__lodash_hash_undefined__",he=500,me="__lodash_placeholder__",rt=1,ke=2,Gt=4,Yt=1,dt=2,ht=1,vt=2,Ne=4,Ae=8,xt=16,at=32,tt=64,St=128,Mt=256,zt=512,pt=30,en="...",$n=800,L=16,nt=1,$t=2,ln=3,jt=1/0,mn=9007199254740991,br=17976931348623157e292,fi=0/0,Nr=4294967295,pr=Nr-1,ti=Nr>>>1,mr=[["ary",St],["bind",ht],["bindKey",vt],["curry",Ae],["curryRight",xt],["flip",zt],["partial",at],["partialRight",tt],["rearg",Mt]],zr="[object Arguments]",Ha="[object Array]",Jn="[object AsyncFunction]",Bi="[object Boolean]",Xa="[object Date]",Su="[object DOMException]",vo="[object Error]",Hi="[object Function]",ds="[object GeneratorFunction]",gi="[object Map]",li="[object Number]",Tu="[object Null]",Xi="[object Object]",Zs="[object Promise]",hs="[object Proxy]",k="[object RegExp]",$i="[object Set]",Wr="[object String]",vs="[object Symbol]",Uo="[object Undefined]",zi="[object WeakMap]",$a="[object WeakSet]",xe="[object ArrayBuffer]",Xe="[object DataView]",bt="[object Float32Array]",Ft="[object Float64Array]",Wt="[object Int8Array]",Rn="[object Int16Array]",Pn="[object Int32Array]",Un="[object Uint8Array]",an="[object Uint8ClampedArray]",ir="[object Uint16Array]",nr="[object Uint32Array]",wa=/\b__p \+= '';/g,Au=/\b(__p \+=) '' \+/g,Bo=/(__e\(.*?\)|\b__t\)) \+\n'';/g,zo=/&(?:amp|lt|gt|quot|#39);/g,ps=/[&<>"']/g,uf=RegExp(zo.source),di=RegExp(ps.source),js=/<%-([\s\S]+?)%>/g,Iu=/<%([\s\S]+?)%>/g,po=/<%=([\s\S]+?)%>/g,Cu=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ya=/^\w*$/,cf=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ru=/[\\^$.*+?()[\]{}|]/g,ff=RegExp(Ru.source),ms=/^\s+/,pc=/\s/,Xr=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Mu=/\{\n\/\* \[wrapped with (.+)\] \*/,ll=/,? & /,ft=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ue=/[()=,{}\[\]\/\s]/,Dt=/\\(\\)?/g,je=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,kt=/\w*$/,Lt=/^[-+]0x[0-9a-f]+$/i,on=/^0b[01]+$/i,qt=/^\[object .+?Constructor\]$/,Nt=/^0o[0-7]+$/i,dn=/^(?:0|[1-9]\d*)$/,yn=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,rr=/($^)/,cr=/['\n\r\u2028\u2029\\]/g,Or="\\ud800-\\udfff",Lr="\\u0300-\\u036f",Li="\\ufe20-\\ufe2f",Yi="\\u20d0-\\u20ff",ni=Lr+Li+Yi,Ci="\\u2700-\\u27bf",Gi="a-z\\xdf-\\xf6\\xf8-\\xff",Ki="\\xac\\xb1\\xd7\\xf7",Hn="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",yi="\\u2000-\\u206f",Ri=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",La="A-Z\\xc0-\\xd6\\xd8-\\xde",oa="\\ufe0e\\ufe0f",sa=Ki+Hn+yi+Ri,mo="['\u2019]",gs="["+Or+"]",hi="["+sa+"]",va="["+ni+"]",Wo="\\d+",Ga="["+Ci+"]",ys="["+Gi+"]",pa="[^"+Or+sa+Wo+Ci+Gi+La+"]",ka="\\ud83c[\\udffb-\\udfff]",Vo="(?:"+va+"|"+ka+")",_i="[^"+Or+"]",Fr="(?:\\ud83c[\\udde6-\\uddff]){2}",Wi="[\\ud800-\\udbff][\\udc00-\\udfff]",xa="["+La+"]",ua="\\u200d",Zo="(?:"+ys+"|"+pa+")",go="(?:"+xa+"|"+pa+")",Ei="(?:"+mo+"(?:d|ll|m|re|s|t|ve))?",jo="(?:"+mo+"(?:D|LL|M|RE|S|T|VE))?",na=Vo+"?",yo="["+oa+"]?",_s="(?:"+ua+"(?:"+[_i,Fr,Wi].join("|")+")"+yo+na+")*",Ho="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Sa="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",yr=yo+na+_s,fr="(?:"+[Ga,Fr,Wi].join("|")+")"+yr,vi="(?:"+[_i+va+"?",va,Fr,Wi,gs].join("|")+")",qi=RegExp(mo,"g"),bi=RegExp(va,"g"),_o=RegExp(ka+"(?="+ka+")|"+vi+yr,"g"),Xo=RegExp([xa+"?"+ys+"+"+Ei+"(?="+[hi,xa,"$"].join("|")+")",go+"+"+jo+"(?="+[hi,xa+Zo,"$"].join("|")+")",xa+"?"+Zo+"+"+Ei,xa+"+"+jo,Sa,Ho,Wo,fr].join("|"),"g"),Fa=RegExp("["+ua+Or+ni+oa+"]"),Eo=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Es=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Hs=-1,Mn={};Mn[bt]=Mn[Ft]=Mn[Wt]=Mn[Rn]=Mn[Pn]=Mn[Un]=Mn[an]=Mn[ir]=Mn[nr]=!0,Mn[zr]=Mn[Ha]=Mn[xe]=Mn[Bi]=Mn[Xe]=Mn[Xa]=Mn[vo]=Mn[Hi]=Mn[gi]=Mn[li]=Mn[Xi]=Mn[k]=Mn[$i]=Mn[Wr]=Mn[zi]=!1;var Bn={};Bn[zr]=Bn[Ha]=Bn[xe]=Bn[Xe]=Bn[Bi]=Bn[Xa]=Bn[bt]=Bn[Ft]=Bn[Wt]=Bn[Rn]=Bn[Pn]=Bn[gi]=Bn[li]=Bn[Xi]=Bn[k]=Bn[$i]=Bn[Wr]=Bn[vs]=Bn[Un]=Bn[an]=Bn[ir]=Bn[nr]=!0,Bn[vo]=Bn[Hi]=Bn[zi]=!1;var $o={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Mi={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},mc={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},gc={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},lf=parseFloat,df=parseInt,Vi=typeof S.g=="object"&&S.g&&S.g.Object===Object&&S.g,Yn=typeof self=="object"&&self&&self.Object===Object&&self,Zn=Vi||Yn||Function("return this")(),$r=I&&!I.nodeType&&I,zn=$r&&!0&&we&&!we.nodeType&&we,Rr=zn&&zn.exports===$r,ri=Rr&&Vi.process,Mr=function(){try{var ge=zn&&zn.require&&zn.require("util").types;return ge||ri&&ri.binding&&ri.binding("util")}catch(Ye){}}(),Ua=Mr&&Mr.isArrayBuffer,Ar=Mr&&Mr.isDate,yc=Mr&&Mr.isMap,bs=Mr&&Mr.isRegExp,dl=Mr&&Mr.isSet,Xs=Mr&&Mr.isTypedArray;function ma(ge,Ye,Pe){switch(Pe.length){case 0:return ge.call(Ye);case 1:return ge.call(Ye,Pe[0]);case 2:return ge.call(Ye,Pe[0],Pe[1]);case 3:return ge.call(Ye,Pe[0],Pe[1],Pe[2])}return ge.apply(Ye,Pe)}function $s(ge,Ye,Pe,Vt){for(var kn=-1,dr=ge==null?0:ge.length;++kn<dr;){var Kr=ge[kn];Ye(Vt,Kr,Pe(Kr),ge)}return Vt}function ga(ge,Ye){for(var Pe=-1,Vt=ge==null?0:ge.length;++Pe<Vt&&Ye(ge[Pe],Pe,ge)!==!1;);return ge}function ad(ge,Ye){for(var Pe=ge==null?0:ge.length;Pe--&&Ye(ge[Pe],Pe,ge)!==!1;);return ge}function od(ge,Ye){for(var Pe=-1,Vt=ge==null?0:ge.length;++Pe<Vt;)if(!Ye(ge[Pe],Pe,ge))return!1;return!0}function ws(ge,Ye){for(var Pe=-1,Vt=ge==null?0:ge.length,kn=0,dr=[];++Pe<Vt;){var Kr=ge[Pe];Ye(Kr,Pe,ge)&&(dr[kn++]=Kr)}return dr}function _c(ge,Ye){var Pe=ge==null?0:ge.length;return!!Pe&&Ka(ge,Ye,0)>-1}function hf(ge,Ye,Pe){for(var Vt=-1,kn=ge==null?0:ge.length;++Vt<kn;)if(Pe(Ye,ge[Vt]))return!0;return!1}function Yr(ge,Ye){for(var Pe=-1,Vt=ge==null?0:ge.length,kn=Array(Vt);++Pe<Vt;)kn[Pe]=Ye(ge[Pe],Pe,ge);return kn}function Yo(ge,Ye){for(var Pe=-1,Vt=Ye.length,kn=ge.length;++Pe<Vt;)ge[kn+Pe]=Ye[Pe];return ge}function Gr(ge,Ye,Pe,Vt){var kn=-1,dr=ge==null?0:ge.length;for(Vt&&dr&&(Pe=ge[++kn]);++kn<dr;)Pe=Ye(Pe,ge[kn],kn,ge);return Pe}function hl(ge,Ye,Pe,Vt){var kn=ge==null?0:ge.length;for(Vt&&kn&&(Pe=ge[--kn]);kn--;)Pe=Ye(Pe,ge[kn],kn,ge);return Pe}function vl(ge,Ye){for(var Pe=-1,Vt=ge==null?0:ge.length;++Pe<Vt;)if(Ye(ge[Pe],Pe,ge))return!0;return!1}var bo=Ko("length");function pl(ge){return ge.split("")}function vf(ge){return ge.match(ft)||[]}function xs(ge,Ye,Pe){var Vt;return Pe(ge,function(kn,dr,Kr){if(Ye(kn,dr,Kr))return Vt=dr,!1}),Vt}function Nu(ge,Ye,Pe,Vt){for(var kn=ge.length,dr=Pe+(Vt?1:-1);Vt?dr--:++dr<kn;)if(Ye(ge[dr],dr,ge))return dr;return-1}function Ka(ge,Ye,Pe){return Ye===Ye?_f(ge,Ye,Pe):Nu(ge,Du,Pe)}function Ss(ge,Ye,Pe,Vt){for(var kn=Pe-1,dr=ge.length;++kn<dr;)if(Vt(ge[kn],Ye))return kn;return-1}function Du(ge){return ge!==ge}function ml(ge,Ye){var Pe=ge==null?0:ge.length;return Pe?mf(ge,Ye)/Pe:fi}function Ko(ge){return function(Ye){return Ye==null?x:Ye[ge]}}function Ts(ge){return function(Ye){return ge==null?x:ge[Ye]}}function pf(ge,Ye,Pe,Vt,kn){return kn(ge,function(dr,Kr,wr){Pe=Vt?(Vt=!1,dr):Ye(Pe,dr,Kr,wr)}),Pe}function Fh(ge,Ye){var Pe=ge.length;for(ge.sort(Ye);Pe--;)ge[Pe]=ge[Pe].value;return ge}function mf(ge,Ye){for(var Pe,Vt=-1,kn=ge.length;++Vt<kn;){var dr=Ye(ge[Vt]);dr!==x&&(Pe=Pe===x?dr:Pe+dr)}return Pe}function gl(ge,Ye){for(var Pe=-1,Vt=Array(ge);++Pe<ge;)Vt[Pe]=Ye(Pe);return Vt}function yl(ge,Ye){return Yr(Ye,function(Pe){return[Pe,ge[Pe]]})}function Ec(ge){return ge&&ge.slice(0,Ef(ge)+1).replace(ms,"")}function ca(ge){return function(Ye){return ge(Ye)}}function bc(ge,Ye){return Yr(Ye,function(Pe){return ge[Pe]})}function wo(ge,Ye){return ge.has(Ye)}function gf(ge,Ye){for(var Pe=-1,Vt=ge.length;++Pe<Vt&&Ka(Ye,ge[Pe],0)>-1;);return Pe}function yf(ge,Ye){for(var Pe=ge.length;Pe--&&Ka(Ye,ge[Pe],0)>-1;);return Pe}function _l(ge,Ye){for(var Pe=ge.length,Vt=0;Pe--;)ge[Pe]===Ye&&++Vt;return Vt}var El=Ts($o),sd=Ts(Mi);function ud(ge){return"\\"+gc[ge]}function cd(ge,Ye){return ge==null?x:ge[Ye]}function As(ge){return Fa.test(ge)}function fd(ge){return Eo.test(ge)}function ld(ge){for(var Ye,Pe=[];!(Ye=ge.next()).done;)Pe.push(Ye.value);return Pe}function bl(ge){var Ye=-1,Pe=Array(ge.size);return ge.forEach(function(Vt,kn){Pe[++Ye]=[kn,Vt]}),Pe}function dd(ge,Ye){return function(Pe){return ge(Ye(Pe))}}function Ba(ge,Ye){for(var Pe=-1,Vt=ge.length,kn=0,dr=[];++Pe<Vt;){var Kr=ge[Pe];(Kr===Ye||Kr===me)&&(ge[Pe]=me,dr[kn++]=Pe)}return dr}function wc(ge){var Ye=-1,Pe=Array(ge.size);return ge.forEach(function(Vt){Pe[++Ye]=Vt}),Pe}function hd(ge){var Ye=-1,Pe=Array(ge.size);return ge.forEach(function(Vt){Pe[++Ye]=[Vt,Vt]}),Pe}function _f(ge,Ye,Pe){for(var Vt=Pe-1,kn=ge.length;++Vt<kn;)if(ge[Vt]===Ye)return Vt;return-1}function Uh(ge,Ye,Pe){for(var Vt=Pe+1;Vt--;)if(ge[Vt]===Ye)return Vt;return Vt}function Pu(ge){return As(ge)?wl(ge):bo(ge)}function qa(ge){return As(ge)?zh(ge):pl(ge)}function Ef(ge){for(var Ye=ge.length;Ye--&&pc.test(ge.charAt(Ye)););return Ye}var Bh=Ts(mc);function wl(ge){for(var Ye=_o.lastIndex=0;_o.test(ge);)++Ye;return Ye}function zh(ge){return ge.match(_o)||[]}function xc(ge){return ge.match(Xo)||[]}var Wh=function ge(Ye){Ye=Ye==null?Zn:Ou.defaults(Zn.Object(),Ye,Ou.pick(Zn,Es));var Pe=Ye.Array,Vt=Ye.Date,kn=Ye.Error,dr=Ye.Function,Kr=Ye.Math,wr=Ye.Object,bf=Ye.RegExp,ip=Ye.String,Ja=Ye.TypeError,Sc=Pe.prototype,Lu=dr.prototype,xo=wr.prototype,wf=Ye["__core-js_shared__"],Is=Lu.toString,Kn=xo.hasOwnProperty,Gu=0,xf=function(){var u=/[^.]+$/.exec(wf&&wf.keys&&wf.keys.IE_PROTO||"");return u?"Symbol(src)_1."+u:""}(),ku=xo.toString,Sf=Is.call(wr),vd=Zn._,pd=bf("^"+Is.call(Kn).replace(Ru,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Tf=Rr?Ye.Buffer:x,qo=Ye.Symbol,Qa=Ye.Uint8Array,Ni=Tf?Tf.allocUnsafe:x,Ta=dd(wr.getPrototypeOf,wr),md=wr.create,Jo=xo.propertyIsEnumerable,Tc=Sc.splice,Af=qo?qo.isConcatSpreadable:x,Ac=qo?qo.iterator:x,Cs=qo?qo.toStringTag:x,Ic=function(){try{var u=$e(wr,"defineProperty");return u({},"",{}),u}catch(l){}}(),ap=Ye.clearTimeout!==Zn.clearTimeout&&Ye.clearTimeout,xl=Vt&&Vt.now!==Zn.Date.now&&Vt.now,gd=Ye.setTimeout!==Zn.setTimeout&&Ye.setTimeout,If=Kr.ceil,Fu=Kr.floor,Cf=wr.getOwnPropertySymbols,Vh=Tf?Tf.isBuffer:x,Uu=Ye.isFinite,yd=Sc.join,Rs=dd(wr.keys,wr),pi=Kr.max,Ji=Kr.min,_d=Vt.now,Ed=Ye.parseInt,Rf=Kr.random,bd=Sc.reverse,Mf=$e(Ye,"DataView"),Bu=$e(Ye,"Map"),Cc=$e(Ye,"Promise"),Ys=$e(Ye,"Set"),fa=$e(Ye,"WeakMap"),zu=$e(wr,"create"),Nf=fa&&new fa,Aa={},Sl=Qr(Mf),Ks=Qr(Bu),Rc=Qr(Cc),wd=Qr(Ys),xd=Qr(fa),Df=qo?qo.prototype:x,qs=Df?Df.valueOf:x,Tl=Df?Df.toString:x;function P(u){if(xi(u)&&!qn(u)&&!(u instanceof lr)){if(u instanceof za)return u;if(Kn.call(u,"__wrapped__"))return _n(u)}return new za(u)}var Wu=function(){function u(){}return function(l){if(!ci(l))return{};if(md)return md(l);u.prototype=l;var p=new u;return u.prototype=x,p}}();function Pf(){}function za(u,l){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!l,this.__index__=0,this.__values__=x}P.templateSettings={escape:js,evaluate:Iu,interpolate:po,variable:"",imports:{_:P}},P.prototype=Pf.prototype,P.prototype.constructor=P,za.prototype=Wu(Pf.prototype),za.prototype.constructor=za;function lr(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Nr,this.__views__=[]}function Sd(){var u=new lr(this.__wrapped__);return u.__actions__=la(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=la(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=la(this.__views__),u}function Zh(){if(this.__filtered__){var u=new lr(this);u.__dir__=-1,u.__filtered__=!0}else u=this.clone(),u.__dir__*=-1;return u}function Of(){var u=this.__wrapped__.value(),l=this.__dir__,p=qn(u),w=l<0,M=p?u.length:0,F=Et(0,M,this.__views__),J=F.start,ue=F.end,be=ue-J,ct=w?ue:J-1,et=this.__iteratees__,wt=et.length,Xt=0,sn=Ji(be,this.__takeCount__);if(!p||!w&&M==be&&sn==be)return rs(u,this.__actions__);var Ln=[];e:for(;be--&&Xt<sn;){ct+=l;for(var ur=-1,Gn=u[ct];++ur<wt;){var hr=et[ur],_r=hr.iteratee,co=hr.type,Da=_r(Gn);if(co==$t)Gn=Da;else if(!Da){if(co==nt)continue e;break e}}Ln[Xt++]=Gn}return Ln}lr.prototype=Wu(Pf.prototype),lr.prototype.constructor=lr;function Ms(u){var l=-1,p=u==null?0:u.length;for(this.clear();++l<p;){var w=u[l];this.set(w[0],w[1])}}function Al(){this.__data__=zu?zu(null):{},this.size=0}function Td(u){var l=this.has(u)&&delete this.__data__[u];return this.size-=l?1:0,l}function Ad(u){var l=this.__data__;if(zu){var p=l[u];return p===De?x:p}return Kn.call(l,u)?l[u]:x}function Mc(u){var l=this.__data__;return zu?l[u]!==x:Kn.call(l,u)}function jh(u,l){var p=this.__data__;return this.size+=this.has(u)?0:1,p[u]=zu&&l===x?De:l,this}Ms.prototype.clear=Al,Ms.prototype.delete=Td,Ms.prototype.get=Ad,Ms.prototype.has=Mc,Ms.prototype.set=jh;function Ns(u){var l=-1,p=u==null?0:u.length;for(this.clear();++l<p;){var w=u[l];this.set(w[0],w[1])}}function Id(){this.__data__=[],this.size=0}function Hh(u){var l=this.__data__,p=To(l,u);if(p<0)return!1;var w=l.length-1;return p==w?l.pop():Tc.call(l,p,1),--this.size,!0}function Xh(u){var l=this.__data__,p=To(l,u);return p<0?x:l[p][1]}function Cd(u){return To(this.__data__,u)>-1}function op(u,l){var p=this.__data__,w=To(p,u);return w<0?(++this.size,p.push([u,l])):p[w][1]=l,this}Ns.prototype.clear=Id,Ns.prototype.delete=Hh,Ns.prototype.get=Xh,Ns.prototype.has=Cd,Ns.prototype.set=op;function Qo(u){var l=-1,p=u==null?0:u.length;for(this.clear();++l<p;){var w=u[l];this.set(w[0],w[1])}}function sp(){this.size=0,this.__data__={hash:new Ms,map:new(Bu||Ns),string:new Ms}}function $h(u){var l=Ee(this,u).delete(u);return this.size-=l?1:0,l}function Yh(u){return Ee(this,u).get(u)}function Vu(u){return Ee(this,u).has(u)}function Kh(u,l){var p=Ee(this,u),w=p.size;return p.set(u,l),this.size+=p.size==w?0:1,this}Qo.prototype.clear=sp,Qo.prototype.delete=$h,Qo.prototype.get=Yh,Qo.prototype.has=Vu,Qo.prototype.set=Kh;function Js(u){var l=-1,p=u==null?0:u.length;for(this.__data__=new Qo;++l<p;)this.add(u[l])}function Rd(u){return this.__data__.set(u,De),this}function Lf(u){return this.__data__.has(u)}Js.prototype.add=Js.prototype.push=Rd,Js.prototype.has=Lf;function eo(u){var l=this.__data__=new Ns(u);this.size=l.size}function Md(){this.__data__=new Ns,this.size=0}function Nd(u){var l=this.__data__,p=l.delete(u);return this.size=l.size,p}function qh(u){return this.__data__.get(u)}function Jh(u){return this.__data__.has(u)}function Qh(u,l){var p=this.__data__;if(p instanceof Ns){var w=p.__data__;if(!Bu||w.length<V-1)return w.push([u,l]),this.size=++p.size,this;p=this.__data__=new Qo(w)}return p.set(u,l),this.size=p.size,this}eo.prototype.clear=Md,eo.prototype.delete=Nd,eo.prototype.get=qh,eo.prototype.has=Jh,eo.prototype.set=Qh;function Dd(u,l){var p=qn(u),w=!p&&Kc(u),M=!p&&!w&&uc(u),F=!p&&!w&&!M&&qc(u),J=p||w||M||F,ue=J?gl(u.length,ip):[],be=ue.length;for(var ct in u)(l||Kn.call(u,ct))&&!(J&&(ct=="length"||M&&(ct=="offset"||ct=="parent")||F&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||Tt(ct,be)))&&ue.push(ct);return ue}function Qs(u){var l=u.length;return l?u[Pl(0,l-1)]:x}function Pd(u,l){return Jr(la(u),Ao(l,0,u.length))}function Zu(u){return Jr(la(u))}function Il(u,l,p){(p!==x&&!us(u[l],p)||p===x&&!(l in u))&&ya(u,l,p)}function So(u,l,p){var w=u[l];(!(Kn.call(u,l)&&us(w,p))||p===x&&!(l in u))&&ya(u,l,p)}function To(u,l){for(var p=u.length;p--;)if(us(u[p][0],l))return p;return-1}function Od(u,l,p,w){return es(u,function(M,F,J){l(w,M,p(M),J)}),w}function eu(u,l){return u&&io(l,ia(l),u)}function Cl(u,l){return u&&io(l,Ea(l),u)}function ya(u,l,p){l=="__proto__"&&Ic?Ic(u,l,{configurable:!0,enumerable:!0,value:p,writable:!0}):u[l]=p}function ju(u,l){for(var p=-1,w=l.length,M=Pe(w),F=u==null;++p<w;)M[p]=F?x:zl(u,l[p]);return M}function Ao(u,l,p){return u===u&&(p!==x&&(u=u<=p?u:p),l!==x&&(u=u>=l?u:l)),u}function _a(u,l,p,w,M,F){var J,ue=l&rt,be=l&ke,ct=l&Gt;if(p&&(J=M?p(u,w,M,F):p(u)),J!==x)return J;if(!ci(u))return u;var et=qn(u);if(et){if(J=fe(u),!ue)return la(u,J)}else{var wt=qe(u),Xt=wt==Hi||wt==ds;if(uc(u))return Ls(u,ue);if(wt==Xi||wt==zr||Xt&&!M){if(J=be||Xt?{}:Ie(u),!ue)return be?lu(u,Cl(J,u)):Zd(u,eu(J,u))}else{if(!Bn[wt])return M?u:{};J=ot(u,wt,ue)}}F||(F=new eo);var sn=F.get(u);if(sn)return sn;F.set(u,J),Hp(u)?u.forEach(function(Gn){J.add(_a(Gn,l,p,Gn,u,F))}):Wp(u)&&u.forEach(function(Gn,hr){J.set(hr,_a(Gn,l,p,hr,u,F))});var Ln=ct?be?T:Kf:be?Ea:ia,ur=et?x:Ln(u);return ga(ur||u,function(Gn,hr){ur&&(hr=Gn,Gn=u[hr]),So(J,hr,_a(Gn,l,p,hr,u,F))}),J}function Gf(u){var l=ia(u);return function(p){return Nc(p,u,l)}}function Nc(u,l,p){var w=p.length;if(u==null)return!w;for(u=wr(u);w--;){var M=p[w],F=l[M],J=u[M];if(J===x&&!(M in u)||!F(J))return!1}return!0}function Hu(u,l,p){if(typeof u!="function")throw new Ja(H);return On(function(){u.apply(x,p)},l)}function Dc(u,l,p,w){var M=-1,F=_c,J=!0,ue=u.length,be=[],ct=l.length;if(!ue)return be;p&&(l=Yr(l,ca(p))),w?(F=hf,J=!1):l.length>=V&&(F=wo,J=!1,l=new Js(l));e:for(;++M<ue;){var et=u[M],wt=p==null?et:p(et);if(et=w||et!==0?et:0,J&&wt===wt){for(var Xt=ct;Xt--;)if(l[Xt]===wt)continue e;be.push(et)}else F(l,wt,w)||be.push(et)}return be}var es=ao(to),Rl=ao(Oc,!0);function Ld(u,l){var p=!0;return es(u,function(w,M,F){return p=!!l(w,M,F),p}),p}function Pc(u,l,p){for(var w=-1,M=u.length;++w<M;){var F=u[w],J=l(F);if(J!=null&&(ue===x?J===J&&!Ma(J):p(J,ue)))var ue=J,be=F}return be}function Gd(u,l,p,w){var M=u.length;for(p=jn(p),p<0&&(p=-p>M?0:M+p),w=w===x||w>M?M:jn(w),w<0&&(w+=M),w=p>w?0:yv(w);p<w;)u[p++]=l;return u}function kf(u,l){var p=[];return es(u,function(w,M,F){l(w,M,F)&&p.push(w)}),p}function Qi(u,l,p,w,M){var F=-1,J=u.length;for(p||(p=Ve),M||(M=[]);++F<J;){var ue=u[F];l>0&&p(ue)?l>1?Qi(ue,l-1,p,w,M):Yo(M,ue):w||(M[M.length]=ue)}return M}var Ff=Ll(),Ml=Ll(!0);function to(u,l){return u&&Ff(u,l,ia)}function Oc(u,l){return u&&Ml(u,l,ia)}function Lc(u,l){return ws(l,function(p){return Fs(u[p])})}function Ds(u,l){l=Fi(l,u);for(var p=0,w=l.length;u!=null&&p<w;)u=u[Ir(l[p++])];return p&&p==w?u:x}function Uf(u,l,p){var w=l(u);return qn(u)?w:Yo(w,p(u))}function ki(u){return u==null?u===x?Uo:Tu:Cs&&Cs in wr(u)?Qe(u):Fn(u)}function Bf(u,l){return u>l}function Nl(u,l){return u!=null&&Kn.call(u,l)}function kd(u,l){return u!=null&&l in wr(u)}function Fd(u,l,p){return u>=Ji(l,p)&&u<pi(l,p)}function tu(u,l,p){for(var w=p?hf:_c,M=u[0].length,F=u.length,J=F,ue=Pe(F),be=Infinity,ct=[];J--;){var et=u[J];J&&l&&(et=Yr(et,ca(l))),be=Ji(et.length,be),ue[J]=!p&&(l||M>=120&&et.length>=120)?new Js(J&&et):x}et=u[0];var wt=-1,Xt=ue[0];e:for(;++wt<M&&ct.length<be;){var sn=et[wt],Ln=l?l(sn):sn;if(sn=p||sn!==0?sn:0,!(Xt?wo(Xt,Ln):w(ct,Ln,p))){for(J=F;--J;){var ur=ue[J];if(!(ur?wo(ur,Ln):w(u[J],Ln,p)))continue e}Xt&&Xt.push(Ln),ct.push(sn)}}return ct}function Ud(u,l,p,w){return to(u,function(M,F,J){l(w,p(M),F,J)}),w}function Xu(u,l,p){l=Fi(l,u),u=An(u,l);var w=u==null?u:u[Ir(ae(l))];return w==null?x:ma(w,u,p)}function zf(u){return xi(u)&&ki(u)==zr}function Dl(u){return xi(u)&&ki(u)==xe}function Gc(u){return xi(u)&&ki(u)==Xa}function $u(u,l,p,w,M){return u===l?!0:u==null||l==null||!xi(u)&&!xi(l)?u!==u&&l!==l:Wf(u,l,p,w,$u,M)}function Wf(u,l,p,w,M,F){var J=qn(u),ue=qn(l),be=J?Ha:qe(u),ct=ue?Ha:qe(l);be=be==zr?Xi:be,ct=ct==zr?Xi:ct;var et=be==Xi,wt=ct==Xi,Xt=be==ct;if(Xt&&uc(u)){if(!uc(l))return!1;J=!0,et=!1}if(Xt&&!et)return F||(F=new eo),J||qc(u)?oc(u,l,p,w,M,F):Yc(u,l,be,p,w,M,F);if(!(p&Yt)){var sn=et&&Kn.call(u,"__wrapped__"),Ln=wt&&Kn.call(l,"__wrapped__");if(sn||Ln){var ur=sn?u.value():u,Gn=Ln?l.value():l;return F||(F=new eo),M(ur,Gn,p,w,F)}}return Xt?(F||(F=new eo),av(u,l,p,w,M,F)):!1}function ts(u){return xi(u)&&qe(u)==gi}function nu(u,l,p,w){var M=p.length,F=M,J=!w;if(u==null)return!F;for(u=wr(u);M--;){var ue=p[M];if(J&&ue[2]?ue[1]!==u[ue[0]]:!(ue[0]in u))return!1}for(;++M<F;){ue=p[M];var be=ue[0],ct=u[be],et=ue[1];if(J&&ue[2]){if(ct===x&&!(be in u))return!1}else{var wt=new eo;if(w)var Xt=w(ct,et,be,u,l,wt);if(!(Xt===x?$u(et,ct,Yt|dt,w,wt):Xt))return!1}}return!0}function Ps(u){if(!ci(u)||Ht(u))return!1;var l=Fs(u)?pd:qt;return l.test(Qr(u))}function kc(u){return xi(u)&&ki(u)==k}function Fc(u){return xi(u)&&qe(u)==$i}function ru(u){return xi(u)&&ih(u.length)&&!!Mn[ki(u)]}function Io(u){return typeof u=="function"?u:u==null?Na:typeof u=="object"?qn(u)?au(u[0],u[1]):iu(u):Iv(u)}function no(u){if(!yt(u))return Rs(u);var l=[];for(var p in wr(u))Kn.call(u,p)&&p!="constructor"&&l.push(p);return l}function Vf(u){if(!ci(u))return Ut(u);var l=yt(u),p=[];for(var w in u)w=="constructor"&&(l||!Kn.call(u,w))||p.push(w);return p}function Yu(u,l){return u<l}function Os(u,l){var p=-1,w=Va(u)?Pe(u.length):[];return es(u,function(M,F,J){w[++p]=l(M,F,J)}),w}function iu(u){var l=Te(u);return l.length==1&&l[0][2]?Ze(l[0][0],l[0][1]):function(p){return p===u||nu(p,u,l)}}function au(u,l){return gt(u)&&lt(l)?Ze(Ir(u),l):function(p){var w=zl(p,u);return w===x&&w===l?Ev(p,u):$u(l,w,Yt|dt)}}function Co(u,l,p,w,M){u!==l&&Ff(l,function(F,J){if(M||(M=new eo),ci(F))ro(u,l,J,p,Co,w,M);else{var ue=w?w(Vr(u,J),F,J+"",u,l,M):x;ue===x&&(ue=F),Il(u,J,ue)}},Ea)}function ro(u,l,p,w,M,F,J){var ue=Vr(u,p),be=Vr(l,p),ct=J.get(be);if(ct){Il(u,p,ct);return}var et=F?F(ue,be,p+"",u,l,J):x,wt=et===x;if(wt){var Xt=qn(be),sn=!Xt&&uc(be),Ln=!Xt&&!sn&&qc(be);et=be,Xt||sn||Ln?qn(ue)?et=ue:Ui(ue)?et=la(ue):sn?(wt=!1,et=Ls(be,!0)):Ln?(wt=!1,et=Hf(be,!0)):et=[]:Bl(be)||Kc(be)?(et=ue,Kc(ue)?et=Yp(ue):(!ci(ue)||Fs(ue))&&(et=Ie(be))):wt=!1}wt&&(J.set(be,et),M(et,be,w,F,J),J.delete(be)),Il(u,p,et)}function Bd(u,l){var p=u.length;if(!!p)return l+=l<0?p:0,Tt(l,p)?u[l]:x}function ra(u,l,p){l.length?l=Yr(l,function(F){return qn(F)?function(J){return Ds(J,F.length===1?F[0]:F)}:F}):l=[Na];var w=-1;l=Yr(l,ca(se()));var M=Os(u,function(F,J,ue){var be=Yr(l,function(ct){return ct(F)});return{criteria:be,index:++w,value:F}});return Fh(M,function(F,J){return rv(F,J,p)})}function ou(u,l){return su(u,l,function(p,w){return Ev(u,w)})}function su(u,l,p){for(var w=-1,M=l.length,F={};++w<M;){var J=l[w],ue=Ds(u,J);p(ue,J)&&Bc(F,Fi(J,u),ue)}return F}function Uc(u){return function(l){return Ds(l,u)}}function Ku(u,l,p,w){var M=w?Ss:Ka,F=-1,J=l.length,ue=u;for(u===l&&(l=la(l)),p&&(ue=Yr(u,ca(p)));++F<J;)for(var be=0,ct=l[F],et=p?p(ct):ct;(be=M(ue,et,be,w))>-1;)ue!==u&&Tc.call(ue,be,1),Tc.call(u,be,1);return u}function ns(u,l){for(var p=u?l.length:0,w=p-1;p--;){var M=l[p];if(p==w||M!==F){var F=M;Tt(M)?Tc.call(u,M,1):ec(u,M)}}return u}function Pl(u,l){return u+Fu(Rf()*(l-u+1))}function qu(u,l,p,w){for(var M=-1,F=pi(If((l-u)/(p||1)),0),J=Pe(F);F--;)J[w?F:++M]=u,u+=p;return J}function Ju(u,l){var p="";if(!u||l<1||l>mn)return p;do l%2&&(p+=u),l=Fu(l/2),l&&(u+=u);while(l);return p}function Qn(u,l){return Zr(fn(u,l,Na),u+"")}function ev(u){return Qs(el(u))}function tv(u,l){var p=el(u);return Jr(p,Ao(l,0,p.length))}function Bc(u,l,p,w){if(!ci(u))return u;l=Fi(l,u);for(var M=-1,F=l.length,J=F-1,ue=u;ue!=null&&++M<F;){var be=Ir(l[M]),ct=p;if(be==="__proto__"||be==="constructor"||be==="prototype")return u;if(M!=J){var et=ue[be];ct=w?w(et,be,ue):x,ct===x&&(ct=ci(et)?et:Tt(l[M+1])?[]:{})}So(ue,be,ct),ue=ue[be]}return u}var zd=Nf?function(u,l){return Nf.set(u,l),u}:Na,Qu=Ic?function(u,l){return Ic(u,"toString",{configurable:!0,enumerable:!1,value:mu(l),writable:!0})}:Na;function Zf(u){return Jr(el(u))}function Wa(u,l,p){var w=-1,M=u.length;l<0&&(l=-l>M?0:M+l),p=p>M?M:p,p<0&&(p+=M),M=l>p?0:p-l>>>0,l>>>=0;for(var F=Pe(M);++w<M;)F[w]=u[w+l];return F}function nv(u,l){var p;return es(u,function(w,M,F){return p=l(w,M,F),!p}),!!p}function jf(u,l,p){var w=0,M=u==null?w:u.length;if(typeof l=="number"&&l===l&&M<=ti){for(;w<M;){var F=w+M>>>1,J=u[F];J!==null&&!Ma(J)&&(p?J<=l:J<l)?w=F+1:M=F}return M}return Ol(u,l,Na,p)}function Ol(u,l,p,w){var M=0,F=u==null?0:u.length;if(F===0)return 0;l=p(l);for(var J=l!==l,ue=l===null,be=Ma(l),ct=l===x;M<F;){var et=Fu((M+F)/2),wt=p(u[et]),Xt=wt!==x,sn=wt===null,Ln=wt===wt,ur=Ma(wt);if(J)var Gn=w||Ln;else ct?Gn=Ln&&(w||Xt):ue?Gn=Ln&&Xt&&(w||!sn):be?Gn=Ln&&Xt&&!sn&&(w||!ur):sn||ur?Gn=!1:Gn=w?wt<=l:wt<l;Gn?M=et+1:F=et}return Ji(F,pr)}function zc(u,l){for(var p=-1,w=u.length,M=0,F=[];++p<w;){var J=u[p],ue=l?l(J):J;if(!p||!us(ue,be)){var be=ue;F[M++]=J===0?0:J}}return F}function Wc(u){return typeof u=="number"?u:Ma(u)?fi:+u}function Ur(u){if(typeof u=="string")return u;if(qn(u))return Yr(u,Ur)+"";if(Ma(u))return Tl?Tl.call(u):"";var l=u+"";return l=="0"&&1/u==-jt?"-0":l}function mi(u,l,p){var w=-1,M=_c,F=u.length,J=!0,ue=[],be=ue;if(p)J=!1,M=hf;else if(F>=V){var ct=l?null:ic(u);if(ct)return wc(ct);J=!1,M=wo,be=new Js}else be=l?[]:ue;e:for(;++w<F;){var et=u[w],wt=l?l(et):et;if(et=p||et!==0?et:0,J&&wt===wt){for(var Xt=be.length;Xt--;)if(be[Xt]===wt)continue e;l&&be.push(wt),ue.push(et)}else M(be,wt,p)||(be!==ue&&be.push(wt),ue.push(et))}return ue}function ec(u,l){return l=Fi(l,u),u=An(u,l),u==null||delete u[Ir(ae(l))]}function Vc(u,l,p,w){return Bc(u,l,p(Ds(u,l)),w)}function uu(u,l,p,w){for(var M=u.length,F=w?M:-1;(w?F--:++F<M)&&l(u[F],F,u););return p?Wa(u,w?0:F,w?F+1:M):Wa(u,w?F+1:0,w?M:F)}function rs(u,l){var p=u;return p instanceof lr&&(p=p.value()),Gr(l,function(w,M){return M.func.apply(M.thisArg,Yo([w],M.args))},p)}function Zc(u,l,p){var w=u.length;if(w<2)return w?mi(u[0]):[];for(var M=-1,F=Pe(w);++M<w;)for(var J=u[M],ue=-1;++ue<w;)ue!=M&&(F[M]=Dc(F[M]||J,u[ue],l,p));return mi(Qi(F,1),l,p)}function jc(u,l,p){for(var w=-1,M=u.length,F=l.length,J={};++w<M;){var ue=w<F?l[w]:x;p(J,u[w],ue)}return J}function tc(u){return Ui(u)?u:[]}function cu(u){return typeof u=="function"?u:Na}function Fi(u,l){return qn(u)?u:gt(u,l)?[u]:oi(Dr(u))}var Zi=Qn;function Ia(u,l,p){var w=u.length;return p=p===x?w:p,!l&&p>=w?u:Wa(u,l,p)}var Ro=ap||function(u){return Zn.clearTimeout(u)};function Ls(u,l){if(l)return u.slice();var p=u.length,w=Ni?Ni(p):new u.constructor(p);return u.copy(w),w}function Hc(u){var l=new u.constructor(u.byteLength);return new Qa(l).set(new Qa(u)),l}function Xc(u,l){var p=l?Hc(u.buffer):u.buffer;return new u.constructor(p,u.byteOffset,u.byteLength)}function fu(u){var l=new u.constructor(u.source,kt.exec(u));return l.lastIndex=u.lastIndex,l}function Gs(u){return qs?wr(qs.call(u)):{}}function Hf(u,l){var p=l?Hc(u.buffer):u.buffer;return new u.constructor(p,u.byteOffset,u.length)}function Wd(u,l){if(u!==l){var p=u!==x,w=u===null,M=u===u,F=Ma(u),J=l!==x,ue=l===null,be=l===l,ct=Ma(l);if(!ue&&!ct&&!F&&u>l||F&&J&&be&&!ue&&!ct||w&&J&&be||!p&&be||!M)return 1;if(!w&&!F&&!ct&&u<l||ct&&p&&M&&!w&&!F||ue&&p&&M||!J&&M||!be)return-1}return 0}function rv(u,l,p){for(var w=-1,M=u.criteria,F=l.criteria,J=M.length,ue=p.length;++w<J;){var be=Wd(M[w],F[w]);if(be){if(w>=ue)return be;var ct=p[w];return be*(ct=="desc"?-1:1)}}return u.index-l.index}function Vd(u,l,p,w){for(var M=-1,F=u.length,J=p.length,ue=-1,be=l.length,ct=pi(F-J,0),et=Pe(be+ct),wt=!w;++ue<be;)et[ue]=l[ue];for(;++M<J;)(wt||M<F)&&(et[p[M]]=u[M]);for(;ct--;)et[ue++]=u[M++];return et}function is(u,l,p,w){for(var M=-1,F=u.length,J=-1,ue=p.length,be=-1,ct=l.length,et=pi(F-ue,0),wt=Pe(et+ct),Xt=!w;++M<et;)wt[M]=u[M];for(var sn=M;++be<ct;)wt[sn+be]=l[be];for(;++J<ue;)(Xt||M<F)&&(wt[sn+p[J]]=u[M++]);return wt}function la(u,l){var p=-1,w=u.length;for(l||(l=Pe(w));++p<w;)l[p]=u[p];return l}function io(u,l,p,w){var M=!p;p||(p={});for(var F=-1,J=l.length;++F<J;){var ue=l[F],be=w?w(p[ue],u[ue],ue,p,u):x;be===x&&(be=u[ue]),M?ya(p,ue,be):So(p,ue,be)}return p}function Zd(u,l){return io(u,it(u),l)}function lu(u,l){return io(u,Le(u),l)}function as(u,l){return function(p,w){var M=qn(p)?$s:Od,F=l?l():{};return M(p,u,se(w,2),F)}}function Mo(u){return Qn(function(l,p){var w=-1,M=p.length,F=M>1?p[M-1]:x,J=M>2?p[2]:x;for(F=u.length>3&&typeof F=="function"?(M--,F):x,J&&Fe(p[0],p[1],J)&&(F=M<3?x:F,M=1),l=wr(l);++w<M;){var ue=p[w];ue&&u(l,ue,w,F)}return l})}function ao(u,l){return function(p,w){if(p==null)return p;if(!Va(p))return u(p,w);for(var M=p.length,F=l?M:-1,J=wr(p);(l?F--:++F<M)&&w(J[F],F,J)!==!1;);return p}}function Ll(u){return function(l,p,w){for(var M=-1,F=wr(l),J=w(l),ue=J.length;ue--;){var be=J[u?ue:++M];if(p(F[be],be,F)===!1)break}return l}}function nc(u,l,p){var w=l&ht,M=hu(u);function F(){var J=this&&this!==Zn&&this instanceof F?M:u;return J.apply(w?p:this,arguments)}return F}function os(u){return function(l){l=Dr(l);var p=As(l)?qa(l):x,w=p?p[0]:l.charAt(0),M=p?Ia(p,1).join(""):l.slice(1);return w[u]()+M}}function du(u){return function(l){return Gr(v0(Wl(l).replace(qi,"")),u,"")}}function hu(u){return function(){var l=arguments;switch(l.length){case 0:return new u;case 1:return new u(l[0]);case 2:return new u(l[0],l[1]);case 3:return new u(l[0],l[1],l[2]);case 4:return new u(l[0],l[1],l[2],l[3]);case 5:return new u(l[0],l[1],l[2],l[3],l[4]);case 6:return new u(l[0],l[1],l[2],l[3],l[4],l[5]);case 7:return new u(l[0],l[1],l[2],l[3],l[4],l[5],l[6])}var p=Wu(u.prototype),w=u.apply(p,l);return ci(w)?w:p}}function Xf(u,l,p){var w=hu(u);function M(){for(var F=arguments.length,J=Pe(F),ue=F,be=ye(M);ue--;)J[ue]=arguments[ue];var ct=F<3&&J[0]!==be&&J[F-1]!==be?[]:Ba(J,be);if(F-=ct.length,F<p)return rc(u,l,oo,M.placeholder,x,J,ct,x,x,p-F);var et=this&&this!==Zn&&this instanceof M?w:u;return ma(et,this,J)}return M}function ks(u){return function(l,p,w){var M=wr(l);if(!Va(l)){var F=se(p,3);l=ia(l),p=function(ue){return F(M[ue],ue,M)}}var J=u(l,p,w);return J>-1?M[F?l[J]:J]:x}}function ea(u){return Pi(function(l){var p=l.length,w=p,M=za.prototype.thru;for(u&&l.reverse();w--;){var F=l[w];if(typeof F!="function")throw new Ja(H);if(M&&!J&&X(F)=="wrapper")var J=new za([],!0)}for(w=J?w:p;++w<p;){F=l[w];var ue=X(F),be=ue=="wrapper"?O(F):x;be&&ut(be[0])&&be[1]==(St|Ae|at|Mt)&&!be[4].length&&be[9]==1?J=J[X(be[0])].apply(J,be[3]):J=F.length==1&&ut(F)?J[ue]():J.thru(F)}return function(){var ct=arguments,et=ct[0];if(J&&ct.length==1&&qn(et))return J.plant(et).value();for(var wt=0,Xt=p?l[wt].apply(this,ct):et;++wt<p;)Xt=l[wt].call(this,Xt);return Xt}})}function oo(u,l,p,w,M,F,J,ue,be,ct){var et=l&St,wt=l&ht,Xt=l&vt,sn=l&(Ae|xt),Ln=l&zt,ur=Xt?x:hu(u);function Gn(){for(var hr=arguments.length,_r=Pe(hr),co=hr;co--;)_r[co]=arguments[co];if(sn)var Da=ye(Gn),Pa=_l(_r,Da);if(w&&(_r=Vd(_r,w,M,sn)),F&&(_r=is(_r,F,J,sn)),hr-=Pa,sn&&hr<ct){var Si=Ba(_r,Da);return rc(u,l,oo,Gn.placeholder,p,_r,Si,ue,be,ct-hr)}var cs=wt?p:this,Us=Xt?cs[u]:u;return hr=_r.length,ue?_r=ar(_r,ue):Ln&&hr>1&&_r.reverse(),et&&be<hr&&(_r.length=be),this&&this!==Zn&&this instanceof Gn&&(Us=ur||hu(Us)),Us.apply(cs,_r)}return Gn}function ii(u,l){return function(p,w){return Ud(p,u,l(w),{})}}function Di(u,l){return function(p,w){var M;if(p===x&&w===x)return l;if(p!==x&&(M=p),w!==x){if(M===x)return w;typeof p=="string"||typeof w=="string"?(p=Ur(p),w=Ur(w)):(p=Wc(p),w=Wc(w)),M=u(p,w)}return M}}function $f(u){return Pi(function(l){return l=Yr(l,ca(se())),Qn(function(p){var w=this;return u(l,function(M){return ma(M,w,p)})})})}function Yf(u,l){l=l===x?" ":Ur(l);var p=l.length;if(p<2)return p?Ju(l,u):l;var w=Ju(l,If(u/Pu(l)));return As(l)?Ia(qa(w),0,u).join(""):w.slice(0,u)}function iv(u,l,p,w){var M=l&ht,F=hu(u);function J(){for(var ue=-1,be=arguments.length,ct=-1,et=w.length,wt=Pe(et+be),Xt=this&&this!==Zn&&this instanceof J?F:u;++ct<et;)wt[ct]=w[ct];for(;be--;)wt[ct++]=arguments[++ue];return ma(Xt,M?p:this,wt)}return J}function jd(u){return function(l,p,w){return w&&typeof w!="number"&&Fe(l,p,w)&&(p=w=x),l=pu(l),p===x?(p=l,l=0):p=pu(p),w=w===x?l<p?1:-1:pu(w),qu(l,p,w,u)}}function ss(u){return function(l,p){return typeof l=="string"&&typeof p=="string"||(l=Lo(l),p=Lo(p)),u(l,p)}}function rc(u,l,p,w,M,F,J,ue,be,ct){var et=l&Ae,wt=et?J:x,Xt=et?x:J,sn=et?F:x,Ln=et?x:F;l|=et?at:tt,l&=~(et?tt:at),l&Ne||(l&=~(ht|vt));var ur=[u,l,M,sn,wt,Ln,Xt,ue,be,ct],Gn=p.apply(x,ur);return ut(u)&&ai(Gn,ur),Gn.placeholder=w,xr(Gn,u,l)}function Gl(u){var l=Kr[u];return function(p,w){if(p=Lo(p),w=w==null?0:Ji(jn(w),292),w&&Uu(p)){var M=(Dr(p)+"e").split("e"),F=l(M[0]+"e"+(+M[1]+w));return M=(Dr(F)+"e").split("e"),+(M[0]+"e"+(+M[1]-w))}return l(p)}}var ic=Ys&&1/wc(new Ys([,-0]))[1]==jt?function(u){return new Ys(u)}:vh;function vu(u){return function(l){var p=qe(l);return p==gi?bl(l):p==$i?hd(l):yl(l,u(l))}}function so(u,l,p,w,M,F,J,ue){var be=l&vt;if(!be&&typeof u!="function")throw new Ja(H);var ct=w?w.length:0;if(ct||(l&=~(at|tt),w=M=x),J=J===x?J:pi(jn(J),0),ue=ue===x?ue:jn(ue),ct-=M?M.length:0,l&tt){var et=w,wt=M;w=M=x}var Xt=be?x:O(u),sn=[u,l,p,w,M,et,wt,F,J,ue];if(Xt&&Tn(sn,Xt),u=sn[0],l=sn[1],p=sn[2],w=sn[3],M=sn[4],ue=sn[9]=sn[9]===x?be?0:u.length:pi(sn[9]-ct,0),!ue&&l&(Ae|xt)&&(l&=~(Ae|xt)),!l||l==ht)var Ln=nc(u,l,p);else l==Ae||l==xt?Ln=Xf(u,l,ue):(l==at||l==(ht|at))&&!M.length?Ln=iv(u,l,p,w):Ln=oo.apply(x,sn);var ur=Xt?zd:ai;return xr(ur(Ln,sn),u,l)}function $c(u,l,p,w){return u===x||us(u,xo[p])&&!Kn.call(w,p)?l:u}function ac(u,l,p,w,M,F){return ci(u)&&ci(l)&&(F.set(l,u),Co(u,l,x,ac,F),F.delete(l)),u}function Hd(u){return Bl(u)?x:u}function oc(u,l,p,w,M,F){var J=p&Yt,ue=u.length,be=l.length;if(ue!=be&&!(J&&be>ue))return!1;var ct=F.get(u),et=F.get(l);if(ct&&et)return ct==l&&et==u;var wt=-1,Xt=!0,sn=p&dt?new Js:x;for(F.set(u,l),F.set(l,u);++wt<ue;){var Ln=u[wt],ur=l[wt];if(w)var Gn=J?w(ur,Ln,wt,l,u,F):w(Ln,ur,wt,u,l,F);if(Gn!==x){if(Gn)continue;Xt=!1;break}if(sn){if(!vl(l,function(hr,_r){if(!wo(sn,_r)&&(Ln===hr||M(Ln,hr,p,w,F)))return sn.push(_r)})){Xt=!1;break}}else if(!(Ln===ur||M(Ln,ur,p,w,F))){Xt=!1;break}}return F.delete(u),F.delete(l),Xt}function Yc(u,l,p,w,M,F,J){switch(p){case Xe:if(u.byteLength!=l.byteLength||u.byteOffset!=l.byteOffset)return!1;u=u.buffer,l=l.buffer;case xe:return!(u.byteLength!=l.byteLength||!F(new Qa(u),new Qa(l)));case Bi:case Xa:case li:return us(+u,+l);case vo:return u.name==l.name&&u.message==l.message;case k:case Wr:return u==l+"";case gi:var ue=bl;case $i:var be=w&Yt;if(ue||(ue=wc),u.size!=l.size&&!be)return!1;var ct=J.get(u);if(ct)return ct==l;w|=dt,J.set(u,l);var et=oc(ue(u),ue(l),w,M,F,J);return J.delete(u),et;case vs:if(qs)return qs.call(u)==qs.call(l)}return!1}function av(u,l,p,w,M,F){var J=p&Yt,ue=Kf(u),be=ue.length,ct=Kf(l),et=ct.length;if(be!=et&&!J)return!1;for(var wt=be;wt--;){var Xt=ue[wt];if(!(J?Xt in l:Kn.call(l,Xt)))return!1}var sn=F.get(u),Ln=F.get(l);if(sn&&Ln)return sn==l&&Ln==u;var ur=!0;F.set(u,l),F.set(l,u);for(var Gn=J;++wt<be;){Xt=ue[wt];var hr=u[Xt],_r=l[Xt];if(w)var co=J?w(_r,hr,Xt,l,u,F):w(hr,_r,Xt,u,l,F);if(!(co===x?hr===_r||M(hr,_r,p,w,F):co)){ur=!1;break}Gn||(Gn=Xt=="constructor")}if(ur&&!Gn){var Da=u.constructor,Pa=l.constructor;Da!=Pa&&"constructor"in u&&"constructor"in l&&!(typeof Da=="function"&&Da instanceof Da&&typeof Pa=="function"&&Pa instanceof Pa)&&(ur=!1)}return F.delete(u),F.delete(l),ur}function Pi(u){return Zr(fn(u,x,U),u+"")}function Kf(u){return Uf(u,ia,it)}function T(u){return Uf(u,Ea,Le)}var O=Nf?function(u){return Nf.get(u)}:vh;function X(u){for(var l=u.name+"",p=Aa[l],w=Kn.call(Aa,l)?p.length:0;w--;){var M=p[w],F=M.func;if(F==null||F==u)return M.name}return l}function ye(u){var l=Kn.call(P,"placeholder")?P:u;return l.placeholder}function se(){var u=P.iteratee||hh;return u=u===hh?Io:u,arguments.length?u(arguments[0],arguments[1]):u}function Ee(u,l){var p=u.__data__;return He(l)?p[typeof l=="string"?"string":"hash"]:p.map}function Te(u){for(var l=ia(u),p=l.length;p--;){var w=l[p],M=u[w];l[p]=[w,M,lt(M)]}return l}function $e(u,l){var p=cd(u,l);return Ps(p)?p:x}function Qe(u){var l=Kn.call(u,Cs),p=u[Cs];try{u[Cs]=x;var w=!0}catch(F){}var M=ku.call(u);return w&&(l?u[Cs]=p:delete u[Cs]),M}var it=Cf?function(u){return u==null?[]:(u=wr(u),ws(Cf(u),function(l){return Jo.call(u,l)}))}:Vl,Le=Cf?function(u){for(var l=[];u;)Yo(l,it(u)),u=Ta(u);return l}:Vl,qe=ki;(Mf&&qe(new Mf(new ArrayBuffer(1)))!=Xe||Bu&&qe(new Bu)!=gi||Cc&&qe(Cc.resolve())!=Zs||Ys&&qe(new Ys)!=$i||fa&&qe(new fa)!=zi)&&(qe=function(u){var l=ki(u),p=l==Xi?u.constructor:x,w=p?Qr(p):"";if(w)switch(w){case Sl:return Xe;case Ks:return gi;case Rc:return Zs;case wd:return $i;case xd:return zi}return l});function Et(u,l,p){for(var w=-1,M=p.length;++w<M;){var F=p[w],J=F.size;switch(F.type){case"drop":u+=J;break;case"dropRight":l-=J;break;case"take":l=Ji(l,u+J);break;case"takeRight":u=pi(u,l-J);break}}return{start:u,end:l}}function Ke(u){var l=u.match(Mu);return l?l[1].split(ll):[]}function mt(u,l,p){l=Fi(l,u);for(var w=-1,M=l.length,F=!1;++w<M;){var J=Ir(l[w]);if(!(F=u!=null&&p(u,J)))break;u=u[J]}return F||++w!=M?F:(M=u==null?0:u.length,!!M&&ih(M)&&Tt(J,M)&&(qn(u)||Kc(u)))}function fe(u){var l=u.length,p=new u.constructor(l);return l&&typeof u[0]=="string"&&Kn.call(u,"index")&&(p.index=u.index,p.input=u.input),p}function Ie(u){return typeof u.constructor=="function"&&!yt(u)?Wu(Ta(u)):{}}function ot(u,l,p){var w=u.constructor;switch(l){case xe:return Hc(u);case Bi:case Xa:return new w(+u);case Xe:return Xc(u,p);case bt:case Ft:case Wt:case Rn:case Pn:case Un:case an:case ir:case nr:return Hf(u,p);case gi:return new w;case li:case Wr:return new w(u);case k:return fu(u);case $i:return new w;case vs:return Gs(u)}}function Ct(u,l){var p=l.length;if(!p)return u;var w=p-1;return l[w]=(p>1?"& ":"")+l[w],l=l.join(p>2?", ":" "),u.replace(Xr,`{
/* [wrapped with `+l+`] */
`)}function Ve(u){return qn(u)||Kc(u)||!!(Af&&u&&u[Af])}function Tt(u,l){var p=typeof u;return l=l??mn,!!l&&(p=="number"||p!="symbol"&&dn.test(u))&&u>-1&&u%1==0&&u<l}function Fe(u,l,p){if(!ci(p))return!1;var w=typeof l;return(w=="number"?Va(p)&&Tt(l,p.length):w=="string"&&l in p)?us(p[l],u):!1}function gt(u,l){if(qn(u))return!1;var p=typeof u;return p=="number"||p=="symbol"||p=="boolean"||u==null||Ma(u)?!0:Ya.test(u)||!Cu.test(u)||l!=null&&u in wr(l)}function He(u){var l=typeof u;return l=="string"||l=="number"||l=="symbol"||l=="boolean"?u!=="__proto__":u===null}function ut(u){var l=X(u),p=P[l];if(typeof p!="function"||!(l in lr.prototype))return!1;if(u===p)return!0;var w=O(p);return!!w&&u===w[0]}function Ht(u){return!!xf&&xf in u}var hn=wf?Fs:Zl;function yt(u){var l=u&&u.constructor,p=typeof l=="function"&&l.prototype||xo;return u===p}function lt(u){return u===u&&!ci(u)}function Ze(u,l){return function(p){return p==null?!1:p[u]===l&&(l!==x||u in wr(p))}}function Qt(u){var l=eh(u,function(w){return p.size===he&&p.clear(),w}),p=l.cache;return l}function Tn(u,l){var p=u[1],w=l[1],M=p|w,F=M<(ht|vt|St),J=w==St&&p==Ae||w==St&&p==Mt&&u[7].length<=l[8]||w==(St|Mt)&&l[7].length<=l[8]&&p==Ae;if(!(F||J))return u;w&ht&&(u[2]=l[2],M|=p&ht?0:Ne);var ue=l[3];if(ue){var be=u[3];u[3]=be?Vd(be,ue,l[4]):ue,u[4]=be?Ba(u[3],me):l[4]}return ue=l[5],ue&&(be=u[5],u[5]=be?is(be,ue,l[6]):ue,u[6]=be?Ba(u[5],me):l[6]),ue=l[7],ue&&(u[7]=ue),w&St&&(u[8]=u[8]==null?l[8]:Ji(u[8],l[8])),u[9]==null&&(u[9]=l[9]),u[0]=l[0],u[1]=M,u}function Ut(u){var l=[];if(u!=null)for(var p in wr(u))l.push(p);return l}function Fn(u){return ku.call(u)}function fn(u,l,p){return l=pi(l===x?u.length-1:l,0),function(){for(var w=arguments,M=-1,F=pi(w.length-l,0),J=Pe(F);++M<F;)J[M]=w[l+M];M=-1;for(var ue=Pe(l+1);++M<l;)ue[M]=w[M];return ue[l]=p(J),ma(u,this,ue)}}function An(u,l){return l.length<2?u:Ds(u,Wa(l,0,-1))}function ar(u,l){for(var p=u.length,w=Ji(l.length,p),M=la(u);w--;){var F=l[w];u[w]=Tt(F,p)?M[F]:x}return u}function Vr(u,l){if(!(l==="constructor"&&typeof u[l]=="function")&&l!="__proto__")return u[l]}var ai=qr(zd),On=gd||function(u,l){return Zn.setTimeout(u,l)},Zr=qr(Qu);function xr(u,l,p){var w=l+"";return Zr(u,Ct(w,jr(Ke(w),p)))}function qr(u){var l=0,p=0;return function(){var w=_d(),M=L-(w-p);if(p=w,M>0){if(++l>=$n)return arguments[0]}else l=0;return u.apply(x,arguments)}}function Jr(u,l){var p=-1,w=u.length,M=w-1;for(l=l===x?w:l;++p<l;){var F=Pl(p,M),J=u[F];u[F]=u[p],u[p]=J}return u.length=l,u}var oi=Qt(function(u){var l=[];return u.charCodeAt(0)===46&&l.push(""),u.replace(cf,function(p,w,M,F){l.push(M?F.replace(Dt,"$1"):w||p)}),l});function Ir(u){if(typeof u=="string"||Ma(u))return u;var l=u+"";return l=="0"&&1/u==-jt?"-0":l}function Qr(u){if(u!=null){try{return Is.call(u)}catch(l){}try{return u+""}catch(l){}}return""}function jr(u,l){return ga(mr,function(p){var w="_."+p[0];l&p[1]&&!_c(u,w)&&u.push(w)}),u.sort()}function _n(u){if(u instanceof lr)return u.clone();var l=new za(u.__wrapped__,u.__chain__);return l.__actions__=la(u.__actions__),l.__index__=u.__index__,l.__values__=u.__values__,l}function si(u,l,p){(p?Fe(u,l,p):l===x)?l=1:l=pi(jn(l),0);var w=u==null?0:u.length;if(!w||l<1)return[];for(var M=0,F=0,J=Pe(If(w/l));M<w;)J[F++]=Wa(u,M,M+=l);return J}function or(u){for(var l=-1,p=u==null?0:u.length,w=0,M=[];++l<p;){var F=u[l];F&&(M[w++]=F)}return M}function tn(){var u=arguments.length;if(!u)return[];for(var l=Pe(u-1),p=arguments[0],w=u;w--;)l[w-1]=arguments[w];return Yo(qn(p)?la(p):[p],Qi(l,1))}var Vn=Qn(function(u,l){return Ui(u)?Dc(u,Qi(l,1,Ui,!0)):[]}),er=Qn(function(u,l){var p=ae(l);return Ui(p)&&(p=x),Ui(u)?Dc(u,Qi(l,1,Ui,!0),se(p,2)):[]}),ui=Qn(function(u,l){var p=ae(l);return Ui(p)&&(p=x),Ui(u)?Dc(u,Qi(l,1,Ui,!0),x,p):[]});function No(u,l,p){var w=u==null?0:u.length;return w?(l=p||l===x?1:jn(l),Wa(u,l<0?0:l,w)):[]}function Ca(u,l,p){var w=u==null?0:u.length;return w?(l=p||l===x?1:jn(l),l=w-l,Wa(u,0,l<0?0:l)):[]}function z(u,l){return u&&u.length?uu(u,se(l,3),!0,!0):[]}function Se(u,l){return u&&u.length?uu(u,se(l,3),!0):[]}function _e(u,l,p,w){var M=u==null?0:u.length;return M?(p&&typeof p!="number"&&Fe(u,l,p)&&(p=0,w=M),Gd(u,l,p,w)):[]}function Pt(u,l,p){var w=u==null?0:u.length;if(!w)return-1;var M=p==null?0:jn(p);return M<0&&(M=pi(w+M,0)),Nu(u,se(l,3),M)}function Nn(u,l,p){var w=u==null?0:u.length;if(!w)return-1;var M=w-1;return p!==x&&(M=jn(p),M=p<0?pi(w+M,0):Ji(M,w-1)),Nu(u,se(l,3),M,!0)}function U(u){var l=u==null?0:u.length;return l?Qi(u,1):[]}function D(u){var l=u==null?0:u.length;return l?Qi(u,jt):[]}function Y(u,l){var p=u==null?0:u.length;return p?(l=l===x?1:jn(l),Qi(u,l)):[]}function ce(u){for(var l=-1,p=u==null?0:u.length,w={};++l<p;){var M=u[l];w[M[0]]=M[1]}return w}function le(u){return u&&u.length?u[0]:x}function ne(u,l,p){var w=u==null?0:u.length;if(!w)return-1;var M=p==null?0:jn(p);return M<0&&(M=pi(w+M,0)),Ka(u,l,M)}function K(u){var l=u==null?0:u.length;return l?Wa(u,0,-1):[]}var oe=Qn(function(u){var l=Yr(u,tc);return l.length&&l[0]===u[0]?tu(l):[]}),B=Qn(function(u){var l=ae(u),p=Yr(u,tc);return l===ae(p)?l=x:p.pop(),p.length&&p[0]===u[0]?tu(p,se(l,2)):[]}),$=Qn(function(u){var l=ae(u),p=Yr(u,tc);return l=typeof l=="function"?l:x,l&&p.pop(),p.length&&p[0]===u[0]?tu(p,x,l):[]});function G(u,l){return u==null?"":yd.call(u,l)}function ae(u){var l=u==null?0:u.length;return l?u[l-1]:x}function pe(u,l,p){var w=u==null?0:u.length;if(!w)return-1;var M=w;return p!==x&&(M=jn(p),M=M<0?pi(w+M,0):Ji(M,w-1)),l===l?Uh(u,l,M):Nu(u,Du,M,!0)}function Oe(u,l){return u&&u.length?Bd(u,jn(l)):x}var Be=Qn(Me);function Me(u,l){return u&&u.length&&l&&l.length?Ku(u,l):u}function st(u,l,p){return u&&u.length&&l&&l.length?Ku(u,l,se(p,2)):u}function At(u,l,p){return u&&u.length&&l&&l.length?Ku(u,l,x,p):u}var xn=Pi(function(u,l){var p=u==null?0:u.length,w=ju(u,l);return ns(u,Yr(l,function(M){return Tt(M,p)?+M:M}).sort(Wd)),w});function Bt(u,l){var p=[];if(!(u&&u.length))return p;var w=-1,M=[],F=u.length;for(l=se(l,3);++w<F;){var J=u[w];l(J,w,u)&&(p.push(J),M.push(w))}return ns(u,M),p}function Jt(u){return u==null?u:bd.call(u)}function vn(u,l,p){var w=u==null?0:u.length;return w?(p&&typeof p!="number"&&Fe(u,l,p)?(l=0,p=w):(l=l==null?0:jn(l),p=p===x?w:jn(p)),Wa(u,l,p)):[]}function tr(u,l){return jf(u,l)}function kr(u,l,p){return Ol(u,l,se(p,2))}function wi(u,l){var p=u==null?0:u.length;if(p){var w=jf(u,l);if(w<p&&us(u[w],l))return w}return-1}function qf(u,l){return jf(u,l,!0)}function Ra(u,l,p){return Ol(u,l,se(p,2),!0)}function kl(u,l){var p=u==null?0:u.length;if(p){var w=jf(u,l,!0)-1;if(us(u[w],l))return w}return-1}function uo(u){return u&&u.length?zc(u):[]}function Xd(u,l){return u&&u.length?zc(u,se(l,2)):[]}function hm(u){var l=u==null?0:u.length;return l?Wa(u,1,l):[]}function $d(u,l,p){return u&&u.length?(l=p||l===x?1:jn(l),Wa(u,0,l<0?0:l)):[]}function up(u,l,p){var w=u==null?0:u.length;return w?(l=p||l===x?1:jn(l),l=w-l,Wa(u,l<0?0:l,w)):[]}function vm(u,l){return u&&u.length?uu(u,se(l,3),!1,!0):[]}function cp(u,l){return u&&u.length?uu(u,se(l,3)):[]}var fp=Qn(function(u){return mi(Qi(u,1,Ui,!0))}),pm=Qn(function(u){var l=ae(u);return Ui(l)&&(l=x),mi(Qi(u,1,Ui,!0),se(l,2))}),ov=Qn(function(u){var l=ae(u);return l=typeof l=="function"?l:x,mi(Qi(u,1,Ui,!0),x,l)});function lp(u){return u&&u.length?mi(u):[]}function sv(u,l){return u&&u.length?mi(u,se(l,2)):[]}function mm(u,l){return l=typeof l=="function"?l:x,u&&u.length?mi(u,x,l):[]}function uv(u){if(!(u&&u.length))return[];var l=0;return u=ws(u,function(p){if(Ui(p))return l=pi(p.length,l),!0}),gl(l,function(p){return Yr(u,Ko(p))})}function dp(u,l){if(!(u&&u.length))return[];var p=uv(u);return l==null?p:Yr(p,function(w){return ma(l,x,w)})}var hp=Qn(function(u,l){return Ui(u)?Dc(u,l):[]}),gm=Qn(function(u){return Zc(ws(u,Ui))}),vp=Qn(function(u){var l=ae(u);return Ui(l)&&(l=x),Zc(ws(u,Ui),se(l,2))}),ym=Qn(function(u){var l=ae(u);return l=typeof l=="function"?l:x,Zc(ws(u,Ui),x,l)}),pp=Qn(uv);function _m(u,l){return jc(u||[],l||[],So)}function mp(u,l){return jc(u||[],l||[],Bc)}var Em=Qn(function(u){var l=u.length,p=l>1?u[l-1]:x;return p=typeof p=="function"?(u.pop(),p):x,dp(u,p)});function sc(u){var l=P(u);return l.__chain__=!0,l}function bm(u,l){return l(u),u}function Yd(u,l){return l(u)}var cv=Pi(function(u){var l=u.length,p=l?u[0]:0,w=this.__wrapped__,M=function(F){return ju(F,u)};return l>1||this.__actions__.length||!(w instanceof lr)||!Tt(p)?this.thru(M):(w=w.slice(p,+p+(l?1:0)),w.__actions__.push({func:Yd,args:[M],thisArg:x}),new za(w,this.__chain__).thru(function(F){return l&&!F.length&&F.push(x),F}))});function fv(){return sc(this)}function wm(){return new za(this.value(),this.__chain__)}function xm(){this.__values__===x&&(this.__values__=Oo(this.value()));var u=this.__index__>=this.__values__.length,l=u?x:this.__values__[this.__index__++];return{done:u,value:l}}function Sm(){return this}function Tm(u){for(var l,p=this;p instanceof Pf;){var w=_n(p);w.__index__=0,w.__values__=x,l?M.__wrapped__=w:l=w;var M=w;p=p.__wrapped__}return M.__wrapped__=u,l}function Jf(){var u=this.__wrapped__;if(u instanceof lr){var l=u;return this.__actions__.length&&(l=new lr(this)),l=l.reverse(),l.__actions__.push({func:Yd,args:[Jt],thisArg:x}),new za(l,this.__chain__)}return this.thru(Jt)}function gp(){return rs(this.__wrapped__,this.__actions__)}var yp=as(function(u,l,p){Kn.call(u,p)?++u[p]:ya(u,p,1)});function Am(u,l,p){var w=qn(u)?od:Ld;return p&&Fe(u,l,p)&&(l=x),w(u,se(l,3))}function _p(u,l){var p=qn(u)?ws:kf;return p(u,se(l,3))}var Kd=ks(Pt),Fl=ks(Nn);function qd(u,l){return Qi(Do(u,l),1)}function Im(u,l){return Qi(Do(u,l),jt)}function Cm(u,l,p){return p=p===x?1:jn(p),Qi(Do(u,l),p)}function lv(u,l){var p=qn(u)?ga:es;return p(u,se(l,3))}function dv(u,l){var p=qn(u)?ad:Rl;return p(u,se(l,3))}var Rm=as(function(u,l,p){Kn.call(u,p)?u[p].push(l):ya(u,p,[l])});function Ep(u,l,p,w){u=Va(u)?u:el(u),p=p&&!w?jn(p):0;var M=u.length;return p<0&&(p=pi(M+p,0)),oh(u)?p<=M&&u.indexOf(l,p)>-1:!!M&&Ka(u,l,p)>-1}var Mm=Qn(function(u,l,p){var w=-1,M=typeof l=="function",F=Va(u)?Pe(u.length):[];return es(u,function(J){F[++w]=M?ma(l,J,p):Xu(J,l,p)}),F}),Nm=as(function(u,l,p){ya(u,p,l)});function Do(u,l){var p=qn(u)?Yr:Os;return p(u,se(l,3))}function bp(u,l,p,w){return u==null?[]:(qn(l)||(l=l==null?[]:[l]),p=w?x:p,qn(p)||(p=p==null?[]:[p]),ra(u,l,p))}var Dm=as(function(u,l,p){u[p?0:1].push(l)},function(){return[[],[]]});function Pm(u,l,p){var w=qn(u)?Gr:pf,M=arguments.length<3;return w(u,se(l,4),p,M,es)}function wp(u,l,p){var w=qn(u)?hl:pf,M=arguments.length<3;return w(u,se(l,4),p,M,Rl)}function Om(u,l){var p=qn(u)?ws:kf;return p(u,th(se(l,3)))}function Lm(u){var l=qn(u)?Qs:ev;return l(u)}function xp(u,l,p){(p?Fe(u,l,p):l===x)?l=1:l=jn(l);var w=qn(u)?Pd:tv;return w(u,l)}function Sp(u){var l=qn(u)?Zu:Zf;return l(u)}function Tp(u){if(u==null)return 0;if(Va(u))return oh(u)?Pu(u):u.length;var l=qe(u);return l==gi||l==$i?u.size:no(u).length}function Gm(u,l,p){var w=qn(u)?vl:nv;return p&&Fe(u,l,p)&&(l=x),w(u,se(l,3))}var km=Qn(function(u,l){if(u==null)return[];var p=l.length;return p>1&&Fe(u,l[0],l[1])?l=[]:p>2&&Fe(l[0],l[1],l[2])&&(l=[l[0]]),ra(u,Qi(l,1),[])}),Ul=xl||function(){return Zn.Date.now()};function Fm(u,l){if(typeof l!="function")throw new Ja(H);return u=jn(u),function(){if(--u<1)return l.apply(this,arguments)}}function Ap(u,l,p){return l=p?x:l,l=u&&l==null?u.length:l,so(u,St,x,x,x,x,l)}function Ip(u,l){var p;if(typeof l!="function")throw new Ja(H);return u=jn(u),function(){return--u>0&&(p=l.apply(this,arguments)),u<=1&&(l=x),p}}var hv=Qn(function(u,l,p){var w=ht;if(p.length){var M=Ba(p,ye(hv));w|=at}return so(u,w,l,p,M)}),Cp=Qn(function(u,l,p){var w=ht|vt;if(p.length){var M=Ba(p,ye(Cp));w|=at}return so(l,w,u,p,M)});function Jd(u,l,p){l=p?x:l;var w=so(u,Ae,x,x,x,x,x,l);return w.placeholder=Jd.placeholder,w}function Qd(u,l,p){l=p?x:l;var w=so(u,xt,x,x,x,x,x,l);return w.placeholder=Qd.placeholder,w}function vv(u,l,p){var w,M,F,J,ue,be,ct=0,et=!1,wt=!1,Xt=!0;if(typeof u!="function")throw new Ja(H);l=Lo(l)||0,ci(p)&&(et=!!p.leading,wt="maxWait"in p,F=wt?pi(Lo(p.maxWait)||0,l):F,Xt="trailing"in p?!!p.trailing:Xt);function sn(Si){var cs=w,Us=M;return w=M=x,ct=Si,J=u.apply(Us,cs),J}function Ln(Si){return ct=Si,ue=On(hr,l),et?sn(Si):J}function ur(Si){var cs=Si-be,Us=Si-ct,M0=l-cs;return wt?Ji(M0,F-Us):M0}function Gn(Si){var cs=Si-be,Us=Si-ct;return be===x||cs>=l||cs<0||wt&&Us>=F}function hr(){var Si=Ul();if(Gn(Si))return _r(Si);ue=On(hr,ur(Si))}function _r(Si){return ue=x,Xt&&w?sn(Si):(w=M=x,J)}function co(){ue!==x&&Ro(ue),ct=0,w=be=M=ue=x}function Da(){return ue===x?J:_r(Ul())}function Pa(){var Si=Ul(),cs=Gn(Si);if(w=arguments,M=this,be=Si,cs){if(ue===x)return Ln(be);if(wt)return Ro(ue),ue=On(hr,l),sn(be)}return ue===x&&(ue=On(hr,l)),J}return Pa.cancel=co,Pa.flush=Da,Pa}var Rp=Qn(function(u,l){return Hu(u,1,l)}),Mp=Qn(function(u,l,p){return Hu(u,Lo(l)||0,p)});function Np(u){return so(u,zt)}function eh(u,l){if(typeof u!="function"||l!=null&&typeof l!="function")throw new Ja(H);var p=function(){var w=arguments,M=l?l.apply(this,w):w[0],F=p.cache;if(F.has(M))return F.get(M);var J=u.apply(this,w);return p.cache=F.set(M,J)||F,J};return p.cache=new(eh.Cache||Qo),p}eh.Cache=Qo;function th(u){if(typeof u!="function")throw new Ja(H);return function(){var l=arguments;switch(l.length){case 0:return!u.call(this);case 1:return!u.call(this,l[0]);case 2:return!u.call(this,l[0],l[1]);case 3:return!u.call(this,l[0],l[1],l[2])}return!u.apply(this,l)}}function Dp(u){return Ip(2,u)}var Um=Zi(function(u,l){l=l.length==1&&qn(l[0])?Yr(l[0],ca(se())):Yr(Qi(l,1),ca(se()));var p=l.length;return Qn(function(w){for(var M=-1,F=Ji(w.length,p);++M<F;)w[M]=l[M].call(this,w[M]);return ma(u,this,w)})}),pv=Qn(function(u,l){var p=Ba(l,ye(pv));return so(u,at,x,l,p)}),Pp=Qn(function(u,l){var p=Ba(l,ye(Pp));return so(u,tt,x,l,p)}),Bm=Pi(function(u,l){return so(u,Mt,x,x,x,l)});function Op(u,l){if(typeof u!="function")throw new Ja(H);return l=l===x?l:jn(l),Qn(u,l)}function zm(u,l){if(typeof u!="function")throw new Ja(H);return l=l==null?0:pi(jn(l),0),Qn(function(p){var w=p[l],M=Ia(p,0,l);return w&&Yo(M,w),ma(u,this,M)})}function mv(u,l,p){var w=!0,M=!0;if(typeof u!="function")throw new Ja(H);return ci(p)&&(w="leading"in p?!!p.leading:w,M="trailing"in p?!!p.trailing:M),vv(u,l,{leading:w,maxWait:l,trailing:M})}function Wm(u){return Ap(u,1)}function Lp(u,l){return pv(cu(l),u)}function Gp(){if(!arguments.length)return[];var u=arguments[0];return qn(u)?u:[u]}function Vm(u){return _a(u,Gt)}function Zm(u,l){return l=typeof l=="function"?l:x,_a(u,Gt,l)}function kp(u){return _a(u,rt|Gt)}function nh(u,l){return l=typeof l=="function"?l:x,_a(u,rt|Gt,l)}function Fp(u,l){return l==null||Nc(u,l,ia(l))}function us(u,l){return u===l||u!==u&&l!==l}var jm=ss(Bf),Hm=ss(function(u,l){return u>=l}),Kc=zf(function(){return arguments}())?zf:function(u){return xi(u)&&Kn.call(u,"callee")&&!Jo.call(u,"callee")},qn=Pe.isArray,Xm=Ua?ca(Ua):Dl;function Va(u){return u!=null&&ih(u.length)&&!Fs(u)}function Ui(u){return xi(u)&&Va(u)}function Up(u){return u===!0||u===!1||xi(u)&&ki(u)==Bi}var uc=Vh||Zl,$m=Ar?ca(Ar):Gc;function rh(u){return xi(u)&&u.nodeType===1&&!Bl(u)}function Bp(u){if(u==null)return!0;if(Va(u)&&(qn(u)||typeof u=="string"||typeof u.splice=="function"||uc(u)||qc(u)||Kc(u)))return!u.length;var l=qe(u);if(l==gi||l==$i)return!u.size;if(yt(u))return!no(u).length;for(var p in u)if(Kn.call(u,p))return!1;return!0}function Zt(u,l){return $u(u,l)}function gv(u,l,p){p=typeof p=="function"?p:x;var w=p?p(u,l):x;return w===x?$u(u,l,x,p):!!w}function sr(u){if(!xi(u))return!1;var l=ki(u);return l==vo||l==Su||typeof u.message=="string"&&typeof u.name=="string"&&!Bl(u)}function zp(u){return typeof u=="number"&&Uu(u)}function Fs(u){if(!ci(u))return!1;var l=ki(u);return l==Hi||l==ds||l==Jn||l==hs}function Qf(u){return typeof u=="number"&&u==jn(u)}function ih(u){return typeof u=="number"&&u>-1&&u%1==0&&u<=mn}function ci(u){var l=typeof u;return u!=null&&(l=="object"||l=="function")}function xi(u){return u!=null&&typeof u=="object"}var Wp=yc?ca(yc):ts;function Ym(u,l){return u===l||nu(u,l,Te(l))}function Km(u,l,p){return p=typeof p=="function"?p:x,nu(u,l,Te(l),p)}function qm(u){return jp(u)&&u!=+u}function Vp(u){if(hn(u))throw new kn(j);return Ps(u)}function Po(u){return u===null}function Zp(u){return u==null}function jp(u){return typeof u=="number"||xi(u)&&ki(u)==li}function Bl(u){if(!xi(u)||ki(u)!=Xi)return!1;var l=Ta(u);if(l===null)return!0;var p=Kn.call(l,"constructor")&&l.constructor;return typeof p=="function"&&p instanceof p&&Is.call(p)==Sf}var ah=bs?ca(bs):kc;function Jm(u){return Qf(u)&&u>=-mn&&u<=mn}var Hp=dl?ca(dl):Fc;function oh(u){return typeof u=="string"||!qn(u)&&xi(u)&&ki(u)==Wr}function Ma(u){return typeof u=="symbol"||xi(u)&&ki(u)==vs}var qc=Xs?ca(Xs):ru;function sh(u){return u===x}function Xp(u){return xi(u)&&qe(u)==zi}function $p(u){return xi(u)&&ki(u)==$a}var uh=ss(Yu),Qm=ss(function(u,l){return u<=l});function Oo(u){if(!u)return[];if(Va(u))return oh(u)?qa(u):la(u);if(Ac&&u[Ac])return ld(u[Ac]());var l=qe(u),p=l==gi?bl:l==$i?wc:el;return p(u)}function pu(u){if(!u)return u===0?u:0;if(u=Lo(u),u===jt||u===-jt){var l=u<0?-1:1;return l*br}return u===u?u:0}function jn(u){var l=pu(u),p=l%1;return l===l?p?l-p:l:0}function yv(u){return u?Ao(jn(u),0,Nr):0}function Lo(u){if(typeof u=="number")return u;if(Ma(u))return fi;if(ci(u)){var l=typeof u.valueOf=="function"?u.valueOf():u;u=ci(l)?l+"":l}if(typeof u!="string")return u===0?u:+u;u=Ec(u);var p=on.test(u);return p||Nt.test(u)?df(u.slice(2),p?2:8):Lt.test(u)?fi:+u}function Yp(u){return io(u,Ea(u))}function eg(u){return u?Ao(jn(u),-mn,mn):u===0?u:0}function Dr(u){return u==null?"":Ur(u)}var tg=Mo(function(u,l){if(yt(l)||Va(l)){io(l,ia(l),u);return}for(var p in l)Kn.call(l,p)&&So(u,p,l[p])}),Kp=Mo(function(u,l){io(l,Ea(l),u)}),ch=Mo(function(u,l,p,w){io(l,Ea(l),u,w)}),ng=Mo(function(u,l,p,w){io(l,ia(l),u,w)}),rg=Pi(ju);function fh(u,l){var p=Wu(u);return l==null?p:eu(p,l)}var ig=Qn(function(u,l){u=wr(u);var p=-1,w=l.length,M=w>2?l[2]:x;for(M&&Fe(l[0],l[1],M)&&(w=1);++p<w;)for(var F=l[p],J=Ea(F),ue=-1,be=J.length;++ue<be;){var ct=J[ue],et=u[ct];(et===x||us(et,xo[ct])&&!Kn.call(u,ct))&&(u[ct]=F[ct])}return u}),ag=Qn(function(u){return u.push(x,ac),ma(Qp,x,u)});function og(u,l){return xs(u,se(l,3),to)}function qp(u,l){return xs(u,se(l,3),Oc)}function sg(u,l){return u==null?u:Ff(u,se(l,3),Ea)}function ug(u,l){return u==null?u:Ml(u,se(l,3),Ea)}function cg(u,l){return u&&to(u,se(l,3))}function _v(u,l){return u&&Oc(u,se(l,3))}function fg(u){return u==null?[]:Lc(u,ia(u))}function lg(u){return u==null?[]:Lc(u,Ea(u))}function zl(u,l,p){var w=u==null?x:Ds(u,l);return w===x?p:w}function dg(u,l){return u!=null&&mt(u,l,Nl)}function Ev(u,l){return u!=null&&mt(u,l,kd)}var Jp=ii(function(u,l,p){l!=null&&typeof l.toString!="function"&&(l=ku.call(l)),u[l]=p},mu(Na)),hg=ii(function(u,l,p){l!=null&&typeof l.toString!="function"&&(l=ku.call(l)),Kn.call(u,l)?u[l].push(p):u[l]=[p]},se),vg=Qn(Xu);function ia(u){return Va(u)?Dd(u):no(u)}function Ea(u){return Va(u)?Dd(u,!0):Vf(u)}function pg(u,l){var p={};return l=se(l,3),to(u,function(w,M,F){ya(p,l(w,M,F),w)}),p}function mg(u,l){var p={};return l=se(l,3),to(u,function(w,M,F){ya(p,M,l(w,M,F))}),p}var gg=Mo(function(u,l,p){Co(u,l,p)}),Qp=Mo(function(u,l,p,w){Co(u,l,p,w)}),e0=Pi(function(u,l){var p={};if(u==null)return p;var w=!1;l=Yr(l,function(F){return F=Fi(F,u),w||(w=F.length>1),F}),io(u,T(u),p),w&&(p=_a(p,rt|ke|Gt,Hd));for(var M=l.length;M--;)ec(p,l[M]);return p});function yg(u,l){return t0(u,th(se(l)))}var _g=Pi(function(u,l){return u==null?{}:ou(u,l)});function t0(u,l){if(u==null)return{};var p=Yr(T(u),function(w){return[w]});return l=se(l),su(u,p,function(w,M){return l(w,M[0])})}function Eg(u,l,p){l=Fi(l,u);var w=-1,M=l.length;for(M||(M=1,u=x);++w<M;){var F=u==null?x:u[Ir(l[w])];F===x&&(w=M,F=p),u=Fs(F)?F.call(u):F}return u}function bg(u,l,p){return u==null?u:Bc(u,l,p)}function wg(u,l,p,w){return w=typeof w=="function"?w:x,u==null?u:Bc(u,l,p,w)}var n0=vu(ia),r0=vu(Ea);function xg(u,l,p){var w=qn(u),M=w||uc(u)||qc(u);if(l=se(l,4),p==null){var F=u&&u.constructor;M?p=w?new F:[]:ci(u)?p=Fs(F)?Wu(Ta(u)):{}:p={}}return(M?ga:to)(u,function(J,ue,be){return l(p,J,ue,be)}),p}function Sg(u,l){return u==null?!0:ec(u,l)}function Tg(u,l,p){return u==null?u:Vc(u,l,cu(p))}function Ag(u,l,p,w){return w=typeof w=="function"?w:x,u==null?u:Vc(u,l,cu(p),w)}function el(u){return u==null?[]:bc(u,ia(u))}function Ig(u){return u==null?[]:bc(u,Ea(u))}function Cg(u,l,p){return p===x&&(p=l,l=x),p!==x&&(p=Lo(p),p=p===p?p:0),l!==x&&(l=Lo(l),l=l===l?l:0),Ao(Lo(u),l,p)}function Rg(u,l,p){return l=pu(l),p===x?(p=l,l=0):p=pu(p),u=Lo(u),Fd(u,l,p)}function Mg(u,l,p){if(p&&typeof p!="boolean"&&Fe(u,l,p)&&(l=p=x),p===x&&(typeof l=="boolean"?(p=l,l=x):typeof u=="boolean"&&(p=u,u=x)),u===x&&l===x?(u=0,l=1):(u=pu(u),l===x?(l=u,u=0):l=pu(l)),u>l){var w=u;u=l,l=w}if(p||u%1||l%1){var M=Rf();return Ji(u+M*(l-u+lf("1e-"+((M+"").length-1))),l)}return Pl(u,l)}var Ng=du(function(u,l,p){return l=l.toLowerCase(),u+(p?i0(l):l)});function i0(u){return xv(Dr(u).toLowerCase())}function Wl(u){return u=Dr(u),u&&u.replace(yn,El).replace(bi,"")}function Dg(u,l,p){u=Dr(u),l=Ur(l);var w=u.length;p=p===x?w:Ao(jn(p),0,w);var M=p;return p-=l.length,p>=0&&u.slice(p,M)==l}function q(u){return u=Dr(u),u&&di.test(u)?u.replace(ps,sd):u}function Pg(u){return u=Dr(u),u&&ff.test(u)?u.replace(Ru,"\\$&"):u}var lh=du(function(u,l,p){return u+(p?"-":"")+l.toLowerCase()}),a0=du(function(u,l,p){return u+(p?" ":"")+l.toLowerCase()}),Og=os("toLowerCase");function Lg(u,l,p){u=Dr(u),l=jn(l);var w=l?Pu(u):0;if(!l||w>=l)return u;var M=(l-w)/2;return Yf(Fu(M),p)+u+Yf(If(M),p)}function Gg(u,l,p){u=Dr(u),l=jn(l);var w=l?Pu(u):0;return l&&w<l?u+Yf(l-w,p):u}function kg(u,l,p){u=Dr(u),l=jn(l);var w=l?Pu(u):0;return l&&w<l?Yf(l-w,p)+u:u}function bv(u,l,p){return p||l==null?l=0:l&&(l=+l),Ed(Dr(u).replace(ms,""),l||0)}function wv(u,l,p){return(p?Fe(u,l,p):l===x)?l=1:l=jn(l),Ju(Dr(u),l)}function o0(){var u=arguments,l=Dr(u[0]);return u.length<3?l:l.replace(u[1],u[2])}var s0=du(function(u,l,p){return u+(p?"_":"")+l.toLowerCase()});function aa(u,l,p){return p&&typeof p!="number"&&Fe(u,l,p)&&(l=p=x),p=p===x?Nr:p>>>0,p?(u=Dr(u),u&&(typeof l=="string"||l!=null&&!ah(l))&&(l=Ur(l),!l&&As(u))?Ia(qa(u),0,p):u.split(l,p)):[]}var u0=du(function(u,l,p){return u+(p?" ":"")+xv(l)});function c0(u,l,p){return u=Dr(u),p=p==null?0:Ao(jn(p),0,u.length),l=Ur(l),u.slice(p,p+l.length)==l}function f0(u,l,p){var w=P.templateSettings;p&&Fe(u,l,p)&&(l=x),u=Dr(u),l=ch({},l,w,$c);var M=ch({},l.imports,w.imports,$c),F=ia(M),J=bc(M,F),ue,be,ct=0,et=l.interpolate||rr,wt="__p += '",Xt=bf((l.escape||rr).source+"|"+et.source+"|"+(et===po?je:rr).source+"|"+(l.evaluate||rr).source+"|$","g"),sn="//# sourceURL="+(Kn.call(l,"sourceURL")?(l.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Hs+"]")+`
`;u.replace(Xt,function(Gn,hr,_r,co,Da,Pa){return _r||(_r=co),wt+=u.slice(ct,Pa).replace(cr,ud),hr&&(ue=!0,wt+=`' +
__e(`+hr+`) +
'`),Da&&(be=!0,wt+=`';
`+Da+`;
__p += '`),_r&&(wt+=`' +
((__t = (`+_r+`)) == null ? '' : __t) +
'`),ct=Pa+Gn.length,Gn}),wt+=`';
`;var Ln=Kn.call(l,"variable")&&l.variable;if(!Ln)wt=`with (obj) {
`+wt+`
}
`;else if(Ue.test(Ln))throw new kn(Z);wt=(be?wt.replace(wa,""):wt).replace(Au,"$1").replace(Bo,"$1;"),wt="function("+(Ln||"obj")+`) {
`+(Ln?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ue?", __e = _.escape":"")+(be?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+wt+`return __p
}`;var ur=p0(function(){return dr(F,sn+"return "+wt).apply(x,J)});if(ur.source=wt,sr(ur))throw ur;return ur}function l0(u){return Dr(u).toLowerCase()}function d0(u){return Dr(u).toUpperCase()}function Fg(u,l,p){if(u=Dr(u),u&&(p||l===x))return Ec(u);if(!u||!(l=Ur(l)))return u;var w=qa(u),M=qa(l),F=gf(w,M),J=yf(w,M)+1;return Ia(w,F,J).join("")}function dh(u,l,p){if(u=Dr(u),u&&(p||l===x))return u.slice(0,Ef(u)+1);if(!u||!(l=Ur(l)))return u;var w=qa(u),M=yf(w,qa(l))+1;return Ia(w,0,M).join("")}function h0(u,l,p){if(u=Dr(u),u&&(p||l===x))return u.replace(ms,"");if(!u||!(l=Ur(l)))return u;var w=qa(u),M=gf(w,qa(l));return Ia(w,M).join("")}function Ug(u,l){var p=pt,w=en;if(ci(l)){var M="separator"in l?l.separator:M;p="length"in l?jn(l.length):p,w="omission"in l?Ur(l.omission):w}u=Dr(u);var F=u.length;if(As(u)){var J=qa(u);F=J.length}if(p>=F)return u;var ue=p-Pu(w);if(ue<1)return w;var be=J?Ia(J,0,ue).join(""):u.slice(0,ue);if(M===x)return be+w;if(J&&(ue+=be.length-ue),ah(M)){if(u.slice(ue).search(M)){var ct,et=be;for(M.global||(M=bf(M.source,Dr(kt.exec(M))+"g")),M.lastIndex=0;ct=M.exec(et);)var wt=ct.index;be=be.slice(0,wt===x?ue:wt)}}else if(u.indexOf(Ur(M),ue)!=ue){var Xt=be.lastIndexOf(M);Xt>-1&&(be=be.slice(0,Xt))}return be+w}function Bg(u){return u=Dr(u),u&&uf.test(u)?u.replace(zo,Bh):u}var zg=du(function(u,l,p){return u+(p?" ":"")+l.toUpperCase()}),xv=os("toUpperCase");function v0(u,l,p){return u=Dr(u),l=p?x:l,l===x?fd(u)?xc(u):vf(u):u.match(l)||[]}var p0=Qn(function(u,l){try{return ma(u,x,l)}catch(p){return sr(p)?p:new kn(p)}}),Wg=Pi(function(u,l){return ga(l,function(p){p=Ir(p),ya(u,p,hv(u[p],u))}),u});function Vg(u){var l=u==null?0:u.length,p=se();return u=l?Yr(u,function(w){if(typeof w[1]!="function")throw new Ja(H);return[p(w[0]),w[1]]}):[],Qn(function(w){for(var M=-1;++M<l;){var F=u[M];if(ma(F[0],this,w))return ma(F[1],this,w)}})}function Zg(u){return Gf(_a(u,rt))}function mu(u){return function(){return u}}function Sv(u,l){return u==null||u!==u?l:u}var m0=ea(),Tv=ea(!0);function Na(u){return u}function hh(u){return Io(typeof u=="function"?u:_a(u,rt))}function g0(u){return iu(_a(u,rt))}function y0(u,l){return au(u,_a(l,rt))}var _0=Qn(function(u,l){return function(p){return Xu(p,u,l)}}),E0=Qn(function(u,l){return function(p){return Xu(u,p,l)}});function Av(u,l,p){var w=ia(l),M=Lc(l,w);p==null&&!(ci(l)&&(M.length||!w.length))&&(p=l,l=u,u=this,M=Lc(l,ia(l)));var F=!(ci(p)&&"chain"in p)||!!p.chain,J=Fs(u);return ga(M,function(ue){var be=l[ue];u[ue]=be,J&&(u.prototype[ue]=function(){var ct=this.__chain__;if(F||ct){var et=u(this.__wrapped__),wt=et.__actions__=la(this.__actions__);return wt.push({func:be,args:arguments,thisArg:u}),et.__chain__=ct,et}return be.apply(u,Yo([this.value()],arguments))})}),u}function jg(){return Zn._===this&&(Zn._=vd),this}function vh(){}function Hg(u){return u=jn(u),Qn(function(l){return Bd(l,u)})}var b0=$f(Yr),w0=$f(od),Xg=$f(vl);function Iv(u){return gt(u)?Ko(Ir(u)):Uc(u)}function x0(u){return function(l){return u==null?x:Ds(u,l)}}var S0=jd(),T0=jd(!0);function Vl(){return[]}function Zl(){return!1}function $g(){return{}}function Yg(){return""}function Kg(){return!0}function qg(u,l){if(u=jn(u),u<1||u>mn)return[];var p=Nr,w=Ji(u,Nr);l=se(l),u-=Nr;for(var M=gl(w,l);++p<u;)l(p);return M}function Jg(u){return qn(u)?Yr(u,Ir):Ma(u)?[u]:la(oi(Dr(u)))}function Qg(u){var l=++Gu;return Dr(u)+l}var A0=Di(function(u,l){return u+l},0),ey=Gl("ceil"),ty=Di(function(u,l){return u/l},1),ny=Gl("floor");function ry(u){return u&&u.length?Pc(u,Na,Bf):x}function iy(u,l){return u&&u.length?Pc(u,se(l,2),Bf):x}function ay(u){return ml(u,Na)}function I0(u,l){return ml(u,se(l,2))}function oy(u){return u&&u.length?Pc(u,Na,Yu):x}function C0(u,l){return u&&u.length?Pc(u,se(l,2),Yu):x}var sy=Di(function(u,l){return u*l},1),uy=Gl("round"),cy=Di(function(u,l){return u-l},0);function fy(u){return u&&u.length?mf(u,Na):0}function R0(u,l){return u&&u.length?mf(u,se(l,2)):0}return P.after=Fm,P.ary=Ap,P.assign=tg,P.assignIn=Kp,P.assignInWith=ch,P.assignWith=ng,P.at=rg,P.before=Ip,P.bind=hv,P.bindAll=Wg,P.bindKey=Cp,P.castArray=Gp,P.chain=sc,P.chunk=si,P.compact=or,P.concat=tn,P.cond=Vg,P.conforms=Zg,P.constant=mu,P.countBy=yp,P.create=fh,P.curry=Jd,P.curryRight=Qd,P.debounce=vv,P.defaults=ig,P.defaultsDeep=ag,P.defer=Rp,P.delay=Mp,P.difference=Vn,P.differenceBy=er,P.differenceWith=ui,P.drop=No,P.dropRight=Ca,P.dropRightWhile=z,P.dropWhile=Se,P.fill=_e,P.filter=_p,P.flatMap=qd,P.flatMapDeep=Im,P.flatMapDepth=Cm,P.flatten=U,P.flattenDeep=D,P.flattenDepth=Y,P.flip=Np,P.flow=m0,P.flowRight=Tv,P.fromPairs=ce,P.functions=fg,P.functionsIn=lg,P.groupBy=Rm,P.initial=K,P.intersection=oe,P.intersectionBy=B,P.intersectionWith=$,P.invert=Jp,P.invertBy=hg,P.invokeMap=Mm,P.iteratee=hh,P.keyBy=Nm,P.keys=ia,P.keysIn=Ea,P.map=Do,P.mapKeys=pg,P.mapValues=mg,P.matches=g0,P.matchesProperty=y0,P.memoize=eh,P.merge=gg,P.mergeWith=Qp,P.method=_0,P.methodOf=E0,P.mixin=Av,P.negate=th,P.nthArg=Hg,P.omit=e0,P.omitBy=yg,P.once=Dp,P.orderBy=bp,P.over=b0,P.overArgs=Um,P.overEvery=w0,P.overSome=Xg,P.partial=pv,P.partialRight=Pp,P.partition=Dm,P.pick=_g,P.pickBy=t0,P.property=Iv,P.propertyOf=x0,P.pull=Be,P.pullAll=Me,P.pullAllBy=st,P.pullAllWith=At,P.pullAt=xn,P.range=S0,P.rangeRight=T0,P.rearg=Bm,P.reject=Om,P.remove=Bt,P.rest=Op,P.reverse=Jt,P.sampleSize=xp,P.set=bg,P.setWith=wg,P.shuffle=Sp,P.slice=vn,P.sortBy=km,P.sortedUniq=uo,P.sortedUniqBy=Xd,P.split=aa,P.spread=zm,P.tail=hm,P.take=$d,P.takeRight=up,P.takeRightWhile=vm,P.takeWhile=cp,P.tap=bm,P.throttle=mv,P.thru=Yd,P.toArray=Oo,P.toPairs=n0,P.toPairsIn=r0,P.toPath=Jg,P.toPlainObject=Yp,P.transform=xg,P.unary=Wm,P.union=fp,P.unionBy=pm,P.unionWith=ov,P.uniq=lp,P.uniqBy=sv,P.uniqWith=mm,P.unset=Sg,P.unzip=uv,P.unzipWith=dp,P.update=Tg,P.updateWith=Ag,P.values=el,P.valuesIn=Ig,P.without=hp,P.words=v0,P.wrap=Lp,P.xor=gm,P.xorBy=vp,P.xorWith=ym,P.zip=pp,P.zipObject=_m,P.zipObjectDeep=mp,P.zipWith=Em,P.entries=n0,P.entriesIn=r0,P.extend=Kp,P.extendWith=ch,Av(P,P),P.add=A0,P.attempt=p0,P.camelCase=Ng,P.capitalize=i0,P.ceil=ey,P.clamp=Cg,P.clone=Vm,P.cloneDeep=kp,P.cloneDeepWith=nh,P.cloneWith=Zm,P.conformsTo=Fp,P.deburr=Wl,P.defaultTo=Sv,P.divide=ty,P.endsWith=Dg,P.eq=us,P.escape=q,P.escapeRegExp=Pg,P.every=Am,P.find=Kd,P.findIndex=Pt,P.findKey=og,P.findLast=Fl,P.findLastIndex=Nn,P.findLastKey=qp,P.floor=ny,P.forEach=lv,P.forEachRight=dv,P.forIn=sg,P.forInRight=ug,P.forOwn=cg,P.forOwnRight=_v,P.get=zl,P.gt=jm,P.gte=Hm,P.has=dg,P.hasIn=Ev,P.head=le,P.identity=Na,P.includes=Ep,P.indexOf=ne,P.inRange=Rg,P.invoke=vg,P.isArguments=Kc,P.isArray=qn,P.isArrayBuffer=Xm,P.isArrayLike=Va,P.isArrayLikeObject=Ui,P.isBoolean=Up,P.isBuffer=uc,P.isDate=$m,P.isElement=rh,P.isEmpty=Bp,P.isEqual=Zt,P.isEqualWith=gv,P.isError=sr,P.isFinite=zp,P.isFunction=Fs,P.isInteger=Qf,P.isLength=ih,P.isMap=Wp,P.isMatch=Ym,P.isMatchWith=Km,P.isNaN=qm,P.isNative=Vp,P.isNil=Zp,P.isNull=Po,P.isNumber=jp,P.isObject=ci,P.isObjectLike=xi,P.isPlainObject=Bl,P.isRegExp=ah,P.isSafeInteger=Jm,P.isSet=Hp,P.isString=oh,P.isSymbol=Ma,P.isTypedArray=qc,P.isUndefined=sh,P.isWeakMap=Xp,P.isWeakSet=$p,P.join=G,P.kebabCase=lh,P.last=ae,P.lastIndexOf=pe,P.lowerCase=a0,P.lowerFirst=Og,P.lt=uh,P.lte=Qm,P.max=ry,P.maxBy=iy,P.mean=ay,P.meanBy=I0,P.min=oy,P.minBy=C0,P.stubArray=Vl,P.stubFalse=Zl,P.stubObject=$g,P.stubString=Yg,P.stubTrue=Kg,P.multiply=sy,P.nth=Oe,P.noConflict=jg,P.noop=vh,P.now=Ul,P.pad=Lg,P.padEnd=Gg,P.padStart=kg,P.parseInt=bv,P.random=Mg,P.reduce=Pm,P.reduceRight=wp,P.repeat=wv,P.replace=o0,P.result=Eg,P.round=uy,P.runInContext=ge,P.sample=Lm,P.size=Tp,P.snakeCase=s0,P.some=Gm,P.sortedIndex=tr,P.sortedIndexBy=kr,P.sortedIndexOf=wi,P.sortedLastIndex=qf,P.sortedLastIndexBy=Ra,P.sortedLastIndexOf=kl,P.startCase=u0,P.startsWith=c0,P.subtract=cy,P.sum=fy,P.sumBy=R0,P.template=f0,P.times=qg,P.toFinite=pu,P.toInteger=jn,P.toLength=yv,P.toLower=l0,P.toNumber=Lo,P.toSafeInteger=eg,P.toString=Dr,P.toUpper=d0,P.trim=Fg,P.trimEnd=dh,P.trimStart=h0,P.truncate=Ug,P.unescape=Bg,P.uniqueId=Qg,P.upperCase=zg,P.upperFirst=xv,P.each=lv,P.eachRight=dv,P.first=le,Av(P,function(){var u={};return to(P,function(l,p){Kn.call(P.prototype,p)||(u[p]=l)}),u}(),{chain:!1}),P.VERSION=ee,ga(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){P[u].placeholder=P}),ga(["drop","take"],function(u,l){lr.prototype[u]=function(p){p=p===x?1:pi(jn(p),0);var w=this.__filtered__&&!l?new lr(this):this.clone();return w.__filtered__?w.__takeCount__=Ji(p,w.__takeCount__):w.__views__.push({size:Ji(p,Nr),type:u+(w.__dir__<0?"Right":"")}),w},lr.prototype[u+"Right"]=function(p){return this.reverse()[u](p).reverse()}}),ga(["filter","map","takeWhile"],function(u,l){var p=l+1,w=p==nt||p==ln;lr.prototype[u]=function(M){var F=this.clone();return F.__iteratees__.push({iteratee:se(M,3),type:p}),F.__filtered__=F.__filtered__||w,F}}),ga(["head","last"],function(u,l){var p="take"+(l?"Right":"");lr.prototype[u]=function(){return this[p](1).value()[0]}}),ga(["initial","tail"],function(u,l){var p="drop"+(l?"":"Right");lr.prototype[u]=function(){return this.__filtered__?new lr(this):this[p](1)}}),lr.prototype.compact=function(){return this.filter(Na)},lr.prototype.find=function(u){return this.filter(u).head()},lr.prototype.findLast=function(u){return this.reverse().find(u)},lr.prototype.invokeMap=Qn(function(u,l){return typeof u=="function"?new lr(this):this.map(function(p){return Xu(p,u,l)})}),lr.prototype.reject=function(u){return this.filter(th(se(u)))},lr.prototype.slice=function(u,l){u=jn(u);var p=this;return p.__filtered__&&(u>0||l<0)?new lr(p):(u<0?p=p.takeRight(-u):u&&(p=p.drop(u)),l!==x&&(l=jn(l),p=l<0?p.dropRight(-l):p.take(l-u)),p)},lr.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},lr.prototype.toArray=function(){return this.take(Nr)},to(lr.prototype,function(u,l){var p=/^(?:filter|find|map|reject)|While$/.test(l),w=/^(?:head|last)$/.test(l),M=P[w?"take"+(l=="last"?"Right":""):l],F=w||/^find/.test(l);!M||(P.prototype[l]=function(){var J=this.__wrapped__,ue=w?[1]:arguments,be=J instanceof lr,ct=ue[0],et=be||qn(J),wt=function(hr){var _r=M.apply(P,Yo([hr],ue));return w&&Xt?_r[0]:_r};et&&p&&typeof ct=="function"&&ct.length!=1&&(be=et=!1);var Xt=this.__chain__,sn=!!this.__actions__.length,Ln=F&&!Xt,ur=be&&!sn;if(!F&&et){J=ur?J:new lr(this);var Gn=u.apply(J,ue);return Gn.__actions__.push({func:Yd,args:[wt],thisArg:x}),new za(Gn,Xt)}return Ln&&ur?u.apply(this,ue):(Gn=this.thru(wt),Ln?w?Gn.value()[0]:Gn.value():Gn)})}),ga(["pop","push","shift","sort","splice","unshift"],function(u){var l=Sc[u],p=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",w=/^(?:pop|shift)$/.test(u);P.prototype[u]=function(){var M=arguments;if(w&&!this.__chain__){var F=this.value();return l.apply(qn(F)?F:[],M)}return this[p](function(J){return l.apply(qn(J)?J:[],M)})}}),to(lr.prototype,function(u,l){var p=P[l];if(p){var w=p.name+"";Kn.call(Aa,w)||(Aa[w]=[]),Aa[w].push({name:l,func:p})}}),Aa[oo(x,vt).name]=[{name:"wrapper",func:x}],lr.prototype.clone=Sd,lr.prototype.reverse=Zh,lr.prototype.value=Of,P.prototype.at=cv,P.prototype.chain=fv,P.prototype.commit=wm,P.prototype.next=xm,P.prototype.plant=Tm,P.prototype.reverse=Jf,P.prototype.toJSON=P.prototype.valueOf=P.prototype.value=gp,P.prototype.first=P.prototype.head,Ac&&(P.prototype[Ac]=Sm),P},Ou=Wh();Zn._=Ou,N=function(){return Ou}.call(I,S,I,we),N!==x&&(we.exports=N)}).call(this)},40582:function(we,I,S){var N=S(89550),x=S(68854),ee=S(36820),V=S(43650),j=S(56601),H=[0,0];we.exports.x7=function(De,he,me,rt,ke){return N(De,me,rt),ee(De,De),x(he,-De[1],De[0]),x(H,-me[1],me[0]),ke/j(he,H)},we.exports.mJ=function(De,he){return x(De,-he[1],he[0]),De},we.exports.o7=function(De,he,me){return V(De,he,me),ee(De,De),De}},28660:function(we,I,S){var N=S(34155);/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var x;(function(ee){(function(V){var j=typeof S.g=="object"?S.g:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),H=Z(ee);typeof j.Reflect=="undefined"?j.Reflect=ee:H=Z(j.Reflect,H),V(H);function Z(De,he){return function(me,rt){typeof De[me]!="function"&&Object.defineProperty(De,me,{configurable:!0,writable:!0,value:rt}),he&&he(me,rt)}}})(function(V){var j=Object.prototype.hasOwnProperty,H=typeof Symbol=="function",Z=H&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",De=H&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",he=typeof Object.create=="function",me={__proto__:[]}instanceof Array,rt=!he&&!me,ke={create:he?function(){return $a(Object.create(null))}:me?function(){return $a({__proto__:null})}:function(){return $a({})},has:rt?function(xe,Xe){return j.call(xe,Xe)}:function(xe,Xe){return Xe in xe},get:rt?function(xe,Xe){return j.call(xe,Xe)?xe[Xe]:void 0}:function(xe,Xe){return xe[Xe]}},Gt=Object.getPrototypeOf(Function),Yt=typeof N=="object"&&{NODE_ENV:"production"}&&{NODE_ENV:"production"}.REFLECT_METADATA_USE_MAP_POLYFILL==="true",dt=!Yt&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:vs(),ht=!Yt&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Uo(),vt=!Yt&&typeof WeakMap=="function"?WeakMap:zi(),Ne=new vt;function Ae(xe,Xe,bt,Ft){if(mr(bt)){if(!ds(xe))throw new TypeError;if(!li(Xe))throw new TypeError;return L(xe,Xe)}else{if(!ds(xe))throw new TypeError;if(!Jn(Xe))throw new TypeError;if(!Jn(Ft)&&!mr(Ft)&&!zr(Ft))throw new TypeError;return zr(Ft)&&(Ft=void 0),bt=Hi(bt),nt(xe,Xe,bt,Ft)}}V("decorate",Ae);function xt(xe,Xe){function bt(Ft,Wt){if(!Jn(Ft))throw new TypeError;if(!mr(Wt)&&!Tu(Wt))throw new TypeError;fi(xe,Xe,Ft,Wt)}return bt}V("metadata",xt);function at(xe,Xe,bt,Ft){if(!Jn(bt))throw new TypeError;return mr(Ft)||(Ft=Hi(Ft)),fi(xe,Xe,bt,Ft)}V("defineMetadata",at);function tt(xe,Xe,bt){if(!Jn(Xe))throw new TypeError;return mr(bt)||(bt=Hi(bt)),ln(xe,Xe,bt)}V("hasMetadata",tt);function St(xe,Xe,bt){if(!Jn(Xe))throw new TypeError;return mr(bt)||(bt=Hi(bt)),jt(xe,Xe,bt)}V("hasOwnMetadata",St);function Mt(xe,Xe,bt){if(!Jn(Xe))throw new TypeError;return mr(bt)||(bt=Hi(bt)),mn(xe,Xe,bt)}V("getMetadata",Mt);function zt(xe,Xe,bt){if(!Jn(Xe))throw new TypeError;return mr(bt)||(bt=Hi(bt)),br(xe,Xe,bt)}V("getOwnMetadata",zt);function pt(xe,Xe){if(!Jn(xe))throw new TypeError;return mr(Xe)||(Xe=Hi(Xe)),Nr(xe,Xe)}V("getMetadataKeys",pt);function en(xe,Xe){if(!Jn(xe))throw new TypeError;return mr(Xe)||(Xe=Hi(Xe)),pr(xe,Xe)}V("getOwnMetadataKeys",en);function $n(xe,Xe,bt){if(!Jn(Xe))throw new TypeError;mr(bt)||(bt=Hi(bt));var Ft=$t(Xe,bt,!1);if(mr(Ft)||!Ft.delete(xe))return!1;if(Ft.size>0)return!0;var Wt=Ne.get(Xe);return Wt.delete(bt),Wt.size>0||Ne.delete(Xe),!0}V("deleteMetadata",$n);function L(xe,Xe){for(var bt=xe.length-1;bt>=0;--bt){var Ft=xe[bt],Wt=Ft(Xe);if(!mr(Wt)&&!zr(Wt)){if(!li(Wt))throw new TypeError;Xe=Wt}}return Xe}function nt(xe,Xe,bt,Ft){for(var Wt=xe.length-1;Wt>=0;--Wt){var Rn=xe[Wt],Pn=Rn(Xe,bt,Ft);if(!mr(Pn)&&!zr(Pn)){if(!Jn(Pn))throw new TypeError;Ft=Pn}}return Ft}function $t(xe,Xe,bt){var Ft=Ne.get(xe);if(mr(Ft)){if(!bt)return;Ft=new dt,Ne.set(xe,Ft)}var Wt=Ft.get(Xe);if(mr(Wt)){if(!bt)return;Wt=new dt,Ft.set(Xe,Wt)}return Wt}function ln(xe,Xe,bt){var Ft=jt(xe,Xe,bt);if(Ft)return!0;var Wt=Wr(Xe);return zr(Wt)?!1:ln(xe,Wt,bt)}function jt(xe,Xe,bt){var Ft=$t(Xe,bt,!1);return mr(Ft)?!1:Su(Ft.has(xe))}function mn(xe,Xe,bt){var Ft=jt(xe,Xe,bt);if(Ft)return br(xe,Xe,bt);var Wt=Wr(Xe);if(!zr(Wt))return mn(xe,Wt,bt)}function br(xe,Xe,bt){var Ft=$t(Xe,bt,!1);if(!mr(Ft))return Ft.get(xe)}function fi(xe,Xe,bt,Ft){var Wt=$t(bt,Ft,!0);Wt.set(xe,Xe)}function Nr(xe,Xe){var bt=pr(xe,Xe),Ft=Wr(xe);if(Ft===null)return bt;var Wt=Nr(Ft,Xe);if(Wt.length<=0)return bt;if(bt.length<=0)return Wt;for(var Rn=new ht,Pn=[],Un=0,an=bt;Un<an.length;Un++){var ir=an[Un],nr=Rn.has(ir);nr||(Rn.add(ir),Pn.push(ir))}for(var wa=0,Au=Wt;wa<Au.length;wa++){var ir=Au[wa],nr=Rn.has(ir);nr||(Rn.add(ir),Pn.push(ir))}return Pn}function pr(xe,Xe){var bt=[],Ft=$t(xe,Xe,!1);if(mr(Ft))return bt;for(var Wt=Ft.keys(),Rn=Zs(Wt),Pn=0;;){var Un=k(Rn);if(!Un)return bt.length=Pn,bt;var an=hs(Un);try{bt[Pn]=an}catch(ir){try{$i(Rn)}finally{throw ir}}Pn++}}function ti(xe){if(xe===null)return 1;switch(typeof xe){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return xe===null?1:6;default:return 6}}function mr(xe){return xe===void 0}function zr(xe){return xe===null}function Ha(xe){return typeof xe=="symbol"}function Jn(xe){return typeof xe=="object"?xe!==null:typeof xe=="function"}function Bi(xe,Xe){switch(ti(xe)){case 0:return xe;case 1:return xe;case 2:return xe;case 3:return xe;case 4:return xe;case 5:return xe}var bt=Xe===3?"string":Xe===5?"number":"default",Ft=Xi(xe,Z);if(Ft!==void 0){var Wt=Ft.call(xe,bt);if(Jn(Wt))throw new TypeError;return Wt}return Xa(xe,bt==="default"?"number":bt)}function Xa(xe,Xe){if(Xe==="string"){var bt=xe.toString;if(gi(bt)){var Ft=bt.call(xe);if(!Jn(Ft))return Ft}var Wt=xe.valueOf;if(gi(Wt)){var Ft=Wt.call(xe);if(!Jn(Ft))return Ft}}else{var Wt=xe.valueOf;if(gi(Wt)){var Ft=Wt.call(xe);if(!Jn(Ft))return Ft}var Rn=xe.toString;if(gi(Rn)){var Ft=Rn.call(xe);if(!Jn(Ft))return Ft}}throw new TypeError}function Su(xe){return!!xe}function vo(xe){return""+xe}function Hi(xe){var Xe=Bi(xe,3);return Ha(Xe)?Xe:vo(Xe)}function ds(xe){return Array.isArray?Array.isArray(xe):xe instanceof Object?xe instanceof Array:Object.prototype.toString.call(xe)==="[object Array]"}function gi(xe){return typeof xe=="function"}function li(xe){return typeof xe=="function"}function Tu(xe){switch(ti(xe)){case 3:return!0;case 4:return!0;default:return!1}}function Xi(xe,Xe){var bt=xe[Xe];if(bt!=null){if(!gi(bt))throw new TypeError;return bt}}function Zs(xe){var Xe=Xi(xe,De);if(!gi(Xe))throw new TypeError;var bt=Xe.call(xe);if(!Jn(bt))throw new TypeError;return bt}function hs(xe){return xe.value}function k(xe){var Xe=xe.next();return Xe.done?!1:Xe}function $i(xe){var Xe=xe.return;Xe&&Xe.call(xe)}function Wr(xe){var Xe=Object.getPrototypeOf(xe);if(typeof xe!="function"||xe===Gt||Xe!==Gt)return Xe;var bt=xe.prototype,Ft=bt&&Object.getPrototypeOf(bt);if(Ft==null||Ft===Object.prototype)return Xe;var Wt=Ft.constructor;return typeof Wt!="function"||Wt===xe?Xe:Wt}function vs(){var xe={},Xe=[],bt=function(){function Pn(Un,an,ir){this._index=0,this._keys=Un,this._values=an,this._selector=ir}return Pn.prototype["@@iterator"]=function(){return this},Pn.prototype[De]=function(){return this},Pn.prototype.next=function(){var Un=this._index;if(Un>=0&&Un<this._keys.length){var an=this._selector(this._keys[Un],this._values[Un]);return Un+1>=this._keys.length?(this._index=-1,this._keys=Xe,this._values=Xe):this._index++,{value:an,done:!1}}return{value:void 0,done:!0}},Pn.prototype.throw=function(Un){throw this._index>=0&&(this._index=-1,this._keys=Xe,this._values=Xe),Un},Pn.prototype.return=function(Un){return this._index>=0&&(this._index=-1,this._keys=Xe,this._values=Xe),{value:Un,done:!0}},Pn}();return function(){function Pn(){this._keys=[],this._values=[],this._cacheKey=xe,this._cacheIndex=-2}return Object.defineProperty(Pn.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Pn.prototype.has=function(Un){return this._find(Un,!1)>=0},Pn.prototype.get=function(Un){var an=this._find(Un,!1);return an>=0?this._values[an]:void 0},Pn.prototype.set=function(Un,an){var ir=this._find(Un,!0);return this._values[ir]=an,this},Pn.prototype.delete=function(Un){var an=this._find(Un,!1);if(an>=0){for(var ir=this._keys.length,nr=an+1;nr<ir;nr++)this._keys[nr-1]=this._keys[nr],this._values[nr-1]=this._values[nr];return this._keys.length--,this._values.length--,Un===this._cacheKey&&(this._cacheKey=xe,this._cacheIndex=-2),!0}return!1},Pn.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=xe,this._cacheIndex=-2},Pn.prototype.keys=function(){return new bt(this._keys,this._values,Ft)},Pn.prototype.values=function(){return new bt(this._keys,this._values,Wt)},Pn.prototype.entries=function(){return new bt(this._keys,this._values,Rn)},Pn.prototype["@@iterator"]=function(){return this.entries()},Pn.prototype[De]=function(){return this.entries()},Pn.prototype._find=function(Un,an){return this._cacheKey!==Un&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Un)),this._cacheIndex<0&&an&&(this._cacheIndex=this._keys.length,this._keys.push(Un),this._values.push(void 0)),this._cacheIndex},Pn}();function Ft(Pn,Un){return Pn}function Wt(Pn,Un){return Un}function Rn(Pn,Un){return[Pn,Un]}}function Uo(){return function(){function xe(){this._map=new dt}return Object.defineProperty(xe.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),xe.prototype.has=function(Xe){return this._map.has(Xe)},xe.prototype.add=function(Xe){return this._map.set(Xe,Xe),this},xe.prototype.delete=function(Xe){return this._map.delete(Xe)},xe.prototype.clear=function(){this._map.clear()},xe.prototype.keys=function(){return this._map.keys()},xe.prototype.values=function(){return this._map.values()},xe.prototype.entries=function(){return this._map.entries()},xe.prototype["@@iterator"]=function(){return this.keys()},xe.prototype[De]=function(){return this.keys()},xe}()}function zi(){var xe=16,Xe=ke.create(),bt=Ft();return function(){function an(){this._key=Ft()}return an.prototype.has=function(ir){var nr=Wt(ir,!1);return nr!==void 0?ke.has(nr,this._key):!1},an.prototype.get=function(ir){var nr=Wt(ir,!1);return nr!==void 0?ke.get(nr,this._key):void 0},an.prototype.set=function(ir,nr){var wa=Wt(ir,!0);return wa[this._key]=nr,this},an.prototype.delete=function(ir){var nr=Wt(ir,!1);return nr!==void 0?delete nr[this._key]:!1},an.prototype.clear=function(){this._key=Ft()},an}();function Ft(){var an;do an="@@WeakMap@@"+Un();while(ke.has(Xe,an));return Xe[an]=!0,an}function Wt(an,ir){if(!j.call(an,bt)){if(!ir)return;Object.defineProperty(an,bt,{value:ke.create()})}return an[bt]}function Rn(an,ir){for(var nr=0;nr<ir;++nr)an[nr]=Math.random()*255|0;return an}function Pn(an){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(an)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(an)):Rn(new Uint8Array(an),an):Rn(new Array(an),an)}function Un(){var an=Pn(xe);an[6]=an[6]&79|64,an[8]=an[8]&191|128;for(var ir="",nr=0;nr<xe;++nr){var wa=an[nr];(nr===4||nr===6||nr===8)&&(ir+="-"),wa<16&&(ir+="0"),ir+=wa.toString(16).toLowerCase()}return ir}}function $a(xe){return xe.__=void 0,delete xe.__,xe}})})(x||(x={}))},81550:function(we){(function(I,S){we.exports=S()})(this,function(){"use strict";var I=function(T){return T instanceof Uint8Array||T instanceof Uint16Array||T instanceof Uint32Array||T instanceof Int8Array||T instanceof Int16Array||T instanceof Int32Array||T instanceof Float32Array||T instanceof Float64Array||T instanceof Uint8ClampedArray},S=function(T,O){for(var X=Object.keys(O),ye=0;ye<X.length;++ye)T[X[ye]]=O[X[ye]];return T},N=`
`;function x(T){return typeof atob!="undefined"?atob(T):"base64:"+T}function ee(T){var O=new Error("(regl) "+T);throw console.error(O),O}function V(T,O){T||ee(O)}function j(T){return T?": "+T:""}function H(T,O,X){T in O||ee("unknown parameter ("+T+")"+j(X)+". possible values: "+Object.keys(O).join())}function Z(T,O){I(T)||ee("invalid parameter type"+j(O)+". must be a typed array")}function De(T,O){switch(O){case"number":return typeof T=="number";case"object":return typeof T=="object";case"string":return typeof T=="string";case"boolean":return typeof T=="boolean";case"function":return typeof T=="function";case"undefined":return typeof T=="undefined";case"symbol":return typeof T=="symbol"}}function he(T,O,X){De(T,O)||ee("invalid parameter type"+j(X)+". expected "+O+", got "+typeof T)}function me(T,O){T>=0&&(T|0)===T||ee("invalid parameter type, ("+T+")"+j(O)+". must be a nonnegative integer")}function rt(T,O,X){O.indexOf(T)<0&&ee("invalid value"+j(X)+". must be one of: "+O)}var ke=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Gt(T){Object.keys(T).forEach(function(O){ke.indexOf(O)<0&&ee('invalid regl constructor argument "'+O+'". must be one of '+ke)})}function Yt(T,O){for(T=T+"";T.length<O;)T=" "+T;return T}function dt(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function ht(T,O){this.number=T,this.line=O,this.errors=[]}function vt(T,O,X){this.file=T,this.line=O,this.message=X}function Ne(){var T=new Error,O=(T.stack||T).toString(),X=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(O);if(X)return X[1];var ye=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(O);return ye?ye[1]:"unknown"}function Ae(){var T=new Error,O=(T.stack||T).toString(),X=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(O);if(X)return X[1];var ye=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(O);return ye?ye[1]:"unknown"}function xt(T,O){var X=T.split(`
`),ye=1,se=0,Ee={unknown:new dt,0:new dt};Ee.unknown.name=Ee[0].name=O||Ne(),Ee.unknown.lines.push(new ht(0,""));for(var Te=0;Te<X.length;++Te){var $e=X[Te],Qe=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec($e);if(Qe)switch(Qe[1]){case"line":var it=/(\d+)(\s+\d+)?/.exec(Qe[2]);it&&(ye=it[1]|0,it[2]&&(se=it[2]|0,se in Ee||(Ee[se]=new dt)));break;case"define":var Le=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Qe[2]);Le&&(Ee[se].name=Le[1]?x(Le[2]):Le[2]);break}Ee[se].lines.push(new ht(ye++,$e))}return Object.keys(Ee).forEach(function(qe){var Et=Ee[qe];Et.lines.forEach(function(Ke){Et.index[Ke.number]=Ke})}),Ee}function at(T){var O=[];return T.split(`
`).forEach(function(X){if(!(X.length<5)){var ye=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(X);ye?O.push(new vt(ye[1]|0,ye[2]|0,ye[3].trim())):X.length>0&&O.push(new vt("unknown",0,X))}}),O}function tt(T,O){O.forEach(function(X){var ye=T[X.file];if(ye){var se=ye.index[X.line];if(se){se.errors.push(X),ye.hasErrors=!0;return}}T.unknown.hasErrors=!0,T.unknown.lines[0].errors.push(X)})}function St(T,O,X,ye,se){if(!T.getShaderParameter(O,T.COMPILE_STATUS)){var Ee=T.getShaderInfoLog(O),Te=ye===T.FRAGMENT_SHADER?"fragment":"vertex";nt(X,"string",Te+" shader source must be a string",se);var $e=xt(X,se),Qe=at(Ee);tt($e,Qe),Object.keys($e).forEach(function(it){var Le=$e[it];if(!Le.hasErrors)return;var qe=[""],Et=[""];function Ke(mt,fe){qe.push(mt),Et.push(fe||"")}Ke("file number "+it+": "+Le.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Le.lines.forEach(function(mt){if(mt.errors.length>0){Ke(Yt(mt.number,4)+"|  ","background-color:yellow; font-weight:bold"),Ke(mt.line+N,"color:red; background-color:yellow; font-weight:bold");var fe=0;mt.errors.forEach(function(Ie){var ot=Ie.message,Ct=/^\s*'(.*)'\s*:\s*(.*)$/.exec(ot);if(Ct){var Ve=Ct[1];switch(ot=Ct[2],Ve){case"assign":Ve="=";break}fe=Math.max(mt.line.indexOf(Ve,fe),0)}else fe=0;Ke(Yt("| ",6)),Ke(Yt("^^^",fe+3)+N,"font-weight:bold"),Ke(Yt("| ",6)),Ke(ot+N,"font-weight:bold")}),Ke(Yt("| ",6)+N)}else Ke(Yt(mt.number,4)+"|  "),Ke(mt.line+N,"color:red")}),typeof document!="undefined"&&!window.chrome?(Et[0]=qe.join("%c"),console.log.apply(console,Et)):console.log(qe.join(""))}),V.raise("Error compiling "+Te+" shader, "+$e[0].name)}}function Mt(T,O,X,ye,se){if(!T.getProgramParameter(O,T.LINK_STATUS)){var Ee=T.getProgramInfoLog(O),Te=xt(X,se),$e=xt(ye,se),Qe='Error linking program with vertex shader, "'+$e[0].name+'", and fragment shader "'+Te[0].name+'"';typeof document!="undefined"?console.log("%c"+Qe+N+"%c"+Ee,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Qe+N+Ee),V.raise(Qe)}}function zt(T){T._commandRef=Ne()}function pt(T,O,X,ye){zt(T);function se(Qe){return Qe?ye.id(Qe):0}T._fragId=se(T.static.frag),T._vertId=se(T.static.vert);function Ee(Qe,it){Object.keys(it).forEach(function(Le){Qe[ye.id(Le)]=!0})}var Te=T._uniformSet={};Ee(Te,O.static),Ee(Te,O.dynamic);var $e=T._attributeSet={};Ee($e,X.static),Ee($e,X.dynamic),T._hasCount="count"in T.static||"count"in T.dynamic||"elements"in T.static||"elements"in T.dynamic}function en(T,O){var X=Ae();ee(T+" in command "+(O||Ne())+(X==="unknown"?"":" called from "+X))}function $n(T,O,X){T||en(O,X||Ne())}function L(T,O,X,ye){T in O||en("unknown parameter ("+T+")"+j(X)+". possible values: "+Object.keys(O).join(),ye||Ne())}function nt(T,O,X,ye){De(T,O)||en("invalid parameter type"+j(X)+". expected "+O+", got "+typeof T,ye||Ne())}function $t(T){T()}function ln(T,O,X){T.texture?rt(T.texture._texture.internalformat,O,"unsupported texture format for attachment"):rt(T.renderbuffer._renderbuffer.format,X,"unsupported renderbuffer format for attachment")}var jt=33071,mn=9728,br=9984,fi=9985,Nr=9986,pr=9987,ti=5120,mr=5121,zr=5122,Ha=5123,Jn=5124,Bi=5125,Xa=5126,Su=32819,vo=32820,Hi=33635,ds=34042,gi=36193,li={};li[ti]=li[mr]=1,li[zr]=li[Ha]=li[gi]=li[Hi]=li[Su]=li[vo]=2,li[Jn]=li[Bi]=li[Xa]=li[ds]=4;function Tu(T,O){return T===vo||T===Su||T===Hi?2:T===ds?4:li[T]*O}function Xi(T){return!(T&T-1)&&!!T}function Zs(T,O,X){var ye,se=O.width,Ee=O.height,Te=O.channels;V(se>0&&se<=X.maxTextureSize&&Ee>0&&Ee<=X.maxTextureSize,"invalid texture shape"),(T.wrapS!==jt||T.wrapT!==jt)&&V(Xi(se)&&Xi(Ee),"incompatible wrap mode for texture, both width and height must be power of 2"),O.mipmask===1?se!==1&&Ee!==1&&V(T.minFilter!==br&&T.minFilter!==Nr&&T.minFilter!==fi&&T.minFilter!==pr,"min filter requires mipmap"):(V(Xi(se)&&Xi(Ee),"texture must be a square power of 2 to support mipmapping"),V(O.mipmask===(se<<1)-1,"missing or incomplete mipmap data")),O.type===Xa&&(X.extensions.indexOf("oes_texture_float_linear")<0&&V(T.minFilter===mn&&T.magFilter===mn,"filter not supported, must enable oes_texture_float_linear"),V(!T.genMipmaps,"mipmap generation not supported with float textures"));var $e=O.images;for(ye=0;ye<16;++ye)if($e[ye]){var Qe=se>>ye,it=Ee>>ye;V(O.mipmask&1<<ye,"missing mipmap data");var Le=$e[ye];if(V(Le.width===Qe&&Le.height===it,"invalid shape for mip images"),V(Le.format===O.format&&Le.internalformat===O.internalformat&&Le.type===O.type,"incompatible type for mip image"),!Le.compressed)if(Le.data){var qe=Math.ceil(Tu(Le.type,Te)*Qe/Le.unpackAlignment)*Le.unpackAlignment;V(Le.data.byteLength===qe*it,"invalid data for image, buffer size is inconsistent with image format")}else Le.element||Le.copy}else T.genMipmaps||V((O.mipmask&1<<ye)==0,"extra mipmap data");O.compressed&&V(!T.genMipmaps,"mipmap generation for compressed images not supported")}function hs(T,O,X,ye){var se=T.width,Ee=T.height,Te=T.channels;V(se>0&&se<=ye.maxTextureSize&&Ee>0&&Ee<=ye.maxTextureSize,"invalid texture shape"),V(se===Ee,"cube map must be square"),V(O.wrapS===jt&&O.wrapT===jt,"wrap mode not supported by cube map");for(var $e=0;$e<X.length;++$e){var Qe=X[$e];V(Qe.width===se&&Qe.height===Ee,"inconsistent cube map face shape"),O.genMipmaps&&(V(!Qe.compressed,"can not generate mipmap for compressed textures"),V(Qe.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var it=Qe.images,Le=0;Le<16;++Le){var qe=it[Le];if(qe){var Et=se>>Le,Ke=Ee>>Le;V(Qe.mipmask&1<<Le,"missing mipmap data"),V(qe.width===Et&&qe.height===Ke,"invalid shape for mip images"),V(qe.format===T.format&&qe.internalformat===T.internalformat&&qe.type===T.type,"incompatible type for mip image"),qe.compressed||(qe.data?V(qe.data.byteLength===Et*Ke*Math.max(Tu(qe.type,Te),qe.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):qe.element||qe.copy)}}}}var k=S(V,{optional:$t,raise:ee,commandRaise:en,command:$n,parameter:H,commandParameter:L,constructor:Gt,type:he,commandType:nt,isTypedArray:Z,nni:me,oneOf:rt,shaderError:St,linkError:Mt,callSite:Ae,saveCommandRef:zt,saveDrawInfo:pt,framebufferFormat:ln,guessCommand:Ne,texture2D:Zs,textureCube:hs}),$i=0,Wr=0,vs=5,Uo=6;function zi(T,O){this.id=$i++,this.type=T,this.data=O}function $a(T){return T.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function xe(T){if(T.length===0)return[];var O=T.charAt(0),X=T.charAt(T.length-1);if(T.length>1&&O===X&&(O==='"'||O==="'"))return['"'+$a(T.substr(1,T.length-2))+'"'];var ye=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(T);if(ye)return xe(T.substr(0,ye.index)).concat(xe(ye[1])).concat(xe(T.substr(ye.index+ye[0].length)));var se=T.split(".");if(se.length===1)return['"'+$a(T)+'"'];for(var Ee=[],Te=0;Te<se.length;++Te)Ee=Ee.concat(xe(se[Te]));return Ee}function Xe(T){return"["+xe(T).join("][")+"]"}function bt(T,O){return new zi(T,Xe(O+""))}function Ft(T){return typeof T=="function"&&!T._reglType||T instanceof zi}function Wt(T,O){if(typeof T=="function")return new zi(Wr,T);if(typeof T=="number"||typeof T=="boolean")return new zi(vs,T);if(Array.isArray(T))return new zi(Uo,T.map((X,ye)=>Wt(X,O+"["+ye+"]")));if(T instanceof zi)return T;k(!1,"invalid option type in uniform "+O)}var Rn={DynamicVariable:zi,define:bt,isDynamic:Ft,unbox:Wt,accessor:Xe},Pn={next:typeof requestAnimationFrame=="function"?function(T){return requestAnimationFrame(T)}:function(T){return setTimeout(T,16)},cancel:typeof cancelAnimationFrame=="function"?function(T){return cancelAnimationFrame(T)}:clearTimeout},Un=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function an(){var T={"":0},O=[""];return{id:function(X){var ye=T[X];return ye||(ye=T[X]=O.length,O.push(X),ye)},str:function(X){return O[X]}}}function ir(T,O,X){var ye=document.createElement("canvas");S(ye.style,{border:0,margin:0,padding:0,top:0,left:0}),T.appendChild(ye),T===document.body&&(ye.style.position="absolute",S(T.style,{margin:0,padding:0}));function se(){var $e=window.innerWidth,Qe=window.innerHeight;if(T!==document.body){var it=T.getBoundingClientRect();$e=it.right-it.left,Qe=it.bottom-it.top}ye.width=X*$e,ye.height=X*Qe,S(ye.style,{width:$e+"px",height:Qe+"px"})}var Ee;T!==document.body&&typeof ResizeObserver=="function"?(Ee=new ResizeObserver(function(){setTimeout(se)}),Ee.observe(T)):window.addEventListener("resize",se,!1);function Te(){Ee?Ee.disconnect():window.removeEventListener("resize",se),T.removeChild(ye)}return se(),{canvas:ye,onDestroy:Te}}function nr(T,O){function X(ye){try{return T.getContext(ye,O)}catch(se){return null}}return X("webgl")||X("experimental-webgl")||X("webgl-experimental")}function wa(T){return typeof T.nodeName=="string"&&typeof T.appendChild=="function"&&typeof T.getBoundingClientRect=="function"}function Au(T){return typeof T.drawArrays=="function"||typeof T.drawElements=="function"}function Bo(T){return typeof T=="string"?T.split():(k(Array.isArray(T),"invalid extension array"),T)}function zo(T){return typeof T=="string"?(k(typeof document!="undefined","not supported outside of DOM"),document.querySelector(T)):T}function ps(T){var O=T||{},X,ye,se,Ee,Te={},$e=[],Qe=[],it=typeof window=="undefined"?1:window.devicePixelRatio,Le=!1,qe=function(mt){mt&&k.raise(mt)},Et=function(){};if(typeof O=="string"?(k(typeof document!="undefined","selector queries only supported in DOM enviroments"),X=document.querySelector(O),k(X,"invalid query string for element")):typeof O=="object"?wa(O)?X=O:Au(O)?(Ee=O,se=Ee.canvas):(k.constructor(O),"gl"in O?Ee=O.gl:"canvas"in O?se=zo(O.canvas):"container"in O&&(ye=zo(O.container)),"attributes"in O&&(Te=O.attributes,k.type(Te,"object","invalid context attributes")),"extensions"in O&&($e=Bo(O.extensions)),"optionalExtensions"in O&&(Qe=Bo(O.optionalExtensions)),"onDone"in O&&(k.type(O.onDone,"function","invalid or missing onDone callback"),qe=O.onDone),"profile"in O&&(Le=!!O.profile),"pixelRatio"in O&&(it=+O.pixelRatio,k(it>0,"invalid pixel ratio"))):k.raise("invalid arguments to regl"),X&&(X.nodeName.toLowerCase()==="canvas"?se=X:ye=X),!Ee){if(!se){k(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var Ke=ir(ye||document.body,qe,it);if(!Ke)return null;se=Ke.canvas,Et=Ke.onDestroy}Te.premultipliedAlpha===void 0&&(Te.premultipliedAlpha=!0),Ee=nr(se,Te)}return Ee?{gl:Ee,canvas:se,container:ye,extensions:$e,optionalExtensions:Qe,pixelRatio:it,profile:Le,onDone:qe,onDestroy:Et}:(Et(),qe("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function uf(T,O){var X={};function ye(Te){k.type(Te,"string","extension name must be string");var $e=Te.toLowerCase(),Qe;try{Qe=X[$e]=T.getExtension($e)}catch(it){}return!!Qe}for(var se=0;se<O.extensions.length;++se){var Ee=O.extensions[se];if(!ye(Ee))return O.onDestroy(),O.onDone('"'+Ee+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return O.optionalExtensions.forEach(ye),{extensions:X,restore:function(){Object.keys(X).forEach(function(Te){if(X[Te]&&!ye(Te))throw new Error("(regl): error restoring extension "+Te)})}}}function di(T,O){for(var X=Array(T),ye=0;ye<T;++ye)X[ye]=O(ye);return X}var js=5120,Iu=5121,po=5122,Cu=5123,Ya=5124,cf=5125,Ru=5126;function ff(T){for(var O=16;O<=1<<28;O*=16)if(T<=O)return O;return 0}function ms(T){var O,X;return O=(T>65535)<<4,T>>>=O,X=(T>255)<<3,T>>>=X,O|=X,X=(T>15)<<2,T>>>=X,O|=X,X=(T>3)<<1,T>>>=X,O|=X,O|T>>1}function pc(){var T=di(8,function(){return[]});function O(Ee){var Te=ff(Ee),$e=T[ms(Te)>>2];return $e.length>0?$e.pop():new ArrayBuffer(Te)}function X(Ee){T[ms(Ee.byteLength)>>2].push(Ee)}function ye(Ee,Te){var $e=null;switch(Ee){case js:$e=new Int8Array(O(Te),0,Te);break;case Iu:$e=new Uint8Array(O(Te),0,Te);break;case po:$e=new Int16Array(O(2*Te),0,Te);break;case Cu:$e=new Uint16Array(O(2*Te),0,Te);break;case Ya:$e=new Int32Array(O(4*Te),0,Te);break;case cf:$e=new Uint32Array(O(4*Te),0,Te);break;case Ru:$e=new Float32Array(O(4*Te),0,Te);break;default:return null}return $e.length!==Te?$e.subarray(0,Te):$e}function se(Ee){X(Ee.buffer)}return{alloc:O,free:X,allocType:ye,freeType:se}}var Xr=pc();Xr.zero=pc();var Mu=3408,ll=3410,ft=3411,Ue=3412,Dt=3413,je=3414,kt=3415,Lt=33901,on=33902,qt=3379,Nt=3386,dn=34921,yn=36347,rr=36348,cr=35661,Or=35660,Lr=34930,Li=36349,Yi=34076,ni=34024,Ci=7936,Gi=7937,Ki=7938,Hn=35724,yi=34047,Ri=36063,La=34852,oa=3553,sa=34067,mo=34069,gs=33984,hi=6408,va=5126,Wo=5121,Ga=36160,ys=36053,pa=36064,ka=16384,Vo=function(T,O){var X=1;O.ext_texture_filter_anisotropic&&(X=T.getParameter(yi));var ye=1,se=1;O.webgl_draw_buffers&&(ye=T.getParameter(La),se=T.getParameter(Ri));var Ee=!!O.oes_texture_float;if(Ee){var Te=T.createTexture();T.bindTexture(oa,Te),T.texImage2D(oa,0,hi,1,1,0,hi,va,null);var $e=T.createFramebuffer();if(T.bindFramebuffer(Ga,$e),T.framebufferTexture2D(Ga,pa,oa,Te,0),T.bindTexture(oa,null),T.checkFramebufferStatus(Ga)!==ys)Ee=!1;else{T.viewport(0,0,1,1),T.clearColor(1,0,0,1),T.clear(ka);var Qe=Xr.allocType(va,4);T.readPixels(0,0,1,1,hi,va,Qe),T.getError()?Ee=!1:(T.deleteFramebuffer($e),T.deleteTexture(Te),Ee=Qe[0]===1),Xr.freeType(Qe)}}var it=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),Le=!0;if(!it){var qe=T.createTexture(),Et=Xr.allocType(Wo,36);T.activeTexture(gs),T.bindTexture(sa,qe),T.texImage2D(mo,0,hi,3,3,0,hi,Wo,Et),Xr.freeType(Et),T.bindTexture(sa,null),T.deleteTexture(qe),Le=!T.getError()}return{colorBits:[T.getParameter(ll),T.getParameter(ft),T.getParameter(Ue),T.getParameter(Dt)],depthBits:T.getParameter(je),stencilBits:T.getParameter(kt),subpixelBits:T.getParameter(Mu),extensions:Object.keys(O).filter(function(Ke){return!!O[Ke]}),maxAnisotropic:X,maxDrawbuffers:ye,maxColorAttachments:se,pointSizeDims:T.getParameter(Lt),lineWidthDims:T.getParameter(on),maxViewportDims:T.getParameter(Nt),maxCombinedTextureUnits:T.getParameter(cr),maxCubeMapSize:T.getParameter(Yi),maxRenderbufferSize:T.getParameter(ni),maxTextureUnits:T.getParameter(Lr),maxTextureSize:T.getParameter(qt),maxAttributes:T.getParameter(dn),maxVertexUniforms:T.getParameter(yn),maxVertexTextureUnits:T.getParameter(Or),maxVaryingVectors:T.getParameter(rr),maxFragmentUniforms:T.getParameter(Li),glsl:T.getParameter(Hn),renderer:T.getParameter(Gi),vendor:T.getParameter(Ci),version:T.getParameter(Ki),readFloat:Ee,npotTextureCube:Le}};function _i(T){return!!T&&typeof T=="object"&&Array.isArray(T.shape)&&Array.isArray(T.stride)&&typeof T.offset=="number"&&T.shape.length===T.stride.length&&(Array.isArray(T.data)||I(T.data))}var Fr=function(T){return Object.keys(T).map(function(O){return T[O]})},Wi={shape:jo,flatten:Ei};function xa(T,O,X){for(var ye=0;ye<O;++ye)X[ye]=T[ye]}function ua(T,O,X,ye){for(var se=0,Ee=0;Ee<O;++Ee)for(var Te=T[Ee],$e=0;$e<X;++$e)ye[se++]=Te[$e]}function Zo(T,O,X,ye,se,Ee){for(var Te=Ee,$e=0;$e<O;++$e)for(var Qe=T[$e],it=0;it<X;++it)for(var Le=Qe[it],qe=0;qe<ye;++qe)se[Te++]=Le[qe]}function go(T,O,X,ye,se){for(var Ee=1,Te=X+1;Te<O.length;++Te)Ee*=O[Te];var $e=O[X];if(O.length-X==4){var Qe=O[X+1],it=O[X+2],Le=O[X+3];for(Te=0;Te<$e;++Te)Zo(T[Te],Qe,it,Le,ye,se),se+=Ee}else for(Te=0;Te<$e;++Te)go(T[Te],O,X+1,ye,se),se+=Ee}function Ei(T,O,X,ye){var se=1;if(O.length)for(var Ee=0;Ee<O.length;++Ee)se*=O[Ee];else se=0;var Te=ye||Xr.allocType(X,se);switch(O.length){case 0:break;case 1:xa(T,O[0],Te);break;case 2:ua(T,O[0],O[1],Te);break;case 3:Zo(T,O[0],O[1],O[2],Te,0);break;default:go(T,O,0,Te,0)}return Te}function jo(T){for(var O=[],X=T;X.length;X=X[0])O.push(X.length);return O}var na={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},yo=5120,_s=5122,Ho=5124,Sa=5121,yr=5123,fr=5125,vi=5126,qi=5126,bi={int8:yo,int16:_s,int32:Ho,uint8:Sa,uint16:yr,uint32:fr,float:vi,float32:qi},_o=35048,Xo=35040,Fa={dynamic:_o,stream:Xo,static:35044},Eo=Wi.flatten,Es=Wi.shape,Hs=35044,Mn=35040,Bn=5121,$o=5126,Mi=[];Mi[5120]=1,Mi[5122]=2,Mi[5124]=4,Mi[5121]=1,Mi[5123]=2,Mi[5125]=4,Mi[5126]=4;function mc(T){return na[Object.prototype.toString.call(T)]|0}function gc(T,O){for(var X=0;X<O.length;++X)T[X]=O[X]}function lf(T,O,X,ye,se,Ee,Te){for(var $e=0,Qe=0;Qe<X;++Qe)for(var it=0;it<ye;++it)T[$e++]=O[se*Qe+Ee*it+Te]}function df(T,O,X,ye){var se=0,Ee={};function Te(fe){this.id=se++,this.buffer=T.createBuffer(),this.type=fe,this.usage=Hs,this.byteLength=0,this.dimension=1,this.dtype=Bn,this.persistentData=null,X.profile&&(this.stats={size:0})}Te.prototype.bind=function(){T.bindBuffer(this.type,this.buffer)},Te.prototype.destroy=function(){Et(this)};var $e=[];function Qe(fe,Ie){var ot=$e.pop();return ot||(ot=new Te(fe)),ot.bind(),qe(ot,Ie,Mn,0,1,!1),ot}function it(fe){$e.push(fe)}function Le(fe,Ie,ot){fe.byteLength=Ie.byteLength,T.bufferData(fe.type,Ie,ot)}function qe(fe,Ie,ot,Ct,Ve,Tt){var Fe;if(fe.usage=ot,Array.isArray(Ie)){if(fe.dtype=Ct||$o,Ie.length>0){var gt;if(Array.isArray(Ie[0])){Fe=Es(Ie);for(var He=1,ut=1;ut<Fe.length;++ut)He*=Fe[ut];fe.dimension=He,gt=Eo(Ie,Fe,fe.dtype),Le(fe,gt,ot),Tt?fe.persistentData=gt:Xr.freeType(gt)}else if(typeof Ie[0]=="number"){fe.dimension=Ve;var Ht=Xr.allocType(fe.dtype,Ie.length);gc(Ht,Ie),Le(fe,Ht,ot),Tt?fe.persistentData=Ht:Xr.freeType(Ht)}else I(Ie[0])?(fe.dimension=Ie[0].length,fe.dtype=Ct||mc(Ie[0])||$o,gt=Eo(Ie,[Ie.length,Ie[0].length],fe.dtype),Le(fe,gt,ot),Tt?fe.persistentData=gt:Xr.freeType(gt)):k.raise("invalid buffer data")}}else if(I(Ie))fe.dtype=Ct||mc(Ie),fe.dimension=Ve,Le(fe,Ie,ot),Tt&&(fe.persistentData=new Uint8Array(new Uint8Array(Ie.buffer)));else if(_i(Ie)){Fe=Ie.shape;var hn=Ie.stride,yt=Ie.offset,lt=0,Ze=0,Qt=0,Tn=0;Fe.length===1?(lt=Fe[0],Ze=1,Qt=hn[0],Tn=0):Fe.length===2?(lt=Fe[0],Ze=Fe[1],Qt=hn[0],Tn=hn[1]):k.raise("invalid shape"),fe.dtype=Ct||mc(Ie.data)||$o,fe.dimension=Ze;var Ut=Xr.allocType(fe.dtype,lt*Ze);lf(Ut,Ie.data,lt,Ze,Qt,Tn,yt),Le(fe,Ut,ot),Tt?fe.persistentData=Ut:Xr.freeType(Ut)}else Ie instanceof ArrayBuffer?(fe.dtype=Bn,fe.dimension=Ve,Le(fe,Ie,ot),Tt&&(fe.persistentData=new Uint8Array(new Uint8Array(Ie)))):k.raise("invalid buffer data")}function Et(fe){O.bufferCount--,ye(fe);var Ie=fe.buffer;k(Ie,"buffer must not be deleted already"),T.deleteBuffer(Ie),fe.buffer=null,delete Ee[fe.id]}function Ke(fe,Ie,ot,Ct){O.bufferCount++;var Ve=new Te(Ie);Ee[Ve.id]=Ve;function Tt(He){var ut=Hs,Ht=null,hn=0,yt=0,lt=1;return Array.isArray(He)||I(He)||_i(He)||He instanceof ArrayBuffer?Ht=He:typeof He=="number"?hn=He|0:He&&(k.type(He,"object","buffer arguments must be an object, a number or an array"),"data"in He&&(k(Ht===null||Array.isArray(Ht)||I(Ht)||_i(Ht),"invalid data for buffer"),Ht=He.data),"usage"in He&&(k.parameter(He.usage,Fa,"invalid buffer usage"),ut=Fa[He.usage]),"type"in He&&(k.parameter(He.type,bi,"invalid buffer type"),yt=bi[He.type]),"dimension"in He&&(k.type(He.dimension,"number","invalid dimension"),lt=He.dimension|0),"length"in He&&(k.nni(hn,"buffer length must be a nonnegative integer"),hn=He.length|0)),Ve.bind(),Ht?qe(Ve,Ht,ut,yt,lt,Ct):(hn&&T.bufferData(Ve.type,hn,ut),Ve.dtype=yt||Bn,Ve.usage=ut,Ve.dimension=lt,Ve.byteLength=hn),X.profile&&(Ve.stats.size=Ve.byteLength*Mi[Ve.dtype]),Tt}function Fe(He,ut){k(ut+He.byteLength<=Ve.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+He.byteLength+" starting from offset "+ut+" to a buffer of size "+Ve.byteLength),T.bufferSubData(Ve.type,ut,He)}function gt(He,ut){var Ht=(ut||0)|0,hn;if(Ve.bind(),I(He)||He instanceof ArrayBuffer)Fe(He,Ht);else if(Array.isArray(He)){if(He.length>0)if(typeof He[0]=="number"){var yt=Xr.allocType(Ve.dtype,He.length);gc(yt,He),Fe(yt,Ht),Xr.freeType(yt)}else if(Array.isArray(He[0])||I(He[0])){hn=Es(He);var lt=Eo(He,hn,Ve.dtype);Fe(lt,Ht),Xr.freeType(lt)}else k.raise("invalid buffer data")}else if(_i(He)){hn=He.shape;var Ze=He.stride,Qt=0,Tn=0,Ut=0,Fn=0;hn.length===1?(Qt=hn[0],Tn=1,Ut=Ze[0],Fn=0):hn.length===2?(Qt=hn[0],Tn=hn[1],Ut=Ze[0],Fn=Ze[1]):k.raise("invalid shape");var fn=Array.isArray(He.data)?Ve.dtype:mc(He.data),An=Xr.allocType(fn,Qt*Tn);lf(An,He.data,Qt,Tn,Ut,Fn,He.offset),Fe(An,Ht),Xr.freeType(An)}else k.raise("invalid data for buffer subdata");return Tt}return ot||Tt(fe),Tt._reglType="buffer",Tt._buffer=Ve,Tt.subdata=gt,X.profile&&(Tt.stats=Ve.stats),Tt.destroy=function(){Et(Ve)},Tt}function mt(){Fr(Ee).forEach(function(fe){fe.buffer=T.createBuffer(),T.bindBuffer(fe.type,fe.buffer),T.bufferData(fe.type,fe.persistentData||fe.byteLength,fe.usage)})}return X.profile&&(O.getTotalBufferSize=function(){var fe=0;return Object.keys(Ee).forEach(function(Ie){fe+=Ee[Ie].stats.size}),fe}),{create:Ke,createStream:Qe,destroyStream:it,clear:function(){Fr(Ee).forEach(Et),$e.forEach(Et)},getBuffer:function(fe){return fe&&fe._buffer instanceof Te?fe._buffer:null},restore:mt,_initBuffer:qe}}var Vi=0,Yn=0,Zn=1,$r=1,zn=4,Rr=4,ri={points:Vi,point:Yn,lines:Zn,line:$r,triangles:zn,triangle:Rr,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Mr=0,Ua=1,Ar=4,yc=5120,bs=5121,dl=5122,Xs=5123,ma=5124,$s=5125,ga=34963,ad=35040,od=35044;function ws(T,O,X,ye){var se={},Ee=0,Te={uint8:bs,uint16:Xs};O.oes_element_index_uint&&(Te.uint32=$s);function $e(mt){this.id=Ee++,se[this.id]=this,this.buffer=mt,this.primType=Ar,this.vertCount=0,this.type=0}$e.prototype.bind=function(){this.buffer.bind()};var Qe=[];function it(mt){var fe=Qe.pop();return fe||(fe=new $e(X.create(null,ga,!0,!1)._buffer)),qe(fe,mt,ad,-1,-1,0,0),fe}function Le(mt){Qe.push(mt)}function qe(mt,fe,Ie,ot,Ct,Ve,Tt){mt.buffer.bind();var Fe;if(fe){var gt=Tt;!Tt&&(!I(fe)||_i(fe)&&!I(fe.data))&&(gt=O.oes_element_index_uint?$s:Xs),X._initBuffer(mt.buffer,fe,Ie,gt,3)}else T.bufferData(ga,Ve,Ie),mt.buffer.dtype=Fe||bs,mt.buffer.usage=Ie,mt.buffer.dimension=3,mt.buffer.byteLength=Ve;if(Fe=Tt,!Tt){switch(mt.buffer.dtype){case bs:case yc:Fe=bs;break;case Xs:case dl:Fe=Xs;break;case $s:case ma:Fe=$s;break;default:k.raise("unsupported type for element array")}mt.buffer.dtype=Fe}mt.type=Fe,k(Fe!==$s||!!O.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var He=Ct;He<0&&(He=mt.buffer.byteLength,Fe===Xs?He>>=1:Fe===$s&&(He>>=2)),mt.vertCount=He;var ut=ot;if(ot<0){ut=Ar;var Ht=mt.buffer.dimension;Ht===1&&(ut=Mr),Ht===2&&(ut=Ua),Ht===3&&(ut=Ar)}mt.primType=ut}function Et(mt){ye.elementsCount--,k(mt.buffer!==null,"must not double destroy elements"),delete se[mt.id],mt.buffer.destroy(),mt.buffer=null}function Ke(mt,fe){var Ie=X.create(null,ga,!0),ot=new $e(Ie._buffer);ye.elementsCount++;function Ct(Ve){if(!Ve)Ie(),ot.primType=Ar,ot.vertCount=0,ot.type=bs;else if(typeof Ve=="number")Ie(Ve),ot.primType=Ar,ot.vertCount=Ve|0,ot.type=bs;else{var Tt=null,Fe=od,gt=-1,He=-1,ut=0,Ht=0;Array.isArray(Ve)||I(Ve)||_i(Ve)?Tt=Ve:(k.type(Ve,"object","invalid arguments for elements"),"data"in Ve&&(Tt=Ve.data,k(Array.isArray(Tt)||I(Tt)||_i(Tt),"invalid data for element buffer")),"usage"in Ve&&(k.parameter(Ve.usage,Fa,"invalid element buffer usage"),Fe=Fa[Ve.usage]),"primitive"in Ve&&(k.parameter(Ve.primitive,ri,"invalid element buffer primitive"),gt=ri[Ve.primitive]),"count"in Ve&&(k(typeof Ve.count=="number"&&Ve.count>=0,"invalid vertex count for elements"),He=Ve.count|0),"type"in Ve&&(k.parameter(Ve.type,Te,"invalid buffer type"),Ht=Te[Ve.type]),"length"in Ve?ut=Ve.length|0:(ut=He,Ht===Xs||Ht===dl?ut*=2:(Ht===$s||Ht===ma)&&(ut*=4))),qe(ot,Tt,Fe,gt,He,ut,Ht)}return Ct}return Ct(mt),Ct._reglType="elements",Ct._elements=ot,Ct.subdata=function(Ve,Tt){return Ie.subdata(Ve,Tt),Ct},Ct.destroy=function(){Et(ot)},Ct}return{create:Ke,createStream:it,destroyStream:Le,getElements:function(mt){return typeof mt=="function"&&mt._elements instanceof $e?mt._elements:null},clear:function(){Fr(se).forEach(Et)}}}var _c=new Float32Array(1),hf=new Uint32Array(_c.buffer),Yr=5123;function Yo(T){for(var O=Xr.allocType(Yr,T.length),X=0;X<T.length;++X)if(isNaN(T[X]))O[X]=65535;else if(T[X]===Infinity)O[X]=31744;else if(T[X]===-Infinity)O[X]=64512;else{_c[0]=T[X];var ye=hf[0],se=ye>>>31<<15,Ee=(ye<<1>>>24)-127,Te=ye>>13&(1<<10)-1;if(Ee<-24)O[X]=se;else if(Ee<-14){var $e=-14-Ee;O[X]=se+(Te+(1<<10)>>$e)}else Ee>15?O[X]=se+31744:O[X]=se+(Ee+15<<10)+Te}return O}function Gr(T){return Array.isArray(T)||I(T)}var hl=function(T){return!(T&T-1)&&!!T},vl=34467,bo=3553,pl=34067,vf=34069,xs=6408,Nu=6406,Ka=6407,Ss=6409,Du=6410,ml=32854,Ko=32855,Ts=36194,pf=32819,Fh=32820,mf=33635,gl=34042,yl=6402,Ec=34041,ca=35904,bc=35906,wo=36193,gf=33776,yf=33777,_l=33778,El=33779,sd=35986,ud=35987,cd=34798,As=35840,fd=35841,ld=35842,bl=35843,dd=36196,Ba=5121,wc=5123,hd=5125,_f=5126,Uh=10242,Pu=10243,qa=10497,Ef=33071,Bh=33648,wl=10240,zh=10241,xc=9728,Wh=9729,Ou=9984,ge=9985,Ye=9986,Pe=9987,Vt=33170,kn=4352,dr=4353,Kr=4354,wr=34046,bf=3317,ip=37440,Ja=37441,Sc=37443,Lu=37444,xo=33984,wf=[Ou,Ye,ge,Pe],Is=[0,Ss,Du,Ka,xs],Kn={};Kn[Ss]=Kn[Nu]=Kn[yl]=1,Kn[Ec]=Kn[Du]=2,Kn[Ka]=Kn[ca]=3,Kn[xs]=Kn[bc]=4;function Gu(T){return"[object "+T+"]"}var xf=Gu("HTMLCanvasElement"),ku=Gu("OffscreenCanvas"),Sf=Gu("CanvasRenderingContext2D"),vd=Gu("ImageBitmap"),pd=Gu("HTMLImageElement"),Tf=Gu("HTMLVideoElement"),qo=Object.keys(na).concat([xf,ku,Sf,vd,pd,Tf]),Qa=[];Qa[Ba]=1,Qa[_f]=4,Qa[wo]=2,Qa[wc]=2,Qa[hd]=4;var Ni=[];Ni[ml]=2,Ni[Ko]=2,Ni[Ts]=2,Ni[Ec]=4,Ni[gf]=.5,Ni[yf]=.5,Ni[_l]=1,Ni[El]=1,Ni[sd]=.5,Ni[ud]=1,Ni[cd]=1,Ni[As]=.5,Ni[fd]=.25,Ni[ld]=.5,Ni[bl]=.25,Ni[dd]=.5;function Ta(T){return Array.isArray(T)&&(T.length===0||typeof T[0]=="number")}function md(T){if(!Array.isArray(T))return!1;var O=T.length;return!(O===0||!Gr(T[0]))}function Jo(T){return Object.prototype.toString.call(T)}function Tc(T){return Jo(T)===xf}function Af(T){return Jo(T)===ku}function Ac(T){return Jo(T)===Sf}function Cs(T){return Jo(T)===vd}function Ic(T){return Jo(T)===pd}function ap(T){return Jo(T)===Tf}function xl(T){if(!T)return!1;var O=Jo(T);return qo.indexOf(O)>=0?!0:Ta(T)||md(T)||_i(T)}function gd(T){return na[Object.prototype.toString.call(T)]|0}function If(T,O){var X=O.length;switch(T.type){case Ba:case wc:case hd:case _f:var ye=Xr.allocType(T.type,X);ye.set(O),T.data=ye;break;case wo:T.data=Yo(O);break;default:k.raise("unsupported texture type, must specify a typed array")}}function Fu(T,O){return Xr.allocType(T.type===wo?_f:T.type,O)}function Cf(T,O){T.type===wo?(T.data=Yo(O),Xr.freeType(O)):T.data=O}function Vh(T,O,X,ye,se,Ee){for(var Te=T.width,$e=T.height,Qe=T.channels,it=Te*$e*Qe,Le=Fu(T,it),qe=0,Et=0;Et<$e;++Et)for(var Ke=0;Ke<Te;++Ke)for(var mt=0;mt<Qe;++mt)Le[qe++]=O[X*Ke+ye*Et+se*mt+Ee];Cf(T,Le)}function Uu(T,O,X,ye,se,Ee){var Te;if(typeof Ni[T]!="undefined"?Te=Ni[T]:Te=Kn[T]*Qa[O],Ee&&(Te*=6),se){for(var $e=0,Qe=X;Qe>=1;)$e+=Te*Qe*Qe,Qe/=2;return $e}else return Te*X*ye}function yd(T,O,X,ye,se,Ee,Te){var $e={"don't care":kn,"dont care":kn,nice:Kr,fast:dr},Qe={repeat:qa,clamp:Ef,mirror:Bh},it={nearest:xc,linear:Wh},Le=S({mipmap:Pe,"nearest mipmap nearest":Ou,"linear mipmap nearest":ge,"nearest mipmap linear":Ye,"linear mipmap linear":Pe},it),qe={none:0,browser:Lu},Et={uint8:Ba,rgba4:pf,rgb565:mf,"rgb5 a1":Fh},Ke={alpha:Nu,luminance:Ss,"luminance alpha":Du,rgb:Ka,rgba:xs,rgba4:ml,"rgb5 a1":Ko,rgb565:Ts},mt={};O.ext_srgb&&(Ke.srgb=ca,Ke.srgba=bc),O.oes_texture_float&&(Et.float32=Et.float=_f),O.oes_texture_half_float&&(Et.float16=Et["half float"]=wo),O.webgl_depth_texture&&(S(Ke,{depth:yl,"depth stencil":Ec}),S(Et,{uint16:wc,uint32:hd,"depth stencil":gl})),O.webgl_compressed_texture_s3tc&&S(mt,{"rgb s3tc dxt1":gf,"rgba s3tc dxt1":yf,"rgba s3tc dxt3":_l,"rgba s3tc dxt5":El}),O.webgl_compressed_texture_atc&&S(mt,{"rgb atc":sd,"rgba atc explicit alpha":ud,"rgba atc interpolated alpha":cd}),O.webgl_compressed_texture_pvrtc&&S(mt,{"rgb pvrtc 4bppv1":As,"rgb pvrtc 2bppv1":fd,"rgba pvrtc 4bppv1":ld,"rgba pvrtc 2bppv1":bl}),O.webgl_compressed_texture_etc1&&(mt["rgb etc1"]=dd);var fe=Array.prototype.slice.call(T.getParameter(vl));Object.keys(mt).forEach(function(z){var Se=mt[z];fe.indexOf(Se)>=0&&(Ke[z]=Se)});var Ie=Object.keys(Ke);X.textureFormats=Ie;var ot=[];Object.keys(Ke).forEach(function(z){var Se=Ke[z];ot[Se]=z});var Ct=[];Object.keys(Et).forEach(function(z){var Se=Et[z];Ct[Se]=z});var Ve=[];Object.keys(it).forEach(function(z){var Se=it[z];Ve[Se]=z});var Tt=[];Object.keys(Le).forEach(function(z){var Se=Le[z];Tt[Se]=z});var Fe=[];Object.keys(Qe).forEach(function(z){var Se=Qe[z];Fe[Se]=z});var gt=Ie.reduce(function(z,Se){var _e=Ke[Se];return _e===Ss||_e===Nu||_e===Ss||_e===Du||_e===yl||_e===Ec||O.ext_srgb&&(_e===ca||_e===bc)?z[_e]=_e:_e===Ko||Se.indexOf("rgba")>=0?z[_e]=xs:z[_e]=Ka,z},{});function He(){this.internalformat=xs,this.format=xs,this.type=Ba,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Lu,this.width=0,this.height=0,this.channels=0}function ut(z,Se){z.internalformat=Se.internalformat,z.format=Se.format,z.type=Se.type,z.compressed=Se.compressed,z.premultiplyAlpha=Se.premultiplyAlpha,z.flipY=Se.flipY,z.unpackAlignment=Se.unpackAlignment,z.colorSpace=Se.colorSpace,z.width=Se.width,z.height=Se.height,z.channels=Se.channels}function Ht(z,Se){if(!(typeof Se!="object"||!Se)){if("premultiplyAlpha"in Se&&(k.type(Se.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),z.premultiplyAlpha=Se.premultiplyAlpha),"flipY"in Se&&(k.type(Se.flipY,"boolean","invalid texture flip"),z.flipY=Se.flipY),"alignment"in Se&&(k.oneOf(Se.alignment,[1,2,4,8],"invalid texture unpack alignment"),z.unpackAlignment=Se.alignment),"colorSpace"in Se&&(k.parameter(Se.colorSpace,qe,"invalid colorSpace"),z.colorSpace=qe[Se.colorSpace]),"type"in Se){var _e=Se.type;k(O.oes_texture_float||!(_e==="float"||_e==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),k(O.oes_texture_half_float||!(_e==="half float"||_e==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),k(O.webgl_depth_texture||!(_e==="uint16"||_e==="uint32"||_e==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),k.parameter(_e,Et,"invalid texture type"),z.type=Et[_e]}var Pt=z.width,Nn=z.height,U=z.channels,D=!1;"shape"in Se?(k(Array.isArray(Se.shape)&&Se.shape.length>=2,"shape must be an array"),Pt=Se.shape[0],Nn=Se.shape[1],Se.shape.length===3&&(U=Se.shape[2],k(U>0&&U<=4,"invalid number of channels"),D=!0),k(Pt>=0&&Pt<=X.maxTextureSize,"invalid width"),k(Nn>=0&&Nn<=X.maxTextureSize,"invalid height")):("radius"in Se&&(Pt=Nn=Se.radius,k(Pt>=0&&Pt<=X.maxTextureSize,"invalid radius")),"width"in Se&&(Pt=Se.width,k(Pt>=0&&Pt<=X.maxTextureSize,"invalid width")),"height"in Se&&(Nn=Se.height,k(Nn>=0&&Nn<=X.maxTextureSize,"invalid height")),"channels"in Se&&(U=Se.channels,k(U>0&&U<=4,"invalid number of channels"),D=!0)),z.width=Pt|0,z.height=Nn|0,z.channels=U|0;var Y=!1;if("format"in Se){var ce=Se.format;k(O.webgl_depth_texture||!(ce==="depth"||ce==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),k.parameter(ce,Ke,"invalid texture format");var le=z.internalformat=Ke[ce];z.format=gt[le],ce in Et&&("type"in Se||(z.type=Et[ce])),ce in mt&&(z.compressed=!0),Y=!0}!D&&Y?z.channels=Kn[z.format]:D&&!Y?z.channels!==Is[z.format]&&(z.format=z.internalformat=Is[z.channels]):Y&&D&&k(z.channels===Kn[z.format],"number of channels inconsistent with specified format")}}function hn(z){T.pixelStorei(ip,z.flipY),T.pixelStorei(Ja,z.premultiplyAlpha),T.pixelStorei(Sc,z.colorSpace),T.pixelStorei(bf,z.unpackAlignment)}function yt(){He.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function lt(z,Se){var _e=null;if(xl(Se)?_e=Se:Se&&(k.type(Se,"object","invalid pixel data type"),Ht(z,Se),"x"in Se&&(z.xOffset=Se.x|0),"y"in Se&&(z.yOffset=Se.y|0),xl(Se.data)&&(_e=Se.data)),k(!z.compressed||_e instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),Se.copy){k(!_e,"can not specify copy and data field for the same texture");var Pt=se.viewportWidth,Nn=se.viewportHeight;z.width=z.width||Pt-z.xOffset,z.height=z.height||Nn-z.yOffset,z.needsCopy=!0,k(z.xOffset>=0&&z.xOffset<Pt&&z.yOffset>=0&&z.yOffset<Nn&&z.width>0&&z.width<=Pt&&z.height>0&&z.height<=Nn,"copy texture read out of bounds")}else if(!_e)z.width=z.width||1,z.height=z.height||1,z.channels=z.channels||4;else if(I(_e))z.channels=z.channels||4,z.data=_e,!("type"in Se)&&z.type===Ba&&(z.type=gd(_e));else if(Ta(_e))z.channels=z.channels||4,If(z,_e),z.alignment=1,z.needsFree=!0;else if(_i(_e)){var U=_e.data;!Array.isArray(U)&&z.type===Ba&&(z.type=gd(U));var D=_e.shape,Y=_e.stride,ce,le,ne,K,oe,B;D.length===3?(ne=D[2],B=Y[2]):(k(D.length===2,"invalid ndarray pixel data, must be 2 or 3D"),ne=1,B=1),ce=D[0],le=D[1],K=Y[0],oe=Y[1],z.alignment=1,z.width=ce,z.height=le,z.channels=ne,z.format=z.internalformat=Is[ne],z.needsFree=!0,Vh(z,U,K,oe,B,_e.offset)}else if(Tc(_e)||Af(_e)||Ac(_e))Tc(_e)||Af(_e)?z.element=_e:z.element=_e.canvas,z.width=z.element.width,z.height=z.element.height,z.channels=4;else if(Cs(_e))z.element=_e,z.width=_e.width,z.height=_e.height,z.channels=4;else if(Ic(_e))z.element=_e,z.width=_e.naturalWidth,z.height=_e.naturalHeight,z.channels=4;else if(ap(_e))z.element=_e,z.width=_e.videoWidth,z.height=_e.videoHeight,z.channels=4;else if(md(_e)){var $=z.width||_e[0].length,G=z.height||_e.length,ae=z.channels;Gr(_e[0][0])?ae=ae||_e[0][0].length:ae=ae||1;for(var pe=Wi.shape(_e),Oe=1,Be=0;Be<pe.length;++Be)Oe*=pe[Be];var Me=Fu(z,Oe);Wi.flatten(_e,pe,"",Me),Cf(z,Me),z.alignment=1,z.width=$,z.height=G,z.channels=ae,z.format=z.internalformat=Is[ae],z.needsFree=!0}z.type===_f?k(X.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):z.type===wo&&k(X.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Ze(z,Se,_e){var Pt=z.element,Nn=z.data,U=z.internalformat,D=z.format,Y=z.type,ce=z.width,le=z.height;hn(z),Pt?T.texImage2D(Se,_e,D,D,Y,Pt):z.compressed?T.compressedTexImage2D(Se,_e,U,ce,le,0,Nn):z.needsCopy?(ye(),T.copyTexImage2D(Se,_e,D,z.xOffset,z.yOffset,ce,le,0)):T.texImage2D(Se,_e,D,ce,le,0,D,Y,Nn||null)}function Qt(z,Se,_e,Pt,Nn){var U=z.element,D=z.data,Y=z.internalformat,ce=z.format,le=z.type,ne=z.width,K=z.height;hn(z),U?T.texSubImage2D(Se,Nn,_e,Pt,ce,le,U):z.compressed?T.compressedTexSubImage2D(Se,Nn,_e,Pt,Y,ne,K,D):z.needsCopy?(ye(),T.copyTexSubImage2D(Se,Nn,_e,Pt,z.xOffset,z.yOffset,ne,K)):T.texSubImage2D(Se,Nn,_e,Pt,ne,K,ce,le,D)}var Tn=[];function Ut(){return Tn.pop()||new yt}function Fn(z){z.needsFree&&Xr.freeType(z.data),yt.call(z),Tn.push(z)}function fn(){He.call(this),this.genMipmaps=!1,this.mipmapHint=kn,this.mipmask=0,this.images=Array(16)}function An(z,Se,_e){var Pt=z.images[0]=Ut();z.mipmask=1,Pt.width=z.width=Se,Pt.height=z.height=_e,Pt.channels=z.channels=4}function ar(z,Se){var _e=null;if(xl(Se))_e=z.images[0]=Ut(),ut(_e,z),lt(_e,Se),z.mipmask=1;else if(Ht(z,Se),Array.isArray(Se.mipmap))for(var Pt=Se.mipmap,Nn=0;Nn<Pt.length;++Nn)_e=z.images[Nn]=Ut(),ut(_e,z),_e.width>>=Nn,_e.height>>=Nn,lt(_e,Pt[Nn]),z.mipmask|=1<<Nn;else _e=z.images[0]=Ut(),ut(_e,z),lt(_e,Se),z.mipmask=1;ut(z,z.images[0]),z.compressed&&(z.internalformat===gf||z.internalformat===yf||z.internalformat===_l||z.internalformat===El)&&k(z.width%4==0&&z.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Vr(z,Se){for(var _e=z.images,Pt=0;Pt<_e.length;++Pt){if(!_e[Pt])return;Ze(_e[Pt],Se,Pt)}}var ai=[];function On(){var z=ai.pop()||new fn;He.call(z),z.mipmask=0;for(var Se=0;Se<16;++Se)z.images[Se]=null;return z}function Zr(z){for(var Se=z.images,_e=0;_e<Se.length;++_e)Se[_e]&&Fn(Se[_e]),Se[_e]=null;ai.push(z)}function xr(){this.minFilter=xc,this.magFilter=xc,this.wrapS=Ef,this.wrapT=Ef,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=kn}function qr(z,Se){if("min"in Se){var _e=Se.min;k.parameter(_e,Le),z.minFilter=Le[_e],wf.indexOf(z.minFilter)>=0&&!("faces"in Se)&&(z.genMipmaps=!0)}if("mag"in Se){var Pt=Se.mag;k.parameter(Pt,it),z.magFilter=it[Pt]}var Nn=z.wrapS,U=z.wrapT;if("wrap"in Se){var D=Se.wrap;typeof D=="string"?(k.parameter(D,Qe),Nn=U=Qe[D]):Array.isArray(D)&&(k.parameter(D[0],Qe),k.parameter(D[1],Qe),Nn=Qe[D[0]],U=Qe[D[1]])}else{if("wrapS"in Se){var Y=Se.wrapS;k.parameter(Y,Qe),Nn=Qe[Y]}if("wrapT"in Se){var ce=Se.wrapT;k.parameter(ce,Qe),U=Qe[ce]}}if(z.wrapS=Nn,z.wrapT=U,"anisotropic"in Se){var le=Se.anisotropic;k(typeof le=="number"&&le>=1&&le<=X.maxAnisotropic,"aniso samples must be between 1 and "),z.anisotropic=Se.anisotropic}if("mipmap"in Se){var ne=!1;switch(typeof Se.mipmap){case"string":k.parameter(Se.mipmap,$e,"invalid mipmap hint"),z.mipmapHint=$e[Se.mipmap],z.genMipmaps=!0,ne=!0;break;case"boolean":ne=z.genMipmaps=Se.mipmap;break;case"object":k(Array.isArray(Se.mipmap),"invalid mipmap type"),z.genMipmaps=!1,ne=!0;break;default:k.raise("invalid mipmap type")}ne&&!("min"in Se)&&(z.minFilter=Ou)}}function Jr(z,Se){T.texParameteri(Se,zh,z.minFilter),T.texParameteri(Se,wl,z.magFilter),T.texParameteri(Se,Uh,z.wrapS),T.texParameteri(Se,Pu,z.wrapT),O.ext_texture_filter_anisotropic&&T.texParameteri(Se,wr,z.anisotropic),z.genMipmaps&&(T.hint(Vt,z.mipmapHint),T.generateMipmap(Se))}var oi=0,Ir={},Qr=X.maxTextureUnits,jr=Array(Qr).map(function(){return null});function _n(z){He.call(this),this.mipmask=0,this.internalformat=xs,this.id=oi++,this.refCount=1,this.target=z,this.texture=T.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new xr,Te.profile&&(this.stats={size:0})}function si(z){T.activeTexture(xo),T.bindTexture(z.target,z.texture)}function or(){var z=jr[0];z?T.bindTexture(z.target,z.texture):T.bindTexture(bo,null)}function tn(z){var Se=z.texture;k(Se,"must not double destroy texture");var _e=z.unit,Pt=z.target;_e>=0&&(T.activeTexture(xo+_e),T.bindTexture(Pt,null),jr[_e]=null),T.deleteTexture(Se),z.texture=null,z.params=null,z.pixels=null,z.refCount=0,delete Ir[z.id],Ee.textureCount--}S(_n.prototype,{bind:function(){var z=this;z.bindCount+=1;var Se=z.unit;if(Se<0){for(var _e=0;_e<Qr;++_e){var Pt=jr[_e];if(Pt){if(Pt.bindCount>0)continue;Pt.unit=-1}jr[_e]=z,Se=_e;break}Se>=Qr&&k.raise("insufficient number of texture units"),Te.profile&&Ee.maxTextureUnits<Se+1&&(Ee.maxTextureUnits=Se+1),z.unit=Se,T.activeTexture(xo+Se),T.bindTexture(z.target,z.texture)}return Se},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&tn(this)}});function Vn(z,Se){var _e=new _n(bo);Ir[_e.id]=_e,Ee.textureCount++;function Pt(D,Y){var ce=_e.texInfo;xr.call(ce);var le=On();return typeof D=="number"?typeof Y=="number"?An(le,D|0,Y|0):An(le,D|0,D|0):D?(k.type(D,"object","invalid arguments to regl.texture"),qr(ce,D),ar(le,D)):An(le,1,1),ce.genMipmaps&&(le.mipmask=(le.width<<1)-1),_e.mipmask=le.mipmask,ut(_e,le),k.texture2D(ce,le,X),_e.internalformat=le.internalformat,Pt.width=le.width,Pt.height=le.height,si(_e),Vr(le,bo),Jr(ce,bo),or(),Zr(le),Te.profile&&(_e.stats.size=Uu(_e.internalformat,_e.type,le.width,le.height,ce.genMipmaps,!1)),Pt.format=ot[_e.internalformat],Pt.type=Ct[_e.type],Pt.mag=Ve[ce.magFilter],Pt.min=Tt[ce.minFilter],Pt.wrapS=Fe[ce.wrapS],Pt.wrapT=Fe[ce.wrapT],Pt}function Nn(D,Y,ce,le){k(!!D,"must specify image data");var ne=Y|0,K=ce|0,oe=le|0,B=Ut();return ut(B,_e),B.width=0,B.height=0,lt(B,D),B.width=B.width||(_e.width>>oe)-ne,B.height=B.height||(_e.height>>oe)-K,k(_e.type===B.type&&_e.format===B.format&&_e.internalformat===B.internalformat,"incompatible format for texture.subimage"),k(ne>=0&&K>=0&&ne+B.width<=_e.width&&K+B.height<=_e.height,"texture.subimage write out of bounds"),k(_e.mipmask&1<<oe,"missing mipmap data"),k(B.data||B.element||B.needsCopy,"missing image data"),si(_e),Qt(B,bo,ne,K,oe),or(),Fn(B),Pt}function U(D,Y){var ce=D|0,le=Y|0||ce;if(ce===_e.width&&le===_e.height)return Pt;Pt.width=_e.width=ce,Pt.height=_e.height=le,si(_e);for(var ne=0;_e.mipmask>>ne;++ne){var K=ce>>ne,oe=le>>ne;if(!K||!oe)break;T.texImage2D(bo,ne,_e.format,K,oe,0,_e.format,_e.type,null)}return or(),Te.profile&&(_e.stats.size=Uu(_e.internalformat,_e.type,ce,le,!1,!1)),Pt}return Pt(z,Se),Pt.subimage=Nn,Pt.resize=U,Pt._reglType="texture2d",Pt._texture=_e,Te.profile&&(Pt.stats=_e.stats),Pt.destroy=function(){_e.decRef()},Pt}function er(z,Se,_e,Pt,Nn,U){var D=new _n(pl);Ir[D.id]=D,Ee.cubeCount++;var Y=new Array(6);function ce(K,oe,B,$,G,ae){var pe,Oe=D.texInfo;for(xr.call(Oe),pe=0;pe<6;++pe)Y[pe]=On();if(typeof K=="number"||!K){var Be=K|0||1;for(pe=0;pe<6;++pe)An(Y[pe],Be,Be)}else if(typeof K=="object")if(oe)ar(Y[0],K),ar(Y[1],oe),ar(Y[2],B),ar(Y[3],$),ar(Y[4],G),ar(Y[5],ae);else if(qr(Oe,K),Ht(D,K),"faces"in K){var Me=K.faces;for(k(Array.isArray(Me)&&Me.length===6,"cube faces must be a length 6 array"),pe=0;pe<6;++pe)k(typeof Me[pe]=="object"&&!!Me[pe],"invalid input for cube map face"),ut(Y[pe],D),ar(Y[pe],Me[pe])}else for(pe=0;pe<6;++pe)ar(Y[pe],K);else k.raise("invalid arguments to cube map");for(ut(D,Y[0]),X.npotTextureCube||k(hl(D.width)&&hl(D.height),"your browser does not support non power or two texture dimensions"),Oe.genMipmaps?D.mipmask=(Y[0].width<<1)-1:D.mipmask=Y[0].mipmask,k.textureCube(D,Oe,Y,X),D.internalformat=Y[0].internalformat,ce.width=Y[0].width,ce.height=Y[0].height,si(D),pe=0;pe<6;++pe)Vr(Y[pe],vf+pe);for(Jr(Oe,pl),or(),Te.profile&&(D.stats.size=Uu(D.internalformat,D.type,ce.width,ce.height,Oe.genMipmaps,!0)),ce.format=ot[D.internalformat],ce.type=Ct[D.type],ce.mag=Ve[Oe.magFilter],ce.min=Tt[Oe.minFilter],ce.wrapS=Fe[Oe.wrapS],ce.wrapT=Fe[Oe.wrapT],pe=0;pe<6;++pe)Zr(Y[pe]);return ce}function le(K,oe,B,$,G){k(!!oe,"must specify image data"),k(typeof K=="number"&&K===(K|0)&&K>=0&&K<6,"invalid face");var ae=B|0,pe=$|0,Oe=G|0,Be=Ut();return ut(Be,D),Be.width=0,Be.height=0,lt(Be,oe),Be.width=Be.width||(D.width>>Oe)-ae,Be.height=Be.height||(D.height>>Oe)-pe,k(D.type===Be.type&&D.format===Be.format&&D.internalformat===Be.internalformat,"incompatible format for texture.subimage"),k(ae>=0&&pe>=0&&ae+Be.width<=D.width&&pe+Be.height<=D.height,"texture.subimage write out of bounds"),k(D.mipmask&1<<Oe,"missing mipmap data"),k(Be.data||Be.element||Be.needsCopy,"missing image data"),si(D),Qt(Be,vf+K,ae,pe,Oe),or(),Fn(Be),ce}function ne(K){var oe=K|0;if(oe!==D.width){ce.width=D.width=oe,ce.height=D.height=oe,si(D);for(var B=0;B<6;++B)for(var $=0;D.mipmask>>$;++$)T.texImage2D(vf+B,$,D.format,oe>>$,oe>>$,0,D.format,D.type,null);return or(),Te.profile&&(D.stats.size=Uu(D.internalformat,D.type,ce.width,ce.height,!1,!0)),ce}}return ce(z,Se,_e,Pt,Nn,U),ce.subimage=le,ce.resize=ne,ce._reglType="textureCube",ce._texture=D,Te.profile&&(ce.stats=D.stats),ce.destroy=function(){D.decRef()},ce}function ui(){for(var z=0;z<Qr;++z)T.activeTexture(xo+z),T.bindTexture(bo,null),jr[z]=null;Fr(Ir).forEach(tn),Ee.cubeCount=0,Ee.textureCount=0}Te.profile&&(Ee.getTotalTextureSize=function(){var z=0;return Object.keys(Ir).forEach(function(Se){z+=Ir[Se].stats.size}),z});function No(){for(var z=0;z<Qr;++z){var Se=jr[z];Se&&(Se.bindCount=0,Se.unit=-1,jr[z]=null)}Fr(Ir).forEach(function(_e){_e.texture=T.createTexture(),T.bindTexture(_e.target,_e.texture);for(var Pt=0;Pt<32;++Pt)if((_e.mipmask&1<<Pt)!=0)if(_e.target===bo)T.texImage2D(bo,Pt,_e.internalformat,_e.width>>Pt,_e.height>>Pt,0,_e.internalformat,_e.type,null);else for(var Nn=0;Nn<6;++Nn)T.texImage2D(vf+Nn,Pt,_e.internalformat,_e.width>>Pt,_e.height>>Pt,0,_e.internalformat,_e.type,null);Jr(_e.texInfo,_e.target)})}function Ca(){for(var z=0;z<Qr;++z){var Se=jr[z];Se&&(Se.bindCount=0,Se.unit=-1,jr[z]=null),T.activeTexture(xo+z),T.bindTexture(bo,null),T.bindTexture(pl,null)}}return{create2D:Vn,createCube:er,clear:ui,getTexture:function(z){return null},restore:No,refresh:Ca}}var Rs=36161,pi=32854,Ji=32855,_d=36194,Ed=33189,Rf=36168,bd=34041,Mf=35907,Bu=34836,Cc=34842,Ys=34843,fa=[];fa[pi]=2,fa[Ji]=2,fa[_d]=2,fa[Ed]=2,fa[Rf]=1,fa[bd]=4,fa[Mf]=4,fa[Bu]=16,fa[Cc]=8,fa[Ys]=6;function zu(T,O,X){return fa[T]*O*X}var Nf=function(T,O,X,ye,se){var Ee={rgba4:pi,rgb565:_d,"rgb5 a1":Ji,depth:Ed,stencil:Rf,"depth stencil":bd};O.ext_srgb&&(Ee.srgba=Mf),O.ext_color_buffer_half_float&&(Ee.rgba16f=Cc,Ee.rgb16f=Ys),O.webgl_color_buffer_float&&(Ee.rgba32f=Bu);var Te=[];Object.keys(Ee).forEach(function(Ke){var mt=Ee[Ke];Te[mt]=Ke});var $e=0,Qe={};function it(Ke){this.id=$e++,this.refCount=1,this.renderbuffer=Ke,this.format=pi,this.width=0,this.height=0,se.profile&&(this.stats={size:0})}it.prototype.decRef=function(){--this.refCount<=0&&Le(this)};function Le(Ke){var mt=Ke.renderbuffer;k(mt,"must not double destroy renderbuffer"),T.bindRenderbuffer(Rs,null),T.deleteRenderbuffer(mt),Ke.renderbuffer=null,Ke.refCount=0,delete Qe[Ke.id],ye.renderbufferCount--}function qe(Ke,mt){var fe=new it(T.createRenderbuffer());Qe[fe.id]=fe,ye.renderbufferCount++;function Ie(Ct,Ve){var Tt=0,Fe=0,gt=pi;if(typeof Ct=="object"&&Ct){var He=Ct;if("shape"in He){var ut=He.shape;k(Array.isArray(ut)&&ut.length>=2,"invalid renderbuffer shape"),Tt=ut[0]|0,Fe=ut[1]|0}else"radius"in He&&(Tt=Fe=He.radius|0),"width"in He&&(Tt=He.width|0),"height"in He&&(Fe=He.height|0);"format"in He&&(k.parameter(He.format,Ee,"invalid renderbuffer format"),gt=Ee[He.format])}else typeof Ct=="number"?(Tt=Ct|0,typeof Ve=="number"?Fe=Ve|0:Fe=Tt):Ct?k.raise("invalid arguments to renderbuffer constructor"):Tt=Fe=1;if(k(Tt>0&&Fe>0&&Tt<=X.maxRenderbufferSize&&Fe<=X.maxRenderbufferSize,"invalid renderbuffer size"),!(Tt===fe.width&&Fe===fe.height&&gt===fe.format))return Ie.width=fe.width=Tt,Ie.height=fe.height=Fe,fe.format=gt,T.bindRenderbuffer(Rs,fe.renderbuffer),T.renderbufferStorage(Rs,gt,Tt,Fe),k(T.getError()===0,"invalid render buffer format"),se.profile&&(fe.stats.size=zu(fe.format,fe.width,fe.height)),Ie.format=Te[fe.format],Ie}function ot(Ct,Ve){var Tt=Ct|0,Fe=Ve|0||Tt;return Tt===fe.width&&Fe===fe.height||(k(Tt>0&&Fe>0&&Tt<=X.maxRenderbufferSize&&Fe<=X.maxRenderbufferSize,"invalid renderbuffer size"),Ie.width=fe.width=Tt,Ie.height=fe.height=Fe,T.bindRenderbuffer(Rs,fe.renderbuffer),T.renderbufferStorage(Rs,fe.format,Tt,Fe),k(T.getError()===0,"invalid render buffer format"),se.profile&&(fe.stats.size=zu(fe.format,fe.width,fe.height))),Ie}return Ie(Ke,mt),Ie.resize=ot,Ie._reglType="renderbuffer",Ie._renderbuffer=fe,se.profile&&(Ie.stats=fe.stats),Ie.destroy=function(){fe.decRef()},Ie}se.profile&&(ye.getTotalRenderbufferSize=function(){var Ke=0;return Object.keys(Qe).forEach(function(mt){Ke+=Qe[mt].stats.size}),Ke});function Et(){Fr(Qe).forEach(function(Ke){Ke.renderbuffer=T.createRenderbuffer(),T.bindRenderbuffer(Rs,Ke.renderbuffer),T.renderbufferStorage(Rs,Ke.format,Ke.width,Ke.height)}),T.bindRenderbuffer(Rs,null)}return{create:qe,clear:function(){Fr(Qe).forEach(Le)},restore:Et}},Aa=36160,Sl=36161,Ks=3553,Rc=34069,wd=36064,xd=36096,Df=36128,qs=33306,Tl=36053,P=36054,Wu=36055,Pf=36057,za=36061,lr=36193,Sd=5121,Zh=5126,Of=6407,Ms=6408,Al=6402,Td=[Of,Ms],Ad=[];Ad[Ms]=4,Ad[Of]=3;var Mc=[];Mc[Sd]=1,Mc[Zh]=4,Mc[lr]=2;var jh=32854,Ns=32855,Id=36194,Hh=33189,Xh=36168,Cd=34041,op=35907,Qo=34836,sp=34842,$h=34843,Yh=[jh,Ns,Id,op,sp,$h,Qo],Vu={};Vu[Tl]="complete",Vu[P]="incomplete attachment",Vu[Pf]="incomplete dimensions",Vu[Wu]="incomplete, missing attachment",Vu[za]="unsupported";function Kh(T,O,X,ye,se,Ee){var Te={cur:null,next:null,dirty:!1,setFBO:null},$e=["rgba"],Qe=["rgba4","rgb565","rgb5 a1"];O.ext_srgb&&Qe.push("srgba"),O.ext_color_buffer_half_float&&Qe.push("rgba16f","rgb16f"),O.webgl_color_buffer_float&&Qe.push("rgba32f");var it=["uint8"];O.oes_texture_half_float&&it.push("half float","float16"),O.oes_texture_float&&it.push("float","float32");function Le(yt,lt,Ze){this.target=yt,this.texture=lt,this.renderbuffer=Ze;var Qt=0,Tn=0;lt?(Qt=lt.width,Tn=lt.height):Ze&&(Qt=Ze.width,Tn=Ze.height),this.width=Qt,this.height=Tn}function qe(yt){yt&&(yt.texture&&yt.texture._texture.decRef(),yt.renderbuffer&&yt.renderbuffer._renderbuffer.decRef())}function Et(yt,lt,Ze){if(!!yt)if(yt.texture){var Qt=yt.texture._texture,Tn=Math.max(1,Qt.width),Ut=Math.max(1,Qt.height);k(Tn===lt&&Ut===Ze,"inconsistent width/height for supplied texture"),Qt.refCount+=1}else{var Fn=yt.renderbuffer._renderbuffer;k(Fn.width===lt&&Fn.height===Ze,"inconsistent width/height for renderbuffer"),Fn.refCount+=1}}function Ke(yt,lt){lt&&(lt.texture?T.framebufferTexture2D(Aa,yt,lt.target,lt.texture._texture.texture,0):T.framebufferRenderbuffer(Aa,yt,Sl,lt.renderbuffer._renderbuffer.renderbuffer))}function mt(yt){var lt=Ks,Ze=null,Qt=null,Tn=yt;typeof yt=="object"&&(Tn=yt.data,"target"in yt&&(lt=yt.target|0)),k.type(Tn,"function","invalid attachment data");var Ut=Tn._reglType;return Ut==="texture2d"?(Ze=Tn,k(lt===Ks)):Ut==="textureCube"?(Ze=Tn,k(lt>=Rc&&lt<Rc+6,"invalid cube map target")):Ut==="renderbuffer"?(Qt=Tn,lt=Sl):k.raise("invalid regl object for attachment"),new Le(lt,Ze,Qt)}function fe(yt,lt,Ze,Qt,Tn){if(Ze){var Ut=ye.create2D({width:yt,height:lt,format:Qt,type:Tn});return Ut._texture.refCount=0,new Le(Ks,Ut,null)}else{var Fn=se.create({width:yt,height:lt,format:Qt});return Fn._renderbuffer.refCount=0,new Le(Sl,null,Fn)}}function Ie(yt){return yt&&(yt.texture||yt.renderbuffer)}function ot(yt,lt,Ze){yt&&(yt.texture?yt.texture.resize(lt,Ze):yt.renderbuffer&&yt.renderbuffer.resize(lt,Ze),yt.width=lt,yt.height=Ze)}var Ct=0,Ve={};function Tt(){this.id=Ct++,Ve[this.id]=this,this.framebuffer=T.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Fe(yt){yt.colorAttachments.forEach(qe),qe(yt.depthAttachment),qe(yt.stencilAttachment),qe(yt.depthStencilAttachment)}function gt(yt){var lt=yt.framebuffer;k(lt,"must not double destroy framebuffer"),T.deleteFramebuffer(lt),yt.framebuffer=null,Ee.framebufferCount--,delete Ve[yt.id]}function He(yt){var lt;T.bindFramebuffer(Aa,yt.framebuffer);var Ze=yt.colorAttachments;for(lt=0;lt<Ze.length;++lt)Ke(wd+lt,Ze[lt]);for(lt=Ze.length;lt<X.maxColorAttachments;++lt)T.framebufferTexture2D(Aa,wd+lt,Ks,null,0);T.framebufferTexture2D(Aa,qs,Ks,null,0),T.framebufferTexture2D(Aa,xd,Ks,null,0),T.framebufferTexture2D(Aa,Df,Ks,null,0),Ke(xd,yt.depthAttachment),Ke(Df,yt.stencilAttachment),Ke(qs,yt.depthStencilAttachment);var Qt=T.checkFramebufferStatus(Aa);!T.isContextLost()&&Qt!==Tl&&k.raise("framebuffer configuration not supported, status = "+Vu[Qt]),T.bindFramebuffer(Aa,Te.next?Te.next.framebuffer:null),Te.cur=Te.next,T.getError()}function ut(yt,lt){var Ze=new Tt;Ee.framebufferCount++;function Qt(Ut,Fn){var fn;k(Te.next!==Ze,"can not update framebuffer which is currently in use");var An=0,ar=0,Vr=!0,ai=!0,On=null,Zr=!0,xr="rgba",qr="uint8",Jr=1,oi=null,Ir=null,Qr=null,jr=!1;if(typeof Ut=="number")An=Ut|0,ar=Fn|0||An;else if(!Ut)An=ar=1;else{k.type(Ut,"object","invalid arguments for framebuffer");var _n=Ut;if("shape"in _n){var si=_n.shape;k(Array.isArray(si)&&si.length>=2,"invalid shape for framebuffer"),An=si[0],ar=si[1]}else"radius"in _n&&(An=ar=_n.radius),"width"in _n&&(An=_n.width),"height"in _n&&(ar=_n.height);("color"in _n||"colors"in _n)&&(On=_n.color||_n.colors,Array.isArray(On)&&k(On.length===1||O.webgl_draw_buffers,"multiple render targets not supported")),On||("colorCount"in _n&&(Jr=_n.colorCount|0,k(Jr>0,"invalid color buffer count")),"colorTexture"in _n&&(Zr=!!_n.colorTexture,xr="rgba4"),"colorType"in _n&&(qr=_n.colorType,Zr?(k(O.oes_texture_float||!(qr==="float"||qr==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),k(O.oes_texture_half_float||!(qr==="half float"||qr==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):qr==="half float"||qr==="float16"?(k(O.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),xr="rgba16f"):(qr==="float"||qr==="float32")&&(k(O.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),xr="rgba32f"),k.oneOf(qr,it,"invalid color type")),"colorFormat"in _n&&(xr=_n.colorFormat,$e.indexOf(xr)>=0?Zr=!0:Qe.indexOf(xr)>=0?Zr=!1:Zr?k.oneOf(_n.colorFormat,$e,"invalid color format for texture"):k.oneOf(_n.colorFormat,Qe,"invalid color format for renderbuffer"))),("depthTexture"in _n||"depthStencilTexture"in _n)&&(jr=!!(_n.depthTexture||_n.depthStencilTexture),k(!jr||O.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in _n&&(typeof _n.depth=="boolean"?Vr=_n.depth:(oi=_n.depth,ai=!1)),"stencil"in _n&&(typeof _n.stencil=="boolean"?ai=_n.stencil:(Ir=_n.stencil,Vr=!1)),"depthStencil"in _n&&(typeof _n.depthStencil=="boolean"?Vr=ai=_n.depthStencil:(Qr=_n.depthStencil,Vr=!1,ai=!1))}var or=null,tn=null,Vn=null,er=null;if(Array.isArray(On))or=On.map(mt);else if(On)or=[mt(On)];else for(or=new Array(Jr),fn=0;fn<Jr;++fn)or[fn]=fe(An,ar,Zr,xr,qr);k(O.webgl_draw_buffers||or.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),k(or.length<=X.maxColorAttachments,"too many color attachments, not supported"),An=An||or[0].width,ar=ar||or[0].height,oi?tn=mt(oi):Vr&&!ai&&(tn=fe(An,ar,jr,"depth","uint32")),Ir?Vn=mt(Ir):ai&&!Vr&&(Vn=fe(An,ar,!1,"stencil","uint8")),Qr?er=mt(Qr):!oi&&!Ir&&ai&&Vr&&(er=fe(An,ar,jr,"depth stencil","depth stencil")),k(!!oi+!!Ir+!!Qr<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var ui=null;for(fn=0;fn<or.length;++fn)if(Et(or[fn],An,ar),k(!or[fn]||or[fn].texture&&Td.indexOf(or[fn].texture._texture.format)>=0||or[fn].renderbuffer&&Yh.indexOf(or[fn].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+fn+" is invalid"),or[fn]&&or[fn].texture){var No=Ad[or[fn].texture._texture.format]*Mc[or[fn].texture._texture.type];ui===null?ui=No:k(ui===No,"all color attachments much have the same number of bits per pixel.")}return Et(tn,An,ar),k(!tn||tn.texture&&tn.texture._texture.format===Al||tn.renderbuffer&&tn.renderbuffer._renderbuffer.format===Hh,"invalid depth attachment for framebuffer object"),Et(Vn,An,ar),k(!Vn||Vn.renderbuffer&&Vn.renderbuffer._renderbuffer.format===Xh,"invalid stencil attachment for framebuffer object"),Et(er,An,ar),k(!er||er.texture&&er.texture._texture.format===Cd||er.renderbuffer&&er.renderbuffer._renderbuffer.format===Cd,"invalid depth-stencil attachment for framebuffer object"),Fe(Ze),Ze.width=An,Ze.height=ar,Ze.colorAttachments=or,Ze.depthAttachment=tn,Ze.stencilAttachment=Vn,Ze.depthStencilAttachment=er,Qt.color=or.map(Ie),Qt.depth=Ie(tn),Qt.stencil=Ie(Vn),Qt.depthStencil=Ie(er),Qt.width=Ze.width,Qt.height=Ze.height,He(Ze),Qt}function Tn(Ut,Fn){k(Te.next!==Ze,"can not resize a framebuffer which is currently in use");var fn=Math.max(Ut|0,1),An=Math.max(Fn|0||fn,1);if(fn===Ze.width&&An===Ze.height)return Qt;for(var ar=Ze.colorAttachments,Vr=0;Vr<ar.length;++Vr)ot(ar[Vr],fn,An);return ot(Ze.depthAttachment,fn,An),ot(Ze.stencilAttachment,fn,An),ot(Ze.depthStencilAttachment,fn,An),Ze.width=Qt.width=fn,Ze.height=Qt.height=An,He(Ze),Qt}return Qt(yt,lt),S(Qt,{resize:Tn,_reglType:"framebuffer",_framebuffer:Ze,destroy:function(){gt(Ze),Fe(Ze)},use:function(Ut){Te.setFBO({framebuffer:Qt},Ut)}})}function Ht(yt){var lt=Array(6);function Ze(Tn){var Ut;k(lt.indexOf(Te.next)<0,"can not update framebuffer which is currently in use");var Fn={color:null},fn=0,An=null,ar="rgba",Vr="uint8",ai=1;if(typeof Tn=="number")fn=Tn|0;else if(!Tn)fn=1;else{k.type(Tn,"object","invalid arguments for framebuffer");var On=Tn;if("shape"in On){var Zr=On.shape;k(Array.isArray(Zr)&&Zr.length>=2,"invalid shape for framebuffer"),k(Zr[0]===Zr[1],"cube framebuffer must be square"),fn=Zr[0]}else"radius"in On&&(fn=On.radius|0),"width"in On?(fn=On.width|0,"height"in On&&k(On.height===fn,"must be square")):"height"in On&&(fn=On.height|0);("color"in On||"colors"in On)&&(An=On.color||On.colors,Array.isArray(An)&&k(An.length===1||O.webgl_draw_buffers,"multiple render targets not supported")),An||("colorCount"in On&&(ai=On.colorCount|0,k(ai>0,"invalid color buffer count")),"colorType"in On&&(k.oneOf(On.colorType,it,"invalid color type"),Vr=On.colorType),"colorFormat"in On&&(ar=On.colorFormat,k.oneOf(On.colorFormat,$e,"invalid color format for texture"))),"depth"in On&&(Fn.depth=On.depth),"stencil"in On&&(Fn.stencil=On.stencil),"depthStencil"in On&&(Fn.depthStencil=On.depthStencil)}var xr;if(An)if(Array.isArray(An))for(xr=[],Ut=0;Ut<An.length;++Ut)xr[Ut]=An[Ut];else xr=[An];else{xr=Array(ai);var qr={radius:fn,format:ar,type:Vr};for(Ut=0;Ut<ai;++Ut)xr[Ut]=ye.createCube(qr)}for(Fn.color=Array(xr.length),Ut=0;Ut<xr.length;++Ut){var Jr=xr[Ut];k(typeof Jr=="function"&&Jr._reglType==="textureCube","invalid cube map"),fn=fn||Jr.width,k(Jr.width===fn&&Jr.height===fn,"invalid cube map shape"),Fn.color[Ut]={target:Rc,data:xr[Ut]}}for(Ut=0;Ut<6;++Ut){for(var oi=0;oi<xr.length;++oi)Fn.color[oi].target=Rc+Ut;Ut>0&&(Fn.depth=lt[0].depth,Fn.stencil=lt[0].stencil,Fn.depthStencil=lt[0].depthStencil),lt[Ut]?lt[Ut](Fn):lt[Ut]=ut(Fn)}return S(Ze,{width:fn,height:fn,color:xr})}function Qt(Tn){var Ut,Fn=Tn|0;if(k(Fn>0&&Fn<=X.maxCubeMapSize,"invalid radius for cube fbo"),Fn===Ze.width)return Ze;var fn=Ze.color;for(Ut=0;Ut<fn.length;++Ut)fn[Ut].resize(Fn);for(Ut=0;Ut<6;++Ut)lt[Ut].resize(Fn);return Ze.width=Ze.height=Fn,Ze}return Ze(yt),S(Ze,{faces:lt,resize:Qt,_reglType:"framebufferCube",destroy:function(){lt.forEach(function(Tn){Tn.destroy()})}})}function hn(){Te.cur=null,Te.next=null,Te.dirty=!0,Fr(Ve).forEach(function(yt){yt.framebuffer=T.createFramebuffer(),He(yt)})}return S(Te,{getFramebuffer:function(yt){if(typeof yt=="function"&&yt._reglType==="framebuffer"){var lt=yt._framebuffer;if(lt instanceof Tt)return lt}return null},create:ut,createCube:Ht,clear:function(){Fr(Ve).forEach(gt)},restore:hn})}var Js=5126,Rd=34962;function Lf(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Js,this.offset=0,this.stride=0,this.divisor=0}function eo(T,O,X,ye,se){for(var Ee=X.maxAttributes,Te=new Array(Ee),$e=0;$e<Ee;++$e)Te[$e]=new Lf;var Qe=0,it={},Le={Record:Lf,scope:{},state:Te,currentVAO:null,targetVAO:null,restore:Et()?Ve:function(){},createVAO:Tt,getVAO:mt,destroyBuffer:qe,setVAO:Et()?fe:Ie,clear:Et()?ot:function(){}};function qe(Fe){for(var gt=0;gt<Te.length;++gt){var He=Te[gt];He.buffer===Fe&&(T.disableVertexAttribArray(gt),He.buffer=null)}}function Et(){return O.oes_vertex_array_object}function Ke(){return O.angle_instanced_arrays}function mt(Fe){return typeof Fe=="function"&&Fe._vao?Fe._vao:null}function fe(Fe){if(Fe!==Le.currentVAO){var gt=Et();Fe?gt.bindVertexArrayOES(Fe.vao):gt.bindVertexArrayOES(null),Le.currentVAO=Fe}}function Ie(Fe){if(Fe!==Le.currentVAO){if(Fe)Fe.bindAttrs();else for(var gt=Ke(),He=0;He<Te.length;++He){var ut=Te[He];ut.buffer?(T.enableVertexAttribArray(He),T.vertexAttribPointer(He,ut.size,ut.type,ut.normalized,ut.stride,ut.offfset),gt&&ut.divisor&&gt.vertexAttribDivisorANGLE(He,ut.divisor)):(T.disableVertexAttribArray(He),T.vertexAttrib4f(He,ut.x,ut.y,ut.z,ut.w))}Le.currentVAO=Fe}}function ot(){Fr(it).forEach(function(Fe){Fe.destroy()})}function Ct(){this.id=++Qe,this.attributes=[];var Fe=Et();Fe?this.vao=Fe.createVertexArrayOES():this.vao=null,it[this.id]=this,this.buffers=[]}Ct.prototype.bindAttrs=function(){for(var Fe=Ke(),gt=this.attributes,He=0;He<gt.length;++He){var ut=gt[He];ut.buffer?(T.enableVertexAttribArray(He),T.bindBuffer(Rd,ut.buffer.buffer),T.vertexAttribPointer(He,ut.size,ut.type,ut.normalized,ut.stride,ut.offset),Fe&&ut.divisor&&Fe.vertexAttribDivisorANGLE(He,ut.divisor)):(T.disableVertexAttribArray(He),T.vertexAttrib4f(He,ut.x,ut.y,ut.z,ut.w))}for(var Ht=gt.length;Ht<Ee;++Ht)T.disableVertexAttribArray(Ht)},Ct.prototype.refresh=function(){var Fe=Et();Fe&&(Fe.bindVertexArrayOES(this.vao),this.bindAttrs(),Le.currentVAO=this)},Ct.prototype.destroy=function(){if(this.vao){var Fe=Et();this===Le.currentVAO&&(Le.currentVAO=null,Fe.bindVertexArrayOES(null)),Fe.deleteVertexArrayOES(this.vao),this.vao=null}it[this.id]&&(delete it[this.id],ye.vaoCount-=1)};function Ve(){var Fe=Et();Fe&&Fr(it).forEach(function(gt){gt.refresh()})}function Tt(Fe){var gt=new Ct;ye.vaoCount+=1;function He(ut){k(Array.isArray(ut),"arguments to vertex array constructor must be an array"),k(ut.length<Ee,"too many attributes"),k(ut.length>0,"must specify at least one attribute");var Ht={},hn=gt.attributes;hn.length=ut.length;for(var yt=0;yt<ut.length;++yt){var lt=ut[yt],Ze=hn[yt]=new Lf,Qt=lt.data||lt;if(Array.isArray(Qt)||I(Qt)||_i(Qt)){var Tn;gt.buffers[yt]&&(Tn=gt.buffers[yt],I(Qt)&&Tn._buffer.byteLength>=Qt.byteLength?Tn.subdata(Qt):(Tn.destroy(),gt.buffers[yt]=null)),gt.buffers[yt]||(Tn=gt.buffers[yt]=se.create(lt,Rd,!1,!0)),Ze.buffer=se.getBuffer(Tn),Ze.size=Ze.buffer.dimension|0,Ze.normalized=!1,Ze.type=Ze.buffer.dtype,Ze.offset=0,Ze.stride=0,Ze.divisor=0,Ze.state=1,Ht[yt]=1}else se.getBuffer(lt)?(Ze.buffer=se.getBuffer(lt),Ze.size=Ze.buffer.dimension|0,Ze.normalized=!1,Ze.type=Ze.buffer.dtype,Ze.offset=0,Ze.stride=0,Ze.divisor=0,Ze.state=1):se.getBuffer(lt.buffer)?(Ze.buffer=se.getBuffer(lt.buffer),Ze.size=(+lt.size||Ze.buffer.dimension)|0,Ze.normalized=!!lt.normalized||!1,"type"in lt?(k.parameter(lt.type,bi,"invalid buffer type"),Ze.type=bi[lt.type]):Ze.type=Ze.buffer.dtype,Ze.offset=(lt.offset||0)|0,Ze.stride=(lt.stride||0)|0,Ze.divisor=(lt.divisor||0)|0,Ze.state=1,k(Ze.size>=1&&Ze.size<=4,"size must be between 1 and 4"),k(Ze.offset>=0,"invalid offset"),k(Ze.stride>=0&&Ze.stride<=255,"stride must be between 0 and 255"),k(Ze.divisor>=0,"divisor must be positive"),k(!Ze.divisor||!!O.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in lt?(k(yt>0,"first attribute must not be a constant"),Ze.x=+lt.x||0,Ze.y=+lt.y||0,Ze.z=+lt.z||0,Ze.w=+lt.w||0,Ze.state=2):k(!1,"invalid attribute spec for location "+yt)}for(var Ut=0;Ut<gt.buffers.length;++Ut)!Ht[Ut]&&gt.buffers[Ut]&&(gt.buffers[Ut].destroy(),gt.buffers[Ut]=null);return gt.refresh(),He}return He.destroy=function(){for(var ut=0;ut<gt.buffers.length;++ut)gt.buffers[ut]&&gt.buffers[ut].destroy();gt.buffers.length=0,gt.destroy()},He._vao=gt,He._reglType="vao",He(Fe)}return Le}var Md=35632,Nd=35633,qh=35718,Jh=35721;function Qh(T,O,X,ye){var se={},Ee={};function Te(fe,Ie,ot,Ct){this.name=fe,this.id=Ie,this.location=ot,this.info=Ct}function $e(fe,Ie){for(var ot=0;ot<fe.length;++ot)if(fe[ot].id===Ie.id){fe[ot].location=Ie.location;return}fe.push(Ie)}function Qe(fe,Ie,ot){var Ct=fe===Md?se:Ee,Ve=Ct[Ie];if(!Ve){var Tt=O.str(Ie);Ve=T.createShader(fe),T.shaderSource(Ve,Tt),T.compileShader(Ve),k.shaderError(T,Ve,Tt,fe,ot),Ct[Ie]=Ve}return Ve}var it={},Le=[],qe=0;function Et(fe,Ie){this.id=qe++,this.fragId=fe,this.vertId=Ie,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,ye.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Ke(fe,Ie,ot){var Ct,Ve,Tt=Qe(Md,fe.fragId),Fe=Qe(Nd,fe.vertId),gt=fe.program=T.createProgram();if(T.attachShader(gt,Tt),T.attachShader(gt,Fe),ot)for(Ct=0;Ct<ot.length;++Ct){var He=ot[Ct];T.bindAttribLocation(gt,He[0],He[1])}T.linkProgram(gt),k.linkError(T,gt,O.str(fe.fragId),O.str(fe.vertId),Ie);var ut=T.getProgramParameter(gt,qh);ye.profile&&(fe.stats.uniformsCount=ut);var Ht=fe.uniforms;for(Ct=0;Ct<ut;++Ct)if(Ve=T.getActiveUniform(gt,Ct),Ve)if(Ve.size>1)for(var hn=0;hn<Ve.size;++hn){var yt=Ve.name.replace("[0]","["+hn+"]");$e(Ht,new Te(yt,O.id(yt),T.getUniformLocation(gt,yt),Ve))}else $e(Ht,new Te(Ve.name,O.id(Ve.name),T.getUniformLocation(gt,Ve.name),Ve));var lt=T.getProgramParameter(gt,Jh);ye.profile&&(fe.stats.attributesCount=lt);var Ze=fe.attributes;for(Ct=0;Ct<lt;++Ct)Ve=T.getActiveAttrib(gt,Ct),Ve&&$e(Ze,new Te(Ve.name,O.id(Ve.name),T.getAttribLocation(gt,Ve.name),Ve))}ye.profile&&(X.getMaxUniformsCount=function(){var fe=0;return Le.forEach(function(Ie){Ie.stats.uniformsCount>fe&&(fe=Ie.stats.uniformsCount)}),fe},X.getMaxAttributesCount=function(){var fe=0;return Le.forEach(function(Ie){Ie.stats.attributesCount>fe&&(fe=Ie.stats.attributesCount)}),fe});function mt(){se={},Ee={};for(var fe=0;fe<Le.length;++fe)Ke(Le[fe],null,Le[fe].attributes.map(function(Ie){return[Ie.location,Ie.name]}))}return{clear:function(){var fe=T.deleteShader.bind(T);Fr(se).forEach(fe),se={},Fr(Ee).forEach(fe),Ee={},Le.forEach(function(Ie){T.deleteProgram(Ie.program)}),Le.length=0,it={},X.shaderCount=0},program:function(fe,Ie,ot,Ct){k.command(fe>=0,"missing vertex shader",ot),k.command(Ie>=0,"missing fragment shader",ot);var Ve=it[Ie];Ve||(Ve=it[Ie]={});var Tt=Ve[fe];if(Tt&&(Tt.refCount++,!Ct))return Tt;var Fe=new Et(Ie,fe);return X.shaderCount++,Ke(Fe,ot,Ct),Tt||(Ve[fe]=Fe),Le.push(Fe),S(Fe,{destroy:function(){if(Fe.refCount--,Fe.refCount<=0){T.deleteProgram(Fe.program);var gt=Le.indexOf(Fe);Le.splice(gt,1),X.shaderCount--}Ve[Fe.vertId].refCount<=0&&(T.deleteShader(Ee[Fe.vertId]),delete Ee[Fe.vertId],delete it[Fe.fragId][Fe.vertId]),Object.keys(it[Fe.fragId]).length||(T.deleteShader(se[Fe.fragId]),delete se[Fe.fragId],delete it[Fe.fragId])}})},restore:mt,shader:Qe,frag:-1,vert:-1}}var Dd=6408,Qs=5121,Pd=3333,Zu=5126;function Il(T,O,X,ye,se,Ee,Te){function $e(Le){var qe;O.next===null?(k(se.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),qe=Qs):(k(O.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),qe=O.next.colorAttachments[0].texture._texture.type,Ee.oes_texture_float?(k(qe===Qs||qe===Zu,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),qe===Zu&&k(Te.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):k(qe===Qs,"Reading from a framebuffer is only allowed for the type 'uint8'"));var Et=0,Ke=0,mt=ye.framebufferWidth,fe=ye.framebufferHeight,Ie=null;I(Le)?Ie=Le:Le&&(k.type(Le,"object","invalid arguments to regl.read()"),Et=Le.x|0,Ke=Le.y|0,k(Et>=0&&Et<ye.framebufferWidth,"invalid x offset for regl.read"),k(Ke>=0&&Ke<ye.framebufferHeight,"invalid y offset for regl.read"),mt=(Le.width||ye.framebufferWidth-Et)|0,fe=(Le.height||ye.framebufferHeight-Ke)|0,Ie=Le.data||null),Ie&&(qe===Qs?k(Ie instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):qe===Zu&&k(Ie instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),k(mt>0&&mt+Et<=ye.framebufferWidth,"invalid width for read pixels"),k(fe>0&&fe+Ke<=ye.framebufferHeight,"invalid height for read pixels"),X();var ot=mt*fe*4;return Ie||(qe===Qs?Ie=new Uint8Array(ot):qe===Zu&&(Ie=Ie||new Float32Array(ot))),k.isTypedArray(Ie,"data buffer for regl.read() must be a typedarray"),k(Ie.byteLength>=ot,"data buffer for regl.read() too small"),T.pixelStorei(Pd,4),T.readPixels(Et,Ke,mt,fe,Dd,qe,Ie),Ie}function Qe(Le){var qe;return O.setFBO({framebuffer:Le.framebuffer},function(){qe=$e(Le)}),qe}function it(Le){return!Le||!("framebuffer"in Le)?$e(Le):Qe(Le)}return it}function So(T){return Array.prototype.slice.call(T)}function To(T){return So(T).join("")}function Od(){var T=0,O=[],X=[];function ye(qe){for(var Et=0;Et<X.length;++Et)if(X[Et]===qe)return O[Et];var Ke="g"+T++;return O.push(Ke),X.push(qe),Ke}function se(){var qe=[];function Et(){qe.push.apply(qe,So(arguments))}var Ke=[];function mt(){var fe="v"+T++;return Ke.push(fe),arguments.length>0&&(qe.push(fe,"="),qe.push.apply(qe,So(arguments)),qe.push(";")),fe}return S(Et,{def:mt,toString:function(){return To([Ke.length>0?"var "+Ke.join(",")+";":"",To(qe)])}})}function Ee(){var qe=se(),Et=se(),Ke=qe.toString,mt=Et.toString;function fe(Ie,ot){Et(Ie,ot,"=",qe.def(Ie,ot),";")}return S(function(){qe.apply(qe,So(arguments))},{def:qe.def,entry:qe,exit:Et,save:fe,set:function(Ie,ot,Ct){fe(Ie,ot),qe(Ie,ot,"=",Ct,";")},toString:function(){return Ke()+mt()}})}function Te(){var qe=To(arguments),Et=Ee(),Ke=Ee(),mt=Et.toString,fe=Ke.toString;return S(Et,{then:function(){return Et.apply(Et,So(arguments)),this},else:function(){return Ke.apply(Ke,So(arguments)),this},toString:function(){var Ie=fe();return Ie&&(Ie="else{"+Ie+"}"),To(["if(",qe,"){",mt(),"}",Ie])}})}var $e=se(),Qe={};function it(qe,Et){var Ke=[];function mt(){var Ve="a"+Ke.length;return Ke.push(Ve),Ve}Et=Et||0;for(var fe=0;fe<Et;++fe)mt();var Ie=Ee(),ot=Ie.toString,Ct=Qe[qe]=S(Ie,{arg:mt,toString:function(){return To(["function(",Ke.join(),"){",ot(),"}"])}});return Ct}function Le(){var qe=['"use strict";',$e,"return {"];Object.keys(Qe).forEach(function(mt){qe.push('"',mt,'":',Qe[mt].toString(),",")}),qe.push("}");var Et=To(qe).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Ke=Function.apply(null,O.concat(Et));return Ke.apply(null,X)}return{global:$e,link:ye,block:se,proc:it,scope:Ee,cond:Te,compile:Le}}var eu="xyzw".split(""),Cl=5121,ya=1,ju=2,Ao=0,_a=1,Gf=2,Nc=3,Hu=4,Dc=5,es=6,Rl="dither",Ld="blend.enable",Pc="blend.color",Gd="blend.equation",kf="blend.func",Qi="depth.enable",Ff="depth.func",Ml="depth.range",to="depth.mask",Oc="colorMask",Lc="cull.enable",Ds="cull.face",Uf="frontFace",ki="lineWidth",Bf="polygonOffset.enable",Nl="polygonOffset.offset",kd="sample.alpha",Fd="sample.enable",tu="sample.coverage",Ud="stencil.enable",Xu="stencil.mask",zf="stencil.func",Dl="stencil.opFront",Gc="stencil.opBack",$u="scissor.enable",Wf="scissor.box",ts="viewport",nu="profile",Ps="framebuffer",kc="vert",Fc="frag",ru="elements",Io="primitive",no="count",Vf="offset",Yu="instances",Os="vao",iu="Width",au="Height",Co=Ps+iu,ro=Ps+au,Bd=ts+iu,ra=ts+au,ou="drawingBuffer",su=ou+iu,Uc=ou+au,Ku=[kf,Gd,zf,Dl,Gc,tu,ts,Wf,Nl],ns=34962,Pl=34963,qu=35632,Ju=35633,Qn=3553,ev=34067,tv=2884,Bc=3042,zd=3024,Qu=2960,Zf=2929,Wa=3089,nv=32823,jf=32926,Ol=32928,zc=5126,Wc=35664,Ur=35665,mi=35666,ec=5124,Vc=35667,uu=35668,rs=35669,Zc=35670,jc=35671,tc=35672,cu=35673,Fi=35674,Zi=35675,Ia=35676,Ro=35678,Ls=35680,Hc=4,Xc=1028,fu=1029,Gs=2304,Hf=2305,Wd=32775,rv=32776,Vd=519,is=7680,la=0,io=1,Zd=32774,lu=513,as=36160,Mo=36064,ao={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Ll=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],nc={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},os={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},du={frag:qu,vert:Ju},hu={cw:Gs,ccw:Hf};function Xf(T){return Array.isArray(T)||I(T)||_i(T)}function ks(T){return T.sort(function(O,X){return O===ts?-1:X===ts?1:O<X?-1:1})}function ea(T,O,X,ye){this.thisDep=T,this.contextDep=O,this.propDep=X,this.append=ye}function oo(T){return T&&!(T.thisDep||T.contextDep||T.propDep)}function ii(T){return new ea(!1,!1,!1,T)}function Di(T,O){var X=T.type;if(X===Ao){var ye=T.data.length;return new ea(!0,ye>=1,ye>=2,O)}else if(X===Hu){var se=T.data;return new ea(se.thisDep,se.contextDep,se.propDep,O)}else{if(X===Dc)return new ea(!1,!1,!1,O);if(X===es){for(var Ee=!1,Te=!1,$e=!1,Qe=0;Qe<T.data.length;++Qe){var it=T.data[Qe];if(it.type===_a)$e=!0;else if(it.type===Gf)Te=!0;else if(it.type===Nc)Ee=!0;else if(it.type===Ao){Ee=!0;var Le=it.data;Le>=1&&(Te=!0),Le>=2&&($e=!0)}else it.type===Hu&&(Ee=Ee||it.data.thisDep,Te=Te||it.data.contextDep,$e=$e||it.data.propDep)}return new ea(Ee,Te,$e,O)}else return new ea(X===Nc,X===Gf,X===_a,O)}}var $f=new ea(!1,!1,!1,function(){});function Yf(T,O,X,ye,se,Ee,Te,$e,Qe,it,Le,qe,Et,Ke,mt){var fe=it.Record,Ie={add:32774,subtract:32778,"reverse subtract":32779};X.ext_blend_minmax&&(Ie.min=Wd,Ie.max=rv);var ot=X.angle_instanced_arrays,Ct=X.webgl_draw_buffers,Ve={dirty:!0,profile:mt.profile},Tt={},Fe=[],gt={},He={};function ut(U){return U.replace(".","_")}function Ht(U,D,Y){var ce=ut(U);Fe.push(U),Tt[ce]=Ve[ce]=!!Y,gt[ce]=D}function hn(U,D,Y){var ce=ut(U);Fe.push(U),Array.isArray(Y)?(Ve[ce]=Y.slice(),Tt[ce]=Y.slice()):Ve[ce]=Tt[ce]=Y,He[ce]=D}Ht(Rl,zd),Ht(Ld,Bc),hn(Pc,"blendColor",[0,0,0,0]),hn(Gd,"blendEquationSeparate",[Zd,Zd]),hn(kf,"blendFuncSeparate",[io,la,io,la]),Ht(Qi,Zf,!0),hn(Ff,"depthFunc",lu),hn(Ml,"depthRange",[0,1]),hn(to,"depthMask",!0),hn(Oc,Oc,[!0,!0,!0,!0]),Ht(Lc,tv),hn(Ds,"cullFace",fu),hn(Uf,Uf,Hf),hn(ki,ki,1),Ht(Bf,nv),hn(Nl,"polygonOffset",[0,0]),Ht(kd,jf),Ht(Fd,Ol),hn(tu,"sampleCoverage",[1,!1]),Ht(Ud,Qu),hn(Xu,"stencilMask",-1),hn(zf,"stencilFunc",[Vd,0,-1]),hn(Dl,"stencilOpSeparate",[Xc,is,is,is]),hn(Gc,"stencilOpSeparate",[fu,is,is,is]),Ht($u,Wa),hn(Wf,"scissor",[0,0,T.drawingBufferWidth,T.drawingBufferHeight]),hn(ts,ts,[0,0,T.drawingBufferWidth,T.drawingBufferHeight]);var yt={gl:T,context:Et,strings:O,next:Tt,current:Ve,draw:qe,elements:Ee,buffer:se,shader:Le,attributes:it.state,vao:it,uniforms:Qe,framebuffer:$e,extensions:X,timer:Ke,isBufferArgs:Xf},lt={primTypes:ri,compareFuncs:nc,blendFuncs:ao,blendEquations:Ie,stencilOps:os,glTypes:bi,orientationType:hu};k.optional(function(){yt.isArrayLike=Gr}),Ct&&(lt.backBuffer=[fu],lt.drawBuffer=di(ye.maxDrawbuffers,function(U){return U===0?[0]:di(U,function(D){return Mo+D})}));var Ze=0;function Qt(){var U=Od(),D=U.link,Y=U.global;U.id=Ze++,U.batchId="0";var ce=D(yt),le=U.shared={props:"a0"};Object.keys(yt).forEach(function($){le[$]=Y.def(ce,".",$)}),k.optional(function(){U.CHECK=D(k),U.commandStr=k.guessCommand(),U.command=D(U.commandStr),U.assert=function($,G,ae){$("if(!(",G,"))",this.CHECK,".commandRaise(",D(ae),",",this.command,");")},lt.invalidBlendCombinations=Ll});var ne=U.next={},K=U.current={};Object.keys(He).forEach(function($){Array.isArray(Ve[$])&&(ne[$]=Y.def(le.next,".",$),K[$]=Y.def(le.current,".",$))});var oe=U.constants={};Object.keys(lt).forEach(function($){oe[$]=Y.def(JSON.stringify(lt[$]))}),U.invoke=function($,G){switch(G.type){case Ao:var ae=["this",le.context,le.props,U.batchId];return $.def(D(G.data),".call(",ae.slice(0,Math.max(G.data.length+1,4)),")");case _a:return $.def(le.props,G.data);case Gf:return $.def(le.context,G.data);case Nc:return $.def("this",G.data);case Hu:return G.data.append(U,$),G.data.ref;case Dc:return G.data.toString();case es:return G.data.map(function(pe){return U.invoke($,pe)})}},U.attribCache={};var B={};return U.scopeAttrib=function($){var G=O.id($);if(G in B)return B[G];var ae=it.scope[G];ae||(ae=it.scope[G]=new fe);var pe=B[G]=D(ae);return pe},U}function Tn(U){var D=U.static,Y=U.dynamic,ce;if(nu in D){var le=!!D[nu];ce=ii(function(K,oe){return le}),ce.enable=le}else if(nu in Y){var ne=Y[nu];ce=Di(ne,function(K,oe){return K.invoke(oe,ne)})}return ce}function Ut(U,D){var Y=U.static,ce=U.dynamic;if(Ps in Y){var le=Y[Ps];return le?(le=$e.getFramebuffer(le),k.command(le,"invalid framebuffer object"),ii(function(K,oe){var B=K.link(le),$=K.shared;oe.set($.framebuffer,".next",B);var G=$.context;return oe.set(G,"."+Co,B+".width"),oe.set(G,"."+ro,B+".height"),B})):ii(function(K,oe){var B=K.shared;oe.set(B.framebuffer,".next","null");var $=B.context;return oe.set($,"."+Co,$+"."+su),oe.set($,"."+ro,$+"."+Uc),"null"})}else if(Ps in ce){var ne=ce[Ps];return Di(ne,function(K,oe){var B=K.invoke(oe,ne),$=K.shared,G=$.framebuffer,ae=oe.def(G,".getFramebuffer(",B,")");k.optional(function(){K.assert(oe,"!"+B+"||"+ae,"invalid framebuffer object")}),oe.set(G,".next",ae);var pe=$.context;return oe.set(pe,"."+Co,ae+"?"+ae+".width:"+pe+"."+su),oe.set(pe,"."+ro,ae+"?"+ae+".height:"+pe+"."+Uc),ae})}else return null}function Fn(U,D,Y){var ce=U.static,le=U.dynamic;function ne(B){if(B in ce){var $=ce[B];k.commandType($,"object","invalid "+B,Y.commandStr);var G=!0,ae=$.x|0,pe=$.y|0,Oe,Be;return"width"in $?(Oe=$.width|0,k.command(Oe>=0,"invalid "+B,Y.commandStr)):G=!1,"height"in $?(Be=$.height|0,k.command(Be>=0,"invalid "+B,Y.commandStr)):G=!1,new ea(!G&&D&&D.thisDep,!G&&D&&D.contextDep,!G&&D&&D.propDep,function(At,xn){var Bt=At.shared.context,Jt=Oe;"width"in $||(Jt=xn.def(Bt,".",Co,"-",ae));var vn=Be;return"height"in $||(vn=xn.def(Bt,".",ro,"-",pe)),[ae,pe,Jt,vn]})}else if(B in le){var Me=le[B],st=Di(Me,function(At,xn){var Bt=At.invoke(xn,Me);k.optional(function(){At.assert(xn,Bt+"&&typeof "+Bt+'==="object"',"invalid "+B)});var Jt=At.shared.context,vn=xn.def(Bt,".x|0"),tr=xn.def(Bt,".y|0"),kr=xn.def('"width" in ',Bt,"?",Bt,".width|0:","(",Jt,".",Co,"-",vn,")"),wi=xn.def('"height" in ',Bt,"?",Bt,".height|0:","(",Jt,".",ro,"-",tr,")");return k.optional(function(){At.assert(xn,kr+">=0&&"+wi+">=0","invalid "+B)}),[vn,tr,kr,wi]});return D&&(st.thisDep=st.thisDep||D.thisDep,st.contextDep=st.contextDep||D.contextDep,st.propDep=st.propDep||D.propDep),st}else return D?new ea(D.thisDep,D.contextDep,D.propDep,function(At,xn){var Bt=At.shared.context;return[0,0,xn.def(Bt,".",Co),xn.def(Bt,".",ro)]}):null}var K=ne(ts);if(K){var oe=K;K=new ea(K.thisDep,K.contextDep,K.propDep,function(B,$){var G=oe.append(B,$),ae=B.shared.context;return $.set(ae,"."+Bd,G[2]),$.set(ae,"."+ra,G[3]),G})}return{viewport:K,scissor_box:ne(Wf)}}function fn(U,D){var Y=U.static,ce=typeof Y[Fc]=="string"&&typeof Y[kc]=="string";if(ce){if(Object.keys(D.dynamic).length>0)return null;var le=D.static,ne=Object.keys(le);if(ne.length>0&&typeof le[ne[0]]=="number"){for(var K=[],oe=0;oe<ne.length;++oe)k(typeof le[ne[oe]]=="number","must specify all vertex attribute locations when using vaos"),K.push([le[ne[oe]]|0,ne[oe]]);return K}}return null}function An(U,D,Y){var ce=U.static,le=U.dynamic;function ne(G){if(G in ce){var ae=O.id(ce[G]);k.optional(function(){Le.shader(du[G],ae,k.guessCommand())});var pe=ii(function(){return ae});return pe.id=ae,pe}else if(G in le){var Oe=le[G];return Di(Oe,function(Be,Me){var st=Be.invoke(Me,Oe),At=Me.def(Be.shared.strings,".id(",st,")");return k.optional(function(){Me(Be.shared.shader,".shader(",du[G],",",At,",",Be.command,");")}),At})}return null}var K=ne(Fc),oe=ne(kc),B=null,$;return oo(K)&&oo(oe)?(B=Le.program(oe.id,K.id,null,Y),$=ii(function(G,ae){return G.link(B)})):$=new ea(K&&K.thisDep||oe&&oe.thisDep,K&&K.contextDep||oe&&oe.contextDep,K&&K.propDep||oe&&oe.propDep,function(G,ae){var pe=G.shared.shader,Oe;K?Oe=K.append(G,ae):Oe=ae.def(pe,".",Fc);var Be;oe?Be=oe.append(G,ae):Be=ae.def(pe,".",kc);var Me=pe+".program("+Be+","+Oe;return k.optional(function(){Me+=","+G.command}),ae.def(Me+")")}),{frag:K,vert:oe,progVar:$,program:B}}function ar(U,D){var Y=U.static,ce=U.dynamic;function le(){if(ru in Y){var G=Y[ru];Xf(G)?G=Ee.getElements(Ee.create(G,!0)):G&&(G=Ee.getElements(G),k.command(G,"invalid elements",D.commandStr));var ae=ii(function(Oe,Be){if(G){var Me=Oe.link(G);return Oe.ELEMENTS=Me,Me}return Oe.ELEMENTS=null,null});return ae.value=G,ae}else if(ru in ce){var pe=ce[ru];return Di(pe,function(Oe,Be){var Me=Oe.shared,st=Me.isBufferArgs,At=Me.elements,xn=Oe.invoke(Be,pe),Bt=Be.def("null"),Jt=Be.def(st,"(",xn,")"),vn=Oe.cond(Jt).then(Bt,"=",At,".createStream(",xn,");").else(Bt,"=",At,".getElements(",xn,");");return k.optional(function(){Oe.assert(vn.else,"!"+xn+"||"+Bt,"invalid elements")}),Be.entry(vn),Be.exit(Oe.cond(Jt).then(At,".destroyStream(",Bt,");")),Oe.ELEMENTS=Bt,Bt})}return null}var ne=le();function K(){if(Io in Y){var G=Y[Io];return k.commandParameter(G,ri,"invalid primitve",D.commandStr),ii(function(pe,Oe){return ri[G]})}else if(Io in ce){var ae=ce[Io];return Di(ae,function(pe,Oe){var Be=pe.constants.primTypes,Me=pe.invoke(Oe,ae);return k.optional(function(){pe.assert(Oe,Me+" in "+Be,"invalid primitive, must be one of "+Object.keys(ri))}),Oe.def(Be,"[",Me,"]")})}else if(ne)return oo(ne)?ne.value?ii(function(pe,Oe){return Oe.def(pe.ELEMENTS,".primType")}):ii(function(){return Hc}):new ea(ne.thisDep,ne.contextDep,ne.propDep,function(pe,Oe){var Be=pe.ELEMENTS;return Oe.def(Be,"?",Be,".primType:",Hc)});return null}function oe(G,ae){if(G in Y){var pe=Y[G]|0;return k.command(!ae||pe>=0,"invalid "+G,D.commandStr),ii(function(Be,Me){return ae&&(Be.OFFSET=pe),pe})}else if(G in ce){var Oe=ce[G];return Di(Oe,function(Be,Me){var st=Be.invoke(Me,Oe);return ae&&(Be.OFFSET=st,k.optional(function(){Be.assert(Me,st+">=0","invalid "+G)})),st})}else if(ae&&ne)return ii(function(Be,Me){return Be.OFFSET="0",0});return null}var B=oe(Vf,!0);function $(){if(no in Y){var G=Y[no]|0;return k.command(typeof G=="number"&&G>=0,"invalid vertex count",D.commandStr),ii(function(){return G})}else if(no in ce){var ae=ce[no];return Di(ae,function(Be,Me){var st=Be.invoke(Me,ae);return k.optional(function(){Be.assert(Me,"typeof "+st+'==="number"&&'+st+">=0&&"+st+"===("+st+"|0)","invalid vertex count")}),st})}else if(ne)if(oo(ne)){if(ne)return B?new ea(B.thisDep,B.contextDep,B.propDep,function(Be,Me){var st=Me.def(Be.ELEMENTS,".vertCount-",Be.OFFSET);return k.optional(function(){Be.assert(Me,st+">=0","invalid vertex offset/element buffer too small")}),st}):ii(function(Be,Me){return Me.def(Be.ELEMENTS,".vertCount")});var pe=ii(function(){return-1});return k.optional(function(){pe.MISSING=!0}),pe}else{var Oe=new ea(ne.thisDep||B.thisDep,ne.contextDep||B.contextDep,ne.propDep||B.propDep,function(Be,Me){var st=Be.ELEMENTS;return Be.OFFSET?Me.def(st,"?",st,".vertCount-",Be.OFFSET,":-1"):Me.def(st,"?",st,".vertCount:-1")});return k.optional(function(){Oe.DYNAMIC=!0}),Oe}return null}return{elements:ne,primitive:K(),count:$(),instances:oe(Yu,!1),offset:B}}function Vr(U,D){var Y=U.static,ce=U.dynamic,le={};return Fe.forEach(function(ne){var K=ut(ne);function oe(B,$){if(ne in Y){var G=B(Y[ne]);le[K]=ii(function(){return G})}else if(ne in ce){var ae=ce[ne];le[K]=Di(ae,function(pe,Oe){return $(pe,Oe,pe.invoke(Oe,ae))})}}switch(ne){case Lc:case Ld:case Rl:case Ud:case Qi:case $u:case Bf:case kd:case Fd:case to:return oe(function(B){return k.commandType(B,"boolean",ne,D.commandStr),B},function(B,$,G){return k.optional(function(){B.assert($,"typeof "+G+'==="boolean"',"invalid flag "+ne,B.commandStr)}),G});case Ff:return oe(function(B){return k.commandParameter(B,nc,"invalid "+ne,D.commandStr),nc[B]},function(B,$,G){var ae=B.constants.compareFuncs;return k.optional(function(){B.assert($,G+" in "+ae,"invalid "+ne+", must be one of "+Object.keys(nc))}),$.def(ae,"[",G,"]")});case Ml:return oe(function(B){return k.command(Gr(B)&&B.length===2&&typeof B[0]=="number"&&typeof B[1]=="number"&&B[0]<=B[1],"depth range is 2d array",D.commandStr),B},function(B,$,G){k.optional(function(){B.assert($,B.shared.isArrayLike+"("+G+")&&"+G+".length===2&&typeof "+G+'[0]==="number"&&typeof '+G+'[1]==="number"&&'+G+"[0]<="+G+"[1]","depth range must be a 2d array")});var ae=$.def("+",G,"[0]"),pe=$.def("+",G,"[1]");return[ae,pe]});case kf:return oe(function(B){k.commandType(B,"object","blend.func",D.commandStr);var $="srcRGB"in B?B.srcRGB:B.src,G="srcAlpha"in B?B.srcAlpha:B.src,ae="dstRGB"in B?B.dstRGB:B.dst,pe="dstAlpha"in B?B.dstAlpha:B.dst;return k.commandParameter($,ao,K+".srcRGB",D.commandStr),k.commandParameter(G,ao,K+".srcAlpha",D.commandStr),k.commandParameter(ae,ao,K+".dstRGB",D.commandStr),k.commandParameter(pe,ao,K+".dstAlpha",D.commandStr),k.command(Ll.indexOf($+", "+ae)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+$+", "+ae+")",D.commandStr),[ao[$],ao[ae],ao[G],ao[pe]]},function(B,$,G){var ae=B.constants.blendFuncs;k.optional(function(){B.assert($,G+"&&typeof "+G+'==="object"',"invalid blend func, must be an object")});function pe(Bt,Jt){var vn=$.def('"',Bt,Jt,'" in ',G,"?",G,".",Bt,Jt,":",G,".",Bt);return k.optional(function(){B.assert($,vn+" in "+ae,"invalid "+ne+"."+Bt+Jt+", must be one of "+Object.keys(ao))}),vn}var Oe=pe("src","RGB"),Be=pe("dst","RGB");k.optional(function(){var Bt=B.constants.invalidBlendCombinations;B.assert($,Bt+".indexOf("+Oe+'+", "+'+Be+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var Me=$.def(ae,"[",Oe,"]"),st=$.def(ae,"[",pe("src","Alpha"),"]"),At=$.def(ae,"[",Be,"]"),xn=$.def(ae,"[",pe("dst","Alpha"),"]");return[Me,At,st,xn]});case Gd:return oe(function(B){if(typeof B=="string")return k.commandParameter(B,Ie,"invalid "+ne,D.commandStr),[Ie[B],Ie[B]];if(typeof B=="object")return k.commandParameter(B.rgb,Ie,ne+".rgb",D.commandStr),k.commandParameter(B.alpha,Ie,ne+".alpha",D.commandStr),[Ie[B.rgb],Ie[B.alpha]];k.commandRaise("invalid blend.equation",D.commandStr)},function(B,$,G){var ae=B.constants.blendEquations,pe=$.def(),Oe=$.def(),Be=B.cond("typeof ",G,'==="string"');return k.optional(function(){function Me(st,At,xn){B.assert(st,xn+" in "+ae,"invalid "+At+", must be one of "+Object.keys(Ie))}Me(Be.then,ne,G),B.assert(Be.else,G+"&&typeof "+G+'==="object"',"invalid "+ne),Me(Be.else,ne+".rgb",G+".rgb"),Me(Be.else,ne+".alpha",G+".alpha")}),Be.then(pe,"=",Oe,"=",ae,"[",G,"];"),Be.else(pe,"=",ae,"[",G,".rgb];",Oe,"=",ae,"[",G,".alpha];"),$(Be),[pe,Oe]});case Pc:return oe(function(B){return k.command(Gr(B)&&B.length===4,"blend.color must be a 4d array",D.commandStr),di(4,function($){return+B[$]})},function(B,$,G){return k.optional(function(){B.assert($,B.shared.isArrayLike+"("+G+")&&"+G+".length===4","blend.color must be a 4d array")}),di(4,function(ae){return $.def("+",G,"[",ae,"]")})});case Xu:return oe(function(B){return k.commandType(B,"number",K,D.commandStr),B|0},function(B,$,G){return k.optional(function(){B.assert($,"typeof "+G+'==="number"',"invalid stencil.mask")}),$.def(G,"|0")});case zf:return oe(function(B){k.commandType(B,"object",K,D.commandStr);var $=B.cmp||"keep",G=B.ref||0,ae="mask"in B?B.mask:-1;return k.commandParameter($,nc,ne+".cmp",D.commandStr),k.commandType(G,"number",ne+".ref",D.commandStr),k.commandType(ae,"number",ne+".mask",D.commandStr),[nc[$],G,ae]},function(B,$,G){var ae=B.constants.compareFuncs;k.optional(function(){function Me(){B.assert($,Array.prototype.join.call(arguments,""),"invalid stencil.func")}Me(G+"&&typeof ",G,'==="object"'),Me('!("cmp" in ',G,")||(",G,".cmp in ",ae,")")});var pe=$.def('"cmp" in ',G,"?",ae,"[",G,".cmp]",":",is),Oe=$.def(G,".ref|0"),Be=$.def('"mask" in ',G,"?",G,".mask|0:-1");return[pe,Oe,Be]});case Dl:case Gc:return oe(function(B){k.commandType(B,"object",K,D.commandStr);var $=B.fail||"keep",G=B.zfail||"keep",ae=B.zpass||"keep";return k.commandParameter($,os,ne+".fail",D.commandStr),k.commandParameter(G,os,ne+".zfail",D.commandStr),k.commandParameter(ae,os,ne+".zpass",D.commandStr),[ne===Gc?fu:Xc,os[$],os[G],os[ae]]},function(B,$,G){var ae=B.constants.stencilOps;k.optional(function(){B.assert($,G+"&&typeof "+G+'==="object"',"invalid "+ne)});function pe(Oe){return k.optional(function(){B.assert($,'!("'+Oe+'" in '+G+")||("+G+"."+Oe+" in "+ae+")","invalid "+ne+"."+Oe+", must be one of "+Object.keys(os))}),$.def('"',Oe,'" in ',G,"?",ae,"[",G,".",Oe,"]:",is)}return[ne===Gc?fu:Xc,pe("fail"),pe("zfail"),pe("zpass")]});case Nl:return oe(function(B){k.commandType(B,"object",K,D.commandStr);var $=B.factor|0,G=B.units|0;return k.commandType($,"number",K+".factor",D.commandStr),k.commandType(G,"number",K+".units",D.commandStr),[$,G]},function(B,$,G){k.optional(function(){B.assert($,G+"&&typeof "+G+'==="object"',"invalid "+ne)});var ae=$.def(G,".factor|0"),pe=$.def(G,".units|0");return[ae,pe]});case Ds:return oe(function(B){var $=0;return B==="front"?$=Xc:B==="back"&&($=fu),k.command(!!$,K,D.commandStr),$},function(B,$,G){return k.optional(function(){B.assert($,G+'==="front"||'+G+'==="back"',"invalid cull.face")}),$.def(G,'==="front"?',Xc,":",fu)});case ki:return oe(function(B){return k.command(typeof B=="number"&&B>=ye.lineWidthDims[0]&&B<=ye.lineWidthDims[1],"invalid line width, must be a positive number between "+ye.lineWidthDims[0]+" and "+ye.lineWidthDims[1],D.commandStr),B},function(B,$,G){return k.optional(function(){B.assert($,"typeof "+G+'==="number"&&'+G+">="+ye.lineWidthDims[0]+"&&"+G+"<="+ye.lineWidthDims[1],"invalid line width")}),G});case Uf:return oe(function(B){return k.commandParameter(B,hu,K,D.commandStr),hu[B]},function(B,$,G){return k.optional(function(){B.assert($,G+'==="cw"||'+G+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),$.def(G+'==="cw"?'+Gs+":"+Hf)});case Oc:return oe(function(B){return k.command(Gr(B)&&B.length===4,"color.mask must be length 4 array",D.commandStr),B.map(function($){return!!$})},function(B,$,G){return k.optional(function(){B.assert($,B.shared.isArrayLike+"("+G+")&&"+G+".length===4","invalid color.mask")}),di(4,function(ae){return"!!"+G+"["+ae+"]"})});case tu:return oe(function(B){k.command(typeof B=="object"&&B,K,D.commandStr);var $="value"in B?B.value:1,G=!!B.invert;return k.command(typeof $=="number"&&$>=0&&$<=1,"sample.coverage.value must be a number between 0 and 1",D.commandStr),[$,G]},function(B,$,G){k.optional(function(){B.assert($,G+"&&typeof "+G+'==="object"',"invalid sample.coverage")});var ae=$.def('"value" in ',G,"?+",G,".value:1"),pe=$.def("!!",G,".invert");return[ae,pe]})}}),le}function ai(U,D){var Y=U.static,ce=U.dynamic,le={};return Object.keys(Y).forEach(function(ne){var K=Y[ne],oe;if(typeof K=="number"||typeof K=="boolean")oe=ii(function(){return K});else if(typeof K=="function"){var B=K._reglType;B==="texture2d"||B==="textureCube"?oe=ii(function($){return $.link(K)}):B==="framebuffer"||B==="framebufferCube"?(k.command(K.color.length>0,'missing color attachment for framebuffer sent to uniform "'+ne+'"',D.commandStr),oe=ii(function($){return $.link(K.color[0])})):k.commandRaise('invalid data for uniform "'+ne+'"',D.commandStr)}else Gr(K)?oe=ii(function($){var G=$.global.def("[",di(K.length,function(ae){return k.command(typeof K[ae]=="number"||typeof K[ae]=="boolean","invalid uniform "+ne,$.commandStr),K[ae]}),"]");return G}):k.commandRaise('invalid or missing data for uniform "'+ne+'"',D.commandStr);oe.value=K,le[ne]=oe}),Object.keys(ce).forEach(function(ne){var K=ce[ne];le[ne]=Di(K,function(oe,B){return oe.invoke(B,K)})}),le}function On(U,D){var Y=U.static,ce=U.dynamic,le={};return Object.keys(Y).forEach(function(ne){var K=Y[ne],oe=O.id(ne),B=new fe;if(Xf(K))B.state=ya,B.buffer=se.getBuffer(se.create(K,ns,!1,!0)),B.type=0;else{var $=se.getBuffer(K);if($)B.state=ya,B.buffer=$,B.type=0;else if(k.command(typeof K=="object"&&K,"invalid data for attribute "+ne,D.commandStr),"constant"in K){var G=K.constant;B.buffer="null",B.state=ju,typeof G=="number"?B.x=G:(k.command(Gr(G)&&G.length>0&&G.length<=4,"invalid constant for attribute "+ne,D.commandStr),eu.forEach(function(At,xn){xn<G.length&&(B[At]=G[xn])}))}else{Xf(K.buffer)?$=se.getBuffer(se.create(K.buffer,ns,!1,!0)):$=se.getBuffer(K.buffer),k.command(!!$,'missing buffer for attribute "'+ne+'"',D.commandStr);var ae=K.offset|0;k.command(ae>=0,'invalid offset for attribute "'+ne+'"',D.commandStr);var pe=K.stride|0;k.command(pe>=0&&pe<256,'invalid stride for attribute "'+ne+'", must be integer betweeen [0, 255]',D.commandStr);var Oe=K.size|0;k.command(!("size"in K)||Oe>0&&Oe<=4,'invalid size for attribute "'+ne+'", must be 1,2,3,4',D.commandStr);var Be=!!K.normalized,Me=0;"type"in K&&(k.commandParameter(K.type,bi,"invalid type for attribute "+ne,D.commandStr),Me=bi[K.type]);var st=K.divisor|0;"divisor"in K&&(k.command(st===0||ot,'cannot specify divisor for attribute "'+ne+'", instancing not supported',D.commandStr),k.command(st>=0,'invalid divisor for attribute "'+ne+'"',D.commandStr)),k.optional(function(){var At=D.commandStr,xn=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(K).forEach(function(Bt){k.command(xn.indexOf(Bt)>=0,'unknown parameter "'+Bt+'" for attribute pointer "'+ne+'" (valid parameters are '+xn+")",At)})}),B.buffer=$,B.state=ya,B.size=Oe,B.normalized=Be,B.type=Me||$.dtype,B.offset=ae,B.stride=pe,B.divisor=st}}le[ne]=ii(function(At,xn){var Bt=At.attribCache;if(oe in Bt)return Bt[oe];var Jt={isStream:!1};return Object.keys(B).forEach(function(vn){Jt[vn]=B[vn]}),B.buffer&&(Jt.buffer=At.link(B.buffer),Jt.type=Jt.type||Jt.buffer+".dtype"),Bt[oe]=Jt,Jt})}),Object.keys(ce).forEach(function(ne){var K=ce[ne];function oe(B,$){var G=B.invoke($,K),ae=B.shared,pe=B.constants,Oe=ae.isBufferArgs,Be=ae.buffer;k.optional(function(){B.assert($,G+"&&(typeof "+G+'==="object"||typeof '+G+'==="function")&&('+Oe+"("+G+")||"+Be+".getBuffer("+G+")||"+Be+".getBuffer("+G+".buffer)||"+Oe+"("+G+'.buffer)||("constant" in '+G+"&&(typeof "+G+'.constant==="number"||'+ae.isArrayLike+"("+G+".constant))))",'invalid dynamic attribute "'+ne+'"')});var Me={isStream:$.def(!1)},st=new fe;st.state=ya,Object.keys(st).forEach(function(Jt){Me[Jt]=$.def(""+st[Jt])});var At=Me.buffer,xn=Me.type;$("if(",Oe,"(",G,")){",Me.isStream,"=true;",At,"=",Be,".createStream(",ns,",",G,");",xn,"=",At,".dtype;","}else{",At,"=",Be,".getBuffer(",G,");","if(",At,"){",xn,"=",At,".dtype;",'}else if("constant" in ',G,"){",Me.state,"=",ju,";","if(typeof "+G+'.constant === "number"){',Me[eu[0]],"=",G,".constant;",eu.slice(1).map(function(Jt){return Me[Jt]}).join("="),"=0;","}else{",eu.map(function(Jt,vn){return Me[Jt]+"="+G+".constant.length>"+vn+"?"+G+".constant["+vn+"]:0;"}).join(""),"}}else{","if(",Oe,"(",G,".buffer)){",At,"=",Be,".createStream(",ns,",",G,".buffer);","}else{",At,"=",Be,".getBuffer(",G,".buffer);","}",xn,'="type" in ',G,"?",pe.glTypes,"[",G,".type]:",At,".dtype;",Me.normalized,"=!!",G,".normalized;");function Bt(Jt){$(Me[Jt],"=",G,".",Jt,"|0;")}return Bt("size"),Bt("offset"),Bt("stride"),Bt("divisor"),$("}}"),$.exit("if(",Me.isStream,"){",Be,".destroyStream(",At,");","}"),Me}le[ne]=Di(K,oe)}),le}function Zr(U,D){var Y=U.static,ce=U.dynamic;if(Os in Y){var le=Y[Os];return le!==null&&it.getVAO(le)===null&&(le=it.createVAO(le)),ii(function(K){return K.link(it.getVAO(le))})}else if(Os in ce){var ne=ce[Os];return Di(ne,function(K,oe){var B=K.invoke(oe,ne);return oe.def(K.shared.vao+".getVAO("+B+")")})}return null}function xr(U){var D=U.static,Y=U.dynamic,ce={};return Object.keys(D).forEach(function(le){var ne=D[le];ce[le]=ii(function(K,oe){return typeof ne=="number"||typeof ne=="boolean"?""+ne:K.link(ne)})}),Object.keys(Y).forEach(function(le){var ne=Y[le];ce[le]=Di(ne,function(K,oe){return K.invoke(oe,ne)})}),ce}function qr(U,D,Y,ce,le){var ne=U.static,K=U.dynamic;k.optional(function(){var Bt=[Ps,kc,Fc,ru,Io,Vf,no,Yu,nu,Os].concat(Fe);function Jt(vn){Object.keys(vn).forEach(function(tr){k.command(Bt.indexOf(tr)>=0,'unknown parameter "'+tr+'"',le.commandStr)})}Jt(ne),Jt(K)});var oe=fn(U,D),B=Ut(U,le),$=Fn(U,B,le),G=ar(U,le),ae=Vr(U,le),pe=An(U,le,oe);function Oe(Bt){var Jt=$[Bt];Jt&&(ae[Bt]=Jt)}Oe(ts),Oe(ut(Wf));var Be=Object.keys(ae).length>0,Me={framebuffer:B,draw:G,shader:pe,state:ae,dirty:Be,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(Me.profile=Tn(U,le),Me.uniforms=ai(Y,le),Me.drawVAO=Me.scopeVAO=Zr(U,le),!Me.drawVAO&&pe.program&&!oe&&X.angle_instanced_arrays){var st=!0,At=pe.program.attributes.map(function(Bt){var Jt=D.static[Bt];return st=st&&!!Jt,Jt});if(st&&At.length>0){var xn=it.getVAO(it.createVAO(At));Me.drawVAO=new ea(null,null,null,function(Bt,Jt){return Bt.link(xn)}),Me.useVAO=!0}}return oe?Me.useVAO=!0:Me.attributes=On(D,le),Me.context=xr(ce,le),Me}function Jr(U,D,Y){var ce=U.shared,le=ce.context,ne=U.scope();Object.keys(Y).forEach(function(K){D.save(le,"."+K);var oe=Y[K],B=oe.append(U,D);Array.isArray(B)?ne(le,".",K,"=[",B.join(),"];"):ne(le,".",K,"=",B,";")}),D(ne)}function oi(U,D,Y,ce){var le=U.shared,ne=le.gl,K=le.framebuffer,oe;Ct&&(oe=D.def(le.extensions,".webgl_draw_buffers"));var B=U.constants,$=B.drawBuffer,G=B.backBuffer,ae;Y?ae=Y.append(U,D):ae=D.def(K,".next"),ce||D("if(",ae,"!==",K,".cur){"),D("if(",ae,"){",ne,".bindFramebuffer(",as,",",ae,".framebuffer);"),Ct&&D(oe,".drawBuffersWEBGL(",$,"[",ae,".colorAttachments.length]);"),D("}else{",ne,".bindFramebuffer(",as,",null);"),Ct&&D(oe,".drawBuffersWEBGL(",G,");"),D("}",K,".cur=",ae,";"),ce||D("}")}function Ir(U,D,Y){var ce=U.shared,le=ce.gl,ne=U.current,K=U.next,oe=ce.current,B=ce.next,$=U.cond(oe,".dirty");Fe.forEach(function(G){var ae=ut(G);if(!(ae in Y.state)){var pe,Oe;if(ae in K){pe=K[ae],Oe=ne[ae];var Be=di(Ve[ae].length,function(st){return $.def(pe,"[",st,"]")});$(U.cond(Be.map(function(st,At){return st+"!=="+Oe+"["+At+"]"}).join("||")).then(le,".",He[ae],"(",Be,");",Be.map(function(st,At){return Oe+"["+At+"]="+st}).join(";"),";"))}else{pe=$.def(B,".",ae);var Me=U.cond(pe,"!==",oe,".",ae);$(Me),ae in gt?Me(U.cond(pe).then(le,".enable(",gt[ae],");").else(le,".disable(",gt[ae],");"),oe,".",ae,"=",pe,";"):Me(le,".",He[ae],"(",pe,");",oe,".",ae,"=",pe,";")}}}),Object.keys(Y.state).length===0&&$(oe,".dirty=false;"),D($)}function Qr(U,D,Y,ce){var le=U.shared,ne=U.current,K=le.current,oe=le.gl;ks(Object.keys(Y)).forEach(function(B){var $=Y[B];if(!(ce&&!ce($))){var G=$.append(U,D);if(gt[B]){var ae=gt[B];oo($)?G?D(oe,".enable(",ae,");"):D(oe,".disable(",ae,");"):D(U.cond(G).then(oe,".enable(",ae,");").else(oe,".disable(",ae,");")),D(K,".",B,"=",G,";")}else if(Gr(G)){var pe=ne[B];D(oe,".",He[B],"(",G,");",G.map(function(Oe,Be){return pe+"["+Be+"]="+Oe}).join(";"),";")}else D(oe,".",He[B],"(",G,");",K,".",B,"=",G,";")}})}function jr(U,D){ot&&(U.instancing=D.def(U.shared.extensions,".angle_instanced_arrays"))}function _n(U,D,Y,ce,le){var ne=U.shared,K=U.stats,oe=ne.current,B=ne.timer,$=Y.profile;function G(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var ae,pe;function Oe(Bt){ae=D.def(),Bt(ae,"=",G(),";"),typeof le=="string"?Bt(K,".count+=",le,";"):Bt(K,".count++;"),Ke&&(ce?(pe=D.def(),Bt(pe,"=",B,".getNumPendingQueries();")):Bt(B,".beginQuery(",K,");"))}function Be(Bt){Bt(K,".cpuTime+=",G(),"-",ae,";"),Ke&&(ce?Bt(B,".pushScopeStats(",pe,",",B,".getNumPendingQueries(),",K,");"):Bt(B,".endQuery();"))}function Me(Bt){var Jt=D.def(oe,".profile");D(oe,".profile=",Bt,";"),D.exit(oe,".profile=",Jt,";")}var st;if($){if(oo($)){$.enable?(Oe(D),Be(D.exit),Me("true")):Me("false");return}st=$.append(U,D),Me(st)}else st=D.def(oe,".profile");var At=U.block();Oe(At),D("if(",st,"){",At,"}");var xn=U.block();Be(xn),D.exit("if(",st,"){",xn,"}")}function si(U,D,Y,ce,le){var ne=U.shared;function K(B){switch(B){case Wc:case Vc:case jc:return 2;case Ur:case uu:case tc:return 3;case mi:case rs:case cu:return 4;default:return 1}}function oe(B,$,G){var ae=ne.gl,pe=D.def(B,".location"),Oe=D.def(ne.attributes,"[",pe,"]"),Be=G.state,Me=G.buffer,st=[G.x,G.y,G.z,G.w],At=["buffer","normalized","offset","stride"];function xn(){D("if(!",Oe,".buffer){",ae,".enableVertexAttribArray(",pe,");}");var Jt=G.type,vn;if(G.size?vn=D.def(G.size,"||",$):vn=$,D("if(",Oe,".type!==",Jt,"||",Oe,".size!==",vn,"||",At.map(function(kr){return Oe+"."+kr+"!=="+G[kr]}).join("||"),"){",ae,".bindBuffer(",ns,",",Me,".buffer);",ae,".vertexAttribPointer(",[pe,vn,Jt,G.normalized,G.stride,G.offset],");",Oe,".type=",Jt,";",Oe,".size=",vn,";",At.map(function(kr){return Oe+"."+kr+"="+G[kr]+";"}).join(""),"}"),ot){var tr=G.divisor;D("if(",Oe,".divisor!==",tr,"){",U.instancing,".vertexAttribDivisorANGLE(",[pe,tr],");",Oe,".divisor=",tr,";}")}}function Bt(){D("if(",Oe,".buffer){",ae,".disableVertexAttribArray(",pe,");",Oe,".buffer=null;","}if(",eu.map(function(Jt,vn){return Oe+"."+Jt+"!=="+st[vn]}).join("||"),"){",ae,".vertexAttrib4f(",pe,",",st,");",eu.map(function(Jt,vn){return Oe+"."+Jt+"="+st[vn]+";"}).join(""),"}")}Be===ya?xn():Be===ju?Bt():(D("if(",Be,"===",ya,"){"),xn(),D("}else{"),Bt(),D("}"))}ce.forEach(function(B){var $=B.name,G=Y.attributes[$],ae;if(G){if(!le(G))return;ae=G.append(U,D)}else{if(!le($f))return;var pe=U.scopeAttrib($);k.optional(function(){U.assert(D,pe+".state","missing attribute "+$)}),ae={},Object.keys(new fe).forEach(function(Oe){ae[Oe]=D.def(pe,".",Oe)})}oe(U.link(B),K(B.info.type),ae)})}function or(U,D,Y,ce,le){for(var ne=U.shared,K=ne.gl,oe,B=0;B<ce.length;++B){var $=ce[B],G=$.name,ae=$.info.type,pe=Y.uniforms[G],Oe=U.link($),Be=Oe+".location",Me;if(pe){if(!le(pe))continue;if(oo(pe)){var st=pe.value;if(k.command(st!==null&&typeof st!="undefined",'missing uniform "'+G+'"',U.commandStr),ae===Ro||ae===Ls){k.command(typeof st=="function"&&(ae===Ro&&(st._reglType==="texture2d"||st._reglType==="framebuffer")||ae===Ls&&(st._reglType==="textureCube"||st._reglType==="framebufferCube")),"invalid texture for uniform "+G,U.commandStr);var At=U.link(st._texture||st.color[0]._texture);D(K,".uniform1i(",Be,",",At+".bind());"),D.exit(At,".unbind();")}else if(ae===Fi||ae===Zi||ae===Ia){k.optional(function(){k.command(Gr(st),"invalid matrix for uniform "+G,U.commandStr),k.command(ae===Fi&&st.length===4||ae===Zi&&st.length===9||ae===Ia&&st.length===16,"invalid length for matrix uniform "+G,U.commandStr)});var xn=U.global.def("new Float32Array(["+Array.prototype.slice.call(st)+"])"),Bt=2;ae===Zi?Bt=3:ae===Ia&&(Bt=4),D(K,".uniformMatrix",Bt,"fv(",Be,",false,",xn,");")}else{switch(ae){case zc:k.commandType(st,"number","uniform "+G,U.commandStr),oe="1f";break;case Wc:k.command(Gr(st)&&st.length===2,"uniform "+G,U.commandStr),oe="2f";break;case Ur:k.command(Gr(st)&&st.length===3,"uniform "+G,U.commandStr),oe="3f";break;case mi:k.command(Gr(st)&&st.length===4,"uniform "+G,U.commandStr),oe="4f";break;case Zc:k.commandType(st,"boolean","uniform "+G,U.commandStr),oe="1i";break;case ec:k.commandType(st,"number","uniform "+G,U.commandStr),oe="1i";break;case jc:k.command(Gr(st)&&st.length===2,"uniform "+G,U.commandStr),oe="2i";break;case Vc:k.command(Gr(st)&&st.length===2,"uniform "+G,U.commandStr),oe="2i";break;case tc:k.command(Gr(st)&&st.length===3,"uniform "+G,U.commandStr),oe="3i";break;case uu:k.command(Gr(st)&&st.length===3,"uniform "+G,U.commandStr),oe="3i";break;case cu:k.command(Gr(st)&&st.length===4,"uniform "+G,U.commandStr),oe="4i";break;case rs:k.command(Gr(st)&&st.length===4,"uniform "+G,U.commandStr),oe="4i";break}D(K,".uniform",oe,"(",Be,",",Gr(st)?Array.prototype.slice.call(st):st,");")}continue}else Me=pe.append(U,D)}else{if(!le($f))continue;Me=D.def(ne.uniforms,"[",O.id(G),"]")}ae===Ro?(k(!Array.isArray(Me),"must specify a scalar prop for textures"),D("if(",Me,"&&",Me,'._reglType==="framebuffer"){',Me,"=",Me,".color[0];","}")):ae===Ls&&(k(!Array.isArray(Me),"must specify a scalar prop for cube maps"),D("if(",Me,"&&",Me,'._reglType==="framebufferCube"){',Me,"=",Me,".color[0];","}")),k.optional(function(){function wi(uo,Xd){U.assert(D,uo,'bad data or missing for uniform "'+G+'".  '+Xd)}function qf(uo){k(!Array.isArray(Me),"must not specify an array type for uniform"),wi("typeof "+Me+'==="'+uo+'"',"invalid type, expected "+uo)}function Ra(uo,Xd){Array.isArray(Me)?k(Me.length===uo,"must have length "+uo):wi(ne.isArrayLike+"("+Me+")&&"+Me+".length==="+uo,"invalid vector, should have length "+uo,U.commandStr)}function kl(uo){k(!Array.isArray(Me),"must not specify a value type"),wi("typeof "+Me+'==="function"&&'+Me+'._reglType==="texture'+(uo===Qn?"2d":"Cube")+'"',"invalid texture type",U.commandStr)}switch(ae){case ec:qf("number");break;case Vc:Ra(2,"number");break;case uu:Ra(3,"number");break;case rs:Ra(4,"number");break;case zc:qf("number");break;case Wc:Ra(2,"number");break;case Ur:Ra(3,"number");break;case mi:Ra(4,"number");break;case Zc:qf("boolean");break;case jc:Ra(2,"boolean");break;case tc:Ra(3,"boolean");break;case cu:Ra(4,"boolean");break;case Fi:Ra(4,"number");break;case Zi:Ra(9,"number");break;case Ia:Ra(16,"number");break;case Ro:kl(Qn);break;case Ls:kl(ev);break}});var Jt=1;switch(ae){case Ro:case Ls:var vn=D.def(Me,"._texture");D(K,".uniform1i(",Be,",",vn,".bind());"),D.exit(vn,".unbind();");continue;case ec:case Zc:oe="1i";break;case Vc:case jc:oe="2i",Jt=2;break;case uu:case tc:oe="3i",Jt=3;break;case rs:case cu:oe="4i",Jt=4;break;case zc:oe="1f";break;case Wc:oe="2f",Jt=2;break;case Ur:oe="3f",Jt=3;break;case mi:oe="4f",Jt=4;break;case Fi:oe="Matrix2fv";break;case Zi:oe="Matrix3fv";break;case Ia:oe="Matrix4fv";break}if(D(K,".uniform",oe,"(",Be,","),oe.charAt(0)==="M"){var tr=Math.pow(ae-Fi+2,2),kr=U.global.def("new Float32Array(",tr,")");Array.isArray(Me)?D("false,(",di(tr,function(wi){return kr+"["+wi+"]="+Me[wi]}),",",kr,")"):D("false,(Array.isArray(",Me,")||",Me," instanceof Float32Array)?",Me,":(",di(tr,function(wi){return kr+"["+wi+"]="+Me+"["+wi+"]"}),",",kr,")")}else Jt>1?D(di(Jt,function(wi){return Array.isArray(Me)?Me[wi]:Me+"["+wi+"]"})):(k(!Array.isArray(Me),"uniform value must not be an array"),D(Me));D(");")}}function tn(U,D,Y,ce){var le=U.shared,ne=le.gl,K=le.draw,oe=ce.draw;function B(){var vn=oe.elements,tr,kr=D;return vn?((vn.contextDep&&ce.contextDynamic||vn.propDep)&&(kr=Y),tr=vn.append(U,kr)):tr=kr.def(K,".",ru),tr&&kr("if("+tr+")"+ne+".bindBuffer("+Pl+","+tr+".buffer.buffer);"),tr}function $(){var vn=oe.count,tr,kr=D;return vn?((vn.contextDep&&ce.contextDynamic||vn.propDep)&&(kr=Y),tr=vn.append(U,kr),k.optional(function(){vn.MISSING&&U.assert(D,"false","missing vertex count"),vn.DYNAMIC&&U.assert(kr,tr+">=0","missing vertex count")})):(tr=kr.def(K,".",no),k.optional(function(){U.assert(kr,tr+">=0","missing vertex count")})),tr}var G=B();function ae(vn){var tr=oe[vn];return tr?tr.contextDep&&ce.contextDynamic||tr.propDep?tr.append(U,Y):tr.append(U,D):D.def(K,".",vn)}var pe=ae(Io),Oe=ae(Vf),Be=$();if(typeof Be=="number"){if(Be===0)return}else Y("if(",Be,"){"),Y.exit("}");var Me,st;ot&&(Me=ae(Yu),st=U.instancing);var At=G+".type",xn=oe.elements&&oo(oe.elements);function Bt(){function vn(){Y(st,".drawElementsInstancedANGLE(",[pe,Be,At,Oe+"<<(("+At+"-"+Cl+")>>1)",Me],");")}function tr(){Y(st,".drawArraysInstancedANGLE(",[pe,Oe,Be,Me],");")}G?xn?vn():(Y("if(",G,"){"),vn(),Y("}else{"),tr(),Y("}")):tr()}function Jt(){function vn(){Y(ne+".drawElements("+[pe,Be,At,Oe+"<<(("+At+"-"+Cl+")>>1)"]+");")}function tr(){Y(ne+".drawArrays("+[pe,Oe,Be]+");")}G?xn?vn():(Y("if(",G,"){"),vn(),Y("}else{"),tr(),Y("}")):tr()}ot&&(typeof Me!="number"||Me>=0)?typeof Me=="string"?(Y("if(",Me,">0){"),Bt(),Y("}else if(",Me,"<0){"),Jt(),Y("}")):Bt():Jt()}function Vn(U,D,Y,ce,le){var ne=Qt(),K=ne.proc("body",le);return k.optional(function(){ne.commandStr=D.commandStr,ne.command=ne.link(D.commandStr)}),ot&&(ne.instancing=K.def(ne.shared.extensions,".angle_instanced_arrays")),U(ne,K,Y,ce),ne.compile().body}function er(U,D,Y,ce){jr(U,D),Y.useVAO?Y.drawVAO?D(U.shared.vao,".setVAO(",Y.drawVAO.append(U,D),");"):D(U.shared.vao,".setVAO(",U.shared.vao,".targetVAO);"):(D(U.shared.vao,".setVAO(null);"),si(U,D,Y,ce.attributes,function(){return!0})),or(U,D,Y,ce.uniforms,function(){return!0}),tn(U,D,D,Y)}function ui(U,D){var Y=U.proc("draw",1);jr(U,Y),Jr(U,Y,D.context),oi(U,Y,D.framebuffer),Ir(U,Y,D),Qr(U,Y,D.state),_n(U,Y,D,!1,!0);var ce=D.shader.progVar.append(U,Y);if(Y(U.shared.gl,".useProgram(",ce,".program);"),D.shader.program)er(U,Y,D,D.shader.program);else{Y(U.shared.vao,".setVAO(null);");var le=U.global.def("{}"),ne=Y.def(ce,".id"),K=Y.def(le,"[",ne,"]");Y(U.cond(K).then(K,".call(this,a0);").else(K,"=",le,"[",ne,"]=",U.link(function(oe){return Vn(er,U,D,oe,1)}),"(",ce,");",K,".call(this,a0);"))}Object.keys(D.state).length>0&&Y(U.shared.current,".dirty=true;")}function No(U,D,Y,ce){U.batchId="a1",jr(U,D);function le(){return!0}si(U,D,Y,ce.attributes,le),or(U,D,Y,ce.uniforms,le),tn(U,D,D,Y)}function Ca(U,D,Y,ce){jr(U,D);var le=Y.contextDep,ne=D.def(),K="a0",oe="a1",B=D.def();U.shared.props=B,U.batchId=ne;var $=U.scope(),G=U.scope();D($.entry,"for(",ne,"=0;",ne,"<",oe,";++",ne,"){",B,"=",K,"[",ne,"];",G,"}",$.exit);function ae(At){return At.contextDep&&le||At.propDep}function pe(At){return!ae(At)}if(Y.needsContext&&Jr(U,G,Y.context),Y.needsFramebuffer&&oi(U,G,Y.framebuffer),Qr(U,G,Y.state,ae),Y.profile&&ae(Y.profile)&&_n(U,G,Y,!1,!0),ce)Y.useVAO?Y.drawVAO?ae(Y.drawVAO)?G(U.shared.vao,".setVAO(",Y.drawVAO.append(U,G),");"):$(U.shared.vao,".setVAO(",Y.drawVAO.append(U,$),");"):$(U.shared.vao,".setVAO(",U.shared.vao,".targetVAO);"):($(U.shared.vao,".setVAO(null);"),si(U,$,Y,ce.attributes,pe),si(U,G,Y,ce.attributes,ae)),or(U,$,Y,ce.uniforms,pe),or(U,G,Y,ce.uniforms,ae),tn(U,$,G,Y);else{var Oe=U.global.def("{}"),Be=Y.shader.progVar.append(U,G),Me=G.def(Be,".id"),st=G.def(Oe,"[",Me,"]");G(U.shared.gl,".useProgram(",Be,".program);","if(!",st,"){",st,"=",Oe,"[",Me,"]=",U.link(function(At){return Vn(No,U,Y,At,2)}),"(",Be,");}",st,".call(this,a0[",ne,"],",ne,");")}}function z(U,D){var Y=U.proc("batch",2);U.batchId="0",jr(U,Y);var ce=!1,le=!0;Object.keys(D.context).forEach(function(Oe){ce=ce||D.context[Oe].propDep}),ce||(Jr(U,Y,D.context),le=!1);var ne=D.framebuffer,K=!1;ne?(ne.propDep?ce=K=!0:ne.contextDep&&ce&&(K=!0),K||oi(U,Y,ne)):oi(U,Y,null),D.state.viewport&&D.state.viewport.propDep&&(ce=!0);function oe(Oe){return Oe.contextDep&&ce||Oe.propDep}Ir(U,Y,D),Qr(U,Y,D.state,function(Oe){return!oe(Oe)}),(!D.profile||!oe(D.profile))&&_n(U,Y,D,!1,"a1"),D.contextDep=ce,D.needsContext=le,D.needsFramebuffer=K;var B=D.shader.progVar;if(B.contextDep&&ce||B.propDep)Ca(U,Y,D,null);else{var $=B.append(U,Y);if(Y(U.shared.gl,".useProgram(",$,".program);"),D.shader.program)Ca(U,Y,D,D.shader.program);else{Y(U.shared.vao,".setVAO(null);");var G=U.global.def("{}"),ae=Y.def($,".id"),pe=Y.def(G,"[",ae,"]");Y(U.cond(pe).then(pe,".call(this,a0,a1);").else(pe,"=",G,"[",ae,"]=",U.link(function(Oe){return Vn(Ca,U,D,Oe,2)}),"(",$,");",pe,".call(this,a0,a1);"))}}Object.keys(D.state).length>0&&Y(U.shared.current,".dirty=true;")}function Se(U,D){var Y=U.proc("scope",3);U.batchId="a2";var ce=U.shared,le=ce.current;Jr(U,Y,D.context),D.framebuffer&&D.framebuffer.append(U,Y),ks(Object.keys(D.state)).forEach(function(K){var oe=D.state[K],B=oe.append(U,Y);Gr(B)?B.forEach(function($,G){Y.set(U.next[K],"["+G+"]",$)}):Y.set(ce.next,"."+K,B)}),_n(U,Y,D,!0,!0),[ru,Vf,no,Yu,Io].forEach(function(K){var oe=D.draw[K];!oe||Y.set(ce.draw,"."+K,""+oe.append(U,Y))}),Object.keys(D.uniforms).forEach(function(K){var oe=D.uniforms[K].append(U,Y);Array.isArray(oe)&&(oe="["+oe.join()+"]"),Y.set(ce.uniforms,"["+O.id(K)+"]",oe)}),Object.keys(D.attributes).forEach(function(K){var oe=D.attributes[K].append(U,Y),B=U.scopeAttrib(K);Object.keys(new fe).forEach(function($){Y.set(B,"."+$,oe[$])})}),D.scopeVAO&&Y.set(ce.vao,".targetVAO",D.scopeVAO.append(U,Y));function ne(K){var oe=D.shader[K];oe&&Y.set(ce.shader,"."+K,oe.append(U,Y))}ne(kc),ne(Fc),Object.keys(D.state).length>0&&(Y(le,".dirty=true;"),Y.exit(le,".dirty=true;")),Y("a1(",U.shared.context,",a0,",U.batchId,");")}function _e(U){if(!(typeof U!="object"||Gr(U))){for(var D=Object.keys(U),Y=0;Y<D.length;++Y)if(Rn.isDynamic(U[D[Y]]))return!0;return!1}}function Pt(U,D,Y){var ce=D.static[Y];if(!ce||!_e(ce))return;var le=U.global,ne=Object.keys(ce),K=!1,oe=!1,B=!1,$=U.global.def("{}");ne.forEach(function(ae){var pe=ce[ae];if(Rn.isDynamic(pe)){typeof pe=="function"&&(pe=ce[ae]=Rn.unbox(pe));var Oe=Di(pe,null);K=K||Oe.thisDep,B=B||Oe.propDep,oe=oe||Oe.contextDep}else{switch(le($,".",ae,"="),typeof pe){case"number":le(pe);break;case"string":le('"',pe,'"');break;case"object":Array.isArray(pe)&&le("[",pe.join(),"]");break;default:le(U.link(pe));break}le(";")}});function G(ae,pe){ne.forEach(function(Oe){var Be=ce[Oe];if(!!Rn.isDynamic(Be)){var Me=ae.invoke(pe,Be);pe($,".",Oe,"=",Me,";")}})}D.dynamic[Y]=new Rn.DynamicVariable(Hu,{thisDep:K,contextDep:oe,propDep:B,ref:$,append:G}),delete D.static[Y]}function Nn(U,D,Y,ce,le){var ne=Qt();ne.stats=ne.link(le),Object.keys(D.static).forEach(function(oe){Pt(ne,D,oe)}),Ku.forEach(function(oe){Pt(ne,U,oe)});var K=qr(U,D,Y,ce,ne);return ui(ne,K),Se(ne,K),z(ne,K),S(ne.compile(),{destroy:function(){K.shader.program.destroy()}})}return{next:Tt,current:Ve,procs:function(){var U=Qt(),D=U.proc("poll"),Y=U.proc("refresh"),ce=U.block();D(ce),Y(ce);var le=U.shared,ne=le.gl,K=le.next,oe=le.current;ce(oe,".dirty=false;"),oi(U,D),oi(U,Y,null,!0);var B;ot&&(B=U.link(ot)),X.oes_vertex_array_object&&Y(U.link(X.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var $=0;$<ye.maxAttributes;++$){var G=Y.def(le.attributes,"[",$,"]"),ae=U.cond(G,".buffer");ae.then(ne,".enableVertexAttribArray(",$,");",ne,".bindBuffer(",ns,",",G,".buffer.buffer);",ne,".vertexAttribPointer(",$,",",G,".size,",G,".type,",G,".normalized,",G,".stride,",G,".offset);").else(ne,".disableVertexAttribArray(",$,");",ne,".vertexAttrib4f(",$,",",G,".x,",G,".y,",G,".z,",G,".w);",G,".buffer=null;"),Y(ae),ot&&Y(B,".vertexAttribDivisorANGLE(",$,",",G,".divisor);")}return Y(U.shared.vao,".currentVAO=null;",U.shared.vao,".setVAO(",U.shared.vao,".targetVAO);"),Object.keys(gt).forEach(function(pe){var Oe=gt[pe],Be=ce.def(K,".",pe),Me=U.block();Me("if(",Be,"){",ne,".enable(",Oe,")}else{",ne,".disable(",Oe,")}",oe,".",pe,"=",Be,";"),Y(Me),D("if(",Be,"!==",oe,".",pe,"){",Me,"}")}),Object.keys(He).forEach(function(pe){var Oe=He[pe],Be=Ve[pe],Me,st,At=U.block();if(At(ne,".",Oe,"("),Gr(Be)){var xn=Be.length;Me=U.global.def(K,".",pe),st=U.global.def(oe,".",pe),At(di(xn,function(Bt){return Me+"["+Bt+"]"}),");",di(xn,function(Bt){return st+"["+Bt+"]="+Me+"["+Bt+"];"}).join("")),D("if(",di(xn,function(Bt){return Me+"["+Bt+"]!=="+st+"["+Bt+"]"}).join("||"),"){",At,"}")}else Me=ce.def(K,".",pe),st=ce.def(oe,".",pe),At(Me,");",oe,".",pe,"=",Me,";"),D("if(",Me,"!==",st,"){",At,"}");Y(At)}),U.compile()}(),compile:Nn}}function iv(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var jd=34918,ss=34919,rc=35007,Gl=function(T,O){if(!O.ext_disjoint_timer_query)return null;var X=[];function ye(){return X.pop()||O.ext_disjoint_timer_query.createQueryEXT()}function se(ot){X.push(ot)}var Ee=[];function Te(ot){var Ct=ye();O.ext_disjoint_timer_query.beginQueryEXT(rc,Ct),Ee.push(Ct),Ke(Ee.length-1,Ee.length,ot)}function $e(){O.ext_disjoint_timer_query.endQueryEXT(rc)}function Qe(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var it=[];function Le(){return it.pop()||new Qe}function qe(ot){it.push(ot)}var Et=[];function Ke(ot,Ct,Ve){var Tt=Le();Tt.startQueryIndex=ot,Tt.endQueryIndex=Ct,Tt.sum=0,Tt.stats=Ve,Et.push(Tt)}var mt=[],fe=[];function Ie(){var ot,Ct,Ve=Ee.length;if(Ve!==0){fe.length=Math.max(fe.length,Ve+1),mt.length=Math.max(mt.length,Ve+1),mt[0]=0,fe[0]=0;var Tt=0;for(ot=0,Ct=0;Ct<Ee.length;++Ct){var Fe=Ee[Ct];O.ext_disjoint_timer_query.getQueryObjectEXT(Fe,ss)?(Tt+=O.ext_disjoint_timer_query.getQueryObjectEXT(Fe,jd),se(Fe)):Ee[ot++]=Fe,mt[Ct+1]=Tt,fe[Ct+1]=ot}for(Ee.length=ot,ot=0,Ct=0;Ct<Et.length;++Ct){var gt=Et[Ct],He=gt.startQueryIndex,ut=gt.endQueryIndex;gt.sum+=mt[ut]-mt[He];var Ht=fe[He],hn=fe[ut];hn===Ht?(gt.stats.gpuTime+=gt.sum/1e6,qe(gt)):(gt.startQueryIndex=Ht,gt.endQueryIndex=hn,Et[ot++]=gt)}Et.length=ot}}return{beginQuery:Te,endQuery:$e,pushScopeStats:Ke,update:Ie,getNumPendingQueries:function(){return Ee.length},clear:function(){X.push.apply(X,Ee);for(var ot=0;ot<X.length;ot++)O.ext_disjoint_timer_query.deleteQueryEXT(X[ot]);Ee.length=0,X.length=0},restore:function(){Ee.length=0,X.length=0}}},ic=16384,vu=256,so=1024,$c=34962,ac="webglcontextlost",Hd="webglcontextrestored",oc=1,Yc=2,av=3;function Pi(T,O){for(var X=0;X<T.length;++X)if(T[X]===O)return X;return-1}function Kf(T){var O=ps(T);if(!O)return null;var X=O.gl,ye=X.getContextAttributes(),se=X.isContextLost(),Ee=uf(X,O);if(!Ee)return null;var Te=an(),$e=iv(),Qe=Ee.extensions,it=Gl(X,Qe),Le=Un(),qe=X.drawingBufferWidth,Et=X.drawingBufferHeight,Ke={tick:0,time:0,viewportWidth:qe,viewportHeight:Et,framebufferWidth:qe,framebufferHeight:Et,drawingBufferWidth:qe,drawingBufferHeight:Et,pixelRatio:O.pixelRatio},mt={},fe={elements:null,primitive:4,count:-1,offset:0,instances:-1},Ie=Vo(X,Qe),ot=df(X,$e,O,Ve),Ct=eo(X,Qe,Ie,$e,ot);function Ve(tn){return Ct.destroyBuffer(tn)}var Tt=ws(X,Qe,ot,$e),Fe=Qh(X,Te,$e,O),gt=yd(X,Qe,Ie,function(){Ht.procs.poll()},Ke,$e,O),He=Nf(X,Qe,Ie,$e,O),ut=Kh(X,Qe,Ie,gt,He,$e),Ht=Yf(X,Te,Qe,Ie,ot,Tt,gt,ut,mt,Ct,Fe,fe,Ke,it,O),hn=Il(X,ut,Ht.procs.poll,Ke,ye,Qe,Ie),yt=Ht.next,lt=X.canvas,Ze=[],Qt=[],Tn=[],Ut=[O.onDestroy],Fn=null;function fn(){if(Ze.length===0){it&&it.update(),Fn=null;return}Fn=Pn.next(fn),Qr();for(var tn=Ze.length-1;tn>=0;--tn){var Vn=Ze[tn];Vn&&Vn(Ke,null,0)}X.flush(),it&&it.update()}function An(){!Fn&&Ze.length>0&&(Fn=Pn.next(fn))}function ar(){Fn&&(Pn.cancel(fn),Fn=null)}function Vr(tn){tn.preventDefault(),se=!0,ar(),Qt.forEach(function(Vn){Vn()})}function ai(tn){X.getError(),se=!1,Ee.restore(),Fe.restore(),ot.restore(),gt.restore(),He.restore(),ut.restore(),Ct.restore(),it&&it.restore(),Ht.procs.refresh(),An(),Tn.forEach(function(Vn){Vn()})}lt&&(lt.addEventListener(ac,Vr,!1),lt.addEventListener(Hd,ai,!1));function On(){Ze.length=0,ar(),lt&&(lt.removeEventListener(ac,Vr),lt.removeEventListener(Hd,ai)),Fe.clear(),ut.clear(),He.clear(),gt.clear(),Tt.clear(),ot.clear(),Ct.clear(),it&&it.clear(),Ut.forEach(function(tn){tn()})}function Zr(tn){k(!!tn,"invalid args to regl({...})"),k.type(tn,"object","invalid args to regl({...})");function Vn(le){var ne=S({},le);delete ne.uniforms,delete ne.attributes,delete ne.context,delete ne.vao,"stencil"in ne&&ne.stencil.op&&(ne.stencil.opBack=ne.stencil.opFront=ne.stencil.op,delete ne.stencil.op);function K(oe){if(oe in ne){var B=ne[oe];delete ne[oe],Object.keys(B).forEach(function($){ne[oe+"."+$]=B[$]})}}return K("blend"),K("depth"),K("cull"),K("stencil"),K("polygonOffset"),K("scissor"),K("sample"),"vao"in le&&(ne.vao=le.vao),ne}function er(le,ne){var K={},oe={};return Object.keys(le).forEach(function(B){var $=le[B];if(Rn.isDynamic($)){oe[B]=Rn.unbox($,B);return}else if(ne&&Array.isArray($)){for(var G=0;G<$.length;++G)if(Rn.isDynamic($[G])){oe[B]=Rn.unbox($,B);return}}K[B]=$}),{dynamic:oe,static:K}}var ui=er(tn.context||{},!0),No=er(tn.uniforms||{},!0),Ca=er(tn.attributes||{},!1),z=er(Vn(tn),!1),Se={gpuTime:0,cpuTime:0,count:0},_e=Ht.compile(z,Ca,No,ui,Se),Pt=_e.draw,Nn=_e.batch,U=_e.scope,D=[];function Y(le){for(;D.length<le;)D.push(null);return D}function ce(le,ne){var K;if(se&&k.raise("context lost"),typeof le=="function")return U.call(this,null,le,0);if(typeof ne=="function")if(typeof le=="number")for(K=0;K<le;++K)U.call(this,null,ne,K);else if(Array.isArray(le))for(K=0;K<le.length;++K)U.call(this,le[K],ne,K);else return U.call(this,le,ne,0);else if(typeof le=="number"){if(le>0)return Nn.call(this,Y(le|0),le|0)}else if(Array.isArray(le)){if(le.length)return Nn.call(this,le,le.length)}else return Pt.call(this,le)}return S(ce,{stats:Se,destroy:function(){_e.destroy()}})}var xr=ut.setFBO=Zr({framebuffer:Rn.define.call(null,oc,"framebuffer")});function qr(tn,Vn){var er=0;Ht.procs.poll();var ui=Vn.color;ui&&(X.clearColor(+ui[0]||0,+ui[1]||0,+ui[2]||0,+ui[3]||0),er|=ic),"depth"in Vn&&(X.clearDepth(+Vn.depth),er|=vu),"stencil"in Vn&&(X.clearStencil(Vn.stencil|0),er|=so),k(!!er,"called regl.clear with no buffer specified"),X.clear(er)}function Jr(tn){if(k(typeof tn=="object"&&tn,"regl.clear() takes an object as input"),"framebuffer"in tn)if(tn.framebuffer&&tn.framebuffer_reglType==="framebufferCube")for(var Vn=0;Vn<6;++Vn)xr(S({framebuffer:tn.framebuffer.faces[Vn]},tn),qr);else xr(tn,qr);else qr(null,tn)}function oi(tn){k.type(tn,"function","regl.frame() callback must be a function"),Ze.push(tn);function Vn(){var er=Pi(Ze,tn);k(er>=0,"cannot cancel a frame twice");function ui(){var No=Pi(Ze,ui);Ze[No]=Ze[Ze.length-1],Ze.length-=1,Ze.length<=0&&ar()}Ze[er]=ui}return An(),{cancel:Vn}}function Ir(){var tn=yt.viewport,Vn=yt.scissor_box;tn[0]=tn[1]=Vn[0]=Vn[1]=0,Ke.viewportWidth=Ke.framebufferWidth=Ke.drawingBufferWidth=tn[2]=Vn[2]=X.drawingBufferWidth,Ke.viewportHeight=Ke.framebufferHeight=Ke.drawingBufferHeight=tn[3]=Vn[3]=X.drawingBufferHeight}function Qr(){Ke.tick+=1,Ke.time=_n(),Ir(),Ht.procs.poll()}function jr(){gt.refresh(),Ir(),Ht.procs.refresh(),it&&it.update()}function _n(){return(Un()-Le)/1e3}jr();function si(tn,Vn){k.type(Vn,"function","listener callback must be a function");var er;switch(tn){case"frame":return oi(Vn);case"lost":er=Qt;break;case"restore":er=Tn;break;case"destroy":er=Ut;break;default:k.raise("invalid event, must be one of frame,lost,restore,destroy")}return er.push(Vn),{cancel:function(){for(var ui=0;ui<er.length;++ui)if(er[ui]===Vn){er[ui]=er[er.length-1],er.pop();return}}}}var or=S(Zr,{clear:Jr,prop:Rn.define.bind(null,oc),context:Rn.define.bind(null,Yc),this:Rn.define.bind(null,av),draw:Zr({}),buffer:function(tn){return ot.create(tn,$c,!1,!1)},elements:function(tn){return Tt.create(tn,!1)},texture:gt.create2D,cube:gt.createCube,renderbuffer:He.create,framebuffer:ut.create,framebufferCube:ut.createCube,vao:Ct.createVAO,attributes:ye,frame:oi,on:si,limits:Ie,hasExtension:function(tn){return Ie.extensions.indexOf(tn.toLowerCase())>=0},read:hn,destroy:On,_gl:X,_refresh:jr,poll:function(){Qr(),it&&it.update()},now:_n,stats:$e});return O.onDone(null,or),or}return Kf})}}]);
